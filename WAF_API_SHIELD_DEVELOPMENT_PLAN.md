# –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ WAF / API Shield

## üìã –û–±–∑–æ—Ä

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ WAF / API Shield –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ä–µ–∞–ª—å–Ω—ã–º —Ä–µ—à–µ–Ω–∏—è–º (Cloudflare WAF, AWS WAF, ModSecurity) –∏ –∏–∑–±–µ–∂–∞–Ω–∏—è —Ö–∞—Ä–¥–∫–æ–¥–∞/—Å–∫—Ä–∏–ø—Ç–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏.

**–¶–µ–ª—å**: –°–æ–∑–¥–∞—Ç—å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—É—é —Å–∏–º—É–ª—è—Ü–∏—é WAF/API Shield —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, –±–µ–∑ —Ö–∞—Ä–¥–∫–æ–¥–∞ –∏ —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –≤ —Å–∏—Å—Ç–µ–º—É.

---

## üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
1. **WAFRoutingEngine** - –±–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
2. **WAFEmulationEngine** - —Ä–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫
3. **WAFConfigAdvanced** - UI –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ EmulationEngine –∏ DataFlowEngine
5. –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏: OWASP –ø—Ä–∞–≤–∏–ª–∞, rate limiting, geo-blocking, DDoS protection

### ‚ùå –ü—Ä–æ–±–ª–µ–º—ã –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:

#### 1. –•–∞—Ä–¥–∫–æ–¥ –∏ —Å–∫—Ä–∏–ø—Ç–æ–≤–∞–Ω–Ω–æ—Å—Ç—å:
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö IP** (`generateRandomIP()`) - —Ö–∞—Ä–¥–∫–æ–¥
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —Å—Ç—Ä–∞–Ω** (`generateRandomCountry()`) - —Ö–∞—Ä–¥–∫–æ–¥
- **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —É–≥—Ä–æ–∑** (5% –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤) - —Ö–∞—Ä–¥–∫–æ–¥
- **–£–ø—Ä–æ—â–µ–Ω–Ω—ã–µ OWASP –ø—Ä–∞–≤–∏–ª–∞** - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏ –∏ –º–µ—Ç–æ–¥—ã** –≤ —Å–∏–º—É–ª—è—Ü–∏–∏ - —Ö–∞—Ä–¥–∫–æ–¥

#### 2. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —Ä–µ–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- **API Shield —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
  - Schema validation (JSON Schema, OpenAPI)
  - JWT validation
  - API key validation
  - Sequence analytics
  - Mutual TLS (mTLS)
  - GraphQL query protection
- **Challenge/CAPTCHA** - —Ç–æ–ª—å–∫–æ –∑–∞–≥–ª—É—à–∫–∞
- **Bot detection** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- **Anomaly detection** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- **Learning mode** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- **Custom response codes/headers** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- **Logging –≤ –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã** - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- **WAF chains** (–Ω–µ—Å–∫–æ–ª—å–∫–æ WAF –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ) - –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

#### 3. –£–ø—Ä–æ—â–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- **Rate limiting** - —Ç–æ–ª—å–∫–æ fixed window, –Ω–µ—Ç sliding window, token bucket
- **Geo-blocking** - –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω/IP
- **IP whitelist** - –Ω–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ CIDR
- **DDoS protection** - —Å–ª–∏—à–∫–æ–º —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞

#### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:
- **–ù–µ—Ç Connection Rules** –¥–ª—è WAF
- **–ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–ù–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ WAF –ø–µ—Ä–µ–¥ API Gateway** (—Ç–∏–ø–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π)

---

## üéØ –¶–µ–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. **–£–±—Ä–∞—Ç—å –≤–µ—Å—å —Ö–∞—Ä–¥–∫–æ–¥** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–∏—Å—Ç–µ–º—ã
2. **–î–æ–±–∞–≤–∏—Ç—å API Shield —Ñ—É–Ω–∫—Ü–∏–∏** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ Cloudflare API Shield
3. **–£–ª—É—á—à–∏—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é** - –±–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —É–≥—Ä–æ–∑
4. **–î–æ–±–∞–≤–∏—Ç—å Connection Rules** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è—Ö
5. **–†–∞—Å—à–∏—Ä–∏—Ç—å OWASP –ø—Ä–∞–≤–∏–ª–∞** - –±–æ–ª—å—à–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏ –ø—Ä–∞–≤–∏–ª
6. **–£–ª—É—á—à–∏—Ç—å rate limiting** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
7. **–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - bot detection, anomaly detection, challenge

---

## üìö –ò–∑—É—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è:

1. **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã:**
   - `src/core/EmulationEngine.ts` - –∫–∞–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –¥–≤–∏–∂–∫–∏ (—Å—Ç—Ä–æ–∫–∏ 776-790, 1102-1118, 10124-10130)
   - `src/core/DataFlowEngine.ts` - –∫–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö (—Å—Ç—Ä–æ–∫–∏ 6237-6323)
   - `src/services/connection/ServiceDiscovery.ts` - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–º–µ–Ω/–ø–æ—Ä—Ç–æ–≤

2. **–ü–æ—Ö–æ–∂–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:**
   - `src/core/api-gateway/CloudAPIGatewayEmulationEngine.ts` - API key validation, rate limiting
   - `src/core/KongRoutingEngine.ts` - plugin —Å–∏—Å—Ç–µ–º–∞, key-auth
   - `src/core/ApigeeRoutingEngine.ts` - API key validation, rate limiting
   - `src/services/connection/rules/keycloakRules.ts` - –ø—Ä–∏–º–µ—Ä Connection Rules

3. **Connection Rules:**
   - `src/services/connection/rules/index.ts` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª
   - `src/services/connection/types.ts` - —Ç–∏–ø—ã –ø—Ä–∞–≤–∏–ª

4. **–†–µ–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ WAF:**
   - –ò–∑—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Cloudflare WAF/API Shield
   - –ò–∑—É—á–∏—Ç—å AWS WAF capabilities
   - –ò–∑—É—á–∏—Ç—å ModSecurity Core Rule Set

---

## üèóÔ∏è –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ö–∞—Ä–¥–∫–æ–¥–∞ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô)

#### 1.1 –£–±—Ä–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–ª—É—á–∞–π–Ω—ã—Ö IP
**–ü—Ä–æ–±–ª–µ–º–∞**: `generateRandomIP()` —Å–æ–∑–¥–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ IP –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ**:
- –£–±—Ä–∞—Ç—å `generateRandomIP()` –∏–∑ `WAFEmulationEngine.ts`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sourceIP` –∏–∑ `DataMessage.metadata` –∏–ª–∏ `message.payload`
- –ï—Å–ª–∏ IP –Ω–µ—Ç –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IP –∏–∑ `ConnectionMetadata` (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
- –ï—Å–ª–∏ IP –≤—Å–µ –µ—â–µ –Ω–µ—Ç, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `'0.0.0.0'` –∫–∞–∫ fallback (–Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π)

**–§–∞–π–ª—ã**:
- `src/core/WAFEmulationEngine.ts` (—Å—Ç—Ä–æ–∫–∏ 296-298, 156-157)
- `src/core/WAFRoutingEngine.ts` (—Å—Ç—Ä–æ–∫–∞ 156)

#### 1.2 –£–±—Ä–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–ª—É—á–∞–π–Ω—ã—Ö —Å—Ç—Ä–∞–Ω
**–ü—Ä–æ–±–ª–µ–º–∞**: `generateRandomCountry()` —Å–æ–∑–¥–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã

**–†–µ—à–µ–Ω–∏–µ**:
- –£–±—Ä–∞—Ç—å `generateRandomCountry()` –∏–∑ `WAFEmulationEngine.ts`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `country` –∏–∑ `DataMessage.metadata` (–º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑ geo-IP lookup –≤ upstream –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö)
- –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `undefined` (–Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª—É—á–∞–π–Ω—É—é)
- Geo-blocking –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∞ —Ä–µ–∞–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞

**–§–∞–π–ª—ã**:
- `src/core/WAFEmulationEngine.ts` (—Å—Ç—Ä–æ–∫–∏ 303-306, 157-158)

#### 1.3 –£–ª—É—á—à–∏—Ç—å —Å–∏–º—É–ª—è—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞**: `generateRandomRequest()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏ –∏ 5% –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ—à–µ–Ω–∏–µ**:
- –£–±—Ä–∞—Ç—å `generateRandomRequest()` –∏–ª–∏ —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º
- –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏–∑ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ï—Å–ª–∏ –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∏–∑ upstream –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏
- –£–≥—Ä–æ–∑—ã –¥–æ–ª–∂–Ω—ã –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö, –∞ –Ω–µ —Å–ª—É—á–∞–π–Ω–æ

**–§–∞–π–ª—ã**:
- `src/core/WAFEmulationEngine.ts` (—Å—Ç—Ä–æ–∫–∏ 239-291, 210-234)
- `src/core/EmulationEngine.ts` (—Å—Ç—Ä–æ–∫–∏ 7217-7235)

#### 1.4 –£–±—Ä–∞—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏ –∏ –º–µ—Ç–æ–¥—ã
**–ü—Ä–æ–±–ª–µ–º–∞**: –•–∞—Ä–¥–∫–æ–¥ –ø—É—Ç–µ–π `['/api/users', '/api/products', ...]`

**–†–µ—à–µ–Ω–∏–µ**:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –ø—É—Ç–∏ –∏–∑ `DataMessage.metadata.path` –∏–ª–∏ `message.payload.path`
- –ï—Å–ª–∏ –ø—É—Ç—å –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `'/'` –∫–∞–∫ fallback
- –ú–µ—Ç–æ–¥—ã –±—Ä–∞—Ç—å –∏–∑ `message.metadata.method` –∏–ª–∏ `message.payload.method`

**–§–∞–π–ª—ã**:
- `src/core/WAFEmulationEngine.ts` (—Å—Ç—Ä–æ–∫–∞ 249)

---

### –≠—Ç–∞–ø 2: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ OWASP –ø—Ä–∞–≤–∏–ª (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô)

#### 2.1 –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ SQL Injection
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –¢–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è:
  - UNION-based SQL injection
  - Boolean-based blind SQL injection
  - Time-based blind SQL injection
  - Error-based SQL injection
  - Second-order SQL injection
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –∏–∑ OWASP ModSecurity CRS

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (—Å—Ç—Ä–æ–∫–∏ 456-477)

**–†–µ—Å—É—Ä—Å—ã**:
- OWASP ModSecurity Core Rule Set: https://github.com/coreruleset/coreruleset
- SQL Injection patterns: https://owasp.org/www-community/attacks/SQL_Injection

#### 2.2 –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ XSS
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –¢–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è:
  - Stored XSS
  - Reflected XSS
  - DOM-based XSS
  - Event handler injection
  - CSS injection
- –†–∞—Å—à–∏—Ä–∏—Ç—å —Å–ø–∏—Å–æ–∫ –æ–ø–∞—Å–Ω—ã—Ö —Ç–µ–≥–æ–≤ –∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (—Å—Ç—Ä–æ–∫–∏ 479-498)

#### 2.3 –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –¥—Ä—É–≥–∏—Ö –∞—Ç–∞–∫
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –¢–æ–ª—å–∫–æ SQL injection, XSS, path traversal, RCE

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è:
  - CSRF (Cross-Site Request Forgery)
  - SSRF (Server-Side Request Forgery)
  - XXE (XML External Entity)
  - Command injection
  - LDAP injection
  - NoSQL injection
  - Template injection

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (–º–µ—Ç–æ–¥ `checkOWASPRules`)

---

### –≠—Ç–∞–ø 3: –£–ª—É—á—à–µ–Ω–∏–µ Rate Limiting (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–†–ï–î–ù–ò–ô)

#### 3.1 –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –¢–æ–ª—å–∫–æ fixed window

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ rate limiting:
  - `fixed-window` (—Ç–µ–∫—É—â–∞—è)
  - `sliding-window` (–±–æ–ª–µ–µ —Ç–æ—á–Ω–∞—è)
  - `token-bucket` (–±–æ–ª–µ–µ –≥–∏–±–∫–∞—è)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –æ—Ç–¥–µ–ª—å–Ω–æ

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (–º–µ—Ç–æ–¥ `checkRateLimit`, —Å—Ç—Ä–æ–∫–∏ 541-569)
- `src/components/config/security/profiles.ts` (–¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `rateLimitStrategy`)
- `src/components/config/security/WAFConfigAdvanced.tsx` (–¥–æ–±–∞–≤–∏—Ç—å UI –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏)

**–¢–∏–ø—ã**:
```typescript
interface WAFConfig {
  // ... existing fields
  rateLimitStrategy?: 'fixed-window' | 'sliding-window' | 'token-bucket';
  rateLimitBurst?: number; // –¥–ª—è token-bucket
}
```

#### 3.2 –î–æ–±–∞–≤–∏—Ç—å per-API/endpoint rate limiting
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –¢–æ–ª—å–∫–æ –≥–ª–æ–±–∞–ª—å–Ω—ã–π rate limit

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é rate limits –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—É—Ç–µ–π/API
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö endpoints

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts`
- `src/components/config/security/WAFConfigAdvanced.tsx`

---

### –≠—Ç–∞–ø 4: –£–ª—É—á—à–µ–Ω–∏–µ Geo-blocking (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–†–ï–î–ù–ò–ô)

#### 4.1 –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É CIDR –¥–ª—è IP –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –¢–æ–ª—å–∫–æ –æ—Ç–¥–µ–ª—å–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É CIDR –Ω–æ—Ç–∞—Ü–∏–∏ –≤ IP whitelist/blacklist
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ IP –≤ CIDR (–∏–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –ø—Ä–æ–≤–µ—Ä–∫—É)

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts`
- `src/components/config/security/WAFConfigAdvanced.tsx`

**–ü—Ä–∏–º–µ—Ä**:
```typescript
// –î–æ–±–∞–≤–∏—Ç—å –≤ WAFConfig
ipBlacklist?: string[]; // –ü–æ–¥–¥–µ—Ä–∂–∫–∞ CIDR: ['192.168.1.0/24', '10.0.0.1']
```

#### 4.2 –£–ª—É—á—à–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã
**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ**: –°—Ç—Ä–∞–Ω–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ**:
- –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IP-to-country lookup (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –ù–æ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω—É –∏–∑ upstream –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (CDN, Load Balancer)

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (–º–µ—Ç–æ–¥ `processRequest`)

---

### –≠—Ç–∞–ø 5: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ API Shield —Ñ—É–Ω–∫—Ü–∏–π (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô)

#### 5.1 Schema Validation
**–û–ø–∏—Å–∞–Ω–∏–µ**: –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ JSON Schema –∏–ª–∏ OpenAPI —Å—Ö–µ–º–µ

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è —Å—Ö–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
  ```typescript
  interface SchemaValidationConfig {
    enabled: boolean;
    schemaType: 'json-schema' | 'openapi';
    schema: string; // JSON Schema –∏–ª–∏ OpenAPI spec
    validateRequest: boolean;
    validateResponse: boolean;
  }
  ```
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ `WAFRoutingEngine.processRequest()`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ajv –¥–ª—è JSON Schema)

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (–¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `validateSchema`)
- `src/components/config/security/WAFConfigAdvanced.tsx` (–¥–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É "Schema Validation")
- `src/components/config/security/profiles.ts` (–¥–æ–±–∞–≤–∏—Ç—å –≤ WAF profile)

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**:
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ—Å–ª–µ IP whitelist, –Ω–æ –¥–æ OWASP –ø—Ä–∞–≤–∏–ª
- –ï—Å–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç, –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å —Å –æ—à–∏–±–∫–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏

#### 5.2 JWT Validation
**–û–ø–∏—Å–∞–Ω–∏–µ**: –í–∞–ª–∏–¥–∞—Ü–∏—è JWT —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
  ```typescript
  interface JWTValidationConfig {
    enabled: boolean;
    secret?: string; // –¥–ª—è HMAC
    publicKey?: string; // –¥–ª—è RSA
    algorithm?: 'HS256' | 'RS256' | 'ES256';
    issuer?: string;
    audience?: string[];
    requireExpiration?: boolean;
  }
  ```
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é JWT (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É –∏–ª–∏ —É–ø—Ä–æ—â–µ–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é)
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (–¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `validateJWT`)
- `src/components/config/security/WAFConfigAdvanced.tsx` (–¥–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É "JWT Validation")

#### 5.3 API Key Validation
**–û–ø–∏—Å–∞–Ω–∏–µ**: –í–∞–ª–∏–¥–∞—Ü–∏—è API –∫–ª—é—á–µ–π (–∫–∞–∫ –≤ API Gateway)

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é API –∫–ª—é—á–µ–π:
  ```typescript
  interface APIKeyConfig {
    enabled: boolean;
    keys: Array<{
      id: string;
      key: string;
      enabled: boolean;
      allowedPaths?: string[]; // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø—É—Ç–µ–π
      rateLimit?: number; // Per-key rate limit
    }>;
    headerName?: string; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 'X-API-Key'
  }
  ```
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É API –∫–ª—é—á–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –∏–ª–∏ query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å rate limiting (per-key limits)

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (–¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `validateAPIKey`)
- `src/components/config/security/WAFConfigAdvanced.tsx` (–¥–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É "API Keys")
- –ò–∑—É—á–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ `src/core/api-gateway/CloudAPIGatewayEmulationEngine.ts`

#### 5.4 GraphQL Query Protection
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª–æ–∂–Ω—ã—Ö/–æ–ø–∞—Å–Ω—ã—Ö GraphQL –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
  ```typescript
  interface GraphQLProtectionConfig {
    enabled: boolean;
    maxDepth?: number; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞
    maxComplexity?: number; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å
    maxAliases?: number; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–ª–∏–∞—Å–æ–≤
    blockIntrospection?: boolean; // –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å introspection –∑–∞–ø—Ä–æ—Å—ã
  }
  ```
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ GraphQL –∑–∞–ø—Ä–æ—Å–æ–≤ (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–π)
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –≥–ª—É–±–∏–Ω—É, —Å–ª–æ–∂–Ω–æ—Å—Ç—å, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–µ–π

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (–¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `validateGraphQL`)
- `src/components/config/security/WAFConfigAdvanced.tsx` (–¥–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É "GraphQL Protection")

---

### –≠—Ç–∞–ø 6: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–†–ï–î–ù–ò–ô)

#### 6.1 Bot Detection
**–û–ø–∏—Å–∞–Ω–∏–µ**: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –±–æ—Ç–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
  ```typescript
  interface BotDetectionConfig {
    enabled: boolean;
    methods: Array<'user-agent' | 'behavioral' | 'fingerprint'>;
    blockKnownBots?: boolean; // –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –±–æ—Ç–æ–≤ (Googlebot, etc.)
    challengeSuspicious?: boolean; // –í—ã–¥–∞–≤–∞—Ç—å challenge –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º
  }
  ```
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –ø—Ä–æ–≤–µ—Ä–∫—É user-agent –Ω–∞ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –±–æ—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã (—Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ cookies)

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (–¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `detectBot`)
- `src/components/config/security/WAFConfigAdvanced.tsx` (–¥–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫—É "Bot Detection")

#### 6.2 Anomaly Detection
**–û–ø–∏—Å–∞–Ω–∏–µ**: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π –≤ —Ç—Ä–∞—Ñ–∏–∫–µ

**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π:
  - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ RPS –ø–æ IP
  - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ä–µ–∑–∫–∏—Ö —Å–∫–∞—á–∫–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞
  - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–µ–æ–±—ã—á–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Å—Ç—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã (moving average, threshold)

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (–¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `detectAnomaly`)
- `src/core/WAFEmulationEngine.ts` (–¥–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏)

#### 6.3 Challenge/CAPTCHA
**–û–ø–∏—Å–∞–Ω–∏–µ**: –í—ã–¥–∞—á–∞ challenge –≤–º–µ—Å—Ç–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

**–†–µ—à–µ–Ω–∏–µ**:
- –£–ª—É—á—à–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–≥–ª—É—à–∫—É `action: 'challenge'`
- –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ç–∏–ø–æ–≤ challenge:
  ```typescript
  interface ChallengeConfig {
    enabled: boolean;
    type: 'captcha' | 'js-challenge' | 'cookie-challenge';
    challengeOnSuspicious?: boolean; // Challenge –≤–º–µ—Å—Ç–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  }
  ```
- –í —Ä–µ–∂–∏–º–µ challenge –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏

**–§–∞–π–ª—ã**:
- `src/core/WAFRoutingEngine.ts` (—É–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É `action: 'challenge'`)
- `src/components/config/security/WAFConfigAdvanced.tsx` (–¥–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ challenge)

---

### –≠—Ç–∞–ø 7: Connection Rules –¥–ª—è WAF (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô)

#### 7.1 –°–æ–∑–¥–∞—Ç—å Connection Rules
**–û–ø–∏—Å–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ WAF –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ**:
- –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `src/services/connection/rules/wafRules.ts`
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è:
  - **API Gateway ‚Üí WAF ‚Üí Backend**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å WAF –¥–ª—è –∑–∞—â–∏—Ç—ã API
  - **Load Balancer ‚Üí WAF ‚Üí Backend**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å WAF –ø–µ—Ä–µ–¥ backend
  - **CDN ‚Üí WAF ‚Üí Origin**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å WAF –¥–ª—è –∑–∞—â–∏—Ç—ã origin —Å–µ—Ä–≤–µ—Ä–∞

**–§–∞–π–ª—ã**:
- `src/services/connection/rules/wafRules.ts` (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
- `src/services/connection/rules/index.ts` (–¥–æ–±–∞–≤–∏—Ç—å `createWAFRule`)

**–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã**:
```typescript
export function createWAFRule(discovery: ServiceDiscovery): ConnectionRule {
  return {
    sourceType: '*', // WAF –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –æ—Ç –ª—é–±—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    targetTypes: ['*'], // WAF –º–æ–∂–µ—Ç –∑–∞—â–∏—â–∞—Ç—å –ª—é–±—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    priority: 5,
    
    updateSourceConfig: (source, waf, connection, metadata) => {
      // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, API Gateway) –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å WAF
      // –ú–æ–∂–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å WAF URL –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
    },
    
    updateTargetConfig: (waf, target, connection, metadata) => {
      // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WAF –¥–ª—è –∑–∞—â–∏—Ç—ã —Ü–µ–ª–µ–≤–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
      // –ú–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã API endpoints
    },
  };
}
```

**–°—Ü–µ–Ω–∞—Ä–∏–∏**:
1. **API Gateway ‚Üí WAF ‚Üí REST API**:
   - WAF –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å endpoints –∏–∑ API Gateway
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã —ç—Ç–∏—Ö endpoints

2. **Load Balancer ‚Üí WAF ‚Üí Backend**:
   - WAF –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å backend —Å–µ—Ä–≤–µ—Ä—ã
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∑–∞—â–∏—Ç—ã backend

#### 7.2 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º—É –ø—Ä–∞–≤–∏–ª
**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å `createWAFRule(discovery)` –≤ `src/services/connection/rules/index.ts`
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–≤—è–∑–µ–π

**–§–∞–π–ª—ã**:
- `src/services/connection/rules/index.ts`

---

### –≠—Ç–∞–ø 8: –£–ª—É—á—à–µ–Ω–∏–µ UI (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–†–ï–î–ù–ò–ô)

#### 8.1 –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫–∏ –≤ `WAFConfigAdvanced.tsx`:
  - "Schema Validation"
  - "JWT Validation"
  - "API Keys"
  - "GraphQL Protection"
  - "Bot Detection"
  - "Anomaly Detection"
  - "Challenge Settings"

**–§–∞–π–ª—ã**:
- `src/components/config/security/WAFConfigAdvanced.tsx`

#### 8.2 –£–ª—É—á—à–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è:
  - Requests over time
  - Threats by type
  - Block rate over time
  - Top blocked IPs
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Recharts (–∫–∞–∫ –≤ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö)

**–§–∞–π–ª—ã**:
- `src/components/config/security/WAFConfigAdvanced.tsx`

#### 8.3 –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤
**–†–µ—à–µ–Ω–∏–µ**:
- –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —ç–∫—Å–ø–æ—Ä—Ç–∞ —É–≥—Ä–æ–∑ –≤ JSON/CSV
- –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–§–∞–π–ª—ã**:
- `src/components/config/security/WAFConfigAdvanced.tsx`

---

### –≠—Ç–∞–ø 9: –£–ª—É—á—à–µ–Ω–∏–µ —Å–∏–º—É–ª—è—Ü–∏–∏ –º–µ—Ç—Ä–∏–∫ (–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ù–ò–ó–ö–ò–ô)

#### 9.1 –ë–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
**–†–µ—à–µ–Ω–∏–µ**:
- –£–ª—É—á—à–∏—Ç—å —Ä–∞—Å—á–µ—Ç latency –Ω–∞ –æ—Å–Ω–æ–≤–µ:
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª
  - –°–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫ (OWASP, schema validation)
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—Å–ª–æ–≤–∏–π –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª–∏ (p50, p99) –¥–ª—è latency

**–§–∞–π–ª—ã**:
- `src/core/WAFEmulationEngine.ts` (–º–µ—Ç–æ–¥ `calculateLoad`)
- `src/core/EmulationEngine.ts` (–º–µ—Ç–æ–¥ `simulateWAF`)

#### 9.2 –£–ª—É—á—à–∏—Ç—å utilization —Ä–∞—Å—á–µ—Ç
**–†–µ—à–µ–Ω–∏–µ**:
- –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç utilization –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏
- –£—á–∏—Ç—ã–≤–∞—Ç—å –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏: OWASP, schema, JWT, rate limiting, etc.

**–§–∞–π–ª—ã**:
- `src/core/EmulationEngine.ts` (–º–µ—Ç–æ–¥ `simulateWAF`, —Å—Ç—Ä–æ–∫–∏ 7190-7197)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ WAFRoutingEngine.ts          # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ (—Ä–∞—Å—à–∏—Ä–∏—Ç—å)
‚îÇ   ‚îú‚îÄ‚îÄ WAFEmulationEngine.ts         # –ú–µ—Ç—Ä–∏–∫–∏ (—É–ª—É—á—à–∏—Ç—å)
‚îÇ   ‚îî‚îÄ‚îÄ WAFTypes.ts                   # –¢–∏–ø—ã (–Ω–æ–≤—ã–π —Ñ–∞–π–ª, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îî‚îÄ‚îÄ config/
‚îÇ       ‚îî‚îÄ‚îÄ security/
‚îÇ           ‚îú‚îÄ‚îÄ WAFConfigAdvanced.tsx # UI (—Ä–∞—Å—à–∏—Ä–∏—Ç—å)
‚îÇ           ‚îî‚îÄ‚îÄ profiles.ts           # –ü—Ä–æ—Ñ–∏–ª–∏ (—Ä–∞—Å—à–∏—Ä–∏—Ç—å)
‚îî‚îÄ‚îÄ services/
    ‚îî‚îÄ‚îÄ connection/
        ‚îî‚îÄ‚îÄ rules/
            ‚îî‚îÄ‚îÄ wafRules.ts           # Connection Rules (–Ω–æ–≤—ã–π)
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã)**:
- `ajv` –∏–ª–∏ `zod` - –¥–ª—è JSON Schema validation (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `jsonwebtoken` –∏–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è - –¥–ª—è JWT validation (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–∞—á–∞—Ç—å —Å —É–ø—Ä–æ—â–µ–Ω–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –∑–∞—Ç–µ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–æ–±–∞–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

---

## üìù –ß–µ–∫–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ö–∞—Ä–¥–∫–æ–¥–∞ ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
- [x] –£–±—Ä–∞—Ç—å `generateRandomIP()` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IP –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π
- [x] –£–±—Ä–∞—Ç—å `generateRandomCountry()` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω—É –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π
- [x] –£–ª—É—á—à–∏—Ç—å `generateRandomRequest()` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (—É–¥–∞–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫)
- [x] –£–±—Ä–∞—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É—Ç–∏ –∏ –º–µ—Ç–æ–¥—ã

**–°—Ç–∞—Ç—É—Å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ. –í—Å–µ —Ö–∞—Ä–¥–∫–æ–¥ —É–±—Ä–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π.

### –≠—Ç–∞–ø 2: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ OWASP –ø—Ä–∞–≤–∏–ª ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
- [x] –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ SQL Injection (UNION-based, Boolean-based, Time-based, Error-based, Second-order)
- [x] –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ XSS (Stored, Reflected, DOM-based, Event handler, CSS injection)
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è CSRF, SSRF, XXE, Command injection, LDAP injection, NoSQL injection, Template injection

**–°—Ç–∞—Ç—É—Å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ. –î–æ–±–∞–≤–ª–µ–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∞—Ç–∞–∫.

### –≠—Ç–∞–ø 3: –£–ª—É—á—à–µ–Ω–∏–µ Rate Limiting ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É sliding-window
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É token-bucket
- [ ] –î–æ–±–∞–≤–∏—Ç—å per-endpoint rate limiting (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ)

**–°—Ç–∞—Ç—É—Å**: –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã. Per-endpoint rate limiting –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

### –≠—Ç–∞–ø 4: –£–ª—É—á—à–µ–Ω–∏–µ Geo-blocking ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É CIDR –¥–ª—è IP –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- [x] –£–ª—É—á—à–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π, –±–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏)

**–°—Ç–∞—Ç—É—Å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ CIDR –¥–ª—è whitelist –∏ blacklist.

### –≠—Ç–∞–ø 5: API Shield —Ñ—É–Ω–∫—Ü–∏–∏ ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Schema Validation (–±–∞–∑–æ–≤–∞—è JSON Schema –≤–∞–ª–∏–¥–∞—Ü–∏—è)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å JWT Validation (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, expiration, issuer, audience)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å API Key Validation (—Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π per-key rate limits –∏ allowed paths)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å GraphQL Query Protection (depth, complexity, aliases, introspection blocking)

**–°—Ç–∞—Ç—É—Å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ. –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ API Shield —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã.

### –≠—Ç–∞–ø 6: –†–µ–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Bot Detection (user-agent, behavioral detection)
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Anomaly Detection (—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π)
- [x] –£–ª—É—á—à–∏—Ç—å Challenge/CAPTCHA (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ challenge action –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö)

**–°—Ç–∞—Ç—É—Å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ. Bot Detection –∏ Anomaly Detection —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã.

### –≠—Ç–∞–ø 7: Connection Rules ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
- [x] –°–æ–∑–¥–∞—Ç—å `wafRules.ts`
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è API Gateway ‚Üí WAF ‚Üí Backend
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è Load Balancer ‚Üí WAF ‚Üí Backend
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è CDN ‚Üí WAF ‚Üí Origin
- [x] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Å–∏—Å—Ç–µ–º—É –ø—Ä–∞–≤–∏–ª

**–°—Ç–∞—Ç—É—Å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ. Connection Rules —Å–æ–∑–¥–∞–Ω—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã.

### –≠—Ç–∞–ø 8: –£–ª—É—á—à–µ–Ω–∏–µ UI ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
- [x] –î–æ–±–∞–≤–∏—Ç—å –≤–∫–ª–∞–¥–∫–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (Schema Validation, JWT, API Keys, GraphQL, Bot Detection, Anomaly Detection)
- [x] –£–ª—É—á—à–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ (—É–∂–µ –µ—Å—Ç—å –≤ —Ç–µ–∫—É—â–µ–º UI)
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É rateLimitStrategy –≤ Rate Limiting –≤–∫–ª–∞–¥–∫–µ
- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É IP Blacklist –≤ Settings
- [ ] –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ)

**–°—Ç–∞—Ç—É—Å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ. –í—Å–µ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–º–µ—é—Ç —Å–≤–æ–∏ –≤–∫–ª–∞–¥–∫–∏ –≤ UI —Å –ø–æ–ª–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π.

### –≠—Ç–∞–ø 9: –£–ª—É—á—à–µ–Ω–∏–µ —Å–∏–º—É–ª—è—Ü–∏–∏ ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
- [x] –ë–æ–ª–µ–µ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (—É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ latency)
- [x] –£–ª—É—á—à–∏—Ç—å utilization —Ä–∞—Å—á–µ—Ç (—É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏: Schema, JWT, API Key, GraphQL, Bot Detection, Anomaly Detection, DDoS)

**–°—Ç–∞—Ç—É—Å**: –ü–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ. Utilization —Ç–µ–ø–µ—Ä—å —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ WAF –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –Ω–∞–≥—Ä—É–∑–∫–∏.

---

## üöÄ –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫** (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º):

1. **–≠—Ç–∞–ø 1** (–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ö–∞—Ä–¥–∫–æ–¥–∞) - **–°–ù–ê–ß–ê–õ–ê –≠–¢–û**
2. **–≠—Ç–∞–ø 7** (Connection Rules) - –≤–∞–∂–Ω–æ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
3. **–≠—Ç–∞–ø 2** (–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ OWASP) - —É–ª—É—á—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –∑–∞—â–∏—Ç—ã
4. **–≠—Ç–∞–ø 5** (API Shield —Ñ—É–Ω–∫—Ü–∏–∏) - –∫–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
5. **–≠—Ç–∞–ø 3** (Rate Limiting) - —É–ª—É—á—à–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ
6. **–≠—Ç–∞–ø 4** (Geo-blocking) - —É–ª—É—á—à–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ
7. **–≠—Ç–∞–ø 6** (–†–µ–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏) - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
8. **–≠—Ç–∞–ø 8** (UI) - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å –¥—Ä—É–≥–∏–º–∏ —ç—Ç–∞–ø–∞–º–∏
9. **–≠—Ç–∞–ø 9** (–°–∏–º—É–ª—è—Ü–∏—è) - —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

---

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è

### –†–µ–∞–ª—å–Ω—ã–µ WAF —Ä–µ—à–µ–Ω–∏—è:
1. **Cloudflare WAF**: https://developers.cloudflare.com/waf/
2. **Cloudflare API Shield**: https://developers.cloudflare.com/api-shield/
3. **AWS WAF**: https://docs.aws.amazon.com/waf/
4. **ModSecurity**: https://github.com/owasp-modsecurity/ModSecurity
5. **OWASP ModSecurity CRS**: https://github.com/coreruleset/coreruleset

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏:
- OWASP Top 10: https://owasp.org/www-project-top-ten/
- SQL Injection: https://owasp.org/www-community/attacks/SQL_Injection
- XSS: https://owasp.org/www-community/attacks/xss/
- Rate Limiting: https://cloud.google.com/architecture/rate-limiting-strategies-techniques

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ò–∑–±–µ–≥–∞—Ç—å —Ö–∞—Ä–¥–∫–æ–¥–∞**: –í—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–∏—Å—Ç–µ–º—ã (—Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ)

2. **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏**: –ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–º WAF —Ä–µ—à–µ–Ω–∏—è–º

3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: WAF –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –±—ã—Å—Ç—Ä–æ, –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

4. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ —Ñ—É–Ω–∫—Ü–∏–∏

5. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å EmulationEngine –∏ DataFlowEngine

6. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: WAF —Å–∞–º –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º (–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫)

---

## üîÑ –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –≤ –¥—Ä—É–≥–æ–º —á–∞—Ç–µ

–ï—Å–ª–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –≤ –¥—Ä—É–≥–æ–º —á–∞—Ç–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –ø–ª–∞–Ω:

1. **–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é**
2. **–ò–∑—É—á–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã** (—Ä–∞–∑–¥–µ–ª "–ò–∑—É—á–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º")
3. **–í—ã–±–µ—Ä–∏—Ç–µ —ç—Ç–∞–ø** –∏–∑ —á–µ–∫–ª–∏—Å—Ç–∞
4. **–°–ª–µ–¥—É–π—Ç–µ –ø–æ—Ä—è–¥–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** (—Ä–∞–∑–¥–µ–ª "–ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è")
5. **–û—Ç–º–µ—á–∞–π—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø—É–Ω–∫—Ç—ã** –≤ —á–µ–∫–ª–∏—Å—Ç–µ
6. **–û–±–Ω–æ–≤–ª—è–π—Ç–µ —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç** –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

**–í–∞–∂–Ω–æ**: –ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É (–∫—Ä–æ–º–µ UI, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ).

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω:

- ‚úÖ **–ù–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ö–∞—Ä–¥–∫–æ–¥–∞** - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–∏—Å—Ç–µ–º—ã
- ‚úÖ **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–º WAF** - ~90-95% —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ Cloudflare WAF/API Shield
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è** - Connection Rules —Ä–∞–±–æ—Ç–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è** - –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ WAF
- ‚úÖ **–•–æ—Ä–æ—à–∏–π UI/UX** - –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –ø–æ–Ω—è—Ç–Ω—ã
- ‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö, –±—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2026-01-26  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–µ–Ω–æ (–≤–µ—Ä—Å–∏—è 0.1.8y)

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: 2026-01-26  
**–í–µ—Ä—Å–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**: 0.1.8y

## ‚úÖ –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–≤–µ—Ä—Å–∏—è 0.1.8y)

### ‚úÖ –í–°–ï –û–°–ù–û–í–ù–´–ï –≠–¢–ê–ü–´ –í–´–ü–û–õ–ù–ï–ù–´

**–í—ã–ø–æ–ª–Ω–µ–Ω–æ (100% –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–¥–∞—á)**:
- ‚úÖ **–≠—Ç–∞–ø 1: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ö–∞—Ä–¥–∫–æ–¥–∞** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
  - –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (generateRandomIP, generateRandomCountry, generateRandomRequest)
  - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–∏—Å—Ç–µ–º—ã
  - –§–∞–π–ª—ã: `src/core/WAFEmulationEngine.ts`, `src/core/WAFRoutingEngine.ts`

- ‚úÖ **–≠—Ç–∞–ø 2: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ OWASP –ø—Ä–∞–≤–∏–ª** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è SQL Injection (UNION-based, Boolean-based, Time-based, Error-based, Second-order)
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è XSS (Stored, Reflected, DOM-based, Event handler, CSS injection)
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è CSRF, SSRF, XXE, Command Injection, LDAP Injection, NoSQL Injection, Template Injection
  - –§–∞–π–ª—ã: `src/core/WAFRoutingEngine.ts` (–º–µ—Ç–æ–¥ `checkOWASPRules`)

- ‚úÖ **–≠—Ç–∞–ø 3: –£–ª—É—á—à–µ–Ω–∏–µ Rate Limiting** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏: fixed-window, sliding-window, token-bucket
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `rateLimitStrategy` –∏ `rateLimitBurst`
  - –§–∞–π–ª—ã: `src/core/WAFRoutingEngine.ts` (–º–µ—Ç–æ–¥—ã `checkFixedWindowRateLimit`, `checkSlidingWindowRateLimit`, `checkTokenBucketRateLimit`)

- ‚úÖ **–≠—Ç–∞–ø 4: –£–ª—É—á—à–µ–Ω–∏–µ Geo-blocking** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ CIDR –Ω–æ—Ç–∞—Ü–∏–∏ –¥–ª—è IP whitelist –∏ blacklist
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –º–µ—Ç–æ–¥—ã `isIPInList()` –∏ `isIPInCIDR()`
  - –§–∞–π–ª—ã: `src/core/WAFRoutingEngine.ts`

- ‚úÖ **–≠—Ç–∞–ø 5: API Shield —Ñ—É–Ω–∫—Ü–∏–∏** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
  - Schema Validation: –±–∞–∑–æ–≤–∞—è JSON Schema –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
  - JWT Validation: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã, expiration, issuer, audience
  - API Key Validation: —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π per-key rate limits –∏ allowed paths
  - GraphQL Query Protection: depth, complexity, aliases, introspection blocking
  - –§–∞–π–ª—ã: `src/core/WAFRoutingEngine.ts` (–º–µ—Ç–æ–¥—ã `validateSchema`, `validateJWT`, `validateAPIKey`, `validateGraphQL`)

- ‚úÖ **–≠—Ç–∞–ø 6: –†–µ–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
  - Bot Detection: user-agent –∏ behavioral detection
  - Anomaly Detection: —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π (moving average, threshold)
  - Challenge/CAPTCHA: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ challenge action –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö
  - –§–∞–π–ª—ã: `src/core/WAFRoutingEngine.ts` (–º–µ—Ç–æ–¥—ã `detectBot`, `detectAnomaly`)

- ‚úÖ **–≠—Ç–∞–ø 7: Connection Rules** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
  - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `src/services/connection/rules/wafRules.ts`
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è API Gateway ‚Üí WAF ‚Üí Backend
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è Load Balancer ‚Üí WAF ‚Üí Backend
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è CDN ‚Üí WAF ‚Üí Origin
  - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ `src/services/connection/rules/index.ts`

- ‚úÖ **–≠—Ç–∞–ø 8: –£–ª—É—á—à–µ–Ω–∏–µ UI** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –≤–∫–ª–∞–¥–∫–∏: Schema Validation, JWT Validation, API Keys, GraphQL Protection, Bot Detection, Anomaly Detection
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `rateLimitStrategy` –≤ Rate Limiting –≤–∫–ª–∞–¥–∫–µ
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ IP Blacklist –≤ Settings
  - –î–æ–±–∞–≤–ª–µ–Ω —ç–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ —É–≥—Ä–æ–∑ –≤ JSON/CSV (–≠—Ç–∞–ø 8.3)
  - –§–∞–π–ª—ã: `src/components/config/security/WAFConfigAdvanced.tsx`

- ‚úÖ **–≠—Ç–∞–ø 9: –£–ª—É—á—à–µ–Ω–∏–µ —Å–∏–º—É–ª—è—Ü–∏–∏** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
  - –£–ª—É—á—à–µ–Ω —Ä–∞—Å—á–µ—Ç latency —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
  - –£–ª—É—á—à–µ–Ω —Ä–∞—Å—á–µ—Ç utilization —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π (Schema, JWT, API Key, GraphQL, Bot Detection, Anomaly Detection, DDoS)
  - –§–∞–π–ª—ã: `src/core/WAFEmulationEngine.ts`, `src/core/EmulationEngine.ts`

### ‚ö†Ô∏è –û–°–¢–ê–õ–û–°–¨ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏)

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏**:
- ‚úÖ **–≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤ —É–≥—Ä–æ–∑ –≤ JSON/CSV** (–≠—Ç–∞–ø 8.3) - –í–´–ü–û–õ–ù–ï–ù–û
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–Ω–æ–ø–∫–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ WAF (–≤–∫–ª–∞–¥–∫–∞ Threats)
  - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —ç–∫—Å–ø–æ—Ä—Ç —Å–ø–∏—Å–∫–∞ —É–≥—Ä–æ–∑ –≤ JSON –∏ CSV —Ñ–æ—Ä–º–∞—Ç—ã
  - –§—É–Ω–∫—Ü–∏–∏: `exportThreatsToJSON()` –∏ `exportThreatsToCSV()`
  - –§–∞–π–ª—ã: `src/components/config/security/WAFConfigAdvanced.tsx`

- ‚ö†Ô∏è **Per-endpoint rate limiting** (–≠—Ç–∞–ø 3.2) - –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û
  - –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é rate limits –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—É—Ç–µ–π/API
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö endpoints
  - –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è: `src/core/WAFRoutingEngine.ts`, `src/components/config/security/WAFConfigAdvanced.tsx`
  - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ù–ò–ó–ö–ò–ô (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

### üìù –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

**–í–µ—Ä—Å–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**: 0.1.8y  
**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: 2026-01-26  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–í–°–ï –≠–¢–ê–ü–´ –ó–ê–í–ï–†–®–ï–ù–´ (–≤–∫–ª—é—á–∞—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ)**

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å WAF/API Shield –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –í—Å–µ 9 —ç—Ç–∞–ø–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω—ã, –≤–∫–ª—é—á–∞—è –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –∑–∞–¥–∞—á—É —ç–∫—Å–ø–æ—Ä—Ç–∞ –ª–æ–≥–æ–≤ —É–≥—Ä–æ–∑. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–º WAF —Ä–µ—à–µ–Ω–∏—è–º (Cloudflare WAF/API Shield, AWS WAF) –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞ - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å–∏—Å—Ç–µ–º—ã. –û—Å—Ç–∞–ª–∞—Å—å —Ç–æ–ª—å–∫–æ 1 –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ (per-endpoint rate limiting), –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö.

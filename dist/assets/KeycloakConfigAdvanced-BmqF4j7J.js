import{K as bs,u as ys,r as E,j as e,B as w,S as I,C as x,h as v,i as N,m as y,A as Cs,k as C,L as l,T as ce,b as de,c as f,a4 as oe,d as Pe,f as g,I as c,x as p,a5 as Te,l as o,P as D,af as me,ax as Le,y as $,bc as q,ai as Z,z,E as V,G,H as K,q as ee,s as se,t as ae,v as te,w as R,a6 as Ie,ae as ws,o as M,e as De}from"./index-HDGrDyRq.js";import{T as he}from"./textarea-CjQgIquO.js";import{u as Ss}from"./use-toast-XAAHaGVT.js";import{S as xe}from"./shield-DzL7mY-o.js";import{G as ks}from"./globe-CxWY8qo-.js";import{K as pe}from"./key-CMmIYHBN.js";import{U as je}from"./users-O29_gLR1.js";import{C as As}from"./clock-3yiD5iuE.js";import{L as Es}from"./lock-BhuwrGKI.js";import{M as Rs}from"./mail-B1SUtQcp.js";import{E as Me}from"./eye-off-c7WbQu-W.js";const Ps=[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]],Ts=bs("fingerprint",Ps);function Gs({componentId:B}){const{nodes:Ue,connections:Fe,updateNode:Oe}=ys(),T=Ue.find(s=>s.id===B),[$e,le]=E.useState(null),[qe,re]=E.useState(null),[Q,ze]=E.useState(""),[U,Ve]=E.useState("");if(!T)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const i=T.data.config||{},ue=i.realm||"archiphoenix",Ge=i.adminUrl||"http://keycloak:8080",ve=i.enabled??!0,Ne=Fe.some(s=>s.source===B||s.target===B),ie=ve&&Ne,fe=i.enableSSL??!1,Ke=i.sslRequired||"external",_e=i.accessTokenLifespan||300,He=i.ssoSessionIdle||1800,Be=i.ssoSessionMax||36e3,Qe=i.refreshTokenLifespan||1800,Je=i.enableOAuth2??!0,We=i.enableSAML??!1,Xe=i.enableLDAP??!1,Ye=i.passwordPolicy||"length(8)",S=i.clients||[{id:"archiphoenix-app",name:"ArchiPhoenix App",clientId:"archiphoenix-app",type:"public",enabled:!0,protocol:"openid-connect",redirectUris:["http://localhost:3000/*"],webOrigins:["http://localhost:3000"],grantTypes:["authorization_code","refresh_token"],standardFlowEnabled:!0,directAccessGrantsEnabled:!1},{id:"admin-cli",name:"Admin CLI",clientId:"admin-cli",type:"public",enabled:!0,protocol:"openid-connect",grantTypes:["client_credentials"],serviceAccountsEnabled:!0}],j=i.users||[{id:"1",username:"admin",email:"admin@archiphoenix.com",firstName:"Admin",lastName:"User",enabled:!0,emailVerified:!0,roles:["admin","user"],groups:[],attributes:{}},{id:"2",username:"user1",email:"user1@archiphoenix.com",firstName:"John",lastName:"Doe",enabled:!0,emailVerified:!1,roles:["user"],groups:[],attributes:{}}],ge=i.authenticationFlows||[{id:"browser",alias:"browser",description:"Browser based authentication",providerId:"basic-flow",topLevel:!0,builtIn:!0,executions:[{id:"cookie",requirement:"ALTERNATIVE",displayName:"Cookie",configurable:!1,providerId:"auth-cookie"},{id:"identity-provider-redirector",requirement:"ALTERNATIVE",displayName:"Identity Provider Redirector",configurable:!0,providerId:"identity-provider-redirector"},{id:"forms",requirement:"ALTERNATIVE",displayName:"Forms",configurable:!1,providerId:"auth-username-password-form"}]},{id:"direct-grant",alias:"direct grant",description:"Direct grant authentication",providerId:"basic-flow",topLevel:!0,builtIn:!0,executions:[{id:"username-password",requirement:"REQUIRED",displayName:"Username Password Form",configurable:!1,providerId:"direct-grant-validate-username-password"}]}],_=i.identityProviders||[],H=i.clientScopes||[{id:"profile",name:"profile",protocol:"openid-connect",description:"OpenID Connect built-in scope: profile"},{id:"email",name:"email",protocol:"openid-connect",description:"OpenID Connect built-in scope: email"},{id:"roles",name:"roles",protocol:"openid-connect",description:"OpenID Connect scope for add user roles to the access token"}],J=i.realmRoles||["admin","user","viewer"],be=i.groups||[],{toast:A}=Ss(),[Ze,ye]=E.useState(0),[W,es]=E.useState({}),[F,Ce]=E.useState({}),[X,we]=E.useState({}),[Y,ss]=E.useState({}),[u,as]=E.useState(null),[m,P]=E.useState({});E.useEffect(()=>{const s=()=>{try{const r=De.getKeycloakEmulationEngine(T.id);if(r){const d=r.getMetrics(),h=r.calculateLoad();if(d){as({...d,...h}),ye(d.activeSessions||0);return}}}catch{}const a=j.filter(r=>r.enabled).length*2;ye(a)};s();const t=setInterval(s,1e3);return()=>clearInterval(t)},[T.id,j]);const ts=s=>!s||!s.trim()||/^(https?:\/\/)?([\w\-\.]+|\*)(:\d+)?(\/.*)?(\*)?$/.test(s.trim())?null:"Invalid redirect URI format. Use http:// or https:// with optional wildcards",Se=s=>!s||!s.trim()||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.trim())?null:"Invalid email format",ls=s=>!s||!s.trim()||/^([\w\-\.]+|\[[\w:\.]+\])$/.test(s.trim())?null:"Invalid SMTP host format",rs=s=>s<1||s>65535?"SMTP port must be between 1 and 65535":null,n=s=>{const t={...i,...s};Oe(B,{data:{...T.data,config:t}});try{const a=De.getKeycloakEmulationEngine(T.id);a&&a.initializeConfig({...T,data:{...T.data,config:t}})}catch{}},is=()=>{const s={id:`client-${Date.now()}`,name:"New Client",clientId:`new-client-${Date.now()}`,type:"public",enabled:!0,protocol:"openid-connect",redirectUris:[],webOrigins:[],grantTypes:["authorization_code"],standardFlowEnabled:!0,directAccessGrantsEnabled:!1,serviceAccountsEnabled:!1,authorizationServicesEnabled:!1,consentRequired:!1,protocolMappers:[],defaultClientScopes:["profile","email"],optionalClientScopes:[],roles:[]};n({clients:[...S,s]}),le(S.length)},b=(s,t)=>{const a=[...S];a[s]={...a[s],...t},n({clients:a})},ns=s=>{n({clients:S.filter((t,a)=>a!==s)}),$e===s&&le(null)},cs=()=>{const s={id:String(Date.now()),username:`user${j.length+1}`,email:`user${j.length+1}@example.com`,enabled:!0,emailVerified:!1,roles:["user"],groups:[],attributes:{},credentials:[],federatedIdentity:[]};n({users:[...j,s]}),re(j.length)},k=(s,t)=>{const a=[...j];a[s]={...a[s],...t},n({users:a})},ds=s=>{n({users:j.filter((t,a)=>a!==s)}),qe===s&&re(null)},os=s=>{const t={id:`mapper-${Date.now()}`,name:"New Mapper",protocol:S[s].protocol,protocolMapper:"oidc-usermodel-property-mapper",config:{}},a=[...S[s].protocolMappers||[],t];b(s,{protocolMappers:a}),A({title:"Protocol Mapper Added",description:"New protocol mapper has been added to the client"})},ms=(s,t)=>{const a=(S[s].protocolMappers||[]).filter((r,d)=>d!==t);b(s,{protocolMappers:a}),A({title:"Protocol Mapper Removed",description:"Protocol mapper has been removed from the client"})},hs=s=>{const t=`attribute-${Date.now()}`,a={...j[s].attributes||{},[t]:[""]};k(s,{attributes:a}),A({title:"Attribute Added",description:"New attribute has been added to the user"})},xs=(s,t)=>{const a={...j[s].attributes||{}};delete a[t],k(s,{attributes:a}),A({title:"Attribute Removed",description:"Attribute has been removed from the user"})},ke=(s,t,a,r)=>{const d={...j[s].attributes||{}};t!==a&&delete d[t],d[a]=r,k(s,{attributes:d})},ps=(s,t,a)=>{const r={type:"password",value:t,temporary:a},d=[...j[s].credentials||[],r];k(s,{credentials:d}),Ce({...F,[s]:""}),we({...X,[s]:!1}),A({title:"Password Set",description:a?"Temporary password has been set":"Password has been set"})},js=(s,t)=>{const a=(j[s].credentials||[]).filter((r,d)=>d!==t);k(s,{credentials:a}),A({title:"Credential Removed",description:"Credential has been removed from the user"})},O=s=>{const t={id:`idp-${Date.now()}`,alias:s,providerId:s,enabled:!0,displayName:s.charAt(0).toUpperCase()+s.slice(1),config:{}};n({identityProviders:[..._,t]}),A({title:"Identity Provider Added",description:`${t.displayName} identity provider has been added`})},ne=(s,t)=>{const a=[..._];a[s]={...a[s],...t},n({identityProviders:a})},us=s=>{n({identityProviders:_.filter((t,a)=>a!==s)}),A({title:"Identity Provider Removed",description:"Identity provider has been removed"})},vs=()=>{const s={id:`scope-${Date.now()}`,name:`new-scope-${Date.now()}`,protocol:"openid-connect",description:"Custom client scope",attributes:{},protocolMappers:[]};n({clientScopes:[...H,s]}),A({title:"Client Scope Created",description:"New client scope has been created"})},Ns=()=>{const s=`role-${Date.now()}`;n({realmRoles:[...J,s]}),A({title:"Role Created",description:"New realm role has been created"})},fs=s=>{n({realmRoles:J.filter(a=>a!==s)});const t=j.map(a=>({...a,roles:a.roles.filter(r=>r!==s)}));n({users:t}),A({title:"Role Removed",description:"Realm role has been removed"})},gs=s=>{navigator.clipboard.writeText(s),A({title:"Copied",description:"Client secret has been copied to clipboard"})},Ae=S.filter(s=>s.name.toLowerCase().includes(Q.toLowerCase())||s.clientId.toLowerCase().includes(Q.toLowerCase())),Ee=j.filter(s=>s.username.toLowerCase().includes(U.toLowerCase())||s.email.toLowerCase().includes(U.toLowerCase())||s.firstName&&s.firstName.toLowerCase().includes(U.toLowerCase())||s.lastName&&s.lastName.toLowerCase().includes(U.toLowerCase()));return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(xe,{className:"h-6 w-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Keycloak"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Identity and Access Management - ",ue]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(w,{variant:ie?"default":"secondary",className:"gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${ie?"bg-green-500 animate-pulse":"bg-gray-500"}`}),ie?"Active":Ne?"Connected":"Standalone"]})})]}),e.jsx(I,{}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(x,{children:[e.jsx(v,{className:"pb-3",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Clients"})}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:S.length}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[S.filter(s=>s.enabled).length," enabled"]})]})]}),e.jsxs(x,{children:[e.jsx(v,{className:"pb-3",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Users"})}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:j.length}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[j.filter(s=>s.enabled).length," active"]})]})]}),e.jsxs(x,{children:[e.jsx(v,{className:"pb-3",children:e.jsx(N,{className:"text-sm font-medium text-muted-foreground",children:"Sessions"})}),e.jsxs(y,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Ze}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Active sessions"})]})]})]}),u&&e.jsxs(x,{className:"border-l-4 border-l-blue-500",children:[e.jsxs(v,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(Cs,{className:"h-5 w-5"}),"Real-time Metrics"]}),e.jsx(C,{children:"Live performance metrics from Keycloak simulation"})]}),e.jsxs(y,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Requests Per Second"}),e.jsx("div",{className:"text-3xl font-bold",children:u.requestsPerSecond.toFixed(2)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Current throughput"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Average Latency"}),e.jsxs("div",{className:"text-3xl font-bold",children:[Math.round(u.averageLatency),"ms"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Response time"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Error Rate"}),e.jsxs("div",{className:"text-3xl font-bold",children:[(u.errorRate*100).toFixed(2),"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Failed requests"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Auth Success Rate"}),e.jsxs("div",{className:"text-3xl font-bold",children:[(u.authSuccessRate*100).toFixed(2),"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Successful authentications"})]})]}),e.jsx(I,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"text-sm",children:"Login Requests"}),e.jsx("div",{className:"text-xl font-bold",children:u.loginRequestsTotal}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[u.loginErrorsTotal," errors"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"text-sm",children:"Token Refresh"}),e.jsx("div",{className:"text-xl font-bold",children:u.tokenRefreshTotal}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Refresh operations"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"text-sm",children:"Sessions"}),e.jsx("div",{className:"text-xl font-bold",children:u.activeSessions}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[u.sessionsCreatedTotal," created, ",u.sessionsExpiredTotal," expired"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"text-sm",children:"Events"}),e.jsx("div",{className:"text-xl font-bold",children:u.eventsTotal}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[u.adminEventsTotal," admin events"]})]})]}),i.email&&e.jsxs(e.Fragment,{children:[e.jsx(I,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"text-sm",children:"Emails Sent"}),e.jsx("div",{className:"text-xl font-bold",children:u.emailsSentTotal}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[u.emailErrorsTotal," errors"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"text-sm",children:"Email Error Rate"}),e.jsxs("div",{className:"text-xl font-bold",children:[u.emailsSentTotal>0?(u.emailErrorsTotal/u.emailsSentTotal*100).toFixed(2):"0.00","%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"SMTP errors"})]})]})]})]})]}),e.jsxs(ce,{defaultValue:"realm",className:"w-full",children:[e.jsxs(de,{className:"grid w-full grid-cols-9",children:[e.jsxs(f,{value:"realm",className:"gap-2",children:[e.jsx(ks,{className:"h-4 w-4"}),"Realm"]}),e.jsxs(f,{value:"clients",className:"gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Clients"]}),e.jsxs(f,{value:"users",className:"gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Users"]}),e.jsxs(f,{value:"authentication",className:"gap-2",children:[e.jsx(Ts,{className:"h-4 w-4"}),"Auth Flows"]}),e.jsxs(f,{value:"identity-providers",className:"gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"IdP"]}),e.jsxs(f,{value:"client-scopes",className:"gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),"Scopes"]}),e.jsxs(f,{value:"roles",className:"gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),"Roles"]}),e.jsxs(f,{value:"sessions",className:"gap-2",children:[e.jsx(As,{className:"h-4 w-4"}),"Sessions"]}),e.jsxs(f,{value:"security",className:"gap-2",children:[e.jsx(Es,{className:"h-4 w-4"}),"Security"]})]}),e.jsxs(g,{value:"realm",className:"space-y-4 mt-4",children:[e.jsxs(x,{children:[e.jsxs(v,{children:[e.jsx(N,{children:"Realm Settings"}),e.jsx(C,{children:"Keycloak realm configuration and settings"})]}),e.jsxs(y,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"realm",children:"Realm Name *"}),e.jsx(c,{id:"realm",value:ue,onChange:s=>n({realm:s.target.value}),placeholder:"my-realm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"admin-url",children:"Admin URL"}),e.jsx(c,{id:"admin-url",value:Ge,onChange:s=>n({adminUrl:s.target.value}),placeholder:"http://keycloak:8080"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"display-name",children:"Display Name"}),e.jsx(c,{id:"display-name",value:i.displayName||"",onChange:s=>n({displayName:s.target.value}),placeholder:"My Realm"})]}),e.jsxs("div",{className:"flex items-center justify-between pt-6",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{children:"Realm Enabled"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Enable or disable this realm"})]}),e.jsx(p,{checked:ve,onCheckedChange:s=>n({enabled:s})})]})]})]})]}),e.jsxs(x,{children:[e.jsxs(v,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"h-5 w-5"}),"Email"]}),e.jsx(C,{children:"Configure SMTP server for sending emails"})]}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"smtp-host",children:"SMTP Host"}),e.jsx(c,{id:"smtp-host",value:i.email?.host||"",onChange:s=>{const t=s.target.value,a=ls(t);if(a)P({...m,"smtp-host":a});else{const r={...m};delete r["smtp-host"],P(r)}n({email:{...i.email,host:t}})},placeholder:"smtp.example.com",className:m["smtp-host"]?"border-red-500":""}),m["smtp-host"]&&e.jsx("p",{className:"text-xs text-red-500",children:m["smtp-host"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"smtp-port",children:"SMTP Port"}),e.jsx(c,{id:"smtp-port",type:"number",value:i.email?.port||587,onChange:s=>{const t=parseInt(s.target.value)||587,a=rs(t);if(a)P({...m,"smtp-port":a});else{const r={...m};delete r["smtp-port"],P(r)}n({email:{...i.email,port:t}})},className:m["smtp-port"]?"border-red-500":""}),m["smtp-port"]&&e.jsx("p",{className:"text-xs text-red-500",children:m["smtp-port"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"smtp-from",children:"From"}),e.jsx(c,{id:"smtp-from",value:i.email?.from||"",onChange:s=>{const t=s.target.value,a=Se(t);if(a&&t.trim())P({...m,"smtp-from":a});else{const r={...m};delete r["smtp-from"],P(r)}n({email:{...i.email,from:t}})},placeholder:"noreply@example.com",className:m["smtp-from"]?"border-red-500":""}),m["smtp-from"]&&e.jsx("p",{className:"text-xs text-red-500",children:m["smtp-from"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"smtp-from-display",children:"From Display Name"}),e.jsx(c,{id:"smtp-from-display",value:i.email?.fromDisplayName||"",onChange:s=>n({email:{...i.email,fromDisplayName:s.target.value}}),placeholder:"Keycloak"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{checked:i.email?.enableSsl??!1,onCheckedChange:s=>n({email:{...i.email,enableSsl:s}})}),e.jsx(l,{children:"Enable SSL"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{checked:i.email?.enableStartTls??!1,onCheckedChange:s=>n({email:{...i.email,enableStartTls:s}})}),e.jsx(l,{children:"Enable StartTLS"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{checked:i.email?.enableAuthentication??!1,onCheckedChange:s=>n({email:{...i.email,enableAuthentication:s}})}),e.jsx(l,{children:"Enable Authentication"})]})]}),i.email?.enableAuthentication&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"smtp-user",children:"Username"}),e.jsx(c,{id:"smtp-user",value:i.email?.user||"",onChange:s=>n({email:{...i.email,user:s.target.value}}),placeholder:"smtp-username"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"smtp-password",children:"Password"}),e.jsx(c,{id:"smtp-password",type:"password",value:i.email?.password||"",onChange:s=>n({email:{...i.email,password:s.target.value}}),placeholder:"smtp-password"})]})]})]})]})]}),e.jsx(g,{value:"clients",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Clients"}),e.jsx(C,{children:"OAuth2 and OpenID Connect clients"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Te,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(c,{placeholder:"Search clients...",value:Q,onChange:s=>ze(s.target.value),className:"pl-8 w-64"})]}),e.jsxs(o,{size:"sm",onClick:is,variant:"outline",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Create Client"]})]})]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3",children:[Ae.map((s,t)=>e.jsx(x,{className:"border-border hover:border-primary/50 transition-colors",children:e.jsx(v,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(pe,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"text-lg",children:s.name}),s.description&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["- ",s.description]})]}),e.jsxs(C,{className:"text-xs mt-1 flex items-center gap-2",children:[e.jsxs("span",{children:["Client ID: ",s.clientId]}),e.jsx("span",{children:"•"}),e.jsx("span",{children:s.type}),e.jsx("span",{children:"•"}),e.jsx("span",{children:s.protocol}),s.redirectUris&&s.redirectUris.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{children:[s.redirectUris.length," redirect URI",s.redirectUris.length!==1?"s":""]})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.enabled?e.jsxs(w,{variant:"default",className:"gap-1",children:[e.jsx(me,{className:"h-3 w-3"}),"Enabled"]}):e.jsxs(w,{variant:"secondary",className:"gap-1",children:[e.jsx(Le,{className:"h-3 w-3"}),"Disabled"]}),e.jsxs($,{children:[e.jsx(q,{asChild:!0,children:e.jsx(o,{size:"icon",variant:"ghost",onClick:()=>le(t),children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsxs(z,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(V,{children:[e.jsxs(G,{children:["Edit Client: ",s.name]}),e.jsx(K,{children:"Configure client settings, credentials, and protocol mappers"})]}),e.jsx("div",{className:"space-y-6 mt-4",children:e.jsxs(ce,{defaultValue:"settings",children:[e.jsxs(de,{children:[e.jsx(f,{value:"settings",children:"Settings"}),e.jsx(f,{value:"credentials",children:"Credentials"}),e.jsx(f,{value:"protocol-mappers",children:"Protocol Mappers"}),e.jsx(f,{value:"scopes",children:"Scopes"})]}),e.jsxs(g,{value:"settings",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"client-name",children:"Client Name *"}),e.jsx(c,{id:"client-name",value:s.name,onChange:a=>b(t,{name:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"client-id",children:"Client ID *"}),e.jsx(c,{id:"client-id",value:s.clientId,onChange:a=>b(t,{clientId:a.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"client-description",children:"Description"}),e.jsx(he,{id:"client-description",value:s.description||"",onChange:a=>b(t,{description:a.target.value}),rows:2})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{children:"Enabled"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Enable or disable this client"})]}),e.jsx(p,{checked:s.enabled,onCheckedChange:a=>b(t,{enabled:a})})]}),e.jsx(I,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Client Protocol"}),e.jsxs(ee,{value:s.protocol,onValueChange:a=>b(t,{protocol:a}),children:[e.jsx(se,{children:e.jsx(ae,{})}),e.jsxs(te,{children:[e.jsx(R,{value:"openid-connect",children:"OpenID Connect"}),e.jsx(R,{value:"saml",children:"SAML 2.0"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Access Type"}),e.jsxs(ee,{value:s.type,onValueChange:a=>b(t,{type:a}),children:[e.jsx(se,{children:e.jsx(ae,{})}),e.jsxs(te,{children:[e.jsx(R,{value:"public",children:"Public"}),e.jsx(R,{value:"confidential",children:"Confidential"}),e.jsx(R,{value:"bearer-only",children:"Bearer-only"})]})]})]}),e.jsx(I,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{children:"Capability Config"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-sm font-normal",children:"Standard Flow Enabled"}),e.jsx(p,{checked:s.standardFlowEnabled??!0,onCheckedChange:a=>b(t,{standardFlowEnabled:a})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-sm font-normal",children:"Direct Access Grants Enabled"}),e.jsx(p,{checked:s.directAccessGrantsEnabled??!1,onCheckedChange:a=>b(t,{directAccessGrantsEnabled:a})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-sm font-normal",children:"Service Accounts Enabled"}),e.jsx(p,{checked:s.serviceAccountsEnabled??!1,onCheckedChange:a=>b(t,{serviceAccountsEnabled:a})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-sm font-normal",children:"Authorization Services Enabled"}),e.jsx(p,{checked:s.authorizationServicesEnabled??!1,onCheckedChange:a=>b(t,{authorizationServicesEnabled:a})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-sm font-normal",children:"Consent Required"}),e.jsx(p,{checked:s.consentRequired??!1,onCheckedChange:a=>b(t,{consentRequired:a})})]})]})]}),e.jsx(I,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"redirect-uris",children:"Valid Redirect URIs"}),e.jsx(he,{id:"redirect-uris",value:s.redirectUris?.join(`
`)||"",onChange:a=>{const r=a.target.value.split(`
`).filter(h=>h.trim()),d=[];if(r.forEach((h,L)=>{const Re=ts(h);Re&&d.push(`URI ${L+1}: ${Re}`)}),d.length>0)P({...m,[`client-${t}-redirect-uris`]:d.join("; ")});else{const h={...m};delete h[`client-${t}-redirect-uris`],P(h)}b(t,{redirectUris:r})},placeholder:`http://localhost:3000/*
https://example.com/callback`,rows:4,className:m[`client-${t}-redirect-uris`]?"border-red-500":""}),m[`client-${t}-redirect-uris`]&&e.jsx("p",{className:"text-xs text-red-500",children:m[`client-${t}-redirect-uris`]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"One URI per line. Use * for wildcards"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"web-origins",children:"Web Origins"}),e.jsx(he,{id:"web-origins",value:s.webOrigins?.join(`
`)||"",onChange:a=>b(t,{webOrigins:a.target.value.split(`
`).filter(r=>r.trim())}),placeholder:`http://localhost:3000
https://example.com`,rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Allowed CORS origins. Use + for all origins, * for all redirect URIs"})]})]}),e.jsxs(g,{value:"credentials",className:"space-y-4 mt-4",children:[s.type==="confidential"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"client-secret",children:"Client Secret"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{id:"client-secret",type:Y[`client-${t}`]?"text":"password",value:s.clientSecret||"",onChange:a=>b(t,{clientSecret:a.target.value}),placeholder:"Enter client secret"}),e.jsx(o,{variant:"outline",size:"icon",onClick:()=>ss({...Y,[`client-${t}`]:!Y[`client-${t}`]}),children:Y[`client-${t}`]?e.jsx(Me,{className:"h-4 w-4"}):e.jsx(Ie,{className:"h-4 w-4"})}),e.jsx(o,{variant:"outline",size:"icon",onClick:()=>{s.clientSecret&&gs(s.clientSecret)},children:e.jsx(ws,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Keep this secret secure. It's used to authenticate the client."})]}),s.type==="public"&&e.jsx("div",{className:"p-4 bg-muted rounded-lg",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Public clients don't require a client secret. They are typically used for browser-based applications."})})]}),e.jsxs(g,{value:"protocol-mappers",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Protocol mappers allow you to add claims to tokens or transform user data"}),e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>os(t),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Add Mapper"]})]}),s.protocolMappers&&s.protocolMappers.length>0?e.jsx("div",{className:"space-y-2",children:s.protocolMappers.map((a,r)=>e.jsx(x,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:a.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.protocolMapper})]}),e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>ms(t,r),children:e.jsx(M,{className:"h-4 w-4"})})]})},r))}):e.jsx("div",{className:"p-4 text-center text-muted-foreground border border-dashed rounded-lg",children:"No protocol mappers configured"})]}),e.jsx(g,{value:"scopes",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Default Client Scopes"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"These scopes are always included in tokens"}),e.jsxs("div",{className:"space-y-2",children:[H.filter(a=>s.defaultClientScopes?.includes(a.id)).map(a=>e.jsx(w,{variant:"default",children:a.name},a.id)),(!s.defaultClientScopes||s.defaultClientScopes.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No default scopes"})]})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Optional Client Scopes"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"These scopes can be requested by the client"}),e.jsxs("div",{className:"space-y-2",children:[H.filter(a=>s.optionalClientScopes?.includes(a.id)).map(a=>e.jsx(w,{variant:"outline",children:a.name},a.id)),(!s.optionalClientScopes||s.optionalClientScopes.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No optional scopes"})]})]})]})})]})})]})]}),S.length>1&&e.jsx(o,{size:"icon",variant:"ghost",onClick:()=>ns(t),children:e.jsx(M,{className:"h-4 w-4"})})]})]})})},t)),Ae.length===0&&e.jsx("div",{className:"p-8 text-center text-muted-foreground border border-dashed rounded-lg",children:Q?"No clients found matching your search":"No clients configured"})]})})]})}),e.jsx(g,{value:"users",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Users"}),e.jsx(C,{children:"User accounts and role mappings"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Te,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(c,{placeholder:"Search users...",value:U,onChange:s=>Ve(s.target.value),className:"pl-8 w-64"})]}),e.jsxs(o,{size:"sm",onClick:cs,variant:"outline",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Add User"]})]})]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3",children:[Ee.map((s,t)=>e.jsx(x,{className:"border-border hover:border-primary/50 transition-colors",children:e.jsx(v,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"p-2 rounded-full bg-secondary",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"text-lg",children:s.firstName&&s.lastName?`${s.firstName} ${s.lastName}`:s.username}),s.emailVerified&&e.jsxs(w,{variant:"outline",className:"text-xs",children:[e.jsx(me,{className:"h-3 w-3 mr-1"}),"Verified"]})]}),e.jsxs(C,{className:"text-xs mt-1",children:[s.email,s.firstName||s.lastName&&e.jsxs("span",{className:"ml-2",children:["(",s.username,")"]})]}),e.jsx("div",{className:"flex gap-1 mt-2",children:s.roles.map((a,r)=>e.jsx(w,{variant:"outline",className:"text-xs",children:a},r))})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.enabled?e.jsxs(w,{variant:"default",className:"gap-1",children:[e.jsx(me,{className:"h-3 w-3"}),"Active"]}):e.jsxs(w,{variant:"secondary",className:"gap-1",children:[e.jsx(Le,{className:"h-3 w-3"}),"Disabled"]}),e.jsxs($,{children:[e.jsx(q,{asChild:!0,children:e.jsx(o,{size:"icon",variant:"ghost",onClick:()=>re(t),children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsxs(z,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(V,{children:[e.jsxs(G,{children:["Edit User: ",s.username]}),e.jsx(K,{children:"Configure user details, credentials, roles, and attributes"})]}),e.jsx("div",{className:"space-y-6 mt-4",children:e.jsxs(ce,{defaultValue:"details",children:[e.jsxs(de,{children:[e.jsx(f,{value:"details",children:"Details"}),e.jsx(f,{value:"credentials",children:"Credentials"}),e.jsx(f,{value:"role-mappings",children:"Role Mappings"}),e.jsx(f,{value:"groups",children:"Groups"}),e.jsx(f,{value:"attributes",children:"Attributes"})]}),e.jsxs(g,{value:"details",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"username",children:"Username *"}),e.jsx(c,{id:"username",value:s.username,onChange:a=>k(t,{username:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email *"}),e.jsx(c,{id:"email",type:"email",value:s.email,onChange:a=>{const r=a.target.value,d=Se(r);if(d&&r.trim())P({...m,[`user-${t}-email`]:d});else{const h={...m};delete h[`user-${t}-email`],P(h)}k(t,{email:r})},className:m[`user-${t}-email`]?"border-red-500":""}),m[`user-${t}-email`]&&e.jsx("p",{className:"text-xs text-red-500",children:m[`user-${t}-email`]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"first-name",children:"First Name"}),e.jsx(c,{id:"first-name",value:s.firstName||"",onChange:a=>k(t,{firstName:a.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"last-name",children:"Last Name"}),e.jsx(c,{id:"last-name",value:s.lastName||"",onChange:a=>k(t,{lastName:a.target.value})})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{checked:s.enabled??!0,onCheckedChange:a=>k(t,{enabled:a})}),e.jsx(l,{children:"Enabled"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{checked:s.emailVerified??!1,onCheckedChange:a=>k(t,{emailVerified:a})}),e.jsx(l,{children:"Email Verified"})]})]})]}),e.jsx(g,{value:"credentials",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{id:"password",type:W[t]?"text":"password",placeholder:"Set new password",value:F[t]||"",onChange:a=>Ce({...F,[t]:a.target.value})}),e.jsx(o,{variant:"outline",onClick:()=>es({...W,[t]:!W[t]}),children:W[t]?e.jsx(Me,{className:"h-4 w-4"}):e.jsx(Ie,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"temporary-password",className:"rounded",checked:X[t]||!1,onChange:a=>we({...X,[t]:a.target.checked})}),e.jsx(l,{htmlFor:"temporary-password",className:"text-sm font-normal",children:"Temporary password (user must change on first login)"})]}),(F[t]||"").length>0&&e.jsx(o,{size:"sm",onClick:()=>{F[t]&&ps(t,F[t],X[t]||!1)},children:"Set Password"})]}),s.credentials&&s.credentials.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Existing Credentials"}),s.credentials.map((a,r)=>e.jsx(x,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.type}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.temporary?"Temporary":"Permanent"})]}),e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>js(t,r),children:e.jsx(M,{className:"h-4 w-4"})})]})},r))]})]})}),e.jsx(g,{value:"role-mappings",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Realm Roles"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Assign realm-level roles to this user"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border rounded-lg p-3",children:J.map(a=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:a}),e.jsx(p,{checked:s.roles.includes(a),onCheckedChange:r=>{const d=r?[...s.roles,a]:s.roles.filter(h=>h!==a);k(t,{roles:d})}})]},a))})]}),S.length>0&&e.jsxs("div",{children:[e.jsx(l,{children:"Client Roles"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Assign client-specific roles"}),S.map(a=>e.jsxs(x,{className:"p-3 mb-2",children:[e.jsx("div",{className:"font-medium text-sm mb-2",children:a.name}),a.roles&&a.roles.length>0?e.jsx("div",{className:"space-y-1",children:a.roles.map(r=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:r}),e.jsx(p,{checked:!1,onCheckedChange:()=>{}})]},r))}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"No client roles defined"})]},a.id))]})]})}),e.jsx(g,{value:"groups",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Groups"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Assign user to groups"}),be.length>0?e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border rounded-lg p-3",children:be.map(a=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:a.path}),e.jsx(p,{checked:s.groups?.includes(a.id)??!1,onCheckedChange:r=>{const d=r?[...s.groups||[],a.id]:(s.groups||[]).filter(h=>h!==a.id);k(t,{groups:d})}})]},a.id))}):e.jsx("div",{className:"p-4 text-center text-muted-foreground border border-dashed rounded-lg",children:"No groups configured"})]})}),e.jsx(g,{value:"attributes",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"User Attributes"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Custom attributes for this user"}),s.attributes&&Object.keys(s.attributes).length>0?e.jsx("div",{className:"space-y-2",children:Object.entries(s.attributes).map(([a,r])=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{value:a,placeholder:"Attribute key",className:"flex-1",onChange:d=>{const h=d.target.value;h!==a&&ke(t,a,h,Array.isArray(r)?r:[String(r)])}}),e.jsx(c,{value:Array.isArray(r)?r.join(", "):String(r),placeholder:"Attribute value(s)",className:"flex-1",onChange:d=>{const h=d.target.value.split(",").map(L=>L.trim()).filter(L=>L);ke(t,a,a,h)}}),e.jsx(o,{size:"icon",variant:"ghost",onClick:()=>xs(t,a),children:e.jsx(M,{className:"h-4 w-4"})})]},a))}):e.jsx("div",{className:"p-4 text-center text-muted-foreground border border-dashed rounded-lg",children:"No attributes configured"}),e.jsxs(o,{size:"sm",variant:"outline",onClick:()=>hs(t),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Add Attribute"]})]})})]})})]})]}),j.length>1&&e.jsx(o,{size:"icon",variant:"ghost",onClick:()=>ds(t),children:e.jsx(M,{className:"h-4 w-4"})})]})]})})},t)),Ee.length===0&&e.jsx("div",{className:"p-8 text-center text-muted-foreground border border-dashed rounded-lg",children:U?"No users found matching your search":"No users configured"})]})})]})}),e.jsx(g,{value:"authentication",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsxs(v,{children:[e.jsx(N,{children:"Authentication Flows"}),e.jsx(C,{children:"Configure authentication flows and execution steps"})]}),e.jsx(y,{className:"space-y-4",children:ge.map((s,t)=>e.jsxs(x,{className:"border-border",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{className:"text-lg",children:s.alias}),s.description&&e.jsx(C,{className:"mt-1",children:s.description})]}),e.jsx(w,{variant:s.builtIn?"default":"outline",children:s.builtIn?"Built-in":"Custom"})]})}),s.executions&&s.executions.length>0&&e.jsx(y,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Execution Steps"}),s.executions.map((a,r)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{variant:"outline",children:a.requirement}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.displayName}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.providerId})]})]}),a.configurable&&e.jsxs($,{children:[e.jsx(q,{asChild:!0,children:e.jsx(o,{size:"sm",variant:"ghost",children:e.jsx(Pe,{className:"h-4 w-4"})})}),e.jsxs(z,{children:[e.jsxs(V,{children:[e.jsxs(G,{children:["Configure Execution: ",a.displayName]}),e.jsxs(K,{children:["Configure the execution step settings for ",s.alias," flow"]})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Requirement Level"}),e.jsxs(ee,{value:a.requirement,onValueChange:d=>{const h=[...ge],L=[...h[t].executions||[]];L[r]={...a,requirement:d},h[t]={...h[t],executions:L},n({authenticationFlows:h})},children:[e.jsx(se,{children:e.jsx(ae,{})}),e.jsxs(te,{children:[e.jsx(R,{value:"REQUIRED",children:"Required"}),e.jsx(R,{value:"ALTERNATIVE",children:"Alternative"}),e.jsx(R,{value:"DISABLED",children:"Disabled"}),e.jsx(R,{value:"CONDITIONAL",children:"Conditional"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.requirement==="REQUIRED"&&"This step must be executed successfully",a.requirement==="ALTERNATIVE"&&"This step is an alternative option",a.requirement==="DISABLED"&&"This step is disabled",a.requirement==="CONDITIONAL"&&"This step is executed conditionally"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Display Name"}),e.jsx(c,{value:a.displayName,readOnly:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Display name cannot be changed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Provider ID"}),e.jsx(c,{value:a.providerId,readOnly:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Provider ID cannot be changed"})]})]})]})]})]},a.id))]})})]},s.id))})]})}),e.jsx(g,{value:"identity-providers",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Identity Providers"}),e.jsx(C,{children:"Configure social logins, SAML, LDAP, and other identity providers"})]}),e.jsxs($,{children:[e.jsx(q,{asChild:!0,children:e.jsxs(o,{size:"sm",variant:"outline",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Add Provider"]})}),e.jsxs(z,{children:[e.jsxs(V,{children:[e.jsx(G,{children:"Add Identity Provider"}),e.jsx(K,{children:"Select the type of identity provider to add"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx(o,{variant:"outline",onClick:()=>{O("google")},children:"Google"}),e.jsx(o,{variant:"outline",onClick:()=>{O("github")},children:"GitHub"}),e.jsx(o,{variant:"outline",onClick:()=>{O("facebook")},children:"Facebook"}),e.jsx(o,{variant:"outline",onClick:()=>{O("saml")},children:"SAML 2.0"}),e.jsx(o,{variant:"outline",onClick:()=>{O("oidc")},children:"OpenID Connect"}),e.jsx(o,{variant:"outline",onClick:()=>{O("ldap")},children:"LDAP"})]})]})]})]})}),e.jsx(y,{children:_.length>0?e.jsx("div",{className:"space-y-3",children:_.map((s,t)=>e.jsx(x,{className:"border-border",children:e.jsx(v,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(oe,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(N,{className:"text-lg",children:s.displayName||s.alias}),e.jsxs(C,{className:"text-xs mt-1",children:[s.providerId," • ",s.enabled?"Enabled":"Disabled"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{variant:s.enabled?"default":"secondary",children:s.enabled?"Active":"Inactive"}),e.jsxs($,{children:[e.jsx(q,{asChild:!0,children:e.jsx(o,{size:"icon",variant:"ghost",children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsxs(z,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(V,{children:[e.jsxs(G,{children:["Edit Identity Provider: ",s.displayName||s.alias]}),e.jsx(K,{children:"Configure identity provider settings"})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Display Name"}),e.jsx(c,{value:s.displayName||"",onChange:a=>ne(t,{displayName:a.target.value})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enabled"}),e.jsx(p,{checked:s.enabled,onCheckedChange:a=>ne(t,{enabled:a})})]}),s.providerId==="ldap"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"LDAP Server URL"}),e.jsx(c,{placeholder:"ldap://ldap.example.com:389",value:s.config?.ldapUrl||"",onChange:a=>ne(t,{config:{...s.config,ldapUrl:a.target.value}})})]})]})]})]}),e.jsx(o,{size:"icon",variant:"ghost",onClick:()=>us(t),children:e.jsx(M,{className:"h-4 w-4"})})]})]})})},s.id))}):e.jsxs("div",{className:"p-8 text-center text-muted-foreground border border-dashed rounded-lg",children:[e.jsx(oe,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No identity providers configured"}),e.jsx("p",{className:"text-xs mt-1",children:"Add providers for Google, GitHub, SAML, LDAP, etc."})]})})]})}),e.jsx(g,{value:"client-scopes",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Client Scopes"}),e.jsx(C,{children:"Configure default and optional client scopes"})]}),e.jsxs(o,{size:"sm",variant:"outline",onClick:vs,children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Create Scope"]})]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{className:"text-base font-semibold",children:"Default Client Scopes"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"These scopes are always included in tokens"}),e.jsx("div",{className:"space-y-2",children:H.filter(s=>s.id==="profile"||s.id==="email").map(s=>e.jsx(x,{className:"p-3 border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),s.description&&e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:s.description})]}),e.jsx(w,{variant:"default",children:"Default"})]})},s.id))})]}),e.jsxs("div",{children:[e.jsx(l,{className:"text-base font-semibold",children:"Optional Client Scopes"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"These scopes can be requested by clients"}),e.jsx("div",{className:"space-y-2",children:H.filter(s=>s.id!=="profile"&&s.id!=="email").map(s=>e.jsx(x,{className:"p-3 border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),s.description&&e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:s.description})]}),e.jsx(w,{variant:"outline",children:"Optional"})]})},s.id))})]})]})})]})}),e.jsx(g,{value:"roles",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Realm Roles"}),e.jsx(C,{children:"Manage realm-level roles and permissions"})]}),e.jsxs(o,{size:"sm",variant:"outline",onClick:Ns,children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Create Role"]})]})}),e.jsx(y,{children:e.jsx("div",{className:"space-y-2",children:J.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsx("div",{className:"font-medium",children:s}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs($,{children:[e.jsx(q,{asChild:!0,children:e.jsx(o,{size:"sm",variant:"ghost",children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsxs(z,{children:[e.jsxs(V,{children:[e.jsxs(G,{children:["Edit Role: ",s]}),e.jsx(K,{children:"Role configuration"})]}),e.jsx("div",{className:"space-y-4 mt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Role Name"}),e.jsx(c,{value:s,readOnly:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Role name cannot be changed"})]})})]})]}),e.jsx(o,{size:"sm",variant:"ghost",onClick:()=>fs(s),children:e.jsx(M,{className:"h-4 w-4"})})]})]},s))})})]})}),e.jsx(g,{value:"sessions",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsxs(v,{children:[e.jsx(N,{children:"Session Management"}),e.jsx(C,{children:"Configure SSO session timeouts and token lifespans"})]}),e.jsx(y,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"access-token-lifespan",children:"Access Token Lifespan"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{id:"access-token-lifespan",type:"number",min:"60",max:"3600",value:_e,onChange:s=>n({accessTokenLifespan:parseInt(s.target.value)||300})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"sec"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How long access tokens are valid"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"refresh-token-lifespan",children:"Refresh Token Lifespan"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{id:"refresh-token-lifespan",type:"number",min:"60",max:"86400",value:Qe,onChange:s=>n({refreshTokenLifespan:parseInt(s.target.value)||1800})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"sec"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How long refresh tokens are valid"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"sso-session-idle",children:"SSO Session Idle"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{id:"sso-session-idle",type:"number",min:"60",max:"7200",value:He,onChange:s=>n({ssoSessionIdle:parseInt(s.target.value)||1800})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"sec"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Idle timeout for SSO sessions"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"sso-session-max",children:"SSO Session Max"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{id:"sso-session-max",type:"number",min:"300",max:"86400",value:Be,onChange:s=>n({ssoSessionMax:parseInt(s.target.value)||36e3})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"sec"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum SSO session duration"})]})]})})]})}),e.jsx(g,{value:"security",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsxs(v,{children:[e.jsx(N,{children:"Security Settings"}),e.jsx(C,{children:"SSL/TLS, protocols, and password policies"})]}),e.jsxs(y,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(l,{children:"Enable SSL"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Encrypt connections with TLS"})]}),e.jsx(p,{checked:fe,onCheckedChange:s=>n({enableSSL:s})})]}),fe&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"SSL Required"}),e.jsxs(ee,{value:Ke,onValueChange:s=>n({sslRequired:s}),children:[e.jsx(se,{children:e.jsx(ae,{})}),e.jsxs(te,{children:[e.jsx(R,{value:"external",children:"External"}),e.jsx(R,{value:"all",children:"All"}),e.jsx(R,{value:"none",children:"None"})]})]})]}),e.jsx(I,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(l,{children:"Protocols"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(l,{children:"OAuth2 / OpenID Connect"})]}),e.jsx(p,{checked:Je,onCheckedChange:s=>n({enableOAuth2:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(l,{children:"SAML 2.0"})]}),e.jsx(p,{checked:We,onCheckedChange:s=>n({enableSAML:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(l,{children:"LDAP / Active Directory"})]}),e.jsx(p,{checked:Xe,onCheckedChange:s=>n({enableLDAP:s})})]})]})]}),e.jsx(I,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password-policy",children:"Password Policy"}),e.jsx(c,{id:"password-policy",value:Ye,onChange:s=>n({passwordPolicy:s.target.value}),placeholder:"length(8) and digits(1)"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Keycloak password policy expression. Examples: length(8), digits(1), uppercase(1), lowercase(1), specialChars(1)"})]})]})]})})]})]})})}export{Gs as KeycloakConfigAdvanced};

import{r as c}from"./index-D3yNmt2J.js";function m(e){if(e==null||e==="")return!1;const t=typeof e=="string"?parseInt(e,10):e;return isNaN(t)?!1:t>=1&&t<=65535}function z(e){if(!e||e.trim()==="")return!1;const t=e.trim();return t.length===0||t.length>253||/\s/.test(t)?!1:/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?(\.[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i.test(t)}function d(e,t,n,r){const i=n.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),u=`${i}:${r}`;for(const a of e){if(a.id===t)continue;const f=a.data.config||{},l=f.host||(a.data.label?a.data.label.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):a.id.slice(0,8)),s=f.port||h(a.type);if(s&&l===i&&s===r)return{hasConflict:!0,conflictingNode:a,endpoint:u}}return{hasConflict:!1}}function h(e){return{postgres:5432,mongodb:27017,redis:6379,cassandra:9042,clickhouse:8123,elasticsearch:9200,rest:8080,grpc:50051,graphql:4e3,websocket:8080,webhook:8080,soap:8080,nginx:80,envoy:80,haproxy:80,traefik:80,docker:2375,kubernetes:6443,kafka:9092,rabbitmq:5672,activemq:61616,"aws-sqs":9324,prometheus:9090,grafana:3e3,loki:3100,jaeger:16686,keycloak:8080,"secrets-vault":8200,crm:8080,erp:8080,"payment-gateway":443}[e]}function E(e){if(e==null||e==="")return"Порт обязателен";const t=typeof e=="string"?parseInt(e,10):e;return isNaN(t)?"Порт должен быть числом":t<1?"Порт должен быть больше 0":t>65535?"Порт должен быть меньше или равен 65535":null}function k(e){if(!e||e.trim()==="")return"Хост обязателен";const t=e.trim();return t.length>253?"Хост слишком длинный (максимум 253 символа)":/\s/.test(t)?"Хост не может содержать пробелы":/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?(\.[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i.test(t)?null:"Неверный формат хоста (разрешены буквы, цифры, дефисы, точки)"}function P(e,t,n,r){const[i,u]=c.useState(null),[a,f]=c.useState(null),[l,s]=c.useState({hasConflict:!1});return c.useEffect(()=>{const o=E(r);if(u(o),!o&&r&&z(n)){const g=d(e,t,n,r);s(g)}else s({hasConflict:!1})},[r,n,e,t]),c.useEffect(()=>{const o=k(n);if(f(o),!o&&r&&m(r)){const g=d(e,t,n,r);s(g)}},[n,r,e,t]),{portError:i,hostError:a,portConflict:l,isValid:!i&&!a&&!l.hasConflict}}export{P as u};

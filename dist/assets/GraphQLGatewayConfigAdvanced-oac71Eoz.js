import{u as J,j as e,r as F,S as v,C as c,e as o,f as x,R as y,k as m,A as W,T as X,a as Y,b as w,c as Z,d as C,h as S,i as q,P as _,I as g,B as k,m as ee,L as i,t as f}from"./index-Cd78gA_v.js";import{C as se}from"./circle-check-big-CUvxeXFh.js";import{G as R}from"./globe-CorfMQQo.js";function re({componentId:b}){const{nodes:E,updateNode:A,connections:B}=J(),N=E.find(s=>s.id===b);if(!N)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const n=N.data.config||{},d=n.services||[],h=n.federation||{enabled:!1,services:[]},I=n.endpoint||"/graphql",T=n.totalServices||d.length,D=n.totalRequests||d.reduce((s,t)=>s+(t.requests||0),0),M=n.totalErrors||d.reduce((s,t)=>s+(t.errors||0),0),[L,u]=F.useState(null),[Q,j]=F.useState(null),l=s=>{A(b,{data:{...N.data,config:{...n,...s}}})},P=()=>{const s={id:`svc-${Date.now()}`,name:"new-service",endpoint:"http://localhost:4000/graphql",status:"disconnected"};l({services:[...d,s]}),setShowCreateService(!1)},$=s=>{l({services:d.filter(t=>t.id!==s)})},G=(s,t,p)=>{const r=d.map(a=>a.id===s?{...a,[t]:p}:a);l({services:r})},z=s=>s.status==="error"?"error":B.some(p=>{if(p.source!==b)return!1;const r=E.find(V=>V.id===p.target);if(!r||r.type!=="graphql")return!1;const a=r.data.label||r.type,H=s.name===a||s.name===r.id,U=s.endpoint&&r.id?s.endpoint.includes(r.id)||s.name===a:!1;return H||U})?"connected":(s.status==="disconnected","disconnected"),K=s=>{switch(s){case"connected":return"bg-green-500";case"disconnected":return"bg-muted";case"error":return"bg-red-500";default:return"bg-muted"}},O=s=>{switch(s){case"connected":return"bg-green-500 text-white";case"disconnected":return"bg-muted text-foreground";case"error":return"bg-red-500 text-white";default:return"bg-muted text-foreground"}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"GraphQL Gateway"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Federated GraphQL Gateway"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Unified GraphQL API gateway with federation support"})]})}),e.jsx(v,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(c,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"text-sm font-medium text-muted-foreground",children:"Services"}),e.jsx(y,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:T}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"registered"})]})})]}),e.jsxs(c,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"text-sm font-medium text-muted-foreground",children:"Requests"}),e.jsx(W,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(m,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:D.toLocaleString()})})})]}),e.jsxs(c,{className:"border-l-4 border-l-red-500 bg-card",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"text-sm font-medium text-muted-foreground",children:"Errors"}),e.jsx(se,{className:"h-4 w-4 text-red-500"})]})}),e.jsx(m,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:M})})})]}),e.jsxs(c,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"text-sm font-medium text-muted-foreground",children:"Federation"}),e.jsx(R,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsx(m,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-cyan-600 dark:text-cyan-400",children:h.enabled?"ON":"OFF"})})})]})]}),e.jsxs(X,{defaultValue:"services",className:"space-y-4",children:[e.jsxs(Y,{children:[e.jsxs(w,{value:"services",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Services (",d.length,")"]}),e.jsxs(w,{value:"federation",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Federation"]}),e.jsxs(w,{value:"settings",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(C,{value:"services",className:"space-y-4",children:e.jsxs(c,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(x,{children:"GraphQL Services"}),e.jsx(S,{children:"Registered GraphQL backend services"})]}),e.jsxs(q,{onClick:P,size:"sm",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Add Service"]})]})}),e.jsx(m,{children:e.jsx("div",{className:"space-y-4",children:d.map(s=>{const t=z(s),p=L===s.id&&Q==="name",r=L===s.id&&Q==="endpoint";return e.jsxs(c,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg ${K(t)}/20`,children:e.jsx(y,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[p?e.jsx(g,{value:s.name,onChange:a=>G(s.id,"name",a.target.value),onBlur:()=>{u(null),j(null)},onKeyDown:a=>{a.key==="Enter"&&(u(null),j(null))},className:"font-semibold text-lg",autoFocus:!0}):e.jsx(x,{className:"text-lg font-semibold cursor-pointer hover:text-primary transition-colors",onClick:()=>{u(s.id),j("name")},children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(k,{variant:"outline",className:`${O(t)} border-0`,children:t}),r?e.jsx(g,{value:s.endpoint,onChange:a=>G(s.id,"endpoint",a.target.value),onBlur:()=>{u(null),j(null)},onKeyDown:a=>{a.key==="Enter"&&(u(null),j(null))},className:"font-mono text-xs h-6",autoFocus:!0}):e.jsx(k,{variant:"outline",className:"font-mono text-xs cursor-pointer hover:bg-accent transition-colors",onClick:()=>{u(s.id),j("endpoint")},children:s.endpoint})]})]})]}),e.jsx(q,{variant:"ghost",size:"icon",onClick:()=>$(s.id),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(ee,{className:"h-4 w-4"})})]})}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.requests!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Requests:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.requests.toLocaleString()})]}),s.errors!==void 0&&s.errors>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Errors:"}),e.jsx("span",{className:"ml-2 font-semibold text-red-500",children:s.errors})]})]})})]},s.id)})})})]})}),e.jsx(C,{value:"federation",className:"space-y-4",children:e.jsxs(c,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"GraphQL Federation"}),e.jsx(S,{children:"Federated schema configuration"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable Federation"}),e.jsx(f,{checked:h.enabled,onCheckedChange:s=>l({federation:{...h,enabled:s}})})]}),h.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Federated Services"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:h.services.map((s,t)=>e.jsx(k,{variant:"outline",children:s},t))})]}),h.supergraph&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Supergraph Schema"}),e.jsx("div",{className:"p-3 bg-muted rounded text-xs font-mono overflow-x-auto",children:h.supergraph})]})]})]})]})}),e.jsx(C,{value:"settings",className:"space-y-4",children:e.jsxs(c,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"Gateway Settings"}),e.jsx(S,{children:"Gateway configuration"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Gateway Endpoint"}),e.jsx(g,{value:I,onChange:s=>l({endpoint:s.target.value}),placeholder:"/graphql"})]}),e.jsx(v,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable Introspection"}),e.jsx(f,{checked:n.enableIntrospection??!0,onCheckedChange:s=>l({enableIntrospection:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable Query Complexity Analysis"}),e.jsx(f,{checked:n.enableQueryComplexityAnalysis??!0,onCheckedChange:s=>l({enableQueryComplexityAnalysis:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable Rate Limiting"}),e.jsx(f,{checked:n.enableRateLimiting??!1,onCheckedChange:s=>l({enableRateLimiting:s})})]}),e.jsx(v,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Max Query Depth"}),e.jsx(g,{type:"number",value:n.maxQueryDepth??15,onChange:s=>l({maxQueryDepth:parseInt(s.target.value)||15}),min:1,max:50})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Max Query Complexity"}),e.jsx(g,{type:"number",value:n.maxQueryComplexity??1e3,onChange:s=>l({maxQueryComplexity:parseInt(s.target.value)||1e3}),min:1})]})]})]})})]})]})})}export{re as GraphQLGatewayConfigAdvanced};

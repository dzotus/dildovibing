import{u as ds,a as os,j as e,r as u,e as _,S as O,C as w,m as P,L as n,q as A,s as S,t as k,v as E,w as t,p as c,h as R,i as I,B as D,T as hs,b as xs,c as Y,W as Me,A as us,d as ms,f as Z,k as Q,l as f,P as te,O as pe,I as j,_ as ee,U as le,o as se,n as js,x as ne,D as ps,y as gs,z as vs,E as fs,G as Ns,H as ys,al as ws}from"./index-CK7lW0SB.js";import{P as Ae}from"./progress-DDUMFohz.js";import{T as Oe}from"./textarea-CJ0ebXZg.js";import{u as Cs}from"./use-toast-CfMGnxqm.js";import{T as d,a as o,b as h,c as x}from"./tooltip-C4xa5N9E.js";import{S as bs}from"./shield-Dv5bpRoA.js";import{P as $e}from"./package-DaqAxP6T.js";import{U as ze}from"./users-DhJuOUKj.js";import{P as Ps}from"./pencil-Gkc4lQfi.js";import{K as As}from"./key-BD3NXtGh.js";function $s({componentId:T}){const{nodes:Ue,updateNode:Se}=ds(),{isRunning:ae,getComponentMetrics:Ke}=os(),{toast:v}=Cs(),ce=Ue.find(s=>s.id===T);if(!ce)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const J=ae?Ke(T):void 0,L=ce.data.config||{},ge=L.organization||"archiphoenix-org",W=L.environment||"prod",m=Array.isArray(L.proxies)?L.proxies:[],q=Array.isArray(L.policies)?L.policies:[],C=Array.isArray(L.products)?L.products:[],y=Array.isArray(L.developerApps)?L.developerApps:[],He=L.apiKey||"",[Ve,ve]=u.useState(null),[fe,Ne]=u.useState(!1),[re,ke]=u.useState("quota"),[Qe,Je]=u.useState(new Map),[We,de]=u.useState(null),[Be,oe]=u.useState(null),[Ss,ks]=u.useState(!1),[ye,he]=u.useState(null),[$,we]=u.useState(""),[B,Ee]=u.useState("all"),[H,qe]=u.useState("all"),[z,Ce]=u.useState(""),[X,Te]=u.useState("all"),[G,De]=u.useState("all"),[U,Fe]=u.useState(""),[V,Re]=u.useState(""),[ie,Ie]=u.useState("all"),xe=u.useCallback((s,a,r)=>{const i=[];return!s.name||s.name.trim()===""?i.push({field:"name",message:"Proxy name is required"}):/^[a-zA-Z0-9_-]+$/.test(s.name)?r.some((l,N)=>N!==a&&l.name===s.name)&&i.push({field:"name",message:"Proxy name must be unique"}):i.push({field:"name",message:"Proxy name can only contain letters, numbers, hyphens and underscores"}),(!s.basePath||!s.basePath.startsWith("/"))&&i.push({field:"basePath",message:"Base path must start with /"}),(!s.targetEndpoint||!s.targetEndpoint.match(/^https?:\/\/.+/))&&i.push({field:"targetEndpoint",message:"Target endpoint must be a valid URL (http:// or https://)"}),s.quota!==void 0&&s.quota<0&&i.push({field:"quota",message:"Quota must be a positive number"}),s.quotaInterval!==void 0&&s.quotaInterval<=0&&i.push({field:"quotaInterval",message:"Quota interval must be greater than 0"}),s.spikeArrest!==void 0&&s.spikeArrest<0&&i.push({field:"spikeArrest",message:"Spike arrest rate must be a positive number"}),i},[]),p=u.useCallback(s=>{const a={...L,...s};Se(T,{data:{...ce.data,config:a}});try{_.updateApigeeRoutingEngine(T)}catch(r){console.error("Failed to update Apigee routing engine:",r),v({title:"Update Error",description:"Failed to synchronize configuration with simulation engine",variant:"destructive"})}},[T,ce,L,Se,v]);u.useEffect(()=>{if(!ae)return;const s=_.getApigeeRoutingEngine(T);if(!s)return;const a=setInterval(()=>{const r=m.map(l=>{const N=s.getProxyMetrics(l.name);return N?{...l,requestCount:N.requestCount,errorCount:N.errorCount,avgResponseTime:N.avgResponseTime}:l});r.some((l,N)=>l.requestCount!==m[N]?.requestCount||l.errorCount!==m[N]?.errorCount||l.avgResponseTime!==m[N]?.avgResponseTime)&&p({proxies:r})},2e3);return()=>clearInterval(a)},[T,ae,m,p]),u.useEffect(()=>{try{_.updateApigeeRoutingEngine(T)}catch(s){console.error("Failed to sync configuration:",s)}},[T,m,q,C,ge,W]);const Xe=u.useCallback(()=>{const s={name:`proxy-${Date.now()}`,environment:W,basePath:"/api",targetEndpoint:"https://api.internal",revision:1,status:"undeployed",quota:1e3,quotaInterval:60,spikeArrest:50,enableOAuth:!1,requestCount:0,errorCount:0,avgResponseTime:0},a=xe(s,m.length,[...m,s]);if(a.length>0){v({title:"Validation Error",description:a.map(r=>r.message).join(", "),variant:"destructive"});return}p({proxies:[...m,s]}),v({title:"Proxy Created",description:`Proxy "${s.name}" has been created in ${W.toUpperCase()} environment`})},[m,xe,p,v,W]),Ge=u.useCallback(s=>{const a=m[s];a&&(p({proxies:m.filter((r,i)=>i!==s)}),v({title:"Proxy Deleted",description:`Proxy "${a.name}" has been deleted`}))},[m,p,v]),M=u.useCallback((s,a,r)=>{const i=[...m],l={...i[s],[a]:r};i[s]=l;const N=xe(l,s,i);Je(b=>{const Pe=new Map(b);return N.length>0?Pe.set(s,N):Pe.delete(s),Pe}),p({proxies:i})},[m,xe,p]),_e=u.useCallback(s=>{const a=m[s];if(!a)return;const r=a.status==="deployed"?"undeployed":"deployed";M(s,"status",r),v({title:`Proxy ${r==="deployed"?"Deployed":"Undeployed"}`,description:`Proxy "${a.name}" is now ${r}`})},[m,M,v]),Ye=u.useCallback(()=>{const s={quota:"Quota Policy","spike-arrest":"Spike Arrest Policy",oauth:"OAuth Policy",jwt:"JWT Policy","verify-api-key":"Verify API Key Policy",cors:"CORS Policy","xml-to-json":"XML to JSON Policy"},a={quota:"RequestFlow","spike-arrest":"RequestFlow",oauth:"PreFlow",jwt:"PreFlow","verify-api-key":"PreFlow",cors:"PostFlow","xml-to-json":"ResponseFlow"},r={id:`policy-${Date.now()}`,name:s[re]||"New Policy",type:re,enabled:!0,executionFlow:a[re],config:{}};p({policies:[...q,r]}),Ne(!1),ke("quota"),v({title:"Policy Created",description:`Policy "${r.name}" has been created`})},[q,re,p,v]),Ze=u.useCallback(s=>{const a=q.find(r=>r.id===s);p({policies:q.filter(r=>r.id!==s)}),a&&v({title:"Policy Deleted",description:`Policy "${a.name}" has been deleted`})},[q,p,v]),g=u.useCallback((s,a,r)=>{const i=q.map(l=>l.id===s?{...l,[a]:r}:l);p({policies:i})},[q,p]),es=u.useCallback(()=>{const s={id:`product-${Date.now()}`,name:`product-${Date.now()}`,displayName:`Product ${Date.now()}`,description:"",proxies:[],environments:["prod"],quota:1e3,quotaInterval:60,createdAt:Date.now(),updatedAt:Date.now()};p({products:[...C,s]}),de(s.id),v({title:"Product Created",description:`Product "${s.displayName}" has been created`})},[C,p,v]),ss=u.useCallback(s=>{const a=C.find(r=>r.id===s);p({products:C.filter(r=>r.id!==s)}),a&&v({title:"Product Deleted",description:`Product "${a.displayName||a.name}" has been deleted`})},[C,p,v]),K=u.useCallback((s,a,r)=>{const i=C.map(l=>l.id===s?{...l,[a]:r,updatedAt:Date.now()}:l);p({products:i})},[C,p]),ue=u.useMemo(()=>C.filter(s=>!U||s.name.toLowerCase().includes(U.toLowerCase())||s.displayName&&s.displayName.toLowerCase().includes(U.toLowerCase())||s.description&&s.description.toLowerCase().includes(U.toLowerCase())),[C,U]),as=u.useCallback(()=>{const s=_.getApigeeRoutingEngine(T),a=s?s.generateApiKey():`key-${Date.now()}`,r={id:`app-${Date.now()}`,name:`app-${Date.now()}`,displayName:`Developer App ${Date.now()}`,description:"",developerId:`dev-${Date.now()}`,developerEmail:"",status:"approved",apiProducts:[],keys:[{id:`key-${Date.now()}`,key:a,consumerKey:a,status:"approved",createdAt:Date.now(),apiProducts:[]}],createdAt:Date.now(),updatedAt:Date.now()};p({developerApps:[...y,r]}),oe(r.id),v({title:"Developer App Created",description:`Developer App "${r.displayName}" has been created`})},[y,T,p,v]),Le=u.useCallback(s=>{const a=y.find(r=>r.id===s);p({developerApps:y.filter(r=>r.id!==s)}),a&&v({title:"Developer App Deleted",description:`Developer App "${a.displayName||a.name}" has been deleted`})},[y,p,v]),F=u.useCallback((s,a,r)=>{const i=y.map(l=>l.id===s?{...l,[a]:r,updatedAt:Date.now()}:l);p({developerApps:i})},[y,p]),rs=u.useCallback(s=>{const a=_.getApigeeRoutingEngine(T),r=a?a.generateApiKey():`key-${Date.now()}`,i=y.find(N=>N.id===s);if(!i)return;const l={id:`key-${Date.now()}`,key:r,consumerKey:r,status:"approved",createdAt:Date.now(),apiProducts:i.apiProducts||[]};F(s,"keys",[...i.keys||[],l]),v({title:"API Key Created",description:"New API key has been generated for this app"})},[y,T,F,v]),is=u.useCallback((s,a)=>{const r=y.find(i=>i.id===s);r&&(F(s,"keys",(r.keys||[]).filter(i=>i.id!==a)),v({title:"API Key Deleted",description:"API key has been removed from this app"}))},[y,F,v]);u.useCallback((s,a,r,i)=>{const l=y.find(b=>b.id===s);if(!l)return;const N=(l.keys||[]).map(b=>b.id===a?{...b,[r]:i}:b);F(s,"keys",N)},[y,F]);const ts=u.useCallback((s,a)=>{const r=y.find(b=>b.id===s);if(!r)return;const i=r.apiProducts||[],l=i.includes(a)?i.filter(b=>b!==a):[...i,a];F(s,"apiProducts",l);const N=(r.keys||[]).map(b=>({...b,apiProducts:l}));F(s,"keys",N)},[y,F]),be=u.useMemo(()=>y.filter(s=>{const a=!V||s.name.toLowerCase().includes(V.toLowerCase())||s.displayName&&s.displayName.toLowerCase().includes(V.toLowerCase())||s.developerEmail&&s.developerEmail.toLowerCase().includes(V.toLowerCase()),r=ie==="all"||s.status===ie;return a&&r}),[y,V,ie]),ls=u.useCallback(s=>{if(!ae)return null;const a=_.getApigeeRoutingEngine(T);return a?a.getKeyUsageMetrics(s):null},[T,ae]),ns=u.useMemo(()=>J?.customMetrics?.total_requests||m.reduce((s,a)=>s+(a.requestCount||0),0),[J,m]);u.useMemo(()=>J?.customMetrics?.total_errors||m.reduce((s,a)=>s+(a.errorCount||0),0),[J,m]);const cs=u.useMemo(()=>J?.customMetrics?.avg_latency||(m.length>0?m.reduce((s,a)=>s+(a.avgResponseTime||0),0)/m.length:0),[J,m]),me=u.useMemo(()=>m.filter(s=>{const a=!$||s.name.toLowerCase().includes($.toLowerCase())||s.basePath.toLowerCase().includes($.toLowerCase())||s.targetEndpoint.toLowerCase().includes($.toLowerCase()),r=B==="all"||s.environment===B,i=H==="all"||H==="deployed"&&(s.status==="deployed"||!s.status)||H==="undeployed"&&s.status==="undeployed";return a&&r&&i}),[m,$,B,H]),je=u.useMemo(()=>q.filter(s=>{const a=!z||s.name.toLowerCase().includes(z.toLowerCase())||s.type.toLowerCase().includes(z.toLowerCase())||s.condition&&s.condition.toLowerCase().includes(z.toLowerCase()),r=X==="all"||s.type===X,i=G==="all"||s.executionFlow===G;return a&&r&&i}),[q,z,X,G]);return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Apigee API Platform"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"API Proxy Management"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure API proxies, policies, quotas and security"})]})}),e.jsx(O,{}),e.jsx(w,{className:"border-primary/20 bg-primary/5",children:e.jsx(P,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx(n,{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Active Environment"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Viewing and managing configuration for this environment"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(A,{value:W,onValueChange:s=>{p({environment:s}),v({title:"Environment Switched",description:`Switched to ${s.toUpperCase()} environment`})},children:[e.jsx(S,{className:"w-[180px]",children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"dev",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-yellow-500"}),e.jsx("span",{children:"Development"})]})}),e.jsx(t,{value:"stage",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-blue-500"}),e.jsx("span",{children:"Staging"})]})}),e.jsx(t,{value:"prod",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsx("span",{children:"Production"})]})})]})]}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Active environment determines which proxies and products are visible. Proxies deployed to this environment will be used for routing."})})]})})]})]})})}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(w,{children:[e.jsx(R,{className:"pb-3",children:e.jsx(I,{className:"text-sm font-medium",children:"Organization"})}),e.jsx(P,{children:e.jsx(D,{variant:"outline",children:ge})})]}),e.jsxs(w,{children:[e.jsx(R,{className:"pb-3",children:e.jsx(I,{className:"text-sm font-medium",children:"API Proxies"})}),e.jsx(P,{children:e.jsx("span",{className:"text-2xl font-bold",children:m.length})})]}),e.jsxs(w,{children:[e.jsx(R,{className:"pb-3",children:e.jsx(I,{className:"text-sm font-medium",children:"Total Requests"})}),e.jsx(P,{children:e.jsx("span",{className:"text-2xl font-bold",children:ns.toLocaleString()})})]}),e.jsxs(w,{children:[e.jsx(R,{className:"pb-3",children:e.jsx(I,{className:"text-sm font-medium",children:"Avg Response Time"})}),e.jsxs(P,{children:[e.jsx("span",{className:"text-2xl font-bold",children:cs.toFixed(0)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ms"})]})]})]}),e.jsxs(hs,{defaultValue:"proxies",className:"space-y-4",children:[e.jsxs(xs,{className:"flex-wrap h-auto min-h-[36px] w-full justify-start gap-1",children:[e.jsxs(Y,{value:"proxies",children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Proxies (",m.length,")"]}),e.jsxs(Y,{value:"policies",children:[e.jsx(bs,{className:"h-4 w-4 mr-2"}),"Policies (",q.length,")"]}),e.jsxs(Y,{value:"products",children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"Products (",C.length,")"]}),e.jsxs(Y,{value:"developer-apps",children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"Developer Apps (",y.length,")"]}),e.jsxs(Y,{value:"monitoring",disabled:m.filter(s=>s.status==="deployed"||!s.status).length===0,children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),"Monitoring (",m.filter(s=>s.status==="deployed"||!s.status).length,")"]}),e.jsxs(Y,{value:"settings",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(Z,{value:"proxies",className:"space-y-4",children:e.jsxs(w,{children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(I,{children:"API Proxies"}),e.jsx(Q,{children:"Configure and manage API proxies"})]}),e.jsxs(f,{onClick:Xe,size:"sm",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Create Proxy"]})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[m.length>0&&e.jsxs("div",{className:"space-y-3 pb-4 border-b",children:[e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(j,{placeholder:"Search proxies by name, base path, or endpoint...",value:$,onChange:s=>we(s.target.value),className:"pl-9"}),$&&e.jsx(f,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7",onClick:()=>we(""),children:e.jsx(ee,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(A,{value:B,onValueChange:Ee,children:[e.jsxs(S,{className:"w-[150px]",children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),e.jsx(k,{})]}),e.jsxs(E,{children:[e.jsx(t,{value:"all",children:"All Environments"}),e.jsx(t,{value:"dev",children:"Development"}),e.jsx(t,{value:"stage",children:"Staging"}),e.jsx(t,{value:"prod",children:"Production"})]})]}),e.jsxs(A,{value:H,onValueChange:qe,children:[e.jsxs(S,{className:"w-[150px]",children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),e.jsx(k,{})]}),e.jsxs(E,{children:[e.jsx(t,{value:"all",children:"All Statuses"}),e.jsx(t,{value:"deployed",children:"Deployed"}),e.jsx(t,{value:"undeployed",children:"Undeployed"})]})]}),($||B!=="all"||H!=="all")&&e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>{we(""),Ee("all"),qe("all")},children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Clear Filters"]})]}),me.length!==m.length&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Showing ",me.length," of ",m.length," proxies"]})]}),m.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No proxies configured. Create your first proxy to get started."}):me.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:$||B!=="all"||H!=="all"?"No proxies match your filters":"No proxies configured"}):me.map(s=>{const a=m.findIndex(i=>i.name===s.name),r=Qe.get(a)||[];return e.jsxs(w,{className:"border-l-4 border-l-blue-500",children:[e.jsx(R,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Me,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[Ve===a?e.jsx(j,{value:s.name,onChange:i=>M(a,"name",i.target.value),onBlur:()=>ve(null),onKeyDown:i=>{i.key==="Enter"&&ve(null)},className:"font-semibold text-base",autoFocus:!0}):e.jsx(I,{className:"text-base cursor-pointer hover:text-primary transition-colors",onClick:()=>ve(a),children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(D,{variant:s.status==="deployed"?"default":"outline",className:"cursor-pointer",onClick:()=>_e(a),children:s.status||"undeployed"}),e.jsx(D,{variant:"outline",children:s.environment}),e.jsxs(D,{variant:"outline",children:["Rev ",s.revision||1]})]})]})]}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>Ge(a),disabled:m.length===1,children:e.jsx(se,{className:"h-4 w-4"})})]})}),e.jsxs(P,{className:"space-y-4",children:[r.length>0&&e.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-md p-3 space-y-1",children:r.map((i,l)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive",children:[e.jsx(js,{className:"h-4 w-4"}),e.jsx("span",{children:i.message})]},l))}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Requests"}),e.jsx("p",{className:"text-lg font-semibold",children:(s.requestCount||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Errors"}),e.jsx("p",{className:"text-lg font-semibold text-red-500",children:(s.errorCount||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Response Time"}),e.jsxs("p",{className:"text-lg font-semibold",children:[(s.avgResponseTime||0).toFixed(0)," ms"]})]})]}),e.jsx(O,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Proxy Name"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Unique identifier for the API proxy. Can only contain letters, numbers, hyphens and underscores."})})]})})]}),e.jsx(j,{value:s.name,onChange:i=>M(a,"name",i.target.value),className:r.some(i=>i.field==="name")?"border-destructive":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Environment"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Deployment environment for this proxy. Determines which environment-specific configurations are applied."})})]})})]}),e.jsxs(A,{value:s.environment,onValueChange:i=>M(a,"environment",i),children:[e.jsx(S,{children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"dev",children:"Development"}),e.jsx(t,{value:"stage",children:"Staging"}),e.jsx(t,{value:"prod",children:"Production"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Base Path"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Base URL path for the API proxy. Must start with a forward slash (/). This path is prepended to all API requests."})})]})})]}),e.jsx(j,{value:s.basePath,onChange:i=>M(a,"basePath",i.target.value),placeholder:"/api",className:r.some(i=>i.field==="basePath")?"border-destructive":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Target Endpoint"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Backend service URL where requests are forwarded. Must be a valid HTTP or HTTPS URL."})})]})})]}),e.jsx(j,{value:s.targetEndpoint,onChange:i=>M(a,"targetEndpoint",i.target.value),placeholder:"https://api.internal",className:r.some(i=>i.field==="targetEndpoint")?"border-destructive":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Quota (requests)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Maximum number of requests allowed per quota interval. Set to 0 to disable quota limiting."})})]})})]}),e.jsx(j,{type:"number",value:s.quota||0,onChange:i=>M(a,"quota",Number(i.target.value)),className:r.some(i=>i.field==="quota")?"border-destructive":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Quota Interval (seconds)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Time window in seconds for quota calculation. The quota limit applies to this time period."})})]})})]}),e.jsx(j,{type:"number",value:s.quotaInterval||60,onChange:i=>M(a,"quotaInterval",Number(i.target.value)),className:r.some(i=>i.field==="quotaInterval")?"border-destructive":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Spike Arrest (req/sec)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Maximum requests per second allowed. Prevents traffic spikes by smoothing out request rate. Set to 0 to disable."})})]})})]}),e.jsx(j,{type:"number",value:s.spikeArrest||0,onChange:i=>M(a,"spikeArrest",Number(i.target.value)),className:r.some(i=>i.field==="spikeArrest")?"border-destructive":""})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Enable OAuth"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Enable OAuth 2.0 authentication for this proxy. Requires valid OAuth tokens for API access."})})]})})]}),e.jsx(ne,{checked:s.enableOAuth||!1,onCheckedChange:i=>M(a,"enableOAuth",i)})]})]}),s.enableOAuth&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"JWT Issuer"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"JWT token issuer identifier. Used to validate JWT tokens issued by this OAuth provider."})})]})})]}),e.jsx(j,{value:s.jwtIssuer||"",onChange:i=>M(a,"jwtIssuer",i.target.value),placeholder:"auth.archi"})]})]})]},a)})]})})]})}),e.jsx(Z,{value:"policies",className:"space-y-4",children:e.jsxs(w,{children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(I,{children:"Policies"}),e.jsx(Q,{children:"Configure API proxy policies"})]}),e.jsxs(f,{onClick:()=>Ne(!0),size:"sm",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Add Policy"]})]})}),e.jsxs(P,{children:[q.length>0&&e.jsxs("div",{className:"space-y-3 pb-4 border-b mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(j,{placeholder:"Search policies by name, type, or condition...",value:z,onChange:s=>Ce(s.target.value),className:"pl-9"}),z&&e.jsx(f,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7",onClick:()=>Ce(""),children:e.jsx(ee,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(A,{value:X,onValueChange:Te,children:[e.jsxs(S,{className:"w-[180px]",children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),e.jsx(k,{})]}),e.jsxs(E,{children:[e.jsx(t,{value:"all",children:"All Types"}),e.jsx(t,{value:"quota",children:"Quota"}),e.jsx(t,{value:"spike-arrest",children:"Spike Arrest"}),e.jsx(t,{value:"verify-api-key",children:"Verify API Key"}),e.jsx(t,{value:"oauth",children:"OAuth"}),e.jsx(t,{value:"jwt",children:"JWT"}),e.jsx(t,{value:"cors",children:"CORS"}),e.jsx(t,{value:"xml-to-json",children:"XML to JSON"})]})]}),e.jsxs(A,{value:G,onValueChange:De,children:[e.jsxs(S,{className:"w-[180px]",children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),e.jsx(k,{})]}),e.jsxs(E,{children:[e.jsx(t,{value:"all",children:"All Flows"}),e.jsx(t,{value:"PreFlow",children:"PreFlow"}),e.jsx(t,{value:"RequestFlow",children:"RequestFlow"}),e.jsx(t,{value:"ResponseFlow",children:"ResponseFlow"}),e.jsx(t,{value:"PostFlow",children:"PostFlow"}),e.jsx(t,{value:"ErrorFlow",children:"ErrorFlow"})]})]}),(z||X!=="all"||G!=="all")&&e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>{Ce(""),Te("all"),De("all")},children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Clear Filters"]})]}),je.length!==q.length&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Showing ",je.length," of ",q.length," policies"]})]}),fe&&e.jsx(w,{className:"mb-4 border-l-4 border-l-blue-500",children:e.jsx(P,{className:"pt-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(n,{className:"text-sm font-semibold",children:"Policy Type"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{className:"max-w-sm",children:e.jsx("p",{children:"The policy type determines its functionality and cannot be changed after creation. Each policy type has specific configuration options and execution behavior."})})]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Select the type of policy to add. The type determines the policy's functionality and cannot be changed after creation."}),e.jsxs(A,{value:re,onValueChange:s=>ke(s),children:[e.jsx(S,{children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"quota",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Quota Policy"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Limit total requests per time period"})]})}),e.jsx(t,{value:"spike-arrest",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Spike Arrest Policy"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Smooth traffic spikes by rate limiting"})]})}),e.jsx(t,{value:"verify-api-key",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Verify API Key"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Validate API keys in requests"})]})}),e.jsx(t,{value:"oauth",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"OAuth Policy"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"OAuth 2.0 authentication and authorization"})]})}),e.jsx(t,{value:"jwt",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"JWT Policy"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"JWT token validation and verification"})]})}),e.jsx(t,{value:"cors",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"CORS Policy"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Cross-origin resource sharing configuration"})]})}),e.jsx(t,{value:"xml-to-json",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"XML to JSON"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Transform XML responses to JSON format"})]})})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{onClick:Ye,size:"sm",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Create Policy"]}),e.jsx(f,{variant:"outline",onClick:()=>Ne(!1),size:"sm",children:"Cancel"})]})]})})}),q.length===0&&!fe?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No policies configured"}):je.length===0&&!fe?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:z||X!=="all"||G!=="all"?"No policies match your filters":"No policies configured"}):e.jsx("div",{className:"space-y-2",children:je.map(s=>e.jsx(w,{className:"border-l-4 border-l-green-500",children:e.jsxs(P,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(D,{variant:"outline",title:"Policy type - determines functionality and cannot be changed",children:s.type}),e.jsx("span",{className:"font-medium",children:s.name}),s.enabled?e.jsx(D,{variant:"default",children:"Enabled"}):e.jsx(D,{variant:"outline",children:"Disabled"}),s.executionFlow&&e.jsx(D,{variant:"secondary",className:"text-xs",children:s.executionFlow})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",s.type,s.executionFlow&&` • Execution: ${s.executionFlow}`,s.condition&&` • Condition: ${s.condition}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{checked:s.enabled,onCheckedChange:a=>g(s.id,"enabled",a)}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>he(s.id),title:"Edit policy configuration",children:e.jsx(Ps,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>Ze(s.id),children:e.jsx(se,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(n,{className:"text-xs",children:"Execution Flow"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"PreFlow:"})," Authentication policies (OAuth, JWT, API Key)"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"RequestFlow:"})," Quota and rate limiting policies"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ResponseFlow:"})," Response transformation policies"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"PostFlow:"})," CORS and final transformations"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"ErrorFlow:"})," Error handling policies"]})]})})]})})]}),e.jsxs(A,{value:s.executionFlow||"RequestFlow",onValueChange:a=>g(s.id,"executionFlow",a),children:[e.jsx(S,{className:"h-8 text-xs",children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"PreFlow",children:"PreFlow (Auth)"}),e.jsx(t,{value:"RequestFlow",children:"RequestFlow (Quota/Rate Limit)"}),e.jsx(t,{value:"ResponseFlow",children:"ResponseFlow (Response Transform)"}),e.jsx(t,{value:"PostFlow",children:"PostFlow (Transform/CORS)"}),e.jsx(t,{value:"ErrorFlow",children:"ErrorFlow (Error Handling)"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx(n,{className:"text-xs",children:"Condition (optional)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Conditional expression to determine when this policy executes. Examples: request.path = '/api', request.verb = 'GET'"})})]})})]}),e.jsx(j,{value:s.condition||"",onChange:a=>g(s.id,"condition",a.target.value),placeholder:"e.g., request.path = '/api'",className:"h-8 text-xs"})]})]})})]})},s.id))})]})]})}),e.jsx(Z,{value:"products",className:"space-y-4",children:e.jsxs(w,{children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(I,{children:"API Products"}),e.jsx(Q,{children:"Group proxies together for access control and quota management"})]}),e.jsxs(f,{onClick:es,size:"sm",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Create Product"]})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[C.length>0&&e.jsxs("div",{className:"space-y-3 pb-4 border-b",children:[e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(j,{placeholder:"Search products by name, display name, or description...",value:U,onChange:s=>Fe(s.target.value),className:"pl-9"}),U&&e.jsx(f,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-7 w-7",onClick:()=>Fe(""),children:e.jsx(ee,{className:"h-4 w-4"})})]}),ue.length!==C.length&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Showing ",ue.length," of ",C.length," products"]})]}),C.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No products configured. Create your first product to group proxies together."}):ue.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:U?"No products match your search":"No products configured"}):ue.map(s=>{const a=m.filter(r=>(s.proxies||[]).includes(r.name));return e.jsxs(w,{className:"border-l-4 border-l-orange-500",children:[e.jsx(R,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx($e,{className:"h-5 w-5 text-orange-500"}),We===s.id?e.jsx(j,{value:s.displayName||s.name,onChange:r=>K(s.id,"displayName",r.target.value),onBlur:()=>de(null),onKeyDown:r=>{r.key==="Enter"&&de(null)},className:"font-semibold text-base",autoFocus:!0}):e.jsx(I,{className:"text-base cursor-pointer hover:text-primary transition-colors",onClick:()=>de(s.id),children:s.displayName||s.name}),e.jsxs(D,{variant:"outline",children:[(s.proxies||[]).length," ",(s.proxies||[]).length===1?"proxy":"proxies"]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description})]}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>ss(s.id),children:e.jsx(se,{className:"h-4 w-4"})})]})}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Product Name"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Unique identifier for the API product. Used internally for product identification."})})]})})]}),e.jsx(j,{value:s.name,onChange:r=>K(s.id,"name",r.target.value),placeholder:"product-name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Display Name"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Human-readable name for the API product. Shown in developer portals and dashboards."})})]})})]}),e.jsx(j,{value:s.displayName||"",onChange:r=>K(s.id,"displayName",r.target.value),placeholder:"Product Display Name"})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Description"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Description of the API product. Helps developers understand what APIs are included in this product."})})]})})]}),e.jsx(j,{value:s.description||"",onChange:r=>K(s.id,"description",r.target.value),placeholder:"Product description"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Quota (requests)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Product-level quota limit. Maximum requests allowed per quota interval for all proxies in this product."})})]})})]}),e.jsx(j,{type:"number",value:s.quota||0,onChange:r=>K(s.id,"quota",Number(r.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Quota Interval (seconds)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Time window in seconds for product-level quota calculation."})})]})})]}),e.jsx(j,{type:"number",value:s.quotaInterval||60,onChange:r=>K(s.id,"quotaInterval",Number(r.target.value))})]})]}),e.jsx(O,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Environments"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Environments where this product is available. Proxies in this product must be deployed to these environments."})})]})})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:["dev","stage","prod"].map(r=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`product-${s.id}-env-${r}`,checked:s.environments?.includes(r)||!1,onChange:i=>{const l=s.environments||[],N=i.target.checked?[...l,r]:l.filter(b=>b!==r);K(s.id,"environments",N)},className:"rounded"}),e.jsx(n,{htmlFor:`product-${s.id}-env-${r}`,className:"text-sm font-normal cursor-pointer",children:r})]},r))})]}),e.jsx(O,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Associated Proxies"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Select which API proxies are included in this product. Proxies can belong to multiple products."})})]})})]}),m.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No proxies available. Create proxies first."}):e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border rounded-md p-2",children:m.map(r=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`product-${s.id}-proxy-${r.name}`,checked:(s.proxies||[]).includes(r.name),onChange:i=>{const l=s.proxies||[],N=i.target.checked?[...l,r.name]:l.filter(b=>b!==r.name);K(s.id,"proxies",N)},className:"rounded"}),e.jsx(n,{htmlFor:`product-${s.id}-proxy-${r.name}`,className:"text-sm font-normal flex-1 cursor-pointer",children:r.name}),e.jsx(D,{variant:"outline",className:"text-xs",children:r.environment}),r.status==="deployed"||!r.status?e.jsx(D,{variant:"default",className:"text-xs",children:"Deployed"}):e.jsx(D,{variant:"outline",className:"text-xs",children:"Undeployed"})]},r.name))}),a.length>0&&e.jsxs("div",{className:"mt-2 p-2 bg-muted rounded-md",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Selected proxies:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:a.map(r=>e.jsx(D,{variant:"secondary",className:"text-xs",children:r.name},r.name))})]})]})]})]},s.id)})]})})]})}),e.jsx(Z,{value:"developer-apps",className:"space-y-4",children:e.jsxs(w,{children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(I,{children:"Developer Apps"}),e.jsx(Q,{children:"Manage developer applications and API keys"})]}),e.jsxs(f,{onClick:as,size:"sm",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Create App"]})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[y.length>0&&e.jsxs("div",{className:"space-y-3 pb-4 border-b",children:[e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(j,{placeholder:"Search apps by name, email...",value:V,onChange:s=>Re(s.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(A,{value:ie,onValueChange:Ie,children:[e.jsx(S,{className:"w-[180px]",children:e.jsx(k,{placeholder:"Filter by status"})}),e.jsxs(E,{children:[e.jsx(t,{value:"all",children:"All Status"}),e.jsx(t,{value:"approved",children:"Approved"}),e.jsx(t,{value:"pending",children:"Pending"}),e.jsx(t,{value:"revoked",children:"Revoked"})]})]}),(V||ie!=="all")&&e.jsxs(f,{variant:"ghost",size:"sm",onClick:()=>{Re(""),Ie("all")},children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),"Clear"]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",be.length," of ",y.length," apps"]})]}),be.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:y.length===0?e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No developer apps yet"}),e.jsx("p",{className:"text-sm mt-2",children:"Create your first developer app to start managing API keys"})]}):e.jsx("p",{children:"No apps match your search criteria"})}):e.jsx("div",{className:"space-y-4",children:be.map(s=>{const a=Be===s.id,r={approved:"bg-green-500",pending:"bg-yellow-500",revoked:"bg-red-500"};return e.jsxs(w,{className:"relative",children:[e.jsx(R,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(I,{className:"text-base",children:a?e.jsx(j,{value:s.displayName||s.name,onChange:i=>F(s.id,"displayName",i.target.value),className:"h-8 font-semibold",placeholder:"App Display Name"}):s.displayName||s.name}),e.jsx(D,{variant:"outline",className:`${r[s.status||"pending"]} text-white border-0`,children:s.status||"pending"})]}),a&&e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-xs",children:"App Name"}),e.jsx(j,{value:s.name,onChange:i=>F(s.id,"name",i.target.value),className:"h-8 text-xs",placeholder:"app-name"})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-xs",children:"Developer Email"}),e.jsx(j,{type:"email",value:s.developerEmail||"",onChange:i=>F(s.id,"developerEmail",i.target.value),className:"h-8 text-xs",placeholder:"developer@example.com"})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-xs",children:"Description"}),e.jsx(j,{value:s.description||"",onChange:i=>F(s.id,"description",i.target.value),className:"h-8 text-xs",placeholder:"App description"})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-xs",children:"Status"}),e.jsxs(A,{value:s.status||"pending",onValueChange:i=>F(s.id,"status",i),children:[e.jsx(S,{className:"h-8 text-xs",children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"approved",children:"Approved"}),e.jsx(t,{value:"pending",children:"Pending"}),e.jsx(t,{value:"revoked",children:"Revoked"})]})]})]})]}),!a&&s.description&&e.jsx(Q,{className:"mt-1",children:s.description}),!a&&s.developerEmail&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.developerEmail})]}),e.jsx("div",{className:"flex items-center gap-2",children:a?e.jsxs(e.Fragment,{children:[e.jsx(f,{size:"sm",variant:"outline",onClick:()=>oe(null),children:"Done"}),e.jsx(f,{size:"sm",variant:"destructive",onClick:()=>{Le(s.id),oe(null)},children:e.jsx(se,{className:"h-4 w-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{size:"sm",variant:"outline",onClick:()=>oe(s.id),children:"Edit"}),e.jsx(f,{size:"sm",variant:"destructive",onClick:()=>Le(s.id),children:e.jsx(se,{className:"h-4 w-4"})})]})})]})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-sm font-medium mb-2 block",children:"API Products"}),e.jsx("div",{className:"space-y-2",children:C.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No products available"}):C.map(i=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`app-${s.id}-product-${i.id}`,checked:(s.apiProducts||[]).includes(i.id),onChange:()=>ts(s.id,i.id),className:"rounded"}),e.jsx(n,{htmlFor:`app-${s.id}-product-${i.id}`,className:"text-sm font-normal cursor-pointer",children:i.displayName||i.name})]},i.id))})]}),e.jsx(O,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs(n,{className:"text-sm font-medium",children:["API Keys (",(s.keys||[]).length,")"]}),e.jsxs(f,{size:"sm",variant:"outline",onClick:()=>rs(s.id),children:[e.jsx(As,{className:"h-4 w-4 mr-1"}),"Add Key"]})]}),e.jsx("div",{className:"space-y-2",children:(s.keys||[]).length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No API keys"}):(s.keys||[]).map(i=>{const l=ls(i.key);return e.jsx(w,{className:"p-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("code",{className:"text-xs bg-muted px-2 py-1 rounded font-mono",children:[i.key.substring(0,20),"..."]}),e.jsx(D,{variant:"outline",className:i.status==="approved"?"bg-green-500 text-white border-0":"bg-red-500 text-white border-0",children:i.status||"approved"})]}),l&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:["Requests: ",l.requestCount.toLocaleString()]}),l.lastUsed>0&&e.jsxs("span",{className:"ml-2",children:["Last used: ",new Date(l.lastUsed).toLocaleString()]})]}),i.expiresAt&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Expires: ",new Date(i.expiresAt).toLocaleDateString()]})]}),e.jsx(f,{size:"sm",variant:"ghost",onClick:()=>is(s.id,i.id),children:e.jsx(se,{className:"h-4 w-4"})})]})},i.id)})})]})]})})]},s.id)})})]})})]})}),e.jsx(Z,{value:"monitoring",className:"space-y-4",children:e.jsxs(w,{children:[e.jsxs(R,{children:[e.jsx(I,{children:"API Analytics"}),e.jsx(Q,{children:"Monitor API proxy performance and usage"})]}),e.jsx(P,{children:e.jsx("div",{className:"space-y-4",children:m.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No proxies to monitor"}):m.map((s,a)=>e.jsxs(w,{className:"border-l-4 border-l-purple-500",children:[e.jsx(R,{className:"pb-3",children:e.jsx(I,{className:"text-base",children:s.name})}),e.jsx(P,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Total Requests"}),e.jsx("p",{className:"text-2xl font-bold",children:(s.requestCount||0).toLocaleString()}),e.jsx(Ae,{value:Math.min((s.requestCount||0)/1e4*100,100),className:"h-2 mt-2"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Errors"}),e.jsx("p",{className:"text-2xl font-bold text-red-500",children:(s.errorCount||0).toLocaleString()}),e.jsx(Ae,{value:Math.min((s.errorCount||0)/100*100,100),className:"h-2 mt-2"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Avg Response Time"}),e.jsxs("p",{className:"text-2xl font-bold",children:[(s.avgResponseTime||0).toFixed(0)," ms"]}),e.jsx(Ae,{value:Math.min((s.avgResponseTime||0)/1e3*100,100),className:"h-2 mt-2"})]})]})})]},a))})})]})}),e.jsx(Z,{value:"settings",className:"space-y-4",children:e.jsxs(w,{children:[e.jsxs(R,{children:[e.jsx(I,{children:"Apigee Settings"}),e.jsx(Q,{children:"Configure organization and API access"})]}),e.jsxs(P,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Organization"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Apigee organization name. This identifies your organization in the Apigee platform."})})]})})]}),e.jsx(j,{value:ge,onChange:s=>p({organization:s.target.value}),placeholder:"my-organization"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Active Environment"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Active environment for viewing and managing configuration. New proxies will be created in this environment. Use the environment selector at the top to switch environments."})})]})})]}),e.jsxs(A,{value:W,onValueChange:s=>{p({environment:s}),v({title:"Environment Switched",description:`Switched to ${s.toUpperCase()} environment`})},children:[e.jsx(S,{children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"dev",children:"Development"}),e.jsx(t,{value:"stage",children:"Staging"}),e.jsx(t,{value:"prod",children:"Production"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This environment is used for viewing configuration and creating new proxies. Proxies can be deployed to different environments."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"API Key"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Apigee API key for authentication. Used to authenticate API calls to Apigee management APIs."})})]})})]}),e.jsx(j,{type:"password",value:He,onChange:s=>p({apiKey:s.target.value}),placeholder:"Enter Apigee API key"})]})]})]})})]}),ye&&(()=>{const s=q.find(r=>r.id===ye);if(!s)return null;const a=s.config||{};return e.jsx(ps,{open:!!ye,onOpenChange:r=>!r&&he(null),children:e.jsxs(gs,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(vs,{children:[e.jsxs(fs,{children:["Configure ",s.name]}),e.jsxs(Ns,{children:["Configure advanced settings for ",s.type," policy"]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Policy Name"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Name of the policy. Used for identification and logging."})})]})})]}),e.jsx(j,{value:s.name,onChange:r=>g(s.id,"name",r.target.value),placeholder:"Policy name"})]}),s.type==="quota"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Allow Count"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Maximum number of requests allowed in the time interval."})})]})})]}),e.jsx(j,{type:"number",min:"1",value:a.quota||a.allowCount||"",onChange:r=>{const i=parseInt(r.target.value)||0;g(s.id,"config",{...a,quota:i,allowCount:i})},placeholder:"1000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Interval (seconds)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Time window in seconds for the quota limit."})})]})})]}),e.jsx(j,{type:"number",min:"1",value:a.interval||a.quotaInterval||"",onChange:r=>{const i=parseInt(r.target.value)||0;g(s.id,"config",{...a,interval:i,quotaInterval:i})},placeholder:"60"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Time Unit"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Time unit for the quota interval (seconds, minutes, hours, days)."})})]})})]}),e.jsxs(A,{value:a.timeUnit||"second",onValueChange:r=>g(s.id,"config",{...a,timeUnit:r}),children:[e.jsx(S,{children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"second",children:"Second"}),e.jsx(t,{value:"minute",children:"Minute"}),e.jsx(t,{value:"hour",children:"Hour"}),e.jsx(t,{value:"day",children:"Day"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{checked:a.distributed||!1,onCheckedChange:r=>g(s.id,"config",{...a,distributed:r})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Distributed"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Enable distributed quota tracking across multiple gateway instances."})})]})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{checked:a.synchronized||!1,onCheckedChange:r=>g(s.id,"config",{...a,synchronized:r})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Synchronized"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Synchronize quota counters across all gateway instances."})})]})})]})]})]}),s.type==="spike-arrest"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Rate (requests per time unit)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Maximum number of requests allowed per time unit."})})]})})]}),e.jsx(j,{type:"number",min:"1",value:a.rate||"",onChange:r=>{const i=parseInt(r.target.value)||0;g(s.id,"config",{...a,rate:i})},placeholder:"10"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Time Unit"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Time unit for the rate limit (second, minute)."})})]})})]}),e.jsxs(A,{value:a.timeUnit||"second",onValueChange:r=>g(s.id,"config",{...a,timeUnit:r}),children:[e.jsx(S,{children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"second",children:"Per Second"}),e.jsx(t,{value:"minute",children:"Per Minute"})]})]})]})]}),s.type==="oauth"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Token Endpoint"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"OAuth 2.0 token endpoint URL for token validation."})})]})})]}),e.jsx(j,{value:a.tokenEndpoint||"",onChange:r=>g(s.id,"config",{...a,tokenEndpoint:r.target.value}),placeholder:"https://oauth.example.com/token"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Client ID"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"OAuth client ID for authentication."})})]})})]}),e.jsx(j,{value:a.clientId||"",onChange:r=>g(s.id,"config",{...a,clientId:r.target.value}),placeholder:"client-id"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Client Secret"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"OAuth client secret for authentication."})})]})})]}),e.jsx(j,{type:"password",value:a.clientSecret||"",onChange:r=>g(s.id,"config",{...a,clientSecret:r.target.value}),placeholder:"client-secret"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Scopes (comma-separated)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Required OAuth scopes for this policy. Multiple scopes can be specified, separated by commas."})})]})})]}),e.jsx(j,{value:Array.isArray(a.scopes)?a.scopes.join(", "):a.scopes||"",onChange:r=>{const i=r.target.value.split(",").map(l=>l.trim()).filter(l=>l);g(s.id,"config",{...a,scopes:i})},placeholder:"read, write"})]})]}),s.type==="jwt"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Issuer"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"JWT issuer (iss claim) that must match the token issuer."})})]})})]}),e.jsx(j,{value:a.issuer||"",onChange:r=>g(s.id,"config",{...a,issuer:r.target.value}),placeholder:"https://jwt.example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Audience"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"JWT audience (aud claim) that must be present in the token."})})]})})]}),e.jsx(j,{value:a.audience||"",onChange:r=>g(s.id,"config",{...a,audience:r.target.value}),placeholder:"api.example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Public Key"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Public key (PEM format) for verifying JWT signature."})})]})})]}),e.jsx(Oe,{value:a.publicKey||"",onChange:r=>g(s.id,"config",{...a,publicKey:r.target.value}),placeholder:`-----BEGIN PUBLIC KEY-----
...
-----END PUBLIC KEY-----`,rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Algorithm"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"JWT signature algorithm (RS256, HS256, ES256, etc.)."})})]})})]}),e.jsxs(A,{value:a.algorithm||"RS256",onValueChange:r=>g(s.id,"config",{...a,algorithm:r}),children:[e.jsx(S,{children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"RS256",children:"RS256 (RSA with SHA-256)"}),e.jsx(t,{value:"HS256",children:"HS256 (HMAC with SHA-256)"}),e.jsx(t,{value:"ES256",children:"ES256 (ECDSA with SHA-256)"}),e.jsx(t,{value:"RS384",children:"RS384 (RSA with SHA-384)"}),e.jsx(t,{value:"HS384",children:"HS384 (HMAC with SHA-384)"}),e.jsx(t,{value:"ES384",children:"ES384 (ECDSA with SHA-384)"}),e.jsx(t,{value:"RS512",children:"RS512 (RSA with SHA-512)"}),e.jsx(t,{value:"HS512",children:"HS512 (HMAC with SHA-512)"}),e.jsx(t,{value:"ES512",children:"ES512 (ECDSA with SHA-512)"})]})]})]})]}),s.type==="verify-api-key"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Key Name"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Name of the header or query parameter that contains the API key."})})]})})]}),e.jsx(j,{value:a.keyName||"X-API-Key",onChange:r=>g(s.id,"config",{...a,keyName:r.target.value}),placeholder:"X-API-Key"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Location"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Where to look for the API key: in HTTP headers or query parameters."})})]})})]}),e.jsxs(A,{value:a.location||"header",onValueChange:r=>g(s.id,"config",{...a,location:r}),children:[e.jsx(S,{children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"header",children:"Header"}),e.jsx(t,{value:"query",children:"Query Parameter"}),e.jsx(t,{value:"headerOrQuery",children:"Header or Query"})]})]})]})]}),s.type==="cors"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Allowed Origins (comma-separated)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"List of allowed origins for CORS. Use * for all origins, or specify specific domains."})})]})})]}),e.jsx(j,{value:Array.isArray(a.origins)?a.origins.join(", "):a.origins||"*",onChange:r=>{const i=r.target.value.split(",").map(l=>l.trim()).filter(l=>l);g(s.id,"config",{...a,origins:i})},placeholder:"https://example.com, https://app.example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Allowed Methods (comma-separated)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"HTTP methods allowed for CORS requests (GET, POST, PUT, DELETE, etc.)."})})]})})]}),e.jsx(j,{value:Array.isArray(a.methods)?a.methods.join(", "):a.methods||"GET, POST, PUT, DELETE",onChange:r=>{const i=r.target.value.split(",").map(l=>l.trim()).filter(l=>l);g(s.id,"config",{...a,methods:i})},placeholder:"GET, POST, PUT, DELETE"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Allowed Headers (comma-separated)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"HTTP headers allowed in CORS requests."})})]})})]}),e.jsx(j,{value:Array.isArray(a.headers)?a.headers.join(", "):a.headers||"Content-Type, Authorization",onChange:r=>{const i=r.target.value.split(",").map(l=>l.trim()).filter(l=>l);g(s.id,"config",{...a,headers:i})},placeholder:"Content-Type, Authorization"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Max Age (seconds)"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Maximum time in seconds that a browser can cache the preflight response."})})]})})]}),e.jsx(j,{type:"number",min:"0",value:a.maxAge||"3600",onChange:r=>{const i=parseInt(r.target.value)||0;g(s.id,"config",{...a,maxAge:i})},placeholder:"3600"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{checked:a.allowCredentials||!1,onCheckedChange:r=>g(s.id,"config",{...a,allowCredentials:r})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Allow Credentials"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Allow cookies and credentials to be sent with CORS requests."})})]})})]})]})]}),s.type==="xml-to-json"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(O,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Options"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"Additional options for XML to JSON transformation (JSON string)."})})]})})]}),e.jsx(Oe,{value:typeof a.options=="string"?a.options:JSON.stringify(a.options||{},null,2),onChange:r=>{try{const i=JSON.parse(r.target.value);g(s.id,"config",{...a,options:i})}catch{g(s.id,"config",{...a,options:r.target.value})}},placeholder:'{"attributePrefix": "@", "textNode": "$t"}',rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Attributes"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"How to handle XML attributes in JSON (prefix, ignore, etc.)."})})]})})]}),e.jsxs(A,{value:a.attributes||"prefix",onValueChange:r=>g(s.id,"config",{...a,attributes:r}),children:[e.jsx(S,{children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"prefix",children:"Prefix (@attribute)"}),e.jsx(t,{value:"ignore",children:"Ignore"}),e.jsx(t,{value:"preserve",children:"Preserve"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{children:"Namespaces"}),e.jsx(d,{children:e.jsxs(o,{children:[e.jsx(h,{asChild:!0,children:e.jsx(c,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(x,{children:e.jsx("p",{children:"How to handle XML namespaces in JSON (prefix, ignore, etc.)."})})]})})]}),e.jsxs(A,{value:a.namespaces||"prefix",onValueChange:r=>g(s.id,"config",{...a,namespaces:r}),children:[e.jsx(S,{children:e.jsx(k,{})}),e.jsxs(E,{children:[e.jsx(t,{value:"prefix",children:"Prefix (ns:element)"}),e.jsx(t,{value:"ignore",children:"Ignore"}),e.jsx(t,{value:"preserve",children:"Preserve"})]})]})]})]})]}),e.jsxs(ys,{children:[e.jsx(f,{variant:"outline",onClick:()=>he(null),children:"Cancel"}),e.jsxs(f,{onClick:()=>{he(null),v({title:"Policy Updated",description:`Configuration for "${s.name}" has been saved`})},children:[e.jsx(ws,{className:"h-4 w-4 mr-2"}),"Save Configuration"]})]})]})})})()]})})}export{$s as ApigeeConfigAdvanced};

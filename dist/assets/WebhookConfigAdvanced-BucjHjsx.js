import{J as qs,j as e,ae as Ks,u as Xs,a as Gs,e as Ys,r as d,l as c,ac as Zs,ad as Qs,S as Oe,C as R,h as T,i as I,m as k,T as et,b as st,c as ze,A as tt,d as at,f as $e,k as Me,aa as ls,o as is,P as ds,O as cs,I as S,_ as os,af as rt,B as A,V as oe,x as he,X as nt,L as i,q as Z,s as Q,U as lt,t as ee,v as se,w as m,ag as hs,ah as it,a8 as dt,D as Je,y as Ue,z as We,E as He,G as _e,H as Ve,$ as ct,a1 as ot,a2 as ht,a3 as xt,a4 as mt,a5 as ut,a6 as jt,a7 as pt}from"./index-CK7lW0SB.js";import{T as xe}from"./textarea-CJ0ebXZg.js";import{T as u,a as j,b as p,c as f}from"./tooltip-C4xa5N9E.js";import{a as D,s as E}from"./toast-CuAtBd-t.js";import{R as ft}from"./refresh-ccw-DMpGPr4r.js";import{W as me}from"./webhook-Bwu9wqvs.js";import{S as Be}from"./send-CT_nbrho.js";import{C as qe}from"./circle-check-big-ZHrlop6r.js";import{R as be,C as we,X as Ce,Y as ke,T as Se,L as xs,a as ms}from"./LineChart-Bm-L2_Xu.js";import{A as us,a as Ke}from"./AreaChart-DRIXfz0i.js";import{C as js}from"./clock-CvabIh5t.js";import{L as ps}from"./loader-circle-CO1hxnMU.js";const gt=[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]],vt=qs("test-tube",gt);function ue({className:U,...De}){return e.jsx("div",{className:Ks("animate-pulse rounded-md bg-primary/10",U),...De})}function Ft({componentId:U}){const{nodes:De,updateNode:fs}=Xs(),{componentMetrics:gs}=Gs(),Ee=De.find(s=>s.id===U);if(!Ee)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const x=Ee.data.config||{},h=x.endpoints||[],P=Ys.getWebhookEmulationEngine(U),Xe=P?P.getDeliveries():[],g=Xe.length>0?Xe:x.deliveries||[],b=gs.get(U)?.customMetrics||{},vs=d.useMemo(()=>b.endpoints_total??h.length,[b.endpoints_total,h.length]),Ns=d.useMemo(()=>b.deliveries_total??g.length,[b.deliveries_total,g.length]),ys=d.useMemo(()=>b.success_rate!==void 0?b.success_rate:g.length>0?g.filter(t=>t.status==="success").length/g.length*100:0,[b.success_rate,g]),[Re,W]=d.useState(!1),[H,Te]=d.useState(null),[O,_]=d.useState(null),[$,Ge]=d.useState(""),[V,Ye]=d.useState(""),[te,bs]=d.useState("all"),[je,ws]=d.useState("all"),[pe,Ze]=d.useState(!1),[n,L]=d.useState({name:"",url:"",method:"POST",secret:"",enabled:!0,events:"",headers:"",allowedIPs:"",timeoutDuration:30,errorRate:10}),[N,Pe]=d.useState({}),[B,fe]=d.useState(null),[F,ge]=d.useState({eventType:"",payload:"{}",headers:"{}"}),[q,K]=d.useState(null),[Qe,ve]=d.useState(!1),[X,ae]=d.useState(null),[re,ne]=d.useState({}),[es,Le]=d.useState(!1),[v,G]=d.useState(new Set),[ss,Cs]=d.useState(new Set),[Ne,ts]=d.useState(null),[z,Y]=d.useState(1),[M,ks]=d.useState(20),[le,Ss]=d.useState("all"),as=d.useRef(null),Fe=d.useMemo(()=>JSON.stringify(x),[x]);d.useEffect(()=>{if(P&&Fe)try{const s=JSON.parse(Fe);P.updateConfig(s)}catch(s){console.error("Error updating webhook config:",s)}},[Fe,P]);const ie=d.useMemo(()=>{if(!$)return h;const s=$.toLowerCase();return h.filter(t=>t.name.toLowerCase().includes(s)||t.url.toLowerCase().includes(s)||t.events.some(a=>a.toLowerCase().includes(s)))},[h,$]),rs=d.useMemo(()=>{let s=g;if(te!=="all"&&(s=s.filter(t=>t.status===te)),je!=="all"&&(s=s.filter(t=>t.endpointId===je)),V){const t=V.toLowerCase();s=s.filter(a=>a.event.toLowerCase().includes(t)||a.endpointId.toLowerCase().includes(t)||a.payload.toLowerCase().includes(t))}return s.sort((t,a)=>new Date(a.timestamp).getTime()-new Date(t.timestamp).getTime())},[g,te,V,je]),y=s=>{fs(U,{data:{...Ee.data,config:{...x,...s}}})},Ds=s=>{if(/^(\d{1,3}\.){3}\d{1,3}$/.test(s))return s.split(".").map(Number).every(l=>l>=0&&l<=255);if(/^(\d{1,3}\.){3}\d{1,3}\/\d{1,2}$/.test(s)){const[r,l]=s.split("/"),o=parseInt(l,10);return o<0||o>32?!1:r.split(".").map(Number).every(C=>C>=0&&C<=255)}return!1},Es=()=>{const s={};if(n.name.trim()||(s.name="Name is required"),!n.url.trim())s.url="URL is required";else{const t=n.url.trim(),a=/^https?:\/\//i.test(t),r=t.startsWith("/");if(!a&&!r)try{new URL(t)}catch{s.url="URL must be absolute (http:// or https://) or relative path (starting with /)"}else if(a)try{new URL(t)}catch{s.url="Invalid URL format"}}if(n.events){const t=n.events.split(",").map(a=>a.trim()).filter(a=>a);for(const a of t)if(!/^[a-zA-Z0-9_-]+$/.test(a)){s.events=`Invalid event name: ${a}. Use alphanumeric characters, dashes, and underscores.`;break}}if(n.headers)try{const t=JSON.parse(n.headers);(typeof t!="object"||Array.isArray(t))&&(s.headers="Headers must be a valid JSON object")}catch{s.headers="Invalid JSON format for headers"}if(n.allowedIPs){const t=n.allowedIPs.split(",").map(a=>a.trim()).filter(a=>a);for(const a of t)if(!Ds(a)){s.allowedIPs=`Invalid IP address or CIDR: ${a}. Use format like 192.168.1.1 or 10.0.0.0/8`;break}}if(n.timeoutDuration!==void 0){const t=n.timeoutDuration;(isNaN(t)||t<1||t>300)&&(s.timeoutDuration="Timeout must be between 1 and 300 seconds")}if(n.errorRate!==void 0){const t=n.errorRate;(isNaN(t)||t<0||t>100)&&(s.errorRate="Error rate must be between 0 and 100 percent")}return Pe(s),Object.keys(s).length===0},Ie=()=>{L({name:"",url:"",method:"POST",secret:"",enabled:!0,events:"",headers:"",allowedIPs:"",timeoutDuration:30,errorRate:10}),Pe({}),Te(null),W(!0)},Rs=s=>{L({name:s.name,url:s.url,method:s.method,secret:s.secret||"",enabled:s.enabled,events:s.events.join(", "),headers:s.headers?JSON.stringify(s.headers,null,2):"",allowedIPs:s.allowedIPs?.join(", ")||"",timeoutDuration:s.timeoutDuration||30,errorRate:s.errorRate||10}),Pe({}),Te(s),W(!0)},Ts=()=>{if(!Es()){E("Please fix validation errors");return}try{const s=n.events?n.events.split(",").map(l=>l.trim()).filter(l=>l):[];let t={};if(n.headers)try{if(t=JSON.parse(n.headers),typeof t!="object"||Array.isArray(t)){E("Headers must be a valid JSON object");return}}catch{E("Invalid JSON format for headers");return}const a=n.allowedIPs?n.allowedIPs.split(",").map(l=>l.trim()).filter(l=>l):void 0,r={id:H?.id||`wh-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:n.name.trim(),url:n.url.trim(),method:n.method,secret:n.secret.trim()||void 0,enabled:n.enabled,events:s,headers:Object.keys(t).length>0?t:void 0,allowedIPs:a,timeoutDuration:n.timeoutDuration||30,errorRate:n.errorRate||10};if(H){const l=h.map(o=>o.id===H.id?r:o);y({endpoints:l}),D("Endpoint updated successfully")}else y({endpoints:[...h,r]}),D("Endpoint created successfully");W(!1),Te(null)}catch(s){console.error("Error saving endpoint:",s),E("Failed to save endpoint. Please try again.")}},Ps=s=>{y({endpoints:h.filter(t=>t.id!==s)}),D("Endpoint deleted successfully"),_(null)},ns=s=>{switch(s){case"success":return"bg-green-500";case"failed":return"bg-red-500";case"pending":return"bg-yellow-500";default:return"bg-gray-500"}},Ls=async()=>{Ze(!0);try{P&&P.updateConfig(x),await new Promise(s=>setTimeout(s,100)),D("Data refreshed")}catch(s){console.error("Error refreshing data:",s),E("Failed to refresh data")}finally{Ze(!1)}},ye=(s,t)=>{navigator.clipboard.writeText(s),ts(t),setTimeout(()=>ts(null),2e3),D("Copied to clipboard")},Fs=async s=>{const t=h.find(a=>a.id===s);t&&(fe(s),ge({eventType:t.events[0]||"test.event",payload:'{"test": "data"}',headers:"{}"}),K(null))},Is=async()=>{if(!B)return;const s=h.find(t=>t.id===B);if(s){ve(!0),K(null);try{let t={};try{t=JSON.parse(F.headers||"{}")}catch{E("Invalid JSON in headers"),ve(!1);return}let a={};try{a=JSON.parse(F.payload||"{}")}catch{E("Invalid JSON in payload"),ve(!1);return}if(P){const r=Date.now(),l=P.processWebhookRequest({url:s.url,method:s.method,headers:{...t,"x-event":F.eventType},body:a,event:F.eventType}),o=Date.now()-r;K({status:l.status,body:l.error||"Success",latency:o})}else{const r=50+Math.random()*150;await new Promise(l=>setTimeout(l,r)),K({status:200,body:JSON.stringify({received:!0,timestamp:Date.now()}),latency:Math.round(r)})}}catch(t){console.error("Error testing webhook:",t),E("Failed to test webhook"),K({status:500,body:String(t),latency:0})}finally{ve(!1)}}},As=s=>{const t=g.find(a=>a.id===s);t&&(ae(s),ne({payload:t.payload,headers:"{}"}))},Os=async()=>{if(!X)return;const s=g.find(a=>a.id===X);if(!s)return;const t=h.find(a=>a.id===s.endpointId);if(!t){E("Endpoint not found");return}Le(!0);try{let a={};try{a=JSON.parse(re.payload||s.payload)}catch{E("Invalid JSON in payload"),Le(!1);return}if(P){const r=P.processWebhookRequest({url:t.url,method:t.method,body:a,event:s.event});r.success?D("Delivery retried successfully"):E(`Retry failed: ${r.error||"Unknown error"}`)}else D("Delivery retry initiated");ae(null),ne({})}catch(a){console.error("Error retrying delivery:",a),E("Failed to retry delivery")}finally{Le(!1)}},zs=s=>{const t=new Set(v);t.has(s)?t.delete(s):t.add(s),G(t)},$s=()=>{G(new Set(ie.map(s=>s.id)))},Ms=()=>{G(new Set)},Js=()=>{const s=h.map(t=>v.has(t.id)?{...t,enabled:!0}:t);y({endpoints:s}),D(`${v.size} endpoint(s) enabled`),G(new Set)},Us=()=>{const s=h.map(t=>v.has(t.id)?{...t,enabled:!1}:t);y({endpoints:s}),D(`${v.size} endpoint(s) disabled`),G(new Set)},Ws=()=>{const s=h.filter(t=>!v.has(t.id));y({endpoints:s}),D(`${v.size} endpoint(s) deleted`),G(new Set)},Hs=s=>{const t={...s,id:`wh-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:`${s.name} (Copy)`};y({endpoints:[...h,t]}),D("Endpoint duplicated")},_s=()=>{const s={endpoints:h,config:{enableRetryOnFailure:x.enableRetryOnFailure,enableSignatureVerification:x.enableSignatureVerification,maxRetryAttempts:x.maxRetryAttempts,retryDelay:x.retryDelay,timeout:x.timeout,retryBackoff:x.retryBackoff,enableRateLimiting:x.enableRateLimiting,rateLimitPerMinute:x.rateLimitPerMinute}},t=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`webhook-config-${Date.now()}.json`,r.click(),URL.revokeObjectURL(a),D("Configuration exported")},Vs=()=>{const s=document.createElement("input");s.type="file",s.accept="application/json",s.onchange=t=>{const a=t.target.files?.[0];if(!a)return;const r=new FileReader;r.onload=l=>{try{const o=JSON.parse(l.target?.result);o.endpoints&&Array.isArray(o.endpoints)?(y({endpoints:o.endpoints,...o.config}),D("Configuration imported")):E("Invalid configuration file")}catch(o){console.error("Error importing config:",o),E("Failed to import configuration")}},r.readAsText(a)},s.click()},Bs=s=>{const t=new Set(ss);t.has(s)?t.delete(s):t.add(s),Cs(t)};d.useEffect(()=>{const s=t=>{const a=t.ctrlKey||t.metaKey;if(a&&t.key==="n"){const r=t.target;if(r.tagName==="INPUT"||r.tagName==="TEXTAREA")return;t.preventDefault(),Ie();return}if(a&&t.key==="f"){const r=t.target;if(r.tagName==="INPUT"||r.tagName==="TEXTAREA")return;t.preventDefault(),as.current?.focus();return}t.key==="Escape"&&(Re&&W(!1),B&&fe(null),X&&ae(null),O&&_(null))};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[Re,B,X,O]);const de=d.useMemo(()=>{let s=rs;if(le!=="all"){const t=Date.now();let a=0;switch(le){case"1h":a=t-3600*1e3;break;case"24h":a=t-1440*60*1e3;break;case"7d":a=t-10080*60*1e3;break;case"30d":a=t-720*60*60*1e3;break}s=s.filter(r=>new Date(r.timestamp).getTime()>=a)}return s},[rs,le]),Ae=d.useMemo(()=>{const s=(z-1)*M,t=s+M;return de.slice(s,t)},[de,z,M]),J=Math.ceil(de.length/M);return e.jsxs("div",{className:"h-full overflow-y-auto bg-background",children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Webhook"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Webhook Endpoint"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"HTTP callback endpoint for event notifications"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",onClick:_s,children:[e.jsx(Zs,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Export"})]})}),e.jsx(f,{children:"Export configuration (Ctrl/Cmd + E)"})]})}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",onClick:Vs,children:[e.jsx(Qs,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Import"})]})}),e.jsx(f,{children:"Import configuration from JSON file"})]})}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",onClick:Ls,disabled:pe,children:[e.jsx(ft,{className:`h-4 w-4 mr-2 ${pe?"animate-spin":""}`}),pe?"Refreshing...":"Refresh"]})}),e.jsx(f,{children:"Refresh data and metrics"})]})})]})]}),e.jsx(Oe,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(R,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{className:"text-sm font-medium text-muted-foreground",children:"Endpoints"}),e.jsx(me,{className:"h-4 w-4 text-blue-500"})]})}),e.jsxs(k,{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:vs}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"configured"})]}),b.endpoints_enabled!==void 0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[b.endpoints_enabled," enabled"]})]})]}),e.jsxs(R,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{className:"text-sm font-medium text-muted-foreground",children:"Deliveries"}),e.jsx(Be,{className:"h-4 w-4 text-green-500"})]})}),e.jsxs(k,{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:Ns}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"total"})]}),b.deliveries_success!==void 0&&b.deliveries_failed!==void 0&&e.jsxs("div",{className:"flex gap-2 mt-1 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"text-green-600 dark:text-green-400",children:[b.deliveries_success," success"]}),e.jsxs("span",{className:"text-red-600 dark:text-red-400",children:[b.deliveries_failed," failed"]})]})]})]}),e.jsxs(R,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{className:"text-sm font-medium text-muted-foreground",children:"Success Rate"}),e.jsx(qe,{className:"h-4 w-4 text-purple-500"})]})}),e.jsxs(k,{children:[e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsxs("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:[ys.toFixed(1),"%"]})}),b.rps!==void 0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[b.rps.toFixed(1)," req/s"]})]})]})]}),g.length>0&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs(R,{children:[e.jsx(T,{className:"pb-3",children:e.jsx(I,{className:"text-sm",children:"Success Rate Trend"})}),e.jsx(k,{children:e.jsx(be,{width:"100%",height:150,children:e.jsxs(us,{data:(()=>{const s=Date.now(),t=[];for(let a=6;a>=0;a--){const r=s-a*24*60*60*1e3,l=g.filter(C=>{const ce=new Date(C.timestamp).getTime();return ce>=r-1440*60*1e3&&ce<r}),o=l.filter(C=>C.status==="success").length,w=l.length;t.push({date:new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric"}),rate:w>0?o/w*100:0})}return t})(),children:[e.jsx(we,{strokeDasharray:"3 3",stroke:"hsl(var(--muted))"}),e.jsx(Ce,{dataKey:"date",tick:{fontSize:10}}),e.jsx(ke,{domain:[0,100],tick:{fontSize:10}}),e.jsx(Se,{formatter:s=>`${s.toFixed(1)}%`}),e.jsx(Ke,{type:"monotone",dataKey:"rate",stroke:"#22c55e",fill:"#22c55e",fillOpacity:.2})]})})})]}),e.jsxs(R,{children:[e.jsx(T,{className:"pb-3",children:e.jsx(I,{className:"text-sm",children:"Average Latency"})}),e.jsx(k,{children:e.jsx(be,{width:"100%",height:150,children:e.jsxs(xs,{data:(()=>{const s=Date.now(),t=[];for(let a=6;a>=0;a--){const r=s-a*24*60*60*1e3,l=g.filter(w=>{const C=new Date(w.timestamp).getTime();return C>=r-1440*60*1e3&&C<r}).filter(w=>w.latency!==void 0),o=l.length>0?l.reduce((w,C)=>w+(C.latency||0),0)/l.length:0;t.push({date:new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric"}),latency:Math.round(o)})}return t})(),children:[e.jsx(we,{strokeDasharray:"3 3",stroke:"hsl(var(--muted))"}),e.jsx(Ce,{dataKey:"date",tick:{fontSize:10}}),e.jsx(ke,{tick:{fontSize:10}}),e.jsx(Se,{formatter:s=>`${s}ms`}),e.jsx(ms,{type:"monotone",dataKey:"latency",stroke:"#3b82f6",strokeWidth:2,dot:!1})]})})})]})]}),e.jsxs(et,{defaultValue:"endpoints",className:"space-y-4",children:[e.jsxs(st,{className:"flex-wrap w-full justify-start",children:[e.jsxs(ze,{value:"endpoints",className:"flex-shrink-0",children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Endpoints"}),e.jsx("span",{className:"sm:hidden",children:"Endpoints"}),e.jsxs("span",{className:"ml-1",children:["(",h.length,")"]})]}),e.jsxs(ze,{value:"deliveries",className:"flex-shrink-0",children:[e.jsx(tt,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Deliveries"}),e.jsx("span",{className:"sm:hidden",children:"Deliveries"}),e.jsxs("span",{className:"ml-1",children:["(",g.length,")"]})]}),e.jsxs(ze,{value:"settings",className:"flex-shrink-0",children:[e.jsx(at,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Settings"}),e.jsx("span",{className:"sm:hidden",children:"Settings"})]})]}),e.jsx($e,{value:"endpoints",className:"space-y-4",children:e.jsxs(R,{children:[e.jsx(T,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{children:"Webhook Endpoints"}),e.jsx(Me,{children:"Configure webhook endpoints"})]}),e.jsxs("div",{className:"flex gap-2",children:[v.size>0&&e.jsxs(e.Fragment,{children:[e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",onClick:Js,children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Enable (",v.size,")"]})}),e.jsx(f,{children:"Enable selected endpoints"})]})}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",onClick:Us,children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Disable (",v.size,")"]})}),e.jsx(f,{children:"Disable selected endpoints"})]})}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>{v.size>0&&_("bulk")},className:"text-destructive",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Delete (",v.size,")"]})}),e.jsx(f,{children:"Delete selected endpoints"})]})})]}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsxs(c,{onClick:Ie,size:"sm",children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Create Endpoint"]})}),e.jsx(f,{children:"Create new endpoint (Ctrl/Cmd + N)"})]})})]})]})}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(S,{ref:as,placeholder:"Search endpoints... (Ctrl/Cmd + F)",value:$,onChange:s=>Ge(s.target.value),className:"pl-10"}),$&&e.jsx(c,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6",onClick:()=>Ge(""),children:e.jsx(os,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(c,{variant:"outline",size:"sm",onClick:v.size===ie.length?Ms:$s,children:v.size===ie.length?"Deselect All":"Select All"})}),e.jsx(f,{children:"Select or deselect all endpoints"})]})})})]}),e.jsx("div",{className:"space-y-4",children:ie.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(me,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:$?"No endpoints match your search":"No endpoints configured"}),!$&&e.jsxs(c,{onClick:Ie,size:"sm",className:"mt-4",children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Create your first endpoint"]})]}):ie.map(s=>e.jsxs(R,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-all duration-200 bg-card animate-in fade-in slide-in-from-top-2",children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"pt-2",children:e.jsx(rt,{checked:v.has(s.id),onCheckedChange:()=>zs(s.id)})}),e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:e.jsx(me,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(I,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[e.jsx(A,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"}),e.jsx(A,{variant:"outline",className:"font-mono text-xs",children:s.method}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(A,{variant:"outline",className:"font-mono text-xs truncate max-w-xs cursor-help",children:s.url})}),e.jsx(f,{children:e.jsx("div",{className:"max-w-md break-all",children:s.url})})]})}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>ye(s.url,`url-${s.id}`),children:e.jsx(oe,{className:`h-3 w-3 ${Ne===`url-${s.id}`?"text-green-600":""}`})})}),e.jsx(f,{children:"Copy URL to clipboard"})]})})]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(he,{checked:s.enabled,onCheckedChange:t=>{const a=h.map(r=>r.id===s.id?{...r,enabled:t}:r);y({endpoints:a}),D(t?"Endpoint enabled":"Endpoint disabled")}})}),e.jsx(f,{children:s.enabled?"Disable endpoint":"Enable endpoint"})]})}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>Fs(s.id),className:"hover:bg-green-50 dark:hover:bg-green-900/20",children:e.jsx(vt,{className:"h-4 w-4"})})}),e.jsx(f,{children:"Test webhook"})]})}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>Hs(s),className:"hover:bg-blue-50 dark:hover:bg-blue-900/20",children:e.jsx(oe,{className:"h-4 w-4"})})}),e.jsx(f,{children:"Duplicate endpoint"})]})}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>Rs(s),className:"hover:bg-blue-50 dark:hover:bg-blue-900/20",children:e.jsx(nt,{className:"h-4 w-4"})})}),e.jsx(f,{children:"Edit endpoint"})]})}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>_(s.id),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(is,{className:"h-4 w-4"})})}),e.jsx(f,{children:"Delete endpoint"})]})})]})]})}),e.jsxs(k,{children:[s.events&&s.events.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-xs",children:"Events"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.events.map((t,a)=>e.jsx(A,{variant:"outline",className:"text-xs",children:t},`${s.id}-event-${a}`))})]}),s.secret&&e.jsxs("div",{className:"mt-2",children:[e.jsx(i,{className:"text-xs",children:"Secret"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-xs font-mono text-muted-foreground",children:"••••••••"}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>{s.secret&&ye(s.secret,`secret-${s.id}`)},children:e.jsx(oe,{className:`h-3 w-3 ${Ne===`secret-${s.id}`?"text-green-600":""}`})})}),e.jsx(f,{children:"Copy secret to clipboard"})]})})]})]}),s.headers&&Object.keys(s.headers).length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx(i,{className:"text-xs",children:"Custom Headers"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[Object.keys(s.headers).length," header(s)"]})]}),s.allowedIPs&&s.allowedIPs.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx(i,{className:"text-xs",children:"Allowed IPs"}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.allowedIPs.length," IP range(s)"]})]}),(()=>{const t=P?.getEndpointMetrics(s.id);return t&&t.totalDeliveries>0?e.jsxs("div",{className:"mt-4 pt-4 border-t space-y-2",children:[e.jsx(i,{className:"text-xs font-semibold",children:"Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Deliveries:"}),e.jsx("span",{className:"ml-1 font-medium",children:t.totalDeliveries})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Success Rate:"}),e.jsxs("span",{className:`ml-1 font-medium ${t.successRate>=95?"text-green-600":t.successRate>=80?"text-yellow-600":"text-red-600"}`,children:[t.successRate.toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Avg Latency:"}),e.jsxs("span",{className:"ml-1 font-medium",children:[t.averageLatency,"ms"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"RPS:"}),e.jsx("span",{className:"ml-1 font-medium",children:t.requestsPerSecond.toFixed(2)})]})]})]}):null})()]})]},s.id))})]})]})}),e.jsxs($e,{value:"deliveries",className:"space-y-4",children:[g.length>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(R,{children:[e.jsx(T,{className:"pb-3",children:e.jsx(I,{className:"text-sm",children:"Success vs Failed (Last 7 Days)"})}),e.jsx(k,{children:e.jsx(be,{width:"100%",height:120,children:e.jsxs(us,{data:(()=>{const s=Date.now(),t=[];for(let a=6;a>=0;a--){const r=s-a*24*60*60*1e3,l=g.filter(o=>{const w=new Date(o.timestamp).getTime();return w>=r-1440*60*1e3&&w<r});t.push({date:new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric"}),success:l.filter(o=>o.status==="success").length,failed:l.filter(o=>o.status==="failed").length})}return t})(),children:[e.jsx(we,{strokeDasharray:"3 3",stroke:"hsl(var(--muted))"}),e.jsx(Ce,{dataKey:"date",tick:{fontSize:10}}),e.jsx(ke,{tick:{fontSize:10}}),e.jsx(Se,{}),e.jsx(Ke,{type:"monotone",dataKey:"success",stackId:"1",stroke:"#22c55e",fill:"#22c55e",fillOpacity:.6}),e.jsx(Ke,{type:"monotone",dataKey:"failed",stackId:"1",stroke:"#ef4444",fill:"#ef4444",fillOpacity:.6})]})})})]}),e.jsxs(R,{children:[e.jsx(T,{className:"pb-3",children:e.jsx(I,{className:"text-sm",children:"Error Rate Trend"})}),e.jsx(k,{children:e.jsx(be,{width:"100%",height:120,children:e.jsxs(xs,{data:(()=>{const s=Date.now(),t=[];for(let a=6;a>=0;a--){const r=s-a*24*60*60*1e3,l=g.filter(C=>{const ce=new Date(C.timestamp).getTime();return ce>=r-1440*60*1e3&&ce<r}),o=l.filter(C=>C.status==="failed").length,w=l.length;t.push({date:new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric"}),errorRate:w>0?o/w*100:0})}return t})(),children:[e.jsx(we,{strokeDasharray:"3 3",stroke:"hsl(var(--muted))"}),e.jsx(Ce,{dataKey:"date",tick:{fontSize:10}}),e.jsx(ke,{domain:[0,100],tick:{fontSize:10}}),e.jsx(Se,{formatter:s=>`${s.toFixed(1)}%`}),e.jsx(ms,{type:"monotone",dataKey:"errorRate",stroke:"#ef4444",strokeWidth:2,dot:!1})]})})})]})]}),e.jsxs(R,{children:[e.jsxs(T,{children:[e.jsx(I,{children:"Delivery History"}),e.jsx(Me,{children:"Webhook delivery attempts and results"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(S,{placeholder:"Search deliveries...",value:V,onChange:s=>Ye(s.target.value),className:"pl-10"}),V&&e.jsx(c,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6",onClick:()=>Ye(""),children:e.jsx(os,{className:"h-3 w-3"})})]}),e.jsxs(Z,{value:te,onValueChange:s=>bs(s),children:[e.jsxs(Q,{className:"w-full sm:w-[180px]",children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),e.jsx(ee,{})]}),e.jsxs(se,{children:[e.jsx(m,{value:"all",children:"All Status"}),e.jsx(m,{value:"success",children:"Success"}),e.jsx(m,{value:"failed",children:"Failed"}),e.jsx(m,{value:"pending",children:"Pending"})]})]}),e.jsxs(Z,{value:le,onValueChange:s=>{Ss(s),Y(1)},children:[e.jsxs(Q,{className:"w-full sm:w-[180px]",children:[e.jsx(js,{className:"h-4 w-4 mr-2"}),e.jsx(ee,{})]}),e.jsxs(se,{children:[e.jsx(m,{value:"all",children:"All Time"}),e.jsx(m,{value:"1h",children:"Last Hour"}),e.jsx(m,{value:"24h",children:"Last 24 Hours"}),e.jsx(m,{value:"7d",children:"Last 7 Days"}),e.jsx(m,{value:"30d",children:"Last 30 Days"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[h.length>0&&e.jsxs(Z,{value:je,onValueChange:s=>{ws(s),Y(1)},children:[e.jsxs(Q,{className:"w-full sm:w-[200px]",children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),e.jsx(ee,{placeholder:"Filter by endpoint"})]}),e.jsxs(se,{children:[e.jsx(m,{value:"all",children:"All Endpoints"}),h.map(s=>e.jsx(m,{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{className:"text-sm",children:"Page size:"}),e.jsxs(Z,{value:String(M),onValueChange:s=>{ks(Number(s)),Y(1)},children:[e.jsx(Q,{className:"w-[100px]",children:e.jsx(ee,{})}),e.jsxs(se,{children:[e.jsx(m,{value:"20",children:"20"}),e.jsx(m,{value:"50",children:"50"}),e.jsx(m,{value:"100",children:"100"})]})]})]})]})]}),e.jsx("div",{className:"space-y-4",children:pe&&Ae.length===0?e.jsx(e.Fragment,{children:[1,2,3].map(s=>e.jsxs(R,{className:"border-l-4 border-l-gray-300",children:[e.jsx(T,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx(ue,{className:"h-9 w-9 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(ue,{className:"h-5 w-32"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ue,{className:"h-5 w-16"}),e.jsx(ue,{className:"h-5 w-20"})]})]})]})})}),e.jsx(k,{children:e.jsx(ue,{className:"h-4 w-24"})})]},s))}):Ae.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(Be,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:V||te!=="all"||le!=="all"?"No deliveries match your filters":"No deliveries yet"}),e.jsx("p",{className:"text-sm",children:"Deliveries will appear here when webhooks are sent"})]}):e.jsxs(e.Fragment,{children:[Ae.map(s=>{const t=ss.has(s.id),a=h.find(r=>r.id===s.endpointId);return e.jsxs(R,{className:`border-l-4 ${s.status==="success"?"border-l-green-500":s.status==="failed"?"border-l-red-500":"border-l-yellow-500"} hover:shadow-md transition-all duration-200 bg-card animate-in fade-in slide-in-from-top-2`,children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg ${ns(s.status)}/20`,children:s.status==="success"?e.jsx(qe,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):s.status==="failed"?e.jsx(ls,{className:"h-5 w-5 text-red-600 dark:text-red-400"}):e.jsx(js,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(I,{className:"text-lg font-semibold",children:s.event}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[e.jsx(A,{variant:"outline",className:ns(s.status),children:s.status}),s.attempts&&e.jsxs(A,{variant:"outline",children:["Attempts: ",s.attempts]}),s.responseCode&&e.jsxs(A,{variant:"outline",children:["HTTP ",s.responseCode]}),s.latency&&e.jsxs(A,{variant:"outline",children:[s.latency,"ms"]}),a&&e.jsx(A,{variant:"outline",className:"font-normal",children:a.name})]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[s.status==="failed"&&e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>As(s.id),className:"hover:bg-green-50 dark:hover:bg-green-900/20",children:e.jsx(hs,{className:"h-4 w-4"})})}),e.jsx(f,{children:"Retry delivery"})]})}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>Bs(s.id),children:t?e.jsx(it,{className:"h-4 w-4"}):e.jsx(dt,{className:"h-4 w-4"})})}),e.jsxs(f,{children:[t?"Collapse":"Expand"," details"]})]})})]})]})}),t&&e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Payload"}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>ye(s.payload,`payload-${s.id}`),children:e.jsx(oe,{className:`h-3 w-3 ${Ne===`payload-${s.id}`?"text-green-600":""}`})})}),e.jsx(f,{children:"Copy payload to clipboard"})]})})]}),e.jsx("pre",{className:"p-3 bg-muted rounded text-xs font-mono overflow-x-auto max-h-60 overflow-y-auto",children:(()=>{try{return JSON.stringify(JSON.parse(s.payload),null,2)}catch{return s.payload}})()})]}),s.responseBody&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Response"}),e.jsx(u,{children:e.jsxs(j,{children:[e.jsx(p,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>ye(s.responseBody||"",`response-${s.id}`),children:e.jsx(oe,{className:`h-3 w-3 ${Ne===`response-${s.id}`?"text-green-600":""}`})})}),e.jsx(f,{children:"Copy response to clipboard"})]})})]}),e.jsx("pre",{className:"p-3 bg-muted rounded text-xs font-mono overflow-x-auto max-h-60 overflow-y-auto",children:(()=>{try{return JSON.stringify(JSON.parse(s.responseBody),null,2)}catch{return s.responseBody}})()})]}),s.error&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-destructive",children:"Error"}),e.jsx("div",{className:"p-3 bg-destructive/10 rounded text-sm text-destructive",children:s.error})]}),s.retryHistory&&s.retryHistory.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Retry History"}),e.jsx("div",{className:"space-y-2",children:s.retryHistory.map((r,l)=>e.jsxs("div",{className:"p-2 bg-muted rounded text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:["Attempt ",r.attempt,":"]}),e.jsxs(A,{variant:"outline",children:["HTTP ",r.status]}),e.jsx("span",{className:"text-muted-foreground",children:r.timestamp})]}),r.error&&e.jsx("div",{className:"mt-1 text-destructive text-xs",children:r.error})]},l))})]}),e.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t",children:[e.jsxs("div",{children:["Timestamp: ",new Date(s.timestamp).toLocaleString()]}),s.latency&&e.jsxs("div",{children:["Latency: ",s.latency,"ms"]})]})]}),!t&&e.jsx(k,{children:e.jsxs("div",{className:"text-xs text-muted-foreground",children:[new Date(s.timestamp).toLocaleString(),s.latency&&` • ${s.latency}ms`]})})]},s.id)}),J>1&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(z-1)*M+1," to ",Math.min(z*M,de.length)," of ",de.length," deliveries"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>Y(s=>Math.max(1,s-1)),disabled:z===1,children:"Previous"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,J)},(s,t)=>{let a;return J<=5||z<=3?a=t+1:z>=J-2?a=J-4+t:a=z-2+t,e.jsx(c,{variant:z===a?"default":"outline",size:"sm",onClick:()=>Y(a),className:"w-8",children:a},a)})}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>Y(s=>Math.min(J,s+1)),disabled:z===J,children:"Next"})]})]})]})})]})]})]}),e.jsx($e,{value:"settings",className:"space-y-4",children:e.jsxs(R,{children:[e.jsxs(T,{children:[e.jsx(I,{children:"Webhook Settings"}),e.jsx(Me,{children:"Global configuration"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{children:"Enable Retry on Failure"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically retry failed deliveries"})]}),e.jsx(he,{checked:x.enableRetryOnFailure??!0,onCheckedChange:s=>y({enableRetryOnFailure:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{children:"Enable Signature Verification"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Verify webhook signatures for security"})]}),e.jsx(he,{checked:x.enableSignatureVerification??!0,onCheckedChange:s=>y({enableSignatureVerification:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{children:"Enable Rate Limiting"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Limit requests per minute"})]}),e.jsx(he,{checked:x.enableRateLimiting??!1,onCheckedChange:s=>y({enableRateLimiting:s})})]}),e.jsx(Oe,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Max Retry Attempts"}),e.jsx(S,{type:"number",value:x.maxRetryAttempts??3,onChange:s=>y({maxRetryAttempts:parseInt(s.target.value)||3}),min:1,max:10}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum number of retry attempts for failed deliveries"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Retry Delay (seconds)"}),e.jsx(S,{type:"number",value:x.retryDelay??5,onChange:s=>y({retryDelay:parseInt(s.target.value)||5}),min:1}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Delay between retry attempts"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Retry Backoff Strategy"}),e.jsxs(Z,{value:x.retryBackoff||"exponential",onValueChange:s=>y({retryBackoff:s}),children:[e.jsx(Q,{children:e.jsx(ee,{})}),e.jsxs(se,{children:[e.jsx(m,{value:"exponential",children:"Exponential"}),e.jsx(m,{value:"linear",children:"Linear"}),e.jsx(m,{value:"constant",children:"Constant"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Timeout (seconds)"}),e.jsx(S,{type:"number",value:x.timeout??30,onChange:s=>y({timeout:parseInt(s.target.value)||30}),min:1}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Request timeout duration"})]}),x.enableRateLimiting&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Rate Limit (per minute)"}),e.jsx(S,{type:"number",value:x.rateLimitPerMinute??100,onChange:s=>y({rateLimitPerMinute:parseInt(s.target.value)||100}),min:1}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum requests per minute"})]})]})]})})]})]}),e.jsx(Je,{open:Re,onOpenChange:W,children:e.jsxs(Ue,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(We,{children:[e.jsx(He,{children:H?"Edit Endpoint":"Create Endpoint"}),e.jsx(_e,{children:H?"Update webhook endpoint configuration":"Create a new webhook endpoint to receive event notifications"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"endpoint-name",children:"Name *"}),e.jsx(S,{id:"endpoint-name",value:n.name,onChange:s=>L({...n,name:s.target.value}),placeholder:"My Webhook Endpoint"}),N.name&&e.jsx("p",{className:"text-xs text-destructive",children:N.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"endpoint-url",children:"URL *"}),e.jsx(S,{id:"endpoint-url",value:n.url,onChange:s=>L({...n,url:s.target.value}),placeholder:"https://api.example.com/webhooks"}),N.url&&e.jsx("p",{className:"text-xs text-destructive",children:N.url})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"endpoint-method",children:"HTTP Method"}),e.jsxs(Z,{value:n.method,onValueChange:s=>L({...n,method:s}),children:[e.jsx(Q,{children:e.jsx(ee,{})}),e.jsxs(se,{children:[e.jsx(m,{value:"POST",children:"POST"}),e.jsx(m,{value:"PUT",children:"PUT"}),e.jsx(m,{value:"PATCH",children:"PATCH"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"endpoint-secret",children:"Secret (optional)"}),e.jsx(S,{id:"endpoint-secret",type:"password",value:n.secret,onChange:s=>L({...n,secret:s.target.value}),placeholder:"webhook-secret-key"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Secret key for signature verification"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"endpoint-events",children:"Events (comma-separated)"}),e.jsx(S,{id:"endpoint-events",value:n.events,onChange:s=>L({...n,events:s.target.value}),placeholder:"user.created, order.updated, *"}),N.events&&e.jsx("p",{className:"text-xs text-destructive",children:N.events}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty to receive all events. Use * for wildcard."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"endpoint-headers",children:"Custom Headers (JSON, optional)"}),e.jsx(xe,{id:"endpoint-headers",value:n.headers,onChange:s=>L({...n,headers:s.target.value}),placeholder:'{ "X-Custom-Header": "value" }',rows:4}),N.headers&&e.jsx("p",{className:"text-xs text-destructive",children:N.headers})]}),e.jsx(Oe,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"endpoint-allowed-ips",children:"Allowed IPs (comma-separated, optional)"}),e.jsx(S,{id:"endpoint-allowed-ips",value:n.allowedIPs||"",onChange:s=>L({...n,allowedIPs:s.target.value}),placeholder:"192.168.1.1, 10.0.0.0/8, 172.16.0.0/12",className:N.allowedIPs?"border-destructive":""}),N.allowedIPs&&e.jsx("p",{className:"text-xs text-destructive",children:N.allowedIPs}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["IP addresses or CIDR ranges allowed to send webhooks. Leave empty to allow all.",e.jsx("br",{}),"Examples: 192.168.1.1, 10.0.0.0/8, 172.16.0.0/12"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"endpoint-timeout",children:"Timeout Duration (seconds)"}),e.jsx(S,{id:"endpoint-timeout",type:"number",value:n.timeoutDuration||30,onChange:s=>L({...n,timeoutDuration:parseInt(s.target.value)||30}),min:1,max:300,className:N.timeoutDuration?"border-destructive":""}),N.timeoutDuration&&e.jsx("p",{className:"text-xs text-destructive",children:N.timeoutDuration}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Request timeout duration for this endpoint (1-300 seconds)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"endpoint-error-rate",children:"Error Rate (%)"}),e.jsx(S,{id:"endpoint-error-rate",type:"number",value:n.errorRate||10,onChange:s=>L({...n,errorRate:parseInt(s.target.value)||10}),min:0,max:100,className:N.errorRate?"border-destructive":""}),N.errorRate&&e.jsx("p",{className:"text-xs text-destructive",children:N.errorRate}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Simulated error rate for testing (0-100%)"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{children:"Enabled"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable this endpoint to receive webhooks"})]}),e.jsx(he,{checked:n.enabled,onCheckedChange:s=>L({...n,enabled:s})})]})]}),e.jsxs(Ve,{children:[e.jsx(c,{variant:"outline",onClick:()=>W(!1),children:"Cancel"}),e.jsx(c,{onClick:Ts,children:H?"Update":"Create"})]})]})}),e.jsx(ct,{open:!!O,onOpenChange:s=>!s&&_(null),children:e.jsxs(ot,{children:[e.jsxs(ht,{children:[e.jsx(xt,{children:O==="bulk"?"Delete Endpoints":"Delete Endpoint"}),e.jsx(mt,{className:"space-y-2",children:O==="bulk"?e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:["Are you sure you want to delete ",v.size," endpoint(s)?"]}),e.jsxs("div",{className:"mt-2 p-2 bg-muted rounded text-sm",children:[e.jsx("p",{className:"font-medium mb-1",children:"Endpoints to be deleted:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[Array.from(v).slice(0,5).map(s=>{const t=h.find(a=>a.id===s);return t?e.jsx("li",{children:t.name},s):null}),v.size>5&&e.jsxs("li",{className:"text-muted-foreground",children:["...and ",v.size-5," more"]})]})]}),e.jsx("p",{className:"text-destructive font-medium mt-2",children:"This action cannot be undone."})]}):(()=>{const s=h.find(a=>a.id===O),t=g.filter(a=>a.endpointId===O);return e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:['Are you sure you want to delete the endpoint "',s?.name,'"?']}),t.length>0&&e.jsx("div",{className:"mt-2 p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded text-sm",children:e.jsxs("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:["Warning: This endpoint has ",t.length," delivery record(s) that will be affected."]})}),e.jsx("p",{className:"text-destructive font-medium mt-2",children:"This action cannot be undone."})]})})()})]}),e.jsxs(ut,{children:[e.jsx(jt,{children:"Cancel"}),e.jsx(pt,{onClick:()=>{O==="bulk"?Ws():O&&Ps(O),_(null)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})}),e.jsx(Je,{open:!!B,onOpenChange:s=>!s&&fe(null),children:e.jsxs(Ue,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(We,{children:[e.jsx(He,{children:"Test Webhook"}),e.jsxs(_e,{children:["Send a test webhook to ",h.find(s=>s.id===B)?.name||"endpoint"]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"test-event-type",children:"Event Type *"}),e.jsx(S,{id:"test-event-type",value:F.eventType,onChange:s=>ge({...F,eventType:s.target.value}),placeholder:"user.created"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"test-payload",children:"Payload (JSON) *"}),e.jsx(xe,{id:"test-payload",value:F.payload,onChange:s=>ge({...F,payload:s.target.value}),placeholder:'{"key": "value"}',rows:8,className:"font-mono text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"test-headers",children:"Headers (JSON, optional)"}),e.jsx(xe,{id:"test-headers",value:F.headers,onChange:s=>ge({...F,headers:s.target.value}),placeholder:'{"X-Custom-Header": "value"}',rows:4,className:"font-mono text-sm"})]}),q&&e.jsxs("div",{className:"space-y-2 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Test Result"}),e.jsxs(A,{variant:q.status>=200&&q.status<300?"default":"destructive",children:["HTTP ",q.status]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Latency: ",q.latency,"ms"]}),e.jsx("pre",{className:"p-3 bg-background rounded text-xs font-mono overflow-x-auto max-h-40 overflow-y-auto",children:q.body})]})]}),e.jsxs(Ve,{children:[e.jsx(c,{variant:"outline",onClick:()=>{fe(null),K(null)},children:"Close"}),e.jsx(c,{onClick:Is,disabled:Qe||!F.eventType||!F.payload,children:Qe?e.jsxs(e.Fragment,{children:[e.jsx(ps,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"Send Test"]})})]})]})}),e.jsx(Je,{open:!!X,onOpenChange:s=>!s&&ae(null),children:e.jsxs(Ue,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(We,{children:[e.jsx(He,{children:"Retry Delivery"}),e.jsx(_e,{children:"Retry a failed webhook delivery"})]}),e.jsx("div",{className:"space-y-4 py-4",children:(()=>{const s=g.find(t=>t.id===X);return s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Original Event"}),e.jsx("div",{className:"p-2 bg-muted rounded text-sm",children:s.event})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"retry-payload",children:"Payload (JSON) *"}),e.jsx(xe,{id:"retry-payload",value:re.payload||s.payload,onChange:t=>ne({...re,payload:t.target.value}),rows:8,className:"font-mono text-sm"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"retry-headers",children:"Headers (JSON, optional)"}),e.jsx(xe,{id:"retry-headers",value:re.headers||"{}",onChange:t=>ne({...re,headers:t.target.value}),rows:4,className:"font-mono text-sm"})]}),s.error&&e.jsxs("div",{className:"p-3 bg-destructive/10 rounded text-sm text-destructive",children:[e.jsx(i,{className:"text-destructive",children:"Previous Error:"}),e.jsx("div",{children:s.error})]})]}):null})()}),e.jsxs(Ve,{children:[e.jsx(c,{variant:"outline",onClick:()=>{ae(null),ne({})},children:"Cancel"}),e.jsx(c,{onClick:Os,disabled:es,children:es?e.jsxs(e.Fragment,{children:[e.jsx(ps,{className:"h-4 w-4 mr-2 animate-spin"}),"Retrying..."]}):e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),"Retry"]})})]})]})})]})}export{Ft as WebhookConfigAdvanced};

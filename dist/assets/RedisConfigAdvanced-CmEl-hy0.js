import{K as Me,u as xe,j as e,r as o,e as f,D as G,B as S,aj as me,S as D,C as j,h as N,i as y,k as E,m as g,L as r,I as x,n as Re,l as m,T as ts,b as as,c as L,d as ns,f as z,P as Pe,q,s as W,t as Z,v as Q,w as d,o as Ee,a5 as ls,x as ue,ak as rs,F as is}from"./index-C50GjM4J.js";import{T as Ke}from"./textarea-DH0yP9d7.js";import{s as u,a as k,c as cs}from"./toast-CdfuIZXR.js";import{v as ds}from"./requiredFields-BLgUUVkB.js";import{K as he}from"./key-CZB3aZ-2.js";import{T as Te}from"./terminal-BgFbsc-r.js";import{R as os}from"./radio-tcGfZWp9.js";const xs=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],ms=Me("hash",xs);const us=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],hs=Me("list",us);function bs({componentId:h}){const{nodes:Be,updateNode:Ie}=xe(),O=Be.find(s=>s.id===h);if(!O)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const l=O.data.config||{},M=l.host||"localhost",B=l.port||6379,Fe=l.password||"",De=l.database||0,Le=l.maxMemory||"256mb",ze=l.maxMemoryPolicy||"noeviction",je=l.enablePersistence??!0,$=l.persistenceType||"rdb",Oe=l.rdbSaveInterval||"900 1 300 10 60 10000",$e=l.aofRewritePolicy||"everysec",ge=l.enableCluster??!1,A=l.clusterNodes||["localhost:6379","localhost:6380","localhost:6381"],R=l.keys||[],X=l.commands||[];l.selectedKey;const[Ae,Y]=o.useState(!1),[K,ee]=o.useState(""),[se,Ue]=o.useState("string"),[te,ae]=o.useState(""),[I,ne]=o.useState(""),[U,Ve]=o.useState("*"),[le,ve]=o.useState(""),[re,He]=o.useState(null),[V,_e]=o.useState(""),[H,pe]=o.useState(""),[ie,fe]=o.useState(""),[T,Je]=o.useState(""),[C,_]=o.useState(null),[n,Ne]=o.useState(null),[J,ye]=o.useState([]),[ce,de]=o.useState("disconnected");o.useEffect(()=>{if(!O){de("disconnected");return}const s=setInterval(()=>{const t=f.getRedisRoutingEngine(h);if(t){de("connected");const a=t.getMetrics(),c=t.getAllKeys();Ne({totalKeys:a.totalKeys,memoryUsage:a.memoryUsage,memoryUsagePercent:a.memoryUsagePercent,operationsPerSecond:a.operationsPerSecond,hitRate:a.hitRate,hitCount:a.hitCount,missCount:a.missCount,slowlog:a.slowlog,commandStatistics:a.commandStatistics,networkBytesIn:a.networkBytesIn,networkBytesOut:a.networkBytesOut,connectedClientsDetail:a.connectedClientsDetail});const P=new Map(R.map(b=>[b.key,b])),v=c.map(b=>{const p=P.get(b.key);return{...b,...p&&{}}});for(const b of R)c.find(p=>p.key===b.key)||v.push(b);ye(v)}else de("disconnected"),Ne(null),ye([])},500);return()=>clearInterval(s)},[h,O,R]);const i=s=>{if(Ie(h,{data:{...O.data,config:{...l,...s}}}),Object.keys(s).some(t=>["host","port"].includes(t))){const t={...w};Object.keys(s).forEach(a=>{t[a]&&delete t[a]}),be(t)}},[w,be]=o.useState({}),Ge=[{field:"host",label:"Host"},{field:"port",label:"Port",validator:s=>typeof s=="number"&&s>0&&s<=65535}],F=()=>{const s=ds({host:M,port:B},Ge);return be(s.errors),s.isValid},qe=()=>{if(!K.trim()){u("Имя ключа обязательно");return}if(R.some(a=>a.key===K.trim())){u(`Ключ "${K.trim()}" уже существует`);return}if(I&&(isNaN(parseInt(I))||parseInt(I)<-1)){u("TTL должен быть числом >= -1");return}const t={key:K.trim(),type:se,ttl:I?parseInt(I):-1,value:te,size:te.length||0};i({keys:[...R,t]}),ee(""),ae(""),ne(""),Y(!1),k(`Ключ "${K.trim()}" успешно создан`)},We=s=>{const t=Se[s];if(t){const a=f.getRedisRoutingEngine(h);a&&a.executeCommand("DEL",[t.key]),i({keys:R.filter(c=>c.key!==t.key)}),k(`Key "${t.key}" deleted`)}},oe=(s,t,a)=>{const c=[...R];c[s]={...c[s],[t]:a},i({keys:c})},Ce=()=>{if(!le.trim())return;const s=le.trim().split(/\s+/),t=s[0].toUpperCase(),a=s.slice(1),c=f.getRedisRoutingEngine(h);let P="OK (simulated)",v;if(c){const p=c.executeCommand(t,a);p.success?p.value!==void 0&&p.value!==null?P=typeof p.value=="string"?p.value:JSON.stringify(p.value,null,2):P="OK":(v=p.error||"Command failed",P=`ERROR: ${v}`)}const b={command:t,args:a,result:v?`ERROR: ${v}`:P};i({commands:[b,...X.slice(0,49)]}),ve(""),v?u(`Redis command failed: ${v}`):k("Command executed successfully")},Ze=()=>{if(!V||!H)return;const s=f.getRedisRoutingEngine(h);if(!s){u("Redis Routing Engine not initialized");return}const t=s.executeCommand("PUBLISH",[V,H]);if(t.success){const a=t.value;k(`Message published to ${a} subscriber${a!==1?"s":""}`),pe(""),_(s.getPubSubInfo())}else u(t.error||"Failed to publish message")},Qe=s=>{const t=f.getRedisRoutingEngine(h);if(!t){u("Redis Routing Engine not initialized");return}const a=t.executeCommand("SUBSCRIBE",[s]);a.success?(k(`Subscribed to channel: ${s}`),_(t.getPubSubInfo())):u(a.error||"Failed to subscribe")},we=s=>{const t=s||ie;if(!t)return;const a=f.getRedisRoutingEngine(h);if(!a){u("Redis Routing Engine not initialized");return}const c=a.executeCommand("PSUBSCRIBE",[t]);c.success?(k(`Subscribed to pattern: ${t}`),fe(""),_(a.getPubSubInfo())):u(c.error||"Failed to subscribe to pattern")};o.useEffect(()=>{const s=f.getRedisRoutingEngine(h);s&&_(s.getPubSubInfo())},[h,n]);const Xe=()=>{const t=B+A.length+1,a=`${M}:${t}`;i({clusterNodes:[...A,a]})},Ye=s=>{i({clusterNodes:A.filter((t,a)=>a!==s)})},es=s=>{switch(s){case"string":return e.jsx(is,{className:"h-4 w-4"});case"hash":return e.jsx(ms,{className:"h-4 w-4"});case"list":return e.jsx(hs,{className:"h-4 w-4"});case"set":return e.jsx(rs,{className:"h-4 w-4"});case"zset":return e.jsx(me,{className:"h-4 w-4"});case"stream":return e.jsx(G,{className:"h-4 w-4"});default:return e.jsx(he,{className:"h-4 w-4"})}},ss=s=>{switch(s){case"string":return"bg-blue-500/10 text-blue-500";case"hash":return"bg-purple-500/10 text-purple-500";case"list":return"bg-green-500/10 text-green-500";case"set":return"bg-yellow-500/10 text-yellow-500";case"zset":return"bg-orange-500/10 text-orange-500";case"stream":return"bg-red-500/10 text-red-500";default:return"bg-gray-500/10 text-gray-500"}},Se=J.length>0?J:R,ke=Se.filter(s=>{if(U==="*")return!0;try{return new RegExp(U.replace(/\*/g,".*")).test(s.key)}catch{return s.key.includes(U)}});return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(G,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Redis"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"In-memory data structure store"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(S,{variant:"outline",className:"text-xs",children:[M,":",B]}),e.jsxs(S,{variant:ce==="connected"?"secondary":"outline",className:"gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${ce==="connected"?"bg-green-500 animate-pulse":"bg-gray-400"}`}),ce==="connected"?"Connected":"Disconnected"]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs(S,{variant:"outline",className:"gap-1",children:[e.jsx(me,{className:"h-3 w-3"}),n.operationsPerSecond.toFixed(0)," ops/s"]}),e.jsxs(S,{variant:"outline",className:"gap-1",children:[e.jsx(G,{className:"h-3 w-3"}),n.totalKeys," keys"]}),e.jsxs(S,{variant:"outline",className:"gap-1",children:[e.jsx(he,{className:"h-3 w-3"}),(n.hitRate*100).toFixed(1),"% hit"]})]})]})]}),e.jsx(D,{}),e.jsxs(j,{children:[e.jsxs(N,{children:[e.jsx(y,{children:"Connection Settings"}),e.jsx(E,{children:"Configure Redis connection parameters"})]}),e.jsxs(g,{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{children:["Host ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(x,{value:M,onChange:s=>{i({host:s.target.value}),w.host&&F()},onBlur:F,className:w.host?"border-destructive":""}),w.host&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive",children:[e.jsx(Re,{className:"h-3 w-3"}),e.jsx("span",{children:w.host})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{children:["Port ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(x,{type:"number",value:B,onChange:s=>{i({port:parseInt(s.target.value)||6379}),w.port&&F()},onBlur:F,className:w.port?"border-destructive":""}),w.port&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive",children:[e.jsx(Re,{className:"h-3 w-3"}),e.jsx("span",{children:w.port})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Password"}),e.jsx(x,{type:"password",value:Fe,onChange:s=>i({password:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Database"}),e.jsx(x,{type:"number",min:"0",max:"15",value:De,onChange:s=>{const t=parseInt(s.target.value);!isNaN(t)&&t>=0&&t<=15?i({database:t}):s.target.value===""&&i({database:0})},onBlur:s=>{const t=parseInt(s.target.value);isNaN(t)||t<0?i({database:0}):t>15&&i({database:15})}}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Redis database number (0-15, default: 0)"})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t col-span-4",children:[e.jsx(m,{onClick:()=>{if(!F()){u("Пожалуйста, исправьте ошибки в полях подключения");return}const{nodes:s,connections:t}=xe.getState();f.initialize(s,t),k("Параметры подключения сохранены и применены")},children:"Сохранить и применить"}),e.jsx(m,{variant:"outline",onClick:()=>{if(!F()){u("Пожалуйста, исправьте ошибки в полях подключения");return}const s=f.getRedisRoutingEngine(h);if(s){const t=s.executeCommand("PING",[]);t.success?k(`Подключение активно: ${M}:${B}`):u(`Ошибка подключения: ${t.error||"Unknown error"}`)}else{const{nodes:t,connections:a}=xe.getState();f.initialize(t,a),setTimeout(()=>{f.getRedisRoutingEngine(h)?k(`Подключение установлено: ${M}:${B}`):u("Не удалось инициализировать подключение")},100)}},children:"Проверить подключение"})]})]})]}),e.jsxs(ts,{defaultValue:"keys",className:"w-full",children:[e.jsxs(as,{className:"flex w-full flex-wrap gap-2",children:[e.jsxs(L,{value:"keys",className:"gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),"Keys"]}),e.jsxs(L,{value:"commands",className:"gap-2",children:[e.jsx(Te,{className:"h-4 w-4"}),"Commands"]}),e.jsxs(L,{value:"pubsub",className:"gap-2",children:[e.jsx(os,{className:"h-4 w-4"}),"Pub/Sub"]}),e.jsxs(L,{value:"metrics",className:"gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),"Metrics"]}),e.jsxs(L,{value:"configuration",className:"gap-2",children:[e.jsx(ns,{className:"h-4 w-4"}),"Configuration"]}),e.jsxs(L,{value:"cluster",className:"gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Cluster"]})]}),e.jsxs(z,{value:"keys",className:"mt-4 space-y-4",children:[n&&e.jsxs(j,{className:"border-l-4 border-l-blue-500",children:[e.jsx(N,{children:e.jsx(y,{className:"text-base",children:"Real-time Metrics"})}),e.jsx(g,{children:e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Memory Usage"}),e.jsxs("div",{className:"text-2xl font-bold",children:[(n.memoryUsage/1024/1024).toFixed(2)," MB"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[n.memoryUsagePercent.toFixed(1),"% of max"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Operations/sec"}),e.jsx("div",{className:"text-2xl font-bold",children:n.operationsPerSecond.toFixed(0)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Current rate"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Hit Rate"}),e.jsxs("div",{className:"text-2xl font-bold",children:[(n.hitRate*100).toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[n.hitCount," hits / ",n.missCount," misses"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Keys"}),e.jsx("div",{className:"text-2xl font-bold",children:n.totalKeys}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"In memory"})]})]})})]}),e.jsxs(j,{children:[e.jsxs(N,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(y,{children:"Keys"}),e.jsxs(E,{children:["Manage Redis keys and their values",J.length>0&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",J.length," keys from runtime)"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{className:"w-48",placeholder:"Search pattern (e.g., user:*)",value:U,onChange:s=>Ve(s.target.value)}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>Y(!0),children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Add Key"]})]})]}),Ae&&e.jsx(g,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Key Name"}),e.jsx(x,{value:K,onChange:s=>ee(s.target.value),placeholder:"user:1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Type"}),e.jsxs(q,{value:se,onValueChange:s=>Ue(s),children:[e.jsx(W,{children:e.jsx(Z,{})}),e.jsxs(Q,{children:[e.jsx(d,{value:"string",children:"String"}),e.jsx(d,{value:"hash",children:"Hash"}),e.jsx(d,{value:"list",children:"List"}),e.jsx(d,{value:"set",children:"Set"}),e.jsx(d,{value:"zset",children:"Sorted Set"}),e.jsx(d,{value:"stream",children:"Stream"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"TTL (seconds, -1 for no expiry)"}),e.jsx(x,{type:"number",value:I,onChange:s=>ne(s.target.value),placeholder:"-1"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Value (JSON for complex types)"}),e.jsx(Ke,{className:"font-mono text-sm",rows:3,value:te,onChange:s=>ae(s.target.value),placeholder:se==="string"?'"value"':'{"field": "value"}'})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{onClick:qe,disabled:!K.trim(),children:"Add Key"}),e.jsx(m,{variant:"outline",onClick:()=>{Y(!1),ee(""),ae(""),ne("")},children:"Cancel"})]})]})}),e.jsxs(g,{className:"space-y-2",children:[ke.map((s,t)=>e.jsxs("div",{className:"p-3 border border-border rounded-lg bg-card space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1.5 rounded ${ss(s.type)}`,children:es(s.type)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-mono font-semibold",children:s.key}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(S,{variant:"outline",className:"text-xs",children:s.type}),s.ttl&&s.ttl>0&&e.jsxs("span",{children:["TTL: ",s.ttl,"s"]}),s.ttl===-1&&e.jsx("span",{children:"No expiry"}),s.size&&e.jsxs("span",{children:["Size: ",s.size," bytes"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>He(re===t?null:t),children:re===t?"Hide":"View"}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>We(t),children:e.jsx(Ee,{className:"h-4 w-4"})})]})]}),re===t&&e.jsxs("div",{className:"pt-2 border-t space-y-2",children:[e.jsx(r,{children:"Value"}),e.jsx(Ke,{className:"font-mono text-xs",rows:4,value:typeof s.value=="string"?s.value:JSON.stringify(s.value,null,2),onChange:a=>{try{const c=JSON.parse(a.target.value);oe(t,"value",c)}catch{oe(t,"value",a.target.value),(a.target.value.trim().startsWith("{")||a.target.value.trim().startsWith("["))&&cs("Неверный формат JSON, значение сохранено как строка")}}}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(r,{children:"TTL (seconds)"}),e.jsx(x,{type:"number",value:s.ttl||-1,onChange:a=>oe(t,"ttl",parseInt(a.target.value)||-1)})]})})]})]},t)),ke.length===0&&e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No keys found. Add a key to get started."})]})]})]}),e.jsx(z,{value:"commands",className:"mt-4 space-y-4",children:e.jsxs(j,{children:[e.jsxs(N,{children:[e.jsx(y,{children:"Redis Commands"}),e.jsx(E,{children:"Execute Redis commands directly"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Command"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{className:"font-mono",value:le,onChange:s=>ve(s.target.value),onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),Ce())},placeholder:"GET user:1"}),e.jsxs(m,{onClick:Ce,children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Execute"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Examples: GET key, SET key value, HGETALL hash, LPUSH list value, SADD set member"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Command History"}),e.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[X.map((s,t)=>e.jsxs("div",{className:"p-3 border rounded bg-muted/50 font-mono text-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"text-primary font-semibold",children:[s.command," ",s.args.join(" ")]})}),s.result&&e.jsxs("div",{className:"text-muted-foreground text-xs mt-1",children:["→ ",s.result]})]},t)),X.length===0&&e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No commands executed yet"})]})]})]})]})}),e.jsx(z,{value:"pubsub",className:"mt-4 space-y-4",children:e.jsxs(j,{children:[e.jsxs(N,{children:[e.jsx(y,{children:"Pub/Sub Channels"}),e.jsx(E,{children:"Manage Redis Pub/Sub channels and subscriptions"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Publish Message"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{placeholder:"Channel name",value:V||"",onChange:s=>_e(s.target.value),className:"flex-1"}),e.jsx(x,{placeholder:"Message",value:H||"",onChange:s=>pe(s.target.value),className:"flex-1"}),e.jsx(m,{onClick:Ze,disabled:!V||!H,children:"Publish"})]})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{children:"Active Channels"}),e.jsxs(S,{variant:"secondary",children:[C?.channels.length||0," channels"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ls,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(x,{placeholder:"Search channels...",value:T,onChange:s=>Je(s.target.value),className:"pl-8"})]}),C&&C.channels.length>0?e.jsxs("div",{className:"space-y-2",children:[C.channels.filter(s=>T.trim()?s.name.toLowerCase().includes(T.toLowerCase()):!0).map(s=>e.jsx(j,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.subscribers," subscriber",s.subscribers!==1?"s":""," • ",s.messageCount," messages",s.lastMessageAt&&e.jsxs(e.Fragment,{children:[" • Last: ",new Date(s.lastMessageAt).toLocaleTimeString()]})]})]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>Qe(s.name),children:"Subscribe"})]})},s.name)),C.channels.filter(s=>T.trim()?s.name.toLowerCase().includes(T.toLowerCase()):!0).length===0&&T.trim()&&e.jsxs("div",{className:"text-center text-muted-foreground py-4",children:['No channels found matching "',T,'"']})]}):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No active channels. Publish a message to create a channel."})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{children:"Pattern Subscriptions"}),e.jsxs(S,{variant:"secondary",children:[C?.patterns.length||0," patterns"]})]}),C&&C.patterns.length>0?e.jsx("div",{className:"space-y-2",children:C.patterns.map(s=>e.jsx(j,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold font-mono",children:s.pattern}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.subscribers," subscriber",s.subscribers!==1?"s":""]})]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>we(s.pattern),children:"Subscribe"})]})},s.pattern))}):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No pattern subscriptions"})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Subscribe to Pattern"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{placeholder:"Pattern (e.g., news.*)",value:ie||"",onChange:s=>fe(s.target.value),className:"flex-1"}),e.jsx(m,{onClick:we,disabled:!ie,children:"PSubscribe"})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Use * for wildcard matching (e.g., news.* matches news.sports, news.tech, etc.)"})]})]})]})}),e.jsxs(z,{value:"metrics",className:"mt-4 space-y-4",children:[e.jsxs(j,{children:[e.jsxs(N,{children:[e.jsx(y,{children:"Command Statistics"}),e.jsx(E,{children:"Statistics for executed commands"})]}),e.jsx(g,{children:n?.commandStatistics&&n.commandStatistics.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-2 p-2 border-b font-semibold text-sm",children:[e.jsx("div",{children:"Command"}),e.jsx("div",{className:"text-right",children:"Calls"}),e.jsx("div",{className:"text-right",children:"Total Duration"}),e.jsx("div",{className:"text-right",children:"Avg Duration"}),e.jsx("div",{className:"text-right",children:"% of Total"})]}),n.commandStatistics.map((s,t)=>{const a=n.commandStatistics.reduce((P,v)=>P+v.calls,0),c=a>0?(s.calls/a*100).toFixed(1):"0.0";return e.jsxs("div",{className:"grid grid-cols-5 gap-2 p-2 border-b text-sm",children:[e.jsx("div",{className:"font-mono",children:s.command}),e.jsx("div",{className:"text-right",children:s.calls.toLocaleString()}),e.jsxs("div",{className:"text-right",children:[(s.totalDuration/1e3).toFixed(2),"ms"]}),e.jsxs("div",{className:"text-right",children:[(s.averageDuration/1e3).toFixed(2),"ms"]}),e.jsxs("div",{className:"text-right",children:[c,"%"]})]},t)})]}):e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No command statistics available yet"})})]}),e.jsxs(j,{children:[e.jsxs(N,{children:[e.jsx(y,{children:"Slowlog"}),e.jsx(E,{children:"Slow commands (threshold: 10ms)"})]}),e.jsx(g,{children:n?.slowlog&&n.slowlog.length>0?e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:n.slowlog.slice(0,20).map(s=>e.jsxs("div",{className:"p-3 border rounded bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"font-mono text-sm font-semibold",children:[s.command," ",s.args.slice(0,3).join(" "),s.args.length>3&&"..."]}),e.jsxs(S,{variant:"outline",className:"text-xs",children:[(s.duration/1e3).toFixed(2),"ms"]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[new Date(s.timestamp).toLocaleString()," • ",s.client]})]},s.id))}):e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No slow commands recorded"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(j,{children:[e.jsx(N,{children:e.jsx(y,{className:"text-base",children:"Network I/O"})}),e.jsx(g,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Bytes In"}),e.jsx("span",{className:"font-mono",children:n?.networkBytesIn?(n.networkBytesIn/1024).toFixed(2)+" KB":"0 KB"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Bytes Out"}),e.jsx("span",{className:"font-mono",children:n?.networkBytesOut?(n.networkBytesOut/1024).toFixed(2)+" KB":"0 KB"})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Total"}),e.jsx("span",{className:"font-mono font-semibold",children:n?.networkBytesIn&&n?.networkBytesOut?((n.networkBytesIn+n.networkBytesOut)/1024).toFixed(2)+" KB":"0 KB"})]})]})})]}),e.jsxs(j,{children:[e.jsx(N,{children:e.jsx(y,{className:"text-base",children:"Connected Clients"})}),e.jsx(g,{children:n?.connectedClientsDetail&&n.connectedClientsDetail.length>0?e.jsx("div",{className:"space-y-2",children:n.connectedClientsDetail.map((s,t)=>e.jsxs("div",{className:"p-2 border rounded text-sm",children:[e.jsx("div",{className:"font-mono",children:s.addr}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Age: ",s.age,"s • Idle: ",s.idle,"s • Cmd: ",s.cmd||"N/A"]})]},t))}):e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No clients connected"})})]})]})]}),e.jsx(z,{value:"configuration",className:"mt-4 space-y-4",children:e.jsxs(j,{children:[e.jsxs(N,{children:[e.jsx(y,{children:"Redis Configuration"}),e.jsx(E,{children:"Configure Redis server settings"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Max Memory"}),e.jsx(x,{value:Le,onChange:s=>i({maxMemory:s.target.value}),placeholder:"256mb"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Max Memory Policy"}),e.jsxs(q,{value:ze,onValueChange:s=>i({maxMemoryPolicy:s}),children:[e.jsx(W,{children:e.jsx(Z,{})}),e.jsxs(Q,{children:[e.jsx(d,{value:"noeviction",children:"noeviction"}),e.jsx(d,{value:"allkeys-lru",children:"allkeys-lru"}),e.jsx(d,{value:"allkeys-lfu",children:"allkeys-lfu"}),e.jsx(d,{value:"volatile-lru",children:"volatile-lru"}),e.jsx(d,{value:"volatile-lfu",children:"volatile-lfu"}),e.jsx(d,{value:"volatile-ttl",children:"volatile-ttl"}),e.jsx(d,{value:"volatile-random",children:"volatile-random"}),e.jsx(d,{value:"allkeys-random",children:"allkeys-random"})]})]})]})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(r,{children:"Enable Persistence"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Save data to disk"})]}),e.jsx(ue,{checked:je,onCheckedChange:s=>i({enablePersistence:s})})]}),je&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Persistence Type"}),e.jsxs(q,{value:$,onValueChange:s=>i({persistenceType:s}),children:[e.jsx(W,{children:e.jsx(Z,{})}),e.jsxs(Q,{children:[e.jsx(d,{value:"rdb",children:"RDB"}),e.jsx(d,{value:"aof",children:"AOF"}),e.jsx(d,{value:"both",children:"Both"})]})]})]}),$==="rdb"||$==="both"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"RDB Save Interval"}),e.jsx(x,{value:Oe,onChange:s=>i({rdbSaveInterval:s.target.value}),placeholder:"900 1 300 10 60 10000"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Format: save <seconds> <changes>"})]}),$==="aof"||$==="both"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"AOF Rewrite Policy"}),e.jsxs(q,{value:$e,onValueChange:s=>i({aofRewritePolicy:s}),children:[e.jsx(W,{children:e.jsx(Z,{})}),e.jsxs(Q,{children:[e.jsx(d,{value:"always",children:"always"}),e.jsx(d,{value:"everysec",children:"everysec"}),e.jsx(d,{value:"no",children:"no"})]})]})]})]})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Enable Metrics Export (redis_exporter)"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Export Redis metrics for Prometheus scraping"})]}),e.jsx(ue,{checked:l.metrics?.enabled??!0,onCheckedChange:s=>i({metrics:{...l.metrics,enabled:s,port:l.metrics?.port||9121,path:l.metrics?.path||"/metrics"}})})]}),l.metrics?.enabled!==!1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Metrics Port (redis_exporter)"}),e.jsx(x,{type:"number",value:l.metrics?.port??9121,onChange:s=>i({metrics:{...l.metrics,port:parseInt(s.target.value)||9121,path:l.metrics?.path||"/metrics"}}),min:1024,max:65535}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default port for redis_exporter: 9121"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{children:"Metrics Path"}),e.jsx(x,{type:"text",value:l.metrics?.path??"/metrics",onChange:s=>i({metrics:{...l.metrics,path:s.target.value||"/metrics",port:l.metrics?.port||9121}}),placeholder:"/metrics"})]})]})]})]})]})}),e.jsx(z,{value:"cluster",className:"mt-4 space-y-4",children:e.jsxs(j,{children:[e.jsxs(N,{children:[e.jsx(y,{children:"Redis Cluster Configuration"}),e.jsx(E,{children:"Configure Redis cluster for high availability"})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(r,{children:"Enable Cluster Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable Redis cluster for distributed data"})]}),e.jsx(ue,{checked:ge,onCheckedChange:s=>i({enableCluster:s})})]}),ge&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{children:"Cluster Nodes"}),e.jsxs(m,{variant:"outline",size:"sm",onClick:Xe,children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Add Node"]})]}),A.map((s,t)=>e.jsxs("div",{className:"p-3 border rounded bg-muted/50 flex items-center justify-between",children:[e.jsx("span",{className:"font-mono",children:s}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>Ye(t),children:e.jsx(Ee,{className:"h-3 w-3"})})]},t))]})]})]})})]})]})})}export{bs as RedisConfigAdvanced};

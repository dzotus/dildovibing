import{r as p,j as e,C as x,h,i as u,aw as is,k as P,m,B as K,D as ce,T as Ge,b as Ze,c as oe,f as xe,A as _e,L as E,q as me,s as he,t as ue,v as je,w as M,I as Y,l as z,af as ze,ax as cs,n as ds,u as os,e as _,S as Ee,a4 as xs,d as ms,P as Le,o as Ye,ag as hs,x as us}from"./index-HDGrDyRq.js";import{P as ie}from"./progress-DX86yUno.js";import{T as js}from"./textarea-CjQgIquO.js";import{S as Ae}from"./server-BVCBHfvZ.js";import{H as ps}from"./hard-drive-C2ovWhGc.js";import{T as Pe}from"./table-DyhipslV.js";import{C as fs}from"./code-BU_fBAbx.js";import{P as gs}from"./pencil-Cx9LnIgM.js";function Ns(t){if(!t||typeof t!="string")return{valid:!1,error:"Address is required and must be a string"};const R=t.trim();if(!R)return{valid:!1,error:"Address cannot be empty"};const v=R.split(":");if(v.length!==2)return{valid:!1,error:'Address must be in format "host:port"'};const[d,c]=v,o=d.trim(),L=c.trim();if(!o)return{valid:!1,error:"Host cannot be empty"};if(!vs(o))return{valid:!1,error:"Host must be a valid hostname or IP address"};const F=parseInt(L,10);return isNaN(F)?{valid:!1,error:"Port must be a number"}:F<1||F>65535?{valid:!1,error:"Port must be between 1 and 65535"}:{valid:!0,host:o,port:F}}function vs(t){const R=/^[a-zA-Z0-9]([a-zA-Z0-9\-_.]{0,61}[a-zA-Z0-9])?$/,v=/^(\d{1,3}\.){3}\d{1,3}$/;return t==="localhost"||R.test(t)?!0:v.test(t)?t.split(".").every(c=>{const o=parseInt(c,10);return o>=0&&o<=255}):!1}function ys(t,R){if(!t)return!1;const v=t.trim().toLowerCase();return!R.some(d=>d.trim().toLowerCase()===v)}function bs(t){return typeof t!="number"||isNaN(t)?{valid:!1,error:"Tokens must be a number"}:t<1?{valid:!1,error:"Tokens must be at least 1"}:Number.isInteger(t)?t>1e4?{valid:!1,error:"Tokens cannot exceed 10000"}:{valid:!0}:{valid:!1,error:"Tokens must be an integer"}}function ws(t){return typeof t!="number"||isNaN(t)?{valid:!1,error:"Load must be a number"}:t<0||t>1?{valid:!1,error:"Load must be between 0.0 and 1.0"}:{valid:!0}}function Cs(t,R=[]){const v=[],d=Ns(t.address);if(d.valid?ys(t.address,R)||v.push(`Address: "${t.address}" is already in use`):v.push(`Address: ${d.error}`),t.tokens!==void 0){const c=bs(t.tokens);c.valid||v.push(`Tokens: ${c.error}`)}if(t.load!==void 0){const c=ws(t.load);c.valid||v.push(`Load: ${c.error}`)}return{valid:v.length===0,errors:v}}const Xe=9223372036854776e3;function Ss({tokenRanges:t,sortedTokens:R,nodeTokens:v,nodes:d,selectedPartitionKey:c,onPartitionKeySelect:o}){const L=p.useRef(null),[F,b]=p.useState(null),[A,S]=p.useState(null),q=j=>j/Xe*2*Math.PI;p.useEffect(()=>{const j=L.current;if(!j)return;const r=j.getContext("2d");if(!r)return;const X=j.width,Z=j.height,W=X/2,G=Z/2,Q=Math.min(X,Z)/2-40;r.clearRect(0,0,X,Z),r.strokeStyle="#e5e7eb",r.lineWidth=2,r.beginPath(),r.arc(W,G,Q,0,2*Math.PI),r.stroke();const se=new Map,H=["#3b82f6","#ef4444","#10b981","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#84cc16","#f97316","#6366f1"];let ae=0;for(const g of t){se.has(g.nodeAddress)||(se.set(g.nodeAddress,H[ae%H.length]),ae++);const D=se.get(g.nodeAddress),n=q(g.start),O=q(g.end);r.strokeStyle=D,r.lineWidth=3,r.beginPath(),r.arc(W,G,Q,n-Math.PI/2,O-Math.PI/2),r.stroke();const $=(n+O)/2,U=W+Math.cos($-Math.PI/2)*(Q+15),V=G+Math.sin($-Math.PI/2)*(Q+15);r.fillStyle=D,r.font="10px monospace",r.fillText(`${(g.end-g.start).toLocaleString()}`,U,V)}const de=new Map;for(const g of v){if(g.tokens.length===0)continue;const D=g.tokens[0],n=q(D),O=W+Math.cos(n-Math.PI/2)*Q,$=G+Math.sin(n-Math.PI/2)*Q;de.set(g.address,{x:O,y:$,angle:n});const V=d.find(ge=>ge.address===g.address)?.status==="up",J=F===g.address;r.fillStyle=V?J?"#10b981":"#3b82f6":"#ef4444",r.beginPath(),r.arc(O,$,J?12:8,0,2*Math.PI),r.fill(),r.fillStyle="#1f2937",r.font="bold 11px sans-serif",r.textAlign="center",r.textBaseline="middle",r.fillText(g.address.split(":")[0],O,$-20)}if(c&&o){let g=0;for(let U=0;U<c.length;U++){const V=c.charCodeAt(U);g=(g<<5)-g+V,g=g&g}const D=Math.abs(g%Xe),n=q(D),O=W+Math.cos(n-Math.PI/2)*Q,$=G+Math.sin(n-Math.PI/2)*Q;r.strokeStyle="#f59e0b",r.lineWidth=3,r.beginPath(),r.arc(O,$,15,0,2*Math.PI),r.stroke(),S(D)}const pe=g=>{const D=j.getBoundingClientRect(),n=g.clientX-D.left,O=g.clientY-D.top;let $=null;for(const[U,V]of de.entries())if(Math.sqrt((n-V.x)**2+(O-V.y)**2)<15){$=U;break}b($)};return j.addEventListener("mousemove",pe),()=>j.removeEventListener("mousemove",pe)},[t,R,v,d,F,c,o]);const i=new Map;for(const j of d){const r=j.datacenter||"default";i.has(r)||i.set(r,[]),i.get(r).push(j)}return e.jsx("div",{className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(is,{className:"h-5 w-5"}),"Token Ring Topology"]}),e.jsx(P,{children:"Visual representation of token distribution across cluster nodes"})]}),e.jsxs(m,{children:[e.jsx("div",{className:"flex items-center justify-center p-4 bg-muted rounded-lg",children:e.jsx("canvas",{ref:L,width:600,height:600,className:"max-w-full h-auto border rounded"})}),A!==null&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-950 rounded-lg",children:e.jsxs("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:["Selected Partition Key Token: ",A.toLocaleString()]})}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Node Tokens"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:v.map(j=>{const r=d.find(X=>X.address===j.address);return e.jsxs("div",{className:`p-2 rounded border ${F===j.address?"border-primary bg-primary/5":""}`,onMouseEnter:()=>b(j.address),onMouseLeave:()=>b(null),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:j.address}),e.jsx(K,{variant:r?.status==="up"?"default":"destructive",children:r?.status.toUpperCase()})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[j.tokens.length," tokens"]})]}),j.datacenter&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[j.datacenter," / ",j.rack||"default"]})]},j.address)})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Datacenter Summary"}),e.jsx("div",{className:"space-y-2",children:Array.from(i.entries()).map(([j,r])=>e.jsxs("div",{className:"p-2 rounded border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:j}),e.jsxs(K,{variant:"outline",children:[r.length," nodes"]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[r.filter(X=>X.status==="up").length," healthy"]})]},j))})]})]})]})]})})}function Ts({datacenterMetrics:t}){const R=d=>d<1024?`${d.toFixed(2)} B`:d<1048576?`${(d/1024).toFixed(2)} KB`:d<1073741824?`${(d/1048576).toFixed(2)} MB`:`${(d/1073741824).toFixed(2)} GB`,v=d=>d<1?`${(d*1e3).toFixed(0)}μs`:`${d.toFixed(2)}ms`;return t.size===0?e.jsx(x,{children:e.jsxs(h,{children:[e.jsx(u,{children:"Datacenter Metrics"}),e.jsx(P,{children:"No datacenters configured"})]})}):e.jsx("div",{className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5"}),"Datacenter Metrics"]}),e.jsx(P,{children:"Performance metrics grouped by datacenter and rack"})]}),e.jsx(m,{children:e.jsxs(Ge,{defaultValue:Array.from(t.keys())[0]||"default",children:[e.jsx(Ze,{className:"grid w-full",style:{gridTemplateColumns:`repeat(${t.size}, 1fr)`},children:Array.from(t.entries()).map(([d])=>e.jsx(oe,{value:d,children:d},d))}),Array.from(t.entries()).map(([d,c])=>e.jsxs(xe,{value:d,className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(u,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),"Nodes"]})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.nodes}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[c.healthyNodes," healthy"]}),e.jsx(ie,{value:c.healthyNodes/c.nodes*100,className:"h-2 mt-2"})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(u,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(ps,{className:"h-4 w-4"}),"Data Size"]})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:R(c.totalSize)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Total storage"})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(u,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(_e,{className:"h-4 w-4"}),"Read Latency"]})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:v(c.readLatency)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Average latency"})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(u,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx(_e,{className:"h-4 w-4"}),"Write Latency"]})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:v(c.writeLatency)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Average latency"})]})]})]}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(u,{className:"text-lg",children:"Throughput"})}),e.jsx(m,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Read Ops/sec"}),e.jsx("span",{className:"text-sm font-semibold",children:c.readOpsPerSecond.toFixed(2)})]}),e.jsx(ie,{value:Math.min(c.readOpsPerSecond/1e3*100,100),className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Write Ops/sec"}),e.jsx("span",{className:"text-sm font-semibold",children:c.writeOpsPerSecond.toFixed(2)})]}),e.jsx(ie,{value:Math.min(c.writeOpsPerSecond/1e3*100,100),className:"h-2"})]})]})})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{className:"text-lg",children:"Rack Breakdown"}),e.jsxs(P,{children:["Node distribution across racks in ",d]})]}),e.jsx(m,{children:c.racks.size===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No racks configured"}):e.jsx("div",{className:"space-y-3",children:Array.from(c.racks.entries()).map(([o,L])=>e.jsxs("div",{className:"p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:o})]}),e.jsxs(K,{variant:"outline",children:[L.nodes," nodes"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Health"}),e.jsxs("span",{className:"text-sm font-semibold",children:[L.healthyNodes," / ",L.nodes]})]}),e.jsx(ie,{value:L.healthyNodes/L.nodes*100,className:"h-2 mt-2"})]},o))})})]})]},d))]})})]})})}function ks({replicaInfo:t,nodes:R,keyspaces:v,onPartitionKeyChange:d}){const[c,o]=p.useState(""),[L,F]=p.useState(v[0]?.name||""),b=()=>{c.trim()&&L&&d(`${L}:${c.trim()}`)};if(!t)return e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5"}),"Replication Visualization"]}),e.jsx(P,{children:"Enter a partition key to visualize replica placement"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Keyspace"}),e.jsxs(me,{value:L,onValueChange:F,children:[e.jsx(he,{children:e.jsx(ue,{placeholder:"Select keyspace"})}),e.jsx(je,{children:v.map(i=>e.jsx(M,{value:i.name,children:i.name},i.name))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Partition Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{value:c,onChange:i=>o(i.target.value),placeholder:"Enter partition key value",onKeyDown:i=>{i.key==="Enter"&&b()}}),e.jsx(z,{onClick:b,disabled:!c.trim(),children:"Visualize"})]})]})]})]});const A=R.find(i=>i.address===t.primaryReplica),S=t.replicaNodes.map(i=>R.find(j=>j.address===i)).filter(Boolean),q=v.find(i=>i.name===L);return e.jsx("div",{className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5"}),"Replication Visualization"]}),e.jsxs(P,{children:["Replica placement for partition key: ",e.jsx("code",{className:"text-xs bg-muted px-1 py-0.5 rounded",children:c})]})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Partition Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{value:c,onChange:i=>o(i.target.value),placeholder:"Enter partition key value",onKeyDown:i=>{i.key==="Enter"&&b()}}),e.jsx(z,{onClick:b,disabled:!c.trim(),children:"Update"})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(u,{className:"text-sm",children:"Token Information"})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Token Value"}),e.jsx("code",{className:"text-sm font-mono",children:t.token.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Replication Factor"}),e.jsx(K,{variant:"outline",children:q?.replication||3})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Replication Strategy"}),e.jsx(K,{variant:"outline",children:q?.replicationStrategy||"NetworkTopologyStrategy"})]})]})})]}),A&&e.jsxs(x,{className:"border-primary",children:[e.jsx(h,{className:"pb-3",children:e.jsxs(u,{className:"text-sm flex items-center gap-2",children:[e.jsx(ze,{className:"h-4 w-4 text-primary"}),"Primary Replica"]})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:A.address})]}),e.jsx(K,{variant:A.status==="up"?"default":"destructive",children:A.status.toUpperCase()})]}),A.datacenter&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:[A.datacenter," / ",A.rack||"default"]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Load"}),e.jsxs("span",{className:"font-semibold",children:[(A.load*100).toFixed(1),"%"]})]})]})})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(u,{className:"text-sm flex items-center gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Replica Nodes (",S.length,")"]})}),e.jsx(m,{children:S.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No replica nodes found"}):e.jsx("div",{className:"space-y-3",children:S.map(i=>{const j=i.address===t.primaryReplica,r=i.status==="up";return e.jsxs("div",{className:`p-3 rounded-lg border ${j?"border-primary bg-primary/5":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[j?e.jsx(ze,{className:"h-4 w-4 text-primary"}):r?e.jsx(ze,{className:"h-4 w-4 text-green-500"}):e.jsx(cs,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"font-medium",children:i.address}),j&&e.jsx(K,{variant:"outline",className:"text-xs",children:"Primary"})]}),e.jsx(K,{variant:r?"default":"destructive",children:i.status.toUpperCase()})]}),i.datacenter&&e.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:[i.datacenter," / ",i.rack||"default"]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Load"}),e.jsxs("span",{className:"font-semibold",children:[(i.load*100).toFixed(1),"%"]})]})]},i.address)})})})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsxs(u,{className:"text-sm flex items-center gap-2",children:[e.jsx(ds,{className:"h-4 w-4"}),"Consistency Requirements"]})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"ONE"}),e.jsx(K,{variant:S.filter(i=>i.status==="up").length>=1?"default":"destructive",children:S.filter(i=>i.status==="up").length>=1?"Satisfied":"Not Satisfied"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"QUORUM"}),e.jsx(K,{variant:S.filter(i=>i.status==="up").length>=Math.ceil(S.length/2)?"default":"destructive",children:S.filter(i=>i.status==="up").length>=Math.ceil(S.length/2)?"Satisfied":"Not Satisfied"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"ALL"}),e.jsx(K,{variant:S.filter(i=>i.status==="up").length===S.length?"default":"destructive",children:S.filter(i=>i.status==="up").length===S.length?"Satisfied":"Not Satisfied"})]})]})})]})]})]})})}function Ds({componentId:t}){const{nodes:R,connections:v,updateNode:d}=os(),c=R.find(s=>s.id===t);if(!c)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const o=c.data.config||{},L=o.clusterName||"archiphoenix-cluster",F=o.nodes||[],b=o.keyspaces||[{name:"system",replication:3,replicationStrategy:"NetworkTopologyStrategy",tables:0,size:0,durableWrites:!0}],A=o.tables||[],S=o.queries||[],[q,i]=p.useState(null),[j,r]=p.useState(!1),[X,Z]=p.useState(!1),[W,G]=p.useState(""),[Q,se]=p.useState(b[0]?.name||"system"),[H,ae]=p.useState(""),de=o.consistencyLevel||"QUORUM",pe=o.replicationFactor||3,[g,D]=p.useState(!1),[n,O]=p.useState(null),[$,U]=p.useState(""),[V,J]=p.useState(256),[ge,Ne]=p.useState(o.datacenter||"dc1"),[Ke,ve]=p.useState("rack1"),[De,$e]=p.useState("up"),[Fe,te]=p.useState(null),[f,Oe]=p.useState(null),[Qe,ye]=p.useState(b),[Ue,be]=p.useState(A),[He,Ie]=p.useState(F),[we,Je]=p.useState(null),[Be,es]=p.useState(new Map),[Ce,Ve]=p.useState(""),[ss,qe]=p.useState(null);p.useEffect(()=>{if(!c)return;const s=setInterval(()=>{const a=_.getCassandraRoutingEngine(t);if(a){const l=a.getMetrics(),k=a.getKeyspaces(),w=a.getTables(),I=a.getNodes();Oe({readLatency:l.readLatency,writeLatency:l.writeLatency,totalNodes:l.totalNodes,healthyNodes:l.healthyNodes,totalKeyspaces:l.totalKeyspaces,totalTables:l.totalTables,totalRows:l.totalRows,totalSize:l.totalSize,hintedHandoffs:l.hintedHandoffs,pendingCompactions:l.pendingCompactions}),Ie(I);const B=a.getTokenRingData();Je(B);const C=a.getDatacenterMetrics();if(es(C),Ce){const N=Ce.split(":");if(N.length>=2){const ee=N[0],fe=N.slice(1).join(":"),rs=a.getReplicaInfo(ee,fe);qe(rs)}}const le=new Map(b.map(N=>[N.name,N])),re=k.map(N=>{const ee=le.get(N.name);return{...N,size:ee?.size??N.size??0,tables:w.filter(fe=>fe.keyspace===N.name).length}});ye(re);const Me=new Map(A.map(N=>[`${N.keyspace}.${N.name}`,N])),Re=w.map(N=>{const ee=Me.get(`${N.keyspace}.${N.name}`);return{...N,...ee&&{columns:ee.columns}}});be(Re)}else Oe(null),ye(b),be(A),Ie(F)},500);return()=>clearInterval(s)},[t,c,b,A,Ce]);const as=f?.totalSize?f.totalSize/(1024*1024*1024):o.totalSize||b.reduce((s,a)=>s+a.size,0),ne=f&&(f.readOperationsPerSecond>0||f.totalRows>0)?f.readLatency:null,Se=f&&(f.writeOperationsPerSecond>0||f.totalRows>0)?f.writeLatency:null,Te=Qe.length>0?Qe:b,ke=Ue.length>0?Ue:A,y=He.length>0?He:F,T=s=>{d(t,{data:{...c.data,config:{...o,...s}}});const a=_.getCassandraRoutingEngine(t);a&&a.syncFromConfig({...o,...s})},ts=()=>{T({keyspaces:[...b,{name:"new_keyspace",replication:pe,tables:0,size:0}]})},ns=s=>{T({keyspaces:b.filter((a,l)=>l!==s)})},We=(s,a,l)=>{const k=[...b];k[s]={...k[s],[a]:l},T({keyspaces:k})},ls=()=>{if(!H.trim())return;const s=`query-${Date.now()}`,a=Date.now(),l={id:s,query:H,status:"running",duration:0,rowsReturned:0},k=_.getCassandraRoutingEngine(t);let w=l;if(k)try{const I=k.executeCQL(H,de),B=Date.now()-a;if(w={id:s,query:H,status:I.success?"success":"error",duration:B,rowsReturned:I.rowCount||0},I.success){const C=H.trim().toUpperCase();if(C.startsWith("CREATE TABLE")||C.startsWith("CREATE KEYSPACE")||C.startsWith("DROP TABLE")||C.startsWith("DROP KEYSPACE")){const le=k.getKeyspaces(),re=k.getTables(),Me=new Map(b.map(N=>[N.name,N])),Re=le.map(N=>{const ee=Me.get(N.name);return{...N,size:ee?.size||N.size||0,tables:re.filter(fe=>fe.keyspace===N.name).length}});T({keyspaces:Re,tables:re}),ye(Re),be(re)}}}catch{const B=Date.now()-a;w={id:s,query:H,status:"error",duration:B,rowsReturned:0}}else w.status="success",w.duration=Date.now()-a;T({queries:[w,...S.slice(0,9)]}),ae(""),r(!1)};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(ce,{className:"h-6 w-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Apache Cassandra"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Distributed NoSQL Database"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(K,{variant:"outline",className:"gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full animate-pulse ${f&&f.healthyNodes>0&&f.healthyNodes===f.totalNodes?"bg-green-500":f&&f.healthyNodes>0?"bg-yellow-500":"bg-red-500"}`}),f&&f.totalNodes>0?`Cluster ${f.healthyNodes===f.totalNodes?"Healthy":"Degraded"}`:"Cluster Not Initialized"]})})]}),e.jsx(Ee,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Nodes"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f?.totalNodes??y.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Cluster nodes"})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Keyspaces"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f?.totalKeyspaces??b.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Total keyspaces"})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Read Latency"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:ne!==null?`${ne}ms`:"—"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:ne!==null?"Average":"No activity"})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Data Size"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:as.toFixed(1)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"GB"})]})]})]}),e.jsxs(Ge,{defaultValue:"keyspaces",className:"w-full",children:[e.jsxs(Ze,{className:"grid w-full grid-cols-5",children:[e.jsxs(oe,{value:"keyspaces",className:"gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Keyspaces"]}),e.jsxs(oe,{value:"tables",className:"gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),"Tables"]}),e.jsxs(oe,{value:"cql",className:"gap-2",children:[e.jsx(fs,{className:"h-4 w-4"}),"CQL Shell"]}),e.jsxs(oe,{value:"cluster",className:"gap-2",children:[e.jsx(xs,{className:"h-4 w-4"}),"Cluster"]}),e.jsxs(oe,{value:"settings",className:"gap-2",children:[e.jsx(ms,{className:"h-4 w-4"}),"Settings"]})]}),e.jsx(xe,{value:"keyspaces",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Keyspaces"}),e.jsx(P,{children:"Cassandra keyspace configuration"})]}),e.jsxs(z,{size:"sm",onClick:ts,variant:"outline",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Create Keyspace"]})]})}),e.jsx(m,{children:e.jsx("div",{className:"space-y-3",children:Te.map((s,a)=>e.jsxs(x,{className:"border-border",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(ce,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg",children:s.name}),e.jsxs(P,{className:"text-xs mt-1",children:[s.tables," tables • Replication: ",s.replication," • Size: ",s.size," GB",s.replicationStrategy&&` • ${s.replicationStrategy}`]})]})]}),Te.length>1&&e.jsx(z,{size:"icon",variant:"ghost",onClick:()=>ns(a),children:e.jsx(Ye,{className:"h-4 w-4"})})]})}),q===a&&e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Replication Factor"}),e.jsx(Y,{type:"number",value:s.replication,onChange:l=>We(a,"replication",Number(l.target.value)),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Replication Strategy"}),e.jsxs(me,{value:s.replicationStrategy||"NetworkTopologyStrategy",onValueChange:l=>We(a,"replicationStrategy",l),children:[e.jsx(he,{children:e.jsx(ue,{})}),e.jsxs(je,{children:[e.jsx(M,{value:"SimpleStrategy",children:"Simple Strategy"}),e.jsx(M,{value:"NetworkTopologyStrategy",children:"Network Topology Strategy"})]})]})]})]}),e.jsx(z,{size:"sm",variant:"outline",onClick:()=>i(null),children:"Done"})]}),q!==a&&e.jsx(m,{children:e.jsx(z,{size:"sm",variant:"outline",onClick:()=>i(a),children:"Edit Settings"})})]},a))})})]})}),e.jsxs(xe,{value:"tables",className:"space-y-4 mt-4",children:[e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Tables"}),e.jsx(P,{children:"Cassandra table configuration"})]}),e.jsxs(z,{size:"sm",variant:"outline",onClick:()=>Z(!0),children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Create Table"]})]})}),e.jsxs(m,{children:[X&&e.jsxs(x,{className:"mb-4 border-primary",children:[e.jsxs(h,{children:[e.jsx(u,{children:"Create New Table"}),e.jsx(P,{children:"Create a table in a keyspace"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Keyspace"}),e.jsxs(me,{value:Q,onValueChange:se,children:[e.jsx(he,{children:e.jsx(ue,{})}),e.jsx(je,{children:Te.map(s=>e.jsx(M,{value:s.name,children:s.name},s.name))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"Table Name"}),e.jsx(Y,{value:W,onChange:s=>G(s.target.value),placeholder:"users"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{onClick:async()=>{if(!W.trim()||!Q)return;const s=`CREATE TABLE ${Q}.${W.trim()} (id UUID PRIMARY KEY, data TEXT)`;let a=_.getCassandraRoutingEngine(t);if(!a&&c&&(_.initialize(R,v||[]),a=_.getCassandraRoutingEngine(t)),a)try{console.log("Executing CREATE TABLE:",s);const l=a.executeCQL(s,de);if(console.log("CREATE TABLE result:",l),l.success){const k=a.getKeyspaces(),w=a.getTables();console.log("Engine keyspaces:",k),console.log("Engine tables:",w);const I=new Map(b.map(C=>[C.name,C])),B=k.map(C=>{const le=I.get(C.name);return{...C,size:le?.size||0,tables:w.filter(re=>re.keyspace===C.name).length}});console.log("Merged keyspaces:",B),console.log("Merged tables:",w),T({keyspaces:B,tables:w}),ye(B),be(w),G(""),se(b[0]?.name||"system"),Z(!1)}else console.error("CREATE TABLE failed:",l.error),alert(`Failed to create table: ${l.error||"Unknown error"}`)}catch(l){console.error("CREATE TABLE error:",l),alert(`Error creating table: ${l instanceof Error?l.message:"Unknown error"}`)}else console.warn("Cassandra engine not available, using CQL Shell fallback"),ae(s),Z(!1),r(!0)},disabled:!W.trim()||!Q,children:"Create Table"}),e.jsx(z,{variant:"outline",onClick:()=>{Z(!1),G(""),se(b[0]?.name||"system")},children:"Cancel"})]})]})]}),ke.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No tables created"}):e.jsx("div",{className:"space-y-3",children:ke.map((s,a)=>e.jsx(x,{className:"border-border",children:e.jsx(h,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pe,{className:"h-4 w-4 text-primary"}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg",children:s.name}),e.jsxs(P,{className:"text-xs mt-1",children:[s.keyspace," • ",s.rows||0," rows • ",s.size?`${s.size} GB`:"N/A"]})]})]})})})},a))})]})]}),e.jsx(ks,{replicaInfo:ss,nodes:y,keyspaces:Te,onPartitionKeyChange:s=>{Ve(s);const a=s.split(":");if(a.length>=2){const l=a[0],k=a.slice(1).join(":"),w=_.getCassandraRoutingEngine(t);if(w){const I=w.getReplicaInfo(l,k);qe(I)}}}}),ke.length>0&&e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"TTL Information"}),e.jsx(P,{children:"Time To Live statistics for tables"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-3",children:ke.map(s=>{const l=_.getCassandraRoutingEngine(t)?.getTTLInfo(`${s.keyspace}.${s.name}`);return!l||l.totalRows===0?null:e.jsxs("div",{className:"p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-medium",children:[s.keyspace,".",s.name]})]}),e.jsxs(K,{variant:"outline",children:[l.rowsWithTTL," / ",l.totalRows," with TTL"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Rows"}),e.jsx("p",{className:"font-semibold",children:l.totalRows})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Rows with TTL"}),e.jsx("p",{className:"font-semibold",children:l.rowsWithTTL})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Expired Rows"}),e.jsx("p",{className:"font-semibold text-destructive",children:l.expiredRows})]})]}),l.averageTTL>0&&e.jsxs("div",{className:"mt-2 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Average TTL: "}),e.jsxs("span",{className:"font-semibold",children:[l.averageTTL.toFixed(0)," seconds"]})]})]},`${s.keyspace}.${s.name}`)})})})]})]}),e.jsx(xe,{value:"cql",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"CQL Shell"}),e.jsx(P,{children:"Execute CQL queries"})]}),e.jsxs(z,{size:"sm",onClick:()=>r(!0),variant:"outline",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"New Query"]})]})}),e.jsxs(m,{children:[j&&e.jsxs(x,{className:"mb-4 border-primary",children:[e.jsx(h,{children:e.jsx(u,{children:"Execute CQL Query"})}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{children:"CQL Query"}),e.jsx(js,{value:H,onChange:s=>ae(s.target.value),placeholder:"SELECT * FROM keyspace.table LIMIT 10;",rows:6,className:"font-mono text-sm"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(z,{onClick:ls,disabled:!H.trim(),title:H.trim()?"Execute CQL query":"Enter a CQL query to execute",children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),"Execute"]}),e.jsx(z,{variant:"outline",onClick:()=>{r(!1),ae("")},children:"Cancel"})]})]})]}),S.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No queries executed"}):e.jsx("div",{className:"space-y-2",children:S.map(s=>e.jsx(x,{className:"border-l-4 border-l-blue-500",children:e.jsx(m,{className:"pt-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(K,{variant:s.status==="success"?"default":s.status==="error"?"destructive":"secondary",children:s.status}),s.duration!==void 0&&e.jsxs(K,{variant:"outline",children:[s.duration,"ms"]}),s.rowsReturned!==void 0&&e.jsxs(K,{variant:"outline",children:[s.rowsReturned," rows"]})]}),e.jsx("pre",{className:"text-xs font-mono bg-muted p-2 rounded overflow-x-auto",children:s.query})]})})})},s.id))})]})]})}),e.jsxs(xe,{value:"cluster",className:"space-y-4 mt-4",children:[e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Cluster Nodes"}),e.jsx(P,{children:"Cassandra cluster topology"})]}),e.jsxs(z,{size:"sm",onClick:()=>{D(!0),U(""),J(256),Ne(o.datacenter||"dc1"),ve("rack1"),$e("up"),te(null)},variant:"outline",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Add Node"]})]})}),e.jsxs(m,{children:[(g||n!==null)&&e.jsxs(x,{className:"mb-4 border-primary",children:[e.jsxs(h,{children:[e.jsx(u,{children:n!==null?"Edit Node":"Add New Node"}),e.jsx(P,{children:"Configure Cassandra cluster node"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"node-address",children:"Address (host:port)"}),e.jsx(Y,{id:"node-address",value:n!==null?y[n]?.address:$,onChange:s=>{if(n!==null){const a=[...y];a[n]={...a[n],address:s.target.value},T({nodes:a})}else U(s.target.value);te(null)},placeholder:"localhost:9042"}),Fe&&e.jsx("p",{className:"text-sm text-destructive",children:Fe})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"node-tokens",children:"Tokens (vnodes)"}),e.jsx(Y,{id:"node-tokens",type:"number",min:"1",max:"10000",value:n!==null?y[n]?.tokens:V,onChange:s=>{const a=parseInt(s.target.value)||256;if(n!==null){const l=[...y];l[n]={...l[n],tokens:a},T({nodes:l})}else J(a);te(null)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"node-status",children:"Initial Status"}),e.jsxs(me,{value:n!==null?y[n]?.status:De,onValueChange:s=>{if(n!==null){const a=[...y];a[n]={...a[n],status:s},T({nodes:a})}else $e(s)},children:[e.jsx(he,{id:"node-status",children:e.jsx(ue,{})}),e.jsxs(je,{children:[e.jsx(M,{value:"up",children:"Up"}),e.jsx(M,{value:"down",children:"Down"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"node-datacenter",children:"Datacenter"}),e.jsx(Y,{id:"node-datacenter",value:n!==null?y[n]?.datacenter||o.datacenter||"dc1":ge,onChange:s=>{if(n!==null){const a=[...y];a[n]={...a[n],datacenter:s.target.value},T({nodes:a})}else Ne(s.target.value)},placeholder:"dc1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"node-rack",children:"Rack"}),e.jsx(Y,{id:"node-rack",value:n!==null?y[n]?.rack||"rack1":Ke,onChange:s=>{if(n!==null){const a=[...y];a[n]={...a[n],rack:s.target.value},T({nodes:a})}else ve(s.target.value)},placeholder:"rack1"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(z,{onClick:()=>{const s=n!==null?y[n]?.address:$,a=n!==null?y[n]?.tokens:V,l=n!==null?y[n]?.datacenter||o.datacenter||"dc1":ge,k=n!==null?y[n]?.rack||"rack1":Ke,w=n!==null?y[n]?.status:De,I=y.map((C,le)=>le===n?"":C.address).filter(Boolean),B=Cs({address:s,tokens:a},I);if(!B.valid){te(B.errors.join(", "));return}if(n!==null){const C=[...y];C[n]={address:s,tokens:a,datacenter:l,rack:k,status:w,load:y[n].load},T({nodes:C}),O(null)}else{const C=[...y,{address:s,tokens:a,datacenter:l,rack:k,status:w,load:0}];T({nodes:C}),D(!1),U(""),J(256),Ne(o.datacenter||"dc1"),ve("rack1")}te(null)},disabled:!$.trim()&&n===null,children:n!==null?"Save Changes":"Add Node"}),e.jsx(z,{variant:"outline",onClick:()=>{D(!1),O(null),U(""),J(256),Ne(o.datacenter||"dc1"),ve("rack1"),te(null)},children:"Cancel"})]})]})]}),y.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No nodes configured. Add a node to start."}):e.jsx("div",{className:"space-y-3",children:y.map((s,a)=>e.jsxs(x,{className:"border-border",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${s.status==="up"?"bg-green-500":"bg-red-500"}`}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg",children:s.address}),e.jsxs(P,{className:"text-xs mt-1",children:[s.tokens," tokens • Load: ",(s.load*100).toFixed(1),"%",s.datacenter&&` • ${s.datacenter}`,s.rack&&`/${s.rack}`]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{variant:s.status==="up"?"default":"destructive",children:s.status.toUpperCase()}),e.jsx(z,{size:"icon",variant:"ghost",onClick:()=>{O(a),D(!1),te(null)},children:e.jsx(gs,{className:"h-4 w-4"})}),e.jsx(z,{size:"icon",variant:"ghost",onClick:()=>{const l=y.filter((k,w)=>w!==a);T({nodes:l})},children:e.jsx(Ye,{className:"h-4 w-4"})})]})]})}),e.jsx(m,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Load:"}),e.jsxs("span",{className:"font-semibold",children:[(s.load*100).toFixed(1),"%"]})]}),e.jsx(ie,{value:s.load*100,className:"h-2"})]})})]},a))})]})]}),we&&e.jsx(Ss,{tokenRanges:we.tokenRanges,sortedTokens:we.sortedTokens,nodeTokens:we.nodeTokens,nodes:y,selectedPartitionKey:Ce,onPartitionKeySelect:Ve}),Be.size>0&&e.jsx(Ts,{datacenterMetrics:Be})]}),e.jsx(xe,{value:"settings",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Cluster Settings"}),e.jsx(P,{children:"Cassandra cluster configuration"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(u,{className:"text-sm font-medium",children:"Read Latency"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:ne!==null?`${ne}ms`:"—"}),ne!==null&&e.jsx(ie,{value:Math.min(ne/10*100,100),className:"h-2 mt-2"})]})]}),e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(u,{className:"text-sm font-medium",children:"Write Latency"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Se!==null?`${Se}ms`:"—"}),Se!==null&&e.jsx(ie,{value:Math.min(Se/10*100,100),className:"h-2 mt-2"})]})]})]}),(f?.hintedHandoffs!==void 0||f?.pendingCompactions!==void 0)&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[f.hintedHandoffs!==void 0&&e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(u,{className:"text-sm font-medium",children:"Hinted Handoffs"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.hintedHandoffs}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Pending hints"})]})]}),f.pendingCompactions!==void 0&&e.jsxs(x,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(u,{className:"text-sm font-medium",children:"Pending Compactions"})}),e.jsxs(m,{children:[e.jsx("div",{className:"text-2xl font-bold",children:f.pendingCompactions}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"SSTable compactions"})]})]})]}),e.jsx(Ee,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"cluster-name",children:"Cluster Name"}),e.jsx(Y,{id:"cluster-name",value:L,onChange:s=>T({clusterName:s.target.value}),placeholder:"my-cluster"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"replication-factor",children:"Default Replication Factor"}),e.jsx(Y,{id:"replication-factor",type:"number",min:"1",max:"10",value:pe,onChange:s=>T({replicationFactor:parseInt(s.target.value)||3})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default replication factor for new keyspaces. Can be overridden per keyspace."})]}),e.jsx(Ee,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"compaction-strategy",children:"Compaction Strategy"}),e.jsxs(me,{value:o.compactionStrategy||"SizeTieredCompactionStrategy",onValueChange:s=>{T({compactionStrategy:s});const a=_.getCassandraRoutingEngine(t);a&&a.syncFromConfig({...o,compactionStrategy:s})},children:[e.jsx(he,{id:"compaction-strategy",children:e.jsx(ue,{placeholder:"Select compaction strategy"})}),e.jsxs(je,{children:[e.jsx(M,{value:"SizeTieredCompactionStrategy",children:"Size-Tiered Compaction Strategy"}),e.jsx(M,{value:"LeveledCompactionStrategy",children:"Leveled Compaction Strategy"}),e.jsx(M,{value:"TimeWindowCompactionStrategy",children:"Time-Window Compaction Strategy"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Compaction strategy affects how SSTables are merged. SizeTiered is default for most workloads."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{htmlFor:"enable-compaction",children:"Enable Compaction"}),e.jsx(us,{id:"enable-compaction",checked:o.enableCompaction!==!1,onCheckedChange:s=>{T({enableCompaction:s});const a=_.getCassandraRoutingEngine(t);a&&a.syncFromConfig({...o,enableCompaction:s})}})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"When enabled, SSTables are periodically compacted to improve read performance."})]}),e.jsx(Ee,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(E,{htmlFor:"default-consistency-level",children:"Default Consistency Level"}),e.jsxs(me,{value:de,onValueChange:s=>T({consistencyLevel:s}),children:[e.jsx(he,{id:"default-consistency-level",children:e.jsx(ue,{placeholder:"Select consistency level"})}),e.jsxs(je,{children:[e.jsx(M,{value:"ONE",children:"ONE"}),e.jsx(M,{value:"TWO",children:"TWO"}),e.jsx(M,{value:"THREE",children:"THREE"}),e.jsx(M,{value:"QUORUM",children:"QUORUM"}),e.jsx(M,{value:"ALL",children:"ALL"}),e.jsx(M,{value:"LOCAL_ONE",children:"LOCAL_ONE"}),e.jsx(M,{value:"LOCAL_QUORUM",children:"LOCAL_QUORUM"}),e.jsx(M,{value:"EACH_QUORUM",children:"EACH_QUORUM"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default consistency level for CQL queries. Can be overridden per query using CONSISTENCY command or in CQL Shell."})]}),e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 dark:bg-blue-950 dark:border-blue-800 p-3",children:e.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:[e.jsx("strong",{children:"Note:"})," In real Apache Cassandra, consistency level is specified per query/session, not as a global cluster setting. This is a default value used when not explicitly specified in queries."]})})]})]})})]})]})})}export{Ds as CassandraConfigAdvanced};

import{E as ue,u as je,j as e,r as p,B as c,S as ve,C as x,e as h,f as u,h as j,k as o,L as d,I as v,t as b,T as ge,a as pe,b as f,Q as be,d as N,i as l,P as z,a2 as fe,m as A,n as D,o as H,p as B,q as E,s as y,K as Ne,a9 as _}from"./index-CLbOuOtM.js";import{P as Z}from"./package-BeFfb38c.js";import{F as ye}from"./folder-BMdEiP3Q.js";import{U as Ce}from"./users-B6_niiDt.js";import{S as we}from"./shield-VlafiO2V.js";const Se=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Pe=ue("tag",Se);function ze({componentId:L}){const{nodes:$,updateNode:q}=je(),S=$.find(s=>s.id===L);if(!S)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const t=S.data.config||{},F=t.serverUrl||"https://harbor.example.com",Q=t.adminUsername||"admin",G=t.adminPassword||"",O=t.enableVulnerabilityScanning??!0,K=t.enableContentTrust??!1,J=t.enableImageScanning??!0,m=t.projects||[{id:"1",name:"archiphoenix",public:!1,repositories:12,tags:45,vulnerabilityCount:3,storageUsed:2.5,accessLevel:"private"},{id:"2",name:"public-images",public:!0,repositories:8,tags:23,vulnerabilityCount:0,storageUsed:1.2,accessLevel:"public"}],W=t.repositories||[{id:"1",name:"archiphoenix/web-app",project:"archiphoenix",tags:5,pullCount:1250,lastPush:"2 hours ago",size:450},{id:"2",name:"archiphoenix/api-server",project:"archiphoenix",tags:8,pullCount:890,lastPush:"1 day ago",size:320}],C=t.tags||[{id:"1",name:"latest",repository:"archiphoenix/web-app",digest:"sha256:abc123...",size:125,created:"2024-01-15T10:30:00Z",vulnerabilityScan:{status:"completed",severity:"medium",totalVulnerabilities:5,critical:0,high:1,medium:3,low:1,scannedAt:"2024-01-15T11:00:00Z"},signed:!0},{id:"2",name:"v1.2.3",repository:"archiphoenix/web-app",digest:"sha256:def456...",size:120,created:"2024-01-14T15:20:00Z",vulnerabilityScan:{status:"completed",severity:"low",totalVulnerabilities:2,critical:0,high:0,medium:1,low:1,scannedAt:"2024-01-14T16:00:00Z"},signed:!1}],w=t.replicationPolicies||[{id:"1",name:"prod-replication",sourceRegistry:"harbor-prod",destinationRegistry:"harbor-backup",trigger:"event-based",enabled:!0,filters:["archiphoenix/**"]}],g=t.users||[{id:"1",username:"admin",email:"admin@archiphoenix.com",role:"admin",enabled:!0},{id:"2",username:"developer1",email:"dev1@archiphoenix.com",role:"developer",enabled:!0}],P=t.selectedProject||m[0]?.name||"",[X,k]=p.useState(!1),[Y,T]=p.useState(!1),[ee,U]=p.useState(!1),[R,se]=p.useState(""),[M,ae]=p.useState(""),n=s=>{q(L,{data:{...S.data,config:{...t,...s}}})},ie=()=>{const s={id:String(m.length+1),name:"new-project",public:!1,repositories:0,tags:0,accessLevel:"private"};n({projects:[...m,s]}),k(!1)},ne=s=>{n({projects:m.filter((i,a)=>a!==s)})},re=(s,i,a)=>{const r=[...m];r[s]={...r[s],[i]:a},n({projects:r})},le=()=>{const s={id:String(w.length+1),name:"new-replication",sourceRegistry:"source-registry",destinationRegistry:"dest-registry",trigger:"manual",enabled:!0};n({replicationPolicies:[...w,s]}),T(!1)},te=s=>{n({replicationPolicies:w.filter((i,a)=>a!==s)})},ce=()=>{const s={id:String(g.length+1),username:"new-user",email:"user@example.com",role:"guest",enabled:!0};n({users:[...g,s]}),U(!1)},de=s=>{n({users:g.filter((i,a)=>a!==s)})},V=(s,i,a)=>{const r=[...g];r[s]={...r[s],[i]:a},n({users:r})},oe=s=>{const i=[...C],a=i.findIndex(r=>r.id===s);a!==-1&&(i[a].vulnerabilityScan={status:"running",severity:"none",scannedAt:new Date().toISOString()},n({tags:i}),setTimeout(()=>{const r=[...C],I=r.findIndex(he=>he.id===s);I!==-1&&(r[I].vulnerabilityScan={status:"completed",severity:"medium",totalVulnerabilities:Math.floor(Math.random()*10),critical:Math.floor(Math.random()*2),high:Math.floor(Math.random()*3),medium:Math.floor(Math.random()*4),low:Math.floor(Math.random()*3),scannedAt:new Date().toISOString()},n({tags:r}))},2e3))},me=s=>{switch(s){case"critical":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-blue-500";default:return"bg-green-500"}},xe=W.filter(s=>!(P&&s.project!==P||M&&!s.name.toLowerCase().includes(M.toLowerCase())));return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(Z,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Harbor Registry"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Container image registry & vulnerability scanning"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:"outline",children:"v2.10"}),e.jsxs(c,{variant:"secondary",className:"gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500 animate-pulse"}),"Running"]})]})]}),e.jsx(ve,{}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Connection Settings"}),e.jsx(j,{children:"Configure Harbor registry connection"})]}),e.jsxs(o,{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Server URL"}),e.jsx(v,{value:F,onChange:s=>n({serverUrl:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Admin Username"}),e.jsx(v,{value:Q,onChange:s=>n({adminUsername:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Admin Password"}),e.jsx(v,{type:"password",value:G,onChange:s=>n({adminPassword:s.target.value})})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Security Settings"}),e.jsx(j,{children:"Configure security features"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{children:"Enable Vulnerability Scanning"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically scan images for vulnerabilities"})]}),e.jsx(b,{checked:O,onCheckedChange:s=>n({enableVulnerabilityScanning:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{children:"Enable Content Trust"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Require signed images"})]}),e.jsx(b,{checked:K,onCheckedChange:s=>n({enableContentTrust:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{children:"Enable Image Scanning"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Scan images on push"})]}),e.jsx(b,{checked:J,onCheckedChange:s=>n({enableImageScanning:s})})]})]})]}),e.jsxs(ge,{defaultValue:"projects",className:"w-full",children:[e.jsxs(pe,{className:"grid w-full grid-cols-5",children:[e.jsxs(f,{value:"projects",className:"gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Projects"]}),e.jsxs(f,{value:"repositories",className:"gap-2",children:[e.jsx(Z,{className:"h-4 w-4"}),"Repositories"]}),e.jsxs(f,{value:"tags",className:"gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),"Tags"]}),e.jsxs(f,{value:"replication",className:"gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),"Replication"]}),e.jsxs(f,{value:"users",className:"gap-2",children:[e.jsx(Ce,{className:"h-4 w-4"}),"Users"]})]}),e.jsx(N,{value:"projects",className:"mt-4 space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Projects"}),e.jsx(j,{children:"Manage container image projects"})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>k(!0),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Create Project"]})]}),X&&e.jsx(o,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Project Name"}),e.jsx(v,{placeholder:"new-project"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{onClick:ie,children:"Create Project"}),e.jsx(l,{variant:"outline",onClick:()=>k(!1),children:"Cancel"})]})]})}),e.jsx(o,{className:"space-y-3",children:m.map((s,i)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.repositories," repositories • ",s.tags," tags",s.storageUsed&&` • ${s.storageUsed} GB`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:s.public?"default":"secondary",children:s.accessLevel||(s.public?"Public":"Private")}),s.vulnerabilityCount!==void 0&&s.vulnerabilityCount>0&&e.jsxs(c,{variant:"destructive",children:[e.jsx(fe,{className:"h-3 w-3 mr-1"}),s.vulnerabilityCount]}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>ne(i),children:e.jsx(A,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(b,{checked:s.public,onCheckedChange:a=>re(i,"public",a)}),e.jsx(d,{children:"Public Project"})]})]},i))})]})}),e.jsx(N,{value:"repositories",className:"mt-4 space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Repositories"}),e.jsx(j,{children:"Container image repositories"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{value:P,onValueChange:s=>n({selectedProject:s}),children:[e.jsx(H,{className:"w-48",children:e.jsx(B,{placeholder:"All Projects"})}),e.jsxs(E,{children:[e.jsx(y,{value:"",children:"All Projects"}),m.map((s,i)=>e.jsx(y,{value:s.name,children:s.name},i))]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(v,{className:"pl-8 w-64",placeholder:"Search repositories...",value:M,onChange:s=>ae(s.target.value)})]})]})]}),e.jsx(o,{className:"space-y-3",children:xe.map((s,i)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold font-mono",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.tags," tags • ",s.pullCount," pulls",s.size&&` • ${s.size} MB`,s.lastPush&&` • Last push: ${s.lastPush}`]})]}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>se(R===s.name?"":s.name),children:R===s.name?"Hide Tags":"View Tags"})]}),R===s.name&&e.jsx("div",{className:"pt-2 border-t space-y-2",children:C.filter(a=>a.repository===s.name).map((a,r)=>e.jsxs("div",{className:"p-2 border rounded bg-muted/50 flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-mono text-sm",children:a.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.digest.substring(0,20),"... • ",a.size," MB"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[a.vulnerabilityScan&&e.jsx(c,{variant:a.vulnerabilityScan.severity==="none"?"default":"destructive",children:a.vulnerabilityScan.severity}),a.signed&&e.jsxs(c,{variant:"outline",children:[e.jsx(_,{className:"h-3 w-3 mr-1"}),"Signed"]})]})]},r))})]},i))})]})}),e.jsx(N,{value:"tags",className:"mt-4 space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Image Tags"}),e.jsx(j,{children:"Manage and scan container image tags"})]}),e.jsx(o,{className:"space-y-3",children:C.map((s,i)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"font-semibold font-mono",children:[s.repository,":",s.name]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.digest," • ",s.size," MB",s.created&&` • Created: ${new Date(s.created).toLocaleDateString()}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.vulnerabilityScan&&e.jsx(c,{variant:s.vulnerabilityScan.severity==="none"?"default":"destructive",className:me(s.vulnerabilityScan.severity),children:s.vulnerabilityScan.severity}),s.signed&&e.jsxs(c,{variant:"outline",children:[e.jsx(_,{className:"h-3 w-3 mr-1"}),"Signed"]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>oe(s.id),disabled:s.vulnerabilityScan?.status==="running",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),s.vulnerabilityScan?.status==="running"?"Scanning...":"Scan"]})]})]}),s.vulnerabilityScan&&s.vulnerabilityScan.status==="completed"&&e.jsxs("div",{className:"pt-2 border-t space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-2 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-red-500",children:s.vulnerabilityScan.critical||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Critical"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-orange-500",children:s.vulnerabilityScan.high||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"High"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-yellow-500",children:s.vulnerabilityScan.medium||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Medium"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-blue-500",children:s.vulnerabilityScan.low||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Low"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold",children:s.vulnerabilityScan.totalVulnerabilities||0}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total"})]})]}),s.vulnerabilityScan.scannedAt&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Scanned: ",new Date(s.vulnerabilityScan.scannedAt).toLocaleString()]})]})]},i))})]})}),e.jsx(N,{value:"replication",className:"mt-4 space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Replication Policies"}),e.jsx(j,{children:"Configure image replication between registries"})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>T(!0),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]}),Y&&e.jsx(o,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Policy Name"}),e.jsx(v,{placeholder:"replication-policy"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{onClick:le,children:"Create Policy"}),e.jsx(l,{variant:"outline",onClick:()=>T(!1),children:"Cancel"})]})]})}),e.jsx(o,{className:"space-y-3",children:w.map((s,i)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.sourceRegistry," → ",s.destinationRegistry]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:s.enabled?"default":"secondary",children:s.enabled?"Enabled":"Disabled"}),e.jsx(c,{variant:"outline",children:s.trigger}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>te(i),children:e.jsx(A,{className:"h-4 w-4"})})]})]}),s.filters&&s.filters.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{className:"text-xs",children:"Filters"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.filters.map((a,r)=>e.jsx(c,{variant:"outline",className:"text-xs",children:a},r))})]})]},i))})]})}),e.jsx(N,{value:"users",className:"mt-4 space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Users"}),e.jsx(j,{children:"Manage Harbor users and permissions"})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>U(!0),children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Add User"]})]}),ee&&e.jsx(o,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Username"}),e.jsx(v,{placeholder:"new-user"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{onClick:ce,children:"Add User"}),e.jsx(l,{variant:"outline",onClick:()=>U(!1),children:"Cancel"})]})]})}),e.jsx(o,{className:"space-y-3",children:g.map((s,i)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold",children:s.username}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{variant:s.role==="admin"?"default":"secondary",children:s.role}),e.jsx(b,{checked:s.enabled,onCheckedChange:a=>V(i,"enabled",a)}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>de(i),children:e.jsx(A,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Role"}),e.jsxs(D,{value:s.role,onValueChange:a=>V(i,"role",a),children:[e.jsx(H,{children:e.jsx(B,{})}),e.jsxs(E,{children:[e.jsx(y,{value:"admin",children:"Admin"}),e.jsx(y,{value:"developer",children:"Developer"}),e.jsx(y,{value:"guest",children:"Guest"})]})]})]})})]},i))})]})})]})]})})}export{ze as HarborConfigAdvanced};

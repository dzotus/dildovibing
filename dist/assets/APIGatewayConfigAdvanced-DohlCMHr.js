import{u as Ve,X as Qe,j as e,r as A,i as j,C as x,e as m,f as g,h as y,k as o,n as L,o as z,p as R,q,s as l,B as w,S as B,A as We,T as _e,a as He,b as T,W as Je,F as Ie,c as Xe,d as S,P as E,L as c,I as d,t as k,aE as Te,m as K,a6 as Ye,a8 as Ze,a9 as es,aa as ss,ab as as,ac as is,ad as ts,ae as ns}from"./index-CD9wK6fJ.js";import{T as Ce}from"./textarea-CYvenaNX.js";import{a as p,s as M,c as rs}from"./toast-CXRJnNnd.js";import{R as cs}from"./refresh-ccw-DMG2e9Iw.js";import{C as be}from"./cloud-BsYlmlcv.js";import{G as ye}from"./globe-BWuxT324.js";import{S as ae}from"./shield-D47a39cT.js";import{T as Se}from"./trending-up-YltmVQj_.js";import{P as ls}from"./package-QsSHaIbq.js";import{K as ds}from"./key-D3Aj1w-o.js";import{S as os}from"./server-BwRMzuOT.js";import{F as hs}from"./file-code-BrJuGIsq.js";import{U as xs}from"./users-Beznkhbd.js";import{R as ms}from"./route-DDGZk6zC.js";function Le(_){switch(_){case"aws":return{provider:"aws",endpointType:"REGIONAL",enableXRay:!1,enableCloudWatchLogs:!0,logRetentionDays:7,stages:[],usagePlans:[],authorizers:[],deployments:[]};case"azure":return{provider:"azure",serviceName:"api-gateway",sku:"Consumption",enableDeveloperPortal:!1,enableManagementApi:!0,enableApplicationInsights:!1,products:[],subscriptions:[],policies:[],namedValues:[],backends:[],certificates:[]};case"gcp":return{provider:"gcp",projectId:"my-project",serviceName:"api-gateway",enableCloudLogging:!0,logLevel:"INFO",enableCloudMonitoring:!0,enableCors:!1,serviceAccounts:[],quotas:[],iamBindings:[]}}}const us={"api-gateway":{defaults:{gatewayType:"aws",region:"us-east-1",enableAuthentication:!0,authType:"api-key",enableRateLimiting:!0,rateLimitPerSecond:100,enableThrottling:!0,throttlingBurst:200,enableCaching:!1,cacheTTL:300,enableLogging:!0,enableMetrics:!0}}};function Ts({componentId:_}){const{nodes:ze,updateNode:Re}=Ve(),{isRunning:qe}=Qe(),H=ze.find(s=>s.id===_);if(!H)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const h=H.data.config||{},Ee=(h.apis||[]).map(s=>s.backend&&!s.backendUrl?{...s,backendUrl:s.backend}:s),P=us["api-gateway"]?.defaults||{},f=h.provider||P.gatewayType||"aws",ie=h.region||P.region||"us-east-1",Ke=h.name||H.data.label||"api-gateway";let O;f==="aws"&&h.awsConfig?O=h.awsConfig:f==="azure"&&h.azureConfig?O=h.azureConfig:f==="gcp"&&h.gcpConfig?O=h.gcpConfig:h.providerConfig&&"provider"in h.providerConfig&&h.providerConfig.provider===f?O=h.providerConfig:O=Le(f);const n={provider:f,region:ie,name:Ke,enableAuthentication:h.enableAuthentication??h.enableApiKeyAuth??P.enableAuthentication??!0,authType:h.authType||P.authType||"api-key",enableRateLimiting:h.enableRateLimiting??P.enableRateLimiting??!0,defaultRateLimit:h.defaultRateLimit??P.rateLimitPerSecond?P.rateLimitPerSecond*60:1e3,enableThrottling:h.enableThrottling??P.enableThrottling??!0,throttlingBurst:h.throttlingBurst??P.throttlingBurst??200,enableCaching:h.enableCaching??P.enableCaching??!1,cacheTTL:h.cacheTTL??P.cacheTTL??300,enableLogging:h.enableLogging??P.enableLogging??!0,enableRequestLogging:h.enableRequestLogging??P.enableLogging??!0,enableMetrics:h.enableMetrics??P.enableMetrics??!0,requestTimeout:h.requestTimeout??30,metrics:h.metrics||{enabled:!0,port:9100,path:"/metrics"},apis:Ee,keys:h.keys||[],providerConfig:O,awsConfig:h.awsConfig||(f==="aws"?O:void 0),azureConfig:h.azureConfig||(f==="azure"?O:void 0),gcpConfig:h.gcpConfig||(f==="gcp"?O:void 0),...h},v=n.apis||[],U=n.keys||[],De=n.totalAPIs||v.length,Oe=n.totalKeys||U.length,J=n.totalRequests||v.reduce((s,i)=>s+(i.requests||0),0),we=qe&&J>0?(J-v.reduce((s,i)=>s+(i.errors||0),0))/J*100:null,[Ue,te]=A.useState(!1),[Ae,ne]=A.useState(!1),[V,re]=A.useState(""),[$,ce]=A.useState(""),[X,le]=A.useState(""),[Y,de]=A.useState("GET"),[oe,he]=A.useState(void 0),[xe,me]=A.useState(""),[ue,ge]=A.useState(!1),[pe,Z]=A.useState(void 0),[Q,ee]=A.useState(["method","path"]),[W,je]=A.useState(""),[G,se]=A.useState([]),[Pe,ve]=A.useState(void 0),[N,C]=A.useState(null),r=s=>{if(s.providerConfig&&"provider"in s.providerConfig){const i=s.providerConfig.provider;i==="aws"?s.awsConfig=s.providerConfig:i==="azure"?s.azureConfig=s.providerConfig:i==="gcp"&&(s.gcpConfig=s.providerConfig)}Re(_,{data:{...H.data,config:{...n,...s}}})},$e=s=>{const i=n.providerConfig,t={provider:s};f==="aws"&&i&&"provider"in i&&i.provider==="aws"?t.awsConfig=i:f==="azure"&&i&&"provider"in i&&i.provider==="azure"?t.azureConfig=i:f==="gcp"&&i&&"provider"in i&&i.provider==="gcp"&&(t.gcpConfig=i);let a;s==="aws"&&n.awsConfig?a=n.awsConfig:s==="azure"&&n.azureConfig?a=n.azureConfig:s==="gcp"&&n.gcpConfig?a=n.gcpConfig:a=Le(s),t.providerConfig=a,r(t),p(`Provider changed to ${s.toUpperCase()}`)},Be=()=>{if(!V.trim()){M("Имя API обязательно");return}if(!$.trim()){M("Путь API обязателен");return}if(!$.startsWith("/")){M("Путь должен начинаться с /");return}if(!X.trim()){M("Backend URL обязателен");return}if(v.some(t=>t.path===$.trim()&&t.method===Y)){M(`API с путем ${$.trim()} и методом ${Y} уже существует`);return}const i={id:`api-${Date.now()}`,name:V.trim(),path:$.trim(),backendUrl:X.trim(),method:Y,enabled:!0,authRequired:oe,authScopes:xe.trim()?xe.split(",").map(t=>t.trim()).filter(t=>t.length>0):void 0,caching:ue?{enabled:!0,ttl:pe||n.cacheTTL||300,cacheKey:Q.length>0?Q:["method","path"]}:void 0};r({apis:[...v,i]}),te(!1),re(""),ce(""),le(""),de("GET"),he(void 0),me(""),ge(!1),Z(void 0),ee(["method","path"]),p(`API "${V.trim()}" успешно создан`)},Me=s=>{const i=v.find(t=>t.id===s);i&&C({type:"api",id:s,name:i.name})},Ge=()=>{if(!N||N.type!=="api")return;const s=U.filter(i=>i.apiIds.includes(N.id));if(s.length>0){rs(`Cannot delete API: ${s.length} API key(s) are using it. Remove keys first.`),C(null);return}r({apis:v.filter(i=>i.id!==N.id)}),p(`API "${N.name}" deleted`),C(null)},Fe=s=>{const i=v.map(t=>t.id===s?{...t,enabled:!t.enabled}:t);r({apis:i})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"API Gateway"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Cloud API Gateway"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Unified API management and routing"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(j,{variant:"outline",size:"sm",children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsxs(x,{children:[e.jsxs(m,{className:"pb-3",children:[e.jsx(g,{className:"text-sm font-medium",children:"Cloud Provider"}),e.jsx(y,{className:"text-xs",children:"Select your API Gateway provider"})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(L,{value:f,onValueChange:s=>$e(s),children:[e.jsx(z,{children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(l,{value:"aws",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{children:"AWS API Gateway"})]})}),e.jsx(l,{value:"azure",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{children:"Azure API Management"})]})}),e.jsx(l,{value:"gcp",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"GCP Cloud Endpoints"})]})})]})]})}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsx(w,{variant:"outline",className:"font-mono text-xs",children:ie})})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[f==="aws"&&"Regional REST API with stages, deployments, and usage plans",f==="azure"&&"API Management service with products, subscriptions, and policies",f==="gcp"&&"Cloud Endpoints with OpenAPI specs, service accounts, and quotas"]})]})]}),e.jsx(B,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(x,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"APIs"}),e.jsx(ye,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:De}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"registered"})]})})]}),e.jsxs(x,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"API Keys"}),e.jsx(ae,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:Oe}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"active"})]})})]}),e.jsxs(x,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Requests"}),e.jsx(We,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(o,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:J.toLocaleString()})})})]}),e.jsxs(x,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Success Rate"}),e.jsx(Se,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsx(o,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-cyan-600 dark:text-cyan-400",children:we!==null?`${we.toFixed(1)}%`:"N/A"})})})]})]}),e.jsxs(_e,{defaultValue:"apis",className:"space-y-4",children:[e.jsx("div",{className:"w-full",children:e.jsxs(He,{className:"flex-wrap h-auto min-h-[36px] w-full justify-start gap-1",children:[e.jsxs(T,{value:"apis",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"APIs (",v.length,")"]}),e.jsxs(T,{value:"keys",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"API Keys (",U.length,")"]}),f==="aws"&&e.jsxs(e.Fragment,{children:[e.jsxs(T,{value:"stages",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Stages"]}),e.jsxs(T,{value:"usage-plans",children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Usage Plans"]}),e.jsxs(T,{value:"authorizers",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Authorizers"]})]}),f==="azure"&&e.jsxs(e.Fragment,{children:[e.jsxs(T,{value:"products",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Products"]}),e.jsxs(T,{value:"subscriptions",children:[e.jsx(ds,{className:"h-4 w-4 mr-2"}),"Subscriptions"]}),e.jsxs(T,{value:"policies",children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Policies"]}),e.jsxs(T,{value:"backends",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Backends"]})]}),f==="gcp"&&e.jsxs(e.Fragment,{children:[e.jsxs(T,{value:"openapi",children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),"OpenAPI"]}),e.jsxs(T,{value:"service-accounts",children:[e.jsx(xs,{className:"h-4 w-4 mr-2"}),"Service Accounts"]}),e.jsxs(T,{value:"quotas",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Quotas"]})]}),e.jsxs(T,{value:"settings",children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"Settings"]})]})}),e.jsx(S,{value:"apis",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"API Routes"}),e.jsx(y,{children:"Registered API endpoints"})]}),e.jsxs(j,{onClick:()=>te(!0),size:"sm",variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create API"]})]})}),Ue&&e.jsx(o,{className:"border-b pb-4 mb-4 bg-card",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"API Name *"}),e.jsx(d,{value:V,onChange:s=>re(s.target.value),placeholder:"User Service API"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Method *"}),e.jsxs(L,{value:Y,onValueChange:s=>de(s),children:[e.jsx(z,{children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(l,{value:"GET",children:"GET"}),e.jsx(l,{value:"POST",children:"POST"}),e.jsx(l,{value:"PUT",children:"PUT"}),e.jsx(l,{value:"DELETE",children:"DELETE"}),e.jsx(l,{value:"ALL",children:"ALL"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Path *"}),e.jsx(d,{value:$,onChange:s=>ce(s.target.value),placeholder:"/api/users"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Backend URL *"}),e.jsx(d,{value:X,onChange:s=>le(s.target.value),placeholder:"http://backend:8080"})]}),e.jsx(B,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Authentication"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Override global authentication (leave unchecked to use global setting)"})]}),e.jsx(k,{checked:oe??!1,onCheckedChange:s=>he(s)})]}),oe&&e.jsxs("div",{className:"space-y-2 pl-6",children:[e.jsx(c,{className:"text-xs",children:"Auth Scopes (comma-separated, optional)"}),e.jsx(d,{value:xe,onChange:s=>me(s.target.value),placeholder:"read, write, admin",className:"text-xs"})]})]}),e.jsx(B,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Caching"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable response caching for this API"})]}),e.jsx(k,{checked:ue,onCheckedChange:s=>{ge(s),s&&!pe&&Z(n.cacheTTL||300)}})]}),ue&&e.jsxs("div",{className:"space-y-3 pl-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Cache TTL (seconds)"}),e.jsx(d,{type:"number",value:pe||n.cacheTTL||300,onChange:s=>Z(s.target.value?parseInt(s.target.value):void 0),placeholder:"300",min:1,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Cache Key Parameters"}),e.jsx("div",{className:"space-y-2",children:["method","path","query","headers"].map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{id:`new-cache-${s}`,checked:Q.includes(s),onCheckedChange:i=>{if(i)ee([...Q,s]);else{const t=Q.filter(a=>a!==s);ee(t.length>0?t:["method","path"])}}}),e.jsx("label",{htmlFor:`new-cache-${s}`,className:"text-xs cursor-pointer capitalize",children:s})]},s))})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{onClick:Be,disabled:!V.trim()||!$.trim()||!X.trim(),children:"Create API"}),e.jsx(j,{variant:"outline",onClick:()=>{te(!1),re(""),ce(""),le(""),de("GET"),he(void 0),me(""),ge(!1),Z(void 0),ee(["method","path"])},children:"Cancel"})]})]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:v.map(s=>e.jsxs(x,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:e.jsx(ms,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"API Name"}),e.jsx(d,{value:s.name||"",onChange:i=>{const t=v.map(a=>a.id===s.id?{...a,name:i.target.value}:a);r({apis:t})},placeholder:"API Name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Method"}),e.jsxs(L,{value:s.method,onValueChange:i=>{const t=v.map(a=>a.id===s.id?{...a,method:i}:a);r({apis:t})},children:[e.jsx(z,{className:"h-8",children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(l,{value:"GET",children:"GET"}),e.jsx(l,{value:"POST",children:"POST"}),e.jsx(l,{value:"PUT",children:"PUT"}),e.jsx(l,{value:"DELETE",children:"DELETE"}),e.jsx(l,{value:"PATCH",children:"PATCH"}),e.jsx(l,{value:"ALL",children:"ALL"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Path"}),e.jsx(d,{value:s.path||"",onChange:i=>{const t=v.map(a=>a.id===s.id?{...a,path:i.target.value}:a);r({apis:t})},placeholder:"/api/users",className:"h-8 font-mono text-xs"})]})]}),s.requests!==void 0&&s.requests>0&&e.jsxs(w,{variant:"outline",className:"bg-green-50 dark:bg-green-950/20 text-green-700 dark:text-green-300 text-xs",children:[s.requests," requests"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx(k,{checked:s.enabled,onCheckedChange:()=>{Fe(s.id),p(`API "${s.name}" ${s.enabled?"disabled":"enabled"}`)}}),e.jsx(w,{variant:s.enabled?"default":"outline",className:"text-[10px]",children:s.enabled?"Active":"Inactive"})]}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>Me(s.id),className:"hover:bg-destructive/10 hover:text-destructive",title:"Delete API",children:e.jsx(K,{className:"h-4 w-4"})})]})]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Backend URL"}),e.jsx(d,{value:s.backendUrl||s.backend||"",onChange:i=>{const t=v.map(a=>a.id===s.id?{...a,backendUrl:i.target.value}:a);r({apis:t})},placeholder:"http://backend:8080",className:"font-mono text-xs"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Rate Limit (req/min, optional)"}),e.jsx(d,{type:"number",value:s.rateLimit||"",onChange:i=>{const t=v.map(a=>a.id===s.id?{...a,rateLimit:i.target.value?parseInt(i.target.value):void 0}:a);r({apis:t})},placeholder:"1000",min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Timeout (seconds, optional)"}),e.jsx(d,{type:"number",value:s.timeout||"",onChange:i=>{const t=v.map(a=>a.id===s.id?{...a,timeout:i.target.value?parseInt(i.target.value):void 0}:a);r({apis:t})},placeholder:"30",min:1})]})]}),e.jsx(B,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{className:"text-xs",children:"Authentication"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Override global authentication settings for this API"})]}),e.jsx(k,{checked:s.authRequired!==void 0?s.authRequired:n.enableAuthentication??!1,onCheckedChange:i=>{const t=v.map(a=>a.id===s.id?{...a,authRequired:i}:a);r({apis:t})}})]}),s.authRequired&&e.jsxs("div",{className:"space-y-2 pl-6",children:[e.jsx(c,{className:"text-xs",children:"Auth Scopes (comma-separated, optional)"}),e.jsx(d,{value:s.authScopes?.join(", ")||"",onChange:i=>{const t=i.target.value.split(",").map(u=>u.trim()).filter(u=>u.length>0),a=v.map(u=>u.id===s.id?{...u,authScopes:t.length>0?t:void 0}:u);r({apis:a})},placeholder:"read, write, admin",className:"text-xs"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"OAuth2/JWT scopes or IAM permissions required for this API"})]}),s.authRequired===!1&&e.jsxs(w,{variant:"outline",className:"text-xs bg-green-50 dark:bg-green-950/20 text-green-700 dark:text-green-300",children:[e.jsx(ye,{className:"h-3 w-3 mr-1"}),"Public API (no authentication required)"]})]}),e.jsx(B,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{className:"text-xs",children:"Caching"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable response caching for this API"})]}),e.jsx(k,{checked:s.caching?.enabled??!1,onCheckedChange:i=>{const t=v.map(a=>a.id===s.id?{...a,caching:{...a.caching,enabled:i,ttl:a.caching?.ttl||n.cacheTTL||300,cacheKey:a.caching?.cacheKey||["method","path"]}}:a);r({apis:t})}})]}),s.caching?.enabled&&e.jsxs("div",{className:"space-y-3 pl-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Cache TTL (seconds)"}),e.jsx(d,{type:"number",value:s.caching?.ttl||n.cacheTTL||300,onChange:i=>{const t=i.target.value?parseInt(i.target.value):void 0,a=v.map(u=>u.id===s.id?{...u,caching:{...u.caching,enabled:!0,ttl:t||n.cacheTTL||300,cacheKey:u.caching?.cacheKey||["method","path"]}}:u);r({apis:a})},placeholder:"300",min:1,className:"text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Cache Key Parameters"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Select which request parameters to include in cache key"}),e.jsx("div",{className:"space-y-2",children:["method","path","query","headers"].map(i=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{id:`cache-${s.id}-${i}`,checked:s.caching?.cacheKey?.includes(i)??(i==="method"||i==="path"),onCheckedChange:t=>{const a=s.caching?.cacheKey||["method","path"],u=t?[...a.filter(I=>I!==i),i]:a.filter(I=>I!==i),D=u.length>0?u:["method","path"],F=v.map(I=>I.id===s.id?{...I,caching:{...I.caching,enabled:!0,ttl:I.caching?.ttl||n.cacheTTL||300,cacheKey:D}}:I);r({apis:F})}}),e.jsx("label",{htmlFor:`cache-${s.id}-${i}`,className:"text-xs cursor-pointer capitalize",children:i})]},i))})]})]})]}),(s.requests!==void 0||s.errors!==void 0||s.latency)&&e.jsxs("div",{className:"pt-2 border-t space-y-2",children:[s.requests!==void 0&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Requests:"}),e.jsx("span",{className:"ml-2 font-semibold text-blue-600 dark:text-blue-400",children:s.requests.toLocaleString()})]}),s.errors!==void 0&&s.errors>0&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Errors:"}),e.jsx("span",{className:"ml-2 font-semibold text-red-500",children:s.errors})]}),s.latency&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Latency:"}),e.jsxs("span",{className:"ml-2",children:["avg: ",s.latency.avg?.toFixed(0),"ms",s.latency.p95&&`, p95: ${s.latency.p95.toFixed(0)}ms`,s.latency.p99&&`, p99: ${s.latency.p99.toFixed(0)}ms`]})]})]})]})]},s.id))})})]})}),e.jsx(S,{value:"keys",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"API Keys"}),e.jsx(y,{children:"API authentication keys"})]}),e.jsxs(j,{onClick:()=>ne(!0),size:"sm",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Key"]})]})}),Ae&&e.jsx(o,{className:"border-b pb-4 mb-4 bg-card",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Key Name *"}),e.jsx(d,{value:W,onChange:s=>je(s.target.value),placeholder:"Mobile App Key"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Select APIs *"}),e.jsxs("div",{className:"space-y-2 max-h-40 overflow-y-auto border rounded-md p-2",children:[v.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`api-${s.id}`,checked:G.includes(s.id),onChange:i=>{i.target.checked?se([...G,s.id]):se(G.filter(t=>t!==s.id))},className:"rounded border-gray-300"}),e.jsxs("label",{htmlFor:`api-${s.id}`,className:"text-sm cursor-pointer",children:[s.name," (",s.method," ",s.path,")"]})]},s.id)),v.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No APIs available. Create an API first."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Rate Limit (requests/min, optional)"}),e.jsx(d,{type:"number",value:Pe||"",onChange:s=>ve(s.target.value?parseInt(s.target.value):void 0),placeholder:"100",min:1})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{onClick:()=>{if(!W.trim()){M("Key name is required");return}if(G.length===0){M("Select at least one API");return}const s=`ak_${f}_${Math.random().toString(36).substr(2,16)}`,i=`${s.substring(0,8)}***${s.substring(s.length-4)}`,t={id:`key-${Date.now()}`,name:W.trim(),key:i,enabled:!0,apiIds:G,rateLimit:Pe,usage:{requests:0,lastUsed:new Date().toISOString()}};r({keys:[...U,t]}),ne(!1),je(""),se([]),ve(void 0),p(`API Key "${W.trim()}" created`)},disabled:!W.trim()||G.length===0,children:"Create Key"}),e.jsx(j,{variant:"outline",onClick:()=>{ne(!1),je(""),se([]),ve(void 0)},children:"Cancel"})]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[U.length===0&&!Ae&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No API keys configured. Create a key to grant API access."}),U.map(s=>e.jsxs(x,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow bg-card",children:[e.jsxs(m,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-100 dark:bg-green-900/30",children:e.jsx(ae,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx(g,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[e.jsx(w,{variant:"outline",className:"font-mono text-xs",children:s.key}),e.jsx(w,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"}),s.rateLimit&&e.jsxs(w,{variant:"outline",children:[s.rateLimit,"/min"]}),s.usage?.requests!==void 0&&s.usage.requests>0&&e.jsxs(w,{variant:"outline",className:"bg-blue-50 dark:bg-blue-950/20 text-blue-700 dark:text-blue-300",children:[s.usage.requests," requests"]}),s.usage?.lastUsed&&e.jsxs(w,{variant:"outline",className:"text-xs",children:["Last used: ",new Date(s.usage.lastUsed).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{checked:s.enabled,onCheckedChange:i=>{const t=U.map(a=>a.id===s.id?{...a,enabled:i}:a);r({keys:t}),p(`API Key "${s.name}" ${i?"enabled":"disabled"}`)}}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>C({type:"key",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",title:"Delete API Key",children:e.jsx(K,{className:"h-4 w-4"})})]})]}),e.jsx(o,{children:s.apiIds.length>0?e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{className:"text-xs",children:"Authorized APIs"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.apiIds.map(i=>{const t=v.find(a=>a.id===i);return e.jsx(w,{variant:"outline",className:"text-xs",children:t?.name||i},i)})})]}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"No APIs assigned"})})]},s.id))]})})]})}),e.jsxs(S,{value:"settings",className:"space-y-4",children:[e.jsxs(x,{children:[e.jsxs(m,{children:[e.jsx(g,{children:"Gateway Configuration"}),e.jsx(y,{children:"Basic gateway settings"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Region"}),e.jsx(d,{type:"text",value:ie,onChange:s=>r({region:s.target.value||"us-east-1"}),placeholder:"us-east-1"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cloud provider region"})]}),e.jsx(B,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Authentication Type"}),e.jsxs(L,{value:n.authType||"api-key",onValueChange:s=>r({authType:s}),children:[e.jsx(z,{children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(l,{value:"api-key",children:"API Key"}),e.jsx(l,{value:"oauth2",children:"OAuth2"}),e.jsx(l,{value:"jwt",children:"JWT"}),e.jsx(l,{value:"iam",children:"IAM"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Enable Authentication"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Require authentication for API access"})]}),e.jsx(k,{checked:n.enableAuthentication??!0,onCheckedChange:s=>r({enableAuthentication:s})})]})]})]}),e.jsxs(x,{children:[e.jsxs(m,{children:[e.jsx(g,{children:"Rate Limiting & Throttling"}),e.jsx(y,{children:"Traffic control settings"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Enable Rate Limiting"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Limit requests per time period"})]}),e.jsx(k,{checked:n.enableRateLimiting??!0,onCheckedChange:s=>r({enableRateLimiting:s})})]}),n.enableRateLimiting&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Default Rate Limit (requests/min)"}),e.jsx(d,{type:"number",value:n.defaultRateLimit??1e3,onChange:s=>r({defaultRateLimit:parseInt(s.target.value)||1e3}),min:1})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Enable Throttling"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Burst capacity control"})]}),e.jsx(k,{checked:n.enableThrottling??!0,onCheckedChange:s=>r({enableThrottling:s})})]}),n.enableThrottling&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Throttling Burst"}),e.jsx(d,{type:"number",value:n.throttlingBurst??200,onChange:s=>r({throttlingBurst:parseInt(s.target.value)||200}),min:1}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum burst capacity"})]})]})]}),e.jsxs(x,{children:[e.jsxs(m,{children:[e.jsx(g,{children:"Caching"}),e.jsx(y,{children:"Response caching settings"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Enable Caching"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Cache API responses"})]}),e.jsx(k,{checked:n.enableCaching??!1,onCheckedChange:s=>r({enableCaching:s})})]}),n.enableCaching&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Cache TTL (seconds)"}),e.jsx(d,{type:"number",value:n.cacheTTL??300,onChange:s=>r({cacheTTL:parseInt(s.target.value)||300}),min:1,max:3600}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Time-to-live for cached responses"})]})]})]}),e.jsxs(x,{children:[e.jsxs(m,{children:[e.jsx(g,{children:"Observability"}),e.jsx(y,{children:"Logging and metrics settings"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Enable Request Logging"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Log all API requests"})]}),e.jsx(k,{checked:n.enableRequestLogging??!0,onCheckedChange:s=>r({enableRequestLogging:s})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Request Timeout (seconds)"}),e.jsx(d,{type:"number",value:n.requestTimeout??30,onChange:s=>r({requestTimeout:parseInt(s.target.value)||30}),min:1})]}),e.jsx(B,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Enable Metrics Export"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Export metrics for Prometheus scraping"})]}),e.jsx(k,{checked:n.metrics?.enabled??!0,onCheckedChange:s=>r({metrics:{...n.metrics,enabled:s,port:n.metrics?.port||9100,path:n.metrics?.path||"/metrics"}})})]}),n.metrics?.enabled!==!1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Metrics Port"}),e.jsx(d,{type:"number",value:n.metrics?.port??9100,onChange:s=>r({metrics:{...n.metrics,port:parseInt(s.target.value)||9100,path:n.metrics?.path||"/metrics"}}),min:1024,max:65535}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Port for Prometheus metrics endpoint"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Metrics Path"}),e.jsx(d,{type:"text",value:n.metrics?.path??"/metrics",onChange:s=>r({metrics:{...n.metrics,path:s.target.value||"/metrics",port:n.metrics?.port||9100}}),placeholder:"/metrics"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Path for metrics endpoint (e.g., /metrics)"})]})]})]})]})]})]}),f==="aws"&&n.providerConfig&&"provider"in n.providerConfig&&n.providerConfig.provider==="aws"&&e.jsxs(e.Fragment,{children:[e.jsx(S,{value:"stages",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Stages & Deployments"}),e.jsx(y,{children:"AWS API Gateway stages and deployments"})]}),e.jsxs(j,{onClick:()=>{const s=n.providerConfig,i={id:`stage-${Date.now()}`,name:"new-stage",cacheClusterEnabled:!1};r({providerConfig:{...s,stages:[...s.stages||[],i]}}),p("Stage created")},size:"sm",variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Stage"]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[(n.providerConfig.stages||[]).map(s=>e.jsxs(x,{className:"border-l-4 border-l-orange-500",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Stage Name"}),e.jsx(d,{value:s.name||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,stages:t.stages?.map(a=>a.id===s.id?{...a,name:i.target.value}:a)||[]}})},placeholder:"dev"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(w,{variant:"outline",children:s.cacheClusterEnabled?"Cached":"No Cache"}),s.cacheClusterSize&&e.jsxs(w,{variant:"outline",children:[s.cacheClusterSize,"GB"]})]})]}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>C({type:"stage",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(K,{className:"h-4 w-4"})})]})}),e.jsxs(o,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Cache Cluster"}),e.jsx(k,{checked:s.cacheClusterEnabled||!1,onCheckedChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,stages:t.stages?.map(a=>a.id===s.id?{...a,cacheClusterEnabled:i}:a)||[]}})}})]}),s.cacheClusterEnabled&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Cache Size"}),e.jsxs(L,{value:s.cacheClusterSize||"0.5",onValueChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,stages:t.stages?.map(a=>a.id===s.id?{...a,cacheClusterSize:i}:a)||[]}})},children:[e.jsx(z,{children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(l,{value:"0.5",children:"0.5 GB"}),e.jsx(l,{value:"1.6",children:"1.6 GB"}),e.jsx(l,{value:"6.1",children:"6.1 GB"}),e.jsx(l,{value:"13.5",children:"13.5 GB"}),e.jsx(l,{value:"28.4",children:"28.4 GB"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Throttle Rate Limit"}),e.jsx(d,{type:"number",value:s.throttlingRateLimit||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,stages:t.stages?.map(a=>a.id===s.id?{...a,throttlingRateLimit:parseInt(i.target.value)||0}:a)||[]}})},placeholder:"1000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Throttle Burst Limit"}),e.jsx(d,{type:"number",value:s.throttlingBurstLimit||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,stages:t.stages?.map(a=>a.id===s.id?{...a,throttlingBurstLimit:parseInt(i.target.value)||0}:a)||[]}})},placeholder:"2000"})]})]})]})]},s.id)),(n.providerConfig.stages||[]).length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No stages configured. Create a stage to deploy your API."})]})})]})}),e.jsx(S,{value:"usage-plans",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Usage Plans"}),e.jsx(y,{children:"Manage API usage plans and quotas"})]}),e.jsxs(j,{onClick:()=>{const s=n.providerConfig,i={id:`plan-${Date.now()}`,name:"New Usage Plan",throttle:{burstLimit:200,rateLimit:100}};r({providerConfig:{...s,usagePlans:[...s.usagePlans||[],i]}}),p("Usage plan created")},size:"sm",variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Plan"]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[(n.providerConfig.usagePlans||[]).map(s=>e.jsxs(x,{className:"border-l-4 border-l-orange-500",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Plan Name"}),e.jsx(d,{value:s.name||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,usagePlans:t.usagePlans?.map(a=>a.id===s.id?{...a,name:i.target.value}:a)||[]}})},placeholder:"Basic Plan"})]})}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>C({type:"usage-plan",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(K,{className:"h-4 w-4"})})]})}),e.jsxs(o,{className:"space-y-3",children:[s.quota&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Quota"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(d,{type:"number",value:s.quota.limit||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,usagePlans:t.usagePlans?.map(a=>a.id===s.id?{...a,quota:{...a.quota,limit:parseInt(i.target.value)||0}}:a)||[]}})},placeholder:"10000"}),e.jsxs(L,{value:s.quota.period||"DAY",onValueChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,usagePlans:t.usagePlans?.map(a=>a.id===s.id?{...a,quota:{...a.quota,period:i}}:a)||[]}})},children:[e.jsx(z,{children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(l,{value:"DAY",children:"Per Day"}),e.jsx(l,{value:"WEEK",children:"Per Week"}),e.jsx(l,{value:"MONTH",children:"Per Month"})]})]})]})]}),s.throttle&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Throttle"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{className:"text-xs",children:"Rate Limit"}),e.jsx(d,{type:"number",value:s.throttle.rateLimit||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,usagePlans:t.usagePlans?.map(a=>a.id===s.id?{...a,throttle:{...a.throttle,rateLimit:parseInt(i.target.value)||0}}:a)||[]}})},placeholder:"100"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{className:"text-xs",children:"Burst Limit"}),e.jsx(d,{type:"number",value:s.throttle.burstLimit||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,usagePlans:t.usagePlans?.map(a=>a.id===s.id?{...a,throttle:{...a.throttle,burstLimit:parseInt(i.target.value)||0}}:a)||[]}})},placeholder:"200"})]})]})]})]})]},s.id)),(n.providerConfig.usagePlans||[]).length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No usage plans configured. Create a plan to manage API access."})]})})]})}),e.jsx(S,{value:"authorizers",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Lambda Authorizers"}),e.jsx(y,{children:"Configure Lambda authorizers for API authentication"})]}),e.jsxs(j,{onClick:()=>{const s=n.providerConfig,i={id:`auth-${Date.now()}`,name:"New Authorizer",type:"TOKEN"};r({providerConfig:{...s,authorizers:[...s.authorizers||[],i]}}),p("Authorizer created")},size:"sm",variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Authorizer"]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[(n.providerConfig.authorizers||[]).map(s=>e.jsxs(x,{className:"border-l-4 border-l-orange-500",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-lg",children:s.name}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>C({type:"authorizer",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(K,{className:"h-4 w-4"})})]})}),e.jsxs(o,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Type"}),e.jsxs(L,{value:s.type||"TOKEN",onValueChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,authorizers:t.authorizers?.map(a=>a.id===s.id?{...a,type:i}:a)||[]}})},children:[e.jsx(z,{children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(l,{value:"TOKEN",children:"TOKEN"}),e.jsx(l,{value:"REQUEST",children:"REQUEST"}),e.jsx(l,{value:"COGNITO_USER_POOLS",children:"Cognito User Pools"})]})]})]}),s.type!=="COGNITO_USER_POOLS"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Lambda ARN"}),e.jsx(d,{value:s.authorizerUri||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,authorizers:t.authorizers?.map(a=>a.id===s.id?{...a,authorizerUri:i.target.value}:a)||[]}})},placeholder:"arn:aws:lambda:region:account:function:name"})]}),s.type==="COGNITO_USER_POOLS"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"User Pool ARNs"}),e.jsx(d,{value:(s.providerARNs||[]).join(","),onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,authorizers:t.authorizers?.map(a=>a.id===s.id?{...a,providerARNs:i.target.value.split(",").filter(Boolean)}:a)||[]}})},placeholder:"arn:aws:cognito-idp:region:account:userpool/id"})]})]})]},s.id)),(n.providerConfig.authorizers||[]).length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No authorizers configured. Create an authorizer to add custom authentication."})]})})]})})]}),f==="azure"&&n.providerConfig&&"provider"in n.providerConfig&&n.providerConfig.provider==="azure"&&e.jsxs(e.Fragment,{children:[e.jsx(S,{value:"products",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Products"}),e.jsx(y,{children:"API Management products"})]}),e.jsxs(j,{onClick:()=>{const s=n.providerConfig,i={id:`product-${Date.now()}`,name:"new-product",displayName:"New Product",state:"notPublished",subscriptionRequired:!0};r({providerConfig:{...s,products:[...s.products||[],i]}}),p("Product created")},size:"sm",variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Product"]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[(n.providerConfig.products||[]).map(s=>e.jsxs(x,{className:"border-l-4 border-l-blue-500",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-lg",children:s.displayName||s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(w,{variant:s.state==="published"?"default":"outline",children:s.state||"notPublished"}),s.subscriptionRequired&&e.jsx(w,{variant:"outline",children:"Subscription Required"})]})]}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>C({type:"product",id:s.id,name:s.displayName||s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(K,{className:"h-4 w-4"})})]})}),e.jsxs(o,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Display Name"}),e.jsx(d,{value:s.displayName||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,products:t.products?.map(a=>a.id===s.id?{...a,displayName:i.target.value}:a)||[]}})},placeholder:"Product Display Name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Description"}),e.jsx(Ce,{value:s.description||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,products:t.products?.map(a=>a.id===s.id?{...a,description:i.target.value}:a)||[]}})},placeholder:"Product description",className:"min-h-[80px]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"State"}),e.jsxs(L,{value:s.state||"notPublished",onValueChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,products:t.products?.map(a=>a.id===s.id?{...a,state:i}:a)||[]}})},children:[e.jsx(z,{children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(l,{value:"published",children:"Published"}),e.jsx(l,{value:"notPublished",children:"Not Published"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Subscription Required"}),e.jsx(k,{checked:s.subscriptionRequired||!1,onCheckedChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,products:t.products?.map(a=>a.id===s.id?{...a,subscriptionRequired:i}:a)||[]}})}})]})]})]})]},s.id)),(n.providerConfig.products||[]).length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No products configured. Create a product to group APIs."})]})})]})}),e.jsx(S,{value:"subscriptions",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Subscriptions"}),e.jsx(y,{children:"API Management subscriptions"})]}),e.jsxs(j,{onClick:()=>{const s=n.providerConfig,i={id:`sub-${Date.now()}`,name:"new-subscription",displayName:"New Subscription",state:"active",primaryKey:`key-${Math.random().toString(36).substr(2,9)}`,secondaryKey:`key-${Math.random().toString(36).substr(2,9)}`,productId:""};r({providerConfig:{...s,subscriptions:[...s.subscriptions||[],i]}}),p("Subscription created")},size:"sm",variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Subscription"]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[(n.providerConfig.subscriptions||[]).map(s=>e.jsxs(x,{className:"border-l-4 border-l-blue-500",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-lg",children:s.displayName||s.name}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx(w,{variant:s.state==="active"?"default":"outline",children:s.state||"active"})})]}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>C({type:"subscription",id:s.id,name:s.displayName||s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(K,{className:"h-4 w-4"})})]})}),e.jsxs(o,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Display Name"}),e.jsx(d,{value:s.displayName||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,subscriptions:t.subscriptions?.map(a=>a.id===s.id?{...a,displayName:i.target.value}:a)||[]}})},placeholder:"Subscription Display Name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Primary Key"}),e.jsx(d,{value:s.primaryKey||"",readOnly:!0,className:"font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"State"}),e.jsxs(L,{value:s.state||"active",onValueChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,subscriptions:t.subscriptions?.map(a=>a.id===s.id?{...a,state:i}:a)||[]}})},children:[e.jsx(z,{children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(l,{value:"active",children:"Active"}),e.jsx(l,{value:"cancelled",children:"Cancelled"}),e.jsx(l,{value:"expired",children:"Expired"}),e.jsx(l,{value:"suspended",children:"Suspended"})]})]})]})]})]},s.id)),(n.providerConfig.subscriptions||[]).length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No subscriptions configured. Create a subscription to grant API access."})]})})]})}),e.jsx(S,{value:"policies",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Policies"}),e.jsx(y,{children:"XML-based policies for API Management"})]}),e.jsxs(j,{onClick:()=>{const s=n.providerConfig,i={id:`policy-${Date.now()}`,name:"New Policy",scope:"Global",policyContent:"<policies><inbound><base /></inbound></policies>"};r({providerConfig:{...s,policies:[...s.policies||[],i]}}),p("Policy created")},size:"sm",variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[(n.providerConfig.policies||[]).map(s=>e.jsxs(x,{className:"border-l-4 border-l-blue-500",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-lg",children:s.name}),e.jsx(w,{variant:"outline",className:"mt-2",children:s.scope||"Global"})]}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>{const i=n.providerConfig;r({providerConfig:{...i,policies:i.policies?.filter(t=>t.id!==s.id)||[]}}),p("Policy deleted")},children:e.jsx(K,{className:"h-4 w-4"})})]})}),e.jsxs(o,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Scope"}),e.jsxs(L,{value:s.scope||"Global",onValueChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,policies:t.policies?.map(a=>a.id===s.id?{...a,scope:i}:a)||[]}})},children:[e.jsx(z,{children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(l,{value:"Global",children:"Global"}),e.jsx(l,{value:"Product",children:"Product"}),e.jsx(l,{value:"API",children:"API"}),e.jsx(l,{value:"Operation",children:"Operation"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Policy XML"}),e.jsx(Ce,{className:"font-mono text-xs min-h-[200px]",value:s.policyContent||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,policies:t.policies?.map(a=>a.id===s.id?{...a,policyContent:i.target.value}:a)||[]}})},placeholder:"<policies>...</policies>"})]})]})]},s.id)),(n.providerConfig.policies||[]).length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No policies configured. Create a policy to customize API behavior."})]})})]})}),e.jsx(S,{value:"backends",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Backends"}),e.jsx(y,{children:"Backend service configurations"})]}),e.jsxs(j,{onClick:()=>{const s=n.providerConfig,i={id:`backend-${Date.now()}`,name:"new-backend",url:"http://backend:8080",protocol:"http"};r({providerConfig:{...s,backends:[...s.backends||[],i]}}),p("Backend created")},size:"sm",variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Backend"]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[(n.providerConfig.backends||[]).map(s=>e.jsxs(x,{className:"border-l-4 border-l-blue-500",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-lg",children:s.name}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>{const i=n.providerConfig;r({providerConfig:{...i,backends:i.backends?.filter(t=>t.id!==s.id)||[]}}),p("Backend deleted")},children:e.jsx(K,{className:"h-4 w-4"})})]})}),e.jsxs(o,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"URL"}),e.jsx(d,{value:s.url||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,backends:t.backends?.map(a=>a.id===s.id?{...a,url:i.target.value}:a)||[]}})},placeholder:"http://backend:8080"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Protocol"}),e.jsxs(L,{value:s.protocol||"http",onValueChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,backends:t.backends?.map(a=>a.id===s.id?{...a,protocol:i}:a)||[]}})},children:[e.jsx(z,{children:e.jsx(R,{})}),e.jsxs(q,{children:[e.jsx(l,{value:"http",children:"HTTP"}),e.jsx(l,{value:"soap",children:"SOAP"})]})]})]})]})]},s.id)),(n.providerConfig.backends||[]).length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No backends configured. Create a backend to define service endpoints."})]})})]})})]}),f==="gcp"&&n.providerConfig&&"provider"in n.providerConfig&&n.providerConfig.provider==="gcp"&&e.jsxs(e.Fragment,{children:[e.jsx(S,{value:"openapi",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(m,{children:[e.jsx(g,{children:"OpenAPI Specification"}),e.jsx(y,{children:"OpenAPI/Swagger spec for Cloud Endpoints"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"OpenAPI Spec URL"}),e.jsx(d,{value:n.providerConfig.openApiSpecUrl||"",onChange:s=>{const i=n.providerConfig;r({providerConfig:{...i,openApiSpecUrl:s.target.value}})},placeholder:"https://example.com/openapi.yaml"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"OpenAPI Spec (YAML/JSON)"}),e.jsx(Ce,{className:"font-mono text-xs min-h-[400px]",value:n.providerConfig.openApiSpec||"",onChange:s=>{const i=n.providerConfig;r({providerConfig:{...i,openApiSpec:s.target.value}})},placeholder:`openapi: 3.0.0
info:
  title: My API
...`}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter OpenAPI 3.0 specification in YAML or JSON format"})]})]})]})}),e.jsx(S,{value:"service-accounts",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Service Accounts"}),e.jsx(y,{children:"GCP service accounts for authentication"})]}),e.jsxs(j,{onClick:()=>{const s=n.providerConfig,i={email:`service-account-${Date.now()}@${s.projectId||"my-project"}.iam.gserviceaccount.com`,roles:[]};r({providerConfig:{...s,serviceAccounts:[...s.serviceAccounts||[],i]}}),p("Service account added")},size:"sm",variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Add Service Account"]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[(n.providerConfig.serviceAccounts||[]).map((s,i)=>e.jsxs(x,{className:"border-l-4 border-l-green-500",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-lg",children:s.email}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>{const t=n.providerConfig;r({providerConfig:{...t,serviceAccounts:t.serviceAccounts?.filter((a,u)=>u!==i)||[]}}),p("Service account removed")},children:e.jsx(K,{className:"h-4 w-4"})})]})}),e.jsxs(o,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Email"}),e.jsx(d,{value:s.email||"",onChange:t=>{const a=n.providerConfig;r({providerConfig:{...a,serviceAccounts:a.serviceAccounts?.map((u,D)=>D===i?{...u,email:t.target.value}:u)||[]}})},placeholder:"service-account@project.iam.gserviceaccount.com",className:"font-mono text-xs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Display Name"}),e.jsx(d,{value:s.displayName||"",onChange:t=>{const a=n.providerConfig;r({providerConfig:{...a,serviceAccounts:a.serviceAccounts?.map((u,D)=>D===i?{...u,displayName:t.target.value}:u)||[]}})},placeholder:"Service Account Display Name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Roles"}),e.jsx(d,{value:(s.roles||[]).join(", "),onChange:t=>{const a=n.providerConfig;r({providerConfig:{...a,serviceAccounts:a.serviceAccounts?.map((u,D)=>D===i?{...u,roles:t.target.value.split(",").map(F=>F.trim()).filter(Boolean)}:u)||[]}})},placeholder:"roles/endpoints.serviceAgent, roles/iam.serviceAccountUser"})]})]})]},i)),(n.providerConfig.serviceAccounts||[]).length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No service accounts configured. Add service accounts for IAM authentication."})]})})]})}),e.jsx(S,{value:"quotas",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Quotas"}),e.jsx(y,{children:"API quotas and limits"})]}),e.jsxs(j,{onClick:()=>{const s=n.providerConfig,i={id:`quota-${Date.now()}`,name:"New Quota",metric:"requests",limit:1e3,unit:"1/min/{project}"};r({providerConfig:{...s,quotas:[...s.quotas||[],i]}}),p("Quota created")},size:"sm",variant:"outline",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Quota"]})]})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[(n.providerConfig.quotas||[]).map(s=>e.jsxs(x,{className:"border-l-4 border-l-green-500",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-lg",children:s.name}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>{const i=n.providerConfig;r({providerConfig:{...i,quotas:i.quotas?.filter(t=>t.id!==s.id)||[]}}),p("Quota deleted")},children:e.jsx(K,{className:"h-4 w-4"})})]})}),e.jsxs(o,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Metric"}),e.jsx(d,{value:s.metric||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,quotas:t.quotas?.map(a=>a.id===s.id?{...a,metric:i.target.value}:a)||[]}})},placeholder:"requests"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Limit"}),e.jsx(d,{type:"number",value:s.limit||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,quotas:t.quotas?.map(a=>a.id===s.id?{...a,limit:parseInt(i.target.value)||0}:a)||[]}})},placeholder:"1000"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{className:"text-xs",children:"Unit"}),e.jsx(d,{value:s.unit||"",onChange:i=>{const t=n.providerConfig;r({providerConfig:{...t,quotas:t.quotas?.map(a=>a.id===s.id?{...a,unit:i.target.value}:a)||[]}})},placeholder:"1/min/{project}"})]})]})]},s.id)),(n.providerConfig.quotas||[]).length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No quotas configured. Create quotas to limit API usage."})]})})]})})]})]}),e.jsx(Ye,{open:!!N,onOpenChange:s=>!s&&C(null),children:e.jsxs(Ze,{children:[e.jsxs(es,{children:[e.jsx(ss,{children:"Confirm Deletion"}),e.jsxs(as,{children:["Are you sure you want to delete ",e.jsx("strong",{children:N?.name}),"? This action cannot be undone.",N?.type==="api"&&" Any API keys using this API will lose access.",N?.type==="key"&&" Applications using this key will lose access."]})]}),e.jsxs(is,{children:[e.jsx(ts,{children:"Cancel"}),e.jsx(ns,{onClick:()=>{if(N)switch(N.type){case"api":Ge();break;case"key":r({keys:U.filter(b=>b.id!==N.id)}),p(`API Key "${N.name}" deleted`),C(null);break;case"stage":const s=n.providerConfig;r({providerConfig:{...s,stages:s.stages?.filter(b=>b.id!==N.id)||[]}}),p("Stage deleted"),C(null);break;case"usage-plan":const i=n.providerConfig;r({providerConfig:{...i,usagePlans:i.usagePlans?.filter(b=>b.id!==N.id)||[]}}),p("Usage plan deleted"),C(null);break;case"authorizer":const t=n.providerConfig;r({providerConfig:{...t,authorizers:t.authorizers?.filter(b=>b.id!==N.id)||[]}}),p("Authorizer deleted"),C(null);break;case"product":const a=n.providerConfig;r({providerConfig:{...a,products:a.products?.filter(b=>b.id!==N.id)||[]}}),p("Product deleted"),C(null);break;case"subscription":const u=n.providerConfig;r({providerConfig:{...u,subscriptions:u.subscriptions?.filter(b=>b.id!==N.id)||[]}}),p("Subscription deleted"),C(null);break;case"policy":const D=n.providerConfig;r({providerConfig:{...D,policies:D.policies?.filter(b=>b.id!==N.id)||[]}}),p("Policy deleted"),C(null);break;case"backend":const F=n.providerConfig;r({providerConfig:{...F,backends:F.backends?.filter(b=>b.id!==N.id)||[]}}),p("Backend deleted"),C(null);break;case"service-account":const I=n.providerConfig,fe=I.serviceAccounts?.findIndex((b,Ne)=>b.email===N.id||Ne.toString()===N.id);fe!==void 0&&fe>=0&&(r({providerConfig:{...I,serviceAccounts:I.serviceAccounts?.filter((b,Ne)=>Ne!==fe)||[]}}),p("Service account removed")),C(null);break;case"quota":const ke=n.providerConfig;r({providerConfig:{...ke,quotas:ke.quotas?.filter(b=>b.id!==N.id)||[]}}),p("Quota deleted"),C(null);break}},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})})}export{Ts as APIGatewayConfigAdvanced};

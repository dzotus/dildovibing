import{J as Ce,u as re,j as e,r as d,e as N,B as S,Z as ve,S as le,C as R,h as K,i as E,k as z,m as b,L as n,I as o,n as ge,l as u,T as He,b as Ue,c as $,d as _e,f as D,P as ye,q as V,s as A,t as B,v as H,w as c,o as fe,x as ne,Y as Je,F as Ge}from"./index-DFZjpGIw.js";import{T as Ne}from"./textarea-GbK-jLLm.js";import{s as y,a as T,c as qe}from"./toast-DwmYLw-T.js";import{v as We}from"./requiredFields-BLgUUVkB.js";import{D as U}from"./database-DY0KNkgw.js";import{K as ce}from"./key-BqWKJNMK.js";import{T as be}from"./terminal-8MVG062z.js";const Ze=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Ye=Ce("hash",Ze);const Qe=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Xe=Ce("list",Qe);function cs({componentId:v}){const{nodes:we,updateNode:ke}=re(),P=we.find(s=>s.id===v);if(!P)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const r=P.data.config||{},M=r.host||"localhost",I=r.port||6379,Se=r.password||"",Re=r.database||0,Ke=r.maxMemory||"256mb",Ee=r.maxMemoryPolicy||"noeviction",ie=r.enablePersistence??!0,F=r.persistenceType||"rdb",Te=r.rdbSaveInterval||"900 1 300 10 60 10000",Pe=r.aofRewritePolicy||"everysec",de=r.enableCluster??!1,_=r.clusterNodes||["localhost:6379","localhost:6380","localhost:6381"],g=r.keys||[],J=r.commands||[];r.selectedKey;const[Me,G]=d.useState(!1),[f,q]=d.useState(""),[W,Ie]=d.useState("string"),[Z,Y]=d.useState(""),[C,Q]=d.useState(""),[L,Fe]=d.useState("*"),[X,oe]=d.useState(""),[ee,ze]=d.useState(null),[x,xe]=d.useState(null),[O,me]=d.useState([]),[se,te]=d.useState("disconnected");d.useEffect(()=>{if(!P){te("disconnected");return}const s=setInterval(()=>{const t=N.getRedisRoutingEngine(v);if(t){te("connected");const a=t.getMetrics(),i=t.getAllKeys();xe({totalKeys:a.totalKeys,memoryUsage:a.memoryUsage,memoryUsagePercent:a.memoryUsagePercent,operationsPerSecond:a.operationsPerSecond,hitRate:a.hitRate,hitCount:a.hitCount,missCount:a.missCount});const k=new Map(g.map(h=>[h.key,h])),p=i.map(h=>{const m=k.get(h.key);return{...h,...m&&{}}});for(const h of g)i.find(m=>m.key===h.key)||p.push(h);me(p)}else te("disconnected"),xe(null),me([])},500);return()=>clearInterval(s)},[v,P,g]);const l=s=>{if(ke(v,{data:{...P.data,config:{...r,...s}}}),Object.keys(s).some(t=>["host","port"].includes(t))){const t={...j};Object.keys(s).forEach(a=>{t[a]&&delete t[a]}),he(t)}},[j,he]=d.useState({}),Le=[{field:"host",label:"Host"},{field:"port",label:"Port",validator:s=>typeof s=="number"&&s>0&&s<=65535}],w=()=>{const s=We({host:M,port:I},Le);return he(s.errors),s.isValid},Oe=()=>{if(!f.trim()){y("Имя ключа обязательно");return}if(g.some(a=>a.key===f.trim())){y(`Ключ "${f.trim()}" уже существует`);return}if(C&&(isNaN(parseInt(C))||parseInt(C)<-1)){y("TTL должен быть числом >= -1");return}const t={key:f.trim(),type:W,ttl:C?parseInt(C):-1,value:Z,size:Z.length||0};l({keys:[...g,t]}),q(""),Y(""),Q(""),G(!1),T(`Ключ "${f.trim()}" успешно создан`)},$e=s=>{const t=je[s];if(t){const a=N.getRedisRoutingEngine(v);a&&a.executeCommand("DEL",[t.key]),l({keys:g.filter(i=>i.key!==t.key)}),T(`Key "${t.key}" deleted`)}},ae=(s,t,a)=>{const i=[...g];i[s]={...i[s],[t]:a},l({keys:i})},ue=()=>{if(!X.trim())return;const s=X.trim().split(/\s+/),t=s[0].toUpperCase(),a=s.slice(1),i=N.getRedisRoutingEngine(v);let k="OK (simulated)",p;if(i){const m=i.executeCommand(t,a);m.success?m.value!==void 0&&m.value!==null?k=typeof m.value=="string"?m.value:JSON.stringify(m.value,null,2):k="OK":(p=m.error||"Command failed",k=`ERROR: ${p}`)}const h={command:t,args:a,result:p?`ERROR: ${p}`:k};l({commands:[h,...J.slice(0,49)]}),oe(""),p?y(`Redis command failed: ${p}`):T("Command executed successfully")},De=()=>{l({clusterNodes:[..._,"localhost:6382"]})},Ve=s=>{l({clusterNodes:_.filter((t,a)=>a!==s)})},Ae=s=>{switch(s){case"string":return e.jsx(Ge,{className:"h-4 w-4"});case"hash":return e.jsx(Ye,{className:"h-4 w-4"});case"list":return e.jsx(Xe,{className:"h-4 w-4"});case"set":return e.jsx(Je,{className:"h-4 w-4"});case"zset":return e.jsx(ve,{className:"h-4 w-4"});case"stream":return e.jsx(U,{className:"h-4 w-4"});default:return e.jsx(ce,{className:"h-4 w-4"})}},Be=s=>{switch(s){case"string":return"bg-blue-500/10 text-blue-500";case"hash":return"bg-purple-500/10 text-purple-500";case"list":return"bg-green-500/10 text-green-500";case"set":return"bg-yellow-500/10 text-yellow-500";case"zset":return"bg-orange-500/10 text-orange-500";case"stream":return"bg-red-500/10 text-red-500";default:return"bg-gray-500/10 text-gray-500"}},je=O.length>0?O:g,pe=je.filter(s=>{if(L==="*")return!0;try{return new RegExp(L.replace(/\*/g,".*")).test(s.key)}catch{return s.key.includes(L)}});return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(U,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Redis"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"In-memory data structure store"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(S,{variant:"outline",className:"text-xs",children:[M,":",I]}),e.jsxs(S,{variant:se==="connected"?"secondary":"outline",className:"gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${se==="connected"?"bg-green-500 animate-pulse":"bg-gray-400"}`}),se==="connected"?"Connected":"Disconnected"]}),x&&e.jsxs(e.Fragment,{children:[e.jsxs(S,{variant:"outline",className:"gap-1",children:[e.jsx(ve,{className:"h-3 w-3"}),x.operationsPerSecond.toFixed(0)," ops/s"]}),e.jsxs(S,{variant:"outline",className:"gap-1",children:[e.jsx(U,{className:"h-3 w-3"}),x.totalKeys," keys"]}),e.jsxs(S,{variant:"outline",className:"gap-1",children:[e.jsx(ce,{className:"h-3 w-3"}),(x.hitRate*100).toFixed(1),"% hit"]})]})]})]}),e.jsx(le,{}),e.jsxs(R,{children:[e.jsxs(K,{children:[e.jsx(E,{children:"Connection Settings"}),e.jsx(z,{children:"Configure Redis connection parameters"})]}),e.jsxs(b,{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{children:["Host ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(o,{value:M,onChange:s=>{l({host:s.target.value}),j.host&&w()},onBlur:w,className:j.host?"border-destructive":""}),j.host&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive",children:[e.jsx(ge,{className:"h-3 w-3"}),e.jsx("span",{children:j.host})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{children:["Port ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(o,{type:"number",value:I,onChange:s=>{l({port:parseInt(s.target.value)||6379}),j.port&&w()},onBlur:w,className:j.port?"border-destructive":""}),j.port&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive",children:[e.jsx(ge,{className:"h-3 w-3"}),e.jsx("span",{children:j.port})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Password"}),e.jsx(o,{type:"password",value:Se,onChange:s=>l({password:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Database"}),e.jsx(o,{type:"number",min:"0",max:"15",value:Re,onChange:s=>{const t=parseInt(s.target.value);!isNaN(t)&&t>=0&&t<=15?l({database:t}):s.target.value===""&&l({database:0})},onBlur:s=>{const t=parseInt(s.target.value);isNaN(t)||t<0?l({database:0}):t>15&&l({database:15})}}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Redis database number (0-15, default: 0)"})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t col-span-4",children:[e.jsx(u,{onClick:()=>{if(!w()){y("Пожалуйста, исправьте ошибки в полях подключения");return}const{nodes:s,connections:t}=re.getState();N.initialize(s,t),T("Параметры подключения сохранены и применены")},children:"Сохранить и применить"}),e.jsx(u,{variant:"outline",onClick:()=>{if(!w()){y("Пожалуйста, исправьте ошибки в полях подключения");return}const s=N.getRedisRoutingEngine(v);if(s){const t=s.executeCommand("PING",[]);t.success?T(`Подключение активно: ${M}:${I}`):y(`Ошибка подключения: ${t.error||"Unknown error"}`)}else{const{nodes:t,connections:a}=re.getState();N.initialize(t,a),setTimeout(()=>{N.getRedisRoutingEngine(v)?T(`Подключение установлено: ${M}:${I}`):y("Не удалось инициализировать подключение")},100)}},children:"Проверить подключение"})]})]})]}),e.jsxs(He,{defaultValue:"keys",className:"w-full",children:[e.jsxs(Ue,{className:"grid w-full grid-cols-4",children:[e.jsxs($,{value:"keys",className:"gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"Keys"]}),e.jsxs($,{value:"commands",className:"gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),"Commands"]}),e.jsxs($,{value:"configuration",className:"gap-2",children:[e.jsx(_e,{className:"h-4 w-4"}),"Configuration"]}),e.jsxs($,{value:"cluster",className:"gap-2",children:[e.jsx(U,{className:"h-4 w-4"}),"Cluster"]})]}),e.jsxs(D,{value:"keys",className:"mt-4 space-y-4",children:[x&&e.jsxs(R,{className:"border-l-4 border-l-blue-500",children:[e.jsx(K,{children:e.jsx(E,{className:"text-base",children:"Real-time Metrics"})}),e.jsx(b,{children:e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Memory Usage"}),e.jsxs("div",{className:"text-2xl font-bold",children:[(x.memoryUsage/1024/1024).toFixed(2)," MB"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[x.memoryUsagePercent.toFixed(1),"% of max"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Operations/sec"}),e.jsx("div",{className:"text-2xl font-bold",children:x.operationsPerSecond.toFixed(0)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Current rate"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Hit Rate"}),e.jsxs("div",{className:"text-2xl font-bold",children:[(x.hitRate*100).toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[x.hitCount," hits / ",x.missCount," misses"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Keys"}),e.jsx("div",{className:"text-2xl font-bold",children:x.totalKeys}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"In memory"})]})]})})]}),e.jsxs(R,{children:[e.jsxs(K,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(E,{children:"Keys"}),e.jsxs(z,{children:["Manage Redis keys and their values",O.length>0&&e.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",O.length," keys from runtime)"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{className:"w-48",placeholder:"Search pattern (e.g., user:*)",value:L,onChange:s=>Fe(s.target.value)}),e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>G(!0),children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Add Key"]})]})]}),Me&&e.jsx(b,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Key Name"}),e.jsx(o,{value:f,onChange:s=>q(s.target.value),placeholder:"user:1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Type"}),e.jsxs(V,{value:W,onValueChange:s=>Ie(s),children:[e.jsx(A,{children:e.jsx(B,{})}),e.jsxs(H,{children:[e.jsx(c,{value:"string",children:"String"}),e.jsx(c,{value:"hash",children:"Hash"}),e.jsx(c,{value:"list",children:"List"}),e.jsx(c,{value:"set",children:"Set"}),e.jsx(c,{value:"zset",children:"Sorted Set"}),e.jsx(c,{value:"stream",children:"Stream"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"TTL (seconds, -1 for no expiry)"}),e.jsx(o,{type:"number",value:C,onChange:s=>Q(s.target.value),placeholder:"-1"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Value (JSON for complex types)"}),e.jsx(Ne,{className:"font-mono text-sm",rows:3,value:Z,onChange:s=>Y(s.target.value),placeholder:W==="string"?'"value"':'{"field": "value"}'})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{onClick:Oe,disabled:!f.trim(),children:"Add Key"}),e.jsx(u,{variant:"outline",onClick:()=>{G(!1),q(""),Y(""),Q("")},children:"Cancel"})]})]})}),e.jsxs(b,{className:"space-y-2",children:[pe.map((s,t)=>e.jsxs("div",{className:"p-3 border border-border rounded-lg bg-card space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1.5 rounded ${Be(s.type)}`,children:Ae(s.type)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-mono font-semibold",children:s.key}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(S,{variant:"outline",className:"text-xs",children:s.type}),s.ttl&&s.ttl>0&&e.jsxs("span",{children:["TTL: ",s.ttl,"s"]}),s.ttl===-1&&e.jsx("span",{children:"No expiry"}),s.size&&e.jsxs("span",{children:["Size: ",s.size," bytes"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{variant:"ghost",size:"sm",onClick:()=>ze(ee===t?null:t),children:ee===t?"Hide":"View"}),e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>$e(t),children:e.jsx(fe,{className:"h-4 w-4"})})]})]}),ee===t&&e.jsxs("div",{className:"pt-2 border-t space-y-2",children:[e.jsx(n,{children:"Value"}),e.jsx(Ne,{className:"font-mono text-xs",rows:4,value:typeof s.value=="string"?s.value:JSON.stringify(s.value,null,2),onChange:a=>{try{const i=JSON.parse(a.target.value);ae(t,"value",i)}catch{ae(t,"value",a.target.value),(a.target.value.trim().startsWith("{")||a.target.value.trim().startsWith("["))&&qe("Неверный формат JSON, значение сохранено как строка")}}}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(n,{children:"TTL (seconds)"}),e.jsx(o,{type:"number",value:s.ttl||-1,onChange:a=>ae(t,"ttl",parseInt(a.target.value)||-1)})]})})]})]},t)),pe.length===0&&e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No keys found. Add a key to get started."})]})]})]}),e.jsx(D,{value:"commands",className:"mt-4 space-y-4",children:e.jsxs(R,{children:[e.jsxs(K,{children:[e.jsx(E,{children:"Redis Commands"}),e.jsx(z,{children:"Execute Redis commands directly"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Command"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{className:"font-mono",value:X,onChange:s=>oe(s.target.value),onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),ue())},placeholder:"GET user:1"}),e.jsxs(u,{onClick:ue,children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Execute"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Examples: GET key, SET key value, HGETALL hash, LPUSH list value, SADD set member"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Command History"}),e.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[J.map((s,t)=>e.jsxs("div",{className:"p-3 border rounded bg-muted/50 font-mono text-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"text-primary font-semibold",children:[s.command," ",s.args.join(" ")]})}),s.result&&e.jsxs("div",{className:"text-muted-foreground text-xs mt-1",children:["→ ",s.result]})]},t)),J.length===0&&e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No commands executed yet"})]})]})]})]})}),e.jsx(D,{value:"configuration",className:"mt-4 space-y-4",children:e.jsxs(R,{children:[e.jsxs(K,{children:[e.jsx(E,{children:"Redis Configuration"}),e.jsx(z,{children:"Configure Redis server settings"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Max Memory"}),e.jsx(o,{value:Ke,onChange:s=>l({maxMemory:s.target.value}),placeholder:"256mb"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Max Memory Policy"}),e.jsxs(V,{value:Ee,onValueChange:s=>l({maxMemoryPolicy:s}),children:[e.jsx(A,{children:e.jsx(B,{})}),e.jsxs(H,{children:[e.jsx(c,{value:"noeviction",children:"noeviction"}),e.jsx(c,{value:"allkeys-lru",children:"allkeys-lru"}),e.jsx(c,{value:"allkeys-lfu",children:"allkeys-lfu"}),e.jsx(c,{value:"volatile-lru",children:"volatile-lru"}),e.jsx(c,{value:"volatile-lfu",children:"volatile-lfu"}),e.jsx(c,{value:"volatile-ttl",children:"volatile-ttl"}),e.jsx(c,{value:"volatile-random",children:"volatile-random"}),e.jsx(c,{value:"allkeys-random",children:"allkeys-random"})]})]})]})]}),e.jsx(le,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{children:"Enable Persistence"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Save data to disk"})]}),e.jsx(ne,{checked:ie,onCheckedChange:s=>l({enablePersistence:s})})]}),ie&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Persistence Type"}),e.jsxs(V,{value:F,onValueChange:s=>l({persistenceType:s}),children:[e.jsx(A,{children:e.jsx(B,{})}),e.jsxs(H,{children:[e.jsx(c,{value:"rdb",children:"RDB"}),e.jsx(c,{value:"aof",children:"AOF"}),e.jsx(c,{value:"both",children:"Both"})]})]})]}),F==="rdb"||F==="both"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"RDB Save Interval"}),e.jsx(o,{value:Te,onChange:s=>l({rdbSaveInterval:s.target.value}),placeholder:"900 1 300 10 60 10000"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Format: save <seconds> <changes>"})]}),F==="aof"||F==="both"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"AOF Rewrite Policy"}),e.jsxs(V,{value:Pe,onValueChange:s=>l({aofRewritePolicy:s}),children:[e.jsx(A,{children:e.jsx(B,{})}),e.jsxs(H,{children:[e.jsx(c,{value:"always",children:"always"}),e.jsx(c,{value:"everysec",children:"everysec"}),e.jsx(c,{value:"no",children:"no"})]})]})]})]})]}),e.jsx(le,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Enable Metrics Export (redis_exporter)"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Export Redis metrics for Prometheus scraping"})]}),e.jsx(ne,{checked:r.metrics?.enabled??!0,onCheckedChange:s=>l({metrics:{...r.metrics,enabled:s,port:r.metrics?.port||9121,path:r.metrics?.path||"/metrics"}})})]}),r.metrics?.enabled!==!1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Metrics Port (redis_exporter)"}),e.jsx(o,{type:"number",value:r.metrics?.port??9121,onChange:s=>l({metrics:{...r.metrics,port:parseInt(s.target.value)||9121,path:r.metrics?.path||"/metrics"}}),min:1024,max:65535}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default port for redis_exporter: 9121"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Metrics Path"}),e.jsx(o,{type:"text",value:r.metrics?.path??"/metrics",onChange:s=>l({metrics:{...r.metrics,path:s.target.value||"/metrics",port:r.metrics?.port||9121}}),placeholder:"/metrics"})]})]})]})]})]})}),e.jsx(D,{value:"cluster",className:"mt-4 space-y-4",children:e.jsxs(R,{children:[e.jsxs(K,{children:[e.jsx(E,{children:"Redis Cluster Configuration"}),e.jsx(z,{children:"Configure Redis cluster for high availability"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(n,{children:"Enable Cluster Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable Redis cluster for distributed data"})]}),e.jsx(ne,{checked:de,onCheckedChange:s=>l({enableCluster:s})})]}),de&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{children:"Cluster Nodes"}),e.jsxs(u,{variant:"outline",size:"sm",onClick:De,children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Add Node"]})]}),_.map((s,t)=>e.jsxs("div",{className:"p-3 border rounded bg-muted/50 flex items-center justify-between",children:[e.jsx("span",{className:"font-mono",children:s}),e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>Ve(t),children:e.jsx(fe,{className:"h-3 w-3"})})]},t))]})]})]})})]})]})})}export{cs as RedisConfigAdvanced};

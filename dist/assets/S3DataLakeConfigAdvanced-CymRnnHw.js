import{E as X,u as _,j as e,r as b,i as f,S as A,C as n,e as h,f as j,k as r,B as d,T as U,a as Y,b as C,A as q,d as w,h as S,P as E,m as R,L as l,I as m,t as p,n as H,o as J,p as $,q as Q,s as B}from"./index-Dd33G1rA.js";import{R as Z}from"./refresh-ccw-BqMDkn9s.js";import{C as ee}from"./cloud-CWbIka4E.js";import{K as se}from"./key-B6QhA7BP.js";import{F as ae}from"./folder-xMpTiV1d.js";const ce=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],K=X("archive",ce);function me({componentId:k}){const{nodes:L,updateNode:I}=_(),v=L.find(s=>s.id===k);if(!v)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const u=v.data.config||{},t=u.buckets||[],z=u.accessKeyId||"",D=u.secretAccessKey||"",N=u.defaultRegion||"us-east-1",g=u.lifecycleRules||[],[le,ne]=b.useState(null),[te,ie]=b.useState(null),[re,T]=b.useState(!1),o=s=>{I(k,{data:{...v.data,config:{...u,...s}}})},M=()=>{const s={name:"new-bucket",region:N,versioning:!1,encryption:"AES256",lifecycleEnabled:!1,publicAccess:!1,objectCount:0,totalSize:0,folders:[]};o({buckets:[...t,s]})},F=s=>{o({buckets:t.filter((c,a)=>a!==s)})},i=(s,c,a)=>{const x=[...t];x[s]={...x[s],[c]:a},o({buckets:x})},P=()=>{const s={id:`rule-${Date.now()}`,name:"New Lifecycle Rule",status:"Enabled",transitions:[]};o({lifecycleRules:[...g,s]}),T(!1)},O=s=>{o({lifecycleRules:g.filter(c=>c.id!==s)})},V=t.length,G=t.reduce((s,c)=>s+(c.objectCount||0),0),W=t.reduce((s,c)=>s+(c.totalSize||0),0),y=s=>{if(s===0)return"0 Bytes";const c=1024,a=["Bytes","KB","MB","GB","TB"],x=Math.floor(Math.log(s)/Math.log(c));return Math.round(s/Math.pow(c,x)*100)/100+" "+a[x]};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Amazon S3 Data Lake"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Object Storage"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure S3 buckets, lifecycle policies and data lake storage"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(f,{variant:"outline",size:"sm",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(f,{variant:"outline",size:"sm",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"AWS Console"]})]})]}),e.jsx(A,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(n,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(j,{className:"text-sm font-medium",children:"Buckets"})}),e.jsx(r,{children:e.jsx("span",{className:"text-2xl font-bold",children:V})})]}),e.jsxs(n,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(j,{className:"text-sm font-medium",children:"Total Objects"})}),e.jsx(r,{children:e.jsx("span",{className:"text-2xl font-bold",children:G.toLocaleString()})})]}),e.jsxs(n,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(j,{className:"text-sm font-medium",children:"Total Size"})}),e.jsx(r,{children:e.jsx("span",{className:"text-2xl font-bold",children:y(W)})})]}),e.jsxs(n,{children:[e.jsx(h,{className:"pb-3",children:e.jsx(j,{className:"text-sm font-medium",children:"Default Region"})}),e.jsx(r,{children:e.jsx(d,{variant:"outline",children:N})})]})]}),e.jsxs(U,{defaultValue:"buckets",className:"space-y-4",children:[e.jsxs(Y,{children:[e.jsxs(C,{value:"buckets",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Buckets (",t.length,")"]}),e.jsxs(C,{value:"lifecycle",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Lifecycle Rules (",g.length,")"]}),e.jsxs(C,{value:"credentials",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Credentials"]})]}),e.jsx(w,{value:"buckets",className:"space-y-4",children:e.jsxs(n,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(j,{children:"S3 Buckets"}),e.jsx(S,{children:"Configure and manage S3 buckets for data lake storage"})]}),e.jsxs(f,{onClick:M,size:"sm",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Bucket"]})]})}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:t.map((s,c)=>e.jsxs(n,{className:"border-l-4 border-l-orange-500",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(K,{className:"h-5 w-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx(j,{className:"text-base",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(d,{variant:"outline",children:s.region}),s.versioning&&e.jsx(d,{variant:"default",children:"Versioning"}),s.publicAccess&&e.jsx(d,{variant:"destructive",children:"Public"}),e.jsxs(d,{variant:"outline",children:[s.objectCount||0," objects"]})]})]})]}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>F(c),disabled:t.length===1,children:e.jsx(R,{className:"h-4 w-4"})})]})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Objects"}),e.jsx("p",{className:"text-lg font-semibold",children:(s.objectCount||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Size"}),e.jsx("p",{className:"text-lg font-semibold",children:y(s.totalSize||0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Bucket URL"}),e.jsxs("p",{className:"text-xs font-mono text-muted-foreground truncate",children:["s3://",s.name]})]})]}),e.jsx(A,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Bucket Name"}),e.jsx(m,{value:s.name,onChange:a=>i(c,"name",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Region"}),e.jsx(m,{value:s.region,onChange:a=>i(c,"region",a.target.value),placeholder:"us-east-1"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Versioning"}),e.jsx(p,{checked:s.versioning||!1,onCheckedChange:a=>i(c,"versioning",a)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Encryption"}),e.jsxs(H,{value:s.encryption||"AES256",onValueChange:a=>i(c,"encryption",a),children:[e.jsx(J,{children:e.jsx($,{})}),e.jsxs(Q,{children:[e.jsx(B,{value:"AES256",children:"AES256"}),e.jsx(B,{value:"aws:kms",children:"AWS KMS"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Public Access"}),e.jsx(p,{checked:s.publicAccess||!1,onCheckedChange:a=>i(c,"publicAccess",a)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Lifecycle Enabled"}),e.jsx(p,{checked:s.lifecycleEnabled||!1,onCheckedChange:a=>i(c,"lifecycleEnabled",a)})]}),s.lifecycleEnabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Lifecycle Transition Days"}),e.jsx(m,{type:"number",value:s.lifecycleDays||30,onChange:a=>i(c,"lifecycleDays",Number(a.target.value)),min:1})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable Glacier Archive"}),e.jsx(p,{checked:s.glacierEnabled||!1,onCheckedChange:a=>i(c,"glacierEnabled",a)})]}),s.glacierEnabled&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Glacier Transition Days"}),e.jsx(m,{type:"number",value:s.glacierDays||90,onChange:a=>i(c,"glacierDays",Number(a.target.value)),min:90})]})]})]}),s.folders&&s.folders.length>0&&e.jsxs("div",{children:[e.jsx(l,{className:"mb-2 block",children:"Folders"}),e.jsx("div",{className:"space-y-2",children:s.folders.map((a,x)=>e.jsx(n,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a.path})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(d,{variant:"outline",children:[a.objectCount||0," objects"]}),e.jsx(d,{variant:"outline",children:y(a.size||0)})]})]})},x))})]})]})]},c))})})]})}),e.jsx(w,{value:"lifecycle",className:"space-y-4",children:e.jsxs(n,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(j,{children:"Lifecycle Rules"}),e.jsx(S,{children:"Configure automatic transitions and expiration"})]}),e.jsxs(f,{onClick:P,size:"sm",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Rule"]})]})}),e.jsx(r,{children:g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No lifecycle rules configured"}):e.jsx("div",{className:"space-y-2",children:g.map(s=>e.jsx(n,{className:"border-l-4 border-l-green-500",children:e.jsx(r,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{variant:s.status==="Enabled"?"default":"outline",children:s.status}),e.jsx("span",{className:"font-medium",children:s.name}),s.prefix&&e.jsxs(d,{variant:"outline",children:["Prefix: ",s.prefix]})]})}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>O(s.id),children:e.jsx(R,{className:"h-4 w-4"})})]})})},s.id))})})]})}),e.jsx(w,{value:"credentials",className:"space-y-4",children:e.jsxs(n,{children:[e.jsxs(h,{children:[e.jsx(j,{children:"AWS Credentials"}),e.jsx(S,{children:"Configure AWS access credentials for S3"})]}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"accessKeyId",children:"Access Key ID"}),e.jsx(m,{id:"accessKeyId",value:z,onChange:s=>o({accessKeyId:s.target.value}),placeholder:"AKIAIOSFODNN7EXAMPLE"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"secretAccessKey",children:"Secret Access Key"}),e.jsx(m,{id:"secretAccessKey",type:"password",value:D,onChange:s=>o({secretAccessKey:s.target.value}),placeholder:"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"defaultRegion",children:"Default Region"}),e.jsx(m,{id:"defaultRegion",value:N,onChange:s=>o({defaultRegion:s.target.value}),placeholder:"us-east-1"})]}),e.jsx("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-md",children:e.jsxs("p",{className:"text-sm text-yellow-700 dark:text-yellow-400",children:[e.jsx("strong",{children:"Security Note:"})," In production, use IAM roles or environment variables instead of hardcoding credentials."]})})]})]})})]})]})})}export{me as S3DataLakeConfigAdvanced};

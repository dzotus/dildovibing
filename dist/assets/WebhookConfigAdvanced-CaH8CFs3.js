import{u as P,j as e,r as F,i as j,S as w,C as n,e as l,f as r,k as i,T as H,a as I,b as u,A as L,c as V,d as p,h as f,P as z,B as d,m as O,L as a,X,t as y,I as g}from"./index-D0eJihqw.js";import{R as $}from"./refresh-ccw-DqkQ7qOS.js";import{W as b}from"./webhook-WGtLSmMQ.js";import{S as G}from"./send-DEXwtZtJ.js";import{C}from"./circle-check-big-BIpSuQBt.js";import{C as M}from"./clock-DxK4bNJ9.js";function _({componentId:N}){const{nodes:k,updateNode:S}=P(),m=k.find(s=>s.id===N);if(!m)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const t=m.data.config||{},x=t.endpoints||[],o=t.deliveries||[],E=t.totalEndpoints||x.length,R=t.totalDeliveries||o.length,T=t.successRate||(o.length>0?o.filter(s=>s.status==="success").length/o.length*100:0),[q,D]=F.useState(!1),c=s=>{S(N,{data:{...m.data,config:{...t,...s}}})},W=()=>{const s={id:`wh-${Date.now()}`,name:"New Webhook",url:"https://api.example.com/webhooks/new",method:"POST",enabled:!0,events:[]};c({endpoints:[...x,s]}),D(!1)},A=s=>{c({endpoints:x.filter(h=>h.id!==s)})},v=s=>{switch(s){case"success":return"bg-green-500";case"failed":return"bg-red-500";case"pending":return"bg-yellow-500";default:return"bg-gray-500"}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Webhook"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Webhook Endpoint"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"HTTP callback endpoint for event notifications"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(j,{variant:"outline",size:"sm",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(w,{}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(n,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{className:"text-sm font-medium text-muted-foreground",children:"Endpoints"}),e.jsx(b,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:E}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"configured"})]})})]}),e.jsxs(n,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{className:"text-sm font-medium text-muted-foreground",children:"Deliveries"}),e.jsx(G,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:R}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"total"})]})})]}),e.jsxs(n,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{className:"text-sm font-medium text-muted-foreground",children:"Success Rate"}),e.jsx(C,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(i,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsxs("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:[T.toFixed(1),"%"]})})})]})]}),e.jsxs(H,{defaultValue:"endpoints",className:"space-y-4",children:[e.jsxs(I,{children:[e.jsxs(u,{value:"endpoints",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Endpoints (",x.length,")"]}),e.jsxs(u,{value:"deliveries",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Deliveries (",o.length,")"]}),e.jsxs(u,{value:"settings",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(p,{value:"endpoints",className:"space-y-4",children:e.jsxs(n,{children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Webhook Endpoints"}),e.jsx(f,{children:"Configure webhook endpoints"})]}),e.jsxs(j,{onClick:W,size:"sm",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Create Endpoint"]})]})}),e.jsx(i,{children:e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsxs(n,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:e.jsx(b,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(r,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(d,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"}),e.jsx(d,{variant:"outline",className:"font-mono text-xs",children:s.method}),e.jsx(d,{variant:"outline",className:"font-mono text-xs truncate max-w-xs",children:s.url})]})]})]}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>A(s.id),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(O,{className:"h-4 w-4"})})]})}),e.jsxs(i,{children:[s.events&&s.events.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Events"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.events.map((h,B)=>e.jsx(d,{variant:"outline",children:h},B))})]}),s.secret&&e.jsxs("div",{className:"mt-2",children:[e.jsx(a,{children:"Secret"}),e.jsx("div",{className:"text-xs font-mono text-muted-foreground",children:s.secret})]})]})]},s.id))})})]})}),e.jsx(p,{value:"deliveries",className:"space-y-4",children:e.jsxs(n,{children:[e.jsxs(l,{children:[e.jsx(r,{children:"Delivery History"}),e.jsx(f,{children:"Webhook delivery attempts and results"})]}),e.jsx(i,{children:e.jsx("div",{className:"space-y-4",children:o.map(s=>e.jsxs(n,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${v(s.status)}/20`,children:s.status==="success"?e.jsx(C,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):s.status==="failed"?e.jsx(X,{className:"h-5 w-5 text-red-600 dark:text-red-400"}):e.jsx(M,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{children:[e.jsx(r,{className:"text-lg font-semibold",children:s.event}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(d,{variant:"outline",className:v(s.status),children:s.status}),s.attempts&&e.jsxs(d,{variant:"outline",children:["Attempts: ",s.attempts]}),s.responseCode&&e.jsxs(d,{variant:"outline",children:["HTTP ",s.responseCode]})]})]})]})})}),e.jsxs(i,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Payload"}),e.jsx("pre",{className:"p-3 bg-muted rounded text-xs font-mono overflow-x-auto max-h-40 overflow-y-auto",children:s.payload})]}),s.responseBody&&e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsx(a,{children:"Response"}),e.jsx("pre",{className:"p-3 bg-muted rounded text-xs font-mono overflow-x-auto max-h-40 overflow-y-auto",children:s.responseBody})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:new Date(s.timestamp).toLocaleString()})]})]},s.id))})})]})}),e.jsx(p,{value:"settings",className:"space-y-4",children:e.jsxs(n,{children:[e.jsxs(l,{children:[e.jsx(r,{children:"Webhook Settings"}),e.jsx(f,{children:"Global configuration"})]}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(a,{children:"Enable Retry on Failure"}),e.jsx(y,{checked:t.enableRetryOnFailure??!0,onCheckedChange:s=>c({enableRetryOnFailure:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(a,{children:"Enable Signature Verification"}),e.jsx(y,{checked:t.enableSignatureVerification??!0,onCheckedChange:s=>c({enableSignatureVerification:s})})]}),e.jsx(w,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Max Retry Attempts"}),e.jsx(g,{type:"number",value:t.maxRetryAttempts??3,onChange:s=>c({maxRetryAttempts:parseInt(s.target.value)||3}),min:1,max:10})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Retry Delay (seconds)"}),e.jsx(g,{type:"number",value:t.retryDelay??5,onChange:s=>c({retryDelay:parseInt(s.target.value)||5}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Timeout (seconds)"}),e.jsx(g,{type:"number",value:t.timeout??30,onChange:s=>c({timeout:parseInt(s.target.value)||30}),min:1})]})]})]})})]})]})})}export{_ as WebhookConfigAdvanced};

import{K as _e,u as Xe,a as Ze,j as e,e as Qe,r as b,l as m,S as D,C as x,h,i as g,a4 as we,m as u,T as Ye,b as es,c as O,d as ss,f as K,k as z,L as l,B as F,I as f,ax as ae,aj as ts,P as ce,o as ke,q as Ee,s as Me,t as Ae,v as Re,w as X,x as U}from"./index-Cd-JdYDo.js";import{T as ns}from"./textarea-C1mJ7m6P.js";import{s as E,d as J}from"./toast-46NEDLjC.js";import{R as is}from"./refresh-ccw--KPBcUEB.js";import{M as re}from"./message-square-B4o7a5LA.js";import{S as oe}from"./send-B14poIBT.js";import{B as ve}from"./bell-D2r3ca8X.js";import{C as be}from"./circle-check-big-Cu7gDr-H.js";import{P as De}from"./pen-Dm0X2t9p.js";const as=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],cs=_e("house",as);function ps({componentId:M}){const{nodes:le,updateNode:Z}=Xe(),{getComponentMetrics:Pe,isRunning:Q}=Ze(),Y=le.find(s=>s.id===M);if(!Y)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const i=Y.data.config||{};Pe(M);const o=Qe.getWebSocketEmulationEngine(M),de=o?.getWebSocketMetrics(),d=i.connections||[],ee=i.messages||[],W=i.rooms||[],P=i.subscriptions||[],T=i.endpoint||"ws://localhost:8080/ws",Te=i.protocol||"ws",Le=d.filter(s=>s.status==="connected").length,Ie=de?.connectionsTotal||i.totalConnections||d.length,ze=de?.connectionsActive||i.activeConnections||Le,We=de?.messagesTotal||i.totalMessages||ee.length,[$,me]=b.useState(""),[j,y]=b.useState(!1),[v,L]=b.useState(null),[S,w]=b.useState(null),[k,xe]=b.useState(null),[B,he]=b.useState(null),[p,H]=b.useState(""),[ge,V]=b.useState(""),[N,q]=b.useState("");b.useEffect(()=>{if(v){const s=d.find(n=>n.id===v);s&&s.status==="connected"?(y(!0),S||w(T)):(y(!1),L(null),w(null))}else{const s=d.find(n=>n.id.startsWith("test-client-"));s&&s.status==="connected"?(L(s.id),y(!0),S||w(T)):j&&(y(!1),w(null))}},[d,v,T,S,j]),b.useEffect(()=>{if(!Q||!o)return;const s=setInterval(()=>{const n=le.find(r=>r.id===M);if(!n)return;const t=n.data.config||{},C=o.getWebSocketMetrics(),A=o.getActiveConnections(),I=o.getRooms(),te=o.getSubscriptions(),ne=o.getMessageHistory(100);let R=[...A.map(r=>({id:r.id,status:r.status==="connected"?"connected":r.status==="disconnected"?"disconnected":"connecting",connectedAt:r.connectedAt?new Date(r.connectedAt).toISOString():void 0,messagesSent:r.messagesSent,messagesReceived:r.messagesReceived}))];const a=(t.connections||[]).filter(r=>r.id.startsWith("test-client-"));for(const r of a){const _=R.findIndex(Ge=>Ge.id===r.id);_>=0?R[_]={...R[_],status:r.status}:R.push(r)}const ie=ne.map(r=>({id:r.id,type:r.direction==="sent"?"sent":"received",content:typeof r.content=="string"?r.content:"[Binary data]",timestamp:new Date(r.timestamp).toISOString()})),fe=(t.messages||[]).filter(r=>r.id.startsWith("msg-")&&!ne.find(_=>_.id===r.id)),Se=[...ie,...fe].slice(-100);(JSON.stringify(R)!==JSON.stringify(t.connections)||JSON.stringify(I)!==JSON.stringify(t.rooms)||JSON.stringify(te)!==JSON.stringify(t.subscriptions)||JSON.stringify(Se)!==JSON.stringify(t.messages)||C.connectionsTotal!==t.totalConnections||C.connectionsActive!==t.activeConnections||C.messagesTotal!==t.totalMessages)&&Z(M,{data:{...n.data,config:{...t,connections:R,rooms:I,subscriptions:te,messages:Se,totalConnections:C.connectionsTotal,activeConnections:C.connectionsActive,totalMessages:C.messagesTotal}}})},1e3);return()=>clearInterval(s)},[Q,o,M,le,Z]);const $e=s=>{if(!s.trim())return"Endpoint is required";try{const n=new URL(s);return n.protocol!=="ws:"&&n.protocol!=="wss:"?"Endpoint must use ws:// or wss:// protocol":null}catch{return"Invalid endpoint URL format"}},G=(s,n,t=1)=>s==null?null:isNaN(s)||s<t?`${n} must be at least ${t}`:null,c=s=>{if(s.endpoint!==void 0){const t=$e(s.endpoint);if(t){J(t);return}}if(s.maxConnections!==void 0){const t=G(s.maxConnections,"Max connections");if(t){J(t);return}}if(s.maxMessageSize!==void 0){const t=G(s.maxMessageSize,"Max message size");if(t){J(t);return}}if(s.pingInterval!==void 0){const t=G(s.pingInterval,"Ping interval",1);if(t){J(t);return}}if(s.rateLimit){if(s.rateLimit.messagesPerSecond!==void 0){const t=G(s.rateLimit.messagesPerSecond,"Messages per second");if(t){J(t);return}}if(s.rateLimit.connectionsPerSecond!==void 0){const t=G(s.rateLimit.connectionsPerSecond,"Connections per second");if(t){J(t);return}}}const n={...i,...s};try{if(Z(M,{data:{...Y.data,config:n}}),o)try{o.updateConfig(n)}catch(t){console.error("Error updating WebSocket engine config:",t),E(`Failed to sync configuration: ${t instanceof Error?t.message:"Unknown error"}`)}}catch(t){console.error("Error updating config:",t),E(`Failed to update configuration: ${t instanceof Error?t.message:"Unknown error"}`)}},Be=()=>{if(!$.trim()||!j||!v)return;const s=new Blob([$]).size,n=(i.maxMessageSize||1024)*1024;if(s>n){E(`Message size ${(s/1024).toFixed(2)} KB exceeds maximum ${i.maxMessageSize||1024} KB`);return}if(o)try{const t=o.processIncomingMessage(v,$,{source:"test-client",timestamp:Date.now()},"sent");if(!t.processed){t.error?E(t.error):E("Failed to process message");return}me("")}catch(t){console.error("Error sending message:",t),E(`Failed to send message: ${t instanceof Error?t.message:"Unknown error"}`)}else{const t={id:`msg-${Date.now()}`,type:"sent",content:$,timestamp:new Date().toISOString()},C=d.map(A=>A.id===v?{...A,messagesSent:(A.messagesSent||0)+1}:A);c({messages:[...ee,t],connections:C}),me("")}},Oe=()=>{if(j){if(v){if(o)try{o.closeConnection(v)}catch(n){console.error("Error closing connection:",n),E(`Failed to close connection: ${n instanceof Error?n.message:"Unknown error"}`)}const s=d.map(n=>n.id===v?{...n,status:"disconnected",connectedAt:n.connectedAt}:n);c({connections:s}),L(null)}y(!1),w(null)}else{const s=`test-client-${Date.now()}`,n={id:s,status:"connected",connectedAt:new Date().toISOString(),messagesSent:0,messagesReceived:0};if(L(s),w(T),y(!0),c({connections:[...d,n]}),o)try{if(!o.createConnection(s,{clientIP:"127.0.0.1",userAgent:"WebSocket Test Client"})){y(!1),L(null),w(null),E("Failed to create connection: connection limit reached or authentication failed");return}}catch(t){console.error("Error creating connection:",t),y(!1),L(null),w(null),E(`Failed to create connection: ${t instanceof Error?t.message:"Unknown error"}`);return}}},Ke=s=>{if(j&&S&&s!==S){let n=[...d];v&&(n=d.map(t=>t.id===v?{...t,status:"disconnected",connectedAt:t.connectedAt}:t),L(null)),y(!1),w(null),c({endpoint:s,connections:n})}else c({endpoint:s})},se=()=>{if(!p.trim())return;const s={id:`room-${Date.now()}`,name:p,connections:[],messagesBroadcast:0,createdAt:Date.now(),description:ge},n=[...W,s];c({rooms:n}),H(""),V("")},Fe=s=>{xe(s),H(s.name),V(s.description||"")},ue=()=>{if(!k||!p.trim())return;const s=W.map(n=>n.id===k.id?{...n,name:p,description:ge}:n);c({rooms:s}),xe(null),H(""),V("")},je=()=>{xe(null),H(""),V("")},Ue=s=>{const n=W.filter(t=>t.id!==s);c({rooms:n})},pe=()=>{if(!N.trim())return;const s={id:`sub-${Date.now()}`,topic:N,connections:[],messagesDelivered:0,createdAt:Date.now(),enabled:!0},n=[...P,s];c({subscriptions:n}),q("")},Je=s=>{const n=P.filter(t=>t.id!==s);c({subscriptions:n})},He=s=>{he(s),q(s.topic)},Ne=()=>{if(!B||!N.trim())return;const s=P.map(n=>n.id===B.id?{...n,topic:N}:n);c({subscriptions:s}),he(null),q("")},Ce=()=>{he(null),q("")},Ve=s=>{const n=P.map(t=>t.id===s?{...t,enabled:!t.enabled}:t);c({subscriptions:n})},qe=()=>{if(o&&Q){const s=o.getWebSocketMetrics(),n=o.getActiveConnections(),t=o.getRooms(),C=o.getSubscriptions(),A=o.getMessageHistory(100),I=n.map(a=>({id:a.id,status:a.status==="connected"?"connected":a.status==="disconnected"?"disconnected":"connecting",connectedAt:a.connectedAt?new Date(a.connectedAt).toISOString():void 0,messagesSent:a.messagesSent,messagesReceived:a.messagesReceived})),te=d.filter(a=>a.id.startsWith("test-client-"));for(const a of te){const ie=I.findIndex(fe=>fe.id===a.id);ie>=0?I[ie]=a:I.push(a)}const ne=t.map(a=>({id:a.id,name:a.name,connections:a.connections,messagesBroadcast:a.messagesBroadcast,createdAt:a.createdAt})),ye=C.map(a=>({id:a.id,topic:a.topic,connections:a.connections,messagesDelivered:a.messagesDelivered,createdAt:a.createdAt,enabled:a.enabled})),R=A.map(a=>({id:a.id,type:a.direction==="sent"?"sent":"received",content:typeof a.content=="string"?a.content:"[Binary data]",timestamp:new Date(a.timestamp).toISOString()}));Z(M,{data:{...Y.data,config:{...i,connections:I,rooms:ne,subscriptions:ye,messages:R,totalConnections:s.connectionsTotal,activeConnections:s.connectionsActive,totalMessages:s.messagesTotal}}})}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"WebSocket"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"WebSocket Server"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Real-time bidirectional communication"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(m,{variant:"outline",size:"sm",onClick:qe,disabled:!Q&&!o,children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(D,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(x,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Connections"}),e.jsx(we,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:ze}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/ ",Ie," total"]})]})})]}),e.jsxs(x,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Messages"}),e.jsx(re,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:We}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"exchanged"})]})})]}),e.jsxs(x,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Sent"}),e.jsx(oe,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(u,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:d.reduce((s,n)=>s+(n.messagesSent||0),0)})})})]}),e.jsxs(x,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Received"}),e.jsx(re,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsx(u,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-cyan-600 dark:text-cyan-400",children:d.reduce((s,n)=>s+(n.messagesReceived||0),0)})})})]})]}),e.jsxs(Ye,{defaultValue:"client",className:"space-y-4",children:[e.jsxs(es,{className:"flex-wrap",children:[e.jsxs(O,{value:"client",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Test Client"]}),e.jsxs(O,{value:"connections",children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Connections (",d.length,")"]}),e.jsxs(O,{value:"rooms",children:[e.jsx(cs,{className:"h-4 w-4 mr-2"}),"Rooms (",W.length,")"]}),e.jsxs(O,{value:"subscriptions",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Subscriptions (",P.length,")"]}),e.jsxs(O,{value:"messages",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),"Messages (",ee.length,")"]}),e.jsxs(O,{value:"settings",children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(K,{value:"client",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(g,{children:"WebSocket Test Client"}),e.jsx(z,{children:"Connect and send messages"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Endpoint"}),j&&S&&e.jsxs(F,{variant:"outline",className:"text-xs",children:["Connected to: ",S]})]}),e.jsx(f,{value:T,onChange:s=>Ke(s.target.value),placeholder:"ws://localhost:8080/ws"}),j&&S&&T!==S&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-950/20 p-2 rounded",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{children:"Endpoint changed. Connection has been disconnected."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{onClick:Oe,variant:j?"destructive":"default",children:j?"Disconnect":"Connect"}),e.jsx(F,{variant:j?"default":"outline",children:j?"Connected":"Disconnected"})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Send Message"}),e.jsx(ns,{value:$,onChange:s=>me(s.target.value),className:"font-mono text-sm min-h-[100px]",placeholder:'{ "type": "message", "data": "Hello" }',disabled:!j})]}),e.jsxs(m,{onClick:Be,disabled:!j||!$.trim(),children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Send Message"]})]})]})}),e.jsx(K,{value:"connections",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(g,{children:"Active Connections"}),e.jsx(z,{children:"WebSocket client connections"})]}),e.jsx(u,{children:e.jsx("div",{className:"space-y-4",children:d.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No connections yet. Use the Test Client tab to create a connection."}):d.map(s=>e.jsxs(x,{className:`border-l-4 hover:shadow-md transition-shadow bg-card ${s.status==="connected"?"border-l-green-500":s.status==="disconnected"?"border-l-gray-400":"border-l-yellow-500"}`,children:[e.jsx(h,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.status==="connected"?"bg-green-100 dark:bg-green-900/30":s.status==="disconnected"?"bg-gray-100 dark:bg-gray-900/30":"bg-yellow-100 dark:bg-yellow-900/30"}`,children:s.status==="connected"?e.jsx(be,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):s.status==="disconnected"?e.jsx(ae,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"}):e.jsx(ts,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{children:[e.jsx(g,{className:"text-lg font-semibold",children:s.id.startsWith("test-client-")?"Test Client":s.id}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(F,{variant:s.status==="connected"?"default":"outline",children:s.status}),s.connectedAt&&e.jsxs(F,{variant:"outline",children:[s.status==="connected"?"Connected":"Disconnected"," ",new Date(s.connectedAt).toLocaleString()]})]})]})]})})}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Sent:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.messagesSent||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Received:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.messagesReceived||0})]}),s.lastMessage&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Last:"}),e.jsx("span",{className:"ml-2 font-semibold truncate",children:s.lastMessage})]})]})})]},s.id))})})]})}),e.jsx(K,{value:"messages",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(g,{children:"Message History"}),e.jsx(z,{children:"Sent and received messages"})]}),e.jsx(u,{children:e.jsx("div",{className:"space-y-4",children:ee.map(s=>e.jsxs(x,{className:`border-l-4 ${s.type==="sent"?"border-l-green-500 bg-card":"border-l-blue-500 bg-card"} hover:shadow-md transition-shadow`,children:[e.jsx(h,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.type==="sent"?"bg-green-100 dark:bg-green-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:s.type==="sent"?e.jsx(oe,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(re,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(g,{className:"text-lg font-semibold capitalize",children:s.type}),e.jsx(F,{variant:"outline",className:"mt-2",children:new Date(s.timestamp).toLocaleString()})]})]})})}),e.jsx(u,{children:e.jsx("pre",{className:"p-3 bg-muted rounded text-xs font-mono overflow-x-auto",children:s.content})})]},s.id))})})]})}),e.jsx(K,{value:"rooms",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Rooms"}),e.jsx(z,{children:"Group connections into rooms for broadcasting"})]}),e.jsxs(m,{onClick:se,size:"sm",disabled:!p.trim(),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add Room"]})]})}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{value:p,onChange:s=>H(s.target.value),placeholder:"Room name",className:"flex-1",onKeyDown:s=>{s.key==="Enter"&&!k&&p.trim()?se():s.key==="Enter"&&k&&p.trim()?ue():s.key==="Escape"&&k&&je()}}),e.jsx(f,{value:ge,onChange:s=>V(s.target.value),placeholder:"Description (optional)",className:"flex-1",onKeyDown:s=>{s.key==="Enter"&&!k&&p.trim()?se():s.key==="Enter"&&k&&p.trim()?ue():s.key==="Escape"&&k&&je()}}),k?e.jsxs(e.Fragment,{children:[e.jsxs(m,{onClick:ue,disabled:!p.trim(),children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Save"]}),e.jsxs(m,{onClick:je,variant:"outline",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):e.jsxs(m,{onClick:se,disabled:!p.trim(),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add"]})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-4",children:[W.map(s=>e.jsxs(x,{className:"border-l-4 border-l-purple-500",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-lg",children:s.name}),s.description&&e.jsx(z,{className:"mt-1",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>Fe(s),children:e.jsx(De,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>Ue(s.id),children:e.jsx(ke,{className:"h-4 w-4 text-destructive"})})]})]})}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Connections:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.connections?.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Messages:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.messagesBroadcast||0})]}),s.createdAt&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"}),e.jsx("span",{className:"ml-2 font-semibold",children:new Date(s.createdAt).toLocaleDateString()})]})]})})]},s.id)),W.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No rooms created yet. Create a room to group connections."})]})]})]})}),e.jsx(K,{value:"subscriptions",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Subscriptions"}),e.jsx(z,{children:"Subscribe connections to topics for event delivery"})]}),e.jsxs(m,{onClick:pe,size:"sm",disabled:!N.trim(),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add Subscription"]})]})}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{value:N,onChange:s=>q(s.target.value),placeholder:"Topic name (e.g., notifications, updates)",className:"flex-1",onKeyDown:s=>{s.key==="Enter"&&!B&&N.trim()?pe():s.key==="Enter"&&B&&N.trim()?Ne():s.key==="Escape"&&B&&Ce()}}),B?e.jsxs(e.Fragment,{children:[e.jsxs(m,{onClick:Ne,disabled:!N.trim(),children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Save"]}),e.jsxs(m,{onClick:Ce,variant:"outline",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):e.jsxs(m,{onClick:pe,disabled:!N.trim(),children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Add"]})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-4",children:[P.map(s=>e.jsxs(x,{className:`border-l-4 ${s.enabled?"border-l-green-500":"border-l-gray-300"}`,children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.enabled?"bg-green-100 dark:bg-green-900/30":"bg-gray-100 dark:bg-gray-900/30"}`,children:s.enabled?e.jsx(ve,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(ve,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("div",{children:[e.jsx(g,{className:"text-lg",children:s.topic}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx(F,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>He(s),children:e.jsx(De,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>Ve(s.id),children:s.enabled?"Disable":"Enable"}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>Je(s.id),children:e.jsx(ke,{className:"h-4 w-4 text-destructive"})})]})]})}),e.jsx(u,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Subscribers:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.connections?.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Messages:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.messagesDelivered||0})]}),s.createdAt&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"}),e.jsx("span",{className:"ml-2 font-semibold",children:new Date(s.createdAt).toLocaleDateString()})]})]})})]},s.id)),P.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No subscriptions created yet. Create a subscription to deliver messages to connections."})]})]})]})}),e.jsx(K,{value:"settings",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(g,{children:"WebSocket Settings"}),e.jsx(z,{children:"Server configuration"})]}),e.jsxs(u,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Endpoint URL"}),e.jsx(f,{value:T,onChange:s=>c({endpoint:s.target.value}),placeholder:"ws://localhost:8080/ws"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Protocol"}),e.jsxs(Ee,{value:Te,onValueChange:s=>c({protocol:s}),children:[e.jsx(Me,{children:e.jsx(Ae,{})}),e.jsxs(Re,{children:[e.jsx(X,{value:"ws",children:"WS (WebSocket)"}),e.jsx(X,{value:"wss",children:"WSS (Secure WebSocket)"})]})]})]}),e.jsx(D,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable Compression"}),e.jsx(U,{checked:i.enableCompression??!0,onCheckedChange:s=>c({enableCompression:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable Ping/Pong"}),e.jsx(U,{checked:i.enablePingPong??!0,onCheckedChange:s=>c({enablePingPong:s})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Ping Interval (seconds)"}),e.jsx(f,{type:"number",value:i.pingInterval??30,onChange:s=>c({pingInterval:parseInt(s.target.value)||30}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Max Connections"}),e.jsx(f,{type:"number",value:i.maxConnections??1e3,onChange:s=>c({maxConnections:parseInt(s.target.value)||1e3}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Max Message Size (KB)"}),e.jsx(f,{type:"number",value:i.maxMessageSize??1024,onChange:s=>c({maxMessageSize:parseInt(s.target.value)||1024}),min:1})]}),e.jsx(D,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Enable Rooms"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Group connections for broadcasting"})]}),e.jsx(U,{checked:i.roomsEnabled??!0,onCheckedChange:s=>c({roomsEnabled:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Enable Subscriptions"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Subscribe to topics for event delivery"})]}),e.jsx(U,{checked:i.subscriptionsEnabled??!0,onCheckedChange:s=>c({subscriptionsEnabled:s})})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Authentication"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Require authentication for connections"})]}),e.jsx(U,{checked:i.authentication?.enabled??!1,onCheckedChange:s=>c({authentication:{...i.authentication,enabled:s,method:i.authentication?.method||"none"}})})]}),i.authentication?.enabled&&e.jsxs("div",{className:"space-y-2 pl-6 border-l-2",children:[e.jsx(l,{children:"Authentication Method"}),e.jsxs(Ee,{value:i.authentication?.method||"none",onValueChange:s=>c({authentication:{...i.authentication,method:s}}),children:[e.jsx(Me,{children:e.jsx(Ae,{})}),e.jsxs(Re,{children:[e.jsx(X,{value:"token",children:"Token"}),e.jsx(X,{value:"apiKey",children:"API Key"}),e.jsx(X,{value:"basic",children:"Basic Auth"})]})]}),i.authentication?.method==="token"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Token"}),e.jsx(f,{type:"password",value:i.authentication?.token||"",onChange:s=>c({authentication:{...i.authentication,token:s.target.value}}),placeholder:"Enter token"})]}),i.authentication?.method==="apiKey"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"API Key"}),e.jsx(f,{type:"password",value:i.authentication?.apiKey||"",onChange:s=>c({authentication:{...i.authentication,apiKey:s.target.value}}),placeholder:"Enter API key"})]})]})]}),e.jsx(D,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Rate Limiting"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Limit message and connection rates"})]}),e.jsx(U,{checked:i.rateLimit?.enabled??!1,onCheckedChange:s=>c({rateLimit:{...i.rateLimit,enabled:s,messagesPerSecond:i.rateLimit?.messagesPerSecond||1e3,connectionsPerSecond:i.rateLimit?.connectionsPerSecond||100}})})]}),i.rateLimit?.enabled&&e.jsxs("div",{className:"space-y-2 pl-6 border-l-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Messages Per Second"}),e.jsx(f,{type:"number",value:i.rateLimit?.messagesPerSecond||1e3,onChange:s=>c({rateLimit:{...i.rateLimit,messagesPerSecond:parseInt(s.target.value)||1e3}}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Connections Per Second"}),e.jsx(f,{type:"number",value:i.rateLimit?.connectionsPerSecond||100,onChange:s=>c({rateLimit:{...i.rateLimit,connectionsPerSecond:parseInt(s.target.value)||100}}),min:1})]})]})]})]})]})})]})]})})}export{ps as WebSocketConfigAdvanced};

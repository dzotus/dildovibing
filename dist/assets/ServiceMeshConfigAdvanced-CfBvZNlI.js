import{u as A,j as e,r as D,i as u,S as g,C as r,e as l,f as c,k as n,A as O,Z as z,T as V,a as _,b as p,c as F,d as f,h as b,B as x,P as U,m as Z,L as i,t as h,n as $,o as G,p as H,q as J,s as v,I as N}from"./index-DLY56EcE.js";import{R as K}from"./refresh-ccw-CIIwm2k8.js";import{S as y}from"./server-dBT74kKC.js";import{S as P}from"./shield-DkBueQ2J.js";function se({componentId:w}){const{nodes:C,updateNode:k}=A(),j=C.find(s=>s.id===w);if(!j)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const a=j.data.config||{},o=a.services||[{id:"svc-1",name:"frontend",namespace:"default",pods:3,healthyPods:3,requests:12500,errors:25,latency:45},{id:"svc-2",name:"backend",namespace:"default",pods:2,healthyPods:2,requests:9800,errors:12,latency:120}],m=a.policies||[{id:"policy-1",name:"mTLS Policy",type:"security",enabled:!0,services:["frontend","backend"]},{id:"policy-2",name:"Traffic Splitting",type:"traffic",enabled:!0,services:["frontend"]}],T=a.totalServices||o.length,L=a.activePolicies||m.filter(s=>s.enabled).length,R=a.totalRequests||o.reduce((s,d)=>s+(d.requests||0),0),M=a.averageLatency||o.reduce((s,d)=>s+(d.latency||0),0)/o.length,[Q,E]=D.useState(!1),t=s=>{k(w,{data:{...j.data,config:{...a,...s}}})},q=()=>{const s={id:`policy-${Date.now()}`,name:"New Policy",type:"traffic",enabled:!0,services:[]};t({policies:[...m,s]}),E(!1)},I=s=>{t({policies:m.filter(d=>d.id!==s)})},S=s=>{switch(s){case"security":return"bg-red-500";case"traffic":return"bg-blue-500";case"observability":return"bg-purple-500";default:return"bg-gray-500"}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Service Mesh"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Service Mesh"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Service-to-service communication and management"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(u,{variant:"outline",size:"sm",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(g,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(r,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Services"}),e.jsx(y,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:T}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"registered"})]})})]}),e.jsxs(r,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Policies"}),e.jsx(P,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:L}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"active"})]})})]}),e.jsxs(r,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Requests"}),e.jsx(O,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(n,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:R.toLocaleString()})})})]}),e.jsxs(r,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Avg Latency"}),e.jsx(z,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsx(n,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-cyan-600 dark:text-cyan-400",children:M.toFixed(0)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"ms"})]})})]})]}),e.jsxs(V,{defaultValue:"services",className:"space-y-4",children:[e.jsxs(_,{children:[e.jsxs(p,{value:"services",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Services (",o.length,")"]}),e.jsxs(p,{value:"policies",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Policies (",m.length,")"]}),e.jsxs(p,{value:"settings",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(f,{value:"services",className:"space-y-4",children:e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsx(c,{children:"Services"}),e.jsx(b,{children:"Registered services in the mesh"})]}),e.jsx(n,{children:e.jsx("div",{className:"space-y-4",children:o.map(s=>e.jsxs(r,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:e.jsx(y,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(c,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(x,{variant:"outline",children:s.namespace}),e.jsxs(x,{variant:s.healthyPods===s.pods?"default":"destructive",children:[s.healthyPods,"/",s.pods," pods"]})]})]})]})}),e.jsx(n,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.requests&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Requests:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.requests.toLocaleString()})]}),s.errors&&s.errors>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Errors:"}),e.jsx("span",{className:"ml-2 font-semibold text-red-500",children:s.errors})]}),s.latency&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Latency:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[s.latency,"ms"]})]})]})})]},s.id))})})]})}),e.jsx(f,{value:"policies",className:"space-y-4",children:e.jsxs(r,{children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Mesh Policies"}),e.jsx(b,{children:"Traffic, security, and observability policies"})]}),e.jsxs(u,{onClick:q,size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]})}),e.jsx(n,{children:e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsxs(r,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${S(s.type)}/20`,children:e.jsx(P,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx(c,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(x,{variant:"outline",className:S(s.type),children:s.type}),e.jsx(x,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"}),e.jsxs(x,{variant:"outline",children:[s.services.length," services"]})]})]})]}),e.jsx(u,{variant:"ghost",size:"icon",onClick:()=>I(s.id),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(Z,{className:"h-4 w-4"})})]})}),e.jsx(n,{children:s.services.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(i,{className:"text-xs",children:"Applied to Services"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.services.map((d,B)=>e.jsx(x,{variant:"outline",className:"text-xs",children:d},B))})]})})]},s.id))})})]})}),e.jsx(f,{value:"settings",className:"space-y-4",children:e.jsxs(r,{children:[e.jsxs(l,{children:[e.jsx(c,{children:"Service Mesh Settings"}),e.jsx(b,{children:"Mesh configuration"})]}),e.jsxs(n,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable mTLS"}),e.jsx(h,{checked:a.enableMTLS??!0,onCheckedChange:s=>t({enableMTLS:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable Tracing"}),e.jsx(h,{checked:a.enableTracing??!0,onCheckedChange:s=>t({enableTracing:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable Metrics"}),e.jsx(h,{checked:a.enableMetrics??!0,onCheckedChange:s=>t({enableMetrics:s})})]}),e.jsx(g,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Default Load Balancer"}),e.jsxs($,{value:a.defaultLoadBalancer??"ROUND_ROBIN",onValueChange:s=>t({defaultLoadBalancer:s}),children:[e.jsx(G,{children:e.jsx(H,{})}),e.jsxs(J,{children:[e.jsx(v,{value:"ROUND_ROBIN",children:"Round Robin"}),e.jsx(v,{value:"LEAST_CONN",children:"Least Connections"}),e.jsx(v,{value:"RANDOM",children:"Random"})]})]})]}),e.jsx(g,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Enable Metrics Export"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Export Istio metrics for Prometheus scraping"})]}),e.jsx(h,{checked:a.metrics?.enabled??!0,onCheckedChange:s=>t({metrics:{...a.metrics,enabled:s,controlPlanePort:a.metrics?.controlPlanePort||15014,sidecarPort:a.metrics?.sidecarPort||15090,gatewayPort:a.metrics?.gatewayPort||15020}})})]}),a.metrics?.enabled!==!1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Control Plane Metrics Port (istiod)"}),e.jsx(N,{type:"number",value:a.metrics?.controlPlanePort??15014,onChange:s=>t({metrics:{...a.metrics,controlPlanePort:parseInt(s.target.value)||15014,sidecarPort:a.metrics?.sidecarPort||15090,gatewayPort:a.metrics?.gatewayPort||15020}}),min:1024,max:65535}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Istio control plane metrics endpoint: :15014/metrics"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Sidecar Metrics Port (Envoy)"}),e.jsx(N,{type:"number",value:a.metrics?.sidecarPort??15090,onChange:s=>t({metrics:{...a.metrics,sidecarPort:parseInt(s.target.value)||15090,controlPlanePort:a.metrics?.controlPlanePort||15014,gatewayPort:a.metrics?.gatewayPort||15020}}),min:1024,max:65535}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Envoy sidecar metrics endpoint: :15090/stats/prometheus"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Gateway Metrics Port"}),e.jsx(N,{type:"number",value:a.metrics?.gatewayPort??15020,onChange:s=>t({metrics:{...a.metrics,gatewayPort:parseInt(s.target.value)||15020,controlPlanePort:a.metrics?.controlPlanePort||15014,sidecarPort:a.metrics?.sidecarPort||15090}}),min:1024,max:65535}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Istio gateway metrics endpoint: :15020/stats/prometheus"})]})]})]})]})]})})]})]})})}export{se as ServiceMeshConfigAdvanced};

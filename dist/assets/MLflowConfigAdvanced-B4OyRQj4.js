import{E as ce,u as de,j as e,r as p,B as r,S as oe,C as v,e as f,f as N,h as b,k as m,L as c,I as w,t as z,T as xe,a as me,b as y,N as he,d as S,i,P as I,m as T,n as A,o as L,p as P,q as D,s as h,K as je,Y as ue,F as ge}from"./index-DnHhyaNM.js";import{P as F}from"./package-82eBOVnY.js";import{T as pe}from"./trending-up-B84c2ox8.js";const ve=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],$=ce("flask-conical",ve);function Se({componentId:O}){const{nodes:U,updateNode:_}=de(),C=U.find(s=>s.id===O);if(!C)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const d=C.data.config||{},B=d.trackingUri||"http://mlflow:5000",V=d.enableModelRegistry??!0,H=d.enableArtifactStore??!0,q=d.artifactStorePath||"/mlflow/artifacts",o=d.experiments||[],x=d.runs||[],j=d.models||[],u=d.selectedExperiment||o[0]?.name||"",[K,k]=p.useState(!1),[Q,R]=p.useState(!1),[M,Y]=p.useState(""),[fe,Ne]=p.useState(""),[E,G]=p.useState(""),l=s=>{_(O,{data:{...C.data,config:{...d,...s}}})},J=()=>{const s={id:String(o.length+1),name:"new-experiment",runs:0,status:"active"};l({experiments:[...o,s]}),k(!1)},W=s=>{l({experiments:o.filter((t,a)=>a!==s)})},X=()=>{const s={id:`run-${Date.now()}`,name:`run-${new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5)}`,experiment:u||o[0]?.name||"",status:"running",startTime:new Date().toISOString(),metrics:[],parameters:[],tags:{}};l({runs:[...x,s]}),R(!1)},Z=s=>{l({runs:x.filter((t,a)=>a!==s)})},ee=(s,t)=>{const a=x.map(n=>n.id===s?{...n,status:t,endTime:new Date().toISOString()}:n);l({runs:a})},se=s=>{const t=x.find(g=>g.id===s);if(!t)return;const a=t.tags?.model_name||"model",n=j.filter(g=>g.name===a).map(g=>g.version),re=n.length>0?Math.max(...n)+1:1,ie={id:`model-${Date.now()}`,name:a,version:re,stage:"None",runId:s,registeredAt:new Date().toISOString(),tags:t.tags||{}};l({models:[...j,ie]})},ae=s=>{l({models:j.filter((t,a)=>a!==s)})},te=(s,t)=>{const a=[...j];a[s]={...a[s],stage:t},l({models:a})},ne=s=>{switch(s){case"finished":case"active":return e.jsx(r,{variant:"default",className:"bg-green-500",children:"Finished"});case"running":return e.jsx(r,{variant:"default",className:"bg-blue-500",children:"Running"});case"failed":return e.jsx(r,{variant:"destructive",children:"Failed"});case"killed":return e.jsx(r,{variant:"outline",className:"border-orange-500 text-orange-500",children:"Killed"});default:return e.jsx(r,{variant:"secondary",children:"Unknown"})}},le=x.filter(s=>!(u&&s.experiment!==u||E&&!s.name.toLowerCase().includes(E.toLowerCase())));return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx($,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"MLflow"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"ML lifecycle management & experiment tracking"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{variant:"outline",children:"v2.8"}),e.jsxs(r,{variant:"secondary",className:"gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500 animate-pulse"}),"Running"]})]})]}),e.jsx(oe,{}),e.jsxs(v,{children:[e.jsxs(f,{children:[e.jsx(N,{children:"Connection Settings"}),e.jsx(b,{children:"Configure MLflow tracking server"})]}),e.jsxs(m,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Tracking URI"}),e.jsx(w,{value:B,onChange:s=>l({trackingUri:s.target.value}),placeholder:"http://mlflow:5000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Artifact Store Path"}),e.jsx(w,{value:q,onChange:s=>l({artifactStorePath:s.target.value}),placeholder:"/mlflow/artifacts"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{children:"Enable Model Registry"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable model versioning and staging"})]}),e.jsx(z,{checked:V,onCheckedChange:s=>l({enableModelRegistry:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(c,{children:"Enable Artifact Store"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Store model artifacts and files"})]}),e.jsx(z,{checked:H,onCheckedChange:s=>l({enableArtifactStore:s})})]})]})]}),e.jsxs(xe,{defaultValue:"experiments",className:"w-full",children:[e.jsxs(me,{className:"grid w-full grid-cols-4",children:[e.jsxs(y,{value:"experiments",className:"gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"Experiments"]}),e.jsxs(y,{value:"runs",className:"gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),"Runs"]}),e.jsxs(y,{value:"models",className:"gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),"Models"]}),e.jsxs(y,{value:"metrics",className:"gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"Metrics"]})]}),e.jsx(S,{value:"experiments",className:"mt-4 space-y-4",children:e.jsxs(v,{children:[e.jsxs(f,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Experiments"}),e.jsx(b,{children:"Manage ML experiments"})]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>k(!0),children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Create Experiment"]})]}),K&&e.jsx(m,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Experiment Name"}),e.jsx(w,{placeholder:"new-experiment"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{onClick:J,children:"Create Experiment"}),e.jsx(i,{variant:"outline",onClick:()=>k(!1),children:"Cancel"})]})]})}),e.jsx(m,{className:"space-y-3",children:o.map((s,t)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.runs," runs",s.lastRun&&` • Last run: ${s.lastRun}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r,{variant:s.status==="active"?"default":"secondary",children:s.status||"active"}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>W(t),children:e.jsx(T,{className:"h-4 w-4"})})]})]}),s.tags&&Object.keys(s.tags).length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(s.tags).map(([a,n])=>e.jsxs(r,{variant:"outline",className:"text-xs",children:[a,": ",n]},a))})]},t))})]})}),e.jsx(S,{value:"runs",className:"mt-4 space-y-4",children:e.jsxs(v,{children:[e.jsxs(f,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Runs"}),e.jsx(b,{children:"Training runs and their metrics"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(A,{value:u,onValueChange:s=>l({selectedExperiment:s}),children:[e.jsx(L,{className:"w-48",children:e.jsx(P,{placeholder:"All Experiments"})}),e.jsxs(D,{children:[e.jsx(h,{value:"",children:"All Experiments"}),o.map((s,t)=>e.jsx(h,{value:s.name,children:s.name},t))]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(w,{className:"pl-8 w-64",placeholder:"Search runs...",value:E,onChange:s=>G(s.target.value)})]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>R(!0),children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"New Run"]})]})]}),Q&&e.jsx(m,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Experiment"}),e.jsxs(A,{value:u,onValueChange:s=>l({selectedExperiment:s}),children:[e.jsx(L,{children:e.jsx(P,{})}),e.jsx(D,{children:o.map((s,t)=>e.jsx(h,{value:s.name,children:s.name},t))})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{onClick:X,children:"Start Run"}),e.jsx(i,{variant:"outline",onClick:()=>R(!1),children:"Cancel"})]})]})}),e.jsx(m,{className:"space-y-3",children:le.map((s,t)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold font-mono",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.experiment," • Started: ",new Date(s.startTime).toLocaleString(),s.duration&&` • Duration: ${Math.floor(s.duration/60)}m ${s.duration%60}s`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[ne(s.status),s.status==="running"&&e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>ee(s.id,"killed"),children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Stop"]}),e.jsx(i,{variant:"ghost",size:"sm",onClick:()=>Y(M===s.id?"":s.id),children:M===s.id?"Hide":"View"}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>Z(t),children:e.jsx(T,{className:"h-4 w-4"})})]})]}),M===s.id&&e.jsxs("div",{className:"pt-3 border-t space-y-4",children:[s.metrics&&s.metrics.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Metrics"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:s.metrics.map((a,n)=>e.jsxs("div",{className:"p-2 border rounded bg-muted/50",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:a.key}),e.jsx("div",{className:"font-semibold",children:a.value.toFixed(4)}),a.step!==void 0&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Step: ",a.step]})]},n))})]}),s.parameters&&s.parameters.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Parameters"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:s.parameters.map((a,n)=>e.jsxs("div",{className:"p-2 border rounded bg-muted/50",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:a.key}),e.jsx("div",{className:"font-mono text-sm",children:a.value})]},n))})]}),s.tags&&Object.keys(s.tags).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(s.tags).map(([a,n])=>e.jsxs(r,{variant:"outline",className:"text-xs",children:[a,": ",n]},a))})]}),s.artifacts&&s.artifacts.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Artifacts"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.artifacts.map((a,n)=>e.jsxs(r,{variant:"secondary",className:"text-xs",children:[e.jsx(ge,{className:"h-3 w-3 mr-1"}),a]},n))})]}),s.status==="finished"&&V&&e.jsx("div",{className:"pt-2",children:e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>se(s.id),children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Register Model"]})})]})]},t))})]})}),e.jsx(S,{value:"models",className:"mt-4 space-y-4",children:e.jsxs(v,{children:[e.jsxs(f,{children:[e.jsx(N,{children:"Model Registry"}),e.jsx(b,{children:"Registered models and versions"})]}),e.jsx(m,{className:"space-y-3",children:j.map((s,t)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Version ",s.version," • Run: ",s.runId,s.registeredAt&&` • Registered: ${new Date(s.registeredAt).toLocaleDateString()}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(A,{value:s.stage,onValueChange:a=>te(t,a),children:[e.jsx(L,{className:"w-32",children:e.jsx(P,{})}),e.jsxs(D,{children:[e.jsx(h,{value:"None",children:"None"}),e.jsx(h,{value:"Staging",children:"Staging"}),e.jsx(h,{value:"Production",children:"Production"}),e.jsx(h,{value:"Archived",children:"Archived"})]})]}),e.jsx(i,{variant:"ghost",size:"icon",onClick:()=>ae(t),children:e.jsx(T,{className:"h-4 w-4"})})]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),s.tags&&Object.keys(s.tags).length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(s.tags).map(([a,n])=>e.jsxs(r,{variant:"outline",className:"text-xs",children:[a,": ",n]},a))})]},t))})]})}),e.jsx(S,{value:"metrics",className:"mt-4 space-y-4",children:e.jsxs(v,{children:[e.jsxs(f,{children:[e.jsx(N,{children:"Metrics Comparison"}),e.jsx(b,{children:"Compare metrics across runs"})]}),e.jsxs(m,{className:"space-y-4",children:[x.filter(s=>s.metrics&&s.metrics.length>0).map((s,t)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-3",children:[e.jsx("div",{className:"font-semibold font-mono text-sm",children:s.name}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:s.metrics?.map((a,n)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:a.key}),e.jsx("div",{className:"text-2xl font-bold",children:a.value.toFixed(4)}),a.step!==void 0&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Step ",a.step]})]},n))})]},t)),x.filter(s=>s.metrics&&s.metrics.length>0).length===0&&e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No metrics available. Start a run to see metrics."})]})]})})]})]})})}export{Se as MLflowConfigAdvanced};

import{u as H,j as e,r as z,i as g,S as C,C as l,e as n,f as r,k as a,T as U,a as $,b as f,A as V,c as O,d as N,h as b,P as q,B as i,t as j,m as G,a2 as J,L as x,n as K,o as M,p as Q,q as W,s as k,I as X}from"./index-CLbOuOtM.js";import{R as Y}from"./refresh-ccw-DeVSev3u.js";import{S}from"./shield-VlafiO2V.js";import{C as v}from"./circle-check-big-DXE2ihkS.js";import{B as w}from"./ban-CErIqk_N.js";import{T as Z}from"./trending-up-Cp33xcZ7.js";function re({componentId:y}){const{nodes:R,updateNode:T}=H(),u=R.find(s=>s.id===y);if(!u)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const t=u.data.config||{},c=t.rules||[{id:"rule-1",name:"Allow HTTP",action:"allow",protocol:"tcp",destination:"0.0.0.0/0",port:80,enabled:!0,priority:10,hits:12500},{id:"rule-2",name:"Allow HTTPS",action:"allow",protocol:"tcp",destination:"0.0.0.0/0",port:443,enabled:!0,priority:10,hits:9800},{id:"rule-3",name:"Block SSH from External",action:"deny",protocol:"tcp",source:"0.0.0.0/0",destination:"10.0.0.0/8",port:22,enabled:!0,priority:5,hits:45},{id:"rule-4",name:"Default Deny",action:"deny",protocol:"all",enabled:!0,priority:1,hits:125}],m=t.logs||[{id:"log-1",timestamp:new Date(Date.now()-36e5).toISOString(),action:"blocked",source:"192.168.1.100",destination:"10.0.0.5",protocol:"tcp",port:22,reason:"SSH blocked from external"},{id:"log-2",timestamp:new Date(Date.now()-18e5).toISOString(),action:"allowed",source:"10.0.0.10",destination:"10.0.0.5",protocol:"tcp",port:80}],D=t.totalRules||c.length,A=t.activeRules||c.filter(s=>s.enabled).length,L=t.blockedConnections||m.filter(s=>s.action==="blocked"||s.action==="rejected").length,P=t.allowedConnections||m.filter(s=>s.action==="allowed").length,[_,F]=z.useState(!1),d=s=>{T(y,{data:{...u.data,config:{...t,...s}}})},B=()=>{const s={id:`rule-${Date.now()}`,name:"New Rule",action:"allow",protocol:"tcp",enabled:!0,priority:5};d({rules:[...c,s]}),F(!1)},I=s=>{d({rules:c.filter(o=>o.id!==s)})},E=s=>{const o=c.map(h=>h.id===s?{...h,enabled:!h.enabled}:h);d({rules:o})},p=s=>{switch(s){case"allow":return"bg-green-500";case"deny":case"blocked":return"bg-red-500";case"reject":case"rejected":return"bg-orange-500";default:return"bg-gray-500"}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Firewall"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Network Firewall"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Network security and traffic filtering"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(g,{variant:"outline",size:"sm",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(C,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(l,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(n,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{className:"text-sm font-medium text-muted-foreground",children:"Rules"}),e.jsx(S,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(a,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:A}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/ ",D," total"]})]})})]}),e.jsxs(l,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(n,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{className:"text-sm font-medium text-muted-foreground",children:"Allowed"}),e.jsx(v,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(a,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:P}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"connections"})]})})]}),e.jsxs(l,{className:"border-l-4 border-l-red-500 bg-card",children:[e.jsx(n,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{className:"text-sm font-medium text-muted-foreground",children:"Blocked"}),e.jsx(w,{className:"h-4 w-4 text-red-500"})]})}),e.jsx(a,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:L}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"connections"})]})})]}),e.jsxs(l,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(n,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{className:"text-sm font-medium text-muted-foreground",children:"Total Hits"}),e.jsx(Z,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(a,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:c.reduce((s,o)=>s+(o.hits||0),0).toLocaleString()})})})]})]}),e.jsxs(U,{defaultValue:"rules",className:"space-y-4",children:[e.jsxs($,{children:[e.jsxs(f,{value:"rules",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Rules (",c.length,")"]}),e.jsxs(f,{value:"logs",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Logs (",m.length,")"]}),e.jsxs(f,{value:"settings",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(N,{value:"rules",className:"space-y-4",children:e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Firewall Rules"}),e.jsx(b,{children:"Network traffic filtering rules"})]}),e.jsxs(g,{onClick:B,size:"sm",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Create Rule"]})]})}),e.jsx(a,{children:e.jsx("div",{className:"space-y-4",children:c.map(s=>e.jsxs(l,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(n,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${p(s.action)}/20`,children:s.action==="allow"?e.jsx(v,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(w,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(r,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(i,{variant:"outline",className:p(s.action),children:s.action.toUpperCase()}),e.jsx(i,{variant:"outline",children:s.protocol.toUpperCase()}),s.port&&e.jsxs(i,{variant:"outline",children:["Port: ",s.port]}),e.jsxs(i,{variant:"outline",children:["Priority: ",s.priority]}),s.hits&&e.jsxs(i,{variant:"outline",className:"bg-purple-50 dark:bg-purple-950/20 text-purple-700 dark:text-purple-300",children:[s.hits," hits"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{checked:s.enabled,onCheckedChange:()=>E(s.id)}),e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>I(s.id),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(G,{className:"h-4 w-4"})})]})]})}),e.jsx(a,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.source&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Source:"}),e.jsx("span",{className:"ml-2 font-mono font-semibold",children:s.source})]}),s.destination&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Destination:"}),e.jsx("span",{className:"ml-2 font-mono font-semibold",children:s.destination})]})]})})]},s.id))})})]})}),e.jsx(N,{value:"logs",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(n,{children:[e.jsx(r,{children:"Firewall Logs"}),e.jsx(b,{children:"Traffic filtering activity logs"})]}),e.jsx(a,{children:e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsxs(l,{className:`border-l-4 ${s.action==="allowed"?"border-l-green-500 bg-card":"border-l-red-500 bg-card"} hover:shadow-md transition-shadow`,children:[e.jsx(n,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${p(s.action)}/20`,children:s.action==="allowed"?e.jsx(v,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(w,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(r,{className:"text-lg font-semibold capitalize",children:s.action}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(i,{variant:"outline",className:"font-mono text-xs",children:s.source}),e.jsx("span",{children:"â†’"}),e.jsx(i,{variant:"outline",className:"font-mono text-xs",children:s.destination}),e.jsx(i,{variant:"outline",children:s.protocol.toUpperCase()}),s.port&&e.jsxs(i,{variant:"outline",children:["Port: ",s.port]})]})]})]})}),s.reason&&e.jsx(a,{children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx(J,{className:"h-4 w-4 inline mr-1"}),s.reason]})}),e.jsx(a,{children:e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(s.timestamp).toLocaleString()})})]},s.id))})})]})}),e.jsx(N,{value:"settings",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(n,{children:[e.jsx(r,{children:"Firewall Settings"}),e.jsx(b,{children:"Security configuration"})]}),e.jsxs(a,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{children:"Enable Firewall"}),e.jsx(j,{checked:t.enableFirewall??!0,onCheckedChange:s=>d({enableFirewall:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{children:"Enable Logging"}),e.jsx(j,{checked:t.enableLogging??!0,onCheckedChange:s=>d({enableLogging:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{children:"Enable Intrusion Detection"}),e.jsx(j,{checked:t.enableIntrusionDetection??!1,onCheckedChange:s=>d({enableIntrusionDetection:s})})]}),e.jsx(C,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Default Policy"}),e.jsxs(K,{value:t.defaultPolicy??"deny",onValueChange:s=>d({defaultPolicy:s}),children:[e.jsx(M,{children:e.jsx(Q,{})}),e.jsxs(W,{children:[e.jsx(k,{value:"allow",children:"Allow All"}),e.jsx(k,{value:"deny",children:"Deny All"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Log Retention (days)"}),e.jsx(X,{type:"number",value:t.logRetention??30,onChange:s=>d({logRetention:parseInt(s.target.value)||30}),min:1})]})]})]})})]})]})})}export{re as FirewallConfigAdvanced};

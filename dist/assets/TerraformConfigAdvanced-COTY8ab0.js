import{u as J,j as e,r as D,i as f,S as V,C as t,e as l,f as n,W as C,k as r,A as S,F as R,T as K,a as Q,b as N,N as I,c as Y,d as v,h as b,P as Z,B as i,X as A,m as _,L as d,I as L,n as O,o as E,p as P,q as z,s as m,t as T}from"./index-B7PftTIS.js";import{T as ee}from"./textarea-DE-qElDS.js";import{R as se}from"./refresh-ccw-DqCUVkkK.js";import{C as y}from"./circle-check-big-CPaBHWOP.js";import{C as ae}from"./cloud-AHyZ57wo.js";import{C as te}from"./clock-hDKlFJVm.js";function ue({componentId:W}){const{nodes:B,updateNode:$}=J(),w=B.find(s=>s.id===W);if(!w)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const x=w.data.config||{},c=x.workspaces||[{id:"1",name:"production",description:"Production infrastructure",terraformVersion:"1.5.0",autoApply:!1,queueAllRuns:!0,workingDirectory:"/terraform",lastRun:{id:"run-1",status:"applied",createdAt:new Date().toISOString()}}],o=x.runs||[{id:"1",workspace:"production",status:"applied",createdAt:new Date().toISOString(),planOnly:!1,message:"Apply completed successfully",duration:120}],j=x.states||[{id:"1",workspace:"production",version:1,serial:1,resources:15,updatedAt:new Date().toISOString()}],q=x.totalWorkspaces||c.length,M=x.activeRuns||o.filter(s=>["pending","planning","applying"].includes(s.status)).length,F=x.completedRuns||o.filter(s=>s.status==="applied").length,[re,le]=D.useState(null),[ne,X]=D.useState(!1),p=s=>{$(W,{data:{...w.data,config:{...x,...s}}})},G=()=>{const s={id:`workspace-${Date.now()}`,name:"new-workspace",terraformVersion:"1.5.0",autoApply:!1,queueAllRuns:!0};p({workspaces:[...c,s]}),X(!1)},H=s=>{p({workspaces:c.filter(a=>a.id!==s)})},u=(s,a,g)=>{const k=c.map(h=>h.id===s?{...h,[a]:g}:h);p({workspaces:k})},U=(s,a=!1)=>{const g=c.find(h=>h.id===s);if(!g)return;const k={id:`run-${Date.now()}`,workspace:g.name,status:"pending",createdAt:new Date().toISOString(),planOnly:a};p({runs:[k,...o.slice(0,9)]})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Terraform"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Infrastructure as Code"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage workspaces, runs, and state"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(f,{variant:"outline",size:"sm",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(V,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(t,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Workspaces"}),e.jsx(C,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:q}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"active"})]})})]}),e.jsxs(t,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Active Runs"}),e.jsx(S,{className:"h-4 w-4 text-cyan-500 animate-pulse"})]})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-cyan-600 dark:text-cyan-400",children:M}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"running"})]})})]}),e.jsxs(t,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Completed"}),e.jsx(y,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:F}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"success"})]})})]}),e.jsxs(t,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"State Versions"}),e.jsx(R,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:j.length}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"versions"})]})})]})]}),e.jsxs(K,{defaultValue:"workspaces",className:"space-y-4",children:[e.jsxs(Q,{children:[e.jsxs(N,{value:"workspaces",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Workspaces (",c.length,")"]}),e.jsxs(N,{value:"runs",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Runs (",o.length,")"]}),e.jsxs(N,{value:"state",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"State (",j.length,")"]}),e.jsxs(N,{value:"settings",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(v,{value:"workspaces",className:"space-y-4",children:e.jsxs(t,{children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Workspaces"}),e.jsx(b,{children:"Manage Terraform workspaces"})]}),e.jsxs(f,{onClick:G,size:"sm",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Create Workspace"]})]})}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:c.map(s=>e.jsxs(t,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:e.jsx(C,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(n,{className:"text-lg font-semibold",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs(i,{variant:"outline",className:"font-mono text-xs",children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"v",s.terraformVersion||"1.5.0"]}),s.autoApply&&e.jsxs(i,{variant:"default",className:"bg-green-500",children:[e.jsx(y,{className:"h-3 w-3 mr-1"}),"Auto Apply"]}),s.lastRun&&e.jsxs(i,{variant:s.lastRun.status==="applied"?"default":s.lastRun.status==="errored"?"destructive":"secondary",children:[s.lastRun.status==="applied"&&e.jsx(y,{className:"h-3 w-3 mr-1"}),s.lastRun.status==="errored"&&e.jsx(A,{className:"h-3 w-3 mr-1"}),s.lastRun.status]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(f,{size:"sm",variant:"default",onClick:()=>U(s.id,!1),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Run Plan"]}),e.jsx(f,{variant:"ghost",size:"icon",onClick:()=>H(s.id),disabled:c.length===1,className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(_,{className:"h-4 w-4"})})]})]})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Workspace Name"}),e.jsx(L,{value:s.name,onChange:a=>u(s.id,"name",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Terraform Version"}),e.jsxs(O,{value:s.terraformVersion||"1.5.0",onValueChange:a=>u(s.id,"terraformVersion",a),children:[e.jsx(E,{children:e.jsx(P,{})}),e.jsxs(z,{children:[e.jsx(m,{value:"1.5.0",children:"1.5.0"}),e.jsx(m,{value:"1.4.0",children:"1.4.0"}),e.jsx(m,{value:"1.3.0",children:"1.3.0"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Working Directory"}),e.jsx(L,{value:s.workingDirectory||"",onChange:a=>u(s.id,"workingDirectory",a.target.value),placeholder:"/terraform"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{children:"Auto Apply"}),e.jsx(T,{checked:s.autoApply??!1,onCheckedChange:a=>u(s.id,"autoApply",a)})]})]}),s.description&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Description"}),e.jsx(ee,{value:s.description,onChange:a=>u(s.id,"description",a.target.value),rows:2})]})]})]},s.id))})})]})}),e.jsx(v,{value:"runs",className:"space-y-4",children:e.jsxs(t,{children:[e.jsxs(l,{children:[e.jsx(n,{children:"Terraform Runs"}),e.jsx(b,{children:"Execution history and status"})]}),e.jsx(r,{children:o.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No runs executed"}):e.jsx("div",{className:"space-y-2",children:o.map(s=>e.jsx(t,{className:`border-l-4 hover:shadow-md transition-all ${s.status==="applied"?"border-l-green-500 bg-card":s.status==="errored"?"border-l-red-500 bg-card":s.status==="canceled"?"border-l-gray-500 bg-card":["pending","planning","applying"].includes(s.status)?"border-l-blue-500 bg-card":"border-l-yellow-500 bg-card"}`,children:e.jsx(r,{className:"pt-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs("div",{className:`p-2 rounded-lg ${s.status==="applied"?"bg-green-100 dark:bg-green-900/30":s.status==="errored"?"bg-red-100 dark:bg-red-900/30":["pending","planning","applying"].includes(s.status)?"bg-blue-100 dark:bg-blue-900/30":"bg-gray-100 dark:bg-gray-900/30"}`,children:[s.status==="applied"&&e.jsx(y,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),s.status==="errored"&&e.jsx(A,{className:"h-5 w-5 text-red-600 dark:text-red-400"}),["pending","planning","applying"].includes(s.status)&&e.jsx(S,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 animate-pulse"}),s.status==="canceled"&&e.jsx(A,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(i,{variant:s.status==="applied"?"default":s.status==="errored"?"destructive":s.status==="canceled"?"outline":"secondary",className:"font-medium",children:s.status}),s.planOnly&&e.jsxs(i,{variant:"outline",className:"text-xs",children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),"Plan Only"]}),e.jsx("span",{className:"font-semibold text-base",children:s.workspace})]}),s.message&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.message}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(te,{className:"h-3 w-3"}),new Date(s.createdAt).toLocaleString()]}),s.duration&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(S,{className:"h-3 w-3"}),s.duration,"s"]})]})]})]})})},s.id))})})]})}),e.jsx(v,{value:"state",className:"space-y-4",children:e.jsxs(t,{children:[e.jsxs(l,{children:[e.jsx(n,{children:"State Management"}),e.jsx(b,{children:"Terraform state versions"})]}),e.jsx(r,{children:j.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No state versions"}):e.jsx("div",{className:"space-y-2",children:j.map(s=>e.jsx(t,{className:"border-l-4 border-l-purple-500",children:e.jsx(r,{className:"pt-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(i,{variant:"outline",children:s.workspace}),e.jsxs(i,{variant:"outline",children:["v",s.version]}),e.jsxs(i,{variant:"outline",children:["Serial: ",s.serial]}),s.resources&&e.jsxs(i,{variant:"outline",children:[s.resources," resources"]})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsxs("p",{children:["Updated: ",new Date(s.updatedAt).toLocaleString()]})})]})})})},s.id))})})]})}),e.jsx(v,{value:"settings",className:"space-y-4",children:e.jsxs(t,{children:[e.jsxs(l,{children:[e.jsx(n,{children:"Terraform Settings"}),e.jsx(b,{children:"Global configuration"})]}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Default Terraform Version"}),e.jsxs(O,{defaultValue:"1.5.0",children:[e.jsx(E,{children:e.jsx(P,{})}),e.jsxs(z,{children:[e.jsx(m,{value:"1.5.0",children:"1.5.0"}),e.jsx(m,{value:"1.4.0",children:"1.4.0"}),e.jsx(m,{value:"1.3.0",children:"1.3.0"})]})]})]}),e.jsx(V,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{children:"Enable State Locking"}),e.jsx(T,{defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{children:"Enable Remote State"}),e.jsx(T,{defaultChecked:!0})]})]})]})})]})]})})}export{ue as TerraformConfigAdvanced};

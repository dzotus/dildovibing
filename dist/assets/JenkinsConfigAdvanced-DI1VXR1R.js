import{J as Xs,u as Qs,a as Ys,j as e,e as Zs,r as c,A as Le,B as D,S as Ne,C as g,h as N,i as b,m as v,T as us,b as xs,c as E,d as Ws,f as S,k,l as u,P as L,R as en,X as ms,F as sn,o as z,x as T,q as H,s as G,t as X,v as Q,w as y,O as nn,I as p,_ as hs,Q as tn,L as d,ai as js,D as Y,y as Z,z as W,E as ee,G as se,n as be,H as ye,ac as an,aa as ln}from"./index-BuyG2OvL.js";import{P as ne}from"./progress-CinqCQMz.js";import{T as ze}from"./textarea-DCb6isO5.js";import{u as rn}from"./use-toast-DkA2djVK.js";import{G as Ue}from"./git-branch-BQQCuQIJ.js";import{P as we}from"./package-BQpaFEtY.js";import{S as Oe}from"./server-D7EKggyl.js";import{U as gs}from"./users-DPMZoLaQ.js";import{C as cn}from"./chart-column-C7GlUvFy.js";import{T as dn}from"./trending-up-BjWzvdhC.js";import{R as Je,C as Me,X as _e,Y as Ke,T as qe,P as He,L as on,a as un,O as xn}from"./LineChart-CtpTf41T.js";import{A as mn,a as Ge}from"./AreaChart-DYxIT51i.js";import{C as ps}from"./clock-DO5TwdGO.js";import{B as hn}from"./BarChart-CBzQB2M6.js";import{L as jn}from"./loader-circle-CuU0hW7t.js";const gn=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],pn=Xs("history",gn);function $n({componentId:te}){const{nodes:fs,updateNode:vs}=Qs(),{isRunning:ie,getComponentMetrics:Ns}=Ys(),{toast:j}=rn(),U=fs.find(s=>s.id===te);if(!U)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const r=Zs.getJenkinsEmulationEngine(te),Xe=Ns(te),[Qe,bs]=c.useState([]),[Ce,ys]=c.useState([]),[R,ws]=c.useState([]),[Ye,Cs]=c.useState([]),[ae,Ze]=c.useState([]),[l,Bs]=c.useState(null),[Be,Pe]=c.useState(null),[O,Ps]=c.useState(""),[le,ks]=c.useState("all"),[re,ce]=c.useState(null),[Es,de]=c.useState(!1),[oe,ke]=c.useState(""),[ue,Ee]=c.useState(1),[We,Se]=c.useState(""),[es,Ae]=c.useState(""),[Ss,xe]=c.useState(!1),[De,J]=c.useState(""),[fn,vn]=c.useState(null),[F,ss]=c.useState(null),[As,Fe]=c.useState(!1),[ns,ts]=c.useState([]),[is,as]=c.useState([]),[Te,ls]=c.useState([]),[Nn,bn]=c.useState(null);c.useEffect(()=>{if(!R.length){ls([]);return}const s=Date.now(),n=6e4,t=20,i=[];for(let a=t-1;a>=0;a--){const o=s-(a+1)*n,h=s-a*n,C=R.filter(f=>{const x=f.startTime||(f.duration?s-f.duration:s);return x>=o&&x<h});if(C.length>0){const f=C.filter($=>$.status==="success").length,x=C.filter($=>$.status==="failed").length,I=C.filter($=>$.duration!==void 0),q=I.length>0?I.reduce(($,Gs)=>$+(Gs.duration||0),0)/I.length/1e3:0;i.push({time:new Date(h).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),builds:C.length,success:f,failed:x,duration:q})}else i.push({time:new Date(h).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),builds:0,success:0,failed:0,duration:0})}ls(i)},[R]);const[me,M]=c.useState(""),[he,_]=c.useState(""),[Ve,K]=c.useState(""),[je,A]=c.useState("");c.useEffect(()=>{if(!r)return;const s=()=>{try{const t=r.getPipelines(),i=r.getActiveBuilds(),a=r.getAllBuilds(),o=r.getNodes(),h=r.getPlugins(),C=r.getJenkinsMetrics();if(bs(f=>JSON.stringify(f)!==JSON.stringify(t)?t:f),ys(f=>JSON.stringify(f)!==JSON.stringify(i)?i:f),ws(f=>{if(f.length!==a.length)return a;const x=f.filter(q=>q.status==="running").length,I=a.filter(q=>q.status==="running").length;return x!==I?a:f}),Cs(o),Ze(h),Bs(C),F){const f=a.find(x=>x.id===F);if(f&&(f.status==="running"||f.logs)){const x=r.getBuildLogs(F),I=r.getBuildArtifacts(F);x&&ts(x),I&&as(I)}}}catch(t){console.error("Error updating Jenkins data:",t)}};s();const n=setInterval(s,ie?500:2e3);return()=>clearInterval(n)},[r,ie,F]);const Ds=s=>{if(ss(s),Fe(!0),r){const n=r.getBuildLogs(s),t=r.getBuildArtifacts(s);n&&ts(n),t&&as(t)}},rs=s=>{if(!r){j({title:"Error",description:"Jenkins engine not available",variant:"destructive"});return}const n=R.find(t=>t.id===s);if(!n){j({title:"Error",description:"Build not found",variant:"destructive"});return}if(n.status!=="running"&&n.status!=="pending"){j({title:"Cannot cancel build",description:`Build is already ${n.status}`,variant:"destructive"});return}try{const t=r.cancelBuild(s);t.success?(j({title:"Build cancelled",description:`Build #${n.number} has been cancelled successfully`}),F===s&&(Fe(!1),ss(null))):j({title:"Cannot cancel build",description:t.reason||"Unknown error",variant:"destructive"})}catch(t){console.error("Error cancelling build:",t),j({title:"Error",description:"Failed to cancel build",variant:"destructive"})}},cs=s=>s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(2)} KB`:`${(s/(1024*1024)).toFixed(2)} MB`,B=U.data.config||{},Fs=B.jenkinsUrl||"http://jenkins:8080",Ts=B.enableCSRF??!0,ge=B.executorCount||2;B.enablePlugins;const ds=B.plugins||["git","docker","kubernetes"],Vs=B.enablePipeline??!0,Is=B.enableBlueOcean??!1,os=B.enableArtifactArchiving??!0,Rs=B.retentionDays||30,P=Qe.length>0?Qe.map(s=>({id:s.id,name:s.name,status:s.status,lastBuild:s.lastBuild,duration:s.duration,branch:s.branch})):B.pipelines||[],w=s=>{if(s.jenkinsUrl!==void 0)try{new URL(s.jenkinsUrl)}catch{j({title:"Invalid URL",description:"Please enter a valid Jenkins URL",variant:"destructive"});return}if(s.executorCount!==void 0){if(s.executorCount<1||s.executorCount>100){j({title:"Invalid executor count",description:"Executor count must be between 1 and 100",variant:"destructive"});return}if(r){const t=r.canUpdateExecutorCount(s.executorCount);if(!t.can){j({title:"Cannot update executors",description:t.reason||"Cannot update executor count",variant:"destructive"});return}}}if(s.retentionDays!==void 0&&(s.retentionDays<1||s.retentionDays>365)){j({title:"Invalid retention days",description:"Retention days must be between 1 and 365",variant:"destructive"});return}const n={...B,...s};if(vs(te,{data:{...U.data,config:n}}),r)try{r.updateConfig({...U,data:{...U.data,config:n}})}catch(t){console.error("Failed to update Jenkins engine config:",t)}j({title:"Configuration updated",description:"Jenkins configuration has been saved"})},Ie=(s,n)=>s.trim()?s.trim().length<2?"Pipeline name must be at least 2 characters":s.trim().length>100?"Pipeline name must be less than 100 characters":/^[a-zA-Z0-9_-]+$/.test(s.trim())?P.some(t=>t.name===s.trim()&&t.id!==n)?"A pipeline with this name already exists":"":"Pipeline name can only contain letters, numbers, hyphens and underscores":"Pipeline name is required",$s=()=>{const s=`pipeline-${Date.now().toString().slice(-6)}`,t={id:String(Date.now()),name:s,lastBuild:0,branch:"main",enabled:!0};w({pipelines:[...P,t]}),j({title:"Pipeline created",description:`Pipeline "${s}" has been created. It will be initialized in emulation.`})},Ls=s=>{const n=P.find(a=>a.id===s);if(!n)return;const t=String(Date.now()),i={...n,id:t,name:`${n.name}-copy`,lastBuild:0};w({pipelines:[...P,i]}),j({title:"Pipeline duplicated",description:`Pipeline "${n.name}" has been duplicated as "${i.name}".`})},V=B.nodes||[],Re=s=>s.trim()?s.trim().length<2?"Node name must be at least 2 characters":s.trim().length>100?"Node name must be less than 100 characters":/^[a-zA-Z0-9_-]+$/.test(s.trim())?V.some(n=>n.name===s.trim())?"A node with this name already exists":"":"Node name can only contain letters, numbers, hyphens and underscores":"Node name is required",$e=s=>s<1?"Must have at least 1 executor":s>100?"Cannot have more than 100 executors":"",zs=()=>{const s=Re(oe),n=$e(ue);if(M(s),_(n),s||n)return;const t={id:String(Date.now()),name:oe.trim(),numExecutors:ue,labels:We.split(",").map(i=>i.trim()).filter(i=>i.length>0),description:es.trim()||void 0};w({nodes:[...V,t]}),ke(""),Ee(1),Se(""),Ae(""),M(""),_(""),de(!1)},Us=s=>{ce(s)},Os=(s,n)=>{const t=V.map(i=>i.id===s?{...i,...n}:i);w({nodes:t}),ce(null)},Js=s=>{V.find(t=>t.id===s)&&w({nodes:V.filter(t=>t.id!==s)})},Ms=s=>{Pe(s)},m=(s,n)=>{if(n.name!==void 0){const t=Ie(n.name,s);if(t){K(t),j({title:"Validation error",description:t,variant:"destructive"});return}K("")}try{const t=P.map(i=>i.id===s?{...i,...n}:i);if(w({pipelines:t}),r&&(n.enabled!==void 0&&r.setPipelineEnabled(s,n.enabled!==!1),n.triggers!==void 0||n.parameters!==void 0||n.environmentVariables!==void 0||n.postBuildActions!==void 0)){const i=t.find(a=>a.id===s);i&&r.updatePipelineConfig(s,{triggers:i.triggers||[],parameters:i.parameters||[],environmentVariables:i.environmentVariables||{},postBuildActions:i.postBuildActions||[]})}(n.name!==void 0||n.branch!==void 0||n.enabled!==void 0)&&j({title:"Pipeline updated",description:"Pipeline configuration has been saved."})}catch(t){console.error("Error saving pipeline:",t),j({title:"Error",description:"Failed to save pipeline configuration.",variant:"destructive"})}},_s=s=>{const n=P.find(i=>i.id===s);if(!n)return;if(r&&Ce.some(i=>i.pipelineId===s&&i.status==="running")){j({title:"Cannot delete pipeline",description:"Pipeline has active builds. Please wait for builds to complete or cancel them first.",variant:"destructive"});return}w({pipelines:P.filter(i=>i.id!==s)}),j({title:"Pipeline deleted",description:`Pipeline "${n.name}" has been deleted.`})},pe=s=>s.trim()?s.trim().length<2?"Plugin name must be at least 2 characters":s.trim().length>100?"Plugin name must be less than 100 characters":/^[a-zA-Z0-9_-]+$/.test(s.trim())?(B.plugins||[]).some(t=>(typeof t=="string"?t:t.name)===s.trim())?"This plugin is already installed":"":"Plugin name can only contain letters, numbers, hyphens and underscores":"Plugin name is required",Ks=s=>{const n=s.trim();if(!n){A("Plugin name is required");return}const t=pe(n);if(t){A(t);return}if(r){if(!r.addPlugin(n)){A("This plugin is already installed");return}const a=B.plugins||[];w({plugins:[...a,n]})}else{const i=B.plugins||[];if(i.some(a=>(typeof a=="string"?a:a.name)===n)){A("This plugin is already installed");return}w({plugins:[...i,n]})}J(""),A(""),xe(!1),j({title:"Plugin installed",description:`Plugin "${n}" has been installed`})},qs=s=>{if(r){const t=r.removePlugin(s);if(!t.success){j({title:"Cannot remove plugin",description:t.reason||"Cannot remove plugin",variant:"destructive"});return}}const n=B.plugins||[];w({plugins:n.filter(t=>(typeof t=="string"?t:t.name)!==s)})},Hs=(s,n)=>{r&&(r.setPluginEnabled(s,n),Ze(r.getPlugins()));const i=(B.plugins||[]).map(a=>typeof a=="string"?a===s?{name:a,enabled:n}:a:a.name===s?{...a,enabled:n}:a);w({plugins:i}),j({title:n?"Plugin enabled":"Plugin disabled",description:`Plugin "${s}" has been ${n?"enabled":"disabled"}`})},fe=s=>{switch(s){case"success":return e.jsx(js,{className:"h-4 w-4 text-green-500"});case"running":return e.jsx(jn,{className:"h-4 w-4 text-blue-500 animate-spin"});case"failed":return e.jsx(ln,{className:"h-4 w-4 text-red-500"});default:return e.jsx(ps,{className:"h-4 w-4 text-muted-foreground"})}},ve=(s,n)=>{if(n===0)return e.jsx(D,{variant:"outline",children:"Never built"});switch(s){case"success":return e.jsx(D,{variant:"default",className:"bg-green-500",children:"Success"});case"running":return e.jsx(D,{variant:"default",className:"bg-blue-500",children:"Running"});case"failed":return e.jsx(D,{variant:"destructive",children:"Failed"});default:return e.jsx(D,{variant:"secondary",children:"Pending"})}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-red-500/10",children:e.jsx(Le,{className:"h-6 w-6 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Jenkins"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Continuous Integration & Delivery"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{variant:"outline",className:"gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${ie?"bg-green-500 animate-pulse":"bg-gray-500"}`}),ie?"Running":"Stopped"]}),Xe&&e.jsxs(D,{variant:"outline",className:"gap-1",children:[e.jsx(Le,{className:"h-3 w-3"}),Xe.throughput?.toFixed(2)||0," req/s"]})]})]}),e.jsx(Ne,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(g,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:"Pipelines"})}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l?.pipelinesTotal||P.length}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[l?.pipelinesEnabled||P.length," enabled"]})]})]}),e.jsxs(g,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:"Executors"})}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l?`${l.executorBusy}/${l.executorBusy+l.executorIdle}`:ge}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l?`${l.executorUtilization.toFixed(1)}% utilized`:"Available"})]})]}),e.jsxs(g,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:"Builds"})}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l?.buildsRunning||Ce.length||0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l?`${l.buildsPerMinute.toFixed(1)}/min`:"Running"})]})]}),e.jsxs(g,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(b,{className:"text-sm font-medium text-muted-foreground",children:"Success Rate"})}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l&&l.buildsSuccess+l.buildsFailed>0?`${(l.buildsSuccess/(l.buildsSuccess+l.buildsFailed)*100).toFixed(1)}%`:(l&&l.buildsTotal>0,"—")}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:l?l.buildsSuccess+l.buildsFailed>0?`${l.buildsSuccess} success, ${l.buildsFailed} failed`:l.buildsTotal>0||l.buildsRunning>0?`${l.buildsRunning} running, ${l.buildsPending} pending`:"No builds yet":"No metrics"})]})]})]}),e.jsxs(us,{defaultValue:"pipelines",className:"w-full",children:[e.jsxs(xs,{className:"grid w-full grid-cols-7",children:[e.jsxs(E,{value:"pipelines",className:"gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Pipelines"]}),e.jsxs(E,{value:"builds",className:"gap-2",children:[e.jsx(pn,{className:"h-4 w-4"}),"Builds"]}),e.jsxs(E,{value:"plugins",className:"gap-2",children:[e.jsx(we,{className:"h-4 w-4"}),"Plugins"]}),e.jsxs(E,{value:"nodes",className:"gap-2",children:[e.jsx(Oe,{className:"h-4 w-4"}),"Nodes"]}),e.jsxs(E,{value:"executors",className:"gap-2",children:[e.jsx(gs,{className:"h-4 w-4"}),"Executors"]}),e.jsxs(E,{value:"settings",className:"gap-2",children:[e.jsx(Ws,{className:"h-4 w-4"}),"Settings"]}),e.jsxs(E,{value:"metrics",className:"gap-2",children:[e.jsx(cn,{className:"h-4 w-4"}),"Metrics"]})]}),e.jsx(S,{value:"pipelines",className:"space-y-4 mt-4",children:e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(b,{children:"Pipelines"}),e.jsx(k,{children:"CI/CD pipeline configuration and monitoring"})]}),e.jsxs(u,{size:"sm",onClick:$s,variant:"outline",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"New Pipeline"]})]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-3",children:P.map(s=>e.jsxs(g,{className:"border-border",children:[e.jsx(N,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[fe(s.status),e.jsxs("div",{className:"flex-1",children:[e.jsx(b,{className:"text-lg",children:s.name}),e.jsxs(k,{className:"text-xs mt-1 flex items-center gap-2",children:[e.jsx(Ue,{className:"h-3 w-3"}),s.branch||"main"," • Build #",s.lastBuild,s.duration&&` • ${s.duration}s`]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[ve(s.status,s.lastBuild),r&&e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>{const n=r.triggerBuildManually(s.id);n.success?j({title:"Build triggered",description:`Build #${n.buildId} started for ${s.name}`}):j({title:"Cannot trigger build",description:n.reason||"Unknown error",variant:"destructive"})},disabled:!s.enabled||s.status==="running",children:[e.jsx(en,{className:"h-4 w-4 mr-1"}),"Build Now"]}),e.jsx(u,{size:"icon",variant:"ghost",onClick:()=>Ms(s.id),title:"Edit pipeline",children:e.jsx(ms,{className:"h-4 w-4"})}),e.jsx(u,{size:"icon",variant:"ghost",onClick:()=>Ls(s.id),title:"Duplicate pipeline",children:e.jsx(sn,{className:"h-4 w-4"})}),P.length>1&&e.jsx(u,{size:"icon",variant:"ghost",onClick:()=>_s(s.id),title:"Delete pipeline",children:e.jsx(z,{className:"h-4 w-4"})})]})]})}),s.status==="running"&&e.jsx(v,{children:e.jsx("div",{className:"space-y-2",children:(()=>{const t=Ce.find(i=>i.pipelineId===s.id)?.progress||0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progress"}),e.jsxs("span",{children:[t,"%"]})]}),e.jsx(ne,{value:t,className:"h-2"})]})})()})})]},s.id))})})]})}),e.jsx(S,{value:"plugins",className:"space-y-4 mt-4",children:e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(b,{children:"Plugins"}),e.jsx(k,{children:"Installed Jenkins plugins"})]}),e.jsxs(u,{size:"sm",onClick:()=>xe(!0),variant:"outline",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Install Plugin"]})]})}),e.jsx(v,{children:ae.length===0&&ds.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(we,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No plugins installed"})]}):e.jsx("div",{className:"space-y-2",children:(ae.length>0?ae:ds.map(n=>typeof n=="string"?{name:n,version:"1.0.0",enabled:!0,active:!0}:{name:n.name||(typeof n=="object"&&n!==null?String(n):"unknown"),version:n.version||"1.0.0",enabled:n.enabled!==!1,active:n.active!==!1,description:n.description})).map(n=>{const t=n.name,i=n.version||"1.0.0",a=n.enabled!==!1,o=ae.length>0?n.active!==!1&&a:a,h=n.description;return e.jsxs("div",{className:"flex items-center gap-3 p-3 border border-border rounded-lg bg-card",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(we,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:t}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[h||"Plugin installed"," • v",i]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{checked:a,onCheckedChange:C=>Hs(t,C)}),e.jsx(D,{variant:o?"default":"secondary",children:o?"Active":"Inactive"}),e.jsx(u,{size:"icon",variant:"ghost",onClick:()=>qs(t),children:e.jsx(z,{className:"h-4 w-4"})})]})]},t)})})})]})}),e.jsx(S,{value:"builds",className:"space-y-4 mt-4",children:e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(b,{children:"Builds"}),e.jsx(k,{children:"Build history and active builds"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(H,{value:le,onValueChange:s=>ks(s),children:[e.jsx(G,{className:"w-32",children:e.jsx(X,{})}),e.jsxs(Q,{children:[e.jsx(y,{value:"all",children:"All"}),e.jsx(y,{value:"active",children:"Active"}),e.jsx(y,{value:"success",children:"Success"}),e.jsx(y,{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(nn,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(p,{placeholder:"Search builds...",value:O,onChange:s=>Ps(s.target.value),className:"pl-8 w-64"})]})]})]})}),e.jsx(v,{children:(()=>{let s=R;return le==="active"?s=s.filter(n=>n.status==="running"||n.status==="pending"):le==="success"?s=s.filter(n=>n.status==="success"):le==="failed"&&(s=s.filter(n=>n.status==="failed")),O&&(s=s.filter(n=>n.pipelineId.toLowerCase().includes(O.toLowerCase())||n.id.toLowerCase().includes(O.toLowerCase())||P.find(t=>t.id===n.pipelineId)?.name.toLowerCase().includes(O.toLowerCase()))),s.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Le,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No builds found"})]}):e.jsx("div",{className:"space-y-3",children:s.map(n=>e.jsxs(g,{className:"border-border",children:[e.jsx(N,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[fe(n.status),e.jsxs("div",{className:"flex-1",children:[e.jsx(b,{className:"text-lg",children:P.find(t=>t.id===n.pipelineId)?.name||n.pipelineId}),e.jsxs(k,{className:"text-xs mt-1 flex items-center gap-2",children:["Build #",n.number,n.branch&&e.jsxs(e.Fragment,{children:[e.jsx(Ue,{className:"h-3 w-3"}),n.branch]}),n.duration&&` • ${(n.duration/1e3).toFixed(1)}s`]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[ve(n.status),n.status==="running"&&r&&e.jsxs(u,{size:"sm",variant:"destructive",onClick:()=>rs(n.id),children:[e.jsx(hs,{className:"h-4 w-4 mr-1"}),"Cancel"]}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>Ds(n.id),children:[e.jsx(tn,{className:"h-4 w-4 mr-1"}),"Details"]})]})]})}),n.status==="running"&&n.progress!==void 0&&e.jsx(v,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progress"}),e.jsxs("span",{children:[n.progress,"%"]})]}),e.jsx(ne,{value:n.progress,className:"h-2"}),n.stages&&n.stages.length>0&&e.jsx("div",{className:"mt-3 space-y-1",children:n.stages.map((t,i)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[fe(t.status),e.jsx("span",{className:t.status==="running"?"font-semibold":"",children:t.name})]},i))})]})}),n.status!=="running"&&n.duration&&e.jsx(v,{children:e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Duration: ",(n.duration/1e3).toFixed(1),"s • Started: ",new Date(n.startTime).toLocaleString()]})})]},n.id))})})()})]})}),e.jsx(S,{value:"executors",className:"space-y-4 mt-4",children:e.jsxs(g,{children:[e.jsxs(N,{children:[e.jsx(b,{children:"Executor Configuration"}),e.jsx(k,{children:"Manage concurrent build executors on master node"})]}),e.jsx(v,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"executor-count",children:"Executor Count"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{id:"executor-count",type:"number",min:"1",max:"100",value:ge,onChange:s=>{const n=parseInt(s.target.value)||2;w({executorCount:n})}}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"concurrent builds"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Number of concurrent builds that can run simultaneously on master node"}),l&&e.jsxs("div",{className:"mt-4 p-3 border rounded-md bg-muted",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Current Status:"}),e.jsxs("span",{className:"font-semibold",children:[l.executorBusy," busy / ",l.executorBusy+l.executorIdle," total"]})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(ne,{value:l.executorUtilization,className:"h-2 flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[l.executorUtilization.toFixed(1),"%"]})]}),l.executorBusy>0&&e.jsxs("p",{className:"text-xs text-amber-600 mt-2",children:["⚠️ ",l.executorBusy," executor(s) are currently busy. You cannot reduce executor count below this value."]})]})]})})]})}),e.jsx(S,{value:"nodes",className:"space-y-4 mt-4",children:e.jsxs(g,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(b,{children:"Jenkins Nodes"}),e.jsx(k,{children:"Manage build agents and executors"})]}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>de(!0),children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Add Node"]})]})}),e.jsx(v,{children:(()=>{const s=Ye.length>0?Ye:[{id:"master",name:"master",status:"online",numExecutors:ge,busyExecutors:0,idleExecutors:ge,labels:["master"]},...V.map(n=>({id:n.id,name:n.name,status:"online",numExecutors:n.numExecutors||1,busyExecutors:0,idleExecutors:n.numExecutors||1,labels:n.labels||[],description:n.description}))];return s.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Oe,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No nodes configured"})]}):e.jsx("div",{className:"space-y-3",children:s.map(n=>{const t=n.id==="master",i=V.find(a=>a.id===n.id);return e.jsxs(g,{className:"border-border",children:[e.jsx(N,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded ${n.status==="online"?"bg-green-500/10":"bg-gray-500/10"}`,children:e.jsx(Oe,{className:`h-4 w-4 ${n.status==="online"?"text-green-500":"text-gray-500"}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs(b,{className:"text-lg",children:[n.name,t&&e.jsx(D,{variant:"outline",className:"ml-2 text-xs",children:"Master"})]}),e.jsxs(k,{className:"text-xs mt-1",children:[n.numExecutors," executors • ",n.busyExecutors," busy • ",n.idleExecutors," idle",t&&e.jsx("span",{className:"block mt-1 text-muted-foreground",children:"Master node is the Jenkins controller that manages builds and coordinates agents."})]}),i?.description&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:i.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{variant:n.status==="online"?"default":"secondary",children:n.status}),!t&&e.jsxs(e.Fragment,{children:[e.jsx(u,{size:"icon",variant:"ghost",onClick:()=>Us(n.id),children:e.jsx(ms,{className:"h-4 w-4"})}),e.jsx(u,{size:"icon",variant:"ghost",onClick:()=>Js(n.id),children:e.jsx(z,{className:"h-4 w-4"})})]})]})]})}),n.labels&&n.labels.length>0&&e.jsx(v,{children:e.jsx("div",{className:"flex flex-wrap gap-1",children:n.labels.map((a,o)=>e.jsx(D,{variant:"outline",className:"text-xs",children:a},o))})})]},n.id)})})})()})]})}),e.jsx(S,{value:"settings",className:"space-y-4 mt-4",children:e.jsxs(g,{children:[e.jsxs(N,{children:[e.jsx(b,{children:"Server Configuration"}),e.jsx(k,{children:"Jenkins server settings"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"jenkins-url",children:"Jenkins URL"}),e.jsx(p,{id:"jenkins-url",value:Fs,onChange:s=>w({jenkinsUrl:s.target.value}),placeholder:"http://jenkins:8080"})]}),e.jsx(Ne,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{children:"Enable CSRF Protection"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Protect against cross-site request forgery"})]}),e.jsx(T,{checked:Ts,onCheckedChange:s=>w({enableCSRF:s})})]}),e.jsx(Ne,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{children:"Enable Pipelines"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Enable Jenkins pipeline support"})]}),e.jsx(T,{checked:Vs,onCheckedChange:s=>w({enablePipeline:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{children:"Enable Blue Ocean"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Modern pipeline UI"})]}),e.jsx(T,{checked:Is,onCheckedChange:s=>w({enableBlueOcean:s})})]}),e.jsx(Ne,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{children:"Enable Artifact Archiving"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Store build artifacts"})]}),e.jsx(T,{checked:os,onCheckedChange:s=>w({enableArtifactArchiving:s})})]}),os&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"retention-days",children:"Retention Days"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{id:"retention-days",type:"number",min:"1",max:"365",value:Rs,onChange:s=>w({retentionDays:parseInt(s.target.value)||30})}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"days"})]})]})]})]})}),e.jsx(S,{value:"metrics",className:"space-y-4 mt-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(g,{children:[e.jsxs(N,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(dn,{className:"h-5 w-5"}),"Build Trends"]}),e.jsx(k,{children:"Build count over time"})]}),e.jsx(v,{children:e.jsx(Je,{width:"100%",height:300,children:e.jsxs(mn,{data:Te,children:[e.jsx(Me,{strokeDasharray:"3 3"}),e.jsx(_e,{dataKey:"time"}),e.jsx(Ke,{}),e.jsx(qe,{}),e.jsx(He,{}),e.jsx(Ge,{type:"monotone",dataKey:"builds",stackId:"1",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.6}),e.jsx(Ge,{type:"monotone",dataKey:"success",stackId:"2",stroke:"#82ca9d",fill:"#82ca9d",fillOpacity:.6}),e.jsx(Ge,{type:"monotone",dataKey:"failed",stackId:"2",stroke:"#ff7300",fill:"#ff7300",fillOpacity:.6})]})})})]}),e.jsxs(g,{children:[e.jsxs(N,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(js,{className:"h-5 w-5 text-green-500"}),"Success Rate"]}),e.jsx(k,{children:"Build success rate over time"})]}),e.jsx(v,{children:e.jsx(Je,{width:"100%",height:300,children:e.jsxs(on,{data:Te.map(s=>({...s,successRate:s.builds>0?s.success/s.builds*100:0})),children:[e.jsx(Me,{strokeDasharray:"3 3"}),e.jsx(_e,{dataKey:"time"}),e.jsx(Ke,{domain:[0,100]}),e.jsx(qe,{formatter:s=>`${s.toFixed(1)}%`}),e.jsx(He,{}),e.jsx(un,{type:"monotone",dataKey:"successRate",stroke:"#82ca9d",strokeWidth:2,name:"Success Rate",dot:{fill:"#82ca9d",r:4}})]})})})]}),e.jsxs(g,{children:[e.jsxs(N,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(ps,{className:"h-5 w-5"}),"Average Build Duration"]}),e.jsx(k,{children:"Average build duration in seconds"})]}),e.jsx(v,{children:e.jsx(Je,{width:"100%",height:300,children:e.jsxs(hn,{data:Te,children:[e.jsx(Me,{strokeDasharray:"3 3"}),e.jsx(_e,{dataKey:"time"}),e.jsx(Ke,{}),e.jsx(qe,{formatter:s=>`${s.toFixed(1)}s`}),e.jsx(He,{}),e.jsx(xn,{dataKey:"duration",fill:"#8884d8",name:"Duration (s)"})]})})})]}),e.jsxs(g,{children:[e.jsxs(N,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(gs,{className:"h-5 w-5"}),"Executor Utilization"]}),e.jsx(k,{children:"Current executor usage"})]}),e.jsx(v,{children:l?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-bold",children:[l.executorUtilization.toFixed(1),"%"]}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-2",children:[l.executorBusy," / ",l.executorBusy+l.executorIdle," executors busy"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Busy"}),e.jsx("span",{className:"font-medium",children:l.executorBusy})]}),e.jsx(ne,{value:l.executorUtilization,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Idle"}),e.jsx("span",{className:"font-medium",children:l.executorIdle})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.buildsPerMinute.toFixed(1)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Builds/min"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[(l.averageBuildDuration/1e3).toFixed(1),"s"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Avg Duration"})]})]})]}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No metrics available"})})]})]})})]}),Be&&(()=>{const s=P.find(n=>n.id===Be);return s?e.jsx(Y,{open:!!Be,onOpenChange:n=>!n&&Pe(null),children:e.jsxs(Z,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(W,{children:[e.jsx(ee,{children:"Edit Pipeline Configuration"}),e.jsx(se,{children:"Configure pipeline settings, triggers, parameters, and post-build actions"})]}),e.jsxs(us,{defaultValue:"basic",className:"w-full",children:[e.jsxs(xs,{className:"grid w-full grid-cols-5",children:[e.jsx(E,{value:"basic",children:"Basic"}),e.jsx(E,{value:"triggers",children:"Triggers"}),e.jsx(E,{value:"parameters",children:"Parameters"}),e.jsx(E,{value:"environment",children:"Environment"}),e.jsx(E,{value:"actions",children:"Post-Build"})]}),e.jsxs(S,{value:"basic",className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"pipeline-name",children:"Name *"}),e.jsx(p,{id:"pipeline-name",defaultValue:s.name,onChange:n=>{const t=Ie(n.target.value,s.id);K(t)},onBlur:n=>{const t=n.target.value.trim(),i=Ie(t,s.id);K(i),!i&&t!==s.name&&m(s.id,{name:t})},className:Ve?"border-red-500":""}),Ve&&e.jsxs("p",{className:"text-xs text-red-500 flex items-center gap-1",children:[e.jsx(be,{className:"h-3 w-3"}),Ve]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"pipeline-branch",children:"Branch"}),e.jsx(p,{id:"pipeline-branch",defaultValue:s.branch||"main",onBlur:n=>{n.target.value!==s.branch&&m(s.id,{branch:n.target.value})}})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(d,{children:"Enabled"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Enable/disable pipeline"})]}),e.jsx(T,{checked:s.enabled!==!1,onCheckedChange:n=>{m(s.id,{enabled:n}),r&&r.setPipelineEnabled(s.id,n)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Status"}),e.jsxs("div",{className:"p-2 border rounded-md bg-muted",children:[ve(s.status,s.lastBuild),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:s.lastBuild===0?"Pipeline has never been built. Status will be determined after first build.":`Status is determined by the last build (#${s.lastBuild}).`})]})]})]}),e.jsx(S,{value:"triggers",className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:"Build Triggers"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Configure when builds should be triggered"})]}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>{const n=[...s.triggers||[],{type:"webhook",enabled:!0,config:{}}];m(s.id,{triggers:n})},children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),"Add Trigger"]})]}),(s.triggers||[]).map((n,t)=>e.jsxs(g,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(H,{value:n.type,onValueChange:i=>{const a=[...s.triggers||[]];a[t]={...n,type:i},m(s.id,{triggers:a})},children:[e.jsx(G,{className:"w-32",children:e.jsx(X,{})}),e.jsxs(Q,{children:[e.jsx(y,{value:"webhook",children:"Webhook"}),e.jsx(y,{value:"cron",children:"Cron"}),e.jsx(y,{value:"scm",children:"SCM Polling"}),e.jsx(y,{value:"manual",children:"Manual Only"})]})]}),e.jsx(T,{checked:n.enabled,onCheckedChange:i=>{const a=[...s.triggers||[]];a[t]={...n,enabled:i},m(s.id,{triggers:a})}})]}),e.jsx(u,{size:"icon",variant:"ghost",onClick:()=>{const i=(s.triggers||[]).filter((a,o)=>o!==t);m(s.id,{triggers:i})},children:e.jsx(z,{className:"h-4 w-4"})})]}),n.type==="webhook"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Branches (comma-separated, empty for all)"}),e.jsx(p,{placeholder:"main, develop, release/*",defaultValue:n.config?.branches?.join(", "),onBlur:i=>{const a=i.target.value.split(",").map(h=>h.trim()).filter(h=>h),o=[...s.triggers||[]];o[t]={...n,config:{...n.config,branches:a}},m(s.id,{triggers:o})}})]}),n.type==="cron"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Cron Expression"}),e.jsx(p,{placeholder:"H/15 * * * *",defaultValue:n.config?.schedule,onBlur:i=>{const a=[...s.triggers||[]];a[t]={...n,config:{...n.config,schedule:i.target.value}},m(s.id,{triggers:a})}}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Example: H/15 * * * * (every 15 minutes)"})]}),n.type==="scm"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Poll Interval (minutes)"}),e.jsx(p,{type:"number",min:"1",placeholder:"5",defaultValue:n.config?.pollInterval,onBlur:i=>{const a=[...s.triggers||[]];a[t]={...n,config:{...n.config,pollInterval:parseInt(i.target.value)||5}},m(s.id,{triggers:a})}})]})]},t)),(!s.triggers||s.triggers.length===0)&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No triggers configured. Builds will use default rate-based triggering."})]})}),e.jsx(S,{value:"parameters",className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:"Build Parameters"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Parameters to pass to builds"})]}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>{const n=[...s.parameters||[],{name:"",type:"string",defaultValue:""}];m(s.id,{parameters:n})},children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),"Add Parameter"]})]}),(s.parameters||[]).map((n,t)=>e.jsxs(g,{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Parameter Name"}),e.jsx(p,{value:n.name,onChange:i=>{const a=[...s.parameters||[]];a[t]={...n,name:i.target.value},m(s.id,{parameters:a})}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Type"}),e.jsxs(H,{value:n.type,onValueChange:i=>{const a=[...s.parameters||[]];a[t]={...n,type:i},m(s.id,{parameters:a})},children:[e.jsx(G,{children:e.jsx(X,{})}),e.jsxs(Q,{children:[e.jsx(y,{value:"string",children:"String"}),e.jsx(y,{value:"choice",children:"Choice"}),e.jsx(y,{value:"boolean",children:"Boolean"}),e.jsx(y,{value:"password",children:"Password"})]})]})]})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsx(d,{children:"Default Value"}),n.type==="boolean"?e.jsx(T,{checked:n.defaultValue===!0,onCheckedChange:i=>{const a=[...s.parameters||[]];a[t]={...n,defaultValue:i},m(s.id,{parameters:a})}}):e.jsx(p,{value:n.defaultValue||"",type:n.type==="password"?"password":"text",onChange:i=>{const a=[...s.parameters||[]];a[t]={...n,defaultValue:i.target.value},m(s.id,{parameters:a})}})]}),n.type==="choice"&&e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsx(d,{children:"Choices (one per line)"}),e.jsx(ze,{rows:3,value:n.choices?.join(`
`)||"",onChange:i=>{const a=i.target.value.split(`
`).map(h=>h.trim()).filter(h=>h),o=[...s.parameters||[]];o[t]={...n,choices:a},m(s.id,{parameters:o})}})]}),e.jsxs(u,{size:"sm",variant:"ghost",onClick:()=>{const i=(s.parameters||[]).filter((a,o)=>o!==t);m(s.id,{parameters:i})},children:[e.jsx(z,{className:"h-4 w-4 mr-1"}),"Remove"]})]},t)),(!s.parameters||s.parameters.length===0)&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No parameters configured."})]})}),e.jsx(S,{value:"environment",className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:"Environment Variables"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Environment variables available to builds"})]}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>{const t={...s.environmentVariables||{},[`VAR_${Date.now()}`]:""};m(s.id,{environmentVariables:t})},children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),"Add Variable"]})]}),s.environmentVariables&&Object.keys(s.environmentVariables).length>0?e.jsx("div",{className:"space-y-2",children:Object.entries(s.environmentVariables).map(([n,t])=>e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-[1fr_2fr_auto] gap-3 items-center",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{className:"text-xs",children:"Variable Name"}),e.jsx(p,{value:n,onChange:i=>{const a=i.target.value,o=s.environmentVariables||{};if(a!==n&&!o[a]){const h={...o};delete h[n],h[a]=t,m(s.id,{environmentVariables:h})}},placeholder:"VAR_NAME"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(d,{className:"text-xs",children:"Value"}),e.jsx(p,{value:t,onChange:i=>{const a=s.environmentVariables||{};m(s.id,{environmentVariables:{...a,[n]:i.target.value}})},placeholder:"variable value"})]}),e.jsx(u,{size:"icon",variant:"ghost",onClick:()=>{const a={...s.environmentVariables||{}};delete a[n],m(s.id,{environmentVariables:a})},children:e.jsx(z,{className:"h-4 w-4"})})]})},n))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No environment variables configured."})]})}),e.jsx(S,{value:"actions",className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium",children:"Post-Build Actions"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Actions to execute after build completes"})]}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>{const n=[...s.postBuildActions||[],{type:"email",enabled:!0,config:{}}];m(s.id,{postBuildActions:n})},children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),"Add Action"]})]}),(s.postBuildActions||[]).map((n,t)=>e.jsxs(g,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(H,{value:n.type,onValueChange:i=>{const a=[...s.postBuildActions||[]];a[t]={...n,type:i,config:{}},m(s.id,{postBuildActions:a})},children:[e.jsx(G,{className:"w-40",children:e.jsx(X,{})}),e.jsxs(Q,{children:[e.jsx(y,{value:"email",children:"Email Notification"}),e.jsx(y,{value:"archive",children:"Archive Artifacts"}),e.jsx(y,{value:"publish",children:"Publish Results"}),e.jsx(y,{value:"deploy",children:"Deploy"})]})]}),e.jsx(T,{checked:n.enabled,onCheckedChange:i=>{const a=[...s.postBuildActions||[]];a[t]={...n,enabled:i},m(s.id,{postBuildActions:a})}})]}),e.jsx(u,{size:"icon",variant:"ghost",onClick:()=>{const i=(s.postBuildActions||[]).filter((a,o)=>o!==t);m(s.id,{postBuildActions:i})},children:e.jsx(z,{className:"h-4 w-4"})})]}),n.type==="email"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Recipients (comma-separated)"}),e.jsx(p,{placeholder:"dev@example.com, team@example.com",defaultValue:n.config?.recipients?.join(", "),onBlur:i=>{const a=i.target.value.split(",").map(h=>h.trim()).filter(h=>h),o=[...s.postBuildActions||[]];o[t]={...n,config:{...n.config,recipients:a}},m(s.id,{postBuildActions:o})}})]}),n.type==="archive"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Archive Pattern"}),e.jsx(p,{placeholder:"**/*.jar, **/*.war",defaultValue:n.config?.archivePattern,onBlur:i=>{const a=[...s.postBuildActions||[]];a[t]={...n,config:{...n.config,archivePattern:i.target.value}},m(s.id,{postBuildActions:a})}})]}),n.type==="deploy"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Deployment Environment"}),e.jsxs(H,{value:n.config?.deployEnv||"staging",onValueChange:i=>{const a=[...s.postBuildActions||[]];a[t]={...n,config:{...n.config,deployEnv:i}},m(s.id,{postBuildActions:a})},children:[e.jsx(G,{children:e.jsx(X,{})}),e.jsxs(Q,{children:[e.jsx(y,{value:"staging",children:"Staging"}),e.jsx(y,{value:"production",children:"Production"}),e.jsx(y,{value:"dev",children:"Development"})]})]})]})]},t)),(!s.postBuildActions||s.postBuildActions.length===0)&&e.jsx("div",{className:"text-center py-8 text-muted-foreground text-sm",children:"No post-build actions configured."})]})})]}),e.jsx(ye,{children:e.jsx(u,{variant:"outline",onClick:()=>{Pe(null),K("")},children:"Close"})})]})}):null})(),e.jsx(Y,{open:Es,onOpenChange:de,children:e.jsxs(Z,{children:[e.jsxs(W,{children:[e.jsx(ee,{children:"Add New Node"}),e.jsx(se,{children:"Create a new Jenkins agent node for distributed builds"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"node-name",children:"Node Name *"}),e.jsx(p,{id:"node-name",value:oe,onChange:s=>{ke(s.target.value),M(Re(s.target.value))},onBlur:s=>M(Re(s.target.value)),placeholder:"agent-1",className:me?"border-red-500":""}),me&&e.jsxs("p",{className:"text-xs text-red-500 flex items-center gap-1",children:[e.jsx(be,{className:"h-3 w-3"}),me]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"node-executors",children:"Number of Executors"}),e.jsx(p,{id:"node-executors",type:"number",min:"1",max:"100",value:ue,onChange:s=>{const n=parseInt(s.target.value)||1;Ee(n),_($e(n))},onBlur:s=>_($e(ue)),className:he?"border-red-500":""}),he?e.jsxs("p",{className:"text-xs text-red-500 flex items-center gap-1",children:[e.jsx(be,{className:"h-3 w-3"}),he]}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of concurrent builds this node can handle"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"node-labels",children:"Labels"}),e.jsx(p,{id:"node-labels",value:We,onChange:s=>Se(s.target.value),placeholder:"linux, docker, kubernetes"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Comma-separated labels for build routing"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"node-description",children:"Description"}),e.jsx(ze,{id:"node-description",value:es,onChange:s=>Ae(s.target.value),placeholder:"Optional description",rows:3})]})]}),e.jsxs(ye,{children:[e.jsx(u,{variant:"outline",onClick:()=>{de(!1),ke(""),Ee(1),Se(""),Ae(""),M(""),_("")},children:"Cancel"}),e.jsx(u,{onClick:zs,disabled:!!me||!!he||!oe.trim(),children:"Add Node"})]})]})}),re&&(()=>{const s=V.find(x=>x.id===re);if(!s)return null;const[n,t]=c.useState(s.name),[i,a]=c.useState(s.numExecutors||1),[o,h]=c.useState(s.labels?.join(", ")||""),[C,f]=c.useState(s.description||"");return e.jsx(Y,{open:!!re,onOpenChange:x=>!x&&ce(null),children:e.jsxs(Z,{children:[e.jsxs(W,{children:[e.jsx(ee,{children:"Edit Node"}),e.jsx(se,{children:"Update node configuration"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-node-name",children:"Node Name *"}),e.jsx(p,{id:"edit-node-name",value:n,onChange:x=>t(x.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-node-executors",children:"Number of Executors"}),e.jsx(p,{id:"edit-node-executors",type:"number",min:"1",max:"100",value:i,onChange:x=>a(parseInt(x.target.value)||1)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-node-labels",children:"Labels"}),e.jsx(p,{id:"edit-node-labels",value:o,onChange:x=>h(x.target.value),placeholder:"linux, docker, kubernetes"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-node-description",children:"Description"}),e.jsx(ze,{id:"edit-node-description",value:C,onChange:x=>f(x.target.value),rows:3})]})]}),e.jsxs(ye,{children:[e.jsx(u,{variant:"outline",onClick:()=>ce(null),children:"Cancel"}),e.jsx(u,{onClick:()=>{if(!n.trim()){j({title:"Invalid name",description:"Node name cannot be empty",variant:"destructive"});return}Os(re,{name:n.trim(),numExecutors:i,labels:o.split(",").map(x=>x.trim()).filter(x=>x.length>0),description:C.trim()||void 0})},children:"Save"})]})]})})})(),e.jsx(Y,{open:Ss,onOpenChange:s=>{xe(s),s||(J(""),A(""))},children:e.jsxs(Z,{children:[e.jsxs(W,{children:[e.jsx(ee,{children:"Install Plugin"}),e.jsx(se,{children:"Install a new Jenkins plugin"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"plugin-name",children:"Plugin Name *"}),e.jsx(p,{id:"plugin-name",value:De,onChange:s=>{const n=s.target.value;if(J(n),n.trim()){const t=pe(n);A(t)}else A("")},onBlur:s=>{const n=pe(s.target.value);A(n)},placeholder:"e.g., git, docker, kubernetes",className:je?"border-red-500":""}),je?e.jsxs("p",{className:"text-xs text-red-500 flex items-center gap-1",children:[e.jsx(be,{className:"h-3 w-3"}),je]}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter the plugin name (e.g., git, docker, kubernetes, workflow-aggregator)"})]}),e.jsxs("div",{className:"p-3 border rounded-md bg-muted",children:[e.jsx("p",{className:"text-sm font-semibold mb-2",children:"Popular plugins:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["git","docker","kubernetes","workflow-aggregator","blue-ocean","junit","maven-plugin"].map(s=>e.jsx(u,{variant:"outline",size:"sm",onClick:()=>{J(s);const n=pe(s);A(n),setTimeout(()=>{const t=document.getElementById("plugin-name");t&&(t.focus(),t.select())},0)},children:s},s))})]})]}),e.jsxs(ye,{children:[e.jsx(u,{variant:"outline",onClick:()=>{xe(!1),J(""),A("")},children:"Cancel"}),e.jsx(u,{onClick:()=>Ks(De),disabled:!!je||!De.trim(),children:"Install"})]})]})}),e.jsx(Y,{open:As,onOpenChange:Fe,children:e.jsxs(Z,{className:"max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs(W,{children:[e.jsx(ee,{children:"Build Details"}),e.jsx(se,{children:F&&(()=>{const s=R.find(t=>t.id===F);if(!s)return"Build details";const n=P.find(t=>t.id===s.pipelineId);return`Build #${s.number} - ${n?.name||s.pipelineId}`})()})]}),F&&(()=>{const s=R.find(t=>t.id===F);if(!s)return null;const n=P.find(t=>t.id===s.pipelineId);return e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4",children:[e.jsxs(g,{children:[e.jsx(N,{children:e.jsx(b,{children:"Build Information"})}),e.jsxs(v,{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Pipeline:"}),e.jsx("span",{className:"ml-2 font-medium",children:n?.name||s.pipelineId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Build Number:"}),e.jsxs("span",{className:"ml-2 font-medium",children:["#",s.number]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Status:"}),e.jsx("span",{className:"ml-2",children:ve(s.status)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Branch:"}),e.jsx("span",{className:"ml-2 font-medium",children:s.branch||"main"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Started:"}),e.jsx("span",{className:"ml-2",children:new Date(s.startTime).toLocaleString()})]}),s.duration&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Duration:"}),e.jsxs("span",{className:"ml-2",children:[(s.duration/1e3).toFixed(1),"s"]})]})]}),s.status==="running"&&s.progress!==void 0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[s.progress,"%"]})]}),e.jsx(ne,{value:s.progress})]}),s.stages&&s.stages.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Stages:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.stages.map((t,i)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm p-2 border rounded",children:[fe(t.status),e.jsx("span",{children:t.name}),t.duration&&e.jsxs("span",{className:"text-xs text-muted-foreground ml-auto",children:[(t.duration/1e3).toFixed(1),"s"]})]},i))})]}),s.status==="running"&&r&&e.jsx("div",{className:"mt-4",children:e.jsxs(u,{variant:"destructive",onClick:()=>rs(s.id),children:[e.jsx(hs,{className:"h-4 w-4 mr-2"}),"Cancel Build"]})})]})]}),e.jsxs(g,{children:[e.jsxs(N,{children:[e.jsx(b,{children:"Console Output"}),e.jsx(k,{children:"Build execution logs"})]}),e.jsx(v,{children:e.jsx("div",{className:"bg-black text-green-400 p-4 rounded font-mono text-xs overflow-x-auto max-h-96 overflow-y-auto",children:ns.length>0?ns.map((t,i)=>e.jsx("div",{className:"whitespace-pre-wrap",children:t},i)):e.jsx("div",{className:"text-muted-foreground",children:"No logs available"})})})]}),is.length>0&&e.jsxs(g,{children:[e.jsxs(N,{children:[e.jsx(b,{children:"Artifacts"}),e.jsx(k,{children:"Build artifacts"})]}),e.jsx(v,{children:e.jsx("div",{className:"space-y-2",children:is.map((t,i)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"font-mono text-sm",children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:cs(t.size)}),e.jsxs(u,{size:"sm",variant:"outline",onClick:()=>{const a=`# Artifact: ${t.name}
# Size: ${cs(t.size)}
# Generated by Jenkins Simulation

This is a simulated artifact file.
In a real Jenkins environment, this would contain the actual build artifact.`,o=new Blob([a],{type:"text/plain"}),h=URL.createObjectURL(o),C=document.createElement("a");C.href=h,C.download=t.name,document.body.appendChild(C),C.click(),document.body.removeChild(C),URL.revokeObjectURL(h),j({title:"Artifact downloaded",description:`${t.name} has been downloaded`})},children:[e.jsx(an,{className:"h-3 w-3 mr-1"}),"Download"]})]})]},i))})})]})]})})()]})})]})})}export{$n as JenkinsConfigAdvanced};

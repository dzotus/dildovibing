import{u as We,X as Be,j as e,V as Qe,r as N,i as m,S as Y,C as i,e as c,f as r,k as d,B as w,T as Xe,a as Ge,b as R,A as Ye,c as Je,d as z,h as I,K as Ue,I as g,Y as Ze,P as U,M as _e,Q as es,m as Z,L as l,D as _,v as ee,w as se,x as ae,y as ne,z as le,t as V,n as A,o as P,p as D,q as L,s as t}from"./index-D1p3qKk1.js";import{u as ss}from"./use-toast-D6Huwyee.js";import{T as he}from"./textarea-Cbj5d7Ql.js";import{R as as}from"./refresh-ccw-BoEyyRRQ.js";import{K as ns}from"./key-CEPPITZ8.js";import{D as ls}from"./database-DCvPvYtR.js";import{S as ts}from"./shield-Czxogl5B.js";import{L as is}from"./lock-kXe5g8dp.js";import{E as cs}from"./eye-off-BgWLTbL5.js";import{C as rs}from"./circle-check-big-lBf-svbX.js";function bs({componentId:F}){const{nodes:je,updateNode:me}=We(),{componentMetrics:ue,isRunning:ds}=Be(),{toast:S}=ss(),k=je.find(s=>s.id===F);if(!k)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const T=ue.get(F),b=Qe.getVaultEmulationEngine(F),h=k.data.config||{},te=h.vaultType||"hashicorp",pe=h.address||"http://vault:8200",ve=h.enableTLS??!1,ge=h.enableTransit??!0,ie=h.enableKV??!0,Ne=h.kvVersion||"2",fe=h.enablePKI??!1,ce=h.enableAuth??!0,ye=h.authMethod||"token",be=h.tokenTTL||"24h",f=h.secrets||[{id:"1",path:"secret/app/database",key:"password",value:"••••••••",version:1,created:new Date().toISOString(),updated:new Date().toISOString(),visible:!1},{id:"2",path:"secret/app/api",key:"api-key",value:"••••••••",version:1,created:new Date().toISOString(),updated:new Date().toISOString(),visible:!1}],E=h.engines||[{id:"1",name:"secret/",type:"kv",enabled:!0,version:2,description:"Key-Value secrets"},{id:"2",name:"transit/",type:"transit",enabled:!0,description:"Encryption as a service"}],O=h.policies||[{id:"1",name:"admin",rules:'path "*" { capabilities = ["create", "read", "update", "delete", "list"] }',enabled:!0},{id:"2",name:"readonly",rules:'path "*" { capabilities = ["read", "list"] }',enabled:!0}],j=b?.getMetrics(),Ce=b?.getConfig(),we=j?.secretsTotal??h.totalSecrets??f.length,Se=Ce?.engines.filter(s=>s.enabled).length??h.enginesEnabled??E.filter(s=>s.enabled).length,re=j?.activeTokens??0,ke=j?.readRequestsTotal??0,Te=j?.writeRequestsTotal??0,Ee=j?.authRequestsTotal??0,Ve=j?.encryptionOperationsTotal??0,Ae=j?.decryptionOperationsTotal??0,[os,xs]=N.useState(null),[Pe,H]=N.useState(!1),[De,W]=N.useState(!1),[Le,B]=N.useState(!1),[Oe,de]=N.useState(null),[K,oe]=N.useState(""),[u,q]=N.useState({path:"secret/",key:"",value:""}),[p,M]=N.useState({name:"",type:"kv",version:2}),[C,Q]=N.useState({name:"",rules:'path "*" { capabilities = ["read"] }'}),[n,v]=N.useState({}),xe=N.useMemo(()=>{if(!K)return f;const s=K.toLowerCase();return f.filter(a=>a.path.toLowerCase().includes(s)||a.key.toLowerCase().includes(s)||a.value.toLowerCase().includes(s))},[f,K]);N.useEffect(()=>{b&&k&&b.initializeConfig(k)},[h,k,b]);const x=s=>{me(F,{data:{...k.data,config:{...h,...s}}})},Ke=()=>{b&&k&&(b.initializeConfig(k),S({title:"Refreshed",description:"Vault configuration refreshed from emulation engine"}))},Re=()=>{const s={};if(u.path?.trim()||(s.path="Path is required"),u.key?.trim()||(s.key="Key is required"),u.value?.trim()||(s.value="Value is required"),Object.keys(s).length>0){v({...n,secret:s});return}v({...n,secret:void 0});const a={id:`secret-${Date.now()}`,path:u.path,key:u.key,value:u.value,version:1,created:new Date().toISOString(),updated:new Date().toISOString(),visible:!1};x({secrets:[...f,a]}),H(!1),q({path:"secret/",key:"",value:""}),S({title:"Secret Created",description:`Secret ${u.path}/${u.key} created successfully`})},ze=s=>{const a=f.find(o=>o.id===s);a&&(x({secrets:f.filter(o=>o.id!==s)}),S({title:"Secret Deleted",description:`Secret ${a.path}/${a.key} deleted`}))},X=(s,a,o)=>{const $=f.map(y=>y.id===s?{...y,[a]:o}:y);x({secrets:$})},Ie=s=>{const a=f.find(o=>o.id===s);a&&X(s,"visible",!a.visible)},qe=s=>{const a=f.find(o=>o.id===s);a&&(navigator.clipboard.writeText(a.value),de(s),setTimeout(()=>de(null),2e3))},Me=()=>{const s={};if(p.name?.trim()||(s.name="Engine name is required"),Object.keys(s).length>0){v({...n,engine:s});return}v({...n,engine:void 0});const a={id:`engine-${Date.now()}`,name:p.name,type:p.type,enabled:!0,version:p.type==="kv"?p.version:void 0};x({engines:[...E,a]}),W(!1),M({name:"",type:"kv",version:2}),S({title:"Engine Created",description:`Secret engine ${p.name} created successfully`})},$e=s=>{const a=E.find(o=>o.id===s);a&&(x({engines:E.filter(o=>o.id!==s)}),S({title:"Engine Removed",description:`Secret engine ${a.name} removed`}))},G=(s,a,o)=>{const $=E.map(y=>y.id===s?{...y,[a]:o}:y);x({engines:$})},Fe=()=>{if(!C.name||!C.rules){S({title:"Validation Error",description:"Please fill in all required fields",variant:"destructive"});return}const s={id:`policy-${Date.now()}`,name:C.name,rules:C.rules,enabled:!0};x({policies:[...O,s]}),B(!1),Q({name:"",rules:'path "*" { capabilities = ["read"] }'}),S({title:"Policy Created",description:`Access policy ${C.name} created successfully`})},He=s=>{const a=O.find(o=>o.id===s);a&&(x({policies:O.filter(o=>o.id!==s)}),S({title:"Policy Deleted",description:`Access policy ${a.name} deleted`}))},J=(s,a,o)=>{const $=O.map(y=>y.id===s?{...y,[a]:o}:y);x({policies:$})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Secrets Vault"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Vault Configuration"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Secure storage and management of secrets, API keys, and credentials"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(m,{variant:"outline",size:"sm",onClick:Ke,children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(Y,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm font-medium",children:"Total Secrets"})}),e.jsxs(d,{children:[e.jsx("span",{className:"text-2xl font-bold",children:we}),T&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[ke," reads, ",Te," writes"]})]})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm font-medium",children:"Engines Enabled"})}),e.jsxs(d,{children:[e.jsx("span",{className:"text-2xl font-bold",children:Se}),T&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Ve+Ae," crypto ops"]})]})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm font-medium",children:"Active Tokens"})}),e.jsxs(d,{children:[e.jsx("span",{className:"text-2xl font-bold",children:re}),T&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Ee," auth requests"]})]})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm font-medium",children:"Vault Type"})}),e.jsxs(d,{children:[e.jsx(w,{variant:"outline",children:te}),T&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Throughput:"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(T.throughput)," ops/s"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Latency:"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(T.latency)," ms"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Error Rate:"}),e.jsxs("span",{className:"font-semibold",children:[(T.errorRate*100).toFixed(2),"%"]})]})]})]})]})]}),e.jsxs(Xe,{defaultValue:"secrets",className:"space-y-4",children:[e.jsxs(Ge,{children:[e.jsxs(R,{value:"secrets",children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"Secrets (",f.length,")"]}),e.jsxs(R,{value:"engines",children:[e.jsx(ls,{className:"h-4 w-4 mr-2"}),"Secret Engines (",E.length,")"]}),e.jsxs(R,{value:"policies",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Policies (",O.length,")"]}),e.jsxs(R,{value:"tokens",children:[e.jsx(is,{className:"h-4 w-4 mr-2"}),"Tokens (",re,")"]}),e.jsxs(R,{value:"audit",children:[e.jsx(Ye,{className:"h-4 w-4 mr-2"}),"Audit Log"]}),e.jsxs(R,{value:"settings",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(z,{value:"secrets",className:"space-y-4",children:e.jsxs(e.Fragment,{children:[e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Secrets"}),e.jsx(I,{children:"Manage stored secrets and credentials"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ue,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(g,{placeholder:"Search secrets...",value:K,onChange:s=>oe(s.target.value),className:"pl-8 w-64"}),K&&e.jsx(m,{variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full",onClick:()=>oe(""),children:e.jsx(Ze,{className:"h-4 w-4"})})]}),e.jsxs(m,{onClick:()=>H(!0),size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Create Secret"]})]})]})}),e.jsx(d,{children:xe.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:K?"No secrets found matching your search":"No secrets configured"}):e.jsx("div",{className:"space-y-4",children:xe.map(s=>e.jsxs(i,{className:"border-l-4 border-l-green-500",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-base",children:s.path}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(w,{variant:"outline",children:s.key}),e.jsxs(w,{variant:"outline",children:["v",s.version]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>Ie(s.id),children:s.visible?e.jsx(cs,{className:"h-4 w-4"}):e.jsx(_e,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>qe(s.id),children:Oe===s.id?e.jsx(rs,{className:"h-4 w-4 text-green-500"}):e.jsx(es,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>ze(s.id),children:e.jsx(Z,{className:"h-4 w-4"})})]})]})}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Path"}),e.jsx(g,{value:s.path,onChange:a=>X(s.id,"path",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Key"}),e.jsx(g,{value:s.key,onChange:a=>X(s.id,"key",a.target.value)})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(l,{children:"Value"}),e.jsx(g,{type:s.visible?"text":"password",value:s.value,onChange:a=>X(s.id,"value",a.target.value),placeholder:"Enter secret value"})]})]})})]},s.id))})})]}),e.jsx(_,{open:Pe,onOpenChange:H,children:e.jsxs(ee,{children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Create New Secret"}),e.jsx(ne,{children:"Add a new secret to the vault"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Path"}),e.jsx(g,{value:u.path,onChange:s=>{q({...u,path:s.target.value}),n.secret?.path&&v({...n,secret:{...n.secret,path:void 0}})},placeholder:"secret/app/database",className:n.secret?.path?"border-destructive":""}),n.secret?.path&&e.jsx("p",{className:"text-sm text-destructive",children:n.secret.path})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Key"}),e.jsx(g,{value:u.key,onChange:s=>{q({...u,key:s.target.value}),n.secret?.key&&v({...n,secret:{...n.secret,key:void 0}})},placeholder:"password",className:n.secret?.key?"border-destructive":""}),n.secret?.key&&e.jsx("p",{className:"text-sm text-destructive",children:n.secret.key})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Value"}),e.jsx(g,{type:"password",value:u.value,onChange:s=>{q({...u,value:s.target.value}),n.secret?.value&&v({...n,secret:{...n.secret,value:void 0}})},placeholder:"Enter secret value",className:n.secret?.value?"border-destructive":""}),n.secret?.value&&e.jsx("p",{className:"text-sm text-destructive",children:n.secret.value})]})]}),e.jsxs(le,{children:[e.jsx(m,{variant:"outline",onClick:()=>{H(!1),v({...n,secret:void 0}),q({path:"secret/",key:"",value:""})},children:"Cancel"}),e.jsx(m,{onClick:Re,children:"Create"})]})]})})]})}),e.jsxs(z,{value:"engines",className:"space-y-4",children:[e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Secret Engines"}),e.jsx(I,{children:"Configure secret storage engines"})]}),e.jsxs(m,{onClick:()=>W(!0),size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Enable Engine"]})]})}),e.jsx(d,{children:e.jsx("div",{className:"space-y-4",children:E.map(s=>e.jsxs(i,{className:"border-l-4 border-l-blue-500",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-base",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(w,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"}),e.jsx(w,{variant:"outline",children:s.type}),s.version&&e.jsxs(w,{variant:"outline",children:["v",s.version]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{checked:s.enabled,onCheckedChange:a=>G(s.id,"enabled",a)}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>$e(s.id),children:e.jsx(Z,{className:"h-4 w-4"})})]})]})}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Engine Name"}),e.jsx(g,{value:s.name,onChange:a=>G(s.id,"name",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Engine Type"}),e.jsxs(A,{value:s.type,onValueChange:a=>G(s.id,"type",a),children:[e.jsx(P,{children:e.jsx(D,{})}),e.jsxs(L,{children:[e.jsx(t,{value:"kv",children:"Key-Value (KV)"}),e.jsx(t,{value:"transit",children:"Transit"}),e.jsx(t,{value:"pki",children:"PKI"}),e.jsx(t,{value:"database",children:"Database"}),e.jsx(t,{value:"aws",children:"AWS"}),e.jsx(t,{value:"azure",children:"Azure"})]})]})]}),s.type==="kv"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"KV Version"}),e.jsxs(A,{value:s.version?.toString()||"2",onValueChange:a=>G(s.id,"version",Number(a)),children:[e.jsx(P,{children:e.jsx(D,{})}),e.jsxs(L,{children:[e.jsx(t,{value:"1",children:"Version 1"}),e.jsx(t,{value:"2",children:"Version 2"})]})]})]})]})})]},s.id))})})]}),e.jsx(_,{open:De,onOpenChange:W,children:e.jsxs(ee,{children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Enable Secret Engine"}),e.jsx(ne,{children:"Configure a new secret storage engine"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Engine Name"}),e.jsx(g,{value:p.name,onChange:s=>{M({...p,name:s.target.value}),n.engine?.name&&v({...n,engine:{name:void 0}})},placeholder:"secret/",className:n.engine?.name?"border-destructive":""}),n.engine?.name&&e.jsx("p",{className:"text-sm text-destructive",children:n.engine.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Engine Type"}),e.jsxs(A,{value:p.type,onValueChange:s=>M({...p,type:s}),children:[e.jsx(P,{children:e.jsx(D,{})}),e.jsxs(L,{children:[e.jsx(t,{value:"kv",children:"Key-Value (KV)"}),e.jsx(t,{value:"transit",children:"Transit"}),e.jsx(t,{value:"pki",children:"PKI"}),e.jsx(t,{value:"database",children:"Database"}),e.jsx(t,{value:"aws",children:"AWS"}),e.jsx(t,{value:"azure",children:"Azure"})]})]})]}),p.type==="kv"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"KV Version"}),e.jsxs(A,{value:p.version.toString(),onValueChange:s=>M({...p,version:Number(s)}),children:[e.jsx(P,{children:e.jsx(D,{})}),e.jsxs(L,{children:[e.jsx(t,{value:"1",children:"Version 1"}),e.jsx(t,{value:"2",children:"Version 2"})]})]})]})]}),e.jsxs(le,{children:[e.jsx(m,{variant:"outline",onClick:()=>{W(!1),v({...n,engine:void 0}),M({name:"",type:"kv",version:2})},children:"Cancel"}),e.jsx(m,{onClick:Me,children:"Enable"})]})]})})]}),e.jsxs(z,{value:"policies",className:"space-y-4",children:[e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Access Policies"}),e.jsx(I,{children:"Configure access control policies"})]}),e.jsxs(m,{onClick:()=>B(!0),size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]})}),e.jsx(d,{children:e.jsx("div",{className:"space-y-4",children:O.map(s=>e.jsxs(i,{className:"border-l-4 border-l-purple-500",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-base",children:s.name}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsx(w,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{checked:s.enabled,onCheckedChange:a=>J(s.id,"enabled",a)}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>He(s.id),children:e.jsx(Z,{className:"h-4 w-4"})})]})]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Policy Name"}),e.jsx(g,{value:s.name,onChange:a=>J(s.id,"name",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Policy Rules (HCL)"}),e.jsx(he,{value:s.rules,onChange:a=>J(s.id,"rules",a.target.value),rows:6,className:"font-mono text-sm"})]})]})]},s.id))})})]}),e.jsx(_,{open:Le,onOpenChange:B,children:e.jsxs(ee,{className:"max-w-2xl",children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Create Access Policy"}),e.jsx(ne,{children:"Define access control rules using HCL syntax"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Policy Name"}),e.jsx(g,{value:C.name,onChange:s=>{Q({...C,name:s.target.value}),n.policy?.name&&v({...n,policy:{...n.policy,name:void 0}})},placeholder:"readonly",className:n.policy?.name?"border-destructive":""}),n.policy?.name&&e.jsx("p",{className:"text-sm text-destructive",children:n.policy.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Policy Rules (HCL)"}),e.jsx(he,{value:C.rules,onChange:s=>{Q({...C,rules:s.target.value}),n.policy?.rules&&v({...n,policy:{...n.policy,rules:void 0}})},rows:8,className:`font-mono text-sm ${n.policy?.rules?"border-destructive":""}`,placeholder:'path "*" { capabilities = ["read", "list"] }'}),n.policy?.rules&&e.jsx("p",{className:"text-sm text-destructive",children:n.policy.rules})]})]}),e.jsxs(le,{children:[e.jsx(m,{variant:"outline",onClick:()=>{B(!1),v({...n,policy:void 0}),Q({name:"",rules:'path "*" { capabilities = ["read"] }'})},children:"Cancel"}),e.jsx(m,{onClick:Fe,children:"Create"})]})]})})]}),e.jsx(z,{value:"tokens",className:"space-y-4",children:e.jsxs(i,{children:[e.jsx(c,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(r,{children:"Active Tokens"}),e.jsx(I,{children:"Manage authentication tokens"})]})})}),e.jsx(d,{children:b?e.jsx("div",{className:"space-y-4",children:b.getActiveTokens().length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No active tokens"}):b.getActiveTokens().map(s=>e.jsxs(i,{className:"border-l-4 border-l-blue-500",children:[e.jsx(c,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs(r,{className:"text-base font-mono text-sm",children:[s.token.substring(0,20),"..."]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(w,{variant:"outline",children:[s.policies.length," policies"]}),e.jsx(w,{variant:s.renewable?"default":"outline",children:s.renewable?"Renewable":"Non-renewable"})]})]})})}),e.jsx(d,{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"}),e.jsx("span",{className:"ml-2",children:new Date(s.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Expires:"}),e.jsx("span",{className:"ml-2",children:new Date(s.expiresAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"TTL:"}),e.jsxs("span",{className:"ml-2",children:[Math.floor((s.expiresAt-Date.now())/1e3/60)," minutes"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Policies:"}),e.jsx("span",{className:"ml-2",children:s.policies.join(", ")})]})]})})]},s.id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Vault engine not initialized"})})]})}),e.jsx(z,{value:"audit",className:"space-y-4",children:e.jsxs(i,{children:[e.jsx(c,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(r,{children:"Audit Log"}),e.jsx(I,{children:"View operation history and audit trail"})]})})}),e.jsx(d,{children:j?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Read Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:j.readRequestsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Write Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:j.writeRequestsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Delete Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:j.deleteRequestsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Auth Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:j.authRequestsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Encryption Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:j.encryptionOperationsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Decryption Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:j.decryptionOperationsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Auth Errors"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold text-destructive",children:j.authErrorsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Tokens Issued"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:j.tokenIssuedTotal})})]})]})}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No audit data available"})})]})}),e.jsx(z,{value:"settings",className:"space-y-4",children:e.jsxs(i,{children:[e.jsxs(c,{children:[e.jsx(r,{children:"Vault Settings"}),e.jsx(I,{children:"General vault configuration"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Vault Type"}),e.jsxs(A,{value:te,onValueChange:s=>x({vaultType:s}),children:[e.jsx(P,{children:e.jsx(D,{})}),e.jsxs(L,{children:[e.jsx(t,{value:"hashicorp",children:"HashiCorp Vault"}),e.jsx(t,{value:"aws",children:"AWS Secrets Manager"}),e.jsx(t,{value:"azure",children:"Azure Key Vault"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Vault Address"}),e.jsx(g,{value:pe,onChange:s=>x({address:s.target.value}),placeholder:"http://vault:8200"})]}),e.jsx(Y,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable TLS"}),e.jsx(V,{checked:ve,onCheckedChange:s=>x({enableTLS:s})})]}),e.jsx(Y,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable KV Store"}),e.jsx(V,{checked:ie,onCheckedChange:s=>x({enableKV:s})})]}),ie&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"KV Version"}),e.jsxs(A,{value:Ne,onValueChange:s=>x({kvVersion:s}),children:[e.jsx(P,{children:e.jsx(D,{})}),e.jsxs(L,{children:[e.jsx(t,{value:"1",children:"Version 1"}),e.jsx(t,{value:"2",children:"Version 2"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable Transit"}),e.jsx(V,{checked:ge,onCheckedChange:s=>x({enableTransit:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable PKI"}),e.jsx(V,{checked:fe,onCheckedChange:s=>x({enablePKI:s})})]})]}),e.jsx(Y,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable Authentication"}),e.jsx(V,{checked:ce,onCheckedChange:s=>x({enableAuth:s})})]}),ce&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Auth Method"}),e.jsxs(A,{value:ye,onValueChange:s=>x({authMethod:s}),children:[e.jsx(P,{children:e.jsx(D,{})}),e.jsxs(L,{children:[e.jsx(t,{value:"token",children:"Token"}),e.jsx(t,{value:"approle",children:"AppRole"}),e.jsx(t,{value:"ldap",children:"LDAP"}),e.jsx(t,{value:"aws",children:"AWS"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Token TTL"}),e.jsx(g,{value:be,onChange:s=>x({tokenTTL:s.target.value}),placeholder:"24h"})]})]})]})]})})]})]})})}export{bs as SecretsVaultConfigAdvanced};

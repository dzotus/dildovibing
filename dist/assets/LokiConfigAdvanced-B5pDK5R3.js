import{u as z,j as e,F as x,B as v,i as h,c as N,S as T,T as k,a as E,b as j,K as Q,d as u,C as i,e as t,f as n,h as c,P as q,k as g,m as B,L as R,I as U}from"./index-CHKNZn98.js";function F({componentId:p}){const{nodes:f,updateNode:b}=z(),o=f.find(s=>s.id===p);if(!o)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const a=o.data.config||{},y=a.serverUrl||"http://loki:3100",l=a.streams||[{name:"app-logs",labels:{app:"web",env:"prod"},entries:125e4,size:2.5,lastEntry:"2s ago"},{name:"error-logs",labels:{level:"error",app:"api"},entries:45e3,size:.8,lastEntry:"5s ago"},{name:"access-logs",labels:{type:"access",app:"nginx"},entries:89e4,size:1.8,lastEntry:"1s ago"}],w=a.queries||[{id:"1",query:'{app="web"} |= "error"',duration:125,results:1250},{id:"2",query:'rate({level="error"}[5m])',duration:89,results:45}];a.totalEntries||l.reduce((s,r)=>s+r.entries,0),a.totalSize||l.reduce((s,r)=>s+r.size,0),a.ingestionRate,a.queryLatency;const m=s=>{b(p,{data:{...o.data,config:{...a,...s}}})},L=()=>{m({streams:[...l,{name:"new-stream",labels:{app:"new"},entries:0,size:0}]})},S=s=>{m({streams:l.filter((r,d)=>d!==s)})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-500/10",children:e.jsx(x,{className:"h-6 w-6 text-green-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Loki"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Log Aggregation System"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(v,{variant:"outline",className:"gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500 animate-pulse"}),"Running"]}),e.jsxs(h,{size:"sm",variant:"outline",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Query"]})]})]}),e.jsx(T,{}),e.jsxs(k,{defaultValue:"streams",className:"w-full",children:[e.jsxs(E,{className:"grid w-full grid-cols-3",children:[e.jsxs(j,{value:"streams",className:"gap-2",children:[e.jsx(x,{className:"h-4 w-4"}),"Log Streams"]}),e.jsxs(j,{value:"queries",className:"gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Queries"]}),e.jsxs(j,{value:"settings",className:"gap-2",children:[e.jsx(N,{className:"h-4 w-4"}),"Settings"]})]}),e.jsx(u,{value:"streams",className:"space-y-4 mt-4",children:e.jsxs(i,{children:[e.jsx(t,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Log Streams"}),e.jsx(c,{children:"Log stream configuration and labels"})]}),e.jsxs(h,{size:"sm",onClick:L,variant:"outline",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Add Stream"]})]})}),e.jsx(g,{children:e.jsx("div",{className:"space-y-3",children:l.map((s,r)=>e.jsx(i,{className:"border-border",children:e.jsx(t,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(x,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(n,{className:"text-lg",children:s.name}),e.jsxs(c,{className:"text-xs mt-1",children:[s.entries.toLocaleString()," entries • ",s.size," GB",s.lastEntry&&` • Last: ${s.lastEntry}`]}),e.jsx("div",{className:"flex gap-1 mt-1",children:Object.entries(s.labels).map(([d,C])=>e.jsxs(v,{variant:"outline",className:"text-xs",children:[d,"=",C]},d))})]})]}),l.length>1&&e.jsx(h,{size:"icon",variant:"ghost",onClick:()=>S(r),children:e.jsx(B,{className:"h-4 w-4"})})]})})},r))})})]})}),e.jsx(u,{value:"queries",className:"space-y-4 mt-4",children:e.jsxs(i,{children:[e.jsxs(t,{children:[e.jsx(n,{children:"LogQL Queries"}),e.jsx(c,{children:"Query log streams with LogQL"})]}),e.jsx(g,{children:e.jsx("div",{className:"space-y-3",children:w.map(s=>e.jsx(i,{className:"border-border",children:e.jsx(t,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx(n,{className:"text-sm font-mono",children:s.query}),e.jsxs(c,{className:"text-xs mt-1",children:[s.results," results • ",s.duration,"ms"]})]})})})},s.id))})})]})}),e.jsx(u,{value:"settings",className:"space-y-4 mt-4",children:e.jsxs(i,{children:[e.jsxs(t,{children:[e.jsx(n,{children:"Loki Server"}),e.jsx(c,{children:"Server configuration"})]}),e.jsx(g,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"server-url",children:"Server URL"}),e.jsx(U,{id:"server-url",value:y,onChange:s=>m({serverUrl:s.target.value}),placeholder:"http://loki:3100"})]})})]})})]})]})})}export{F as LokiConfigAdvanced};

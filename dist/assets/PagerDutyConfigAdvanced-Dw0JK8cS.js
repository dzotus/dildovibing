import{E as F,u as G,j as e,r as w,i as h,S as Q,C as l,e as n,f as c,k as t,T as W,a as X,b as g,a2 as Y,c as Z,d as p,h as f,B as v,P,m as k,L as u,I as C,n as T,o as A,p as R,q as D,s as N,t as ee}from"./index-DnHhyaNM.js";import{R as se}from"./refresh-ccw-Bw4u_-k5.js";import{U as ae}from"./users-DsXewXFX.js";const le=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],te=F("bell",le);function he({componentId:S}){const{nodes:E,updateNode:z}=G(),y=E.find(s=>s.id===S);if(!y)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const r=y.data.config||{},d=r.services||[{id:"1",name:"archiphoenix-service",integrationKey:"integration-key-123",status:"active",escalationPolicy:"default-policy",autoResolve:!0,resolveTimeout:300,incidentCount:0}],o=r.incidents||[{id:"1",title:"High CPU usage detected",service:"archiphoenix-service",status:"triggered",severity:"critical",createdAt:new Date().toISOString()}],m=r.escalationPolicies||[{id:"1",name:"default-policy",levels:[{level:1,timeout:5,targets:["user1"]},{level:2,timeout:15,targets:["user2"]}]}],M=r.onCallUsers||[{id:"1",name:"John Doe",email:"john@example.com",status:"on-call"},{id:"2",name:"Jane Smith",email:"jane@example.com",status:"off-call"}],O=r.totalIncidents||o.length,I=r.activeIncidents||o.filter(s=>s.status!=="resolved").length,L=r.resolvedIncidents||o.filter(s=>s.status==="resolved").length,[ie,ne]=w.useState(null),[ce,K]=w.useState(!1),[re,U]=w.useState(!1),x=s=>{z(S,{data:{...y.data,config:{...r,...s}}})},B=()=>{const s={id:`service-${Date.now()}`,name:"new-service",integrationKey:"",status:"active",autoResolve:!0,resolveTimeout:300,incidentCount:0};x({services:[...d,s]}),K(!1)},V=s=>{x({services:d.filter(a=>a.id!==s)})},j=(s,a,i)=>{const q=d.map(b=>b.id===s?{...b,[a]:i}:b);x({services:q})},$=s=>{const a=o.map(i=>i.id===s?{...i,status:"acknowledged",acknowledgedAt:new Date().toISOString()}:i);x({incidents:a})},H=s=>{const a=o.map(i=>i.id===s?{...i,status:"resolved",resolvedAt:new Date().toISOString()}:i);x({incidents:a})},J=()=>{const s={id:`policy-${Date.now()}`,name:"new-policy",levels:[{level:1,timeout:5,targets:[]}]};x({escalationPolicies:[...m,s]}),U(!1)},_=s=>{x({escalationPolicies:m.filter(a=>a.id!==s)})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"PagerDuty"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Incident Management"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage incidents, services, escalation policies and on-call schedules"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(h,{variant:"outline",size:"sm",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(Q,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(l,{children:[e.jsx(n,{className:"pb-3",children:e.jsx(c,{className:"text-sm font-medium",children:"Total Incidents"})}),e.jsx(t,{children:e.jsx("span",{className:"text-2xl font-bold",children:O})})]}),e.jsxs(l,{children:[e.jsx(n,{className:"pb-3",children:e.jsx(c,{className:"text-sm font-medium",children:"Active"})}),e.jsx(t,{children:e.jsx("span",{className:"text-2xl font-bold text-red-500",children:I})})]}),e.jsxs(l,{children:[e.jsx(n,{className:"pb-3",children:e.jsx(c,{className:"text-sm font-medium",children:"Resolved"})}),e.jsx(t,{children:e.jsx("span",{className:"text-2xl font-bold text-green-500",children:L})})]}),e.jsxs(l,{children:[e.jsx(n,{className:"pb-3",children:e.jsx(c,{className:"text-sm font-medium",children:"Services"})}),e.jsx(t,{children:e.jsx("span",{className:"text-2xl font-bold",children:d.length})})]})]}),e.jsxs(W,{defaultValue:"incidents",className:"space-y-4",children:[e.jsxs(X,{children:[e.jsxs(g,{value:"incidents",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Incidents (",I,")"]}),e.jsxs(g,{value:"services",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Services (",d.length,")"]}),e.jsxs(g,{value:"policies",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Escalation Policies (",m.length,")"]}),e.jsxs(g,{value:"oncall",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"On-Call"]})]}),e.jsx(p,{value:"incidents",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(n,{children:[e.jsx(c,{children:"Incidents"}),e.jsx(f,{children:"Manage and respond to incidents"})]}),e.jsx(t,{children:o.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No incidents"}):e.jsx("div",{className:"space-y-2",children:o.map(s=>e.jsx(l,{className:`border-l-4 ${s.severity==="critical"?"border-l-red-500":s.severity==="error"?"border-l-orange-500":s.severity==="warning"?"border-l-yellow-500":"border-l-blue-500"}`,children:e.jsx(t,{className:"pt-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(v,{variant:s.status==="resolved"?"default":s.status==="acknowledged"?"secondary":"destructive",children:s.status}),e.jsx(v,{variant:s.severity==="critical"?"destructive":s.severity==="error"?"default":"outline",children:s.severity}),e.jsx("span",{className:"font-medium",children:s.title})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Service: ",s.service]}),e.jsxs("p",{children:["Created: ",new Date(s.createdAt).toLocaleString()]}),s.assignedTo&&e.jsxs("p",{children:["Assigned to: ",s.assignedTo]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.status==="triggered"&&e.jsx(h,{size:"sm",variant:"outline",onClick:()=>$(s.id),children:"Acknowledge"}),s.status!=="resolved"&&e.jsx(h,{size:"sm",variant:"default",onClick:()=>H(s.id),children:"Resolve"})]})]})})},s.id))})})]})}),e.jsx(p,{value:"services",className:"space-y-4",children:e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Services"}),e.jsx(f,{children:"Configure monitored services"})]}),e.jsxs(h,{onClick:B,size:"sm",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Create Service"]})]})}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:d.map(s=>e.jsxs(l,{className:"border-l-4 border-l-blue-500",children:[e.jsx(n,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-base",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(v,{variant:s.status==="active"?"default":s.status==="maintenance"?"secondary":"outline",children:s.status}),e.jsxs(v,{variant:"outline",children:[s.incidentCount||0," incidents"]})]})]}),e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>V(s.id),disabled:d.length===1,children:e.jsx(k,{className:"h-4 w-4"})})]})}),e.jsx(t,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Service Name"}),e.jsx(C,{value:s.name,onChange:a=>j(s.id,"name",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Integration Key"}),e.jsx(C,{value:s.integrationKey,onChange:a=>j(s.id,"integrationKey",a.target.value),placeholder:"integration-key"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Status"}),e.jsxs(T,{value:s.status,onValueChange:a=>j(s.id,"status",a),children:[e.jsx(A,{children:e.jsx(R,{})}),e.jsxs(D,{children:[e.jsx(N,{value:"active",children:"Active"}),e.jsx(N,{value:"maintenance",children:"Maintenance"}),e.jsx(N,{value:"disabled",children:"Disabled"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Escalation Policy"}),e.jsxs(T,{value:s.escalationPolicy||"",onValueChange:a=>j(s.id,"escalationPolicy",a),children:[e.jsx(A,{children:e.jsx(R,{})}),e.jsx(D,{children:m.map(a=>e.jsx(N,{value:a.name,children:a.name},a.id))})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{children:"Auto Resolve"}),e.jsx(ee,{checked:s.autoResolve??!0,onCheckedChange:a=>j(s.id,"autoResolve",a)})]}),s.autoResolve&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{children:"Resolve Timeout (seconds)"}),e.jsx(C,{type:"number",value:s.resolveTimeout||300,onChange:a=>j(s.id,"resolveTimeout",Number(a.target.value)),min:60})]})]})})]},s.id))})})]})}),e.jsx(p,{value:"policies",className:"space-y-4",children:e.jsxs(l,{children:[e.jsx(n,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(c,{children:"Escalation Policies"}),e.jsx(f,{children:"Configure incident escalation rules"})]}),e.jsxs(h,{onClick:J,size:"sm",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]})}),e.jsx(t,{children:e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsxs(l,{className:"border-l-4 border-l-green-500",children:[e.jsx(n,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-base",children:s.name}),e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>_(s.id),disabled:m.length===1,children:e.jsx(k,{className:"h-4 w-4"})})]})}),e.jsx(t,{children:e.jsx("div",{className:"space-y-2",children:s.levels.map((a,i)=>e.jsx(l,{className:"p-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Level ",a.level]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Timeout: ",a.timeout," min â€¢ Targets: ",a.targets.length]})]})})},i))})})]},s.id))})})]})}),e.jsx(p,{value:"oncall",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(n,{children:[e.jsx(c,{children:"On-Call Schedule"}),e.jsx(f,{children:"Manage on-call users and schedules"})]}),e.jsx(t,{children:e.jsx("div",{className:"space-y-2",children:M.map(s=>e.jsx(l,{className:"border-l-4 border-l-purple-500",children:e.jsx(t,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.email})]}),e.jsx(v,{variant:s.status==="on-call"?"default":"outline",children:s.status==="on-call"?"On-Call":"Off-Call"})]})})},s.id))})})]})})]})]})})}export{he as PagerDutyConfigAdvanced};

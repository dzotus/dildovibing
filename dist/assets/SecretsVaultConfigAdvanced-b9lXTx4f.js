import{E as he,u as oe,j as e,r as N,i as j,S as V,C as r,e as d,f as h,k as o,B as u,T as xe,a as je,b as E,c as me,d as P,h as I,P as D,M as ue,Q as ve,m as L,L as l,I as v,t as p,n as y,o as S,p as C,q as w,s as i}from"./index-DnHhyaNM.js";import{T as pe}from"./textarea-DTiKCdOr.js";import{R as ge}from"./refresh-ccw-Bw4u_-k5.js";import{K as be}from"./key-BJaVblTT.js";import{D as fe}from"./database-SBDMIIdt.js";import{S as Ne}from"./shield-DvdnOHbO.js";import{C as ye}from"./circle-check-big-KHCYDcI-.js";const Se=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Ce=he("eye-off",Se);function Me({componentId:z}){const{nodes:H,updateNode:W}=oe(),K=H.find(s=>s.id===z);if(!K)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const c=K.data.config||{},M=c.vaultType||"hashicorp",$=c.address||"http://vault:8200",_=c.enableTLS??!1,q=c.enableTransit??!0,O=c.enableKV??!0,G=c.kvVersion||"2",Q=c.enablePKI??!1,R=c.enableAuth??!0,F=c.authMethod||"token",J=c.tokenTTL||"24h",m=c.secrets||[{id:"1",path:"secret/app/database",key:"password",value:"••••••••",version:1,created:new Date().toISOString(),updated:new Date().toISOString(),visible:!1},{id:"2",path:"secret/app/api",key:"api-key",value:"••••••••",version:1,created:new Date().toISOString(),updated:new Date().toISOString(),visible:!1}],g=c.engines||[{id:"1",name:"secret/",type:"kv",enabled:!0,version:2,description:"Key-Value secrets"},{id:"2",name:"transit/",type:"transit",enabled:!0,description:"Encryption as a service"}],b=c.policies||[{id:"1",name:"admin",rules:'path "*" { capabilities = ["create", "read", "update", "delete", "list"] }',enabled:!0},{id:"2",name:"readonly",rules:'path "*" { capabilities = ["read", "list"] }',enabled:!0}],U=c.totalSecrets||m.length,X=c.enginesEnabled||g.filter(s=>s.enabled).length,[we,ke]=N.useState(null),[Te,Y]=N.useState(!1),[Ve,Z]=N.useState(!1),[Ee,ee]=N.useState(!1),[se,B]=N.useState(null),n=s=>{W(z,{data:{...K.data,config:{...c,...s}}})},ae=()=>{const s={id:`secret-${Date.now()}`,path:"secret/new",key:"new-key",value:"",version:1,created:new Date().toISOString(),updated:new Date().toISOString(),visible:!1};n({secrets:[...m,s]}),Y(!1)},ne=s=>{n({secrets:m.filter(a=>a.id!==s)})},k=(s,a,x)=>{const f=m.map(t=>t.id===s?{...t,[a]:x}:t);n({secrets:f})},le=s=>{const a=m.find(x=>x.id===s);a&&k(s,"visible",!a.visible)},ie=s=>{const a=m.find(x=>x.id===s);a&&(navigator.clipboard.writeText(a.value),B(s),setTimeout(()=>B(null),2e3))},ce=()=>{const s={id:`engine-${Date.now()}`,name:"new-engine/",type:"kv",enabled:!0,version:2};n({engines:[...g,s]}),Z(!1)},te=s=>{n({engines:g.filter(a=>a.id!==s)})},T=(s,a,x)=>{const f=g.map(t=>t.id===s?{...t,[a]:x}:t);n({engines:f})},re=()=>{const s={id:`policy-${Date.now()}`,name:"new-policy",rules:'path "*" { capabilities = ["read"] }',enabled:!0};n({policies:[...b,s]}),ee(!1)},de=s=>{n({policies:b.filter(a=>a.id!==s)})},A=(s,a,x)=>{const f=b.map(t=>t.id===s?{...t,[a]:x}:t);n({policies:f})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Secrets Vault"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Vault Configuration"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Secure storage and management of secrets, API keys, and credentials"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(j,{variant:"outline",size:"sm",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(V,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(r,{children:[e.jsx(d,{className:"pb-3",children:e.jsx(h,{className:"text-sm font-medium",children:"Total Secrets"})}),e.jsx(o,{children:e.jsx("span",{className:"text-2xl font-bold",children:U})})]}),e.jsxs(r,{children:[e.jsx(d,{className:"pb-3",children:e.jsx(h,{className:"text-sm font-medium",children:"Engines Enabled"})}),e.jsx(o,{children:e.jsx("span",{className:"text-2xl font-bold",children:X})})]}),e.jsxs(r,{children:[e.jsx(d,{className:"pb-3",children:e.jsx(h,{className:"text-sm font-medium",children:"Policies"})}),e.jsx(o,{children:e.jsx("span",{className:"text-2xl font-bold",children:b.length})})]}),e.jsxs(r,{children:[e.jsx(d,{className:"pb-3",children:e.jsx(h,{className:"text-sm font-medium",children:"Vault Type"})}),e.jsx(o,{children:e.jsx(u,{variant:"outline",children:M})})]})]}),e.jsxs(xe,{defaultValue:"secrets",className:"space-y-4",children:[e.jsxs(je,{children:[e.jsxs(E,{value:"secrets",children:[e.jsx(be,{className:"h-4 w-4 mr-2"}),"Secrets (",m.length,")"]}),e.jsxs(E,{value:"engines",children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Secret Engines (",g.length,")"]}),e.jsxs(E,{value:"policies",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Policies (",b.length,")"]}),e.jsxs(E,{value:"settings",children:[e.jsx(me,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(P,{value:"secrets",className:"space-y-4",children:e.jsxs(r,{children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{children:"Secrets"}),e.jsx(I,{children:"Manage stored secrets and credentials"})]}),e.jsxs(j,{onClick:ae,size:"sm",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Create Secret"]})]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsxs(r,{className:"border-l-4 border-l-green-500",children:[e.jsx(d,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{className:"text-base",children:s.path}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(u,{variant:"outline",children:s.key}),e.jsxs(u,{variant:"outline",children:["v",s.version]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>le(s.id),children:s.visible?e.jsx(Ce,{className:"h-4 w-4"}):e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>ie(s.id),children:se===s.id?e.jsx(ye,{className:"h-4 w-4 text-green-500"}):e.jsx(ve,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>ne(s.id),children:e.jsx(L,{className:"h-4 w-4"})})]})]})}),e.jsx(o,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Path"}),e.jsx(v,{value:s.path,onChange:a=>k(s.id,"path",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Key"}),e.jsx(v,{value:s.key,onChange:a=>k(s.id,"key",a.target.value)})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(l,{children:"Value"}),e.jsx(v,{type:s.visible?"text":"password",value:s.value,onChange:a=>k(s.id,"value",a.target.value),placeholder:"Enter secret value"})]})]})})]},s.id))})})]})}),e.jsx(P,{value:"engines",className:"space-y-4",children:e.jsxs(r,{children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{children:"Secret Engines"}),e.jsx(I,{children:"Configure secret storage engines"})]}),e.jsxs(j,{onClick:ce,size:"sm",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Enable Engine"]})]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:g.map(s=>e.jsxs(r,{className:"border-l-4 border-l-blue-500",children:[e.jsx(d,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{className:"text-base",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(u,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"}),e.jsx(u,{variant:"outline",children:s.type}),s.version&&e.jsxs(u,{variant:"outline",children:["v",s.version]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{checked:s.enabled,onCheckedChange:a=>T(s.id,"enabled",a)}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>te(s.id),children:e.jsx(L,{className:"h-4 w-4"})})]})]})}),e.jsx(o,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Engine Name"}),e.jsx(v,{value:s.name,onChange:a=>T(s.id,"name",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Engine Type"}),e.jsxs(y,{value:s.type,onValueChange:a=>T(s.id,"type",a),children:[e.jsx(S,{children:e.jsx(C,{})}),e.jsxs(w,{children:[e.jsx(i,{value:"kv",children:"Key-Value (KV)"}),e.jsx(i,{value:"transit",children:"Transit"}),e.jsx(i,{value:"pki",children:"PKI"}),e.jsx(i,{value:"database",children:"Database"}),e.jsx(i,{value:"aws",children:"AWS"}),e.jsx(i,{value:"azure",children:"Azure"})]})]})]}),s.type==="kv"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"KV Version"}),e.jsxs(y,{value:s.version?.toString()||"2",onValueChange:a=>T(s.id,"version",Number(a)),children:[e.jsx(S,{children:e.jsx(C,{})}),e.jsxs(w,{children:[e.jsx(i,{value:"1",children:"Version 1"}),e.jsx(i,{value:"2",children:"Version 2"})]})]})]})]})})]},s.id))})})]})}),e.jsx(P,{value:"policies",className:"space-y-4",children:e.jsxs(r,{children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{children:"Access Policies"}),e.jsx(I,{children:"Configure access control policies"})]}),e.jsxs(j,{onClick:re,size:"sm",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:b.map(s=>e.jsxs(r,{className:"border-l-4 border-l-purple-500",children:[e.jsx(d,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{className:"text-base",children:s.name}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsx(u,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{checked:s.enabled,onCheckedChange:a=>A(s.id,"enabled",a)}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>de(s.id),children:e.jsx(L,{className:"h-4 w-4"})})]})]})}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Policy Name"}),e.jsx(v,{value:s.name,onChange:a=>A(s.id,"name",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Policy Rules (HCL)"}),e.jsx(pe,{value:s.rules,onChange:a=>A(s.id,"rules",a.target.value),rows:6,className:"font-mono text-sm"})]})]})]},s.id))})})]})}),e.jsx(P,{value:"settings",className:"space-y-4",children:e.jsxs(r,{children:[e.jsxs(d,{children:[e.jsx(h,{children:"Vault Settings"}),e.jsx(I,{children:"General vault configuration"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Vault Type"}),e.jsxs(y,{value:M,onValueChange:s=>n({vaultType:s}),children:[e.jsx(S,{children:e.jsx(C,{})}),e.jsxs(w,{children:[e.jsx(i,{value:"hashicorp",children:"HashiCorp Vault"}),e.jsx(i,{value:"aws",children:"AWS Secrets Manager"}),e.jsx(i,{value:"azure",children:"Azure Key Vault"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Vault Address"}),e.jsx(v,{value:$,onChange:s=>n({address:s.target.value}),placeholder:"http://vault:8200"})]}),e.jsx(V,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable TLS"}),e.jsx(p,{checked:_,onCheckedChange:s=>n({enableTLS:s})})]}),e.jsx(V,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable KV Store"}),e.jsx(p,{checked:O,onCheckedChange:s=>n({enableKV:s})})]}),O&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"KV Version"}),e.jsxs(y,{value:G,onValueChange:s=>n({kvVersion:s}),children:[e.jsx(S,{children:e.jsx(C,{})}),e.jsxs(w,{children:[e.jsx(i,{value:"1",children:"Version 1"}),e.jsx(i,{value:"2",children:"Version 2"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable Transit"}),e.jsx(p,{checked:q,onCheckedChange:s=>n({enableTransit:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable PKI"}),e.jsx(p,{checked:Q,onCheckedChange:s=>n({enablePKI:s})})]})]}),e.jsx(V,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Enable Authentication"}),e.jsx(p,{checked:R,onCheckedChange:s=>n({enableAuth:s})})]}),R&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Auth Method"}),e.jsxs(y,{value:F,onValueChange:s=>n({authMethod:s}),children:[e.jsx(S,{children:e.jsx(C,{})}),e.jsxs(w,{children:[e.jsx(i,{value:"token",children:"Token"}),e.jsx(i,{value:"approle",children:"AppRole"}),e.jsx(i,{value:"ldap",children:"LDAP"}),e.jsx(i,{value:"aws",children:"AWS"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Token TTL"}),e.jsx(v,{value:J,onChange:s=>n({tokenTTL:s.target.value}),placeholder:"24h"})]})]})]})]})})]})]})})}export{Me as SecretsVaultConfigAdvanced};

import{u as vs,a as ys,j as e,r as h,e as ze,l as m,S as A,am as U,C as p,h as N,i as v,m as j,T as bs,b as Cs,c as Q,d as ws,W as Ss,f as M,k as T,L as l,I as n,q as ue,s as xe,t as he,v as pe,w as y,x as Ee,P as je,O as X,B as J,_ as ge,o as fe,D as Re,y as Ue,z as Be,E as $e,G as Ie,n as Oe,H as We}from"./index-CwK32Mz8.js";import{P as Y}from"./progress-CUxBxdH0.js";import{A as B,b as $,a as I}from"./alert-CDD0Q9Rv.js";import{a as F}from"./toast-DfLGesnc.js";import{R as Ts}from"./refresh-ccw-D-s9mPLx.js";import{M as Ve}from"./message-square-19feBYZT.js";import{D as _e}from"./database-Cu0THndJ.js";import{U as Ls}from"./users-BpuogKws.js";import{S as ks}from"./shield-iBzfi9_i.js";import{P as Ne}from"./pen-IVdrgzOT.js";function $s({componentId:O}){const{nodes:ee,updateNode:Ge,connections:ve}=vs(),{isRunning:ye,start:qs,stop:As,updateMetrics:He}=ys(),L=ee.find(s=>s.id===O);if(!L)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const o=L.data.config||{},be=o.brokerName||"localhost",Ke=o.brokerUrl||"tcp://localhost:61616",Ze=o.protocol||"openwire",Xe=o.port||61616,Je=o.username||"admin",Ye=o.password||"admin",u=o.queues||[],g=o.topics||[],P=o.connections||[],w=o.subscriptions||[],es=o.persistenceEnabled??!0,ss=o.maxConnections||1e3,se=o.memoryLimit||1024,Ce=o.consumptionRate??10,we=o.storeUsage||0,Se=o.tempUsage||0,ts=o.avgMessageSize??1024,Te=o.protocolLatencies||{openwire:2,amqp:5,mqtt:8,stomp:10,ws:12},rs=o.memoryPressureThreshold??.8,as=o.queueLatencyBase??0,ns=o.queueLatencyFactor??1,W=o.acls||[],[Le,te]=h.useState(!1),[x,k]=h.useState({principal:"",resource:"",operation:"read",permission:"allow"});h.useEffect(()=>{if(!L)return;const s=ze.getActiveMQRoutingEngine(O);if(!s)return;const r=L.data.config||{};s.initialize({queues:r.queues||[],topics:r.topics||[],subscriptions:r.subscriptions||[],consumptionRate:r.consumptionRate??10}),ze.updateNodesAndConnections(ee,ve)},[O,u.length,g.length,Ce,L?.id,ee,ve]);const c=s=>{Ge(O,{data:{...L.data,config:{...o,...s}}})},ls=()=>{const s=`queue-${Date.now()}`;c({queues:[...u,{name:s,queueSize:0,consumerCount:0,enqueueCount:0,dequeueCount:0,memoryUsage:0,memoryPercent:0}]}),F("Queue added successfully")},is=s=>!s||s.trim()===""?"Queue name cannot be empty":s.length>255?"Queue name cannot exceed 255 characters":/^[a-zA-Z0-9._-]+$/.test(s)?s.startsWith(".")||s.endsWith(".")?"Queue name cannot start or end with a dot":null:"Queue name can only contain letters, numbers, dots, underscores, and hyphens",D=(s,r,t)=>{if(r==="name"){const i=is(t);if(i){re({...b,[s]:i});return}else{const f={...b};delete f[s],re(f)}}const a=[...u];a[s]={...a[s],[r]:t},c({queues:a})},[ke,z]=h.useState(null),[b,re]=h.useState({}),cs=()=>{const s=`topic-${Date.now()}`;c({topics:[...g,{name:s,subscriberCount:0,enqueueCount:0,dequeueCount:0,memoryUsage:0,memoryPercent:0}]}),F("Topic added successfully")},os=s=>!s||s.trim()===""?"Topic name cannot be empty":s.length>255?"Topic name cannot exceed 255 characters":/^[a-zA-Z0-9._-]+$/.test(s)?s.startsWith(".")||s.endsWith(".")?"Topic name cannot start or end with a dot":null:"Topic name can only contain letters, numbers, dots, underscores, and hyphens",V=(s,r,t)=>{if(r==="name"){const i=os(t);if(i){ae({...C,[s]:i});return}else{const f={...C};delete f[s],ae(f)}}const a=[...g];a[s]={...a[s],[r]:t},c({topics:a})},[qe,E]=h.useState(null),[C,ae]=h.useState({}),[ne,ds]=h.useState(""),[le,ms]=h.useState(""),[_,us]=h.useState(""),[G,xs]=h.useState(""),[S,H]=h.useState(null),[q,K]=h.useState(null),[ie,ce]=h.useState(null),[hs,Z]=h.useState(null),[R,oe]=h.useState({}),Ae=u.filter(s=>s.name.toLowerCase().includes(ne.toLowerCase())),Qe=g.filter(s=>s.name.toLowerCase().includes(le.toLowerCase())),de=P.filter(s=>(s.clientId||"").toLowerCase().includes(_.toLowerCase())||(s.remoteAddress||"").toLowerCase().includes(_.toLowerCase())),me=w.filter(s=>(s.clientId||"").toLowerCase().includes(G.toLowerCase())||(s.destination||"").toLowerCase().includes(G.toLowerCase())),Me=s=>{if(!s||s.trim()==="")return"Resource cannot be empty";if(s==="*")return null;if(!s.includes("://"))return"Resource must be in format queue://name or topic://name (or use * for all)";const[r,t]=s.split("://");return r!=="queue"&&r!=="topic"?'Resource prefix must be "queue" or "topic"':!t||t.trim()===""?"Resource name cannot be empty":t!=="*"&&!/^[a-zA-Z0-9._*-]+$/.test(t)?"Resource name can only contain letters, numbers, dots, underscores, hyphens, and asterisks":null},ps=()=>{const s=Me(x.resource);if(s){ce(s);return}if(ce(null),!x.principal||!x.resource)return;const r={principal:x.principal,resource:x.resource,operation:x.operation,permission:x.permission};c({acls:[...W,r]}),te(!1),F("ACL rule added successfully"),k({principal:"",resource:"",operation:"read",permission:"allow"})},js=s=>{c({acls:W.filter((r,t)=>t!==s)}),F("ACL rule removed successfully")},gs=s=>{const r=u[s];r&&(r.queueSize||0)>0?H(s):Fe(s)},Fe=s=>{c({queues:u.filter((r,t)=>t!==s)}),H(null),F("Queue removed successfully")},fs=s=>{const r=g[s];w.some(a=>a.destination===r.name)?K(s):Pe(s)},Pe=s=>{c({topics:g.filter((r,t)=>t!==s)}),K(null),F("Topic removed successfully")},Ns=u.reduce((s,r)=>s+(r.queueSize||0),0);return u.reduce((s,r)=>s+(r.consumerCount||0),0),g.reduce((s,r)=>s+(r.subscriberCount||0),0),e.jsxs("div",{className:"h-full overflow-y-auto bg-background",children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"ActiveMQ Broker"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Broker Management"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure ActiveMQ broker, queues, topics, connections and security"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>He(),title:"Manually refresh broker metrics (metrics update automatically during simulation)",children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Refresh Metrics"]})})]}),e.jsx(A,{}),u.length===0&&g.length===0&&e.jsxs(B,{children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx($,{children:"Getting Started"}),e.jsxs(I,{className:"space-y-2 mt-2",children:[e.jsx("p",{children:"To start using ActiveMQ broker, follow these steps:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[e.jsxs("li",{children:["Configure at least one ",e.jsx("strong",{children:"Queue"})," or ",e.jsx("strong",{children:"Topic"})," in the tabs below"]}),e.jsx("li",{children:"Connect other components (producers/consumers) to this broker"}),e.jsx("li",{children:"Start the simulation from the Emulation Panel to see metrics"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[e.jsx("strong",{children:"Note:"})," Queues and Topics are configuration - they define what destinations are available. Connections and Subscriptions are created automatically by clients at runtime."]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(p,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(v,{className:"text-sm font-medium",children:"Broker Status"})}),e.jsxs(j,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${ye?"bg-green-500":"bg-gray-500"}`}),e.jsx("span",{className:"text-lg font-semibold",children:ye?"Running":"Stopped"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:be})]})]}),e.jsxs(p,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(v,{className:"text-sm font-medium",children:"Total Messages"})}),e.jsxs(j,{children:[e.jsx("span",{className:"text-2xl font-bold",children:Ns.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Across all queues"})]})]}),e.jsxs(p,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(v,{className:"text-sm font-medium",children:"Active Connections"})}),e.jsxs(j,{children:[e.jsx("span",{className:"text-2xl font-bold",children:P.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Connected clients"})]})]}),e.jsxs(p,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(v,{className:"text-sm font-medium",children:"Memory Usage"})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("span",{children:["Store: ",we," MB"]}),e.jsxs("span",{children:["Temp: ",Se," MB"]})]}),e.jsx(Y,{value:(we+Se)/se*100,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Limit: ",se," MB"]})]})})]})]}),e.jsxs(bs,{defaultValue:"broker",className:"space-y-4",children:[e.jsxs(Cs,{className:"flex w-full flex-wrap gap-1",children:[e.jsxs(Q,{value:"broker",className:"gap-2",children:[e.jsx(ws,{className:"h-4 w-4"}),"Broker"]}),e.jsxs(Q,{value:"queues",className:"gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Queues (",u.length,")"]}),e.jsxs(Q,{value:"topics",className:"gap-2",children:[e.jsx(_e,{className:"h-4 w-4"}),"Topics (",g.length,")"]}),e.jsxs(Q,{value:"connections",className:"gap-2",children:[e.jsx(Ss,{className:"h-4 w-4"}),"Connections (",P.length,")"]}),e.jsxs(Q,{value:"subscriptions",className:"gap-2",children:[e.jsx(Ls,{className:"h-4 w-4"}),"Subscriptions (",w.length,")"]}),e.jsxs(Q,{value:"security",className:"gap-2",children:[e.jsx(ks,{className:"h-4 w-4"}),"Security"]})]}),e.jsxs(M,{value:"broker",className:"space-y-4",children:[e.jsxs(B,{className:"mb-4",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx($,{children:"Broker Configuration"}),e.jsx(I,{className:"text-sm",children:"Configure connection settings, protocols, and broker limits. These settings affect how clients connect to the broker and how messages are processed."})]}),e.jsxs(p,{children:[e.jsxs(N,{children:[e.jsx(v,{children:"Broker Configuration"}),e.jsx(T,{children:"Basic broker settings and connection parameters"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"brokerName",children:"Broker Name"}),e.jsx(n,{id:"brokerName",value:be,onChange:s=>c({brokerName:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"brokerUrl",children:"Broker URL"}),e.jsx(n,{id:"brokerUrl",value:Ke,onChange:s=>c({brokerUrl:s.target.value}),placeholder:"tcp://localhost:61616"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"protocol",children:"Protocol"}),e.jsxs(ue,{value:Ze,onValueChange:s=>c({protocol:s}),children:[e.jsx(xe,{children:e.jsx(he,{})}),e.jsxs(pe,{children:[e.jsx(y,{value:"openwire",children:"OpenWire"}),e.jsx(y,{value:"amqp",children:"AMQP"}),e.jsx(y,{value:"mqtt",children:"MQTT"}),e.jsx(y,{value:"stomp",children:"STOMP"}),e.jsx(y,{value:"ws",children:"WebSocket"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"port",children:"Port"}),e.jsx(n,{id:"port",type:"number",value:Xe,onChange:s=>c({port:Number(s.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"username",children:"Username"}),e.jsx(n,{id:"username",value:Je,onChange:s=>c({username:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password",children:"Password"}),e.jsx(n,{id:"password",type:"password",value:Ye,onChange:s=>c({password:s.target.value})})]})]}),e.jsx(A,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"persistenceEnabled",children:"Persistence Enabled"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Persist messages to disk"})]}),e.jsx(Ee,{id:"persistenceEnabled",checked:es,onCheckedChange:s=>c({persistenceEnabled:s})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"maxConnections",children:"Max Connections"}),e.jsx(n,{id:"maxConnections",type:"number",value:ss,onChange:s=>c({maxConnections:Number(s.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"memoryLimit",children:"Memory Limit (MB)"}),e.jsx(n,{id:"memoryLimit",type:"number",value:se,onChange:s=>c({memoryLimit:Number(s.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"consumptionRate",children:"Consumption Rate (msgs/sec per consumer)"}),e.jsx(n,{id:"consumptionRate",type:"number",min:"1",value:Ce,onChange:s=>c({consumptionRate:Number(s.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of messages per second that each consumer can process"})]})]})]}),e.jsx(A,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold",children:"Advanced Performance Settings"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"avgMessageSize",children:"Average Message Size (bytes)"}),e.jsx(n,{id:"avgMessageSize",type:"number",min:"1",value:ts,onChange:s=>c({avgMessageSize:Number(s.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average size of messages in bytes (used for throughput calculation)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"memoryPressureThreshold",children:"Memory Pressure Threshold"}),e.jsx(n,{id:"memoryPressureThreshold",type:"number",min:"0",max:"1",step:"0.1",value:rs,onChange:s=>c({memoryPressureThreshold:Number(s.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Memory usage threshold (0.0-1.0) that triggers additional latency"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"queueLatencyBase",children:"Queue Latency Base (ms)"}),e.jsx(n,{id:"queueLatencyBase",type:"number",min:"0",value:as,onChange:s=>c({queueLatencyBase:Number(s.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Base latency in milliseconds added to queue latency calculation"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"queueLatencyFactor",children:"Queue Latency Factor"}),e.jsx(n,{id:"queueLatencyFactor",type:"number",min:"0",step:"0.1",value:ns,onChange:s=>c({queueLatencyFactor:Number(s.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Factor for calculating latency based on queue depth (ms per 1000 messages)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Protocol Latencies (ms)"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Configure base latency for each protocol"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:["openwire","amqp","mqtt","stomp","ws"].map(s=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:`protocol-${s}`,className:"text-xs capitalize",children:s==="ws"?"WebSocket":s.toUpperCase()}),e.jsx(n,{id:`protocol-${s}`,type:"number",min:"0",value:Te[s]||5,onChange:r=>{const t={...Te};t[s]=Number(r.target.value),c({protocolLatencies:t})}})]},s))})]})]})]})]})]}),e.jsxs(M,{value:"queues",className:"space-y-4",children:[e.jsxs(B,{className:"mb-4",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx($,{children:"Queue Configuration"}),e.jsxs(I,{className:"text-sm space-y-1",children:[e.jsx("p",{children:"Configure queues for point-to-point messaging. Each queue represents a destination where producers send messages and consumers receive them."}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx("strong",{children:"Tip:"})," To send messages to a queue, connect a producer component and specify the queue name in the connection settings."]})]})]}),e.jsxs(p,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(v,{children:"Queues"}),e.jsx(T,{children:"Configure message queues (queues are created dynamically by clients at runtime)"})]}),e.jsxs(m,{onClick:ls,size:"sm",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Add Queue Config"]})]})}),e.jsxs(j,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(n,{placeholder:"Search queues...",value:ne,onChange:s=>ds(s.target.value),className:"pl-9"})]}),ne&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Showing ",Ae.length," of ",u.length," queues"]})]}),e.jsx("div",{className:"space-y-4",children:Ae.map((s,r)=>{const t=u.findIndex(d=>d.name===s.name),a=s.queueSize||0;s.consumerCount;let i="empty",f="bg-gray-500";return a===0?(i="empty",f="bg-gray-500"):a<100?(i="normal",f="bg-green-500"):a<1e3?(i="warning",f="bg-yellow-500"):(i="full",f="bg-red-500"),e.jsxs(p,{className:"border-l-4 border-l-blue-500",children:[e.jsx(N,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(Ve,{className:"h-5 w-5 text-blue-500"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(J,{variant:"outline",className:f,children:i.charAt(0).toUpperCase()+i.slice(1)})}),ke===t?e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{value:s.name,onChange:d=>D(t,"name",d.target.value),placeholder:"queue-name",className:`flex-1 ${b[t]?"border-red-500":""}`,onBlur:()=>{b[t]||z(null)},onKeyDown:d=>{if(d.key==="Enter"&&!b[t]&&z(null),d.key==="Escape"){z(null);const De={...b};delete De[t],re(De)}},autoFocus:!0}),e.jsx(m,{size:"sm",variant:"outline",onClick:()=>{b[t]||z(null)},disabled:!!b[t],children:e.jsx(ge,{className:"h-3 w-3"})})]}),b[t]&&e.jsx("p",{className:"text-xs text-red-500",children:b[t]})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"text-base",children:s.name}),e.jsx(m,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:()=>z(t),children:e.jsx(Ne,{className:"h-3 w-3"})})]})]}),ke!==t&&e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>gs(t),disabled:u.length===1,children:e.jsx(fe,{className:"h-4 w-4"})})]})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-4",children:[a>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Queue Size"}),e.jsxs("span",{className:"font-medium",children:[a," messages"]})]}),e.jsx(Y,{value:Math.min(100,a/1e3*100),className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Queue Size"}),e.jsx("p",{className:"text-lg font-semibold",children:s.queueSize||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Consumers"}),e.jsx("p",{className:"text-lg font-semibold",children:s.consumerCount||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enqueued"}),e.jsx("p",{className:"text-lg font-semibold",children:(s.enqueueCount||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Dequeued"}),e.jsx("p",{className:"text-lg font-semibold",children:(s.dequeueCount||0).toLocaleString()})]})]}),e.jsx(A,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:`queue-memory-limit-${t}`,className:"text-xs",children:"Memory Limit (MB)"}),e.jsx(n,{id:`queue-memory-limit-${t}`,type:"number",min:"0",value:s.memoryLimit||"",onChange:d=>D(t,"memoryLimit",d.target.value?Number(d.target.value):void 0),placeholder:"Unlimited"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum memory usage for this queue (0 = unlimited)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:`queue-prefetch-${t}`,className:"text-xs",children:"Prefetch Size"}),e.jsx(n,{id:`queue-prefetch-${t}`,type:"number",min:"0",value:s.prefetch||"",onChange:d=>D(t,"prefetch",d.target.value?Number(d.target.value):void 0),placeholder:"Default"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of messages to prefetch per consumer (0 = default)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:`queue-priority-${t}`,className:"text-xs",children:"Default Priority (0-9)"}),e.jsx(n,{id:`queue-priority-${t}`,type:"number",min:"0",max:"9",value:s.defaultPriority!==void 0?s.defaultPriority:"",onChange:d=>D(t,"defaultPriority",d.target.value?Number(d.target.value):void 0),placeholder:"Default"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default message priority for this queue (0 = lowest, 9 = highest)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:`queue-ttl-${t}`,className:"text-xs",children:"Default TTL (seconds)"}),e.jsx(n,{id:`queue-ttl-${t}`,type:"number",min:"0",value:s.defaultTTL!==void 0?s.defaultTTL:"",onChange:d=>D(t,"defaultTTL",d.target.value?Number(d.target.value):void 0),placeholder:"Unlimited"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default message time-to-live in seconds (0 = unlimited)"})]})]}),s.memoryUsage!==void 0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{children:"Memory Usage"}),e.jsxs("span",{children:[s.memoryUsage," MB (",s.memoryPercent||0,"%)"]})]}),e.jsx(Y,{value:s.memoryPercent||0,className:"h-2"})]})]})})]},t)})})]})]})]}),e.jsxs(M,{value:"topics",className:"space-y-4",children:[e.jsxs(B,{className:"mb-4",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx($,{children:"Topic Configuration"}),e.jsxs(I,{className:"text-sm space-y-1",children:[e.jsx("p",{children:"Configure topics for publish-subscribe messaging. Publishers send messages to topics, and all subscribers receive copies of the messages."}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx("strong",{children:"Tip:"})," To publish messages, connect a producer component and specify the topic name. Multiple consumers can subscribe to the same topic."]})]})]}),e.jsxs(p,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(v,{children:"Topics"}),e.jsx(T,{children:"Configure publish-subscribe topics (topics are created dynamically by clients at runtime)"})]}),e.jsxs(m,{onClick:cs,size:"sm",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Add Topic Config"]})]})}),e.jsxs(j,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(n,{placeholder:"Search topics...",value:le,onChange:s=>ms(s.target.value),className:"pl-9"})]}),le&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Showing ",Qe.length," of ",g.length," topics"]})]}),e.jsx("div",{className:"space-y-4",children:Qe.map((s,r)=>{const t=g.findIndex(a=>a.name===s.name);return s.subscriberCount,e.jsxs(p,{className:"border-l-4 border-l-green-500",children:[e.jsx(N,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[e.jsx(_e,{className:"h-5 w-5 text-green-500"}),qe===t?e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{value:s.name,onChange:a=>V(t,"name",a.target.value),placeholder:"topic-name",className:`flex-1 ${C[t]?"border-red-500":""}`,onBlur:()=>{C[t]||E(null)},onKeyDown:a=>{if(a.key==="Enter"&&!C[t]&&E(null),a.key==="Escape"){E(null);const i={...C};delete i[t],ae(i)}},autoFocus:!0}),e.jsx(m,{size:"sm",variant:"outline",onClick:()=>{C[t]||E(null)},disabled:!!C[t],children:e.jsx(ge,{className:"h-3 w-3"})})]}),C[t]&&e.jsx("p",{className:"text-xs text-red-500",children:C[t]})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"text-base",children:s.name}),e.jsx(m,{size:"icon",variant:"ghost",className:"h-6 w-6",onClick:()=>E(t),children:e.jsx(Ne,{className:"h-3 w-3"})})]})]}),qe!==t&&e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>fs(t),children:e.jsx(fe,{className:"h-4 w-4"})})]})}),e.jsxs(j,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Subscribers"}),e.jsx("p",{className:"text-lg font-semibold",children:s.subscriberCount||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enqueued"}),e.jsx("p",{className:"text-lg font-semibold",children:(s.enqueueCount||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Dequeued"}),e.jsx("p",{className:"text-lg font-semibold",children:(s.dequeueCount||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Memory"}),e.jsxs("p",{className:"text-lg font-semibold",children:[s.memoryUsage||0," MB"]})]})]}),e.jsx(A,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:`topic-memory-limit-${t}`,className:"text-xs",children:"Memory Limit (MB)"}),e.jsx(n,{id:`topic-memory-limit-${t}`,type:"number",min:"0",value:s.memoryLimit||"",onChange:a=>V(t,"memoryLimit",a.target.value?Number(a.target.value):void 0),placeholder:"Unlimited"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum memory usage for this topic (0 = unlimited)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:`topic-priority-${t}`,className:"text-xs",children:"Default Priority (0-9)"}),e.jsx(n,{id:`topic-priority-${t}`,type:"number",min:"0",max:"9",value:s.defaultPriority!==void 0?s.defaultPriority:"",onChange:a=>V(t,"defaultPriority",a.target.value?Number(a.target.value):void 0),placeholder:"Default"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default message priority for this topic (0 = lowest, 9 = highest)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:`topic-ttl-${t}`,className:"text-xs",children:"Default TTL (seconds)"}),e.jsx(n,{id:`topic-ttl-${t}`,type:"number",min:"0",value:s.defaultTTL!==void 0?s.defaultTTL:"",onChange:a=>V(t,"defaultTTL",a.target.value?Number(a.target.value):void 0),placeholder:"Unlimited"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default message time-to-live in seconds (0 = unlimited)"})]})]}),s.memoryPercent!==void 0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{children:"Memory Usage"}),e.jsxs("span",{children:[s.memoryPercent,"%"]})]}),e.jsx(Y,{value:s.memoryPercent,className:"h-2"})]})]})]},t)})})]})]})]}),e.jsx(M,{value:"connections",className:"space-y-4",children:e.jsxs(p,{children:[e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(v,{children:"Connections"}),e.jsx(T,{children:"Active client connections to the broker (read-only, connections are created by clients)"})]})})}),e.jsxs(j,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(n,{placeholder:"Search connections...",value:_,onChange:s=>us(s.target.value),className:"pl-9"})]}),_&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Showing ",de.length," of ",P.length," connections"]})]}),de.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:P.length===0?"No active connections":"No connections match your search"}):e.jsx("div",{className:"space-y-2",children:de.map(s=>e.jsx(p,{className:"border-l-4 border-l-purple-500",children:e.jsxs(j,{className:"pt-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1 grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Client ID"}),e.jsx("p",{className:"text-sm font-medium",children:s.clientId})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"User"}),e.jsx("p",{className:"text-sm font-medium",children:s.userName||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Protocol"}),e.jsx(J,{variant:"outline",children:s.protocol||"OpenWire"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Messages"}),e.jsx("p",{className:"text-sm font-medium",children:s.messageCount||0})]})]})}),s.remoteAddress&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Remote: ",s.remoteAddress]})]})},s.id))})]})]})}),e.jsx(M,{value:"subscriptions",className:"space-y-4",children:e.jsxs(p,{children:[e.jsx(N,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(v,{children:"Subscriptions"}),e.jsx(T,{children:"Active topic subscriptions (read-only, subscriptions are created by clients)"})]})})}),e.jsxs(j,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(n,{placeholder:"Search subscriptions...",value:G,onChange:s=>xs(s.target.value),className:"pl-9"})]}),G&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Showing ",me.length," of ",w.length," subscriptions"]})]}),me.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:w.length===0?"No active subscriptions":"No subscriptions match your search"}):e.jsx("div",{className:"space-y-2",children:me.filter(s=>w.findIndex(r=>r.id===s.id)!==-1).map(s=>{const r=w.findIndex(i=>i.id===s.id),t=(i,f)=>{const d=[...w];d[r]={...d[r],[i]:f},c({subscriptions:d})},a=R[r]!==void 0?R[r]:s.selector||"";return e.jsx(p,{className:"border-l-4 border-l-orange-500",children:e.jsxs(j,{className:"pt-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1 grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Destination"}),e.jsx("p",{className:"text-sm font-medium",children:s.destination})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Client ID"}),e.jsx("p",{className:"text-sm font-medium",children:s.clientId})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pending"}),e.jsx("p",{className:"text-sm font-medium",children:s.pendingQueueSize||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Dispatched"}),e.jsx("p",{className:"text-sm font-medium",children:s.dispatchedQueueSize||0})]})]})}),e.jsx(A,{className:"my-3"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:`sub-selector-${r}`,className:"text-xs",children:"Message Selector"}),hs===r?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{id:`sub-selector-${r}`,value:a,onChange:i=>{oe({...R,[r]:i.target.value})},placeholder:"e.g., priority > 5 OR type = 'order'",className:"flex-1",onKeyDown:i=>{i.key==="Enter"&&(t("selector",a||void 0),Z(null)),i.key==="Escape"&&(oe({...R,[r]:s.selector||""}),Z(null))},autoFocus:!0}),e.jsx(m,{size:"sm",variant:"outline",onClick:()=>{t("selector",a||void 0),Z(null)},children:e.jsx(ge,{className:"h-3 w-3"})})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{value:s.selector||"(no selector)",readOnly:!0,className:"flex-1 bg-muted"}),e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>{oe({...R,[r]:s.selector||""}),Z(r)},children:e.jsx(Ne,{className:"h-3 w-3"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:`SQL-like selector to filter messages (e.g., "priority > 5", "type = 'order'")`})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:`sub-durable-${r}`,className:"text-xs",children:"Durable Subscription"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Subscription survives client disconnection"})]}),e.jsx(Ee,{id:`sub-durable-${r}`,checked:s.durable||!1,onCheckedChange:i=>t("durable",i)})]})]})]})},s.id)})})]})]})}),e.jsxs(M,{value:"security",className:"space-y-4",children:[e.jsxs(B,{className:"mb-4",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx($,{children:"Access Control Lists (ACLs)"}),e.jsxs(I,{className:"text-sm space-y-1",children:[e.jsx("p",{children:"Configure permissions to control access to queues and topics. ACLs are enforced during simulation."}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx("strong",{children:"Format:"})," Resource should be in format ",e.jsx("code",{children:"queue://name"})," or ",e.jsx("code",{children:"topic://name"})," (wildcard ",e.jsx("code",{children:"*"})," supported). Operations: ",e.jsx("code",{children:"read"}),", ",e.jsx("code",{children:"write"}),", ",e.jsx("code",{children:"admin"}),", ",e.jsx("code",{children:"create"}),".",e.jsx("strong",{children:"Deny"})," takes precedence over ",e.jsx("strong",{children:"Allow"}),"."]})]})]}),e.jsxs(p,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(v,{children:"Access Control Lists (ACLs)"}),e.jsx(T,{children:"Configure permissions for users and resources"})]}),e.jsxs(m,{onClick:()=>te(!0),size:"sm",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Add ACL"]})]})}),e.jsxs(j,{children:[Le&&e.jsxs(p,{className:"mb-4 border-primary",children:[e.jsxs(N,{children:[e.jsx(v,{children:"Create ACL Rule"}),e.jsx(T,{children:"Configure access control for queues and topics"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"acl-principal",children:"Principal (User/Group)"}),e.jsx(n,{id:"acl-principal",value:x.principal,onChange:s=>k({...x,principal:s.target.value}),placeholder:"user1 or * for all"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"User or group name, use * for all"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"acl-resource",children:"Resource"}),e.jsx(n,{id:"acl-resource",value:x.resource,onChange:s=>{k({...x,resource:s.target.value});const r=Me(s.target.value);ce(r)},placeholder:"queue://orders or topic://events",className:ie?"border-red-500":""}),ie?e.jsx("p",{className:"text-xs text-red-500",children:ie}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"Format: queue://name or topic://name (use * for all)"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"acl-operation",children:"Operation"}),e.jsxs(ue,{value:x.operation,onValueChange:s=>k({...x,operation:s}),children:[e.jsx(xe,{id:"acl-operation",children:e.jsx(he,{})}),e.jsxs(pe,{children:[e.jsx(y,{value:"read",children:"Read"}),e.jsx(y,{value:"write",children:"Write"}),e.jsx(y,{value:"admin",children:"Admin"}),e.jsx(y,{value:"create",children:"Create"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"acl-permission",children:"Permission"}),e.jsxs(ue,{value:x.permission,onValueChange:s=>k({...x,permission:s}),children:[e.jsx(xe,{id:"acl-permission",children:e.jsx(he,{})}),e.jsxs(pe,{children:[e.jsx(y,{value:"allow",children:"Allow"}),e.jsx(y,{value:"deny",children:"Deny"})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{onClick:ps,disabled:!x.principal||!x.resource,children:"Create ACL"}),e.jsx(m,{variant:"outline",onClick:()=>{te(!1),k({principal:"",resource:"",operation:"read",permission:"allow"})},children:"Cancel"})]})]})]}),W.length===0&&!Le?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No ACLs configured"}):e.jsx("div",{className:"space-y-2",children:W.map((s,r)=>e.jsx(p,{className:"border-l-4 border-l-red-500",children:e.jsx(j,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Principal"}),e.jsx("p",{className:"text-sm font-medium",children:s.principal})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Resource"}),e.jsx("p",{className:"text-sm font-medium",children:s.resource})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Operation"}),e.jsx(J,{variant:"outline",children:s.operation})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Permission"}),e.jsx(J,{variant:s.permission==="allow"?"default":"destructive",children:s.permission})]})]}),e.jsx(m,{variant:"ghost",size:"icon",onClick:()=>js(r),children:e.jsx(fe,{className:"h-4 w-4"})})]})})},r))})]})]})]})]})]}),e.jsx(Re,{open:S!==null,onOpenChange:s=>!s&&H(null),children:e.jsxs(Ue,{children:[e.jsxs(Be,{children:[e.jsx($e,{children:"Delete Queue"}),e.jsxs(Ie,{children:['Are you sure you want to delete the queue "',u[S||0]?.name,'"?',u[S||0]&&(u[S||0].queueSize||0)>0&&e.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx(Oe,{className:"h-4 w-4 inline mr-1"}),"This queue contains ",u[S||0].queueSize," messages. All messages will be lost."]})})]})]}),e.jsxs(We,{children:[e.jsx(m,{variant:"outline",onClick:()=>H(null),children:"Cancel"}),e.jsx(m,{variant:"destructive",onClick:()=>S!==null&&Fe(S),children:"Delete"})]})]})}),e.jsx(Re,{open:q!==null,onOpenChange:s=>!s&&K(null),children:e.jsxs(Ue,{children:[e.jsxs(Be,{children:[e.jsx($e,{children:"Delete Topic"}),e.jsxs(Ie,{children:['Are you sure you want to delete the topic "',g[q||0]?.name,'"?',g[q||0]&&w.some(s=>s.destination===g[q||0]?.name)&&e.jsx("div",{className:"mt-2 p-2 bg-yellow-50 border border-yellow-200 rounded",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx(Oe,{className:"h-4 w-4 inline mr-1"}),"This topic has active subscriptions. Subscribers will lose access to this topic."]})})]})]}),e.jsxs(We,{children:[e.jsx(m,{variant:"outline",onClick:()=>K(null),children:"Cancel"}),e.jsx(m,{variant:"destructive",onClick:()=>q!==null&&Pe(q),children:"Delete"})]})]})})]})}export{$s as ActiveMQConfigAdvanced};

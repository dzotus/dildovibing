import{u as rs,a as ds,j as e,e as os,r as g,l as h,S as q,C as i,h as c,i as r,m as d,B as S,T as hs,b as xs,c as L,A as Se,D as ms,d as de,f as K,k as O,L as t,y as us,z as js,E as ps,G as vs,H as gs,I as C,J as fs,a5 as Ns,am as te,P as oe,a6 as ys,ae as bs,o as he,q as B,s as M,t as F,v as H,w as m,x as A}from"./index-HDGrDyRq.js";import{u as Cs}from"./use-toast-XAAHaGVT.js";import{T as ks}from"./textarea-CjQgIquO.js";import{R as ws}from"./refresh-ccw-BUKvY8S7.js";import{K as Ss}from"./key-CMmIYHBN.js";import{S as Es}from"./shield-DzL7mY-o.js";import{L as xe}from"./lock-BhuwrGKI.js";import{E as Ts}from"./eye-off-c7WbQu-W.js";import{C as Vs}from"./circle-check-big-3lbqtoL4.js";function Bs({componentId:Q}){const{nodes:Ee,updateNode:Te}=rs(),{componentMetrics:Ve,isRunning:As}=ds(),{toast:N}=Cs(),E=Ee.find(s=>s.id===Q);if(!E)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const P=Ve.get(Q),f=os.getVaultEmulationEngine(Q),o=E.data.config||{},me=o.vaultType||"hashicorp",Ae=o.address||"http://vault:8200",Pe=o.enableTLS??!1,ze=o.enableTransit??!0,ue=o.enableKV??!0,De=o.kvVersion||"2",Le=o.enablePKI??!1,je=o.enableAuth??!0,Ke=o.authMethod||"token",Oe=o.tokenTTL||"24h",b=Array.isArray(o.secrets)?o.secrets:[],T=Array.isArray(o.engines)?o.engines:[],R=Array.isArray(o.policies)?o.policies:[],p=f?.getMetrics(),Z=f?.getConfig(),I=f?.getSealState(),J=I?.sealed??o.sealed??!0,Re=p?.secretsTotal??o.totalSecrets??b.length,Ie=Z?.engines.filter(s=>s.enabled).length??o.enginesEnabled??T.filter(s=>s.enabled).length,pe=p?.activeTokens??0,Ue=p?.readRequestsTotal??0,$e=p?.writeRequestsTotal??0,qe=p?.authRequestsTotal??0,Be=p?.encryptionOperationsTotal??0,Me=p?.decryptionOperationsTotal??0,[Ps,zs]=g.useState(null),[ie,ce]=g.useState(!1),[ve,W]=g.useState(!1),[ge,_]=g.useState(!1),[z,X]=g.useState(null),[G,Y]=g.useState(null),[Fe,fe]=g.useState(null),[U,Ne]=g.useState(""),[v,$]=g.useState({path:"",key:"",value:""}),[j,V]=g.useState({name:"",type:"kv",version:2}),[y,D]=g.useState({name:"",rules:'path "*" { capabilities = ["read"] }'}),[l,u]=g.useState({}),[He,ee]=g.useState(!1),[se,ae]=g.useState(["","",""]),ye=g.useMemo(()=>{if(!U)return b;const s=U.toLowerCase();return b.filter(a=>a.path.toLowerCase().includes(s)||a.key.toLowerCase().includes(s)||a.value.toLowerCase().includes(s))},[b,U]);g.useEffect(()=>{f&&E&&f.initializeConfig(E)},[o,E,f]);const x=s=>{Te(Q,{data:{...E.data,config:{...o,...s}}})},We=()=>{f&&E&&(f.initializeConfig(E),N({title:"Refreshed",description:"Vault configuration refreshed from emulation engine"}))},_e=s=>{if(!s?.trim())return"Path is required";if(!/^[a-zA-Z0-9/_-]+$/.test(s))return"Path contains invalid characters. Use only letters, numbers, /, _, and -";if(v.key?.trim()&&b.find(n=>n.path===s&&n.key===v.key))return"A secret with this path and key already exists"},Ge=()=>{const s={},a=_e(v.path);if(a&&(s.path=a),v.key?.trim()||(s.key="Key is required"),v.value?.trim()||(s.value="Value is required"),Object.keys(s).length>0){u({...l,secret:s});return}u({...l,secret:void 0});const n={id:`secret-${Date.now()}`,path:v.path,key:v.key,value:v.value,version:1,created:new Date().toISOString(),updated:new Date().toISOString(),visible:!1};x({secrets:[...b,n]}),ce(!1),$({path:"",key:"",value:""}),N({title:"Secret Created",description:`Secret ${v.path}/${v.key} created successfully`})},be=()=>{ce(!1),u({...l,secret:void 0}),$({path:"",key:"",value:""})},Qe=s=>{const a=b.find(n=>n.id===s);a&&(x({secrets:b.filter(n=>n.id!==s)}),N({title:"Secret Deleted",description:`Secret ${a.path}/${a.key} deleted`}))},le=(s,a,n)=>{const k=b.map(w=>w.id===s?{...w,[a]:n}:w);x({secrets:k})},Ze=s=>{const a=b.find(n=>n.id===s);a&&le(s,"visible",!a.visible)},Je=s=>{const a=b.find(n=>n.id===s);a&&(navigator.clipboard.writeText(a.value),fe(s),setTimeout(()=>fe(null),2e3))},Ce=(s,a)=>{if(!s?.trim())return"Engine name is required";if(!s.endsWith("/"))return"Engine name must end with /";if(T.find(k=>k.name===s&&k.id!==a))return"An engine with this name already exists";if(!/^[a-zA-Z0-9/_-]+$/.test(s))return"Engine name contains invalid characters"},Xe=()=>{const s={},a=Ce(j.name);if(a&&(s.name=a),Object.keys(s).length>0){u({...l,engine:s});return}u({...l,engine:void 0});const n={id:`engine-${Date.now()}`,name:j.name,type:j.type,enabled:!0,version:j.type==="kv"?j.version:void 0};x({engines:[...T,n]}),W(!1),V({name:"",type:"kv",version:2}),N({title:"Engine Created",description:`Secret engine ${j.name} created successfully`})},Ye=s=>{X(s.id),V({name:s.name,type:s.type,version:s.version||2}),W(!0),u({...l,engine:void 0})},es=()=>{if(z){const s={},a=Ce(j.name,z);if(a&&(s.name=a),Object.keys(s).length>0){u({...l,engine:s});return}ne(z,"name",j.name),ne(z,"type",j.type),j.type==="kv"&&ne(z,"version",j.version),W(!1),X(null),V({name:"",type:"kv",version:2}),N({title:"Engine Updated",description:"Secret engine updated successfully"})}else Xe()},ke=()=>{W(!1),X(null),u({...l,engine:void 0}),V({name:"",type:"kv",version:2})},ss=s=>{const a=T.find(n=>n.id===s);a&&(x({engines:T.filter(n=>n.id!==s)}),N({title:"Engine Removed",description:`Secret engine ${a.name} removed`}))},ne=(s,a,n)=>{const k=T.map(w=>w.id===s?{...w,[a]:n}:w);x({engines:k})},as=()=>{if(!y.name||!y.rules){N({title:"Validation Error",description:"Please fill in all required fields",variant:"destructive"});return}const s={id:`policy-${Date.now()}`,name:y.name,rules:y.rules,enabled:!0};x({policies:[...R,s]}),_(!1),D({name:"",rules:'path "*" { capabilities = ["read"] }'}),N({title:"Policy Created",description:`Access policy ${y.name} created successfully`})},ls=s=>{Y(s.id),D({name:s.name,rules:s.rules}),_(!0),u({...l,policy:void 0})},ns=()=>{if(G){if(!y.name||!y.rules){N({title:"Validation Error",description:"Please fill in all required fields",variant:"destructive"});return}re(G,"name",y.name),re(G,"rules",y.rules),_(!1),Y(null),D({name:"",rules:'path "*" { capabilities = ["read"] }'}),N({title:"Policy Updated",description:"Access policy updated successfully"})}else as()},we=()=>{_(!1),Y(null),u({...l,policy:void 0}),D({name:"",rules:'path "*" { capabilities = ["read"] }'})},ts=s=>{const a=R.find(n=>n.id===s);a&&(x({policies:R.filter(n=>n.id!==s)}),N({title:"Policy Deleted",description:`Access policy ${a.name} deleted`}))},re=(s,a,n)=>{const k=R.map(w=>w.id===s?{...w,[a]:n}:w);x({policies:k})},is=()=>{f&&(f.seal(),x({sealed:!0}),N({title:"Vault Sealed",description:"Vault has been sealed. All operations are now blocked."}))},cs=()=>{if(f){const s=se.filter(n=>n&&n.trim().length>0),a=f.unseal(s);if(a.success)x({sealed:!1}),ee(!1),ae(["","",""]),N({title:"Vault Unsealed",description:"Vault has been successfully unsealed."});else if(N({title:"Unseal Progress",description:a.error||`Progress: ${a.progress}/${a.threshold}`,variant:a.progress>0?"default":"destructive"}),a.progress<a.threshold){const n=a.threshold-a.progress;ae([...se,...Array(n).fill("")])}}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Secrets Vault"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Vault Configuration"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Secure storage and management of secrets, API keys, and credentials"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(h,{variant:"outline",size:"sm",onClick:We,children:[e.jsx(ws,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(q,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm font-medium",children:"Total Secrets"})}),e.jsxs(d,{children:[e.jsx("span",{className:"text-2xl font-bold",children:Re}),P&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Ue," reads, ",$e," writes"]})]})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm font-medium",children:"Engines Enabled"})}),e.jsxs(d,{children:[e.jsx("span",{className:"text-2xl font-bold",children:Ie}),P&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[Be+Me," crypto ops"]})]})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm font-medium",children:"Active Tokens"})}),e.jsxs(d,{children:[e.jsx("span",{className:"text-2xl font-bold",children:pe}),P&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[qe," auth requests"]})]})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm font-medium",children:"Vault Type"})}),e.jsxs(d,{children:[e.jsx(S,{variant:"outline",children:me}),P&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Throughput:"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(P.throughput)," ops/s"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Latency:"}),e.jsxs("span",{className:"font-semibold",children:[Math.round(P.latency)," ms"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Error Rate:"}),e.jsxs("span",{className:"font-semibold",children:[(P.errorRate*100).toFixed(2),"%"]})]})]})]})]})]}),e.jsxs(hs,{defaultValue:"status",className:"space-y-4",children:[e.jsxs(xs,{children:[e.jsxs(L,{value:"status",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Status"]}),e.jsxs(L,{value:"secrets",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Secrets (",b.length,")"]}),e.jsxs(L,{value:"engines",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Secret Engines (",T.length,")"]}),e.jsxs(L,{value:"policies",children:[e.jsx(Es,{className:"h-4 w-4 mr-2"}),"Policies (",R.length,")"]}),e.jsxs(L,{value:"tokens",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Tokens (",pe,")"]}),e.jsxs(L,{value:"audit",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Audit Log"]}),e.jsxs(L,{value:"settings",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsxs(K,{value:"status",className:"space-y-4",children:[e.jsxs(i,{children:[e.jsxs(c,{children:[e.jsx(r,{children:"Vault Status"}),e.jsx(O,{children:"Current state and seal status"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${J?"bg-red-500":"bg-green-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:J?"Sealed":"Unsealed"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:J?"Vault is sealed. Operations are blocked.":"Vault is unsealed. Operations are allowed."})]})]}),e.jsx("div",{className:"flex gap-2",children:J?e.jsxs(h,{onClick:()=>ee(!0),size:"sm",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Unseal Vault"]}):e.jsxs(h,{onClick:is,size:"sm",variant:"destructive",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Seal Vault"]})})]}),I&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{className:"text-muted-foreground",children:"Unseal Threshold"}),e.jsx("p",{className:"text-lg font-semibold",children:I.unsealThreshold})]}),e.jsxs("div",{children:[e.jsx(t,{className:"text-muted-foreground",children:"Unseal Progress"}),e.jsxs("p",{className:"text-lg font-semibold",children:[I.unsealProgress," / ",I.unsealThreshold]})]})]}),Z?.storageBackend&&e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx(t,{className:"text-muted-foreground",children:"Storage Backend"}),e.jsx("p",{className:"text-lg font-semibold capitalize",children:Z.storageBackend.type}),Z.storageBackend.haEnabled&&e.jsx(S,{variant:"outline",className:"mt-2",children:"HA Enabled"})]})]})]}),e.jsx(us,{open:He,onOpenChange:ee,children:e.jsxs(js,{children:[e.jsxs(ps,{children:[e.jsx(vs,{children:"Unseal Vault"}),e.jsxs(gs,{children:["Provide unseal keys to unseal the vault. You need ",I?.unsealThreshold||3," keys."]})]}),e.jsx("div",{className:"space-y-4",children:se.map((s,a)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs(t,{children:["Unseal Key ",a+1]}),e.jsx(C,{type:"password",value:s,onChange:n=>{const k=[...se];k[a]=n.target.value,ae(k)},placeholder:`Enter unseal key ${a+1}`})]},a))}),e.jsxs(fs,{children:[e.jsx(h,{variant:"outline",onClick:()=>{ee(!1),ae(["","",""])},children:"Cancel"}),e.jsx(h,{onClick:cs,children:"Unseal"})]})]})})]}),e.jsx(K,{value:"secrets",className:"space-y-4",children:e.jsx(e.Fragment,{children:e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Secrets"}),e.jsx(O,{children:"Manage stored secrets and credentials"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ns,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(C,{placeholder:"Search secrets...",value:U,onChange:s=>Ne(s.target.value),className:"pl-8 w-64"}),U&&e.jsx(h,{variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full",onClick:()=>Ne(""),children:e.jsx(te,{className:"h-4 w-4"})})]}),!ie&&e.jsxs(h,{onClick:()=>{ce(!0),$({path:"",key:"",value:""}),u({...l,secret:void 0})},size:"sm",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Create Secret"]})]})]})}),e.jsx(d,{children:e.jsxs("div",{className:"space-y-4",children:[ie&&e.jsxs(i,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{children:"Create New Secret"}),e.jsx(h,{variant:"ghost",size:"icon",onClick:be,children:e.jsx(te,{className:"h-4 w-4"})})]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Path"}),e.jsx(C,{value:v.path,onChange:s=>{$({...v,path:s.target.value}),l.secret?.path&&u({...l,secret:{...l.secret,path:void 0}})},placeholder:"secret/app/database",className:l.secret?.path?"border-destructive":""}),l.secret?.path&&e.jsx("p",{className:"text-sm text-destructive",children:l.secret.path})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Key"}),e.jsx(C,{value:v.key,onChange:s=>{$({...v,key:s.target.value}),l.secret?.key&&u({...l,secret:{...l.secret,key:void 0}})},placeholder:"password",className:l.secret?.key?"border-destructive":""}),l.secret?.key&&e.jsx("p",{className:"text-sm text-destructive",children:l.secret.key})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Value"}),e.jsx(C,{type:"password",value:v.value,onChange:s=>{$({...v,value:s.target.value}),l.secret?.value&&u({...l,secret:{...l.secret,value:void 0}})},placeholder:"Enter secret value",className:l.secret?.value?"border-destructive":""}),l.secret?.value&&e.jsx("p",{className:"text-sm text-destructive",children:l.secret.value})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(h,{variant:"outline",onClick:be,children:"Cancel"}),e.jsx(h,{onClick:Ge,children:"Create"})]})]})]}),ye.length===0&&!ie?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:U?"No secrets found matching your search":"No secrets configured"}):ye.map(s=>e.jsxs(i,{className:"border-l-4 border-l-green-500",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-base",children:s.path}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(S,{variant:"outline",children:s.key}),e.jsxs(S,{variant:"outline",children:["v",s.version]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>Ze(s.id),children:s.visible?e.jsx(Ts,{className:"h-4 w-4"}):e.jsx(ys,{className:"h-4 w-4"})}),e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>Je(s.id),children:Fe===s.id?e.jsx(Vs,{className:"h-4 w-4 text-green-500"}):e.jsx(bs,{className:"h-4 w-4"})}),e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>Qe(s.id),children:e.jsx(he,{className:"h-4 w-4"})})]})]})}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Path"}),e.jsx(C,{value:s.path,onChange:a=>le(s.id,"path",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Key"}),e.jsx(C,{value:s.key,onChange:a=>le(s.id,"key",a.target.value)})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(t,{children:"Value"}),e.jsx(C,{type:s.visible?"text":"password",value:s.value,onChange:a=>le(s.id,"value",a.target.value),placeholder:"Enter secret value"})]})]})})]},s.id))]})})]})})}),e.jsx(K,{value:"engines",className:"space-y-4",children:e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Secret Engines"}),e.jsx(O,{children:"Configure secret storage engines"})]}),!ve&&e.jsxs(h,{onClick:()=>{W(!0),X(null),V({name:"",type:"kv",version:2}),u({...l,engine:void 0})},size:"sm",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Enable Engine"]})]})}),e.jsx(d,{children:e.jsxs("div",{className:"space-y-4",children:[ve&&e.jsxs(i,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{children:z?"Edit Engine":"Enable Secret Engine"}),e.jsx(h,{variant:"ghost",size:"icon",onClick:ke,children:e.jsx(te,{className:"h-4 w-4"})})]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Engine Name"}),e.jsx(C,{value:j.name,onChange:s=>{V({...j,name:s.target.value}),l.engine?.name&&u({...l,engine:{name:void 0}})},placeholder:"secret/",className:l.engine?.name?"border-destructive":""}),l.engine?.name&&e.jsx("p",{className:"text-sm text-destructive",children:l.engine.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Engine Type"}),e.jsxs(B,{value:j.type,onValueChange:s=>V({...j,type:s}),children:[e.jsx(M,{children:e.jsx(F,{})}),e.jsxs(H,{children:[e.jsx(m,{value:"kv",children:"Key-Value (KV)"}),e.jsx(m,{value:"transit",children:"Transit"}),e.jsx(m,{value:"pki",children:"PKI"}),e.jsx(m,{value:"database",children:"Database"}),e.jsx(m,{value:"aws",children:"AWS"}),e.jsx(m,{value:"azure",children:"Azure"})]})]})]}),j.type==="kv"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"KV Version"}),e.jsxs(B,{value:j.version.toString(),onValueChange:s=>V({...j,version:Number(s)}),children:[e.jsx(M,{children:e.jsx(F,{})}),e.jsxs(H,{children:[e.jsx(m,{value:"1",children:"Version 1"}),e.jsx(m,{value:"2",children:"Version 2"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(h,{variant:"outline",onClick:ke,children:"Cancel"}),e.jsx(h,{onClick:es,children:z?"Update":"Enable"})]})]})]}),T.map(s=>e.jsxs(i,{className:"border-l-4 border-l-blue-500",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-base",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(S,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"}),e.jsx(S,{variant:"outline",children:s.type}),s.version&&e.jsxs(S,{variant:"outline",children:["v",s.version]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>Ye(s),children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx(A,{checked:s.enabled,onCheckedChange:a=>ne(s.id,"enabled",a)}),e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>ss(s.id),children:e.jsx(he,{className:"h-4 w-4"})})]})]})}),e.jsx(d,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Name:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Type:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.type})]}),s.version&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Version:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:["v",s.version]})]})]})})]},s.id))]})})]})}),e.jsx(K,{value:"policies",className:"space-y-4",children:e.jsxs(i,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{children:"Access Policies"}),e.jsx(O,{children:"Configure access control policies"})]}),!ge&&e.jsxs(h,{onClick:()=>{_(!0),Y(null),D({name:"",rules:'path "*" { capabilities = ["read"] }'}),u({...l,policy:void 0})},size:"sm",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]})}),e.jsx(d,{children:e.jsxs("div",{className:"space-y-4",children:[ge&&e.jsxs(i,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(r,{children:G?"Edit Policy":"Create Access Policy"}),e.jsx(h,{variant:"ghost",size:"icon",onClick:we,children:e.jsx(te,{className:"h-4 w-4"})})]})}),e.jsxs(d,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Policy Name"}),e.jsx(C,{value:y.name,onChange:s=>{D({...y,name:s.target.value}),l.policy?.name&&u({...l,policy:{...l.policy,name:void 0}})},placeholder:"readonly",className:l.policy?.name?"border-destructive":""}),l.policy?.name&&e.jsx("p",{className:"text-sm text-destructive",children:l.policy.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Policy Rules (HCL)"}),e.jsx(ks,{value:y.rules,onChange:s=>{D({...y,rules:s.target.value}),l.policy?.rules&&u({...l,policy:{...l.policy,rules:void 0}})},rows:8,className:`font-mono text-sm ${l.policy?.rules?"border-destructive":""}`,placeholder:'path "*" { capabilities = ["read", "list"] }'}),l.policy?.rules&&e.jsx("p",{className:"text-sm text-destructive",children:l.policy.rules})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(h,{variant:"outline",onClick:we,children:"Cancel"}),e.jsx(h,{onClick:ns,children:G?"Update":"Create"})]})]})]}),R.map(s=>e.jsxs(i,{className:"border-l-4 border-l-purple-500",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(r,{className:"text-base",children:s.name}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsx(S,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>ls(s),children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx(A,{checked:s.enabled,onCheckedChange:a=>re(s.id,"enabled",a)}),e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>ts(s.id),children:e.jsx(he,{className:"h-4 w-4"})})]})]})}),e.jsx(d,{className:"space-y-4",children:e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Rules:"}),e.jsx("pre",{className:"mt-2 p-3 bg-muted rounded-md text-xs font-mono overflow-x-auto",children:s.rules})]})})})]},s.id))]})})]})}),e.jsx(K,{value:"tokens",className:"space-y-4",children:e.jsxs(i,{children:[e.jsx(c,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(r,{children:"Active Tokens"}),e.jsx(O,{children:"Manage authentication tokens"})]})})}),e.jsx(d,{children:f?e.jsx("div",{className:"space-y-4",children:f.getActiveTokens().length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No active tokens"}):f.getActiveTokens().map(s=>e.jsxs(i,{className:"border-l-4 border-l-blue-500",children:[e.jsx(c,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs(r,{className:"text-base font-mono text-sm",children:[s.token.substring(0,20),"..."]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(S,{variant:"outline",children:[s.policies.length," policies"]}),e.jsx(S,{variant:s.renewable?"default":"outline",children:s.renewable?"Renewable":"Non-renewable"})]})]})})}),e.jsx(d,{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"}),e.jsx("span",{className:"ml-2",children:new Date(s.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Expires:"}),e.jsx("span",{className:"ml-2",children:new Date(s.expiresAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"TTL:"}),e.jsxs("span",{className:"ml-2",children:[Math.floor((s.expiresAt-Date.now())/1e3/60)," minutes"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Policies:"}),e.jsx("span",{className:"ml-2",children:s.policies.join(", ")})]})]})})]},s.id))}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Vault engine not initialized"})})]})}),e.jsx(K,{value:"audit",className:"space-y-4",children:e.jsxs(i,{children:[e.jsx(c,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(r,{children:"Audit Log"}),e.jsx(O,{children:"View operation history and audit trail"})]})})}),e.jsx(d,{children:p?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Read Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:p.readRequestsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Write Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:p.writeRequestsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Delete Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:p.deleteRequestsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Auth Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:p.authRequestsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Encryption Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:p.encryptionOperationsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Decryption Operations"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:p.decryptionOperationsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Auth Errors"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold text-destructive",children:p.authErrorsTotal})})]}),e.jsxs(i,{children:[e.jsx(c,{className:"pb-3",children:e.jsx(r,{className:"text-sm",children:"Tokens Issued"})}),e.jsx(d,{children:e.jsx("span",{className:"text-2xl font-bold",children:p.tokenIssuedTotal})})]})]})}):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No audit data available"})})]})}),e.jsx(K,{value:"settings",className:"space-y-4",children:e.jsxs(i,{children:[e.jsxs(c,{children:[e.jsx(r,{children:"Vault Settings"}),e.jsx(O,{children:"General vault configuration"})]}),e.jsxs(d,{className:"space-y-4",children:[e.jsx(q,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(t,{className:"text-base font-semibold",children:"Storage Backend"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Storage Type"}),e.jsxs(B,{value:o.storageBackend?.type||"consul",onValueChange:s=>{x({storageBackend:{type:s,haEnabled:o.storageBackend?.haEnabled??!1}})},children:[e.jsx(M,{children:e.jsx(F,{})}),e.jsxs(H,{children:[e.jsx(m,{value:"consul",children:"Consul"}),e.jsx(m,{value:"etcd",children:"etcd"}),e.jsx(m,{value:"file",children:"File"}),e.jsx(m,{value:"s3",children:"S3"}),e.jsx(m,{value:"inmem",children:"In-Memory"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{children:"High Availability"}),e.jsx(A,{checked:o.storageBackend?.haEnabled??!1,onCheckedChange:s=>{x({storageBackend:{type:o.storageBackend?.type||"consul",haEnabled:s}})}})]})]})]}),e.jsx(q,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Vault Type"}),e.jsxs(B,{value:me,onValueChange:s=>x({vaultType:s}),children:[e.jsx(M,{children:e.jsx(F,{})}),e.jsxs(H,{children:[e.jsx(m,{value:"hashicorp",children:"HashiCorp Vault"}),e.jsx(m,{value:"aws",children:"AWS Secrets Manager"}),e.jsx(m,{value:"azure",children:"Azure Key Vault"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Vault Address"}),e.jsx(C,{value:Ae,onChange:s=>x({address:s.target.value}),placeholder:"http://vault:8200"})]}),e.jsx(q,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{children:"Enable TLS"}),e.jsx(A,{checked:Pe,onCheckedChange:s=>x({enableTLS:s})})]}),e.jsx(q,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{children:"Enable KV Store"}),e.jsx(A,{checked:ue,onCheckedChange:s=>x({enableKV:s})})]}),ue&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"KV Version"}),e.jsxs(B,{value:De,onValueChange:s=>x({kvVersion:s}),children:[e.jsx(M,{children:e.jsx(F,{})}),e.jsxs(H,{children:[e.jsx(m,{value:"1",children:"Version 1"}),e.jsx(m,{value:"2",children:"Version 2"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{children:"Enable Transit"}),e.jsx(A,{checked:ze,onCheckedChange:s=>x({enableTransit:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{children:"Enable PKI"}),e.jsx(A,{checked:Le,onCheckedChange:s=>x({enablePKI:s})})]})]}),e.jsx(q,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{children:"Enable Authentication"}),e.jsx(A,{checked:je,onCheckedChange:s=>x({enableAuth:s})})]}),je&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Auth Method"}),e.jsxs(B,{value:Ke,onValueChange:s=>x({authMethod:s}),children:[e.jsx(M,{children:e.jsx(F,{})}),e.jsxs(H,{children:[e.jsx(m,{value:"token",children:"Token"}),e.jsx(m,{value:"approle",children:"AppRole"}),e.jsx(m,{value:"ldap",children:"LDAP"}),e.jsx(m,{value:"aws",children:"AWS"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{children:"Token TTL"}),e.jsx(C,{value:Oe,onChange:s=>x({tokenTTL:s.target.value}),placeholder:"24h"})]})]})]})]})})]})]})})}export{Bs as SecretsVaultConfigAdvanced};

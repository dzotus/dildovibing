import{u as Ke,a as Ze,j as e,e as es,r as p,l,S as Y,a4 as ss,I as d,ak as as,ag as ts,q as X,s as K,t as Z,v as ee,w as o,C as h,h as m,i as u,a3 as se,m as f,A as Ce,ap as is,T as ls,b as ns,c as D,aj as de,d as rs,f as T,aw as cs,k as R,B as x,ah as U,o as L,P as J,L as i,x as me,N as ds,O as os,Q as hs,V as xs,W as ms,X as us,Y as js,_ as vs,D as ae,y as te,z as ie,E as le,G as ne,H as re}from"./index-Car91T5O.js";import{A as ps,a as gs,b as Ns}from"./alert-B2AJvFl-.js";import{T as ue}from"./textarea-Cgvn3GTT.js";import{R as fs}from"./refresh-ccw-BcN9ARyd.js";import{R as Se}from"./route-BrSxShy6.js";import{G as Pe}from"./globe-DkMnv8r8.js";import{S as oe}from"./shield-COME9V66.js";function Ds({componentId:ce}){const{nodes:ke,updateNode:Ee}=Ke(),{getComponentMetrics:Ae}=Ze(),he=ke.find(s=>s.id===ce);if(!he)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const N=he.data.config||{},$=Ae(ce),z=es.getIstioRoutingEngine(ce),W=N.services||[],M=N.virtualServices||[],O=N.destinationRules||[],P=N.gateways||[],I=N.peerAuthentications||[],B=N.authorizationPolicies||[],F=N.serviceEntries||[],Q=N.sidecars||[],De=W.length,Te=$?.customMetrics?.total_requests||z?.getStats().totalRequests||0,Re=$?.customMetrics?.total_errors||z?.getStats().totalErrors||0,Le=Math.round($?.customMetrics?.average_latency||z?.getStats().averageLatency||$?.latency||0),[j,je]=p.useState(""),[g,ze]=p.useState("all"),[w,A]=p.useState(null),[t,y]=p.useState(null),[n,b]=p.useState(null),[C,V]=p.useState(null),[S,q]=p.useState(null),[ys,Me]=p.useState(null),[bs,Oe]=p.useState(null),[k,E]=p.useState(null),Ie=p.useMemo(()=>{const s=new Set;return W.forEach(a=>a.namespace&&s.add(a.namespace)),M.forEach(a=>a.namespace&&s.add(a.namespace)),O.forEach(a=>a.namespace&&s.add(a.namespace)),P.forEach(a=>a.namespace&&s.add(a.namespace)),I.forEach(a=>a.namespace&&s.add(a.namespace)),B.forEach(a=>a.namespace&&s.add(a.namespace)),F.forEach(a=>a.namespace&&s.add(a.namespace)),Q.forEach(a=>a.namespace&&s.add(a.namespace)),Array.from(s).sort()},[W,M,O,P,I,B,F,Q]),G=s=>{if(!j.trim())return s;const a=j.toLowerCase();return s.filter(c=>c.name.toLowerCase().includes(a)||c.namespace&&c.namespace.toLowerCase().includes(a))},H=s=>g==="all"?s:s.filter(a=>a.namespace===g),ve=p.useMemo(()=>H(G(W)),[W,j,g]),pe=p.useMemo(()=>H(G(M)),[M,j,g]),ge=p.useMemo(()=>H(G(O)),[O,j,g]),Ne=p.useMemo(()=>H(G(P)),[P,j,g]),fe=p.useMemo(()=>H(G(I)),[I,j,g]),ye=p.useMemo(()=>H(G(B)),[B,j,g]),be=p.useMemo(()=>H(G(F)),[F,j,g]),we=p.useMemo(()=>H(G(Q)),[Q,j,g]);p.useEffect(()=>{if(!z||!$)return;const s=z.getStats(),a=$.customMetrics||{};({...N,totalRequests:s.totalRequests||a.total_requests||N.totalRequests,totalErrors:s.totalErrors||a.total_errors||N.totalErrors,averageLatency:Math.round(s.averageLatency||a.average_latency||N.averageLatency||0)})},[z,$]);const r=s=>{Ee(ce,{data:{...he.data,config:{...N,...s}}})},Be=()=>{const s={id:`vs-${Date.now()}`,name:"new-virtual-service",namespace:"default",hosts:["example.com"],http:[{route:[{destination:{host:"service"},weight:100}]}]};r({virtualServices:[...M,s]}),A(s)},Ve=s=>{r({virtualServices:M.filter(a=>a.id!==s)})},qe=()=>{const s={id:`dr-${Date.now()}`,name:"new-destination-rule",namespace:"default",host:"service",subsets:[{name:"v1",labels:{version:"v1"}}]};r({destinationRules:[...O,s]}),y(s)},Ge=s=>{r({destinationRules:O.filter(a=>a.id!==s)})},He=()=>{const s={id:`gw-${Date.now()}`,name:"new-gateway",namespace:"default",selector:{istio:"ingressgateway"},servers:[{port:{number:80,protocol:"HTTP",name:"http"},hosts:["*"]}]};r({gateways:[...P,s]}),b(s)},_e=s=>{r({gateways:P.filter(a=>a.id!==s)})},Ue=()=>{const s={id:`pa-${Date.now()}`,name:"new-peer-authentication",namespace:"default",mtls:{mode:"PERMISSIVE"}};r({peerAuthentications:[...I,s]})},Je=s=>{r({peerAuthentications:I.filter(a=>a.id!==s)})},$e=()=>{const s={id:`ap-${Date.now()}`,name:"new-authorization-policy",namespace:"default",action:"ALLOW",rules:[]};r({authorizationPolicies:[...B,s]})},We=s=>{r({authorizationPolicies:B.filter(a=>a.id!==s)})},Fe=()=>{const s={id:`se-${Date.now()}`,name:"new-service-entry",namespace:"default",hosts:["external.example.com"],location:"MESH_EXTERNAL",resolution:"DNS"};r({serviceEntries:[...F,s]})},Qe=s=>{r({serviceEntries:F.filter(a=>a.id!==s)})},Ye=()=>{const s={id:`sc-${Date.now()}`,name:"new-sidecar",namespace:"default",egress:[],ingress:[]};r({sidecars:[...Q,s]})},Xe=s=>{r({sidecars:Q.filter(a=>a.id!==s)})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Istio Service Mesh"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Traffic Management"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Service mesh for microservices traffic management and security"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{z&&z.resetStats()},title:"Reset statistics",children:[e.jsx(fs,{className:"h-4 w-4 mr-2"}),"Refresh Stats"]})})]}),e.jsx(Y,{}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ss,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(d,{placeholder:"Search services, policies, rules...",value:j,onChange:s=>je(s.target.value),className:"pl-10"}),j&&e.jsx(l,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6",onClick:()=>je(""),children:e.jsx(as,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(X,{value:g,onValueChange:ze,children:[e.jsx(K,{className:"w-[180px]",children:e.jsx(Z,{placeholder:"All namespaces"})}),e.jsxs(ee,{children:[e.jsx(o,{value:"all",children:"All namespaces"}),Ie.map(s=>e.jsx(o,{value:s,children:s},s))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(h,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Services"}),e.jsx(se,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:De}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"registered"})]})})]}),e.jsxs(h,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Requests"}),e.jsx(Ce,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(f,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:Te.toLocaleString()})})})]}),e.jsxs(h,{className:"border-l-4 border-l-red-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Errors"}),e.jsx(is,{className:"h-4 w-4 text-red-500"})]})}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:Re}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"total"})]})})]}),e.jsxs(h,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Avg Latency"}),e.jsx(Ce,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:Le}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"ms"})]})})]})]}),e.jsxs(ls,{defaultValue:"services",className:"space-y-4",children:[e.jsxs(ns,{children:[e.jsxs(D,{value:"services",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Services (",W.length,")"]}),e.jsxs(D,{value:"virtual-services",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"Virtual Services (",M.length,")"]}),e.jsxs(D,{value:"destination-rules",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Destination Rules (",O.length,")"]}),e.jsxs(D,{value:"gateways",children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Gateways (",P.length,")"]}),e.jsxs(D,{value:"peer-authentication",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Peer Auth (",I.length,")"]}),e.jsxs(D,{value:"authorization-policy",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Auth Policy (",B.length,")"]}),e.jsxs(D,{value:"service-entry",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Service Entry (",F.length,")"]}),e.jsxs(D,{value:"sidecar",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Sidecar (",Q.length,")"]}),e.jsxs(D,{value:"settings",children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsxs(T,{value:"services",className:"space-y-4",children:[e.jsxs(ps,{className:"border-blue-200 bg-blue-50 dark:border-blue-800 dark:bg-blue-950/30",children:[e.jsx(cs,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),e.jsx(gs,{className:"text-blue-900 dark:text-blue-100",children:"Automatic Service Discovery"}),e.jsx(Ns,{className:"text-blue-800 dark:text-blue-200",children:"Services are automatically added to the mesh when connections are created. Create a connection from Istio to any service (API, Database, Queue, etc.), and the service will be automatically registered in the mesh with the correct protocol and port."})]}),e.jsxs(h,{children:[e.jsxs(m,{children:[e.jsx(u,{children:"Services"}),e.jsx(R,{children:"Registered services in the mesh"})]}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4",children:ve.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(se,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground opacity-50"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:j||g!=="all"?"No services match the filter":"No services registered yet"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Создайте соединение от Istio к сервису, чтобы автоматически добавить его в mesh"})]}):ve.map(s=>e.jsxs(h,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:e.jsx(se,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(x,{variant:"outline",children:s.namespace}),s.version&&e.jsx(x,{variant:"outline",children:s.version}),e.jsxs(x,{variant:s.healthyPods===s.pods?"default":"destructive",children:[s.healthyPods||0,"/",s.pods||0," pods"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>{},className:"hover:bg-primary/10",disabled:!0,title:"Service editing coming soon",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>E({type:"service",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(L,{className:"h-4 w-4"})})]})]})}),e.jsx(f,{children:e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Requests:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.requests?.toLocaleString()||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Errors:"}),e.jsx("span",{className:`ml-2 font-semibold ${s.errors&&s.errors>0?"text-red-500":""}`,children:s.errors||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Latency:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[s.latency||0,"ms"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Error Rate:"}),e.jsxs("span",{className:`ml-2 font-semibold ${s.requests&&s.errors&&s.errors/s.requests>.01?"text-red-500":""}`,children:[s.requests&&s.errors?(s.errors/s.requests*100).toFixed(2):0,"%"]})]})]})})]},s.id))})})]})]}),e.jsx(T,{value:"virtual-services",className:"space-y-4",children:e.jsxs(h,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Virtual Services"}),e.jsx(R,{children:"Configure traffic routing rules"})]}),e.jsxs(l,{onClick:Be,size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Add Virtual Service"]})]})}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4",children:pe.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:j||g!=="all"?"No virtual services match the filter":"No virtual services configured"}):pe.map(s=>e.jsxs(h,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-100 dark:bg-green-900/30",children:e.jsx(Se,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg font-semibold",children:s.name}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:s.hosts.map((a,c)=>e.jsx(x,{variant:"outline",className:"font-mono text-xs",children:a},c))})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>A(s),className:"hover:bg-primary/10",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>E({type:"virtualService",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(L,{className:"h-4 w-4"})})]})]})}),e.jsx(f,{children:s.http&&s.http.length>0&&e.jsx("div",{className:"space-y-2",children:s.http.map((a,c)=>e.jsx("div",{className:"p-3 border rounded",children:a.route&&e.jsx("div",{className:"space-y-1",children:a.route.map((v,_)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"→"}),e.jsx("span",{className:"ml-2 font-medium",children:v.destination.host}),v.destination.subset&&e.jsx(x,{variant:"outline",className:"ml-2",children:v.destination.subset}),v.weight&&e.jsxs(x,{variant:"outline",className:"ml-2",children:[v.weight,"%"]})]},_))})},c))})})]},s.id))})})]})}),e.jsx(T,{value:"destination-rules",className:"space-y-4",children:e.jsxs(h,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Destination Rules"}),e.jsx(R,{children:"Configure traffic policies and subsets"})]}),e.jsxs(l,{onClick:qe,size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Add Destination Rule"]})]})}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4",children:ge.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:j||g!=="all"?"No destination rules match the filter":"No destination rules configured"}):ge.map(s=>e.jsxs(h,{className:"border-l-4 border-l-purple-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100 dark:bg-purple-900/30",children:e.jsx(de,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(x,{variant:"outline",className:"font-mono text-xs",children:s.host}),s.trafficPolicy?.loadBalancer?.simple&&e.jsx(x,{variant:"outline",children:s.trafficPolicy.loadBalancer.simple})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>y(s),className:"hover:bg-primary/10",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>E({type:"destinationRule",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(L,{className:"h-4 w-4"})})]})]})}),e.jsx(f,{children:s.subsets&&s.subsets.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Subsets"}),s.subsets.map((a,c)=>e.jsx("div",{className:"p-2 border rounded",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{variant:"outline",children:a.name}),a.labels&&Object.entries(a.labels).map(([v,_])=>e.jsxs(x,{variant:"outline",className:"text-xs",children:[v,"=",_]},v))]})},c))]})})]},s.id))})})]})}),e.jsx(T,{value:"gateways",className:"space-y-4",children:e.jsxs(h,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Gateways"}),e.jsx(R,{children:"Configure ingress and egress gateways"})]}),e.jsxs(l,{onClick:He,size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Create Gateway"]})]})}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4",children:Ne.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:j||g!=="all"?"No gateways match the filter":"No gateways configured"}):Ne.map(s=>e.jsx(h,{className:"border-l-4 border-l-cyan-500 hover:shadow-md transition-shadow bg-card",children:e.jsxs(m,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-cyan-100 dark:bg-cyan-900/30",children:e.jsx(Pe,{className:"h-5 w-5 text-cyan-600 dark:text-cyan-400"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg font-semibold",children:s.name}),s.servers&&s.servers.length>0&&e.jsx("div",{className:"flex items-center gap-2 mt-2",children:s.servers.map((a,c)=>e.jsxs(x,{variant:"outline",className:"text-xs",children:[a.port.protocol,":",a.port.number]},c))})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>b(s),className:"hover:bg-primary/10",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>E({type:"gateway",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(L,{className:"h-4 w-4"})})]})]})},s.id))})})]})}),e.jsx(T,{value:"peer-authentication",className:"space-y-4",children:e.jsxs(h,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Peer Authentication"}),e.jsx(R,{children:"Configure mTLS authentication policies"})]}),e.jsxs(l,{onClick:Ue,size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Create Peer Authentication"]})]})}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4",children:fe.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:j||g!=="all"?"No peer authentications match the filter":"No peer authentications configured"}):fe.map(s=>e.jsx(h,{className:"border-l-4 border-l-orange-500 hover:shadow-md transition-shadow bg-card",children:e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-orange-100 dark:bg-orange-900/30",children:e.jsx(oe,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.namespace&&e.jsx(x,{variant:"outline",children:s.namespace}),s.mtls&&e.jsxs(x,{variant:s.mtls.mode==="STRICT"?"default":"outline",children:["mTLS: ",s.mtls.mode]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>V(s),className:"hover:bg-primary/10",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>E({type:"peerAuthentication",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(L,{className:"h-4 w-4"})})]})]})})},s.id))})})]})}),e.jsx(T,{value:"authorization-policy",className:"space-y-4",children:e.jsxs(h,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Authorization Policies"}),e.jsx(R,{children:"Configure access control policies"})]}),e.jsxs(l,{onClick:$e,size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Create Authorization Policy"]})]})}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4",children:ye.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:j||g!=="all"?"No authorization policies match the filter":"No authorization policies configured"}):ye.map(s=>e.jsx(h,{className:"border-l-4 border-l-red-500 hover:shadow-md transition-shadow bg-card",children:e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-red-100 dark:bg-red-900/30",children:e.jsx(oe,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.namespace&&e.jsx(x,{variant:"outline",children:s.namespace}),s.action&&e.jsx(x,{variant:s.action==="DENY"?"destructive":"default",children:s.action}),s.rules&&e.jsxs(x,{variant:"outline",children:[s.rules.length," rules"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>q(s),className:"hover:bg-primary/10",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>E({type:"authorizationPolicy",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(L,{className:"h-4 w-4"})})]})]})})},s.id))})})]})}),e.jsx(T,{value:"service-entry",className:"space-y-4",children:e.jsxs(h,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Service Entries"}),e.jsx(R,{children:"Configure external services"})]}),e.jsxs(l,{onClick:Fe,size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Create Service Entry"]})]})}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4",children:be.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:j||g!=="all"?"No service entries match the filter":"No service entries configured"}):be.map(s=>e.jsx(h,{className:"border-l-4 border-l-teal-500 hover:shadow-md transition-shadow bg-card",children:e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-teal-100 dark:bg-teal-900/30",children:e.jsx(se,{className:"h-5 w-5 text-teal-600 dark:text-teal-400"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.namespace&&e.jsx(x,{variant:"outline",children:s.namespace}),s.location&&e.jsx(x,{variant:"outline",children:s.location}),s.hosts&&s.hosts.length>0&&e.jsx(x,{variant:"outline",className:"font-mono text-xs",children:s.hosts[0]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>Me(s),className:"hover:bg-primary/10",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>E({type:"serviceEntry",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(L,{className:"h-4 w-4"})})]})]})})},s.id))})})]})}),e.jsx(T,{value:"sidecar",className:"space-y-4",children:e.jsxs(h,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Sidecars"}),e.jsx(R,{children:"Configure sidecar proxy settings"})]}),e.jsxs(l,{onClick:Ye,size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Create Sidecar"]})]})}),e.jsx(f,{children:e.jsx("div",{className:"space-y-4",children:we.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:j||g!=="all"?"No sidecars match the filter":"No sidecars configured"}):we.map(s=>e.jsx(h,{className:"border-l-4 border-l-indigo-500 hover:shadow-md transition-shadow bg-card",children:e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-indigo-100 dark:bg-indigo-900/30",children:e.jsx(de,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.namespace&&e.jsx(x,{variant:"outline",children:s.namespace}),s.egress&&e.jsxs(x,{variant:"outline",children:[s.egress.length," egress"]}),s.ingress&&e.jsxs(x,{variant:"outline",children:[s.ingress.length," ingress"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>Oe(s),className:"hover:bg-primary/10",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>E({type:"sidecar",id:s.id,name:s.name}),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(L,{className:"h-4 w-4"})})]})]})})},s.id))})})]})}),e.jsx(T,{value:"settings",className:"space-y-4",children:e.jsxs(h,{children:[e.jsxs(m,{children:[e.jsx(u,{children:"Istio Settings"}),e.jsx(R,{children:"Service mesh configuration"})]}),e.jsxs(f,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable mTLS"}),e.jsx(me,{checked:N.enableMTLS??!0,onCheckedChange:s=>r({enableMTLS:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable Tracing"}),e.jsx(me,{checked:N.enableTracing??!0,onCheckedChange:s=>r({enableTracing:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable Metrics"}),e.jsx(me,{checked:N.enableMetrics??!0,onCheckedChange:s=>r({enableMetrics:s})})]}),e.jsx(Y,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Default Load Balancer"}),e.jsxs(X,{value:N.defaultLoadBalancer??"ROUND_ROBIN",onValueChange:s=>r({defaultLoadBalancer:s}),children:[e.jsx(K,{children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(o,{value:"ROUND_ROBIN",children:"Round Robin"}),e.jsx(o,{value:"LEAST_CONN",children:"Least Connections"}),e.jsx(o,{value:"RANDOM",children:"Random"})]})]})]})]})]})})]}),e.jsx(ds,{open:!!k,onOpenChange:s=>!s&&E(null),children:e.jsxs(os,{children:[e.jsxs(hs,{children:[e.jsx(xs,{children:"Confirm Deletion"}),e.jsxs(ms,{children:["Are you sure you want to delete ",e.jsx("strong",{children:k?.name}),"? This action cannot be undone."]})]}),e.jsxs(us,{children:[e.jsx(js,{children:"Cancel"}),e.jsx(vs,{onClick:()=>{if(k){switch(k.type){case"service":r({services:W.filter(s=>s.id!==k.id)});break;case"virtualService":Ve(k.id);break;case"destinationRule":Ge(k.id);break;case"gateway":_e(k.id);break;case"peerAuthentication":Je(k.id);break;case"authorizationPolicy":We(k.id);break;case"serviceEntry":Qe(k.id);break;case"sidecar":Xe(k.id);break}E(null)}},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})}),e.jsx(ae,{open:!!w,onOpenChange:s=>!s&&A(null),children:e.jsxs(te,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(le,{children:"Edit Virtual Service"}),e.jsx(ne,{children:"Update virtual service configuration"})]}),w&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Name"}),e.jsx(d,{value:w.name,onChange:s=>A({...w,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Namespace"}),e.jsx(d,{value:w.namespace||"default",onChange:s=>A({...w,namespace:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Hosts (comma-separated)"}),e.jsx(d,{value:w.hosts.join(", "),onChange:s=>A({...w,hosts:s.target.value.split(",").map(a=>a.trim()).filter(a=>a)}),placeholder:"example.com, *.example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Gateways (comma-separated, optional)"}),e.jsx(d,{value:w.gateways?.join(", ")||"",onChange:s=>A({...w,gateways:s.target.value?s.target.value.split(",").map(a=>a.trim()).filter(a=>a):void 0}),placeholder:"istio-gateway"})]})]}),e.jsxs(re,{children:[e.jsx(l,{variant:"outline",onClick:()=>A(null),children:"Cancel"}),e.jsx(l,{onClick:()=>{if(w){const s=M.map(a=>a.id===w.id?w:a);r({virtualServices:s}),A(null)}},children:"Save"})]})]})}),e.jsx(ae,{open:!!t,onOpenChange:s=>!s&&y(null),children:e.jsxs(te,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(le,{children:"Edit Destination Rule"}),e.jsx(ne,{children:"Update destination rule configuration"})]}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Name"}),e.jsx(d,{value:t.name,onChange:s=>y({...t,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Namespace"}),e.jsx(d,{value:t.namespace||"default",onChange:s=>y({...t,namespace:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Host"}),e.jsx(d,{value:t.host,onChange:s=>y({...t,host:s.target.value}),placeholder:"service.namespace.svc.cluster.local"})]}),e.jsx(Y,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(i,{className:"text-base font-semibold",children:"Traffic Policy"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Load Balancer"}),e.jsxs(X,{value:t.trafficPolicy?.loadBalancer?.simple||"ROUND_ROBIN",onValueChange:s=>y({...t,trafficPolicy:{...t.trafficPolicy,loadBalancer:{simple:s}}}),children:[e.jsx(K,{children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(o,{value:"ROUND_ROBIN",children:"Round Robin"}),e.jsx(o,{value:"LEAST_CONN",children:"Least Connections"}),e.jsx(o,{value:"RANDOM",children:"Random"})]})]})]}),e.jsx(Y,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(i,{className:"text-sm font-semibold",children:"Connection Pool"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Max Connections"}),e.jsx(d,{type:"number",value:t.trafficPolicy?.connectionPool?.tcp?.maxConnections||"",onChange:s=>y({...t,trafficPolicy:{...t.trafficPolicy,connectionPool:{...t.trafficPolicy?.connectionPool,tcp:{...t.trafficPolicy?.connectionPool?.tcp,maxConnections:s.target.value?parseInt(s.target.value):void 0}}}}),placeholder:"100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:'Connect Timeout (e.g., "30s")'}),e.jsx(d,{value:t.trafficPolicy?.connectionPool?.tcp?.connectTimeout||"",onChange:s=>y({...t,trafficPolicy:{...t.trafficPolicy,connectionPool:{...t.trafficPolicy?.connectionPool,tcp:{...t.trafficPolicy?.connectionPool?.tcp,connectTimeout:s.target.value||void 0}}}}),placeholder:"30s"})]})]})]}),e.jsx(Y,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(i,{className:"text-sm font-semibold",children:"Outlier Detection (Circuit Breaker)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Consecutive Errors"}),e.jsx(d,{type:"number",value:t.trafficPolicy?.outlierDetection?.consecutiveErrors||"",onChange:s=>y({...t,trafficPolicy:{...t.trafficPolicy,outlierDetection:{...t.trafficPolicy?.outlierDetection,consecutiveErrors:s.target.value?parseInt(s.target.value):void 0}}}),placeholder:"5"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of errors before circuit breaker opens"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:'Base Ejection Time (e.g., "30s")'}),e.jsx(d,{value:t.trafficPolicy?.outlierDetection?.baseEjectionTime||"",onChange:s=>y({...t,trafficPolicy:{...t.trafficPolicy,outlierDetection:{...t.trafficPolicy?.outlierDetection,baseEjectionTime:s.target.value||void 0}}}),placeholder:"30s"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Time before retrying after circuit breaker opens"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:'Interval (e.g., "10s")'}),e.jsx(d,{value:t.trafficPolicy?.outlierDetection?.interval||"",onChange:s=>y({...t,trafficPolicy:{...t.trafficPolicy,outlierDetection:{...t.trafficPolicy?.outlierDetection,interval:s.target.value||void 0}}}),placeholder:"10s"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Max Ejection Percent"}),e.jsx(d,{type:"number",min:"0",max:"100",value:t.trafficPolicy?.outlierDetection?.maxEjectionPercent||"",onChange:s=>y({...t,trafficPolicy:{...t.trafficPolicy,outlierDetection:{...t.trafficPolicy?.outlierDetection,maxEjectionPercent:s.target.value?parseInt(s.target.value):void 0}}}),placeholder:"50"})]})]})]})]})]}),e.jsxs(re,{children:[e.jsx(l,{variant:"outline",onClick:()=>y(null),children:"Cancel"}),e.jsx(l,{onClick:()=>{if(t){const s=O.map(a=>a.id===t.id?t:a);r({destinationRules:s}),y(null)}},children:"Save"})]})]})}),e.jsx(ae,{open:!!n,onOpenChange:s=>!s&&b(null),children:e.jsxs(te,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(le,{children:P.find(s=>s.id===n?.id)?"Edit Gateway":"Create Gateway"}),e.jsx(ne,{children:P.find(s=>s.id===n?.id)?"Update gateway configuration":"Configure a new gateway for ingress or egress traffic"})]}),n&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Name"}),e.jsx(d,{value:n.name,onChange:s=>b({...n,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Namespace"}),e.jsx(d,{value:n.namespace||"default",onChange:s=>b({...n,namespace:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Selector (JSON format)"}),e.jsx(ue,{value:JSON.stringify(n.selector||{},null,2),onChange:s=>{try{const a=JSON.parse(s.target.value);b({...n,selector:a})}catch{}},placeholder:'{"istio": "ingressgateway"}',className:"font-mono text-sm"})]}),e.jsx(Y,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{className:"text-base font-semibold",children:"Servers"}),e.jsxs(l,{type:"button",variant:"outline",size:"sm",onClick:()=>{const s={port:{number:80,protocol:"HTTP",name:"http"},hosts:["*"]};b({...n,servers:[...n.servers||[],s]})},children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Add Server"]})]}),!n.servers||n.servers.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No servers configured. Add a server to define ports and hosts."}):e.jsx("div",{className:"space-y-4",children:n.servers.map((s,a)=>e.jsxs(h,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(i,{className:"text-sm font-semibold",children:["Server ",a+1]}),e.jsx(l,{type:"button",variant:"ghost",size:"sm",onClick:()=>{const c=n.servers?.filter((v,_)=>_!==a)||[];b({...n,servers:c})},children:e.jsx(L,{className:"h-4 w-4 text-destructive"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Port Number"}),e.jsx(d,{type:"number",value:s.port.number,onChange:c=>{const v=[...n.servers||[]];v[a]={...s,port:{...s.port,number:parseInt(c.target.value)||80}},b({...n,servers:v})}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Protocol"}),e.jsxs(X,{value:s.port.protocol,onValueChange:c=>{const v=[...n.servers||[]];v[a]={...s,port:{...s.port,protocol:c}},b({...n,servers:v})},children:[e.jsx(K,{children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(o,{value:"HTTP",children:"HTTP"}),e.jsx(o,{value:"HTTPS",children:"HTTPS"}),e.jsx(o,{value:"TCP",children:"TCP"}),e.jsx(o,{value:"TLS",children:"TLS"}),e.jsx(o,{value:"GRPC",children:"gRPC"}),e.jsx(o,{value:"HTTP2",children:"HTTP2"}),e.jsx(o,{value:"MONGO",children:"MongoDB"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Port Name"}),e.jsx(d,{value:s.port.name||"",onChange:c=>{const v=[...n.servers||[]];v[a]={...s,port:{...s.port,name:c.target.value}},b({...n,servers:v})},placeholder:"http"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Hosts (comma-separated)"}),e.jsx(d,{value:s.hosts.join(", "),onChange:c=>{const v=c.target.value.split(",").map(xe=>xe.trim()).filter(xe=>xe),_=[...n.servers||[]];_[a]={...s,hosts:v},b({...n,servers:_})},placeholder:"*, example.com, *.example.com"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Use * for all hosts, or specify domain names"})]})]})]},a))})]})]}),e.jsxs(re,{children:[e.jsx(l,{variant:"outline",onClick:()=>b(null),children:"Cancel"}),e.jsx(l,{onClick:()=>{if(n){if(P.findIndex(a=>a.id===n.id)>=0){const a=P.map(c=>c.id===n.id?n:c);r({gateways:a})}else r({gateways:[...P,n]});b(null)}},children:"Save"})]})]})}),e.jsx(ae,{open:!!C,onOpenChange:s=>!s&&V(null),children:e.jsxs(te,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(le,{children:"Edit Peer Authentication"}),e.jsx(ne,{children:"Update mTLS authentication policy"})]}),C&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Name"}),e.jsx(d,{value:C.name,onChange:s=>V({...C,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Namespace"}),e.jsx(d,{value:C.namespace||"default",onChange:s=>V({...C,namespace:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"mTLS Mode"}),e.jsxs(X,{value:C.mtls?.mode||"PERMISSIVE",onValueChange:s=>V({...C,mtls:{mode:s}}),children:[e.jsx(K,{children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(o,{value:"STRICT",children:"STRICT - mTLS required"}),e.jsx(o,{value:"PERMISSIVE",children:"PERMISSIVE - mTLS optional"}),e.jsx(o,{value:"DISABLE",children:"DISABLE - no mTLS"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Selector (JSON format, optional)"}),e.jsx(ue,{value:JSON.stringify(C.selector?.matchLabels||{},null,2),onChange:s=>{try{const a=JSON.parse(s.target.value);V({...C,selector:{matchLabels:a}})}catch{}},placeholder:'{"app": "myapp"}',className:"font-mono text-sm"})]})]}),e.jsxs(re,{children:[e.jsx(l,{variant:"outline",onClick:()=>V(null),children:"Cancel"}),e.jsx(l,{onClick:()=>{if(C){const s=I.map(a=>a.id===C.id?C:a);r({peerAuthentications:s}),V(null)}},children:"Save"})]})]})}),e.jsx(ae,{open:!!S,onOpenChange:s=>!s&&q(null),children:e.jsxs(te,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(le,{children:"Edit Authorization Policy"}),e.jsx(ne,{children:"Update access control policy"})]}),S&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Name"}),e.jsx(d,{value:S.name,onChange:s=>q({...S,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Namespace"}),e.jsx(d,{value:S.namespace||"default",onChange:s=>q({...S,namespace:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Action"}),e.jsxs(X,{value:S.action||"ALLOW",onValueChange:s=>q({...S,action:s}),children:[e.jsx(K,{children:e.jsx(Z,{})}),e.jsxs(ee,{children:[e.jsx(o,{value:"ALLOW",children:"ALLOW - Allow access"}),e.jsx(o,{value:"DENY",children:"DENY - Deny access"}),e.jsx(o,{value:"AUDIT",children:"AUDIT - Audit only"}),e.jsx(o,{value:"CUSTOM",children:"CUSTOM - Custom action"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Selector (JSON format, optional)"}),e.jsx(ue,{value:JSON.stringify(S.selector?.matchLabels||{},null,2),onChange:s=>{try{const a=JSON.parse(s.target.value);q({...S,selector:{matchLabels:a}})}catch{}},placeholder:'{"app": "myapp"}',className:"font-mono text-sm"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:e.jsx("p",{children:"Rules can be configured in advanced mode. Basic configuration allows setting action and selector."})})]}),e.jsxs(re,{children:[e.jsx(l,{variant:"outline",onClick:()=>q(null),children:"Cancel"}),e.jsx(l,{onClick:()=>{if(S){const s=B.map(a=>a.id===S.id?S:a);r({authorizationPolicies:s}),q(null)}},children:"Save"})]})]})})]})})}export{Ds as IstioConfigAdvanced};

import{u as oe,j as e,r as C,K as he,B as v,i as o,S,C as n,e as i,f as d,k as c,T as xe,a as me,b as f,F as ue,c as je,d as b,h as g,P as F,m as P,L as h,I as u,N as Ne,l as $,t as _}from"./index-Dd33G1rA.js";import{T as pe}from"./textarea-DbhW0zkJ.js";import{R as ge}from"./refresh-ccw-BqMDkn9s.js";import{C as ve}from"./cloud-CWbIka4E.js";import{C as fe}from"./code-CeqdEWNh.js";import{D as be}from"./database-CTo8fyrd.js";import{S as ye}from"./shield-pnIeGi0d.js";function ze({componentId:A}){const{nodes:q,updateNode:G}=oe(),E=q.find(s=>s.id===A);if(!E)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const l=E.data.config||{},K=l.clusterName||"archiphoenix-cluster",x=l.nodes||["localhost:9200"],U=l.index||"archiphoenix-index",J=l.shards||5,M=l.replicas||1,O=l.refreshInterval||"1s",V=l.enableSSL??!1,L=l.enableAuth??!1,W=l.username||"elastic",X=l.password||"",j=l.indices||[],I=l.queries||[],N=l.clusterHealth||"green",Y=l.activeShards||10,Z=l.relocatingShards||0;l.initializingShards;const ee=l.totalDocs||j.reduce((s,a)=>s+a.docs,0),se=l.totalSize||j.reduce((s,a)=>s+a.size,0),[R,H]=C.useState(null),[ae,k]=C.useState(!1),[y,T]=C.useState(""),t=s=>{if(G(A,{data:{...E.data,config:{...l,...s}}}),s.nodes!==void 0){const a={...m};a.nodes&&delete a.nodes,w(a)}},[m,w]=C.useState({}),z=()=>{if(!x||x.length===0)return w({...m,nodes:"Необходимо указать хотя бы один узел"}),!1;if(x.filter(r=>{if(!r||!r.trim())return!0;const p=r.trim().split(":");if(p.length!==2)return!0;const D=parseInt(p[1]);return isNaN(D)||D<=0||D>65535}).length>0)return w({...m,nodes:"Неверный формат узла. Используйте формат host:port"}),!1;const a={...m};return a.nodes&&delete a.nodes,w(a),!0},Q=()=>z(),le=()=>{t({nodes:[...x,"localhost:9201"]})},re=s=>{t({nodes:x.filter((a,r)=>r!==s)})},te=(s,a)=>{const r=[...x];r[s]=a,t({nodes:r})},ne=()=>{t({indices:[...j,{name:"new-index",docs:0,size:0,shards:1,replicas:1,health:"yellow"}]})},ce=s=>{t({indices:j.filter((a,r)=>r!==s)})},B=(s,a,r)=>{const p=[...j];p[s]={...p[s],[a]:r},t({indices:p})},ie=()=>{if(!y.trim())return;const s={id:`query-${Date.now()}`,query:y,status:"running",duration:0,hits:0,took:0};t({queries:[s,...I.slice(0,9)]}),T(""),k(!1)},de=s=>{switch(s){case"green":return"bg-green-500";case"yellow":return"bg-yellow-500";case"red":return"bg-red-500";default:return"bg-gray-500"}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-500/10",children:e.jsx(he,{className:"h-6 w-6 text-green-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Elasticsearch"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Distributed Search & Analytics Engine"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(v,{variant:"outline",className:"gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${N==="green"?"bg-green-500":N==="yellow"?"bg-yellow-500":"bg-red-500"} animate-pulse`}),N==="green"?"Healthy":N==="yellow"?"Degraded":"Unhealthy"]}),e.jsxs(o,{size:"sm",variant:"outline",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(o,{size:"sm",variant:"outline",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Kibana"]})]})]}),e.jsx(S,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(n,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Indices"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:j.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Total indices"})]})]}),e.jsxs(n,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Documents"})}),e.jsxs(c,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[(ee/1e6).toFixed(1),"M"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Total documents"})]})]}),e.jsxs(n,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Size"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:se.toFixed(1)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"GB"})]})]}),e.jsxs(n,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Nodes"})}),e.jsxs(c,{children:[e.jsx("div",{className:"text-2xl font-bold",children:x.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Cluster nodes"})]})]})]}),e.jsxs(xe,{defaultValue:"indices",className:"w-full",children:[e.jsxs(me,{className:"grid w-full grid-cols-5",children:[e.jsxs(f,{value:"indices",className:"gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Indices"]}),e.jsxs(f,{value:"devtools",className:"gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"Dev Tools"]}),e.jsxs(f,{value:"cluster",className:"gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),"Cluster"]}),e.jsxs(f,{value:"security",className:"gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Security"]}),e.jsxs(f,{value:"settings",className:"gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Settings"]})]}),e.jsx(b,{value:"indices",className:"space-y-4 mt-4",children:e.jsxs(n,{children:[e.jsx(i,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Indices"}),e.jsx(g,{children:"Elasticsearch index configuration"})]}),e.jsxs(o,{size:"sm",onClick:ne,variant:"outline",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Create Index"]})]})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-3",children:j.map((s,a)=>e.jsxs(n,{className:"border-border",children:[e.jsx(i,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${de(s.health)}`}),e.jsxs("div",{children:[e.jsx(d,{className:"text-lg",children:s.name}),e.jsxs(g,{className:"text-xs mt-1",children:[s.shards," shards • ",s.replicas," replicas • Health: ",s.health]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{variant:s.health==="green"?"default":s.health==="yellow"?"secondary":"destructive",children:s.health}),j.length>1&&e.jsx(o,{size:"icon",variant:"ghost",onClick:()=>ce(a),children:e.jsx(P,{className:"h-4 w-4"})})]})]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Documents:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.docs.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Size:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[s.size," GB"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shards:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.shards})]})]}),R===a&&e.jsxs("div",{className:"pt-4 border-t space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Number of Shards"}),e.jsx(u,{type:"number",value:s.shards,onChange:r=>B(a,"shards",Number(r.target.value)),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Number of Replicas"}),e.jsx(u,{type:"number",value:s.replicas,onChange:r=>B(a,"replicas",Number(r.target.value)),min:0})]})]}),e.jsx(o,{size:"sm",variant:"outline",onClick:()=>H(null),children:"Done"})]}),R!==a&&e.jsx(o,{size:"sm",variant:"outline",onClick:()=>H(a),children:"Edit Settings"})]})]},a))})})]})}),e.jsx(b,{value:"devtools",className:"space-y-4 mt-4",children:e.jsxs(n,{children:[e.jsx(i,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Dev Tools"}),e.jsx(g,{children:"Execute Elasticsearch queries and API calls"})]}),e.jsxs(o,{size:"sm",onClick:()=>k(!0),variant:"outline",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"New Query"]})]})}),e.jsxs(c,{children:[ae&&e.jsxs(n,{className:"mb-4 border-primary",children:[e.jsx(i,{children:e.jsx(d,{children:"Execute Query"})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Query (JSON)"}),e.jsx(pe,{value:y,onChange:s=>T(s.target.value),placeholder:'GET /_search\\n{\\n  "query": {\\n    "match_all": {}\\n  }\\n}',rows:8,className:"font-mono text-sm"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(o,{onClick:ie,disabled:!y.trim(),children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Execute"]}),e.jsx(o,{variant:"outline",onClick:()=>{k(!1),T("")},children:"Cancel"})]})]})]}),I.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No queries executed"}):e.jsx("div",{className:"space-y-2",children:I.map(s=>e.jsx(n,{className:"border-l-4 border-l-blue-500",children:e.jsx(c,{className:"pt-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(v,{variant:s.status==="success"?"default":s.status==="error"?"destructive":"secondary",children:s.status}),s.took!==void 0&&e.jsxs(v,{variant:"outline",children:[s.took,"ms"]}),s.hits!==void 0&&e.jsxs(v,{variant:"outline",children:[s.hits," hits"]})]}),e.jsx("pre",{className:"text-xs font-mono bg-muted p-2 rounded overflow-x-auto",children:s.query})]})})})},s.id))})]})]})}),e.jsx(b,{value:"cluster",className:"space-y-4 mt-4",children:e.jsxs(n,{children:[e.jsxs(i,{children:[e.jsx(d,{children:"Cluster Configuration"}),e.jsx(g,{children:"Elasticsearch cluster connection and topology"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(n,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium",children:"Cluster Health"})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${N==="green"?"bg-green-500":N==="yellow"?"bg-yellow-500":"bg-red-500"}`}),e.jsx("span",{className:"text-lg font-semibold uppercase",children:N})]})})]}),e.jsxs(n,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium",children:"Active Shards"})}),e.jsx(c,{children:e.jsx("span",{className:"text-2xl font-bold",children:Y})})]}),e.jsxs(n,{children:[e.jsx(i,{className:"pb-3",children:e.jsx(d,{className:"text-sm font-medium",children:"Relocating"})}),e.jsx(c,{children:e.jsx("span",{className:"text-2xl font-bold",children:Z})})]})]}),e.jsx(S,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"cluster-name",children:"Cluster Name"}),e.jsx(u,{id:"cluster-name",value:K,onChange:s=>t({clusterName:s.target.value}),placeholder:"my-cluster"})]}),e.jsx(S,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(h,{children:["Node Addresses ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs(o,{size:"sm",onClick:le,variant:"outline",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Add Node"]})]}),x.length===0&&m.nodes&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive p-2 border border-destructive rounded",children:[e.jsx($,{className:"h-4 w-4"}),e.jsx("span",{children:m.nodes})]}),e.jsx("div",{className:"space-y-2",children:x.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{value:s,onChange:r=>{te(a,r.target.value),m.nodes&&z()},onBlur:z,placeholder:"localhost:9200",className:`flex-1 ${m.nodes?"border-destructive":""}`}),x.length>1&&e.jsx(o,{size:"icon",variant:"ghost",onClick:()=>re(a),children:e.jsx(P,{className:"h-4 w-4"})})]},a))}),m.nodes&&x.length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive",children:[e.jsx($,{className:"h-3 w-3"}),e.jsx("span",{children:m.nodes})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsx(o,{onClick:()=>{Q()?showSuccess("Параметры подключения сохранены"):showError("Пожалуйста, укажите хотя бы один корректный узел (host:port)")},children:"Сохранить настройки"}),e.jsx(o,{variant:"outline",onClick:()=>{Q()?showSuccess("Параметры подключения валидны"):showError("Пожалуйста, укажите хотя бы один корректный узел (host:port)")},children:"Проверить подключение"})]})]})]})}),e.jsx(b,{value:"security",className:"space-y-4 mt-4",children:e.jsxs(n,{children:[e.jsxs(i,{children:[e.jsx(d,{children:"Security Settings"}),e.jsx(g,{children:"SSL/TLS and authentication"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(h,{children:"Enable SSL/TLS"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Encrypt connections to cluster"})]}),e.jsx(_,{checked:V,onCheckedChange:s=>t({enableSSL:s})})]}),e.jsx(S,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(h,{children:"Enable Authentication"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Require authentication"})]}),e.jsx(_,{checked:L,onCheckedChange:s=>t({enableAuth:s})})]}),L&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"username",children:"Username"}),e.jsx(u,{id:"username",value:W,onChange:s=>t({username:s.target.value}),placeholder:"elastic"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"password",children:"Password"}),e.jsx(u,{id:"password",type:"password",value:X,onChange:s=>t({password:s.target.value}),placeholder:"password"})]})]})})]})]})}),e.jsx(b,{value:"settings",className:"space-y-4 mt-4",children:e.jsxs(n,{children:[e.jsxs(i,{children:[e.jsx(d,{children:"Index Settings"}),e.jsx(g,{children:"Default index configuration"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"index",children:"Index Name"}),e.jsx(u,{id:"index",value:U,onChange:s=>t({index:s.target.value}),placeholder:"my-index"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"shards",children:"Number of Shards"}),e.jsx(u,{id:"shards",type:"number",min:"1",max:"100",value:J,onChange:s=>t({shards:parseInt(s.target.value)||5})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"replicas",children:"Number of Replicas"}),e.jsx(u,{id:"replicas",type:"number",min:"0",max:"10",value:M,onChange:s=>t({replicas:parseInt(s.target.value)||1})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"refresh-interval",children:"Refresh Interval"}),e.jsx(u,{id:"refresh-interval",value:O,onChange:s=>t({refreshInterval:s.target.value}),placeholder:"1s"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How often to refresh the index (e.g., 1s, 5m)"})]})]})]})})]})]})})}export{ze as ElasticsearchConfigAdvanced};

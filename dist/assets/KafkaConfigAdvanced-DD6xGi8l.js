import{u as He,a as Ke,j as e,g as We,e as $e,r as v,B as y,S as Je,T as Ze,b as qe,c as D,A as X,F as de,d as Qe,f as G,C as f,h as S,i as R,k as A,l as h,P as O,m as I,n as V,I as d,o as $,L as i,p as ee,q as b,s as C,t as T,v as w,w as n,x as Ye,D as me,y as he,z as xe,E as ue,G as pe,H as je}from"./index-0yVPR4Zl.js";import{P as Xe}from"./progress-DepjVIQE.js";import{T as es}from"./textarea-DDJx7dm7.js";import{T as se,a as ae,b as re,c as te}from"./tooltip-DA4s8jVM.js";import{D as ge}from"./database-DOREgfmn.js";import{U as ne}from"./users-_FCiOnLf.js";import{S as ve}from"./shield-BjxQad9w.js";import{R as ss}from"./refresh-ccw-BqidHAae.js";function ms({componentId:U}){const{nodes:fe,updateNode:Ne}=He(),{componentMetrics:ye,isRunning:ie}=Ke(),J=fe.find(s=>s.id===U);if(!J)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const L=We(J.data.config,{}),u=L.brokers||["localhost:9092"],p=L.topics||[],B=L.consumerGroups||[],be=L.groupId||"default-group",Ce=L.clientId||"default-client",P=L.schemaRegistry||{url:"http://localhost:8081",subjects:[]},_=L.acls||[],m=$e.getKafkaRoutingEngine(U);ye.get(U)?.customMetrics;const[Te,ce]=v.useState({}),[Z,we]=v.useState(null),[ke,q]=v.useState(!1),[Se,H]=v.useState(!1),[Re,K]=v.useState(!1),[Q,Ae]=v.useState(null);v.useEffect(()=>{if(!m||!ie){ce({});return}const s=()=>{const a={};p.forEach(c=>{const t=m.getAllPartitionMetrics(c.name);t.length>0&&(a[c.name]=t)}),ce(a)};s();const r=setInterval(s,1e3);return()=>clearInterval(r)},[m,p,ie]);const[j,F]=v.useState({subjectName:"",schemaType:"AVRO",schema:""}),[l,k]=v.useState({principal:"User:",resourceType:"Topic",resourceName:"",resourcePatternType:"Literal",operation:"Read",permission:"Allow",host:"*"}),x=s=>{if(Ne(U,{data:{...J.data,config:{...L,...s}}}),s.brokers!==void 0){const r={...N};r.brokers&&delete r.brokers,W(r)}},[N,W]=v.useState({}),[g,le]=v.useState({}),Ie=s=>!s||s.trim().length===0?"Topic name is required":s.length>249?"Topic name must be 249 characters or less":/^[a-zA-Z0-9][a-zA-Z0-9._-]*$/.test(s)?s==="__consumer_offsets"||s.startsWith("__")?"Topic name cannot start with double underscore (reserved for internal topics)":null:"Topic name can only contain letters, numbers, dots, underscores, and hyphens. Cannot start with dot or underscore.",Le=(s,r)=>s<1?"Replication factor must be at least 1":s>u.length?`Replication factor cannot exceed number of brokers (${u.length})`:null,Pe=s=>s<1?"Number of partitions must be at least 1":s>1e4?"Number of partitions cannot exceed 10000":null,oe=()=>{if(!u||u.length===0)return W({...N,brokers:"Необходимо указать хотя бы один broker"}),!1;if(u.filter(a=>{if(!a||!a.trim())return!0;const c=a.trim().split(":");if(c.length!==2)return!0;const t=parseInt(c[1]);return isNaN(t)||t<=0||t>65535}).length>0)return W({...N,brokers:"Неверный формат broker. Используйте формат host:port"}),!1;const r={...N};return r.brokers&&delete r.brokers,W(r),!0},Fe=()=>{x({brokers:[...u,"localhost:9093"]})},Me=s=>{x({brokers:u.filter((r,a)=>a!==s)})},ze=(s,r)=>{const a=[...u];a[s]=r,x({brokers:a})},De=()=>{const s={name:"new-topic",partitions:3,replication:1,messages:0,size:0,config:{retentionMs:6048e5,cleanupPolicy:"delete",compressionType:"gzip",maxMessageBytes:1e6,minInsyncReplicas:1},partitionInfo:Array.from({length:3},(r,a)=>({id:a,leader:0,replicas:[0,1],isr:[0,1]}))};x({topics:[...p,s]}),q(!1)},Ge=s=>{x({topics:p.filter((r,a)=>a!==s)})},Y=(s,r,a)=>{const c=[...p];c[s]={...c[s],[r]:a};const t={...g[s]||{}};if(r==="name"){const o=Ie(String(a));o?t.name=o:delete t.name}else if(r==="replication"){const o=Le(Number(a));o?t.replication=o:delete t.replication}else if(r==="partitions"){const o=Pe(Number(a));o?t.partitions=o:delete t.partitions}if(Object.keys(t).length>0)le({...g,[s]:t});else{const o={...g};delete o[s],le(o)}x({topics:c})},M=(s,r,a)=>{const c=[...p];c[s].config||(c[s].config={}),c[s].config={...c[s].config,[r]:a},x({topics:c})},Be=()=>{x({consumerGroups:[...B,{id:"new-group",topic:p[0]?.name||"",lag:0,members:1,offsetStrategy:"latest",autoCommit:!0}]})},Ee=s=>{x({consumerGroups:B.filter((r,a)=>a!==s)})},E=(s,r,a)=>{const c=[...B];c[s]={...c[s],[r]:a},x({consumerGroups:c})},Oe=()=>{if(!j.subjectName.trim()||!j.schema.trim())return;const s={name:j.subjectName.trim(),version:1,schemaType:j.schemaType,schema:j.schema.trim()};x({schemaRegistry:{...P,subjects:[...P.subjects||[],s]}}),F({subjectName:"",schemaType:"AVRO",schema:""}),H(!1)},Ve=()=>{if(!l.principal.trim()||!l.resourceName.trim())return;const s={principal:l.principal.trim(),resourceType:l.resourceType,resourceName:l.resourceName.trim(),resourcePatternType:l.resourcePatternType,operation:l.operation,permission:l.permission,host:l.host||"*"};x({acls:[..._,s]}),k({principal:"User:",resourceType:"Topic",resourceName:"",resourcePatternType:"Literal",operation:"Read",permission:"Allow",host:"*"}),K(!1)},Ue=s=>{x({acls:_.filter((r,a)=>a!==s)})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:e.jsx(ge,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Kafka Cluster"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Apache Kafka Configuration & Management"})]})]})}),e.jsxs(y,{variant:"outline",className:"gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),"Configured"]})]}),e.jsx(Je,{}),e.jsxs(Ze,{defaultValue:"brokers",className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-6",children:[e.jsxs(D,{value:"brokers",className:"gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),"Brokers"]}),e.jsxs(D,{value:"topics",className:"gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Topics"]}),e.jsxs(D,{value:"consumers",className:"gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),"Consumers"]}),e.jsxs(D,{value:"schemas",className:"gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Schemas"]}),e.jsxs(D,{value:"acls",className:"gap-2",children:[e.jsx(ve,{className:"h-4 w-4"}),"ACLs"]}),e.jsxs(D,{value:"settings",className:"gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),"Settings"]})]}),e.jsx(G,{value:"brokers",className:"space-y-4 mt-4",children:e.jsxs(f,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Broker Cluster"}),e.jsx(A,{children:"Kafka broker endpoints and connection details"})]}),e.jsxs(h,{size:"sm",onClick:Fe,variant:"outline",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Add Broker"]})]})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-3",children:[u.length===0&&N.brokers&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive p-2 border border-destructive rounded",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{children:N.brokers})]}),u.map((s,r)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 border border-border rounded-lg bg-card",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-3",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),e.jsx(d,{value:s,onChange:a=>{ze(r,a.target.value),N.brokers&&oe()},onBlur:oe,placeholder:"localhost:9092",className:`flex-1 ${N.brokers?"border-destructive":""}`}),e.jsxs(y,{variant:"secondary",children:["Broker ",r+1]})]}),u.length>1&&e.jsx(h,{size:"icon",variant:"ghost",onClick:()=>Me(r),children:e.jsx($,{className:"h-4 w-4"})})]},r)),N.brokers&&u.length>0&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive",children:[e.jsx(V,{className:"h-3 w-3"}),e.jsx("span",{children:N.brokers})]})]})})]})}),e.jsxs(G,{value:"topics",className:"space-y-4 mt-4",children:[ke&&e.jsxs(f,{className:"mb-4 border-primary",children:[e.jsxs(S,{children:[e.jsx(R,{children:"Create New Topic"}),e.jsx(A,{children:"Configure topic settings"})]}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Topic Name"}),e.jsx(d,{placeholder:"my-topic"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Partitions"}),e.jsx(d,{type:"number",defaultValue:3,min:1})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Replication Factor"}),e.jsx(d,{type:"number",defaultValue:1,min:1,max:u.length})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{onClick:De,children:"Create Topic"}),e.jsx(h,{variant:"outline",onClick:()=>q(!1),children:"Cancel"})]})]})]}),e.jsxs(f,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Topics"}),e.jsx(A,{children:"Kafka topic configuration and monitoring"})]}),e.jsxs(h,{size:"sm",onClick:()=>q(!0),variant:"outline",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Create Topic"]})]})}),e.jsx(I,{children:p.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(X,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No topics configured"}),e.jsx("p",{className:"text-xs mt-2",children:'Click "Create Topic" to add a new topic'})]}):e.jsx("div",{className:"space-y-4",children:p.map((s,r)=>e.jsxs(f,{className:"border-border",children:[e.jsx(S,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(X,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(R,{className:"text-lg",children:s.name}),e.jsxs(A,{className:"text-xs mt-1",children:[s.partitions," partitions • ",s.replication," replicas"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{size:"sm",variant:"outline",onClick:()=>we(Z===r?null:r),children:Z===r?"Hide Config":"Show Config"}),p.length>1&&e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>Ge(r),children:e.jsx($,{className:"h-4 w-4"})})]})]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{children:"Topic Name"}),e.jsx(se,{children:e.jsxs(ae,{children:[e.jsx(re,{asChild:!0,children:e.jsx(ee,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(te,{children:e.jsx("p",{children:"Kafka topic name. Can contain letters, numbers, dots, underscores, and hyphens. Cannot start with dot or underscore. Max 249 characters."})})]})})]}),e.jsx(d,{value:s.name,onChange:a=>Y(r,"name",a.target.value),placeholder:"topic-name",className:g[r]?.name?"border-destructive":""}),g[r]?.name&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(V,{className:"h-3 w-3"}),g[r].name]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{children:"Partitions"}),e.jsx(se,{children:e.jsxs(ae,{children:[e.jsx(re,{asChild:!0,children:e.jsx(ee,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(te,{children:e.jsx("p",{children:"Number of partitions for this topic. More partitions allow higher parallelism but increase overhead. Recommended: 1-10000."})})]})})]}),e.jsx(d,{type:"number",min:"1",value:s.partitions,onChange:a=>Y(r,"partitions",parseInt(a.target.value)||1),className:g[r]?.partitions?"border-destructive":""}),g[r]?.partitions&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(V,{className:"h-3 w-3"}),g[r].partitions]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{children:"Replication Factor"}),e.jsx(se,{children:e.jsxs(ae,{children:[e.jsx(re,{asChild:!0,children:e.jsx(ee,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),e.jsx(te,{children:e.jsxs("p",{children:["Number of replicas for each partition. Must be between 1 and the number of brokers (",u.length,"). Higher replication improves durability but uses more storage."]})})]})})]}),e.jsx(d,{type:"number",min:"1",max:u.length,value:s.replication,onChange:a=>Y(r,"replication",parseInt(a.target.value)||1),className:g[r]?.replication?"border-destructive":""}),g[r]?.replication&&e.jsxs("p",{className:"text-xs text-destructive flex items-center gap-1",children:[e.jsx(V,{className:"h-3 w-3"}),g[r].replication]})]}),Z===r&&s.config&&e.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Topic Configuration"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Retention (ms)"}),e.jsx(d,{type:"number",value:s.config.retentionMs||6048e5,onChange:a=>M(r,"retentionMs",parseInt(a.target.value)||0),placeholder:"604800000 (7 days)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Retention (bytes)"}),e.jsx(d,{type:"number",value:s.config.retentionBytes||-1,onChange:a=>M(r,"retentionBytes",parseInt(a.target.value)||-1),placeholder:"-1 (unlimited)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Cleanup Policy"}),e.jsxs(b,{value:s.config.cleanupPolicy||"delete",onValueChange:a=>M(r,"cleanupPolicy",a),children:[e.jsx(C,{children:e.jsx(T,{})}),e.jsxs(w,{children:[e.jsx(n,{value:"delete",children:"Delete"}),e.jsx(n,{value:"compact",children:"Compact"}),e.jsx(n,{value:"delete,compact",children:"Delete, Compact"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Compression Type"}),e.jsxs(b,{value:s.config.compressionType||"gzip",onValueChange:a=>M(r,"compressionType",a),children:[e.jsx(C,{children:e.jsx(T,{})}),e.jsxs(w,{children:[e.jsx(n,{value:"uncompressed",children:"Uncompressed"}),e.jsx(n,{value:"gzip",children:"Gzip"}),e.jsx(n,{value:"snappy",children:"Snappy"}),e.jsx(n,{value:"lz4",children:"LZ4"}),e.jsx(n,{value:"zstd",children:"Zstd"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Max Message Bytes"}),e.jsx(d,{type:"number",value:s.config.maxMessageBytes||1e6,onChange:a=>M(r,"maxMessageBytes",parseInt(a.target.value)||1e6)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Min In-Sync Replicas"}),e.jsx(d,{type:"number",min:"1",value:s.config.minInsyncReplicas||1,onChange:a=>M(r,"minInsyncReplicas",parseInt(a.target.value)||1)})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-border",children:[e.jsx("h4",{className:"font-semibold text-sm mb-3",children:"Partition Details"}),e.jsx("div",{className:"space-y-2",children:(()=>{const a=Te[s.name]||[],c=s.partitionInfo||[];return a.length>0?a.map(t=>{const o=t.isr.length<t.replicas.length;return t.highWatermark-t.offset,e.jsxs("div",{className:"p-3 border rounded-lg bg-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-mono font-semibold",children:["Partition ",t.partitionId]}),o&&e.jsx(y,{variant:"destructive",className:"text-xs",children:"Under-replicated"}),!o&&t.isr.length===t.replicas.length&&e.jsx(y,{variant:"default",className:"text-xs bg-green-500",children:"Healthy"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Leader: ",t.leader]}),e.jsxs("span",{children:["Replicas: [",t.replicas.join(", "),"]"]}),e.jsxs("span",{children:["ISR: [",t.isr.join(", "),"]"]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-xs mt-2 pt-2 border-t border-border",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Messages:"}),e.jsx("span",{className:"ml-1 font-semibold",children:t.messages.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Size:"}),e.jsxs("span",{className:"ml-1 font-semibold",children:[(t.size/1024/1024).toFixed(2)," MB"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Offset:"}),e.jsx("span",{className:"ml-1 font-semibold",children:t.offset})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"HW:"}),e.jsx("span",{className:"ml-1 font-semibold",children:t.highWatermark})]})]})]},t.partitionId)}):c.length>0?c.map((t,o)=>e.jsx("div",{className:"p-2 border rounded text-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"font-mono",children:["Partition ",t.id]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Leader: ",t.leader]}),e.jsxs("span",{children:["Replicas: [",t.replicas.join(", "),"]"]}),e.jsxs("span",{children:["ISR: [",t.isr.join(", "),"]"]})]})]})},o)):e.jsx("div",{className:"text-sm text-muted-foreground p-2",children:"No partition information available"})})()})]}),e.jsx("div",{className:"pt-3 border-t border-border",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Messages:"}),e.jsx("span",{className:"ml-2 font-semibold",children:(()=>{if(m){const a=m.getTopicMetrics(s.name);if(a)return a.messages.toLocaleString()}return(s.messages||0).toLocaleString()})()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Size:"}),e.jsx("span",{className:"ml-2 font-semibold",children:(()=>{if(m){const a=m.getTopicMetrics(s.name);if(a)return(a.size/1024/1024).toFixed(2)+" MB"}return((s.size||0)/1024/1024).toFixed(2)+" MB"})()})]})]})})]})]},r))})})]})]}),e.jsx(G,{value:"consumers",className:"space-y-4 mt-4",children:e.jsxs(f,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Consumer Groups"}),e.jsx(A,{children:"Monitor consumer group lag and activity"})]}),e.jsxs(h,{size:"sm",onClick:Be,variant:"outline",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Add Group"]})]})}),e.jsx(I,{children:B.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ne,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No consumer groups configured"})]}):e.jsx("div",{className:"space-y-3",children:B.map((s,r)=>e.jsxs(f,{className:"border-border",children:[e.jsx(S,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(ne,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(R,{className:"text-lg",children:s.id}),e.jsxs(A,{className:"text-xs mt-1",children:["Topic: ",s.topic," • ",s.members||0," members"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(y,{variant:(m?m.getConsumerGroupLag(s.id,s.topic):s.lag||0)>1e3?"destructive":"secondary",children:["Lag: ",(()=>{if(m){const a=m.getConsumerGroupLag(s.id,s.topic);return Math.round(a)}return Math.round(s.lag||0)})()]}),m&&(()=>{const a=m.getConsumptionRate(s.id,s.topic);return a>0?e.jsxs(y,{variant:"outline",children:[Math.round(a)," msg/s"]}):null})(),e.jsx(h,{size:"sm",variant:"outline",onClick:()=>Ae(Q===r?null:r),children:Q===r?"Hide":"Edit"}),e.jsx(h,{size:"sm",variant:"ghost",onClick:()=>Ee(r),children:e.jsx($,{className:"h-4 w-4"})})]})]})}),e.jsx(I,{className:"space-y-4",children:Q===r?e.jsxs("div",{className:"space-y-4 pt-2 border-t border-border",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Group ID"}),e.jsx(d,{value:s.id,onChange:a=>E(r,"id",a.target.value),placeholder:"consumer-group-id"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Topic"}),e.jsxs(b,{value:s.topic,onValueChange:a=>E(r,"topic",a),children:[e.jsx(C,{children:e.jsx(T,{})}),e.jsx(w,{children:p.map(a=>e.jsx(n,{value:a.name,children:a.name},a.name))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Members"}),e.jsx(d,{type:"number",min:"1",value:s.members||1,onChange:a=>E(r,"members",parseInt(a.target.value)||1)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Offset Strategy"}),e.jsxs(b,{value:s.offsetStrategy||"latest",onValueChange:a=>E(r,"offsetStrategy",a),children:[e.jsx(C,{children:e.jsx(T,{})}),e.jsxs(w,{children:[e.jsx(n,{value:"earliest",children:"Earliest"}),e.jsx(n,{value:"latest",children:"Latest"}),e.jsx(n,{value:"none",children:"None"})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{htmlFor:`auto-commit-${r}`,children:"Auto Commit"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically commit offsets after consuming messages"})]}),e.jsx(Ye,{id:`auto-commit-${r}`,checked:s.autoCommit!==!1,onCheckedChange:a=>E(r,"autoCommit",a)})]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Members:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.members||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Offset:"}),e.jsx("span",{className:"ml-2 font-semibold capitalize",children:s.offsetStrategy||"latest"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Auto Commit:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.autoCommit!==!1?"Yes":"No"})]}),m&&(()=>{const a=m.getConsumptionRate(s.id,s.topic);return a>0?e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Consumption Rate:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[Math.round(a)," msg/s"]})]}):null})()]}),(()=>{const a=m?m.getConsumerGroupLag(s.id,s.topic):s.lag||0;return e.jsx(Xe,{value:Math.min(a/1e4*100,100),className:"h-2"})})(),m&&(()=>{const a=m.getConsumerGroupState(s.id),c=a?.partitionAssignment;if(c&&c.size>0){const t=[];return c.forEach((o,z)=>{t.push({memberId:z,partitions:o})}),e.jsxs("div",{className:"pt-2 border-t border-border mt-2",children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground mb-2",children:"Partition Assignment:"}),e.jsx("div",{className:"space-y-1",children:t.map(o=>e.jsxs("div",{className:"text-xs",children:[e.jsxs("span",{className:"font-mono",children:["Member ",o.memberId,":"]}),e.jsxs("span",{className:"ml-2 text-muted-foreground",children:["[",o.partitions.sort((z,_e)=>z-_e).join(", "),"]"]})]},o.memberId))}),a?.isRebalancing&&e.jsxs(y,{variant:"outline",className:"mt-2 text-xs",children:[e.jsx(ss,{className:"h-3 w-3 mr-1 animate-spin"}),"Rebalancing..."]})]})}return null})()]})})]},r))})})]})}),e.jsx(G,{value:"schemas",className:"space-y-4 mt-4",children:e.jsxs(f,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Schema Registry"}),e.jsx(A,{children:"Avro/JSON Schema management"})]}),e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>{F({subjectName:"",schemaType:"AVRO",schema:""}),H(!0)},children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Register Schema"]})]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Schema Registry URL"}),e.jsx(d,{value:P.url||"",onChange:s=>x({schemaRegistry:{...P,url:s.target.value}}),placeholder:"http://localhost:8081"})]}),P.subjects&&P.subjects.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Registered Subjects"}),P.subjects.map((s,r)=>e.jsx(f,{className:"p-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"font-semibold",children:s.name}),s.schemaType&&e.jsx(y,{variant:"outline",className:"text-xs",children:s.schemaType})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Version ",s.version]}),s.schema&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1 font-mono truncate max-w-md",children:[s.schema.substring(0,100),s.schema.length>100?"...":""]})]})})},r))]}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(de,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No schemas registered"})]})]})]})}),e.jsx(G,{value:"acls",className:"space-y-4 mt-4",children:e.jsxs(f,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Access Control Lists"}),e.jsx(A,{children:"Manage topic and consumer group permissions"})]}),e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>{k({principal:"User:",resourceType:"Topic",resourceName:p[0]?.name||"",resourcePatternType:"Literal",operation:"Read",permission:"Allow",host:"*"}),K(!0)},children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Add ACL"]})]})}),e.jsx(I,{children:_.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ve,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No ACLs configured"})]}):e.jsx("div",{className:"space-y-3",children:_.map((s,r)=>{const a=s,c=a.resourceType||"Topic",t=a.resourceName||a.resource||"unknown",o=a.resourcePatternType||"Literal",z=a.host||"*";return e.jsx(f,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:"font-semibold",children:s.principal}),e.jsx(y,{variant:s.permission==="Allow"?"default":"destructive",className:"text-xs",children:s.permission})]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:[c,":"]})," ",t,o!=="Literal"&&e.jsx(y,{variant:"outline",className:"ml-2 text-xs",children:o})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Operation:"})," ",s.operation,z!=="*"&&e.jsxs("span",{className:"ml-2",children:["• Host: ",z]})]})]})]}),e.jsx(h,{size:"icon",variant:"ghost",onClick:()=>Ue(r),children:e.jsx($,{className:"h-4 w-4"})})]})},r)})})})]})}),e.jsx(G,{value:"settings",className:"space-y-4 mt-4",children:e.jsxs(f,{children:[e.jsxs(S,{children:[e.jsx(R,{children:"Client Settings"}),e.jsx(A,{children:"Consumer group and client configuration"})]}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"group-id",children:"Consumer Group ID"}),e.jsx(d,{id:"group-id",value:be,onChange:s=>x({groupId:s.target.value}),placeholder:"default-group"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"client-id",children:"Client ID"}),e.jsx(d,{id:"client-id",value:Ce,onChange:s=>x({clientId:s.target.value}),placeholder:"default-client"})]})]})]})})]}),e.jsx(me,{open:Se,onOpenChange:H,children:e.jsxs(he,{className:"max-w-2xl",children:[e.jsxs(xe,{children:[e.jsx(ue,{children:"Register Schema"}),e.jsx(pe,{children:"Register a new schema in Schema Registry. The subject name typically follows the pattern: topic-name-value or topic-name-key."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[p.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Select Topic (optional)"}),e.jsxs(b,{onValueChange:s=>{F({...j,subjectName:`${s}-value`})},children:[e.jsx(C,{children:e.jsx(T,{placeholder:"Choose a topic to auto-fill subject name"})}),e.jsx(w,{children:p.map(s=>e.jsx(n,{value:s.name,children:s.name},s.name))})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Selecting a topic will set subject name to: topic-name-value"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"subject-name",children:"Subject Name"}),e.jsx(d,{id:"subject-name",value:j.subjectName,onChange:s=>F({...j,subjectName:s.target.value}),placeholder:"my-topic-value"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Subject name (e.g., topic-name-value, topic-name-key). In Schema Registry, subjects are typically named as topic-name-value or topic-name-key."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"schema-type",children:"Schema Type"}),e.jsxs(b,{value:j.schemaType,onValueChange:s=>F({...j,schemaType:s}),children:[e.jsx(C,{id:"schema-type",children:e.jsx(T,{})}),e.jsxs(w,{children:[e.jsx(n,{value:"AVRO",children:"AVRO"}),e.jsx(n,{value:"JSON",children:"JSON"}),e.jsx(n,{value:"PROTOBUF",children:"PROTOBUF"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"schema-content",children:"Schema Content"}),e.jsx(es,{id:"schema-content",value:j.schema,onChange:s=>F({...j,schema:s.target.value}),placeholder:'{"type": "record", "name": "Example", "fields": [{"name": "field1", "type": "string"}]}',className:"font-mono text-sm h-48"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter the schema definition in JSON format"})]})]}),e.jsxs(je,{children:[e.jsx(h,{variant:"outline",onClick:()=>H(!1),children:"Cancel"}),e.jsx(h,{onClick:Oe,disabled:!j.subjectName.trim()||!j.schema.trim(),children:"Register Schema"})]})]})}),e.jsx(me,{open:Re,onOpenChange:K,children:e.jsxs(he,{className:"max-w-2xl",children:[e.jsxs(xe,{children:[e.jsx(ue,{children:"Add Access Control List (ACL)"}),e.jsx(pe,{children:"Create a new ACL rule to control access to Kafka resources. Principal format: User:username or Group:groupname"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"principal",children:"Principal"}),e.jsx(d,{id:"principal",value:l.principal,onChange:s=>k({...l,principal:s.target.value}),placeholder:"User:alice or Group:developers"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Format: User:username or Group:groupname"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"resource-type",children:"Resource Type"}),e.jsxs(b,{value:l.resourceType,onValueChange:s=>k({...l,resourceType:s}),children:[e.jsx(C,{id:"resource-type",children:e.jsx(T,{})}),e.jsxs(w,{children:[e.jsx(n,{value:"Topic",children:"Topic"}),e.jsx(n,{value:"Group",children:"Group"}),e.jsx(n,{value:"Cluster",children:"Cluster"}),e.jsx(n,{value:"TransactionalId",children:"TransactionalId"}),e.jsx(n,{value:"DelegationToken",children:"DelegationToken"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"resource-pattern-type",children:"Pattern Type"}),e.jsxs(b,{value:l.resourcePatternType,onValueChange:s=>k({...l,resourcePatternType:s}),children:[e.jsx(C,{id:"resource-pattern-type",children:e.jsx(T,{})}),e.jsxs(w,{children:[e.jsx(n,{value:"Literal",children:"Literal"}),e.jsx(n,{value:"Prefixed",children:"Prefixed"}),e.jsx(n,{value:"Match",children:"Match"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"resource-name",children:"Resource Name"}),e.jsx(d,{id:"resource-name",value:l.resourceName,onChange:s=>k({...l,resourceName:s.target.value}),placeholder:l.resourceType==="Topic"?"my-topic":l.resourceType==="Group"?"my-group":"resource-name"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"operation",children:"Operation"}),e.jsxs(b,{value:l.operation,onValueChange:s=>k({...l,operation:s}),children:[e.jsx(C,{id:"operation",children:e.jsx(T,{})}),e.jsxs(w,{children:[e.jsx(n,{value:"Read",children:"Read"}),e.jsx(n,{value:"Write",children:"Write"}),e.jsx(n,{value:"Create",children:"Create"}),e.jsx(n,{value:"Delete",children:"Delete"}),e.jsx(n,{value:"Alter",children:"Alter"}),e.jsx(n,{value:"Describe",children:"Describe"}),e.jsx(n,{value:"AlterConfigs",children:"AlterConfigs"}),e.jsx(n,{value:"DescribeConfigs",children:"DescribeConfigs"}),e.jsx(n,{value:"ClusterAction",children:"ClusterAction"}),e.jsx(n,{value:"IdempotentWrite",children:"IdempotentWrite"}),e.jsx(n,{value:"All",children:"All"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"permission",children:"Permission"}),e.jsxs(b,{value:l.permission,onValueChange:s=>k({...l,permission:s}),children:[e.jsx(C,{id:"permission",children:e.jsx(T,{})}),e.jsxs(w,{children:[e.jsx(n,{value:"Allow",children:"Allow"}),e.jsx(n,{value:"Deny",children:"Deny"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"host",children:"Host (optional)"}),e.jsx(d,{id:"host",value:l.host,onChange:s=>k({...l,host:s.target.value}),placeholder:"* (all hosts)"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"IP address or hostname. Use * for all hosts."})]})]}),e.jsxs(je,{children:[e.jsx(h,{variant:"outline",onClick:()=>K(!1),children:"Cancel"}),e.jsx(h,{onClick:Ve,disabled:!l.principal.trim()||!l.resourceName.trim(),children:"Add ACL"})]})]})})]})})}export{ms as KafkaConfigAdvanced};

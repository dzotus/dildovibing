import{u as L,j as e,i as R,S as w,C as n,e as a,f as l,k as c,R as N,Z as K,T as G,a as z,b,c as F,d as f,h as v,B as r,L as o,n as I,o as S,p as P,q as k,s as x,t as B,I as T}from"./index-2Qx8irw2.js";import{R as H}from"./refresh-ccw-DHaGPCfE.js";import{U as y}from"./users-B0LkoMSP.js";import{L as U}from"./lock-shdaLOJW.js";import{C as Z}from"./clock-DYxsyur0.js";function Y({componentId:C}){const{nodes:A,updateNode:V}=L(),p=A.find(s=>s.id===C);if(!p)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const t=p.data.config||{},m=t.connections||[{id:"conn-1",username:"user1",remoteIP:"203.0.113.10",localIP:"10.8.0.5",status:"connected",connectedAt:new Date(Date.now()-36e5).toISOString(),bytesIn:1024e6,bytesOut:512e6,duration:3600},{id:"conn-2",username:"user2",remoteIP:"203.0.113.11",localIP:"10.8.0.6",status:"connected",connectedAt:new Date(Date.now()-18e5).toISOString(),bytesIn:512e6,bytesOut:256e6,duration:1800}],g=t.tunnels||[{id:"tunnel-1",name:"HQ to Branch",type:"site-to-site",remoteEndpoint:"192.168.100.1",status:"up",connections:1,bytesIn:2048e6,bytesOut:1024e6},{id:"tunnel-2",name:"Remote Access",type:"remote-access",remoteEndpoint:"vpn.example.com",status:"up",connections:2,bytesIn:1536e6,bytesOut:768e6}],O=t.totalConnections||m.length,E=t.activeConnections||m.filter(s=>s.status==="connected").length,D=t.totalTunnels||g.length,M=t.totalBytes||m.reduce((s,i)=>s+(i.bytesIn||0)+(i.bytesOut||0),0),d=s=>{V(C,{data:{...p.data,config:{...t,...s}}})},u=s=>{switch(s){case"connected":case"up":return"bg-green-500";case"disconnected":case"down":return"bg-gray-500";case"connecting":return"bg-yellow-500";default:return"bg-gray-500"}},j=s=>{if(!s)return"0 B";const i=["B","KB","MB","GB"],h=Math.floor(Math.log(s)/Math.log(1024));return`${(s/Math.pow(1024,h)).toFixed(2)} ${i[h]}`},$=s=>{if(!s)return"0s";const i=Math.floor(s/3600),h=Math.floor(s%3600/60);return i>0?`${i}h ${h}m`:`${h}m`};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"VPN Concentrator"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Virtual Private Network"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Secure remote access and site-to-site connectivity"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(R,{variant:"outline",size:"sm",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(w,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(n,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(a,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-sm font-medium text-muted-foreground",children:"Connections"}),e.jsx(y,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:E}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/ ",O," total"]})]})})]}),e.jsxs(n,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(a,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-sm font-medium text-muted-foreground",children:"Tunnels"}),e.jsx(N,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:D}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"active"})]})})]}),e.jsxs(n,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(a,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-sm font-medium text-muted-foreground",children:"Data Transferred"}),e.jsx(K,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(c,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:(M/1024/1024/1024).toFixed(2)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"GB"})]})})]}),e.jsxs(n,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(a,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{className:"text-sm font-medium text-muted-foreground",children:"Encryption"}),e.jsx(U,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsx(c,{children:e.jsx("div",{className:"text-sm font-semibold text-cyan-600 dark:text-cyan-400",children:"AES-256"})})]})]}),e.jsxs(G,{defaultValue:"connections",className:"space-y-4",children:[e.jsxs(z,{children:[e.jsxs(b,{value:"connections",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Connections (",m.length,")"]}),e.jsxs(b,{value:"tunnels",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"Tunnels (",g.length,")"]}),e.jsxs(b,{value:"settings",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(f,{value:"connections",className:"space-y-4",children:e.jsxs(n,{children:[e.jsxs(a,{children:[e.jsx(l,{children:"Active Connections"}),e.jsx(v,{children:"VPN client connections"})]}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsxs(n,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(a,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${u(s.status)}/20`,children:e.jsx(y,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(l,{className:"text-lg font-semibold",children:s.username}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(r,{variant:"outline",className:u(s.status),children:s.status}),e.jsx(r,{variant:"outline",className:"font-mono text-xs",children:s.remoteIP}),s.localIP&&e.jsx(r,{variant:"outline",className:"font-mono text-xs",children:s.localIP}),s.duration&&e.jsxs(r,{variant:"outline",children:[e.jsx(Z,{className:"h-3 w-3 mr-1"}),$(s.duration)]})]})]})]})})}),e.jsxs(c,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Bytes In:"}),e.jsx("span",{className:"ml-2 font-semibold",children:j(s.bytesIn)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Bytes Out:"}),e.jsx("span",{className:"ml-2 font-semibold",children:j(s.bytesOut)})]})]}),s.connectedAt&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Connected: ",new Date(s.connectedAt).toLocaleString()]})]})]},s.id))})})]})}),e.jsx(f,{value:"tunnels",className:"space-y-4",children:e.jsxs(n,{children:[e.jsxs(a,{children:[e.jsx(l,{children:"VPN Tunnels"}),e.jsx(v,{children:"Site-to-site and remote access tunnels"})]}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:g.map(s=>e.jsxs(n,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(a,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${u(s.status)}/20`,children:e.jsx(N,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx(l,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(r,{variant:"outline",className:u(s.status),children:s.status}),e.jsx(r,{variant:"outline",children:s.type}),e.jsx(r,{variant:"outline",className:"font-mono text-xs",children:s.remoteEndpoint}),s.connections&&e.jsxs(r,{variant:"outline",className:"bg-blue-50 dark:bg-blue-950/20 text-blue-700 dark:text-blue-300",children:[s.connections," connections"]})]})]})]})}),e.jsx(c,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Bytes In:"}),e.jsx("span",{className:"ml-2 font-semibold",children:j(s.bytesIn)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Bytes Out:"}),e.jsx("span",{className:"ml-2 font-semibold",children:j(s.bytesOut)})]})]})})]},s.id))})})]})}),e.jsx(f,{value:"settings",className:"space-y-4",children:e.jsxs(n,{children:[e.jsxs(a,{children:[e.jsx(l,{children:"VPN Settings"}),e.jsx(v,{children:"VPN concentrator configuration"})]}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"VPN Protocol"}),e.jsxs(I,{value:t.vpnProtocol??"openvpn",onValueChange:s=>d({vpnProtocol:s}),children:[e.jsx(S,{children:e.jsx(P,{})}),e.jsxs(k,{children:[e.jsx(x,{value:"openvpn",children:"OpenVPN"}),e.jsx(x,{value:"ipsec",children:"IPsec"}),e.jsx(x,{value:"wireguard",children:"WireGuard"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Encryption Algorithm"}),e.jsxs(I,{value:t.encryptionAlgorithm??"aes-256",onValueChange:s=>d({encryptionAlgorithm:s}),children:[e.jsx(S,{children:e.jsx(P,{})}),e.jsxs(k,{children:[e.jsx(x,{value:"aes-256",children:"AES-256"}),e.jsx(x,{value:"aes-128",children:"AES-128"}),e.jsx(x,{value:"chacha20-poly1305",children:"ChaCha20"})]})]})]}),e.jsx(w,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{children:"Enable Compression"}),e.jsx(B,{checked:t.enableCompression??!0,onCheckedChange:s=>d({enableCompression:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{children:"Enable Keep-Alive"}),e.jsx(B,{checked:t.enableKeepAlive??!0,onCheckedChange:s=>d({enableKeepAlive:s})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Max Connections"}),e.jsx(T,{type:"number",value:t.maxConnections??100,onChange:s=>d({maxConnections:parseInt(s.target.value)||100}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Connection Timeout (seconds)"}),e.jsx(T,{type:"number",value:t.connectionTimeout??120,onChange:s=>d({connectionTimeout:parseInt(s.target.value)||120}),min:1})]})]})]})})]})]})})}export{Y as VPNConfigAdvanced};

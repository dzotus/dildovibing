import{K as Se,u as As,a as Ps,j as e,e as ze,r as h,bd as ee,l as S,S as K,C as y,h as N,i as k,m as b,T as Es,b as Ls,c as se,aA as pe,be as Ts,d as $s,f as te,k as ne,a5 as Rs,I as U,q as E,s as L,t as T,v as $,w as c,B as A,ax as Oe,o as Me,a8 as Ue,a9 as He,a7 as Bs,aa as Fe,ab as q,F as ae,U as zs,bf as Os,a4 as Ms,P as Us,aI as Ve,L as g,a6 as Hs,ae as Fs,x as H,y as Vs,z as Gs,E as Js,G as Ks,H as qs,ag as Xs,bg as Ge}from"./index-HDGrDyRq.js";import{u as _s}from"./use-toast-XAAHaGVT.js";import{T as Qs}from"./textarea-CjQgIquO.js";import{R as Ws}from"./refresh-ccw-BUKvY8S7.js";import{S as Ys}from"./shield-DzL7mY-o.js";import{R as re,L as Zs,C as je,X as ge,Y as fe,T as ie,b as et,a as st,B as le,s as tt}from"./LineChart-Cj16NB3Q.js";import{B as Je}from"./BarChart-DhtmkRt5.js";import{P as nt,a as at}from"./PieChart-CK27OCfB.js";import{C as ve}from"./circle-check-big-3lbqtoL4.js";import"./value-DZlexiVD.js";const rt=[["path",{d:"M3 7V5c0-1.1.9-2 2-2h2",key:"adw53z"}],["path",{d:"M17 3h2c1.1 0 2 .9 2 2v2",key:"an4l38"}],["path",{d:"M21 17v2c0 1.1-.9 2-2 2h-2",key:"144t0e"}],["path",{d:"M7 21H5c-1.1 0-2-.9-2-2v-2",key:"rtnfgi"}],["rect",{width:"7",height:"5",x:"7",y:"7",rx:"1",key:"1eyiv7"}],["rect",{width:"7",height:"5",x:"10",y:"12",rx:"1",key:"1qlmkx"}]],it=Se("group",rt);const lt=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ct=Se("square-check-big",lt);const ot=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],dt=Se("square",ot);function Nt({componentId:B}){const{nodes:Ke,updateNode:ye}=As(),{getComponentMetrics:qe}=Ps(),{toast:o}=_s(),F=Ke.find(s=>s.id===B);if(!F)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const f=F.data.config||{},be=f.mode||"ids",Xe=f.enableSignatureDetection??!0,_e=f.enableAnomalyDetection??!0,Qe=f.enableBehavioralAnalysis??!1,we=f.alertThreshold||"medium",Ne=f.enableAutoBlock??!1,We=f.blockDuration||3600,ke=f.enableLogging??!0,Ye=f.logRetention||30;qe(B);const C=ze.getIDSIPSEmulationEngine(B),[Ce,Ie]=h.useState([]),[De,Ae]=h.useState([]),[ce,Pe]=h.useState({totalAlerts:0,alertsBlocked:0,signaturesActive:0,blockedIPs:0});h.useEffect(()=>{if(!C)return;const s=()=>{const t=C.getAlerts(100),r=C.getBlockedIPs(),i=C.getStats();Ie(t.map(a=>({id:a.id,type:a.type,sourceIP:a.sourceIP,destinationIP:a.destinationIP,protocol:a.protocol,port:a.port,severity:a.severity,timestamp:new Date(a.timestamp).toISOString(),description:a.description,blocked:a.blocked,signature:a.signature}))),Ae(r.map(a=>({ip:a.ip,reason:a.reason,blockedAt:new Date(a.blockedAt).toISOString(),expiresAt:a.expiresAt?new Date(a.expiresAt).toISOString():void 0,duration:a.expiresAt?Math.floor((a.expiresAt-a.blockedAt)/1e3):void 0}))),Pe({totalAlerts:i.alertsGenerated,alertsBlocked:i.alertsBlocked,signaturesActive:i.activeSignatures,blockedIPs:i.blockedIPs})},n=setInterval(s,1e3);return s(),()=>clearInterval(n)},[C]);const v=Array.isArray(f.signatures)?f.signatures:[],Ze=h.useMemo(()=>JSON.stringify(v.map(s=>({id:s.id,pattern:s.pattern}))),[v]);h.useEffect(()=>{const s=new Map;v.forEach(n=>{if(n.pattern){const t=ee(n.pattern);s.set(n.id,t)}}),Ee(s)},[Ze]);const R=Ce.length>0?Ce:f.alerts||[],V=De.length>0?De:f.blockedIPs||[],es=ce.totalAlerts||f.totalAlerts||R.length,ss=ce.alertsBlocked||f.alertsBlocked||R.filter(s=>s.blocked).length,ts=ce.signaturesActive||f.signaturesActive||v.filter(s=>s.enabled).length,[ht,ut]=h.useState(null),[mt,ns]=h.useState(!1),[oe,as]=h.useState(""),[X,rs]=h.useState("all"),[_,is]=h.useState("all"),[Q,ls]=h.useState("all"),[G,cs]=h.useState("none"),[P,Ee]=h.useState(new Map),[p,z]=h.useState(new Set),[os,Le]=h.useState(!1),[W,ds]=h.useState(null),[de,Y]=h.useState(""),[O,Z]=h.useState(null),he=h.useRef(F);h.useEffect(()=>{he.current=F},[F]);const j=h.useCallback(()=>{const s=he.current;if(!s)return[];const n=s.data.config||{};return Array.isArray(n.signatures)?n.signatures:[]},[]),u=h.useCallback(s=>{const n=he.current;if(!n)return;const r={...n.data.config||{},...s};ye(B,{data:{...n.data,config:r}});try{const i=ze.getIDSIPSEmulationEngine(B);i&&i.initializeConfig({...n,data:{...n.data,config:r}})}catch{}},[B,ye]),hs=()=>{if(C){const s=C.getAlerts(100),n=C.getBlockedIPs(),t=C.getStats();Ie(s.map(r=>({id:r.id,type:r.type,sourceIP:r.sourceIP,destinationIP:r.destinationIP,protocol:r.protocol,port:r.port,severity:r.severity,timestamp:new Date(r.timestamp).toISOString(),description:r.description,blocked:r.blocked,signature:r.signature}))),Ae(n.map(r=>({ip:r.ip,reason:r.reason,blockedAt:new Date(r.blockedAt).toISOString(),expiresAt:r.expiresAt?new Date(r.expiresAt).toISOString():void 0,duration:r.expiresAt?Math.floor((r.expiresAt-r.blockedAt)/1e3):void 0}))),Pe({totalAlerts:t.alertsGenerated,alertsBlocked:t.alertsBlocked,signaturesActive:t.activeSignatures,blockedIPs:t.blockedIPs}),o({title:"Refreshed",description:"IDS/IPS data has been refreshed"})}},us=h.useCallback(()=>{const s=j(),n={id:`sig-${Date.now()}`,name:"New Signature",description:"",enabled:!0,severity:"medium",pattern:"",action:"alert"};u({signatures:[...s,n]}),ns(!1),o({title:"Signature created",description:"New signature has been created"})},[j,u,o]),ms=h.useCallback(s=>{const n=j(),t=n.find(r=>r.id===s);u({signatures:n.filter(r=>r.id!==s)}),o({title:"Signature deleted",description:t?`Signature "${t.name}" has been deleted`:"Signature has been deleted"})},[j,u,o]),M=h.useCallback((s,n,t)=>{const i=j().map(a=>a.id===s?{...a,[n]:t}:a);if(u({signatures:i}),n==="pattern"){const a=ee(t);Ee(d=>{const l=new Map(d);return l.set(s,a),l}),a.warnings.length>0&&o({title:"Pattern validation warning",description:a.warnings.join("; "),variant:"default"}),!a.valid&&a.errors.length>0&&o({title:"Invalid pattern",description:a.errors.join("; "),variant:"destructive"})}},[u,o]),xs=s=>{C&&C.unblockIP(s),u({blockedIPs:V.filter(n=>n.ip!==s)}),o({title:"IP unblocked",description:`IP address ${s} has been unblocked`})},Te=(s="json")=>{if(v.length===0){o({title:"No signatures",description:"No signatures to export",variant:"destructive"});return}if(s==="json"){const n={version:"1.0",exportedAt:new Date().toISOString(),signatures:v.map(a=>({name:a.name,description:a.description,enabled:a.enabled,severity:a.severity,pattern:a.pattern,action:a.action}))},t=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`idsips-signatures-${Date.now()}.json`,i.click(),URL.revokeObjectURL(r),o({title:"Exported",description:`Exported ${v.length} signature(s) to JSON`})}else if(s==="snort"){const n=v.filter(a=>a.enabled&&a.pattern).map(a=>{const d=ee(a.pattern);if(d.valid&&d.parsed)return d.parsed.raw;const l=a.protocol||"tcp",m=a.sourceIP||"any",x=a.sourcePort?a.sourcePort.toString():"any",w=a.destinationIP||"any",D=a.port?a.port.toString():"any",I=a.action==="block"?"drop":"alert",me=a.description||a.name,xe=parseInt(a.id.replace("sig-",""))||1e6+v.indexOf(a);return`${I} ${l} ${m} ${x} -> ${w} ${D} (msg:"${me}"; sid:${xe};)`}).join(`
`),t=new Blob([n],{type:"text/plain"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`idsips-signatures-${Date.now()}.rules`,i.click(),URL.revokeObjectURL(r),o({title:"Exported",description:`Exported ${v.filter(a=>a.enabled).length} signature(s) to Snort rules`})}},$e=(s="json")=>{const n=document.createElement("input");n.type="file",n.accept=s==="json"?"application/json":".rules,.txt",n.onchange=t=>{const r=t.target.files?.[0];if(!r)return;const i=new FileReader;i.onload=a=>{try{const d=a.target?.result;if(s==="json"){const l=JSON.parse(d);if(!l.signatures||!Array.isArray(l.signatures))throw new Error("Invalid JSON format: signatures array not found");const m=l.signatures.map((w,D)=>({id:`sig-${Date.now()}-${D}`,name:w.name||`Imported Signature ${D+1}`,description:w.description||"",enabled:w.enabled!==void 0?w.enabled:!0,severity:w.severity||"medium",pattern:w.pattern||"",action:w.action||"alert"})),x=j();u({signatures:[...x,...m]}),o({title:"Imported",description:`Imported ${m.length} signature(s) from JSON`})}else if(s==="snort"){const l=d.split(`
`).filter(x=>x.trim()&&!x.trim().startsWith("#")),m=[];if(l.forEach((x,w)=>{const D=Ge(x.trim());if(D.valid&&D.parsed){const I=D.parsed,me=I.options.msg||`Snort Rule ${w+1}`,xe=I.options.priority?I.options.priority>=3?"critical":I.options.priority>=2?"high":"medium":"medium",Ds=I.action==="drop"||I.action==="reject"?"block":"alert";m.push({id:`sig-${Date.now()}-${w}`,name:me,description:I.options.msg||"",enabled:!0,severity:xe,pattern:x.trim(),action:Ds})}}),m.length>0){const x=j();u({signatures:[...x,...m]}),o({title:"Imported",description:`Imported ${m.length} signature(s) from Snort rules`})}else o({title:"Import failed",description:"No valid Snort rules found in file",variant:"destructive"})}}catch(d){o({title:"Import failed",description:d instanceof Error?d.message:"Failed to import signatures",variant:"destructive"})}},i.readAsText(r)},n.click()},ps=async()=>{const s=prompt("Enter URL to import signatures from:");if(s)try{const n=await fetch(s);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const t=await n.text();let r="snort";try{JSON.parse(t),r="json"}catch{r="snort"}if(r==="json"){const i=JSON.parse(t);if(!i.signatures||!Array.isArray(i.signatures))throw new Error("Invalid JSON format: signatures array not found");const a=i.signatures.map((l,m)=>({id:`sig-${Date.now()}-${m}`,name:l.name||`Imported Signature ${m+1}`,description:l.description||"",enabled:l.enabled!==void 0?l.enabled:!0,severity:l.severity||"medium",pattern:l.pattern||"",action:l.action||"alert"})),d=j();u({signatures:[...d,...a]}),o({title:"Imported",description:`Imported ${a.length} signature(s) from URL`})}else{const i=t.split(`
`).filter(d=>d.trim()&&!d.trim().startsWith("#")),a=[];if(i.forEach((d,l)=>{const m=Ge(d.trim());if(m.valid&&m.parsed){const x=m.parsed,w=x.options.msg||`Snort Rule ${l+1}`,D=x.options.priority?x.options.priority>=3?"critical":x.options.priority>=2?"high":"medium":"medium",I=x.action==="drop"||x.action==="reject"?"block":"alert";a.push({id:`sig-${Date.now()}-${l}`,name:w,description:x.options.msg||"",enabled:!0,severity:D,pattern:d.trim(),action:I})}}),a.length>0){const d=j();u({signatures:[...d,...a]}),o({title:"Imported",description:`Imported ${a.length} signature(s) from URL`})}else o({title:"Import failed",description:"No valid Snort rules found at URL",variant:"destructive"})}}catch(n){o({title:"Import failed",description:n instanceof Error?n.message:"Failed to import from URL",variant:"destructive"})}},js=s=>{z(n=>{const t=new Set(n);return t.has(s)?t.delete(s):t.add(s),t})},gs=()=>{z(new Set(v.map(s=>s.id)))},Re=()=>{z(new Set)},fs=h.useCallback(()=>{if(p.size===0){o({title:"No selection",description:"Please select signatures to enable",variant:"destructive"});return}const n=j().map(t=>p.has(t.id)?{...t,enabled:!0}:t);u({signatures:n}),o({title:"Enabled",description:`Enabled ${p.size} signature(s)`}),z(new Set)},[p,j,u,o]),vs=h.useCallback(()=>{if(p.size===0){o({title:"No selection",description:"Please select signatures to disable",variant:"destructive"});return}const n=j().map(t=>p.has(t.id)?{...t,enabled:!1}:t);u({signatures:n}),o({title:"Disabled",description:`Disabled ${p.size} signature(s)`}),z(new Set)},[p,j,u,o]),Ss=h.useCallback(()=>{if(p.size===0){o({title:"No selection",description:"Please select signatures to delete",variant:"destructive"});return}const n=j().filter(t=>!p.has(t.id));u({signatures:n}),o({title:"Deleted",description:`Deleted ${p.size} signature(s)`}),z(new Set)},[p,j,u,o]),ys=h.useCallback(s=>{const n=j(),t=n.find(i=>i.id===s);if(!t)return;const r={...t,id:`sig-${Date.now()}`,name:`${t.name} (Copy)`};u({signatures:[...n,r]}),o({title:"Copied",description:`Signature "${t.name}" has been copied`})},[j,u,o]),bs=(s,n)=>{if(!n.trim()){Z({matched:!1,details:"Please enter a test payload"});return}try{const t=ee(s.pattern);let r=!1,i="";if(t.valid&&t.parsed){const a=t.parsed;if(a.options.content){const d=a.options.content;r=new RegExp(d.replace(/\\x[0-9a-fA-F]{2}/g,m=>String.fromCharCode(parseInt(m.slice(2),16)))).test(n),i=r?`Pattern "${d}" matched in payload`:`Pattern "${d}" did not match`}else i="Snort rule has no content option to test"}else try{r=new RegExp(s.pattern).test(n),i=r?`Pattern "${s.pattern}" matched in payload`:`Pattern "${s.pattern}" did not match`}catch(a){i=`Invalid regex pattern: ${a instanceof Error?a.message:String(a)}`}Z({matched:r,details:i})}catch(t){Z({matched:!1,details:`Error testing signature: ${t instanceof Error?t.message:String(t)}`})}},ws=s=>{ds(s),Y(""),Z(null),Le(!0)},J=R.filter(s=>{if(X!=="all"&&s.type!==X||_!=="all"&&s.severity!==_)return!1;if(Q!=="all"){const n=new Date(s.timestamp).getTime(),t=Date.now(),r={"1h":3600*1e3,"6h":360*60*1e3,"24h":1440*60*1e3,"7d":10080*60*1e3};if(t-n>r[Q])return!1}if(oe){const n=oe.toLowerCase();return s.sourceIP.toLowerCase().includes(n)||s.destinationIP.toLowerCase().includes(n)||s.description.toLowerCase().includes(n)||s.signature&&s.signature.toLowerCase().includes(n)}return!0}),Ns=(()=>{if(G==="none")return{"All Alerts":J};const s={};return J.forEach(n=>{let t;switch(G){case"type":t=n.type;break;case"severity":t=n.severity;break;case"sourceIP":t=n.sourceIP;break;case"time":const r=new Date(n.timestamp),a=(new Date().getTime()-r.getTime())/(1e3*60*60);a<1?t="Last hour":a<6?t="Last 6 hours":a<24?t="Last 24 hours":a<168?t="Last week":t="Older";break;default:t="All Alerts"}s[t]||(s[t]=[]),s[t].push(n)}),s})(),ks=(()=>{const s=Date.now(),n=["1h","6h","24h","7d"],t=[];return n.forEach(r=>{const a=s-{"1h":36e5,"6h":216e5,"24h":864e5,"7d":6048e5}[r],d=R.filter(l=>{const m=new Date(l.timestamp).getTime();return m>=a&&m<s});t.push({time:r,signature:d.filter(l=>l.type==="signature").length,anomaly:d.filter(l=>l.type==="anomaly").length,behavioral:d.filter(l=>l.type==="behavioral").length})}),t})(),ue=(()=>{const s={};return J.forEach(n=>{const t=n.description.toLowerCase();let r="Other";t.includes("sql injection")||t.includes("sqli")?r="SQL Injection":t.includes("xss")||t.includes("cross-site")?r="XSS":t.includes("brute force")||t.includes("bruteforce")?r="Brute Force":t.includes("ddos")||t.includes("denial")?r="DDoS":t.includes("port scan")||t.includes("scanning")?r="Port Scanning":t.includes("network scan")?r="Network Scanning":t.includes("malware")||t.includes("virus")?r="Malware":t.includes("phishing")?r="Phishing":t.includes("rce")||t.includes("remote code")?r="RCE":(t.includes("path traversal")||t.includes("directory traversal"))&&(r="Path Traversal"),s[r]=(s[r]||0)+1}),Object.entries(s).map(([n,t])=>({name:n,value:t}))})(),Cs=(()=>{const s={critical:0,high:0,medium:0,low:0};return J.forEach(n=>{s[n.severity]=(s[n.severity]||0)+1}),Object.entries(s).map(([n,t])=>({name:n,value:t}))})(),Is=(()=>{const s=Date.now(),n=24,t=[];for(let r=n-1;r>=0;r--){const i=s-(r+1)*60*60*1e3,a=s-r*60*60*1e3,d=R.filter(m=>{const x=new Date(m.timestamp).getTime();return x>=i&&x<a}),l=new Date(a);t.push({time:`${l.getHours().toString().padStart(2,"0")}:00`,count:d.length})}return t})(),Be=["#ef4444","#f97316","#eab308","#3b82f6","#8b5cf6","#ec4899","#14b8a6"];return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"IDS / IPS"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Intrusion Detection & Prevention"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Monitor and protect network from security threats"})]}),e.jsx("div",{className:"flex gap-2 flex-shrink-0",children:e.jsxs(S,{variant:"outline",size:"sm",onClick:hs,children:[e.jsx(Ws,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})})]}),e.jsx(K,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(y,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(k,{className:"text-sm font-medium",children:"Total Alerts"})}),e.jsx(b,{children:e.jsx("span",{className:"text-2xl font-bold",children:es})})]}),e.jsxs(y,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(k,{className:"text-sm font-medium",children:"Alerts Blocked"})}),e.jsx(b,{children:e.jsx("span",{className:"text-2xl font-bold text-red-500",children:ss})})]}),e.jsxs(y,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(k,{className:"text-sm font-medium",children:"Active Signatures"})}),e.jsx(b,{children:e.jsx("span",{className:"text-2xl font-bold",children:ts})})]}),e.jsxs(y,{children:[e.jsx(N,{className:"pb-3",children:e.jsx(k,{className:"text-sm font-medium",children:"Blocked IPs"})}),e.jsx(b,{children:e.jsx("span",{className:"text-2xl font-bold",children:V.length})})]})]}),e.jsxs(Es,{defaultValue:"alerts",className:"space-y-4",children:[e.jsxs(Ls,{children:[e.jsxs(se,{value:"alerts",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"Alerts (",R.length,")"]}),e.jsxs(se,{value:"signatures",children:[e.jsx(Ys,{className:"h-4 w-4 mr-2"}),"Signatures (",v.length,")"]}),e.jsxs(se,{value:"blocked",children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Blocked IPs (",V.length,")"]}),e.jsxs(se,{value:"settings",children:[e.jsx($s,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsxs(te,{value:"alerts",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(y,{children:[e.jsx(N,{children:e.jsx(k,{className:"text-sm",children:"Alerts Over Time"})}),e.jsx(b,{children:e.jsx(re,{width:"100%",height:200,children:e.jsxs(Zs,{data:Is,children:[e.jsx(je,{strokeDasharray:"3 3",stroke:"hsl(var(--muted))"}),e.jsx(ge,{dataKey:"time",tick:{fontSize:10}}),e.jsx(fe,{tick:{fontSize:10}}),e.jsx(ie,{}),e.jsx(et,{type:"monotone",dataKey:"count",stroke:"#ef4444",strokeWidth:2,dot:!1})]})})})]}),e.jsxs(y,{children:[e.jsx(N,{children:e.jsx(k,{className:"text-sm",children:"Alerts by Type"})}),e.jsx(b,{children:e.jsx(re,{width:"100%",height:200,children:e.jsxs(Je,{data:ks,children:[e.jsx(je,{strokeDasharray:"3 3",stroke:"hsl(var(--muted))"}),e.jsx(ge,{dataKey:"time",tick:{fontSize:10}}),e.jsx(fe,{tick:{fontSize:10}}),e.jsx(ie,{}),e.jsx(st,{wrapperStyle:{fontSize:11}}),e.jsx(le,{dataKey:"signature",stackId:"a",fill:"#ef4444"}),e.jsx(le,{dataKey:"anomaly",stackId:"a",fill:"#f97316"}),e.jsx(le,{dataKey:"behavioral",stackId:"a",fill:"#eab308"})]})})})]}),ue.length>0&&e.jsxs(y,{children:[e.jsx(N,{children:e.jsx(k,{className:"text-sm",children:"Attack Types"})}),e.jsx(b,{children:e.jsx(re,{width:"100%",height:200,children:e.jsxs(nt,{children:[e.jsx(at,{data:ue,cx:"50%",cy:"50%",labelLine:!1,label:({name:s,percent:n})=>`${s} ${(n*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:ue.map((s,n)=>e.jsx(tt,{fill:Be[n%Be.length]},`cell-${n}`))}),e.jsx(ie,{})]})})})]}),e.jsxs(y,{children:[e.jsx(N,{children:e.jsx(k,{className:"text-sm",children:"Alerts by Severity"})}),e.jsx(b,{children:e.jsx(re,{width:"100%",height:200,children:e.jsxs(Je,{data:Cs,children:[e.jsx(je,{strokeDasharray:"3 3",stroke:"hsl(var(--muted))"}),e.jsx(ge,{dataKey:"name",tick:{fontSize:10}}),e.jsx(fe,{tick:{fontSize:10}}),e.jsx(ie,{}),e.jsx(le,{dataKey:"value",fill:"#ef4444"})]})})})]})]}),e.jsxs(y,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx(k,{children:"Security Alerts"}),e.jsx(ne,{children:"Recent intrusion detection alerts"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 flex-wrap",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Rs,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(U,{placeholder:"Search alerts...",value:oe,onChange:s=>as(s.target.value),className:"pl-8 w-full"})]}),e.jsxs(E,{value:X,onValueChange:s=>{s!==X&&rs(s)},children:[e.jsx(L,{className:"w-full sm:w-40",children:e.jsx(T,{})}),e.jsxs($,{children:[e.jsx(c,{value:"all",children:"All Types"}),e.jsx(c,{value:"signature",children:"Signature"}),e.jsx(c,{value:"anomaly",children:"Anomaly"}),e.jsx(c,{value:"behavioral",children:"Behavioral"})]})]}),e.jsxs(E,{value:_,onValueChange:s=>{s!==_&&is(s)},children:[e.jsx(L,{className:"w-full sm:w-40",children:e.jsx(T,{})}),e.jsxs($,{children:[e.jsx(c,{value:"all",children:"All Severities"}),e.jsx(c,{value:"critical",children:"Critical"}),e.jsx(c,{value:"high",children:"High"}),e.jsx(c,{value:"medium",children:"Medium"}),e.jsx(c,{value:"low",children:"Low"})]})]}),e.jsxs(E,{value:Q,onValueChange:s=>{s!==Q&&ls(s)},children:[e.jsx(L,{className:"w-full sm:w-40",children:e.jsx(T,{})}),e.jsxs($,{children:[e.jsx(c,{value:"all",children:"All Time"}),e.jsx(c,{value:"1h",children:"Last Hour"}),e.jsx(c,{value:"6h",children:"Last 6 Hours"}),e.jsx(c,{value:"24h",children:"Last 24 Hours"}),e.jsx(c,{value:"7d",children:"Last 7 Days"})]})]}),e.jsxs(E,{value:G,onValueChange:s=>{s!==G&&cs(s)},children:[e.jsx(L,{className:"w-full sm:w-40",children:e.jsx(T,{})}),e.jsxs($,{children:[e.jsx(c,{value:"none",children:"No Grouping"}),e.jsx(c,{value:"type",children:"Group by Type"}),e.jsx(c,{value:"severity",children:"Group by Severity"}),e.jsx(c,{value:"sourceIP",children:"Group by Source IP"}),e.jsx(c,{value:"time",children:"Group by Time"})]})]})]})]})}),e.jsx(b,{children:J.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:R.length===0?"No alerts detected":"No alerts match the filter"}):e.jsx("div",{className:"space-y-4",children:Object.entries(Ns).map(([s,n])=>e.jsxs("div",{className:"space-y-2",children:[G!=="none"&&e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(it,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("h3",{className:"font-semibold text-sm",children:s}),e.jsxs(A,{variant:"outline",children:[n.length," alerts"]})]}),e.jsx("div",{className:"space-y-2",children:n.map(t=>e.jsx(y,{className:`border-l-4 ${t.severity==="critical"?"border-l-red-500":t.severity==="high"?"border-l-orange-500":t.severity==="medium"?"border-l-yellow-500":"border-l-blue-500"}`,children:e.jsx(b,{className:"pt-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(A,{variant:t.severity==="critical"?"destructive":t.severity==="high"?"default":"outline",children:t.severity}),e.jsx(A,{variant:"outline",children:t.type}),t.blocked?e.jsxs(A,{variant:"default",className:"bg-green-500",children:[e.jsx(ve,{className:"h-3 w-3 mr-1"}),"Blocked"]}):e.jsxs(A,{variant:"outline",children:[e.jsx(Oe,{className:"h-3 w-3 mr-1"}),"Not Blocked"]})]}),e.jsx("p",{className:"font-medium mb-1",children:t.description}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Source: ",t.sourceIP," â†’ Destination: ",t.destinationIP]}),e.jsxs("p",{children:["Protocol: ",t.protocol," Port: ",t.port]}),e.jsxs("p",{children:["Time: ",new Date(t.timestamp).toLocaleString()]}),t.signature&&e.jsxs("p",{children:["Signature: ",t.signature]})]})]})})})},t.id))})]},s))})})]})]}),e.jsx(te,{value:"signatures",className:"space-y-4",children:e.jsxs(y,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx(k,{children:"Detection Signatures"}),e.jsx(ne,{children:"Configure detection rules and patterns"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[p.size>0&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(S,{variant:"outline",size:"sm",onClick:fs,className:"flex-shrink-0",children:[e.jsx(ct,{className:"h-4 w-4 sm:mr-2"}),e.jsxs("span",{className:"hidden sm:inline",children:["Enable (",p.size,")"]}),e.jsx("span",{className:"sm:hidden",children:"Enable"})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:vs,className:"flex-shrink-0",children:[e.jsx(dt,{className:"h-4 w-4 sm:mr-2"}),e.jsxs("span",{className:"hidden sm:inline",children:["Disable (",p.size,")"]}),e.jsx("span",{className:"sm:hidden",children:"Disable"})]}),e.jsxs(S,{variant:"outline",size:"sm",onClick:Ss,className:"flex-shrink-0",children:[e.jsx(Me,{className:"h-4 w-4 sm:mr-2"}),e.jsxs("span",{className:"hidden sm:inline",children:["Delete (",p.size,")"]}),e.jsx("span",{className:"sm:hidden",children:"Delete"})]}),e.jsx(S,{variant:"ghost",size:"sm",onClick:Re,className:"flex-shrink-0",children:"Clear"})]}),e.jsxs(Ue,{children:[e.jsx(He,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",className:"flex-shrink-0",children:[e.jsx(Bs,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Export"})]})}),e.jsxs(Fe,{children:[e.jsxs(q,{onClick:()=>Te("json"),children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Export as JSON"]}),e.jsxs(q,{onClick:()=>Te("snort"),children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Export as Snort Rules"]})]})]}),e.jsxs(Ue,{children:[e.jsx(He,{asChild:!0,children:e.jsxs(S,{variant:"outline",size:"sm",className:"flex-shrink-0",children:[e.jsx(zs,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Import"})]})}),e.jsxs(Fe,{children:[e.jsxs(q,{onClick:()=>$e("json"),children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Import from JSON"]}),e.jsxs(q,{onClick:()=>$e("snort"),children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Import from Snort Rules"]}),e.jsx(Os,{}),e.jsxs(q,{onClick:ps,children:[e.jsx(Ms,{className:"h-4 w-4 mr-2"}),"Import from URL"]})]})]}),e.jsxs(S,{onClick:us,size:"sm",className:"flex-shrink-0",children:[e.jsx(Us,{className:"h-4 w-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Create Signature"}),e.jsx("span",{className:"sm:hidden",children:"Create"})]})]})]})}),e.jsx(b,{children:v.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No signatures configured. Create your first signature or import from file."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx(Ve,{checked:p.size===v.length&&v.length>0,onCheckedChange:s=>{s?gs():Re()}}),e.jsxs(g,{className:"text-sm text-muted-foreground",children:["Select all (",p.size," selected)"]})]}),v.map(s=>e.jsxs(y,{className:"border-l-4 border-l-blue-500",children:[e.jsx(N,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx(Ve,{checked:p.has(s.id),onCheckedChange:()=>js(s.id),className:"flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(k,{className:"text-base truncate",children:s.name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-1",children:[e.jsx(A,{variant:s.enabled?"default":"outline",className:"flex-shrink-0",children:s.enabled?"Enabled":"Disabled"}),e.jsx(A,{variant:s.severity==="critical"?"destructive":s.severity==="high"?"default":"outline",className:"flex-shrink-0",children:s.severity}),e.jsx(A,{variant:"outline",className:"flex-shrink-0",children:s.action})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>ws(s),title:"Preview/Test signature",children:e.jsx(Hs,{className:"h-4 w-4"})}),e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>ys(s.id),title:"Copy signature",children:e.jsx(Fs,{className:"h-4 w-4"})}),e.jsx(H,{checked:s.enabled,onCheckedChange:n=>M(s.id,"enabled",n)}),e.jsx(S,{variant:"ghost",size:"icon",onClick:()=>ms(s.id),children:e.jsx(Me,{className:"h-4 w-4"})})]})]})}),e.jsx(b,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Signature Name"}),e.jsx(U,{value:s.name,onChange:n=>M(s.id,"name",n.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Severity"}),e.jsxs(E,{value:s.severity||"medium",onValueChange:n=>{n!==s.severity&&M(s.id,"severity",n)},children:[e.jsx(L,{children:e.jsx(T,{})}),e.jsxs($,{children:[e.jsx(c,{value:"critical",children:"Critical"}),e.jsx(c,{value:"high",children:"High"}),e.jsx(c,{value:"medium",children:"Medium"}),e.jsx(c,{value:"low",children:"Low"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Action"}),e.jsxs(E,{value:s.action||"alert",onValueChange:n=>{n!==s.action&&M(s.id,"action",n)},children:[e.jsx(L,{children:e.jsx(T,{})}),e.jsxs($,{children:[e.jsx(c,{value:"block",children:"Block"}),e.jsx(c,{value:"alert",children:"Alert"}),e.jsx(c,{value:"log",children:"Log"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Description"}),e.jsx(U,{value:s.description,onChange:n=>M(s.id,"description",n.target.value),placeholder:"Signature description"})]}),e.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[e.jsx(g,{children:"Pattern"}),e.jsx(U,{value:s.pattern,onChange:n=>M(s.id,"pattern",n.target.value),placeholder:"Detection pattern (regex or Snort rule)",className:`font-mono text-sm ${P.get(s.id)?.valid===!1?"border-red-500":P.get(s.id)?.warnings.length?"border-yellow-500":""}`}),P.get(s.id)&&e.jsxs("div",{className:"space-y-1",children:[P.get(s.id)?.errors.map((n,t)=>e.jsxs("p",{className:"text-xs text-red-500 flex items-center gap-1",children:[e.jsx(Oe,{className:"h-3 w-3"}),n]},t)),P.get(s.id)?.warnings.map((n,t)=>e.jsxs("p",{className:"text-xs text-yellow-500 flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3"}),n]},t)),P.get(s.id)?.valid&&P.get(s.id)?.errors.length===0&&P.get(s.id)?.warnings.length===0&&e.jsxs("p",{className:"text-xs text-green-500 flex items-center gap-1",children:[e.jsx(ve,{className:"h-3 w-3"}),"Pattern is valid"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Enter a regex pattern or Snort rule format (e.g., alert tcp any any -> any 22 (msg:"SSH"; sid:1000001;))'})]})]})})]},s.id))]})})]})}),e.jsx(te,{value:"blocked",className:"space-y-4",children:e.jsxs(y,{children:[e.jsxs(N,{children:[e.jsx(k,{children:"Blocked IP Addresses"}),e.jsx(ne,{children:"IPs currently blocked by the system"})]}),e.jsx(b,{children:V.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No IPs blocked"}):e.jsx("div",{className:"space-y-2",children:V.map((s,n)=>e.jsx(y,{className:"border-l-4 border-l-red-500",children:e.jsx(b,{className:"pt-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(A,{variant:"destructive",children:s.ip}),e.jsx(A,{variant:"outline",children:s.reason})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Blocked at: ",new Date(s.blockedAt).toLocaleString()]}),s.duration&&e.jsxs("p",{children:["Duration: ",s.duration," seconds"]}),s.expiresAt&&e.jsxs("p",{children:["Expires: ",new Date(s.expiresAt).toLocaleString()]})]})]}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>xs(s.ip),children:"Unblock"})]})})},n))})})]})}),e.jsx(te,{value:"settings",className:"space-y-4",children:e.jsxs(y,{children:[e.jsxs(N,{children:[e.jsx(k,{children:"IDS/IPS Settings"}),e.jsx(ne,{children:"Configure detection and prevention settings"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Operation Mode"}),e.jsxs(E,{value:be,onValueChange:s=>{s!==be&&u({mode:s})},children:[e.jsx(L,{children:e.jsx(T,{})}),e.jsxs($,{children:[e.jsx(c,{value:"ips",children:"IPS (Prevention - Active blocking)"}),e.jsx(c,{value:"ids",children:"IDS (Detection - Monitoring only)"})]})]})]}),e.jsx(K,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{children:"Signature Detection"}),e.jsx(H,{checked:Xe,onCheckedChange:s=>u({enableSignatureDetection:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{children:"Anomaly Detection"}),e.jsx(H,{checked:_e,onCheckedChange:s=>u({enableAnomalyDetection:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{children:"Behavioral Analysis"}),e.jsx(H,{checked:Qe,onCheckedChange:s=>u({enableBehavioralAnalysis:s})})]})]}),e.jsx(K,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Alert Threshold"}),e.jsxs(E,{value:we,onValueChange:s=>{s!==we&&u({alertThreshold:s})},children:[e.jsx(L,{children:e.jsx(T,{})}),e.jsxs($,{children:[e.jsx(c,{value:"critical",children:"Critical"}),e.jsx(c,{value:"high",children:"High"}),e.jsx(c,{value:"medium",children:"Medium"}),e.jsx(c,{value:"low",children:"Low"})]})]})]}),e.jsx(K,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{children:"Auto Block"}),e.jsx(H,{checked:Ne,onCheckedChange:s=>u({enableAutoBlock:s})})]}),Ne&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Block Duration (seconds)"}),e.jsx(U,{type:"number",value:We,onChange:s=>u({blockDuration:Number(s.target.value)}),min:60,max:86400})]}),e.jsx(K,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(g,{children:"Enable Logging"}),e.jsx(H,{checked:ke,onCheckedChange:s=>u({enableLogging:s})})]}),ke&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Log Retention (days)"}),e.jsx(U,{type:"number",value:Ye,onChange:s=>u({logRetention:Number(s.target.value)}),min:1,max:365})]})]})]})})]}),e.jsx(Vs,{open:os,onOpenChange:Le,children:e.jsxs(Gs,{className:"max-w-2xl",children:[e.jsxs(Js,{children:[e.jsx(Ks,{children:"Preview & Test Signature"}),e.jsx(qs,{children:"Test how this signature will match against sample payloads"})]}),W&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(g,{children:["Signature: ",W.name]}),e.jsx("div",{className:"p-3 bg-muted rounded-md font-mono text-sm",children:W.pattern})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{children:"Test Payload"}),e.jsx(Qs,{value:de,onChange:s=>Y(s.target.value),placeholder:"Enter a sample payload to test against the signature pattern...",className:"font-mono text-sm",rows:6})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(S,{onClick:()=>bs(W,de),disabled:!de.trim(),children:[e.jsx(Xs,{className:"h-4 w-4 mr-2"}),"Test Signature"]}),e.jsx(S,{variant:"outline",onClick:()=>{Y("SELECT * FROM users WHERE id = 1 OR 1=1")},children:"Load SQL Injection Example"}),e.jsx(S,{variant:"outline",onClick:()=>{Y('<script>alert("XSS")<\/script>')},children:"Load XSS Example"})]}),O&&e.jsxs("div",{className:`p-4 rounded-md border ${O.matched?"bg-red-50 border-red-200 dark:bg-red-950 dark:border-red-800":"bg-green-50 border-green-200 dark:bg-green-950 dark:border-green-800"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[O.matched?e.jsx(pe,{className:"h-5 w-5 text-red-600 dark:text-red-400"}):e.jsx(ve,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),e.jsx("span",{className:`font-semibold ${O.matched?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:O.matched?"MATCHED - Alert would be triggered!":"No Match - Payload is safe"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:O.details})]})]})]})})]})})}export{Nt as IDSIPSConfigAdvanced};

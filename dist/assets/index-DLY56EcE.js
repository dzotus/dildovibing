const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KafkaConfigAdvanced-BKod3AZk.js","assets/progress-CkVRywlg.js","assets/textarea-DLekUSKy.js","assets/database-CVetjLhw.js","assets/users-DjA8t-Um.js","assets/shield-DkBueQ2J.js","assets/RabbitMQConfigAdvanced-C2GPYtwa.js","assets/usePortValidation-BoiHBeSp.js","assets/requiredFields-BLgUUVkB.js","assets/toast-BNc3Mgc4.js","assets/message-square-Zgj4ahqF.js","assets/arrow-right-left-CmDoUtUA.js","assets/key-BPyaeisU.js","assets/PostgreSQLConfigAdvanced-B6d8JrKR.js","assets/table-D_CIhXfO.js","assets/MongoDBConfigAdvanced-BCaDfznX.js","assets/RedisConfigAdvanced-Dg8xh044.js","assets/ElasticsearchConfigAdvanced-CK31HyG0.js","assets/refresh-ccw-CIIwm2k8.js","assets/code-CgxJflZX.js","assets/CassandraConfigAdvanced-DyJnGqDA.js","assets/ClickHouseConfigAdvanced-C6zV7P-T.js","assets/chart-column-Bmtstpym.js","assets/SnowflakeConfigAdvanced-DpPdGLQY.js","assets/S3DataLakeConfigAdvanced-B2FlARgF.js","assets/folder-BSsFRthP.js","assets/NginxConfigAdvanced-jkc3hS2J.js","assets/globe-DP-LPvzN.js","assets/server-dBT74kKC.js","assets/RestApiConfigAdvanced-Z1HTF79f.js","assets/GRPCConfigAdvanced-CxujBLTa.js","assets/circle-check-big-B_f8k0M8.js","assets/WebSocketConfigAdvanced-BqZrKOTx.js","assets/send-BUYSiZg6.js","assets/GraphQLConfigAdvanced-CDMa4ZZ-.js","assets/SOAPConfigAdvanced-fw5HiuwX.js","assets/WebhookConfigAdvanced-Dy8uJEuN.js","assets/webhook-CaKy921y.js","assets/clock-D1MMpo7s.js","assets/DockerK8sConfigAdvanced-a_0smPj1.js","assets/HAProxyConfigAdvanced-CuV--yAH.js","assets/trending-up-B0BoZP1t.js","assets/TraefikConfigAdvanced-Ou9e_gym.js","assets/route-BDXoagyf.js","assets/EnvoyConfigAdvanced-CV8sb236.js","assets/ActiveMQConfigAdvanced-DRE_OgVs.js","assets/alert-BnO97dQF.js","assets/pen-Ct_jupjF.js","assets/AWSSQSConfigAdvanced-pIsvdiAd.js","assets/cloud-DcIGRbho.js","assets/AzureServiceBusConfigAdvanced-Dl5w8yy3.js","assets/GCPPubSubConfigAdvanced-D6mCC7Qa.js","assets/KongConfigAdvanced-BUumuDv8.js","assets/ApigeeConfigAdvanced-BJ1MpQk3.js","assets/MuleSoftConfigAdvanced-DCKrixF0.js","assets/GraphQLGatewayConfigAdvanced-C0Jw4oCW.js","assets/BFFServiceConfigAdvanced-B7lgotX0.js","assets/WebhookRelayConfigAdvanced-DhSgwXDv.js","assets/PrometheusConfigAdvanced-BvQUNJiS.js","assets/GrafanaConfigAdvanced-CQgDs6VK.js","assets/LokiConfigAdvanced-BvEPy39v.js","assets/JaegerConfigAdvanced-BQLYwgTL.js","assets/git-branch-jKOT0U6P.js","assets/OpenTelemetryCollectorConfigAdvanced-C_uvrMoG.js","assets/PagerDutyConfigAdvanced-B0jGgle_.js","assets/KeycloakConfigAdvanced-exO-rPcE.js","assets/lock-CNEa57gd.js","assets/WAFConfigAdvanced-CMNgW3FX.js","assets/SecretsVaultConfigAdvanced-DxVbKow6.js","assets/IDSIPSConfigAdvanced-BMEEA_vP.js","assets/ban-DHeCOWI4.js","assets/FirewallConfigAdvanced-ZOJ0bYQR.js","assets/JenkinsConfigAdvanced-Ch0dTAPy.js","assets/package-Bvx3YVNN.js","assets/GitLabCIConfigAdvanced-DQnQPECD.js","assets/ArgoCDConfigAdvanced-G9tSz_cK.js","assets/HarborConfigAdvanced-CZgO6AAC.js","assets/TerraformConfigAdvanced-BJMSPmR9.js","assets/AnsibleConfigAdvanced-5CosIfaW.js","assets/IstioConfigAdvanced-3lqrqitf.js","assets/ServiceMeshConfigAdvanced-CfBvZNlI.js","assets/APIGatewayConfigAdvanced-D09s-lvU.js","assets/VPNConfigAdvanced-Bvy-g_Yk.js","assets/CDNConfigAdvanced-rGK86-ni.js","assets/SparkConfigAdvanced-BW9ifVA6.js","assets/TensorFlowServingConfigAdvanced-DdnWRqbI.js","assets/PyTorchServeConfigAdvanced-D7qObqah.js","assets/FeatureStoreConfigAdvanced-BbO5hrry.js","assets/MLflowConfigAdvanced-D4abdMEt.js","assets/CRMConfigAdvanced-_CzBswHr.js","assets/dollar-sign-244awUuj.js","assets/building-DQpXsEaA.js","assets/ERPConfigAdvanced-B9Q0Xc49.js","assets/RPABotConfigAdvanced-CpjZ7Uaw.js","assets/BPMNEngineConfigAdvanced-Bccv1n0T.js","assets/PaymentGatewayConfigAdvanced-CZ9g91xN.js"])))=>i.map(i=>d[i]);
function ZM(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const o in n)if(o!=="default"&&!(o in r)){const i=Object.getOwnPropertyDescriptor(n,o);i&&Object.defineProperty(r,o,i.get?i:{enumerable:!0,get:()=>n[o]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();var h3=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Th(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var zf={exports:{}},yi={};var x0;function JM(){if(x0)return yi;x0=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,o,i){var l=null;if(i!==void 0&&(l=""+i),o.key!==void 0&&(l=""+o.key),"key"in o){i={};for(var u in o)u!=="key"&&(i[u]=o[u])}else i=o;return o=i.ref,{$$typeof:r,type:n,key:l,ref:o!==void 0?o:null,props:i}}return yi.Fragment=e,yi.jsx=t,yi.jsxs=t,yi}var w0;function eE(){return w0||(w0=1,zf.exports=JM()),zf.exports}var h=eE(),Lf={exports:{}},Le={};var S0;function tE(){if(S0)return Le;S0=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),y=Symbol.iterator;function x(_){return _===null||typeof _!="object"?null:(_=y&&_[y]||_["@@iterator"],typeof _=="function"?_:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,E={};function M(_,Q,Y){this.props=_,this.context=Q,this.refs=E,this.updater=Y||S}M.prototype.isReactComponent={},M.prototype.setState=function(_,Q){if(typeof _!="object"&&typeof _!="function"&&_!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,_,Q,"setState")},M.prototype.forceUpdate=function(_){this.updater.enqueueForceUpdate(this,_,"forceUpdate")};function A(){}A.prototype=M.prototype;function T(_,Q,Y){this.props=_,this.context=Q,this.refs=E,this.updater=Y||S}var N=T.prototype=new A;N.constructor=T,C(N,M.prototype),N.isPureReactComponent=!0;var D=Array.isArray;function q(){}var P={H:null,A:null,T:null,S:null},H=Object.prototype.hasOwnProperty;function J(_,Q,Y){var ae=Y.ref;return{$$typeof:r,type:_,key:Q,ref:ae!==void 0?ae:null,props:Y}}function se(_,Q){return J(_.type,Q,_.props)}function ce(_){return typeof _=="object"&&_!==null&&_.$$typeof===r}function Z(_){var Q={"=":"=0",":":"=2"};return"$"+_.replace(/[=:]/g,function(Y){return Q[Y]})}var te=/\/+/g;function le(_,Q){return typeof _=="object"&&_!==null&&_.key!=null?Z(""+_.key):Q.toString(36)}function ue(_){switch(_.status){case"fulfilled":return _.value;case"rejected":throw _.reason;default:switch(typeof _.status=="string"?_.then(q,q):(_.status="pending",_.then(function(Q){_.status==="pending"&&(_.status="fulfilled",_.value=Q)},function(Q){_.status==="pending"&&(_.status="rejected",_.reason=Q)})),_.status){case"fulfilled":return _.value;case"rejected":throw _.reason}}throw _}function z(_,Q,Y,ae,B){var oe=typeof _;(oe==="undefined"||oe==="boolean")&&(_=null);var $=!1;if(_===null)$=!0;else switch(oe){case"bigint":case"string":case"number":$=!0;break;case"object":switch(_.$$typeof){case r:case e:$=!0;break;case g:return $=_._init,z($(_._payload),Q,Y,ae,B)}}if($)return B=B(_),$=ae===""?"."+le(_,0):ae,D(B)?(Y="",$!=null&&(Y=$.replace(te,"$&/")+"/"),z(B,Q,Y,"",function(me){return me})):B!=null&&(ce(B)&&(B=se(B,Y+(B.key==null||_&&_.key===B.key?"":(""+B.key).replace(te,"$&/")+"/")+$)),Q.push(B)),1;$=0;var V=ae===""?".":ae+":";if(D(_))for(var pe=0;pe<_.length;pe++)ae=_[pe],oe=V+le(ae,pe),$+=z(ae,Q,Y,oe,B);else if(pe=x(_),typeof pe=="function")for(_=pe.call(_),pe=0;!(ae=_.next()).done;)ae=ae.value,oe=V+le(ae,pe++),$+=z(ae,Q,Y,oe,B);else if(oe==="object"){if(typeof _.then=="function")return z(ue(_),Q,Y,ae,B);throw Q=String(_),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return $}function j(_,Q,Y){if(_==null)return _;var ae=[],B=0;return z(_,ae,"","",function(oe){return Q.call(Y,oe,B++)}),ae}function O(_){if(_._status===-1){var Q=_._result;Q=Q(),Q.then(function(Y){(_._status===0||_._status===-1)&&(_._status=1,_._result=Y)},function(Y){(_._status===0||_._status===-1)&&(_._status=2,_._result=Y)}),_._status===-1&&(_._status=0,_._result=Q)}if(_._status===1)return _._result.default;throw _._result}var X=typeof reportError=="function"?reportError:function(_){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof _=="object"&&_!==null&&typeof _.message=="string"?String(_.message):String(_),error:_});if(!window.dispatchEvent(Q))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",_);return}console.error(_)},he={map:j,forEach:function(_,Q,Y){j(_,function(){Q.apply(this,arguments)},Y)},count:function(_){var Q=0;return j(_,function(){Q++}),Q},toArray:function(_){return j(_,function(Q){return Q})||[]},only:function(_){if(!ce(_))throw Error("React.Children.only expected to receive a single React element child.");return _}};return Le.Activity=m,Le.Children=he,Le.Component=M,Le.Fragment=t,Le.Profiler=o,Le.PureComponent=T,Le.StrictMode=n,Le.Suspense=f,Le.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,Le.__COMPILER_RUNTIME={__proto__:null,c:function(_){return P.H.useMemoCache(_)}},Le.cache=function(_){return function(){return _.apply(null,arguments)}},Le.cacheSignal=function(){return null},Le.cloneElement=function(_,Q,Y){if(_==null)throw Error("The argument must be a React element, but you passed "+_+".");var ae=C({},_.props),B=_.key;if(Q!=null)for(oe in Q.key!==void 0&&(B=""+Q.key),Q)!H.call(Q,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&Q.ref===void 0||(ae[oe]=Q[oe]);var oe=arguments.length-2;if(oe===1)ae.children=Y;else if(1<oe){for(var $=Array(oe),V=0;V<oe;V++)$[V]=arguments[V+2];ae.children=$}return J(_.type,B,ae)},Le.createContext=function(_){return _={$$typeof:l,_currentValue:_,_currentValue2:_,_threadCount:0,Provider:null,Consumer:null},_.Provider=_,_.Consumer={$$typeof:i,_context:_},_},Le.createElement=function(_,Q,Y){var ae,B={},oe=null;if(Q!=null)for(ae in Q.key!==void 0&&(oe=""+Q.key),Q)H.call(Q,ae)&&ae!=="key"&&ae!=="__self"&&ae!=="__source"&&(B[ae]=Q[ae]);var $=arguments.length-2;if($===1)B.children=Y;else if(1<$){for(var V=Array($),pe=0;pe<$;pe++)V[pe]=arguments[pe+2];B.children=V}if(_&&_.defaultProps)for(ae in $=_.defaultProps,$)B[ae]===void 0&&(B[ae]=$[ae]);return J(_,oe,B)},Le.createRef=function(){return{current:null}},Le.forwardRef=function(_){return{$$typeof:u,render:_}},Le.isValidElement=ce,Le.lazy=function(_){return{$$typeof:g,_payload:{_status:-1,_result:_},_init:O}},Le.memo=function(_,Q){return{$$typeof:p,type:_,compare:Q===void 0?null:Q}},Le.startTransition=function(_){var Q=P.T,Y={};P.T=Y;try{var ae=_(),B=P.S;B!==null&&B(Y,ae),typeof ae=="object"&&ae!==null&&typeof ae.then=="function"&&ae.then(q,X)}catch(oe){X(oe)}finally{Q!==null&&Y.types!==null&&(Q.types=Y.types),P.T=Q}},Le.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},Le.use=function(_){return P.H.use(_)},Le.useActionState=function(_,Q,Y){return P.H.useActionState(_,Q,Y)},Le.useCallback=function(_,Q){return P.H.useCallback(_,Q)},Le.useContext=function(_){return P.H.useContext(_)},Le.useDebugValue=function(){},Le.useDeferredValue=function(_,Q){return P.H.useDeferredValue(_,Q)},Le.useEffect=function(_,Q){return P.H.useEffect(_,Q)},Le.useEffectEvent=function(_){return P.H.useEffectEvent(_)},Le.useId=function(){return P.H.useId()},Le.useImperativeHandle=function(_,Q,Y){return P.H.useImperativeHandle(_,Q,Y)},Le.useInsertionEffect=function(_,Q){return P.H.useInsertionEffect(_,Q)},Le.useLayoutEffect=function(_,Q){return P.H.useLayoutEffect(_,Q)},Le.useMemo=function(_,Q){return P.H.useMemo(_,Q)},Le.useOptimistic=function(_,Q){return P.H.useOptimistic(_,Q)},Le.useReducer=function(_,Q,Y){return P.H.useReducer(_,Q,Y)},Le.useRef=function(_){return P.H.useRef(_)},Le.useState=function(_){return P.H.useState(_)},Le.useSyncExternalStore=function(_,Q,Y){return P.H.useSyncExternalStore(_,Q,Y)},Le.useTransition=function(){return P.H.useTransition()},Le.version="19.2.0",Le}var C0;function Ah(){return C0||(C0=1,Lf.exports=tE()),Lf.exports}var w=Ah();const Et=Th(w),Nh=ZM({__proto__:null,default:Et},[w]);var Of={exports:{}},vi={},Pf={exports:{}},If={};var M0;function nE(){return M0||(M0=1,(function(r){function e(z,j){var O=z.length;z.push(j);e:for(;0<O;){var X=O-1>>>1,he=z[X];if(0<o(he,j))z[X]=j,z[O]=he,O=X;else break e}}function t(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var j=z[0],O=z.pop();if(O!==j){z[0]=O;e:for(var X=0,he=z.length,_=he>>>1;X<_;){var Q=2*(X+1)-1,Y=z[Q],ae=Q+1,B=z[ae];if(0>o(Y,O))ae<he&&0>o(B,Y)?(z[X]=B,z[ae]=O,X=ae):(z[X]=Y,z[Q]=O,X=Q);else if(ae<he&&0>o(B,O))z[X]=B,z[ae]=O,X=ae;else break e}}return j}function o(z,j){var O=z.sortIndex-j.sortIndex;return O!==0?O:z.id-j.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var l=Date,u=l.now();r.unstable_now=function(){return l.now()-u}}var f=[],p=[],g=1,m=null,y=3,x=!1,S=!1,C=!1,E=!1,M=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function N(z){for(var j=t(p);j!==null;){if(j.callback===null)n(p);else if(j.startTime<=z)n(p),j.sortIndex=j.expirationTime,e(f,j);else break;j=t(p)}}function D(z){if(C=!1,N(z),!S)if(t(f)!==null)S=!0,q||(q=!0,Z());else{var j=t(p);j!==null&&ue(D,j.startTime-z)}}var q=!1,P=-1,H=5,J=-1;function se(){return E?!0:!(r.unstable_now()-J<H)}function ce(){if(E=!1,q){var z=r.unstable_now();J=z;var j=!0;try{e:{S=!1,C&&(C=!1,A(P),P=-1),x=!0;var O=y;try{t:{for(N(z),m=t(f);m!==null&&!(m.expirationTime>z&&se());){var X=m.callback;if(typeof X=="function"){m.callback=null,y=m.priorityLevel;var he=X(m.expirationTime<=z);if(z=r.unstable_now(),typeof he=="function"){m.callback=he,N(z),j=!0;break t}m===t(f)&&n(f),N(z)}else n(f);m=t(f)}if(m!==null)j=!0;else{var _=t(p);_!==null&&ue(D,_.startTime-z),j=!1}}break e}finally{m=null,y=O,x=!1}j=void 0}}finally{j?Z():q=!1}}}var Z;if(typeof T=="function")Z=function(){T(ce)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,le=te.port2;te.port1.onmessage=ce,Z=function(){le.postMessage(null)}}else Z=function(){M(ce,0)};function ue(z,j){P=M(function(){z(r.unstable_now())},j)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(z){z.callback=null},r.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<z?Math.floor(1e3/z):5},r.unstable_getCurrentPriorityLevel=function(){return y},r.unstable_next=function(z){switch(y){case 1:case 2:case 3:var j=3;break;default:j=y}var O=y;y=j;try{return z()}finally{y=O}},r.unstable_requestPaint=function(){E=!0},r.unstable_runWithPriority=function(z,j){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var O=y;y=z;try{return j()}finally{y=O}},r.unstable_scheduleCallback=function(z,j,O){var X=r.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?X+O:X):O=X,z){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=O+he,z={id:g++,callback:j,priorityLevel:z,startTime:O,expirationTime:he,sortIndex:-1},O>X?(z.sortIndex=O,e(p,z),t(f)===null&&z===t(p)&&(C?(A(P),P=-1):C=!0,ue(D,O-X))):(z.sortIndex=he,e(f,z),S||x||(S=!0,q||(q=!0,Z()))),z},r.unstable_shouldYield=se,r.unstable_wrapCallback=function(z){var j=y;return function(){var O=y;y=j;try{return z.apply(this,arguments)}finally{y=O}}}})(If)),If}var E0;function sE(){return E0||(E0=1,Pf.exports=nE()),Pf.exports}var qf={exports:{}},an={};var R0;function aE(){if(R0)return an;R0=1;var r=Ah();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)p+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},o=Symbol.for("react.portal");function i(f,p,g){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:m==null?null:""+m,children:f,containerInfo:p,implementation:g}}var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return an.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,an.createPortal=function(f,p){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return i(f,p,null,g)},an.flushSync=function(f){var p=l.T,g=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=p,n.p=g,n.d.f()}},an.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,n.d.C(f,p))},an.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},an.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var g=p.as,m=u(g,p.crossOrigin),y=typeof p.integrity=="string"?p.integrity:void 0,x=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;g==="style"?n.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:m,integrity:y,fetchPriority:x}):g==="script"&&n.d.X(f,{crossOrigin:m,integrity:y,fetchPriority:x,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},an.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var g=u(p.as,p.crossOrigin);n.d.M(f,{crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&n.d.M(f)},an.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var g=p.as,m=u(g,p.crossOrigin);n.d.L(f,g,{crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},an.preloadModule=function(f,p){if(typeof f=="string")if(p){var g=u(p.as,p.crossOrigin);n.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else n.d.m(f)},an.requestFormReset=function(f){n.d.r(f)},an.unstable_batchedUpdates=function(f,p){return f(p)},an.useFormState=function(f,p,g){return l.H.useFormState(f,p,g)},an.useFormStatus=function(){return l.H.useHostTransitionStatus()},an.version="19.2.0",an}var T0;function Dv(){if(T0)return qf.exports;T0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),qf.exports=aE(),qf.exports}var A0;function oE(){if(A0)return vi;A0=1;var r=sE(),e=Ah(),t=Dv();function n(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)a+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var a=s,c=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(c=a.return),s=a.return;while(s)}return a.tag===3?c:null}function l(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function u(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function f(s){if(i(s)!==s)throw Error(n(188))}function p(s){var a=s.alternate;if(!a){if(a=i(s),a===null)throw Error(n(188));return a!==s?null:s}for(var c=s,d=a;;){var v=c.return;if(v===null)break;var b=v.alternate;if(b===null){if(d=v.return,d!==null){c=d;continue}break}if(v.child===b.child){for(b=v.child;b;){if(b===c)return f(v),s;if(b===d)return f(v),a;b=b.sibling}throw Error(n(188))}if(c.return!==d.return)c=v,d=b;else{for(var R=!1,k=v.child;k;){if(k===c){R=!0,c=v,d=b;break}if(k===d){R=!0,d=v,c=b;break}k=k.sibling}if(!R){for(k=b.child;k;){if(k===c){R=!0,c=b,d=v;break}if(k===d){R=!0,d=b,c=v;break}k=k.sibling}if(!R)throw Error(n(189))}}if(c.alternate!==d)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:a}function g(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=g(s),a!==null)return a;s=s.sibling}return null}var m=Object.assign,y=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),T=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),J=Symbol.for("react.activity"),se=Symbol.for("react.memo_cache_sentinel"),ce=Symbol.iterator;function Z(s){return s===null||typeof s!="object"?null:(s=ce&&s[ce]||s["@@iterator"],typeof s=="function"?s:null)}var te=Symbol.for("react.client.reference");function le(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===te?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case C:return"Fragment";case M:return"Profiler";case E:return"StrictMode";case D:return"Suspense";case q:return"SuspenseList";case J:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case S:return"Portal";case T:return s.displayName||"Context";case A:return(s._context.displayName||"Context")+".Consumer";case N:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case P:return a=s.displayName||null,a!==null?a:le(s.type)||"Memo";case H:a=s._payload,s=s._init;try{return le(s(a))}catch{}}return null}var ue=Array.isArray,z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O={pending:!1,data:null,method:null,action:null},X=[],he=-1;function _(s){return{current:s}}function Q(s){0>he||(s.current=X[he],X[he]=null,he--)}function Y(s,a){he++,X[he]=s.current,s.current=a}var ae=_(null),B=_(null),oe=_(null),$=_(null);function V(s,a){switch(Y(oe,a),Y(B,s),Y(ae,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?By(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=By(a),s=Qy(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}Q(ae),Y(ae,s)}function pe(){Q(ae),Q(B),Q(oe)}function me(s){s.memoizedState!==null&&Y($,s);var a=ae.current,c=Qy(a,s.type);a!==c&&(Y(B,s),Y(ae,c))}function ye(s){B.current===s&&(Q(ae),Q(B)),$.current===s&&(Q($),hi._currentValue=O)}var ve,_e;function Ue(s){if(ve===void 0)try{throw Error()}catch(c){var a=c.stack.trim().match(/\n( *(at )?)/);ve=a&&a[1]||"",_e=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ve+s+_e}var at=!1;function Ze(s,a){if(!s||at)return"";at=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(a){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(W){var K=W}Reflect.construct(s,[],ie)}else{try{ie.call()}catch(W){K=W}s.call(ie.prototype)}}else{try{throw Error()}catch(W){K=W}(ie=s())&&typeof ie.catch=="function"&&ie.catch(function(){})}}catch(W){if(W&&K&&typeof W.stack=="string")return[W.stack,K.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=d.DetermineComponentFrameRoot(),R=b[0],k=b[1];if(R&&k){var L=R.split(`
`),F=k.split(`
`);for(v=d=0;d<L.length&&!L[d].includes("DetermineComponentFrameRoot");)d++;for(;v<F.length&&!F[v].includes("DetermineComponentFrameRoot");)v++;if(d===L.length||v===F.length)for(d=L.length-1,v=F.length-1;1<=d&&0<=v&&L[d]!==F[v];)v--;for(;1<=d&&0<=v;d--,v--)if(L[d]!==F[v]){if(d!==1||v!==1)do if(d--,v--,0>v||L[d]!==F[v]){var ne=`
`+L[d].replace(" at new "," at ");return s.displayName&&ne.includes("<anonymous>")&&(ne=ne.replace("<anonymous>",s.displayName)),ne}while(1<=d&&0<=v);break}}}finally{at=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?Ue(c):""}function Dt(s,a){switch(s.tag){case 26:case 27:case 5:return Ue(s.type);case 16:return Ue("Lazy");case 13:return s.child!==a&&a!==null?Ue("Suspense Fallback"):Ue("Suspense");case 19:return Ue("SuspenseList");case 0:case 15:return Ze(s.type,!1);case 11:return Ze(s.type.render,!1);case 1:return Ze(s.type,!0);case 31:return Ue("Activity");default:return""}}function de(s){try{var a="",c=null;do a+=Dt(s,c),c=s,s=s.return;while(s);return a}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var He=Object.prototype.hasOwnProperty,$e=r.unstable_scheduleCallback,yt=r.unstable_cancelCallback,pt=r.unstable_shouldYield,qt=r.unstable_requestPaint,Je=r.unstable_now,jt=r.unstable_getCurrentPriorityLevel,vt=r.unstable_ImmediatePriority,gt=r.unstable_UserBlockingPriority,Yt=r.unstable_NormalPriority,Gt=r.unstable_LowPriority,Rs=r.unstable_IdlePriority,Yn=r.log,kn=r.unstable_setDisableYieldValue,rs=null,Xt=null;function Ft(s){if(typeof Yn=="function"&&kn(s),Xt&&typeof Xt.setStrictMode=="function")try{Xt.setStrictMode(rs,s)}catch{}}var _t=Math.clz32?Math.clz32:Gi,Ua=Math.log,Dn=Math.LN2;function Gi(s){return s>>>=0,s===0?32:31-(Ua(s)/Dn|0)|0}var Ts=256,$a=262144,oa=4194304;function Xn(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function As(s,a,c){var d=s.pendingLanes;if(d===0)return 0;var v=0,b=s.suspendedLanes,R=s.pingedLanes;s=s.warmLanes;var k=d&134217727;return k!==0?(d=k&~b,d!==0?v=Xn(d):(R&=k,R!==0?v=Xn(R):c||(c=k&~s,c!==0&&(v=Xn(c))))):(k=d&~b,k!==0?v=Xn(k):R!==0?v=Xn(R):c||(c=d&~s,c!==0&&(v=Xn(c)))),v===0?0:a!==0&&a!==v&&(a&b)===0&&(b=v&-v,c=a&-a,b>=c||b===32&&(c&4194048)!==0)?a:v}function Ns(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function Mu(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ee(){var s=oa;return oa<<=1,(oa&62914560)===0&&(oa=4194304),s}function fe(s){for(var a=[],c=0;31>c;c++)a.push(s);return a}function be(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function ze(s,a,c,d,v,b){var R=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var k=s.entanglements,L=s.expirationTimes,F=s.hiddenUpdates;for(c=R&~c;0<c;){var ne=31-_t(c),ie=1<<ne;k[ne]=0,L[ne]=-1;var K=F[ne];if(K!==null)for(F[ne]=null,ne=0;ne<K.length;ne++){var W=K[ne];W!==null&&(W.lane&=-536870913)}c&=~ie}d!==0&&Oe(s,d,0),b!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=b&~(R&~a))}function Oe(s,a,c){s.pendingLanes|=a,s.suspendedLanes&=~a;var d=31-_t(a);s.entangledLanes|=a,s.entanglements[d]=s.entanglements[d]|1073741824|c&261930}function ct(s,a){var c=s.entangledLanes|=a;for(s=s.entanglements;c;){var d=31-_t(c),v=1<<d;v&a|s[d]&a&&(s[d]|=a),c&=~v}}function zt(s,a){var c=a&-a;return c=(c&42)!==0?1:Wt(c),(c&(s.suspendedLanes|a))!==0?0:c}function Wt(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Rt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function cn(){var s=j.p;return s!==0?s:(s=window.event,s===void 0?32:h0(s.type))}function wt(s,a){var c=j.p;try{return j.p=s,a()}finally{j.p=c}}var ot=Math.random().toString(36).slice(2),mt="__reactFiber$"+ot,Ht="__reactProps$"+ot,is="__reactContainer$"+ot,Be="__reactEvents$"+ot,jn="__reactListeners$"+ot,Ba="__reactHandles$"+ot,xo="__reactResources$"+ot,Ar="__reactMarker$"+ot;function Eu(s){delete s[mt],delete s[Ht],delete s[Be],delete s[jn],delete s[Ba]}function wo(s){var a=s[mt];if(a)return a;for(var c=s.parentNode;c;){if(a=c[is]||c[mt]){if(c=a.alternate,a.child!==null||c!==null&&c.child!==null)for(s=Wy(s);s!==null;){if(c=s[mt])return c;s=Wy(s)}return a}s=c,c=s.parentNode}return null}function So(s){if(s=s[mt]||s[is]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function Nr(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(n(33))}function Co(s){var a=s[xo];return a||(a=s[xo]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Vt(s){s[Ar]=!0}var Dp=new Set,jp={};function Qa(s,a){Mo(s,a),Mo(s+"Capture",a)}function Mo(s,a){for(jp[s]=a,s=0;s<a.length;s++)Dp.add(a[s])}var BS=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_p={},zp={};function QS(s){return He.call(zp,s)?!0:He.call(_p,s)?!1:BS.test(s)?zp[s]=!0:(_p[s]=!0,!1)}function Fi(s,a,c){if(QS(a))if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var d=a.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+c)}}function Vi(s,a,c){if(c===null)s.removeAttribute(a);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+c)}}function ks(s,a,c,d){if(d===null)s.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(a,c,""+d)}}function _n(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Lp(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function GS(s,a,c){var d=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,b=d.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return v.call(this)},set:function(R){c=""+R,b.call(this,R)}}),Object.defineProperty(s,a,{enumerable:d.enumerable}),{getValue:function(){return c},setValue:function(R){c=""+R},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function Ru(s){if(!s._valueTracker){var a=Lp(s)?"checked":"value";s._valueTracker=GS(s,a,""+s[a])}}function Op(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var c=a.getValue(),d="";return s&&(d=Lp(s)?s.checked?"true":"false":s.value),s=d,s!==c?(a.setValue(s),!0):!1}function Ki(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var FS=/[\n"\\]/g;function zn(s){return s.replace(FS,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Tu(s,a,c,d,v,b,R,k){s.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?s.type=R:s.removeAttribute("type"),a!=null?R==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+_n(a)):s.value!==""+_n(a)&&(s.value=""+_n(a)):R!=="submit"&&R!=="reset"||s.removeAttribute("value"),a!=null?Au(s,R,_n(a)):c!=null?Au(s,R,_n(c)):d!=null&&s.removeAttribute("value"),v==null&&b!=null&&(s.defaultChecked=!!b),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.name=""+_n(k):s.removeAttribute("name")}function Pp(s,a,c,d,v,b,R,k){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(s.type=b),a!=null||c!=null){if(!(b!=="submit"&&b!=="reset"||a!=null)){Ru(s);return}c=c!=null?""+_n(c):"",a=a!=null?""+_n(a):c,k||a===s.value||(s.value=a),s.defaultValue=a}d=d??v,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=k?s.checked:!!d,s.defaultChecked=!!d,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(s.name=R),Ru(s)}function Au(s,a,c){a==="number"&&Ki(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Eo(s,a,c,d){if(s=s.options,a){a={};for(var v=0;v<c.length;v++)a["$"+c[v]]=!0;for(c=0;c<s.length;c++)v=a.hasOwnProperty("$"+s[c].value),s[c].selected!==v&&(s[c].selected=v),v&&d&&(s[c].defaultSelected=!0)}else{for(c=""+_n(c),a=null,v=0;v<s.length;v++){if(s[v].value===c){s[v].selected=!0,d&&(s[v].defaultSelected=!0);return}a!==null||s[v].disabled||(a=s[v])}a!==null&&(a.selected=!0)}}function Ip(s,a,c){if(a!=null&&(a=""+_n(a),a!==s.value&&(s.value=a),c==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=c!=null?""+_n(c):""}function qp(s,a,c,d){if(a==null){if(d!=null){if(c!=null)throw Error(n(92));if(ue(d)){if(1<d.length)throw Error(n(93));d=d[0]}c=d}c==null&&(c=""),a=c}c=_n(a),s.defaultValue=c,d=s.textContent,d===c&&d!==""&&d!==null&&(s.value=d),Ru(s)}function Ro(s,a){if(a){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=a;return}}s.textContent=a}var VS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Hp(s,a,c){var d=a.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":d?s.setProperty(a,c):typeof c!="number"||c===0||VS.has(a)?a==="float"?s.cssFloat=c:s[a]=(""+c).trim():s[a]=c+"px"}function Up(s,a,c){if(a!=null&&typeof a!="object")throw Error(n(62));if(s=s.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||a!=null&&a.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var v in a)d=a[v],a.hasOwnProperty(v)&&c[v]!==d&&Hp(s,v,d)}else for(var b in a)a.hasOwnProperty(b)&&Hp(s,b,a[b])}function Nu(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var KS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),YS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Yi(s){return YS.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Ds(){}var ku=null;function Du(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var To=null,Ao=null;function $p(s){var a=So(s);if(a&&(s=a.stateNode)){var c=s[Ht]||null;e:switch(s=a.stateNode,a.type){case"input":if(Tu(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),a=c.name,c.type==="radio"&&a!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+zn(""+a)+'"][type="radio"]'),a=0;a<c.length;a++){var d=c[a];if(d!==s&&d.form===s.form){var v=d[Ht]||null;if(!v)throw Error(n(90));Tu(d,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(a=0;a<c.length;a++)d=c[a],d.form===s.form&&Op(d)}break e;case"textarea":Ip(s,c.value,c.defaultValue);break e;case"select":a=c.value,a!=null&&Eo(s,!!c.multiple,a,!1)}}}var ju=!1;function Bp(s,a,c){if(ju)return s(a,c);ju=!0;try{var d=s(a);return d}finally{if(ju=!1,(To!==null||Ao!==null)&&(Oc(),To&&(a=To,s=Ao,Ao=To=null,$p(a),s)))for(a=0;a<s.length;a++)$p(s[a])}}function kr(s,a){var c=s.stateNode;if(c===null)return null;var d=c[Ht]||null;if(d===null)return null;c=d[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,a,typeof c));return c}var js=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_u=!1;if(js)try{var Dr={};Object.defineProperty(Dr,"passive",{get:function(){_u=!0}}),window.addEventListener("test",Dr,Dr),window.removeEventListener("test",Dr,Dr)}catch{_u=!1}var ra=null,zu=null,Xi=null;function Qp(){if(Xi)return Xi;var s,a=zu,c=a.length,d,v="value"in ra?ra.value:ra.textContent,b=v.length;for(s=0;s<c&&a[s]===v[s];s++);var R=c-s;for(d=1;d<=R&&a[c-d]===v[b-d];d++);return Xi=v.slice(s,1<d?1-d:void 0)}function Wi(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Zi(){return!0}function Gp(){return!1}function fn(s){function a(c,d,v,b,R){this._reactName=c,this._targetInst=v,this.type=d,this.nativeEvent=b,this.target=R,this.currentTarget=null;for(var k in s)s.hasOwnProperty(k)&&(c=s[k],this[k]=c?c(b):b[k]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Zi:Gp,this.isPropagationStopped=Gp,this}return m(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Zi)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Zi)},persist:function(){},isPersistent:Zi}),a}var Ga={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ji=fn(Ga),jr=m({},Ga,{view:0,detail:0}),XS=fn(jr),Lu,Ou,_r,ec=m({},jr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Iu,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==_r&&(_r&&s.type==="mousemove"?(Lu=s.screenX-_r.screenX,Ou=s.screenY-_r.screenY):Ou=Lu=0,_r=s),Lu)},movementY:function(s){return"movementY"in s?s.movementY:Ou}}),Fp=fn(ec),WS=m({},ec,{dataTransfer:0}),ZS=fn(WS),JS=m({},jr,{relatedTarget:0}),Pu=fn(JS),eC=m({},Ga,{animationName:0,elapsedTime:0,pseudoElement:0}),tC=fn(eC),nC=m({},Ga,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),sC=fn(nC),aC=m({},Ga,{data:0}),Vp=fn(aC),oC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},iC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cC(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=iC[s])?!!a[s]:!1}function Iu(){return cC}var lC=m({},jr,{key:function(s){if(s.key){var a=oC[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=Wi(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?rC[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Iu,charCode:function(s){return s.type==="keypress"?Wi(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Wi(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),uC=fn(lC),dC=m({},ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kp=fn(dC),fC=m({},jr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Iu}),hC=fn(fC),pC=m({},Ga,{propertyName:0,elapsedTime:0,pseudoElement:0}),gC=fn(pC),mC=m({},ec,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),yC=fn(mC),vC=m({},Ga,{newState:0,oldState:0}),bC=fn(vC),xC=[9,13,27,32],qu=js&&"CompositionEvent"in window,zr=null;js&&"documentMode"in document&&(zr=document.documentMode);var wC=js&&"TextEvent"in window&&!zr,Yp=js&&(!qu||zr&&8<zr&&11>=zr),Xp=" ",Wp=!1;function Zp(s,a){switch(s){case"keyup":return xC.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jp(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var No=!1;function SC(s,a){switch(s){case"compositionend":return Jp(a);case"keypress":return a.which!==32?null:(Wp=!0,Xp);case"textInput":return s=a.data,s===Xp&&Wp?null:s;default:return null}}function CC(s,a){if(No)return s==="compositionend"||!qu&&Zp(s,a)?(s=Qp(),Xi=zu=ra=null,No=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Yp&&a.locale!=="ko"?null:a.data;default:return null}}var MC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function eg(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!MC[s.type]:a==="textarea"}function tg(s,a,c,d){To?Ao?Ao.push(d):Ao=[d]:To=d,a=Bc(a,"onChange"),0<a.length&&(c=new Ji("onChange","change",null,c,d),s.push({event:c,listeners:a}))}var Lr=null,Or=null;function EC(s){Py(s,0)}function tc(s){var a=Nr(s);if(Op(a))return s}function ng(s,a){if(s==="change")return a}var sg=!1;if(js){var Hu;if(js){var Uu="oninput"in document;if(!Uu){var ag=document.createElement("div");ag.setAttribute("oninput","return;"),Uu=typeof ag.oninput=="function"}Hu=Uu}else Hu=!1;sg=Hu&&(!document.documentMode||9<document.documentMode)}function og(){Lr&&(Lr.detachEvent("onpropertychange",rg),Or=Lr=null)}function rg(s){if(s.propertyName==="value"&&tc(Or)){var a=[];tg(a,Or,s,Du(s)),Bp(EC,a)}}function RC(s,a,c){s==="focusin"?(og(),Lr=a,Or=c,Lr.attachEvent("onpropertychange",rg)):s==="focusout"&&og()}function TC(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return tc(Or)}function AC(s,a){if(s==="click")return tc(a)}function NC(s,a){if(s==="input"||s==="change")return tc(a)}function kC(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var xn=typeof Object.is=="function"?Object.is:kC;function Pr(s,a){if(xn(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var c=Object.keys(s),d=Object.keys(a);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var v=c[d];if(!He.call(a,v)||!xn(s[v],a[v]))return!1}return!0}function ig(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function cg(s,a){var c=ig(s);s=0;for(var d;c;){if(c.nodeType===3){if(d=s+c.textContent.length,s<=a&&d>=a)return{node:c,offset:a-s};s=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=ig(c)}}function lg(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?lg(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function ug(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=Ki(s.document);a instanceof s.HTMLIFrameElement;){try{var c=typeof a.contentWindow.location.href=="string"}catch{c=!1}if(c)s=a.contentWindow;else break;a=Ki(s.document)}return a}function $u(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var DC=js&&"documentMode"in document&&11>=document.documentMode,ko=null,Bu=null,Ir=null,Qu=!1;function dg(s,a,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Qu||ko==null||ko!==Ki(d)||(d=ko,"selectionStart"in d&&$u(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Ir&&Pr(Ir,d)||(Ir=d,d=Bc(Bu,"onSelect"),0<d.length&&(a=new Ji("onSelect","select",null,a,c),s.push({event:a,listeners:d}),a.target=ko)))}function Fa(s,a){var c={};return c[s.toLowerCase()]=a.toLowerCase(),c["Webkit"+s]="webkit"+a,c["Moz"+s]="moz"+a,c}var Do={animationend:Fa("Animation","AnimationEnd"),animationiteration:Fa("Animation","AnimationIteration"),animationstart:Fa("Animation","AnimationStart"),transitionrun:Fa("Transition","TransitionRun"),transitionstart:Fa("Transition","TransitionStart"),transitioncancel:Fa("Transition","TransitionCancel"),transitionend:Fa("Transition","TransitionEnd")},Gu={},fg={};js&&(fg=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function Va(s){if(Gu[s])return Gu[s];if(!Do[s])return s;var a=Do[s],c;for(c in a)if(a.hasOwnProperty(c)&&c in fg)return Gu[s]=a[c];return s}var hg=Va("animationend"),pg=Va("animationiteration"),gg=Va("animationstart"),jC=Va("transitionrun"),_C=Va("transitionstart"),zC=Va("transitioncancel"),mg=Va("transitionend"),yg=new Map,Fu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Fu.push("scrollEnd");function Wn(s,a){yg.set(s,a),Qa(a,[s])}var nc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ln=[],jo=0,Vu=0;function sc(){for(var s=jo,a=Vu=jo=0;a<s;){var c=Ln[a];Ln[a++]=null;var d=Ln[a];Ln[a++]=null;var v=Ln[a];Ln[a++]=null;var b=Ln[a];if(Ln[a++]=null,d!==null&&v!==null){var R=d.pending;R===null?v.next=v:(v.next=R.next,R.next=v),d.pending=v}b!==0&&vg(c,v,b)}}function ac(s,a,c,d){Ln[jo++]=s,Ln[jo++]=a,Ln[jo++]=c,Ln[jo++]=d,Vu|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function Ku(s,a,c,d){return ac(s,a,c,d),oc(s)}function Ka(s,a){return ac(s,null,null,a),oc(s)}function vg(s,a,c){s.lanes|=c;var d=s.alternate;d!==null&&(d.lanes|=c);for(var v=!1,b=s.return;b!==null;)b.childLanes|=c,d=b.alternate,d!==null&&(d.childLanes|=c),b.tag===22&&(s=b.stateNode,s===null||s._visibility&1||(v=!0)),s=b,b=b.return;return s.tag===3?(b=s.stateNode,v&&a!==null&&(v=31-_t(c),s=b.hiddenUpdates,d=s[v],d===null?s[v]=[a]:d.push(a),a.lane=c|536870912),b):null}function oc(s){if(50<ri)throw ri=0,sf=null,Error(n(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var _o={};function LC(s,a,c,d){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wn(s,a,c,d){return new LC(s,a,c,d)}function Yu(s){return s=s.prototype,!(!s||!s.isReactComponent)}function _s(s,a){var c=s.alternate;return c===null?(c=wn(s.tag,a,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=a,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,a=s.dependencies,c.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function bg(s,a){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,a=c.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function rc(s,a,c,d,v,b){var R=0;if(d=s,typeof s=="function")Yu(s)&&(R=1);else if(typeof s=="string")R=HM(s,c,ae.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case J:return s=wn(31,c,a,v),s.elementType=J,s.lanes=b,s;case C:return Ya(c.children,v,b,a);case E:R=8,v|=24;break;case M:return s=wn(12,c,a,v|2),s.elementType=M,s.lanes=b,s;case D:return s=wn(13,c,a,v),s.elementType=D,s.lanes=b,s;case q:return s=wn(19,c,a,v),s.elementType=q,s.lanes=b,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case T:R=10;break e;case A:R=9;break e;case N:R=11;break e;case P:R=14;break e;case H:R=16,d=null;break e}R=29,c=Error(n(130,s===null?"null":typeof s,"")),d=null}return a=wn(R,c,a,v),a.elementType=s,a.type=d,a.lanes=b,a}function Ya(s,a,c,d){return s=wn(7,s,d,a),s.lanes=c,s}function Xu(s,a,c){return s=wn(6,s,null,a),s.lanes=c,s}function xg(s){var a=wn(18,null,null,0);return a.stateNode=s,a}function Wu(s,a,c){return a=wn(4,s.children!==null?s.children:[],s.key,a),a.lanes=c,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var wg=new WeakMap;function On(s,a){if(typeof s=="object"&&s!==null){var c=wg.get(s);return c!==void 0?c:(a={value:s,source:a,stack:de(a)},wg.set(s,a),a)}return{value:s,source:a,stack:de(a)}}var zo=[],Lo=0,ic=null,qr=0,Pn=[],In=0,ia=null,cs=1,ls="";function zs(s,a){zo[Lo++]=qr,zo[Lo++]=ic,ic=s,qr=a}function Sg(s,a,c){Pn[In++]=cs,Pn[In++]=ls,Pn[In++]=ia,ia=s;var d=cs;s=ls;var v=32-_t(d)-1;d&=~(1<<v),c+=1;var b=32-_t(a)+v;if(30<b){var R=v-v%5;b=(d&(1<<R)-1).toString(32),d>>=R,v-=R,cs=1<<32-_t(a)+v|c<<v|d,ls=b+s}else cs=1<<b|c<<v|d,ls=s}function Zu(s){s.return!==null&&(zs(s,1),Sg(s,1,0))}function Ju(s){for(;s===ic;)ic=zo[--Lo],zo[Lo]=null,qr=zo[--Lo],zo[Lo]=null;for(;s===ia;)ia=Pn[--In],Pn[In]=null,ls=Pn[--In],Pn[In]=null,cs=Pn[--In],Pn[In]=null}function Cg(s,a){Pn[In++]=cs,Pn[In++]=ls,Pn[In++]=ia,cs=a.id,ls=a.overflow,ia=s}var Zt=null,bt=null,Xe=!1,ca=null,qn=!1,ed=Error(n(519));function la(s){var a=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Hr(On(a,s)),ed}function Mg(s){var a=s.stateNode,c=s.type,d=s.memoizedProps;switch(a[mt]=s,a[Ht]=d,c){case"dialog":Ge("cancel",a),Ge("close",a);break;case"iframe":case"object":case"embed":Ge("load",a);break;case"video":case"audio":for(c=0;c<ci.length;c++)Ge(ci[c],a);break;case"source":Ge("error",a);break;case"img":case"image":case"link":Ge("error",a),Ge("load",a);break;case"details":Ge("toggle",a);break;case"input":Ge("invalid",a),Pp(a,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":Ge("invalid",a);break;case"textarea":Ge("invalid",a),qp(a,d.value,d.defaultValue,d.children)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||a.textContent===""+c||d.suppressHydrationWarning===!0||Uy(a.textContent,c)?(d.popover!=null&&(Ge("beforetoggle",a),Ge("toggle",a)),d.onScroll!=null&&Ge("scroll",a),d.onScrollEnd!=null&&Ge("scrollend",a),d.onClick!=null&&(a.onclick=Ds),a=!0):a=!1,a||la(s,!0)}function Eg(s){for(Zt=s.return;Zt;)switch(Zt.tag){case 5:case 31:case 13:qn=!1;return;case 27:case 3:qn=!0;return;default:Zt=Zt.return}}function Oo(s){if(s!==Zt)return!1;if(!Xe)return Eg(s),Xe=!0,!1;var a=s.tag,c;if((c=a!==3&&a!==27)&&((c=a===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||bf(s.type,s.memoizedProps)),c=!c),c&&bt&&la(s),Eg(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));bt=Xy(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));bt=Xy(s)}else a===27?(a=bt,Ca(s.type)?(s=Mf,Mf=null,bt=s):bt=a):bt=Zt?Un(s.stateNode.nextSibling):null;return!0}function Xa(){bt=Zt=null,Xe=!1}function td(){var s=ca;return s!==null&&(mn===null?mn=s:mn.push.apply(mn,s),ca=null),s}function Hr(s){ca===null?ca=[s]:ca.push(s)}var nd=_(null),Wa=null,Ls=null;function ua(s,a,c){Y(nd,a._currentValue),a._currentValue=c}function Os(s){s._currentValue=nd.current,Q(nd)}function sd(s,a,c){for(;s!==null;){var d=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,d!==null&&(d.childLanes|=a)):d!==null&&(d.childLanes&a)!==a&&(d.childLanes|=a),s===c)break;s=s.return}}function ad(s,a,c,d){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var b=v.dependencies;if(b!==null){var R=v.child;b=b.firstContext;e:for(;b!==null;){var k=b;b=v;for(var L=0;L<a.length;L++)if(k.context===a[L]){b.lanes|=c,k=b.alternate,k!==null&&(k.lanes|=c),sd(b.return,c,s),d||(R=null);break e}b=k.next}}else if(v.tag===18){if(R=v.return,R===null)throw Error(n(341));R.lanes|=c,b=R.alternate,b!==null&&(b.lanes|=c),sd(R,c,s),R=null}else R=v.child;if(R!==null)R.return=v;else for(R=v;R!==null;){if(R===s){R=null;break}if(v=R.sibling,v!==null){v.return=R.return,R=v;break}R=R.return}v=R}}function Po(s,a,c,d){s=null;for(var v=a,b=!1;v!==null;){if(!b){if((v.flags&524288)!==0)b=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var R=v.alternate;if(R===null)throw Error(n(387));if(R=R.memoizedProps,R!==null){var k=v.type;xn(v.pendingProps.value,R.value)||(s!==null?s.push(k):s=[k])}}else if(v===$.current){if(R=v.alternate,R===null)throw Error(n(387));R.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(hi):s=[hi])}v=v.return}s!==null&&ad(a,s,c,d),a.flags|=262144}function cc(s){for(s=s.firstContext;s!==null;){if(!xn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Za(s){Wa=s,Ls=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Jt(s){return Rg(Wa,s)}function lc(s,a){return Wa===null&&Za(s),Rg(s,a)}function Rg(s,a){var c=a._currentValue;if(a={context:a,memoizedValue:c,next:null},Ls===null){if(s===null)throw Error(n(308));Ls=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Ls=Ls.next=a;return c}var OC=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(c,d){s.push(d)}};this.abort=function(){a.aborted=!0,s.forEach(function(c){return c()})}},PC=r.unstable_scheduleCallback,IC=r.unstable_NormalPriority,Lt={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function od(){return{controller:new OC,data:new Map,refCount:0}}function Ur(s){s.refCount--,s.refCount===0&&PC(IC,function(){s.controller.abort()})}var $r=null,rd=0,Io=0,qo=null;function qC(s,a){if($r===null){var c=$r=[];rd=0,Io=uf(),qo={status:"pending",value:void 0,then:function(d){c.push(d)}}}return rd++,a.then(Tg,Tg),a}function Tg(){if(--rd===0&&$r!==null){qo!==null&&(qo.status="fulfilled");var s=$r;$r=null,Io=0,qo=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function HC(s,a){var c=[],d={status:"pending",value:null,reason:null,then:function(v){c.push(v)}};return s.then(function(){d.status="fulfilled",d.value=a;for(var v=0;v<c.length;v++)(0,c[v])(a)},function(v){for(d.status="rejected",d.reason=v,v=0;v<c.length;v++)(0,c[v])(void 0)}),d}var Ag=z.S;z.S=function(s,a){dy=Je(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&qC(s,a),Ag!==null&&Ag(s,a)};var Ja=_(null);function id(){var s=Ja.current;return s!==null?s:ft.pooledCache}function uc(s,a){a===null?Y(Ja,Ja.current):Y(Ja,a.pool)}function Ng(){var s=id();return s===null?null:{parent:Lt._currentValue,pool:s}}var Ho=Error(n(460)),cd=Error(n(474)),dc=Error(n(542)),fc={then:function(){}};function kg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Dg(s,a,c){switch(c=s[c],c===void 0?s.push(a):c!==a&&(a.then(Ds,Ds),a=c),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,_g(s),s;default:if(typeof a.status=="string")a.then(Ds,Ds);else{if(s=ft,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=a,s.status="pending",s.then(function(d){if(a.status==="pending"){var v=a;v.status="fulfilled",v.value=d}},function(d){if(a.status==="pending"){var v=a;v.status="rejected",v.reason=d}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,_g(s),s}throw to=a,Ho}}function eo(s){try{var a=s._init;return a(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(to=c,Ho):c}}var to=null;function jg(){if(to===null)throw Error(n(459));var s=to;return to=null,s}function _g(s){if(s===Ho||s===dc)throw Error(n(483))}var Uo=null,Br=0;function hc(s){var a=Br;return Br+=1,Uo===null&&(Uo=[]),Dg(Uo,s,a)}function Qr(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function pc(s,a){throw a.$$typeof===y?Error(n(525)):(s=Object.prototype.toString.call(a),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function zg(s){function a(U,I){if(s){var G=U.deletions;G===null?(U.deletions=[I],U.flags|=16):G.push(I)}}function c(U,I){if(!s)return null;for(;I!==null;)a(U,I),I=I.sibling;return null}function d(U){for(var I=new Map;U!==null;)U.key!==null?I.set(U.key,U):I.set(U.index,U),U=U.sibling;return I}function v(U,I){return U=_s(U,I),U.index=0,U.sibling=null,U}function b(U,I,G){return U.index=G,s?(G=U.alternate,G!==null?(G=G.index,G<I?(U.flags|=67108866,I):G):(U.flags|=67108866,I)):(U.flags|=1048576,I)}function R(U){return s&&U.alternate===null&&(U.flags|=67108866),U}function k(U,I,G,re){return I===null||I.tag!==6?(I=Xu(G,U.mode,re),I.return=U,I):(I=v(I,G),I.return=U,I)}function L(U,I,G,re){var Te=G.type;return Te===C?ne(U,I,G.props.children,re,G.key):I!==null&&(I.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===H&&eo(Te)===I.type)?(I=v(I,G.props),Qr(I,G),I.return=U,I):(I=rc(G.type,G.key,G.props,null,U.mode,re),Qr(I,G),I.return=U,I)}function F(U,I,G,re){return I===null||I.tag!==4||I.stateNode.containerInfo!==G.containerInfo||I.stateNode.implementation!==G.implementation?(I=Wu(G,U.mode,re),I.return=U,I):(I=v(I,G.children||[]),I.return=U,I)}function ne(U,I,G,re,Te){return I===null||I.tag!==7?(I=Ya(G,U.mode,re,Te),I.return=U,I):(I=v(I,G),I.return=U,I)}function ie(U,I,G){if(typeof I=="string"&&I!==""||typeof I=="number"||typeof I=="bigint")return I=Xu(""+I,U.mode,G),I.return=U,I;if(typeof I=="object"&&I!==null){switch(I.$$typeof){case x:return G=rc(I.type,I.key,I.props,null,U.mode,G),Qr(G,I),G.return=U,G;case S:return I=Wu(I,U.mode,G),I.return=U,I;case H:return I=eo(I),ie(U,I,G)}if(ue(I)||Z(I))return I=Ya(I,U.mode,G,null),I.return=U,I;if(typeof I.then=="function")return ie(U,hc(I),G);if(I.$$typeof===T)return ie(U,lc(U,I),G);pc(U,I)}return null}function K(U,I,G,re){var Te=I!==null?I.key:null;if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return Te!==null?null:k(U,I,""+G,re);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case x:return G.key===Te?L(U,I,G,re):null;case S:return G.key===Te?F(U,I,G,re):null;case H:return G=eo(G),K(U,I,G,re)}if(ue(G)||Z(G))return Te!==null?null:ne(U,I,G,re,null);if(typeof G.then=="function")return K(U,I,hc(G),re);if(G.$$typeof===T)return K(U,I,lc(U,G),re);pc(U,G)}return null}function W(U,I,G,re,Te){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return U=U.get(G)||null,k(I,U,""+re,Te);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case x:return U=U.get(re.key===null?G:re.key)||null,L(I,U,re,Te);case S:return U=U.get(re.key===null?G:re.key)||null,F(I,U,re,Te);case H:return re=eo(re),W(U,I,G,re,Te)}if(ue(re)||Z(re))return U=U.get(G)||null,ne(I,U,re,Te,null);if(typeof re.then=="function")return W(U,I,G,hc(re),Te);if(re.$$typeof===T)return W(U,I,G,lc(I,re),Te);pc(I,re)}return null}function xe(U,I,G,re){for(var Te=null,et=null,Me=I,Ie=I=0,Ve=null;Me!==null&&Ie<G.length;Ie++){Me.index>Ie?(Ve=Me,Me=null):Ve=Me.sibling;var tt=K(U,Me,G[Ie],re);if(tt===null){Me===null&&(Me=Ve);break}s&&Me&&tt.alternate===null&&a(U,Me),I=b(tt,I,Ie),et===null?Te=tt:et.sibling=tt,et=tt,Me=Ve}if(Ie===G.length)return c(U,Me),Xe&&zs(U,Ie),Te;if(Me===null){for(;Ie<G.length;Ie++)Me=ie(U,G[Ie],re),Me!==null&&(I=b(Me,I,Ie),et===null?Te=Me:et.sibling=Me,et=Me);return Xe&&zs(U,Ie),Te}for(Me=d(Me);Ie<G.length;Ie++)Ve=W(Me,U,Ie,G[Ie],re),Ve!==null&&(s&&Ve.alternate!==null&&Me.delete(Ve.key===null?Ie:Ve.key),I=b(Ve,I,Ie),et===null?Te=Ve:et.sibling=Ve,et=Ve);return s&&Me.forEach(function(Aa){return a(U,Aa)}),Xe&&zs(U,Ie),Te}function ke(U,I,G,re){if(G==null)throw Error(n(151));for(var Te=null,et=null,Me=I,Ie=I=0,Ve=null,tt=G.next();Me!==null&&!tt.done;Ie++,tt=G.next()){Me.index>Ie?(Ve=Me,Me=null):Ve=Me.sibling;var Aa=K(U,Me,tt.value,re);if(Aa===null){Me===null&&(Me=Ve);break}s&&Me&&Aa.alternate===null&&a(U,Me),I=b(Aa,I,Ie),et===null?Te=Aa:et.sibling=Aa,et=Aa,Me=Ve}if(tt.done)return c(U,Me),Xe&&zs(U,Ie),Te;if(Me===null){for(;!tt.done;Ie++,tt=G.next())tt=ie(U,tt.value,re),tt!==null&&(I=b(tt,I,Ie),et===null?Te=tt:et.sibling=tt,et=tt);return Xe&&zs(U,Ie),Te}for(Me=d(Me);!tt.done;Ie++,tt=G.next())tt=W(Me,U,Ie,tt.value,re),tt!==null&&(s&&tt.alternate!==null&&Me.delete(tt.key===null?Ie:tt.key),I=b(tt,I,Ie),et===null?Te=tt:et.sibling=tt,et=tt);return s&&Me.forEach(function(WM){return a(U,WM)}),Xe&&zs(U,Ie),Te}function dt(U,I,G,re){if(typeof G=="object"&&G!==null&&G.type===C&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case x:e:{for(var Te=G.key;I!==null;){if(I.key===Te){if(Te=G.type,Te===C){if(I.tag===7){c(U,I.sibling),re=v(I,G.props.children),re.return=U,U=re;break e}}else if(I.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===H&&eo(Te)===I.type){c(U,I.sibling),re=v(I,G.props),Qr(re,G),re.return=U,U=re;break e}c(U,I);break}else a(U,I);I=I.sibling}G.type===C?(re=Ya(G.props.children,U.mode,re,G.key),re.return=U,U=re):(re=rc(G.type,G.key,G.props,null,U.mode,re),Qr(re,G),re.return=U,U=re)}return R(U);case S:e:{for(Te=G.key;I!==null;){if(I.key===Te)if(I.tag===4&&I.stateNode.containerInfo===G.containerInfo&&I.stateNode.implementation===G.implementation){c(U,I.sibling),re=v(I,G.children||[]),re.return=U,U=re;break e}else{c(U,I);break}else a(U,I);I=I.sibling}re=Wu(G,U.mode,re),re.return=U,U=re}return R(U);case H:return G=eo(G),dt(U,I,G,re)}if(ue(G))return xe(U,I,G,re);if(Z(G)){if(Te=Z(G),typeof Te!="function")throw Error(n(150));return G=Te.call(G),ke(U,I,G,re)}if(typeof G.then=="function")return dt(U,I,hc(G),re);if(G.$$typeof===T)return dt(U,I,lc(U,G),re);pc(U,G)}return typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint"?(G=""+G,I!==null&&I.tag===6?(c(U,I.sibling),re=v(I,G),re.return=U,U=re):(c(U,I),re=Xu(G,U.mode,re),re.return=U,U=re),R(U)):c(U,I)}return function(U,I,G,re){try{Br=0;var Te=dt(U,I,G,re);return Uo=null,Te}catch(Me){if(Me===Ho||Me===dc)throw Me;var et=wn(29,Me,null,U.mode);return et.lanes=re,et.return=U,et}finally{}}}var no=zg(!0),Lg=zg(!1),da=!1;function ld(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ud(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function fa(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ha(s,a,c){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(nt&2)!==0){var v=d.pending;return v===null?a.next=a:(a.next=v.next,v.next=a),d.pending=a,a=oc(s),vg(s,null,c),a}return ac(s,d,a,c),oc(s)}function Gr(s,a,c){if(a=a.updateQueue,a!==null&&(a=a.shared,(c&4194048)!==0)){var d=a.lanes;d&=s.pendingLanes,c|=d,a.lanes=c,ct(s,c)}}function dd(s,a){var c=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var v=null,b=null;if(c=c.firstBaseUpdate,c!==null){do{var R={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};b===null?v=b=R:b=b.next=R,c=c.next}while(c!==null);b===null?v=b=a:b=b.next=a}else v=b=a;c={baseState:d.baseState,firstBaseUpdate:v,lastBaseUpdate:b,shared:d.shared,callbacks:d.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=a:s.next=a,c.lastBaseUpdate=a}var fd=!1;function Fr(){if(fd){var s=qo;if(s!==null)throw s}}function Vr(s,a,c,d){fd=!1;var v=s.updateQueue;da=!1;var b=v.firstBaseUpdate,R=v.lastBaseUpdate,k=v.shared.pending;if(k!==null){v.shared.pending=null;var L=k,F=L.next;L.next=null,R===null?b=F:R.next=F,R=L;var ne=s.alternate;ne!==null&&(ne=ne.updateQueue,k=ne.lastBaseUpdate,k!==R&&(k===null?ne.firstBaseUpdate=F:k.next=F,ne.lastBaseUpdate=L))}if(b!==null){var ie=v.baseState;R=0,ne=F=L=null,k=b;do{var K=k.lane&-536870913,W=K!==k.lane;if(W?(Fe&K)===K:(d&K)===K){K!==0&&K===Io&&(fd=!0),ne!==null&&(ne=ne.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var xe=s,ke=k;K=a;var dt=c;switch(ke.tag){case 1:if(xe=ke.payload,typeof xe=="function"){ie=xe.call(dt,ie,K);break e}ie=xe;break e;case 3:xe.flags=xe.flags&-65537|128;case 0:if(xe=ke.payload,K=typeof xe=="function"?xe.call(dt,ie,K):xe,K==null)break e;ie=m({},ie,K);break e;case 2:da=!0}}K=k.callback,K!==null&&(s.flags|=64,W&&(s.flags|=8192),W=v.callbacks,W===null?v.callbacks=[K]:W.push(K))}else W={lane:K,tag:k.tag,payload:k.payload,callback:k.callback,next:null},ne===null?(F=ne=W,L=ie):ne=ne.next=W,R|=K;if(k=k.next,k===null){if(k=v.shared.pending,k===null)break;W=k,k=W.next,W.next=null,v.lastBaseUpdate=W,v.shared.pending=null}}while(!0);ne===null&&(L=ie),v.baseState=L,v.firstBaseUpdate=F,v.lastBaseUpdate=ne,b===null&&(v.shared.lanes=0),va|=R,s.lanes=R,s.memoizedState=ie}}function Og(s,a){if(typeof s!="function")throw Error(n(191,s));s.call(a)}function Pg(s,a){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)Og(c[s],a)}var $o=_(null),gc=_(0);function Ig(s,a){s=Gs,Y(gc,s),Y($o,a),Gs=s|a.baseLanes}function hd(){Y(gc,Gs),Y($o,$o.current)}function pd(){Gs=gc.current,Q($o),Q(gc)}var Sn=_(null),Hn=null;function pa(s){var a=s.alternate;Y(Tt,Tt.current&1),Y(Sn,s),Hn===null&&(a===null||$o.current!==null||a.memoizedState!==null)&&(Hn=s)}function gd(s){Y(Tt,Tt.current),Y(Sn,s),Hn===null&&(Hn=s)}function qg(s){s.tag===22?(Y(Tt,Tt.current),Y(Sn,s),Hn===null&&(Hn=s)):ga()}function ga(){Y(Tt,Tt.current),Y(Sn,Sn.current)}function Cn(s){Q(Sn),Hn===s&&(Hn=null),Q(Tt)}var Tt=_(0);function mc(s){for(var a=s;a!==null;){if(a.tag===13){var c=a.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||Sf(c)||Cf(c)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Ps=0,Pe=null,lt=null,Ot=null,yc=!1,Bo=!1,so=!1,vc=0,Kr=0,Qo=null,UC=0;function Ct(){throw Error(n(321))}function md(s,a){if(a===null)return!1;for(var c=0;c<a.length&&c<s.length;c++)if(!xn(s[c],a[c]))return!1;return!0}function yd(s,a,c,d,v,b){return Ps=b,Pe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,z.H=s===null||s.memoizedState===null?Sm:jd,so=!1,b=c(d,v),so=!1,Bo&&(b=Ug(a,c,d,v)),Hg(s),b}function Hg(s){z.H=Wr;var a=lt!==null&&lt.next!==null;if(Ps=0,Ot=lt=Pe=null,yc=!1,Kr=0,Qo=null,a)throw Error(n(300));s===null||Pt||(s=s.dependencies,s!==null&&cc(s)&&(Pt=!0))}function Ug(s,a,c,d){Pe=s;var v=0;do{if(Bo&&(Qo=null),Kr=0,Bo=!1,25<=v)throw Error(n(301));if(v+=1,Ot=lt=null,s.updateQueue!=null){var b=s.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}z.H=Cm,b=a(c,d)}while(Bo);return b}function $C(){var s=z.H,a=s.useState()[0];return a=typeof a.then=="function"?Yr(a):a,s=s.useState()[0],(lt!==null?lt.memoizedState:null)!==s&&(Pe.flags|=1024),a}function vd(){var s=vc!==0;return vc=0,s}function bd(s,a,c){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~c}function xd(s){if(yc){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}yc=!1}Ps=0,Ot=lt=Pe=null,Bo=!1,Kr=vc=0,Qo=null}function ln(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?Pe.memoizedState=Ot=s:Ot=Ot.next=s,Ot}function At(){if(lt===null){var s=Pe.alternate;s=s!==null?s.memoizedState:null}else s=lt.next;var a=Ot===null?Pe.memoizedState:Ot.next;if(a!==null)Ot=a,lt=s;else{if(s===null)throw Pe.alternate===null?Error(n(467)):Error(n(310));lt=s,s={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},Ot===null?Pe.memoizedState=Ot=s:Ot=Ot.next=s}return Ot}function bc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yr(s){var a=Kr;return Kr+=1,Qo===null&&(Qo=[]),s=Dg(Qo,s,a),a=Pe,(Ot===null?a.memoizedState:Ot.next)===null&&(a=a.alternate,z.H=a===null||a.memoizedState===null?Sm:jd),s}function xc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Yr(s);if(s.$$typeof===T)return Jt(s)}throw Error(n(438,String(s)))}function wd(s){var a=null,c=Pe.updateQueue;if(c!==null&&(a=c.memoCache),a==null){var d=Pe.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(a={data:d.data.map(function(v){return v.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),c===null&&(c=bc(),Pe.updateQueue=c),c.memoCache=a,c=a.data[a.index],c===void 0)for(c=a.data[a.index]=Array(s),d=0;d<s;d++)c[d]=se;return a.index++,c}function Is(s,a){return typeof a=="function"?a(s):a}function wc(s){var a=At();return Sd(a,lt,s)}function Sd(s,a,c){var d=s.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=c;var v=s.baseQueue,b=d.pending;if(b!==null){if(v!==null){var R=v.next;v.next=b.next,b.next=R}a.baseQueue=v=b,d.pending=null}if(b=s.baseState,v===null)s.memoizedState=b;else{a=v.next;var k=R=null,L=null,F=a,ne=!1;do{var ie=F.lane&-536870913;if(ie!==F.lane?(Fe&ie)===ie:(Ps&ie)===ie){var K=F.revertLane;if(K===0)L!==null&&(L=L.next={lane:0,revertLane:0,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),ie===Io&&(ne=!0);else if((Ps&K)===K){F=F.next,K===Io&&(ne=!0);continue}else ie={lane:0,revertLane:F.revertLane,gesture:null,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},L===null?(k=L=ie,R=b):L=L.next=ie,Pe.lanes|=K,va|=K;ie=F.action,so&&c(b,ie),b=F.hasEagerState?F.eagerState:c(b,ie)}else K={lane:ie,revertLane:F.revertLane,gesture:F.gesture,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},L===null?(k=L=K,R=b):L=L.next=K,Pe.lanes|=ie,va|=ie;F=F.next}while(F!==null&&F!==a);if(L===null?R=b:L.next=k,!xn(b,s.memoizedState)&&(Pt=!0,ne&&(c=qo,c!==null)))throw c;s.memoizedState=b,s.baseState=R,s.baseQueue=L,d.lastRenderedState=b}return v===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function Cd(s){var a=At(),c=a.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var d=c.dispatch,v=c.pending,b=a.memoizedState;if(v!==null){c.pending=null;var R=v=v.next;do b=s(b,R.action),R=R.next;while(R!==v);xn(b,a.memoizedState)||(Pt=!0),a.memoizedState=b,a.baseQueue===null&&(a.baseState=b),c.lastRenderedState=b}return[b,d]}function $g(s,a,c){var d=Pe,v=At(),b=Xe;if(b){if(c===void 0)throw Error(n(407));c=c()}else c=a();var R=!xn((lt||v).memoizedState,c);if(R&&(v.memoizedState=c,Pt=!0),v=v.queue,Rd(Gg.bind(null,d,v,s),[s]),v.getSnapshot!==a||R||Ot!==null&&Ot.memoizedState.tag&1){if(d.flags|=2048,Go(9,{destroy:void 0},Qg.bind(null,d,v,c,a),null),ft===null)throw Error(n(349));b||(Ps&127)!==0||Bg(d,a,c)}return c}function Bg(s,a,c){s.flags|=16384,s={getSnapshot:a,value:c},a=Pe.updateQueue,a===null?(a=bc(),Pe.updateQueue=a,a.stores=[s]):(c=a.stores,c===null?a.stores=[s]:c.push(s))}function Qg(s,a,c,d){a.value=c,a.getSnapshot=d,Fg(a)&&Vg(s)}function Gg(s,a,c){return c(function(){Fg(a)&&Vg(s)})}function Fg(s){var a=s.getSnapshot;s=s.value;try{var c=a();return!xn(s,c)}catch{return!0}}function Vg(s){var a=Ka(s,2);a!==null&&yn(a,s,2)}function Md(s){var a=ln();if(typeof s=="function"){var c=s;if(s=c(),so){Ft(!0);try{c()}finally{Ft(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:s},a}function Kg(s,a,c,d){return s.baseState=c,Sd(s,lt,typeof d=="function"?d:Is)}function BC(s,a,c,d,v){if(Mc(s))throw Error(n(485));if(s=a.action,s!==null){var b={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){b.listeners.push(R)}};z.T!==null?c(!0):b.isTransition=!1,d(b),c=a.pending,c===null?(b.next=a.pending=b,Yg(a,b)):(b.next=c.next,a.pending=c.next=b)}}function Yg(s,a){var c=a.action,d=a.payload,v=s.state;if(a.isTransition){var b=z.T,R={};z.T=R;try{var k=c(v,d),L=z.S;L!==null&&L(R,k),Xg(s,a,k)}catch(F){Ed(s,a,F)}finally{b!==null&&R.types!==null&&(b.types=R.types),z.T=b}}else try{b=c(v,d),Xg(s,a,b)}catch(F){Ed(s,a,F)}}function Xg(s,a,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){Wg(s,a,d)},function(d){return Ed(s,a,d)}):Wg(s,a,c)}function Wg(s,a,c){a.status="fulfilled",a.value=c,Zg(a),s.state=c,a=s.pending,a!==null&&(c=a.next,c===a?s.pending=null:(c=c.next,a.next=c,Yg(s,c)))}function Ed(s,a,c){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do a.status="rejected",a.reason=c,Zg(a),a=a.next;while(a!==d)}s.action=null}function Zg(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function Jg(s,a){return a}function em(s,a){if(Xe){var c=ft.formState;if(c!==null){e:{var d=Pe;if(Xe){if(bt){t:{for(var v=bt,b=qn;v.nodeType!==8;){if(!b){v=null;break t}if(v=Un(v.nextSibling),v===null){v=null;break t}}b=v.data,v=b==="F!"||b==="F"?v:null}if(v){bt=Un(v.nextSibling),d=v.data==="F!";break e}}la(d)}d=!1}d&&(a=c[0])}}return c=ln(),c.memoizedState=c.baseState=a,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Jg,lastRenderedState:a},c.queue=d,c=bm.bind(null,Pe,d),d.dispatch=c,d=Md(!1),b=Dd.bind(null,Pe,!1,d.queue),d=ln(),v={state:a,dispatch:null,action:s,pending:null},d.queue=v,c=BC.bind(null,Pe,v,b,c),v.dispatch=c,d.memoizedState=s,[a,c,!1]}function tm(s){var a=At();return nm(a,lt,s)}function nm(s,a,c){if(a=Sd(s,a,Jg)[0],s=wc(Is)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var d=Yr(a)}catch(R){throw R===Ho?dc:R}else d=a;a=At();var v=a.queue,b=v.dispatch;return c!==a.memoizedState&&(Pe.flags|=2048,Go(9,{destroy:void 0},QC.bind(null,v,c),null)),[d,b,s]}function QC(s,a){s.action=a}function sm(s){var a=At(),c=lt;if(c!==null)return nm(a,c,s);At(),a=a.memoizedState,c=At();var d=c.queue.dispatch;return c.memoizedState=s,[a,d,!1]}function Go(s,a,c,d){return s={tag:s,create:c,deps:d,inst:a,next:null},a=Pe.updateQueue,a===null&&(a=bc(),Pe.updateQueue=a),c=a.lastEffect,c===null?a.lastEffect=s.next=s:(d=c.next,c.next=s,s.next=d,a.lastEffect=s),s}function am(){return At().memoizedState}function Sc(s,a,c,d){var v=ln();Pe.flags|=s,v.memoizedState=Go(1|a,{destroy:void 0},c,d===void 0?null:d)}function Cc(s,a,c,d){var v=At();d=d===void 0?null:d;var b=v.memoizedState.inst;lt!==null&&d!==null&&md(d,lt.memoizedState.deps)?v.memoizedState=Go(a,b,c,d):(Pe.flags|=s,v.memoizedState=Go(1|a,b,c,d))}function om(s,a){Sc(8390656,8,s,a)}function Rd(s,a){Cc(2048,8,s,a)}function GC(s){Pe.flags|=4;var a=Pe.updateQueue;if(a===null)a=bc(),Pe.updateQueue=a,a.events=[s];else{var c=a.events;c===null?a.events=[s]:c.push(s)}}function rm(s){var a=At().memoizedState;return GC({ref:a,nextImpl:s}),function(){if((nt&2)!==0)throw Error(n(440));return a.impl.apply(void 0,arguments)}}function im(s,a){return Cc(4,2,s,a)}function cm(s,a){return Cc(4,4,s,a)}function lm(s,a){if(typeof a=="function"){s=s();var c=a(s);return function(){typeof c=="function"?c():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function um(s,a,c){c=c!=null?c.concat([s]):null,Cc(4,4,lm.bind(null,a,s),c)}function Td(){}function dm(s,a){var c=At();a=a===void 0?null:a;var d=c.memoizedState;return a!==null&&md(a,d[1])?d[0]:(c.memoizedState=[s,a],s)}function fm(s,a){var c=At();a=a===void 0?null:a;var d=c.memoizedState;if(a!==null&&md(a,d[1]))return d[0];if(d=s(),so){Ft(!0);try{s()}finally{Ft(!1)}}return c.memoizedState=[d,a],d}function Ad(s,a,c){return c===void 0||(Ps&1073741824)!==0&&(Fe&261930)===0?s.memoizedState=a:(s.memoizedState=c,s=hy(),Pe.lanes|=s,va|=s,c)}function hm(s,a,c,d){return xn(c,a)?c:$o.current!==null?(s=Ad(s,c,d),xn(s,a)||(Pt=!0),s):(Ps&42)===0||(Ps&1073741824)!==0&&(Fe&261930)===0?(Pt=!0,s.memoizedState=c):(s=hy(),Pe.lanes|=s,va|=s,a)}function pm(s,a,c,d,v){var b=j.p;j.p=b!==0&&8>b?b:8;var R=z.T,k={};z.T=k,Dd(s,!1,a,c);try{var L=v(),F=z.S;if(F!==null&&F(k,L),L!==null&&typeof L=="object"&&typeof L.then=="function"){var ne=HC(L,d);Xr(s,a,ne,Rn(s))}else Xr(s,a,d,Rn(s))}catch(ie){Xr(s,a,{then:function(){},status:"rejected",reason:ie},Rn())}finally{j.p=b,R!==null&&k.types!==null&&(R.types=k.types),z.T=R}}function FC(){}function Nd(s,a,c,d){if(s.tag!==5)throw Error(n(476));var v=gm(s).queue;pm(s,v,a,O,c===null?FC:function(){return mm(s),c(d)})}function gm(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:O,baseState:O,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:O},next:null};var c={};return a.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Is,lastRenderedState:c},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function mm(s){var a=gm(s);a.next===null&&(a=s.alternate.memoizedState),Xr(s,a.next.queue,{},Rn())}function kd(){return Jt(hi)}function ym(){return At().memoizedState}function vm(){return At().memoizedState}function VC(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var c=Rn();s=fa(c);var d=ha(a,s,c);d!==null&&(yn(d,a,c),Gr(d,a,c)),a={cache:od()},s.payload=a;return}a=a.return}}function KC(s,a,c){var d=Rn();c={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Mc(s)?xm(a,c):(c=Ku(s,a,c,d),c!==null&&(yn(c,s,d),wm(c,a,d)))}function bm(s,a,c){var d=Rn();Xr(s,a,c,d)}function Xr(s,a,c,d){var v={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Mc(s))xm(a,v);else{var b=s.alternate;if(s.lanes===0&&(b===null||b.lanes===0)&&(b=a.lastRenderedReducer,b!==null))try{var R=a.lastRenderedState,k=b(R,c);if(v.hasEagerState=!0,v.eagerState=k,xn(k,R))return ac(s,a,v,0),ft===null&&sc(),!1}catch{}finally{}if(c=Ku(s,a,v,d),c!==null)return yn(c,s,d),wm(c,a,d),!0}return!1}function Dd(s,a,c,d){if(d={lane:2,revertLane:uf(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},Mc(s)){if(a)throw Error(n(479))}else a=Ku(s,c,d,2),a!==null&&yn(a,s,2)}function Mc(s){var a=s.alternate;return s===Pe||a!==null&&a===Pe}function xm(s,a){Bo=yc=!0;var c=s.pending;c===null?a.next=a:(a.next=c.next,c.next=a),s.pending=a}function wm(s,a,c){if((c&4194048)!==0){var d=a.lanes;d&=s.pendingLanes,c|=d,a.lanes=c,ct(s,c)}}var Wr={readContext:Jt,use:xc,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useLayoutEffect:Ct,useInsertionEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useSyncExternalStore:Ct,useId:Ct,useHostTransitionStatus:Ct,useFormState:Ct,useActionState:Ct,useOptimistic:Ct,useMemoCache:Ct,useCacheRefresh:Ct};Wr.useEffectEvent=Ct;var Sm={readContext:Jt,use:xc,useCallback:function(s,a){return ln().memoizedState=[s,a===void 0?null:a],s},useContext:Jt,useEffect:om,useImperativeHandle:function(s,a,c){c=c!=null?c.concat([s]):null,Sc(4194308,4,lm.bind(null,a,s),c)},useLayoutEffect:function(s,a){return Sc(4194308,4,s,a)},useInsertionEffect:function(s,a){Sc(4,2,s,a)},useMemo:function(s,a){var c=ln();a=a===void 0?null:a;var d=s();if(so){Ft(!0);try{s()}finally{Ft(!1)}}return c.memoizedState=[d,a],d},useReducer:function(s,a,c){var d=ln();if(c!==void 0){var v=c(a);if(so){Ft(!0);try{c(a)}finally{Ft(!1)}}}else v=a;return d.memoizedState=d.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},d.queue=s,s=s.dispatch=KC.bind(null,Pe,s),[d.memoizedState,s]},useRef:function(s){var a=ln();return s={current:s},a.memoizedState=s},useState:function(s){s=Md(s);var a=s.queue,c=bm.bind(null,Pe,a);return a.dispatch=c,[s.memoizedState,c]},useDebugValue:Td,useDeferredValue:function(s,a){var c=ln();return Ad(c,s,a)},useTransition:function(){var s=Md(!1);return s=pm.bind(null,Pe,s.queue,!0,!1),ln().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,c){var d=Pe,v=ln();if(Xe){if(c===void 0)throw Error(n(407));c=c()}else{if(c=a(),ft===null)throw Error(n(349));(Fe&127)!==0||Bg(d,a,c)}v.memoizedState=c;var b={value:c,getSnapshot:a};return v.queue=b,om(Gg.bind(null,d,b,s),[s]),d.flags|=2048,Go(9,{destroy:void 0},Qg.bind(null,d,b,c,a),null),c},useId:function(){var s=ln(),a=ft.identifierPrefix;if(Xe){var c=ls,d=cs;c=(d&~(1<<32-_t(d)-1)).toString(32)+c,a="_"+a+"R_"+c,c=vc++,0<c&&(a+="H"+c.toString(32)),a+="_"}else c=UC++,a="_"+a+"r_"+c.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:kd,useFormState:em,useActionState:em,useOptimistic:function(s){var a=ln();a.memoizedState=a.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=c,a=Dd.bind(null,Pe,!0,c),c.dispatch=a,[s,a]},useMemoCache:wd,useCacheRefresh:function(){return ln().memoizedState=VC.bind(null,Pe)},useEffectEvent:function(s){var a=ln(),c={impl:s};return a.memoizedState=c,function(){if((nt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},jd={readContext:Jt,use:xc,useCallback:dm,useContext:Jt,useEffect:Rd,useImperativeHandle:um,useInsertionEffect:im,useLayoutEffect:cm,useMemo:fm,useReducer:wc,useRef:am,useState:function(){return wc(Is)},useDebugValue:Td,useDeferredValue:function(s,a){var c=At();return hm(c,lt.memoizedState,s,a)},useTransition:function(){var s=wc(Is)[0],a=At().memoizedState;return[typeof s=="boolean"?s:Yr(s),a]},useSyncExternalStore:$g,useId:ym,useHostTransitionStatus:kd,useFormState:tm,useActionState:tm,useOptimistic:function(s,a){var c=At();return Kg(c,lt,s,a)},useMemoCache:wd,useCacheRefresh:vm};jd.useEffectEvent=rm;var Cm={readContext:Jt,use:xc,useCallback:dm,useContext:Jt,useEffect:Rd,useImperativeHandle:um,useInsertionEffect:im,useLayoutEffect:cm,useMemo:fm,useReducer:Cd,useRef:am,useState:function(){return Cd(Is)},useDebugValue:Td,useDeferredValue:function(s,a){var c=At();return lt===null?Ad(c,s,a):hm(c,lt.memoizedState,s,a)},useTransition:function(){var s=Cd(Is)[0],a=At().memoizedState;return[typeof s=="boolean"?s:Yr(s),a]},useSyncExternalStore:$g,useId:ym,useHostTransitionStatus:kd,useFormState:sm,useActionState:sm,useOptimistic:function(s,a){var c=At();return lt!==null?Kg(c,lt,s,a):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:wd,useCacheRefresh:vm};Cm.useEffectEvent=rm;function _d(s,a,c,d){a=s.memoizedState,c=c(d,a),c=c==null?a:m({},a,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var zd={enqueueSetState:function(s,a,c){s=s._reactInternals;var d=Rn(),v=fa(d);v.payload=a,c!=null&&(v.callback=c),a=ha(s,v,d),a!==null&&(yn(a,s,d),Gr(a,s,d))},enqueueReplaceState:function(s,a,c){s=s._reactInternals;var d=Rn(),v=fa(d);v.tag=1,v.payload=a,c!=null&&(v.callback=c),a=ha(s,v,d),a!==null&&(yn(a,s,d),Gr(a,s,d))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var c=Rn(),d=fa(c);d.tag=2,a!=null&&(d.callback=a),a=ha(s,d,c),a!==null&&(yn(a,s,c),Gr(a,s,c))}};function Mm(s,a,c,d,v,b,R){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,b,R):a.prototype&&a.prototype.isPureReactComponent?!Pr(c,d)||!Pr(v,b):!0}function Em(s,a,c,d){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(c,d),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(c,d),a.state!==s&&zd.enqueueReplaceState(a,a.state,null)}function ao(s,a){var c=a;if("ref"in a){c={};for(var d in a)d!=="ref"&&(c[d]=a[d])}if(s=s.defaultProps){c===a&&(c=m({},c));for(var v in s)c[v]===void 0&&(c[v]=s[v])}return c}function Rm(s){nc(s)}function Tm(s){console.error(s)}function Am(s){nc(s)}function Ec(s,a){try{var c=s.onUncaughtError;c(a.value,{componentStack:a.stack})}catch(d){setTimeout(function(){throw d})}}function Nm(s,a,c){try{var d=s.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function Ld(s,a,c){return c=fa(c),c.tag=3,c.payload={element:null},c.callback=function(){Ec(s,a)},c}function km(s){return s=fa(s),s.tag=3,s}function Dm(s,a,c,d){var v=c.type.getDerivedStateFromError;if(typeof v=="function"){var b=d.value;s.payload=function(){return v(b)},s.callback=function(){Nm(a,c,d)}}var R=c.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(s.callback=function(){Nm(a,c,d),typeof v!="function"&&(ba===null?ba=new Set([this]):ba.add(this));var k=d.stack;this.componentDidCatch(d.value,{componentStack:k!==null?k:""})})}function YC(s,a,c,d,v){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(a=c.alternate,a!==null&&Po(a,c,v,!0),c=Sn.current,c!==null){switch(c.tag){case 31:case 13:return Hn===null?Pc():c.alternate===null&&Mt===0&&(Mt=3),c.flags&=-257,c.flags|=65536,c.lanes=v,d===fc?c.flags|=16384:(a=c.updateQueue,a===null?c.updateQueue=new Set([d]):a.add(d),rf(s,d,v)),!1;case 22:return c.flags|=65536,d===fc?c.flags|=16384:(a=c.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=a):(c=a.retryQueue,c===null?a.retryQueue=new Set([d]):c.add(d)),rf(s,d,v)),!1}throw Error(n(435,c.tag))}return rf(s,d,v),Pc(),!1}if(Xe)return a=Sn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=v,d!==ed&&(s=Error(n(422),{cause:d}),Hr(On(s,c)))):(d!==ed&&(a=Error(n(423),{cause:d}),Hr(On(a,c))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,d=On(d,c),v=Ld(s.stateNode,d,v),dd(s,v),Mt!==4&&(Mt=2)),!1;var b=Error(n(520),{cause:d});if(b=On(b,c),oi===null?oi=[b]:oi.push(b),Mt!==4&&(Mt=2),a===null)return!0;d=On(d,c),c=a;do{switch(c.tag){case 3:return c.flags|=65536,s=v&-v,c.lanes|=s,s=Ld(c.stateNode,d,s),dd(c,s),!1;case 1:if(a=c.type,b=c.stateNode,(c.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ba===null||!ba.has(b))))return c.flags|=65536,v&=-v,c.lanes|=v,v=km(v),Dm(v,s,c,d),dd(c,v),!1}c=c.return}while(c!==null);return!1}var Od=Error(n(461)),Pt=!1;function en(s,a,c,d){a.child=s===null?Lg(a,null,c,d):no(a,s.child,c,d)}function jm(s,a,c,d,v){c=c.render;var b=a.ref;if("ref"in d){var R={};for(var k in d)k!=="ref"&&(R[k]=d[k])}else R=d;return Za(a),d=yd(s,a,c,R,b,v),k=vd(),s!==null&&!Pt?(bd(s,a,v),qs(s,a,v)):(Xe&&k&&Zu(a),a.flags|=1,en(s,a,d,v),a.child)}function _m(s,a,c,d,v){if(s===null){var b=c.type;return typeof b=="function"&&!Yu(b)&&b.defaultProps===void 0&&c.compare===null?(a.tag=15,a.type=b,zm(s,a,b,d,v)):(s=rc(c.type,null,d,a,a.mode,v),s.ref=a.ref,s.return=a,a.child=s)}if(b=s.child,!Qd(s,v)){var R=b.memoizedProps;if(c=c.compare,c=c!==null?c:Pr,c(R,d)&&s.ref===a.ref)return qs(s,a,v)}return a.flags|=1,s=_s(b,d),s.ref=a.ref,s.return=a,a.child=s}function zm(s,a,c,d,v){if(s!==null){var b=s.memoizedProps;if(Pr(b,d)&&s.ref===a.ref)if(Pt=!1,a.pendingProps=d=b,Qd(s,v))(s.flags&131072)!==0&&(Pt=!0);else return a.lanes=s.lanes,qs(s,a,v)}return Pd(s,a,c,d,v)}function Lm(s,a,c,d){var v=d.children,b=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((a.flags&128)!==0){if(b=b!==null?b.baseLanes|c:c,s!==null){for(d=a.child=s.child,v=0;d!==null;)v=v|d.lanes|d.childLanes,d=d.sibling;d=v&~b}else d=0,a.child=null;return Om(s,a,b,c,d)}if((c&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&uc(a,b!==null?b.cachePool:null),b!==null?Ig(a,b):hd(),qg(a);else return d=a.lanes=536870912,Om(s,a,b!==null?b.baseLanes|c:c,c,d)}else b!==null?(uc(a,b.cachePool),Ig(a,b),ga(),a.memoizedState=null):(s!==null&&uc(a,null),hd(),ga());return en(s,a,v,c),a.child}function Zr(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Om(s,a,c,d,v){var b=id();return b=b===null?null:{parent:Lt._currentValue,pool:b},a.memoizedState={baseLanes:c,cachePool:b},s!==null&&uc(a,null),hd(),qg(a),s!==null&&Po(s,a,d,!0),a.childLanes=v,null}function Rc(s,a){return a=Ac({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function Pm(s,a,c){return no(a,s.child,null,c),s=Rc(a,a.pendingProps),s.flags|=2,Cn(a),a.memoizedState=null,s}function XC(s,a,c){var d=a.pendingProps,v=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(Xe){if(d.mode==="hidden")return s=Rc(a,d),a.lanes=536870912,Zr(null,s);if(gd(a),(s=bt)?(s=Yy(s,qn),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ia!==null?{id:cs,overflow:ls}:null,retryLane:536870912,hydrationErrors:null},c=xg(s),c.return=a,a.child=c,Zt=a,bt=null)):s=null,s===null)throw la(a);return a.lanes=536870912,null}return Rc(a,d)}var b=s.memoizedState;if(b!==null){var R=b.dehydrated;if(gd(a),v)if(a.flags&256)a.flags&=-257,a=Pm(s,a,c);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(n(558));else if(Pt||Po(s,a,c,!1),v=(c&s.childLanes)!==0,Pt||v){if(d=ft,d!==null&&(R=zt(d,c),R!==0&&R!==b.retryLane))throw b.retryLane=R,Ka(s,R),yn(d,s,R),Od;Pc(),a=Pm(s,a,c)}else s=b.treeContext,bt=Un(R.nextSibling),Zt=a,Xe=!0,ca=null,qn=!1,s!==null&&Cg(a,s),a=Rc(a,d),a.flags|=4096;return a}return s=_s(s.child,{mode:d.mode,children:d.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Tc(s,a){var c=a.ref;if(c===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(s===null||s.ref!==c)&&(a.flags|=4194816)}}function Pd(s,a,c,d,v){return Za(a),c=yd(s,a,c,d,void 0,v),d=vd(),s!==null&&!Pt?(bd(s,a,v),qs(s,a,v)):(Xe&&d&&Zu(a),a.flags|=1,en(s,a,c,v),a.child)}function Im(s,a,c,d,v,b){return Za(a),a.updateQueue=null,c=Ug(a,d,c,v),Hg(s),d=vd(),s!==null&&!Pt?(bd(s,a,b),qs(s,a,b)):(Xe&&d&&Zu(a),a.flags|=1,en(s,a,c,b),a.child)}function qm(s,a,c,d,v){if(Za(a),a.stateNode===null){var b=_o,R=c.contextType;typeof R=="object"&&R!==null&&(b=Jt(R)),b=new c(d,b),a.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=zd,a.stateNode=b,b._reactInternals=a,b=a.stateNode,b.props=d,b.state=a.memoizedState,b.refs={},ld(a),R=c.contextType,b.context=typeof R=="object"&&R!==null?Jt(R):_o,b.state=a.memoizedState,R=c.getDerivedStateFromProps,typeof R=="function"&&(_d(a,c,R,d),b.state=a.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(R=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),R!==b.state&&zd.enqueueReplaceState(b,b.state,null),Vr(a,d,b,v),Fr(),b.state=a.memoizedState),typeof b.componentDidMount=="function"&&(a.flags|=4194308),d=!0}else if(s===null){b=a.stateNode;var k=a.memoizedProps,L=ao(c,k);b.props=L;var F=b.context,ne=c.contextType;R=_o,typeof ne=="object"&&ne!==null&&(R=Jt(ne));var ie=c.getDerivedStateFromProps;ne=typeof ie=="function"||typeof b.getSnapshotBeforeUpdate=="function",k=a.pendingProps!==k,ne||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(k||F!==R)&&Em(a,b,d,R),da=!1;var K=a.memoizedState;b.state=K,Vr(a,d,b,v),Fr(),F=a.memoizedState,k||K!==F||da?(typeof ie=="function"&&(_d(a,c,ie,d),F=a.memoizedState),(L=da||Mm(a,c,L,d,K,F,R))?(ne||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(a.flags|=4194308)):(typeof b.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=d,a.memoizedState=F),b.props=d,b.state=F,b.context=R,d=L):(typeof b.componentDidMount=="function"&&(a.flags|=4194308),d=!1)}else{b=a.stateNode,ud(s,a),R=a.memoizedProps,ne=ao(c,R),b.props=ne,ie=a.pendingProps,K=b.context,F=c.contextType,L=_o,typeof F=="object"&&F!==null&&(L=Jt(F)),k=c.getDerivedStateFromProps,(F=typeof k=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(R!==ie||K!==L)&&Em(a,b,d,L),da=!1,K=a.memoizedState,b.state=K,Vr(a,d,b,v),Fr();var W=a.memoizedState;R!==ie||K!==W||da||s!==null&&s.dependencies!==null&&cc(s.dependencies)?(typeof k=="function"&&(_d(a,c,k,d),W=a.memoizedState),(ne=da||Mm(a,c,ne,d,K,W,L)||s!==null&&s.dependencies!==null&&cc(s.dependencies))?(F||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(d,W,L),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(d,W,L)),typeof b.componentDidUpdate=="function"&&(a.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof b.componentDidUpdate!="function"||R===s.memoizedProps&&K===s.memoizedState||(a.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&K===s.memoizedState||(a.flags|=1024),a.memoizedProps=d,a.memoizedState=W),b.props=d,b.state=W,b.context=L,d=ne):(typeof b.componentDidUpdate!="function"||R===s.memoizedProps&&K===s.memoizedState||(a.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&K===s.memoizedState||(a.flags|=1024),d=!1)}return b=d,Tc(s,a),d=(a.flags&128)!==0,b||d?(b=a.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:b.render(),a.flags|=1,s!==null&&d?(a.child=no(a,s.child,null,v),a.child=no(a,null,c,v)):en(s,a,c,v),a.memoizedState=b.state,s=a.child):s=qs(s,a,v),s}function Hm(s,a,c,d){return Xa(),a.flags|=256,en(s,a,c,d),a.child}var Id={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function qd(s){return{baseLanes:s,cachePool:Ng()}}function Hd(s,a,c){return s=s!==null?s.childLanes&~c:0,a&&(s|=En),s}function Um(s,a,c){var d=a.pendingProps,v=!1,b=(a.flags&128)!==0,R;if((R=b)||(R=s!==null&&s.memoizedState===null?!1:(Tt.current&2)!==0),R&&(v=!0,a.flags&=-129),R=(a.flags&32)!==0,a.flags&=-33,s===null){if(Xe){if(v?pa(a):ga(),(s=bt)?(s=Yy(s,qn),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:ia!==null?{id:cs,overflow:ls}:null,retryLane:536870912,hydrationErrors:null},c=xg(s),c.return=a,a.child=c,Zt=a,bt=null)):s=null,s===null)throw la(a);return Cf(s)?a.lanes=32:a.lanes=536870912,null}var k=d.children;return d=d.fallback,v?(ga(),v=a.mode,k=Ac({mode:"hidden",children:k},v),d=Ya(d,v,c,null),k.return=a,d.return=a,k.sibling=d,a.child=k,d=a.child,d.memoizedState=qd(c),d.childLanes=Hd(s,R,c),a.memoizedState=Id,Zr(null,d)):(pa(a),Ud(a,k))}var L=s.memoizedState;if(L!==null&&(k=L.dehydrated,k!==null)){if(b)a.flags&256?(pa(a),a.flags&=-257,a=$d(s,a,c)):a.memoizedState!==null?(ga(),a.child=s.child,a.flags|=128,a=null):(ga(),k=d.fallback,v=a.mode,d=Ac({mode:"visible",children:d.children},v),k=Ya(k,v,c,null),k.flags|=2,d.return=a,k.return=a,d.sibling=k,a.child=d,no(a,s.child,null,c),d=a.child,d.memoizedState=qd(c),d.childLanes=Hd(s,R,c),a.memoizedState=Id,a=Zr(null,d));else if(pa(a),Cf(k)){if(R=k.nextSibling&&k.nextSibling.dataset,R)var F=R.dgst;R=F,d=Error(n(419)),d.stack="",d.digest=R,Hr({value:d,source:null,stack:null}),a=$d(s,a,c)}else if(Pt||Po(s,a,c,!1),R=(c&s.childLanes)!==0,Pt||R){if(R=ft,R!==null&&(d=zt(R,c),d!==0&&d!==L.retryLane))throw L.retryLane=d,Ka(s,d),yn(R,s,d),Od;Sf(k)||Pc(),a=$d(s,a,c)}else Sf(k)?(a.flags|=192,a.child=s.child,a=null):(s=L.treeContext,bt=Un(k.nextSibling),Zt=a,Xe=!0,ca=null,qn=!1,s!==null&&Cg(a,s),a=Ud(a,d.children),a.flags|=4096);return a}return v?(ga(),k=d.fallback,v=a.mode,L=s.child,F=L.sibling,d=_s(L,{mode:"hidden",children:d.children}),d.subtreeFlags=L.subtreeFlags&65011712,F!==null?k=_s(F,k):(k=Ya(k,v,c,null),k.flags|=2),k.return=a,d.return=a,d.sibling=k,a.child=d,Zr(null,d),d=a.child,k=s.child.memoizedState,k===null?k=qd(c):(v=k.cachePool,v!==null?(L=Lt._currentValue,v=v.parent!==L?{parent:L,pool:L}:v):v=Ng(),k={baseLanes:k.baseLanes|c,cachePool:v}),d.memoizedState=k,d.childLanes=Hd(s,R,c),a.memoizedState=Id,Zr(s.child,d)):(pa(a),c=s.child,s=c.sibling,c=_s(c,{mode:"visible",children:d.children}),c.return=a,c.sibling=null,s!==null&&(R=a.deletions,R===null?(a.deletions=[s],a.flags|=16):R.push(s)),a.child=c,a.memoizedState=null,c)}function Ud(s,a){return a=Ac({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Ac(s,a){return s=wn(22,s,null,a),s.lanes=0,s}function $d(s,a,c){return no(a,s.child,null,c),s=Ud(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function $m(s,a,c){s.lanes|=a;var d=s.alternate;d!==null&&(d.lanes|=a),sd(s.return,a,c)}function Bd(s,a,c,d,v,b){var R=s.memoizedState;R===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:v,treeForkCount:b}:(R.isBackwards=a,R.rendering=null,R.renderingStartTime=0,R.last=d,R.tail=c,R.tailMode=v,R.treeForkCount=b)}function Bm(s,a,c){var d=a.pendingProps,v=d.revealOrder,b=d.tail;d=d.children;var R=Tt.current,k=(R&2)!==0;if(k?(R=R&1|2,a.flags|=128):R&=1,Y(Tt,R),en(s,a,d,c),d=Xe?qr:0,!k&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&$m(s,c,a);else if(s.tag===19)$m(s,c,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(c=a.child,v=null;c!==null;)s=c.alternate,s!==null&&mc(s)===null&&(v=c),c=c.sibling;c=v,c===null?(v=a.child,a.child=null):(v=c.sibling,c.sibling=null),Bd(a,!1,v,c,b,d);break;case"backwards":case"unstable_legacy-backwards":for(c=null,v=a.child,a.child=null;v!==null;){if(s=v.alternate,s!==null&&mc(s)===null){a.child=v;break}s=v.sibling,v.sibling=c,c=v,v=s}Bd(a,!0,c,null,b,d);break;case"together":Bd(a,!1,null,null,void 0,d);break;default:a.memoizedState=null}return a.child}function qs(s,a,c){if(s!==null&&(a.dependencies=s.dependencies),va|=a.lanes,(c&a.childLanes)===0)if(s!==null){if(Po(s,a,c,!1),(c&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(n(153));if(a.child!==null){for(s=a.child,c=_s(s,s.pendingProps),a.child=c,c.return=a;s.sibling!==null;)s=s.sibling,c=c.sibling=_s(s,s.pendingProps),c.return=a;c.sibling=null}return a.child}function Qd(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&cc(s)))}function WC(s,a,c){switch(a.tag){case 3:V(a,a.stateNode.containerInfo),ua(a,Lt,s.memoizedState.cache),Xa();break;case 27:case 5:me(a);break;case 4:V(a,a.stateNode.containerInfo);break;case 10:ua(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,gd(a),null;break;case 13:var d=a.memoizedState;if(d!==null)return d.dehydrated!==null?(pa(a),a.flags|=128,null):(c&a.child.childLanes)!==0?Um(s,a,c):(pa(a),s=qs(s,a,c),s!==null?s.sibling:null);pa(a);break;case 19:var v=(s.flags&128)!==0;if(d=(c&a.childLanes)!==0,d||(Po(s,a,c,!1),d=(c&a.childLanes)!==0),v){if(d)return Bm(s,a,c);a.flags|=128}if(v=a.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Y(Tt,Tt.current),d)break;return null;case 22:return a.lanes=0,Lm(s,a,c,a.pendingProps);case 24:ua(a,Lt,s.memoizedState.cache)}return qs(s,a,c)}function Qm(s,a,c){if(s!==null)if(s.memoizedProps!==a.pendingProps)Pt=!0;else{if(!Qd(s,c)&&(a.flags&128)===0)return Pt=!1,WC(s,a,c);Pt=(s.flags&131072)!==0}else Pt=!1,Xe&&(a.flags&1048576)!==0&&Sg(a,qr,a.index);switch(a.lanes=0,a.tag){case 16:e:{var d=a.pendingProps;if(s=eo(a.elementType),a.type=s,typeof s=="function")Yu(s)?(d=ao(s,d),a.tag=1,a=qm(null,a,s,d,c)):(a.tag=0,a=Pd(null,a,s,d,c));else{if(s!=null){var v=s.$$typeof;if(v===N){a.tag=11,a=jm(null,a,s,d,c);break e}else if(v===P){a.tag=14,a=_m(null,a,s,d,c);break e}}throw a=le(s)||s,Error(n(306,a,""))}}return a;case 0:return Pd(s,a,a.type,a.pendingProps,c);case 1:return d=a.type,v=ao(d,a.pendingProps),qm(s,a,d,v,c);case 3:e:{if(V(a,a.stateNode.containerInfo),s===null)throw Error(n(387));d=a.pendingProps;var b=a.memoizedState;v=b.element,ud(s,a),Vr(a,d,null,c);var R=a.memoizedState;if(d=R.cache,ua(a,Lt,d),d!==b.cache&&ad(a,[Lt],c,!0),Fr(),d=R.element,b.isDehydrated)if(b={element:d,isDehydrated:!1,cache:R.cache},a.updateQueue.baseState=b,a.memoizedState=b,a.flags&256){a=Hm(s,a,d,c);break e}else if(d!==v){v=On(Error(n(424)),a),Hr(v),a=Hm(s,a,d,c);break e}else{switch(s=a.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(bt=Un(s.firstChild),Zt=a,Xe=!0,ca=null,qn=!0,c=Lg(a,null,d,c),a.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(Xa(),d===v){a=qs(s,a,c);break e}en(s,a,d,c)}a=a.child}return a;case 26:return Tc(s,a),s===null?(c=t0(a.type,null,a.pendingProps,null))?a.memoizedState=c:Xe||(c=a.type,s=a.pendingProps,d=Qc(oe.current).createElement(c),d[mt]=a,d[Ht]=s,tn(d,c,s),Vt(d),a.stateNode=d):a.memoizedState=t0(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return me(a),s===null&&Xe&&(d=a.stateNode=Zy(a.type,a.pendingProps,oe.current),Zt=a,qn=!0,v=bt,Ca(a.type)?(Mf=v,bt=Un(d.firstChild)):bt=v),en(s,a,a.pendingProps.children,c),Tc(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&Xe&&((v=d=bt)&&(d=TM(d,a.type,a.pendingProps,qn),d!==null?(a.stateNode=d,Zt=a,bt=Un(d.firstChild),qn=!1,v=!0):v=!1),v||la(a)),me(a),v=a.type,b=a.pendingProps,R=s!==null?s.memoizedProps:null,d=b.children,bf(v,b)?d=null:R!==null&&bf(v,R)&&(a.flags|=32),a.memoizedState!==null&&(v=yd(s,a,$C,null,null,c),hi._currentValue=v),Tc(s,a),en(s,a,d,c),a.child;case 6:return s===null&&Xe&&((s=c=bt)&&(c=AM(c,a.pendingProps,qn),c!==null?(a.stateNode=c,Zt=a,bt=null,s=!0):s=!1),s||la(a)),null;case 13:return Um(s,a,c);case 4:return V(a,a.stateNode.containerInfo),d=a.pendingProps,s===null?a.child=no(a,null,d,c):en(s,a,d,c),a.child;case 11:return jm(s,a,a.type,a.pendingProps,c);case 7:return en(s,a,a.pendingProps,c),a.child;case 8:return en(s,a,a.pendingProps.children,c),a.child;case 12:return en(s,a,a.pendingProps.children,c),a.child;case 10:return d=a.pendingProps,ua(a,a.type,d.value),en(s,a,d.children,c),a.child;case 9:return v=a.type._context,d=a.pendingProps.children,Za(a),v=Jt(v),d=d(v),a.flags|=1,en(s,a,d,c),a.child;case 14:return _m(s,a,a.type,a.pendingProps,c);case 15:return zm(s,a,a.type,a.pendingProps,c);case 19:return Bm(s,a,c);case 31:return XC(s,a,c);case 22:return Lm(s,a,c,a.pendingProps);case 24:return Za(a),d=Jt(Lt),s===null?(v=id(),v===null&&(v=ft,b=od(),v.pooledCache=b,b.refCount++,b!==null&&(v.pooledCacheLanes|=c),v=b),a.memoizedState={parent:d,cache:v},ld(a),ua(a,Lt,v)):((s.lanes&c)!==0&&(ud(s,a),Vr(a,null,null,c),Fr()),v=s.memoizedState,b=a.memoizedState,v.parent!==d?(v={parent:d,cache:d},a.memoizedState=v,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=v),ua(a,Lt,d)):(d=b.cache,ua(a,Lt,d),d!==v.cache&&ad(a,[Lt],c,!0))),en(s,a,a.pendingProps.children,c),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function Hs(s){s.flags|=4}function Gd(s,a,c,d,v){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(yy())s.flags|=8192;else throw to=fc,cd}else s.flags&=-16777217}function Gm(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!r0(a))if(yy())s.flags|=8192;else throw to=fc,cd}function Nc(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?ee():536870912,s.lanes|=a,Yo|=a)}function Jr(s,a){if(!Xe)switch(s.tailMode){case"hidden":a=s.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function xt(s){var a=s.alternate!==null&&s.alternate.child===s.child,c=0,d=0;if(a)for(var v=s.child;v!==null;)c|=v.lanes|v.childLanes,d|=v.subtreeFlags&65011712,d|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)c|=v.lanes|v.childLanes,d|=v.subtreeFlags,d|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=d,s.childLanes=c,a}function ZC(s,a,c){var d=a.pendingProps;switch(Ju(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(a),null;case 1:return xt(a),null;case 3:return c=a.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),a.memoizedState.cache!==d&&(a.flags|=2048),Os(Lt),pe(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(Oo(a)?Hs(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,td())),xt(a),null;case 26:var v=a.type,b=a.memoizedState;return s===null?(Hs(a),b!==null?(xt(a),Gm(a,b)):(xt(a),Gd(a,v,null,d,c))):b?b!==s.memoizedState?(Hs(a),xt(a),Gm(a,b)):(xt(a),a.flags&=-16777217):(s=s.memoizedProps,s!==d&&Hs(a),xt(a),Gd(a,v,s,d,c)),null;case 27:if(ye(a),c=oe.current,v=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==d&&Hs(a);else{if(!d){if(a.stateNode===null)throw Error(n(166));return xt(a),null}s=ae.current,Oo(a)?Mg(a):(s=Zy(v,d,c),a.stateNode=s,Hs(a))}return xt(a),null;case 5:if(ye(a),v=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==d&&Hs(a);else{if(!d){if(a.stateNode===null)throw Error(n(166));return xt(a),null}if(b=ae.current,Oo(a))Mg(a);else{var R=Qc(oe.current);switch(b){case 1:b=R.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:b=R.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":b=R.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":b=R.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":b=R.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof d.is=="string"?R.createElement("select",{is:d.is}):R.createElement("select"),d.multiple?b.multiple=!0:d.size&&(b.size=d.size);break;default:b=typeof d.is=="string"?R.createElement(v,{is:d.is}):R.createElement(v)}}b[mt]=a,b[Ht]=d;e:for(R=a.child;R!==null;){if(R.tag===5||R.tag===6)b.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===a)break e;for(;R.sibling===null;){if(R.return===null||R.return===a)break e;R=R.return}R.sibling.return=R.return,R=R.sibling}a.stateNode=b;e:switch(tn(b,v,d),v){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&Hs(a)}}return xt(a),Gd(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,c),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==d&&Hs(a);else{if(typeof d!="string"&&a.stateNode===null)throw Error(n(166));if(s=oe.current,Oo(a)){if(s=a.stateNode,c=a.memoizedProps,d=null,v=Zt,v!==null)switch(v.tag){case 27:case 5:d=v.memoizedProps}s[mt]=a,s=!!(s.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||Uy(s.nodeValue,c)),s||la(a,!0)}else s=Qc(s).createTextNode(d),s[mt]=a,a.stateNode=s}return xt(a),null;case 31:if(c=a.memoizedState,s===null||s.memoizedState!==null){if(d=Oo(a),c!==null){if(s===null){if(!d)throw Error(n(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[mt]=a}else Xa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;xt(a),s=!1}else c=td(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return a.flags&256?(Cn(a),a):(Cn(a),null);if((a.flags&128)!==0)throw Error(n(558))}return xt(a),null;case 13:if(d=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=Oo(a),d!==null&&d.dehydrated!==null){if(s===null){if(!v)throw Error(n(318));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[mt]=a}else Xa(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;xt(a),v=!1}else v=td(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return a.flags&256?(Cn(a),a):(Cn(a),null)}return Cn(a),(a.flags&128)!==0?(a.lanes=c,a):(c=d!==null,s=s!==null&&s.memoizedState!==null,c&&(d=a.child,v=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(v=d.alternate.memoizedState.cachePool.pool),b=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(b=d.memoizedState.cachePool.pool),b!==v&&(d.flags|=2048)),c!==s&&c&&(a.child.flags|=8192),Nc(a,a.updateQueue),xt(a),null);case 4:return pe(),s===null&&pf(a.stateNode.containerInfo),xt(a),null;case 10:return Os(a.type),xt(a),null;case 19:if(Q(Tt),d=a.memoizedState,d===null)return xt(a),null;if(v=(a.flags&128)!==0,b=d.rendering,b===null)if(v)Jr(d,!1);else{if(Mt!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(b=mc(s),b!==null){for(a.flags|=128,Jr(d,!1),s=b.updateQueue,a.updateQueue=s,Nc(a,s),a.subtreeFlags=0,s=c,c=a.child;c!==null;)bg(c,s),c=c.sibling;return Y(Tt,Tt.current&1|2),Xe&&zs(a,d.treeForkCount),a.child}s=s.sibling}d.tail!==null&&Je()>zc&&(a.flags|=128,v=!0,Jr(d,!1),a.lanes=4194304)}else{if(!v)if(s=mc(b),s!==null){if(a.flags|=128,v=!0,s=s.updateQueue,a.updateQueue=s,Nc(a,s),Jr(d,!0),d.tail===null&&d.tailMode==="hidden"&&!b.alternate&&!Xe)return xt(a),null}else 2*Je()-d.renderingStartTime>zc&&c!==536870912&&(a.flags|=128,v=!0,Jr(d,!1),a.lanes=4194304);d.isBackwards?(b.sibling=a.child,a.child=b):(s=d.last,s!==null?s.sibling=b:a.child=b,d.last=b)}return d.tail!==null?(s=d.tail,d.rendering=s,d.tail=s.sibling,d.renderingStartTime=Je(),s.sibling=null,c=Tt.current,Y(Tt,v?c&1|2:c&1),Xe&&zs(a,d.treeForkCount),s):(xt(a),null);case 22:case 23:return Cn(a),pd(),d=a.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(a.flags|=8192):d&&(a.flags|=8192),d?(c&536870912)!==0&&(a.flags&128)===0&&(xt(a),a.subtreeFlags&6&&(a.flags|=8192)):xt(a),c=a.updateQueue,c!==null&&Nc(a,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),d=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(d=a.memoizedState.cachePool.pool),d!==c&&(a.flags|=2048),s!==null&&Q(Ja),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),Os(Lt),xt(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function JC(s,a){switch(Ju(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return Os(Lt),pe(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return ye(a),null;case 31:if(a.memoizedState!==null){if(Cn(a),a.alternate===null)throw Error(n(340));Xa()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(Cn(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(n(340));Xa()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return Q(Tt),null;case 4:return pe(),null;case 10:return Os(a.type),null;case 22:case 23:return Cn(a),pd(),s!==null&&Q(Ja),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return Os(Lt),null;case 25:return null;default:return null}}function Fm(s,a){switch(Ju(a),a.tag){case 3:Os(Lt),pe();break;case 26:case 27:case 5:ye(a);break;case 4:pe();break;case 31:a.memoizedState!==null&&Cn(a);break;case 13:Cn(a);break;case 19:Q(Tt);break;case 10:Os(a.type);break;case 22:case 23:Cn(a),pd(),s!==null&&Q(Ja);break;case 24:Os(Lt)}}function ei(s,a){try{var c=a.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var v=d.next;c=v;do{if((c.tag&s)===s){d=void 0;var b=c.create,R=c.inst;d=b(),R.destroy=d}c=c.next}while(c!==v)}}catch(k){it(a,a.return,k)}}function ma(s,a,c){try{var d=a.updateQueue,v=d!==null?d.lastEffect:null;if(v!==null){var b=v.next;d=b;do{if((d.tag&s)===s){var R=d.inst,k=R.destroy;if(k!==void 0){R.destroy=void 0,v=a;var L=c,F=k;try{F()}catch(ne){it(v,L,ne)}}}d=d.next}while(d!==b)}}catch(ne){it(a,a.return,ne)}}function Vm(s){var a=s.updateQueue;if(a!==null){var c=s.stateNode;try{Pg(a,c)}catch(d){it(s,s.return,d)}}}function Km(s,a,c){c.props=ao(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(d){it(s,a,d)}}function ti(s,a){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof c=="function"?s.refCleanup=c(d):c.current=d}}catch(v){it(s,a,v)}}function us(s,a){var c=s.ref,d=s.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(v){it(s,a,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(v){it(s,a,v)}else c.current=null}function Ym(s){var a=s.type,c=s.memoizedProps,d=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(v){it(s,s.return,v)}}function Fd(s,a,c){try{var d=s.stateNode;wM(d,s.type,c,a),d[Ht]=a}catch(v){it(s,s.return,v)}}function Xm(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Ca(s.type)||s.tag===4}function Vd(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Xm(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Ca(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Kd(s,a,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,a?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,a):(a=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,a.appendChild(s),c=c._reactRootContainer,c!=null||a.onclick!==null||(a.onclick=Ds));else if(d!==4&&(d===27&&Ca(s.type)&&(c=s.stateNode,a=null),s=s.child,s!==null))for(Kd(s,a,c),s=s.sibling;s!==null;)Kd(s,a,c),s=s.sibling}function kc(s,a,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,a?c.insertBefore(s,a):c.appendChild(s);else if(d!==4&&(d===27&&Ca(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(kc(s,a,c),s=s.sibling;s!==null;)kc(s,a,c),s=s.sibling}function Wm(s){var a=s.stateNode,c=s.memoizedProps;try{for(var d=s.type,v=a.attributes;v.length;)a.removeAttributeNode(v[0]);tn(a,d,c),a[mt]=s,a[Ht]=c}catch(b){it(s,s.return,b)}}var Us=!1,It=!1,Yd=!1,Zm=typeof WeakSet=="function"?WeakSet:Set,Kt=null;function eM(s,a){if(s=s.containerInfo,yf=Wc,s=ug(s),$u(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var v=d.anchorOffset,b=d.focusNode;d=d.focusOffset;try{c.nodeType,b.nodeType}catch{c=null;break e}var R=0,k=-1,L=-1,F=0,ne=0,ie=s,K=null;t:for(;;){for(var W;ie!==c||v!==0&&ie.nodeType!==3||(k=R+v),ie!==b||d!==0&&ie.nodeType!==3||(L=R+d),ie.nodeType===3&&(R+=ie.nodeValue.length),(W=ie.firstChild)!==null;)K=ie,ie=W;for(;;){if(ie===s)break t;if(K===c&&++F===v&&(k=R),K===b&&++ne===d&&(L=R),(W=ie.nextSibling)!==null)break;ie=K,K=ie.parentNode}ie=W}c=k===-1||L===-1?null:{start:k,end:L}}else c=null}c=c||{start:0,end:0}}else c=null;for(vf={focusedElem:s,selectionRange:c},Wc=!1,Kt=a;Kt!==null;)if(a=Kt,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,Kt=s;else for(;Kt!==null;){switch(a=Kt,b=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)v=s[c],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&b!==null){s=void 0,c=a,v=b.memoizedProps,b=b.memoizedState,d=c.stateNode;try{var xe=ao(c.type,v);s=d.getSnapshotBeforeUpdate(xe,b),d.__reactInternalSnapshotBeforeUpdate=s}catch(ke){it(c,c.return,ke)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,c=s.nodeType,c===9)wf(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":wf(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=a.sibling,s!==null){s.return=a.return,Kt=s;break}Kt=a.return}}function Jm(s,a,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:Bs(s,c),d&4&&ei(5,c);break;case 1:if(Bs(s,c),d&4)if(s=c.stateNode,a===null)try{s.componentDidMount()}catch(R){it(c,c.return,R)}else{var v=ao(c.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(v,a,s.__reactInternalSnapshotBeforeUpdate)}catch(R){it(c,c.return,R)}}d&64&&Vm(c),d&512&&ti(c,c.return);break;case 3:if(Bs(s,c),d&64&&(s=c.updateQueue,s!==null)){if(a=null,c.child!==null)switch(c.child.tag){case 27:case 5:a=c.child.stateNode;break;case 1:a=c.child.stateNode}try{Pg(s,a)}catch(R){it(c,c.return,R)}}break;case 27:a===null&&d&4&&Wm(c);case 26:case 5:Bs(s,c),a===null&&d&4&&Ym(c),d&512&&ti(c,c.return);break;case 12:Bs(s,c);break;case 31:Bs(s,c),d&4&&ny(s,c);break;case 13:Bs(s,c),d&4&&sy(s,c),d&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=lM.bind(null,c),NM(s,c))));break;case 22:if(d=c.memoizedState!==null||Us,!d){a=a!==null&&a.memoizedState!==null||It,v=Us;var b=It;Us=d,(It=a)&&!b?Qs(s,c,(c.subtreeFlags&8772)!==0):Bs(s,c),Us=v,It=b}break;case 30:break;default:Bs(s,c)}}function ey(s){var a=s.alternate;a!==null&&(s.alternate=null,ey(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&Eu(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var St=null,hn=!1;function $s(s,a,c){for(c=c.child;c!==null;)ty(s,a,c),c=c.sibling}function ty(s,a,c){if(Xt&&typeof Xt.onCommitFiberUnmount=="function")try{Xt.onCommitFiberUnmount(rs,c)}catch{}switch(c.tag){case 26:It||us(c,a),$s(s,a,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:It||us(c,a);var d=St,v=hn;Ca(c.type)&&(St=c.stateNode,hn=!1),$s(s,a,c),ui(c.stateNode),St=d,hn=v;break;case 5:It||us(c,a);case 6:if(d=St,v=hn,St=null,$s(s,a,c),St=d,hn=v,St!==null)if(hn)try{(St.nodeType===9?St.body:St.nodeName==="HTML"?St.ownerDocument.body:St).removeChild(c.stateNode)}catch(b){it(c,a,b)}else try{St.removeChild(c.stateNode)}catch(b){it(c,a,b)}break;case 18:St!==null&&(hn?(s=St,Vy(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),sr(s)):Vy(St,c.stateNode));break;case 4:d=St,v=hn,St=c.stateNode.containerInfo,hn=!0,$s(s,a,c),St=d,hn=v;break;case 0:case 11:case 14:case 15:ma(2,c,a),It||ma(4,c,a),$s(s,a,c);break;case 1:It||(us(c,a),d=c.stateNode,typeof d.componentWillUnmount=="function"&&Km(c,a,d)),$s(s,a,c);break;case 21:$s(s,a,c);break;case 22:It=(d=It)||c.memoizedState!==null,$s(s,a,c),It=d;break;default:$s(s,a,c)}}function ny(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{sr(s)}catch(c){it(a,a.return,c)}}}function sy(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{sr(s)}catch(c){it(a,a.return,c)}}function tM(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new Zm),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new Zm),a;default:throw Error(n(435,s.tag))}}function Dc(s,a){var c=tM(s);a.forEach(function(d){if(!c.has(d)){c.add(d);var v=uM.bind(null,s,d);d.then(v,v)}})}function pn(s,a){var c=a.deletions;if(c!==null)for(var d=0;d<c.length;d++){var v=c[d],b=s,R=a,k=R;e:for(;k!==null;){switch(k.tag){case 27:if(Ca(k.type)){St=k.stateNode,hn=!1;break e}break;case 5:St=k.stateNode,hn=!1;break e;case 3:case 4:St=k.stateNode.containerInfo,hn=!0;break e}k=k.return}if(St===null)throw Error(n(160));ty(b,R,v),St=null,hn=!1,b=v.alternate,b!==null&&(b.return=null),v.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)ay(a,s),a=a.sibling}var Zn=null;function ay(s,a){var c=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:pn(a,s),gn(s),d&4&&(ma(3,s,s.return),ei(3,s),ma(5,s,s.return));break;case 1:pn(a,s),gn(s),d&512&&(It||c===null||us(c,c.return)),d&64&&Us&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var v=Zn;if(pn(a,s),gn(s),d&512&&(It||c===null||us(c,c.return)),d&4){var b=c!==null?c.memoizedState:null;if(d=s.memoizedState,c===null)if(d===null)if(s.stateNode===null){e:{d=s.type,c=s.memoizedProps,v=v.ownerDocument||v;t:switch(d){case"title":b=v.getElementsByTagName("title")[0],(!b||b[Ar]||b[mt]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=v.createElement(d),v.head.insertBefore(b,v.querySelector("head > title"))),tn(b,d,c),b[mt]=s,Vt(b),d=b;break e;case"link":var R=a0("link","href",v).get(d+(c.href||""));if(R){for(var k=0;k<R.length;k++)if(b=R[k],b.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&b.getAttribute("rel")===(c.rel==null?null:c.rel)&&b.getAttribute("title")===(c.title==null?null:c.title)&&b.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){R.splice(k,1);break t}}b=v.createElement(d),tn(b,d,c),v.head.appendChild(b);break;case"meta":if(R=a0("meta","content",v).get(d+(c.content||""))){for(k=0;k<R.length;k++)if(b=R[k],b.getAttribute("content")===(c.content==null?null:""+c.content)&&b.getAttribute("name")===(c.name==null?null:c.name)&&b.getAttribute("property")===(c.property==null?null:c.property)&&b.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&b.getAttribute("charset")===(c.charSet==null?null:c.charSet)){R.splice(k,1);break t}}b=v.createElement(d),tn(b,d,c),v.head.appendChild(b);break;default:throw Error(n(468,d))}b[mt]=s,Vt(b),d=b}s.stateNode=d}else o0(v,s.type,s.stateNode);else s.stateNode=s0(v,d,s.memoizedProps);else b!==d?(b===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):b.count--,d===null?o0(v,s.type,s.stateNode):s0(v,d,s.memoizedProps)):d===null&&s.stateNode!==null&&Fd(s,s.memoizedProps,c.memoizedProps)}break;case 27:pn(a,s),gn(s),d&512&&(It||c===null||us(c,c.return)),c!==null&&d&4&&Fd(s,s.memoizedProps,c.memoizedProps);break;case 5:if(pn(a,s),gn(s),d&512&&(It||c===null||us(c,c.return)),s.flags&32){v=s.stateNode;try{Ro(v,"")}catch(xe){it(s,s.return,xe)}}d&4&&s.stateNode!=null&&(v=s.memoizedProps,Fd(s,v,c!==null?c.memoizedProps:v)),d&1024&&(Yd=!0);break;case 6:if(pn(a,s),gn(s),d&4){if(s.stateNode===null)throw Error(n(162));d=s.memoizedProps,c=s.stateNode;try{c.nodeValue=d}catch(xe){it(s,s.return,xe)}}break;case 3:if(Vc=null,v=Zn,Zn=Gc(a.containerInfo),pn(a,s),Zn=v,gn(s),d&4&&c!==null&&c.memoizedState.isDehydrated)try{sr(a.containerInfo)}catch(xe){it(s,s.return,xe)}Yd&&(Yd=!1,oy(s));break;case 4:d=Zn,Zn=Gc(s.stateNode.containerInfo),pn(a,s),gn(s),Zn=d;break;case 12:pn(a,s),gn(s);break;case 31:pn(a,s),gn(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,Dc(s,d)));break;case 13:pn(a,s),gn(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(_c=Je()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,Dc(s,d)));break;case 22:v=s.memoizedState!==null;var L=c!==null&&c.memoizedState!==null,F=Us,ne=It;if(Us=F||v,It=ne||L,pn(a,s),It=ne,Us=F,gn(s),d&8192)e:for(a=s.stateNode,a._visibility=v?a._visibility&-2:a._visibility|1,v&&(c===null||L||Us||It||oo(s)),c=null,a=s;;){if(a.tag===5||a.tag===26){if(c===null){L=c=a;try{if(b=L.stateNode,v)R=b.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{k=L.stateNode;var ie=L.memoizedProps.style,K=ie!=null&&ie.hasOwnProperty("display")?ie.display:null;k.style.display=K==null||typeof K=="boolean"?"":(""+K).trim()}}catch(xe){it(L,L.return,xe)}}}else if(a.tag===6){if(c===null){L=a;try{L.stateNode.nodeValue=v?"":L.memoizedProps}catch(xe){it(L,L.return,xe)}}}else if(a.tag===18){if(c===null){L=a;try{var W=L.stateNode;v?Ky(W,!0):Ky(L.stateNode,!1)}catch(xe){it(L,L.return,xe)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;c===a&&(c=null),a=a.return}c===a&&(c=null),a.sibling.return=a.return,a=a.sibling}d&4&&(d=s.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,Dc(s,c))));break;case 19:pn(a,s),gn(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,Dc(s,d)));break;case 30:break;case 21:break;default:pn(a,s),gn(s)}}function gn(s){var a=s.flags;if(a&2){try{for(var c,d=s.return;d!==null;){if(Xm(d)){c=d;break}d=d.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var v=c.stateNode,b=Vd(s);kc(s,b,v);break;case 5:var R=c.stateNode;c.flags&32&&(Ro(R,""),c.flags&=-33);var k=Vd(s);kc(s,k,R);break;case 3:case 4:var L=c.stateNode.containerInfo,F=Vd(s);Kd(s,F,L);break;default:throw Error(n(161))}}catch(ne){it(s,s.return,ne)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function oy(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;oy(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function Bs(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Jm(s,a.alternate,a),a=a.sibling}function oo(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:ma(4,a,a.return),oo(a);break;case 1:us(a,a.return);var c=a.stateNode;typeof c.componentWillUnmount=="function"&&Km(a,a.return,c),oo(a);break;case 27:ui(a.stateNode);case 26:case 5:us(a,a.return),oo(a);break;case 22:a.memoizedState===null&&oo(a);break;case 30:oo(a);break;default:oo(a)}s=s.sibling}}function Qs(s,a,c){for(c=c&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var d=a.alternate,v=s,b=a,R=b.flags;switch(b.tag){case 0:case 11:case 15:Qs(v,b,c),ei(4,b);break;case 1:if(Qs(v,b,c),d=b,v=d.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(F){it(d,d.return,F)}if(d=b,v=d.updateQueue,v!==null){var k=d.stateNode;try{var L=v.shared.hiddenCallbacks;if(L!==null)for(v.shared.hiddenCallbacks=null,v=0;v<L.length;v++)Og(L[v],k)}catch(F){it(d,d.return,F)}}c&&R&64&&Vm(b),ti(b,b.return);break;case 27:Wm(b);case 26:case 5:Qs(v,b,c),c&&d===null&&R&4&&Ym(b),ti(b,b.return);break;case 12:Qs(v,b,c);break;case 31:Qs(v,b,c),c&&R&4&&ny(v,b);break;case 13:Qs(v,b,c),c&&R&4&&sy(v,b);break;case 22:b.memoizedState===null&&Qs(v,b,c),ti(b,b.return);break;case 30:break;default:Qs(v,b,c)}a=a.sibling}}function Xd(s,a){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&Ur(c))}function Wd(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ur(s))}function Jn(s,a,c,d){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)ry(s,a,c,d),a=a.sibling}function ry(s,a,c,d){var v=a.flags;switch(a.tag){case 0:case 11:case 15:Jn(s,a,c,d),v&2048&&ei(9,a);break;case 1:Jn(s,a,c,d);break;case 3:Jn(s,a,c,d),v&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&Ur(s)));break;case 12:if(v&2048){Jn(s,a,c,d),s=a.stateNode;try{var b=a.memoizedProps,R=b.id,k=b.onPostCommit;typeof k=="function"&&k(R,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(L){it(a,a.return,L)}}else Jn(s,a,c,d);break;case 31:Jn(s,a,c,d);break;case 13:Jn(s,a,c,d);break;case 23:break;case 22:b=a.stateNode,R=a.alternate,a.memoizedState!==null?b._visibility&2?Jn(s,a,c,d):ni(s,a):b._visibility&2?Jn(s,a,c,d):(b._visibility|=2,Fo(s,a,c,d,(a.subtreeFlags&10256)!==0||!1)),v&2048&&Xd(R,a);break;case 24:Jn(s,a,c,d),v&2048&&Wd(a.alternate,a);break;default:Jn(s,a,c,d)}}function Fo(s,a,c,d,v){for(v=v&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var b=s,R=a,k=c,L=d,F=R.flags;switch(R.tag){case 0:case 11:case 15:Fo(b,R,k,L,v),ei(8,R);break;case 23:break;case 22:var ne=R.stateNode;R.memoizedState!==null?ne._visibility&2?Fo(b,R,k,L,v):ni(b,R):(ne._visibility|=2,Fo(b,R,k,L,v)),v&&F&2048&&Xd(R.alternate,R);break;case 24:Fo(b,R,k,L,v),v&&F&2048&&Wd(R.alternate,R);break;default:Fo(b,R,k,L,v)}a=a.sibling}}function ni(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var c=s,d=a,v=d.flags;switch(d.tag){case 22:ni(c,d),v&2048&&Xd(d.alternate,d);break;case 24:ni(c,d),v&2048&&Wd(d.alternate,d);break;default:ni(c,d)}a=a.sibling}}var si=8192;function Vo(s,a,c){if(s.subtreeFlags&si)for(s=s.child;s!==null;)iy(s,a,c),s=s.sibling}function iy(s,a,c){switch(s.tag){case 26:Vo(s,a,c),s.flags&si&&s.memoizedState!==null&&UM(c,Zn,s.memoizedState,s.memoizedProps);break;case 5:Vo(s,a,c);break;case 3:case 4:var d=Zn;Zn=Gc(s.stateNode.containerInfo),Vo(s,a,c),Zn=d;break;case 22:s.memoizedState===null&&(d=s.alternate,d!==null&&d.memoizedState!==null?(d=si,si=16777216,Vo(s,a,c),si=d):Vo(s,a,c));break;default:Vo(s,a,c)}}function cy(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function ai(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];Kt=d,uy(d,s)}cy(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)ly(s),s=s.sibling}function ly(s){switch(s.tag){case 0:case 11:case 15:ai(s),s.flags&2048&&ma(9,s,s.return);break;case 3:ai(s);break;case 12:ai(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,jc(s)):ai(s);break;default:ai(s)}}function jc(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];Kt=d,uy(d,s)}cy(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:ma(8,a,a.return),jc(a);break;case 22:c=a.stateNode,c._visibility&2&&(c._visibility&=-3,jc(a));break;default:jc(a)}s=s.sibling}}function uy(s,a){for(;Kt!==null;){var c=Kt;switch(c.tag){case 0:case 11:case 15:ma(8,c,a);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Ur(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,Kt=d;else e:for(c=s;Kt!==null;){d=Kt;var v=d.sibling,b=d.return;if(ey(d),d===c){Kt=null;break e}if(v!==null){v.return=b,Kt=v;break e}Kt=b}}}var nM={getCacheForType:function(s){var a=Jt(Lt),c=a.data.get(s);return c===void 0&&(c=s(),a.data.set(s,c)),c},cacheSignal:function(){return Jt(Lt).controller.signal}},sM=typeof WeakMap=="function"?WeakMap:Map,nt=0,ft=null,Qe=null,Fe=0,rt=0,Mn=null,ya=!1,Ko=!1,Zd=!1,Gs=0,Mt=0,va=0,ro=0,Jd=0,En=0,Yo=0,oi=null,mn=null,ef=!1,_c=0,dy=0,zc=1/0,Lc=null,ba=null,Ut=0,xa=null,Xo=null,Fs=0,tf=0,nf=null,fy=null,ri=0,sf=null;function Rn(){return(nt&2)!==0&&Fe!==0?Fe&-Fe:z.T!==null?uf():cn()}function hy(){if(En===0)if((Fe&536870912)===0||Xe){var s=$a;$a<<=1,($a&3932160)===0&&($a=262144),En=s}else En=536870912;return s=Sn.current,s!==null&&(s.flags|=32),En}function yn(s,a,c){(s===ft&&(rt===2||rt===9)||s.cancelPendingCommit!==null)&&(Wo(s,0),wa(s,Fe,En,!1)),be(s,c),((nt&2)===0||s!==ft)&&(s===ft&&((nt&2)===0&&(ro|=c),Mt===4&&wa(s,Fe,En,!1)),ds(s))}function py(s,a,c){if((nt&6)!==0)throw Error(n(327));var d=!c&&(a&127)===0&&(a&s.expiredLanes)===0||Ns(s,a),v=d?rM(s,a):of(s,a,!0),b=d;do{if(v===0){Ko&&!d&&wa(s,a,0,!1);break}else{if(c=s.current.alternate,b&&!aM(c)){v=of(s,a,!1),b=!1;continue}if(v===2){if(b=a,s.errorRecoveryDisabledLanes&b)var R=0;else R=s.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){a=R;e:{var k=s;v=oi;var L=k.current.memoizedState.isDehydrated;if(L&&(Wo(k,R).flags|=256),R=of(k,R,!1),R!==2){if(Zd&&!L){k.errorRecoveryDisabledLanes|=b,ro|=b,v=4;break e}b=mn,mn=v,b!==null&&(mn===null?mn=b:mn.push.apply(mn,b))}v=R}if(b=!1,v!==2)continue}}if(v===1){Wo(s,0),wa(s,a,0,!0);break}e:{switch(d=s,b=v,b){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:wa(d,a,En,!ya);break e;case 2:mn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(v=_c+300-Je(),10<v)){if(wa(d,a,En,!ya),As(d,0,!0)!==0)break e;Fs=a,d.timeoutHandle=Gy(gy.bind(null,d,c,mn,Lc,ef,a,En,ro,Yo,ya,b,"Throttled",-0,0),v);break e}gy(d,c,mn,Lc,ef,a,En,ro,Yo,ya,b,null,-0,0)}}break}while(!0);ds(s)}function gy(s,a,c,d,v,b,R,k,L,F,ne,ie,K,W){if(s.timeoutHandle=-1,ie=a.subtreeFlags,ie&8192||(ie&16785408)===16785408){ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ds},iy(a,b,ie);var xe=(b&62914560)===b?_c-Je():(b&4194048)===b?dy-Je():0;if(xe=$M(ie,xe),xe!==null){Fs=b,s.cancelPendingCommit=xe(Cy.bind(null,s,a,b,c,d,v,R,k,L,ne,ie,null,K,W)),wa(s,b,R,!F);return}}Cy(s,a,b,c,d,v,R,k,L)}function aM(s){for(var a=s;;){var c=a.tag;if((c===0||c===11||c===15)&&a.flags&16384&&(c=a.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var v=c[d],b=v.getSnapshot;v=v.value;try{if(!xn(b(),v))return!1}catch{return!1}}if(c=a.child,a.subtreeFlags&16384&&c!==null)c.return=a,a=c;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function wa(s,a,c,d){a&=~Jd,a&=~ro,s.suspendedLanes|=a,s.pingedLanes&=~a,d&&(s.warmLanes|=a),d=s.expirationTimes;for(var v=a;0<v;){var b=31-_t(v),R=1<<b;d[b]=-1,v&=~R}c!==0&&Oe(s,c,a)}function Oc(){return(nt&6)===0?(ii(0),!1):!0}function af(){if(Qe!==null){if(rt===0)var s=Qe.return;else s=Qe,Ls=Wa=null,xd(s),Uo=null,Br=0,s=Qe;for(;s!==null;)Fm(s.alternate,s),s=s.return;Qe=null}}function Wo(s,a){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,MM(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),Fs=0,af(),ft=s,Qe=c=_s(s.current,null),Fe=a,rt=0,Mn=null,ya=!1,Ko=Ns(s,a),Zd=!1,Yo=En=Jd=ro=va=Mt=0,mn=oi=null,ef=!1,(a&8)!==0&&(a|=a&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=a;0<d;){var v=31-_t(d),b=1<<v;a|=s[v],d&=~b}return Gs=a,sc(),c}function my(s,a){Pe=null,z.H=Wr,a===Ho||a===dc?(a=jg(),rt=3):a===cd?(a=jg(),rt=4):rt=a===Od?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Mn=a,Qe===null&&(Mt=1,Ec(s,On(a,s.current)))}function yy(){var s=Sn.current;return s===null?!0:(Fe&4194048)===Fe?Hn===null:(Fe&62914560)===Fe||(Fe&536870912)!==0?s===Hn:!1}function vy(){var s=z.H;return z.H=Wr,s===null?Wr:s}function by(){var s=z.A;return z.A=nM,s}function Pc(){Mt=4,ya||(Fe&4194048)!==Fe&&Sn.current!==null||(Ko=!0),(va&134217727)===0&&(ro&134217727)===0||ft===null||wa(ft,Fe,En,!1)}function of(s,a,c){var d=nt;nt|=2;var v=vy(),b=by();(ft!==s||Fe!==a)&&(Lc=null,Wo(s,a)),a=!1;var R=Mt;e:do try{if(rt!==0&&Qe!==null){var k=Qe,L=Mn;switch(rt){case 8:af(),R=6;break e;case 3:case 2:case 9:case 6:Sn.current===null&&(a=!0);var F=rt;if(rt=0,Mn=null,Zo(s,k,L,F),c&&Ko){R=0;break e}break;default:F=rt,rt=0,Mn=null,Zo(s,k,L,F)}}oM(),R=Mt;break}catch(ne){my(s,ne)}while(!0);return a&&s.shellSuspendCounter++,Ls=Wa=null,nt=d,z.H=v,z.A=b,Qe===null&&(ft=null,Fe=0,sc()),R}function oM(){for(;Qe!==null;)xy(Qe)}function rM(s,a){var c=nt;nt|=2;var d=vy(),v=by();ft!==s||Fe!==a?(Lc=null,zc=Je()+500,Wo(s,a)):Ko=Ns(s,a);e:do try{if(rt!==0&&Qe!==null){a=Qe;var b=Mn;t:switch(rt){case 1:rt=0,Mn=null,Zo(s,a,b,1);break;case 2:case 9:if(kg(b)){rt=0,Mn=null,wy(a);break}a=function(){rt!==2&&rt!==9||ft!==s||(rt=7),ds(s)},b.then(a,a);break e;case 3:rt=7;break e;case 4:rt=5;break e;case 7:kg(b)?(rt=0,Mn=null,wy(a)):(rt=0,Mn=null,Zo(s,a,b,7));break;case 5:var R=null;switch(Qe.tag){case 26:R=Qe.memoizedState;case 5:case 27:var k=Qe;if(R?r0(R):k.stateNode.complete){rt=0,Mn=null;var L=k.sibling;if(L!==null)Qe=L;else{var F=k.return;F!==null?(Qe=F,Ic(F)):Qe=null}break t}}rt=0,Mn=null,Zo(s,a,b,5);break;case 6:rt=0,Mn=null,Zo(s,a,b,6);break;case 8:af(),Mt=6;break e;default:throw Error(n(462))}}iM();break}catch(ne){my(s,ne)}while(!0);return Ls=Wa=null,z.H=d,z.A=v,nt=c,Qe!==null?0:(ft=null,Fe=0,sc(),Mt)}function iM(){for(;Qe!==null&&!pt();)xy(Qe)}function xy(s){var a=Qm(s.alternate,s,Gs);s.memoizedProps=s.pendingProps,a===null?Ic(s):Qe=a}function wy(s){var a=s,c=a.alternate;switch(a.tag){case 15:case 0:a=Im(c,a,a.pendingProps,a.type,void 0,Fe);break;case 11:a=Im(c,a,a.pendingProps,a.type.render,a.ref,Fe);break;case 5:xd(a);default:Fm(c,a),a=Qe=bg(a,Gs),a=Qm(c,a,Gs)}s.memoizedProps=s.pendingProps,a===null?Ic(s):Qe=a}function Zo(s,a,c,d){Ls=Wa=null,xd(a),Uo=null,Br=0;var v=a.return;try{if(YC(s,v,a,c,Fe)){Mt=1,Ec(s,On(c,s.current)),Qe=null;return}}catch(b){if(v!==null)throw Qe=v,b;Mt=1,Ec(s,On(c,s.current)),Qe=null;return}a.flags&32768?(Xe||d===1?s=!0:Ko||(Fe&536870912)!==0?s=!1:(ya=s=!0,(d===2||d===9||d===3||d===6)&&(d=Sn.current,d!==null&&d.tag===13&&(d.flags|=16384))),Sy(a,s)):Ic(a)}function Ic(s){var a=s;do{if((a.flags&32768)!==0){Sy(a,ya);return}s=a.return;var c=ZC(a.alternate,a,Gs);if(c!==null){Qe=c;return}if(a=a.sibling,a!==null){Qe=a;return}Qe=a=s}while(a!==null);Mt===0&&(Mt=5)}function Sy(s,a){do{var c=JC(s.alternate,s);if(c!==null){c.flags&=32767,Qe=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!a&&(s=s.sibling,s!==null)){Qe=s;return}Qe=s=c}while(s!==null);Mt=6,Qe=null}function Cy(s,a,c,d,v,b,R,k,L){s.cancelPendingCommit=null;do qc();while(Ut!==0);if((nt&6)!==0)throw Error(n(327));if(a!==null){if(a===s.current)throw Error(n(177));if(b=a.lanes|a.childLanes,b|=Vu,ze(s,c,b,R,k,L),s===ft&&(Qe=ft=null,Fe=0),Xo=a,xa=s,Fs=c,tf=b,nf=v,fy=d,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,dM(Yt,function(){return Ay(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||d){d=z.T,z.T=null,v=j.p,j.p=2,R=nt,nt|=4;try{eM(s,a,c)}finally{nt=R,j.p=v,z.T=d}}Ut=1,My(),Ey(),Ry()}}function My(){if(Ut===1){Ut=0;var s=xa,a=Xo,c=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||c){c=z.T,z.T=null;var d=j.p;j.p=2;var v=nt;nt|=4;try{ay(a,s);var b=vf,R=ug(s.containerInfo),k=b.focusedElem,L=b.selectionRange;if(R!==k&&k&&k.ownerDocument&&lg(k.ownerDocument.documentElement,k)){if(L!==null&&$u(k)){var F=L.start,ne=L.end;if(ne===void 0&&(ne=F),"selectionStart"in k)k.selectionStart=F,k.selectionEnd=Math.min(ne,k.value.length);else{var ie=k.ownerDocument||document,K=ie&&ie.defaultView||window;if(K.getSelection){var W=K.getSelection(),xe=k.textContent.length,ke=Math.min(L.start,xe),dt=L.end===void 0?ke:Math.min(L.end,xe);!W.extend&&ke>dt&&(R=dt,dt=ke,ke=R);var U=cg(k,ke),I=cg(k,dt);if(U&&I&&(W.rangeCount!==1||W.anchorNode!==U.node||W.anchorOffset!==U.offset||W.focusNode!==I.node||W.focusOffset!==I.offset)){var G=ie.createRange();G.setStart(U.node,U.offset),W.removeAllRanges(),ke>dt?(W.addRange(G),W.extend(I.node,I.offset)):(G.setEnd(I.node,I.offset),W.addRange(G))}}}}for(ie=[],W=k;W=W.parentNode;)W.nodeType===1&&ie.push({element:W,left:W.scrollLeft,top:W.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<ie.length;k++){var re=ie[k];re.element.scrollLeft=re.left,re.element.scrollTop=re.top}}Wc=!!yf,vf=yf=null}finally{nt=v,j.p=d,z.T=c}}s.current=a,Ut=2}}function Ey(){if(Ut===2){Ut=0;var s=xa,a=Xo,c=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||c){c=z.T,z.T=null;var d=j.p;j.p=2;var v=nt;nt|=4;try{Jm(s,a.alternate,a)}finally{nt=v,j.p=d,z.T=c}}Ut=3}}function Ry(){if(Ut===4||Ut===3){Ut=0,qt();var s=xa,a=Xo,c=Fs,d=fy;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Ut=5:(Ut=0,Xo=xa=null,Ty(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(ba=null),Rt(c),a=a.stateNode,Xt&&typeof Xt.onCommitFiberRoot=="function")try{Xt.onCommitFiberRoot(rs,a,void 0,(a.current.flags&128)===128)}catch{}if(d!==null){a=z.T,v=j.p,j.p=2,z.T=null;try{for(var b=s.onRecoverableError,R=0;R<d.length;R++){var k=d[R];b(k.value,{componentStack:k.stack})}}finally{z.T=a,j.p=v}}(Fs&3)!==0&&qc(),ds(s),v=s.pendingLanes,(c&261930)!==0&&(v&42)!==0?s===sf?ri++:(ri=0,sf=s):ri=0,ii(0)}}function Ty(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,Ur(a)))}function qc(){return My(),Ey(),Ry(),Ay()}function Ay(){if(Ut!==5)return!1;var s=xa,a=tf;tf=0;var c=Rt(Fs),d=z.T,v=j.p;try{j.p=32>c?32:c,z.T=null,c=nf,nf=null;var b=xa,R=Fs;if(Ut=0,Xo=xa=null,Fs=0,(nt&6)!==0)throw Error(n(331));var k=nt;if(nt|=4,ly(b.current),ry(b,b.current,R,c),nt=k,ii(0,!1),Xt&&typeof Xt.onPostCommitFiberRoot=="function")try{Xt.onPostCommitFiberRoot(rs,b)}catch{}return!0}finally{j.p=v,z.T=d,Ty(s,a)}}function Ny(s,a,c){a=On(c,a),a=Ld(s.stateNode,a,2),s=ha(s,a,2),s!==null&&(be(s,2),ds(s))}function it(s,a,c){if(s.tag===3)Ny(s,s,c);else for(;a!==null;){if(a.tag===3){Ny(a,s,c);break}else if(a.tag===1){var d=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(ba===null||!ba.has(d))){s=On(c,s),c=km(2),d=ha(a,c,2),d!==null&&(Dm(c,d,a,s),be(d,2),ds(d));break}}a=a.return}}function rf(s,a,c){var d=s.pingCache;if(d===null){d=s.pingCache=new sM;var v=new Set;d.set(a,v)}else v=d.get(a),v===void 0&&(v=new Set,d.set(a,v));v.has(c)||(Zd=!0,v.add(c),s=cM.bind(null,s,a,c),a.then(s,s))}function cM(s,a,c){var d=s.pingCache;d!==null&&d.delete(a),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,ft===s&&(Fe&c)===c&&(Mt===4||Mt===3&&(Fe&62914560)===Fe&&300>Je()-_c?(nt&2)===0&&Wo(s,0):Jd|=c,Yo===Fe&&(Yo=0)),ds(s)}function ky(s,a){a===0&&(a=ee()),s=Ka(s,a),s!==null&&(be(s,a),ds(s))}function lM(s){var a=s.memoizedState,c=0;a!==null&&(c=a.retryLane),ky(s,c)}function uM(s,a){var c=0;switch(s.tag){case 31:case 13:var d=s.stateNode,v=s.memoizedState;v!==null&&(c=v.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(a),ky(s,c)}function dM(s,a){return $e(s,a)}var Hc=null,Jo=null,cf=!1,Uc=!1,lf=!1,Sa=0;function ds(s){s!==Jo&&s.next===null&&(Jo===null?Hc=Jo=s:Jo=Jo.next=s),Uc=!0,cf||(cf=!0,hM())}function ii(s,a){if(!lf&&Uc){lf=!0;do for(var c=!1,d=Hc;d!==null;){if(s!==0){var v=d.pendingLanes;if(v===0)var b=0;else{var R=d.suspendedLanes,k=d.pingedLanes;b=(1<<31-_t(42|s)+1)-1,b&=v&~(R&~k),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(c=!0,zy(d,b))}else b=Fe,b=As(d,d===ft?b:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(b&3)===0||Ns(d,b)||(c=!0,zy(d,b));d=d.next}while(c);lf=!1}}function fM(){Dy()}function Dy(){Uc=cf=!1;var s=0;Sa!==0&&CM()&&(s=Sa);for(var a=Je(),c=null,d=Hc;d!==null;){var v=d.next,b=jy(d,a);b===0?(d.next=null,c===null?Hc=v:c.next=v,v===null&&(Jo=c)):(c=d,(s!==0||(b&3)!==0)&&(Uc=!0)),d=v}Ut!==0&&Ut!==5||ii(s),Sa!==0&&(Sa=0)}function jy(s,a){for(var c=s.suspendedLanes,d=s.pingedLanes,v=s.expirationTimes,b=s.pendingLanes&-62914561;0<b;){var R=31-_t(b),k=1<<R,L=v[R];L===-1?((k&c)===0||(k&d)!==0)&&(v[R]=Mu(k,a)):L<=a&&(s.expiredLanes|=k),b&=~k}if(a=ft,c=Fe,c=As(s,s===a?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,c===0||s===a&&(rt===2||rt===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&yt(d),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||Ns(s,c)){if(a=c&-c,a===s.callbackPriority)return a;switch(d!==null&&yt(d),Rt(c)){case 2:case 8:c=gt;break;case 32:c=Yt;break;case 268435456:c=Rs;break;default:c=Yt}return d=_y.bind(null,s),c=$e(c,d),s.callbackPriority=a,s.callbackNode=c,a}return d!==null&&d!==null&&yt(d),s.callbackPriority=2,s.callbackNode=null,2}function _y(s,a){if(Ut!==0&&Ut!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(qc()&&s.callbackNode!==c)return null;var d=Fe;return d=As(s,s===ft?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(py(s,d,a),jy(s,Je()),s.callbackNode!=null&&s.callbackNode===c?_y.bind(null,s):null)}function zy(s,a){if(qc())return null;py(s,a,!0)}function hM(){EM(function(){(nt&6)!==0?$e(vt,fM):Dy()})}function uf(){if(Sa===0){var s=Io;s===0&&(s=Ts,Ts<<=1,(Ts&261888)===0&&(Ts=256)),Sa=s}return Sa}function Ly(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Yi(""+s)}function Oy(s,a){var c=a.ownerDocument.createElement("input");return c.name=a.name,c.value=a.value,s.id&&c.setAttribute("form",s.id),a.parentNode.insertBefore(c,a),s=new FormData(s),c.parentNode.removeChild(c),s}function pM(s,a,c,d,v){if(a==="submit"&&c&&c.stateNode===v){var b=Ly((v[Ht]||null).action),R=d.submitter;R&&(a=(a=R[Ht]||null)?Ly(a.formAction):R.getAttribute("formAction"),a!==null&&(b=a,R=null));var k=new Ji("action","action",null,d,v);s.push({event:k,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Sa!==0){var L=R?Oy(v,R):new FormData(v);Nd(c,{pending:!0,data:L,method:v.method,action:b},null,L)}}else typeof b=="function"&&(k.preventDefault(),L=R?Oy(v,R):new FormData(v),Nd(c,{pending:!0,data:L,method:v.method,action:b},b,L))},currentTarget:v}]})}}for(var df=0;df<Fu.length;df++){var ff=Fu[df],gM=ff.toLowerCase(),mM=ff[0].toUpperCase()+ff.slice(1);Wn(gM,"on"+mM)}Wn(hg,"onAnimationEnd"),Wn(pg,"onAnimationIteration"),Wn(gg,"onAnimationStart"),Wn("dblclick","onDoubleClick"),Wn("focusin","onFocus"),Wn("focusout","onBlur"),Wn(jC,"onTransitionRun"),Wn(_C,"onTransitionStart"),Wn(zC,"onTransitionCancel"),Wn(mg,"onTransitionEnd"),Mo("onMouseEnter",["mouseout","mouseover"]),Mo("onMouseLeave",["mouseout","mouseover"]),Mo("onPointerEnter",["pointerout","pointerover"]),Mo("onPointerLeave",["pointerout","pointerover"]),Qa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Qa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Qa("onBeforeInput",["compositionend","keypress","textInput","paste"]),Qa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Qa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Qa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ci="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yM=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ci));function Py(s,a){a=(a&4)!==0;for(var c=0;c<s.length;c++){var d=s[c],v=d.event;d=d.listeners;e:{var b=void 0;if(a)for(var R=d.length-1;0<=R;R--){var k=d[R],L=k.instance,F=k.currentTarget;if(k=k.listener,L!==b&&v.isPropagationStopped())break e;b=k,v.currentTarget=F;try{b(v)}catch(ne){nc(ne)}v.currentTarget=null,b=L}else for(R=0;R<d.length;R++){if(k=d[R],L=k.instance,F=k.currentTarget,k=k.listener,L!==b&&v.isPropagationStopped())break e;b=k,v.currentTarget=F;try{b(v)}catch(ne){nc(ne)}v.currentTarget=null,b=L}}}}function Ge(s,a){var c=a[Be];c===void 0&&(c=a[Be]=new Set);var d=s+"__bubble";c.has(d)||(Iy(a,s,2,!1),c.add(d))}function hf(s,a,c){var d=0;a&&(d|=4),Iy(c,s,d,a)}var $c="_reactListening"+Math.random().toString(36).slice(2);function pf(s){if(!s[$c]){s[$c]=!0,Dp.forEach(function(c){c!=="selectionchange"&&(yM.has(c)||hf(c,!1,s),hf(c,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[$c]||(a[$c]=!0,hf("selectionchange",!1,a))}}function Iy(s,a,c,d){switch(h0(a)){case 2:var v=GM;break;case 8:v=FM;break;default:v=Nf}c=v.bind(null,a,c,s),v=void 0,!_u||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(v=!0),d?v!==void 0?s.addEventListener(a,c,{capture:!0,passive:v}):s.addEventListener(a,c,!0):v!==void 0?s.addEventListener(a,c,{passive:v}):s.addEventListener(a,c,!1)}function gf(s,a,c,d,v){var b=d;if((a&1)===0&&(a&2)===0&&d!==null)e:for(;;){if(d===null)return;var R=d.tag;if(R===3||R===4){var k=d.stateNode.containerInfo;if(k===v)break;if(R===4)for(R=d.return;R!==null;){var L=R.tag;if((L===3||L===4)&&R.stateNode.containerInfo===v)return;R=R.return}for(;k!==null;){if(R=wo(k),R===null)return;if(L=R.tag,L===5||L===6||L===26||L===27){d=b=R;continue e}k=k.parentNode}}d=d.return}Bp(function(){var F=b,ne=Du(c),ie=[];e:{var K=yg.get(s);if(K!==void 0){var W=Ji,xe=s;switch(s){case"keypress":if(Wi(c)===0)break e;case"keydown":case"keyup":W=uC;break;case"focusin":xe="focus",W=Pu;break;case"focusout":xe="blur",W=Pu;break;case"beforeblur":case"afterblur":W=Pu;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":W=Fp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":W=ZS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":W=hC;break;case hg:case pg:case gg:W=tC;break;case mg:W=gC;break;case"scroll":case"scrollend":W=XS;break;case"wheel":W=yC;break;case"copy":case"cut":case"paste":W=sC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":W=Kp;break;case"toggle":case"beforetoggle":W=bC}var ke=(a&4)!==0,dt=!ke&&(s==="scroll"||s==="scrollend"),U=ke?K!==null?K+"Capture":null:K;ke=[];for(var I=F,G;I!==null;){var re=I;if(G=re.stateNode,re=re.tag,re!==5&&re!==26&&re!==27||G===null||U===null||(re=kr(I,U),re!=null&&ke.push(li(I,re,G))),dt)break;I=I.return}0<ke.length&&(K=new W(K,xe,null,c,ne),ie.push({event:K,listeners:ke}))}}if((a&7)===0){e:{if(K=s==="mouseover"||s==="pointerover",W=s==="mouseout"||s==="pointerout",K&&c!==ku&&(xe=c.relatedTarget||c.fromElement)&&(wo(xe)||xe[is]))break e;if((W||K)&&(K=ne.window===ne?ne:(K=ne.ownerDocument)?K.defaultView||K.parentWindow:window,W?(xe=c.relatedTarget||c.toElement,W=F,xe=xe?wo(xe):null,xe!==null&&(dt=i(xe),ke=xe.tag,xe!==dt||ke!==5&&ke!==27&&ke!==6)&&(xe=null)):(W=null,xe=F),W!==xe)){if(ke=Fp,re="onMouseLeave",U="onMouseEnter",I="mouse",(s==="pointerout"||s==="pointerover")&&(ke=Kp,re="onPointerLeave",U="onPointerEnter",I="pointer"),dt=W==null?K:Nr(W),G=xe==null?K:Nr(xe),K=new ke(re,I+"leave",W,c,ne),K.target=dt,K.relatedTarget=G,re=null,wo(ne)===F&&(ke=new ke(U,I+"enter",xe,c,ne),ke.target=G,ke.relatedTarget=dt,re=ke),dt=re,W&&xe)t:{for(ke=vM,U=W,I=xe,G=0,re=U;re;re=ke(re))G++;re=0;for(var Te=I;Te;Te=ke(Te))re++;for(;0<G-re;)U=ke(U),G--;for(;0<re-G;)I=ke(I),re--;for(;G--;){if(U===I||I!==null&&U===I.alternate){ke=U;break t}U=ke(U),I=ke(I)}ke=null}else ke=null;W!==null&&qy(ie,K,W,ke,!1),xe!==null&&dt!==null&&qy(ie,dt,xe,ke,!0)}}e:{if(K=F?Nr(F):window,W=K.nodeName&&K.nodeName.toLowerCase(),W==="select"||W==="input"&&K.type==="file")var et=ng;else if(eg(K))if(sg)et=NC;else{et=TC;var Me=RC}else W=K.nodeName,!W||W.toLowerCase()!=="input"||K.type!=="checkbox"&&K.type!=="radio"?F&&Nu(F.elementType)&&(et=ng):et=AC;if(et&&(et=et(s,F))){tg(ie,et,c,ne);break e}Me&&Me(s,K,F),s==="focusout"&&F&&K.type==="number"&&F.memoizedProps.value!=null&&Au(K,"number",K.value)}switch(Me=F?Nr(F):window,s){case"focusin":(eg(Me)||Me.contentEditable==="true")&&(ko=Me,Bu=F,Ir=null);break;case"focusout":Ir=Bu=ko=null;break;case"mousedown":Qu=!0;break;case"contextmenu":case"mouseup":case"dragend":Qu=!1,dg(ie,c,ne);break;case"selectionchange":if(DC)break;case"keydown":case"keyup":dg(ie,c,ne)}var Ie;if(qu)e:{switch(s){case"compositionstart":var Ve="onCompositionStart";break e;case"compositionend":Ve="onCompositionEnd";break e;case"compositionupdate":Ve="onCompositionUpdate";break e}Ve=void 0}else No?Zp(s,c)&&(Ve="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Ve="onCompositionStart");Ve&&(Yp&&c.locale!=="ko"&&(No||Ve!=="onCompositionStart"?Ve==="onCompositionEnd"&&No&&(Ie=Qp()):(ra=ne,zu="value"in ra?ra.value:ra.textContent,No=!0)),Me=Bc(F,Ve),0<Me.length&&(Ve=new Vp(Ve,s,null,c,ne),ie.push({event:Ve,listeners:Me}),Ie?Ve.data=Ie:(Ie=Jp(c),Ie!==null&&(Ve.data=Ie)))),(Ie=wC?SC(s,c):CC(s,c))&&(Ve=Bc(F,"onBeforeInput"),0<Ve.length&&(Me=new Vp("onBeforeInput","beforeinput",null,c,ne),ie.push({event:Me,listeners:Ve}),Me.data=Ie)),pM(ie,s,F,c,ne)}Py(ie,a)})}function li(s,a,c){return{instance:s,listener:a,currentTarget:c}}function Bc(s,a){for(var c=a+"Capture",d=[];s!==null;){var v=s,b=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||b===null||(v=kr(s,c),v!=null&&d.unshift(li(s,v,b)),v=kr(s,a),v!=null&&d.push(li(s,v,b))),s.tag===3)return d;s=s.return}return[]}function vM(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function qy(s,a,c,d,v){for(var b=a._reactName,R=[];c!==null&&c!==d;){var k=c,L=k.alternate,F=k.stateNode;if(k=k.tag,L!==null&&L===d)break;k!==5&&k!==26&&k!==27||F===null||(L=F,v?(F=kr(c,b),F!=null&&R.unshift(li(c,F,L))):v||(F=kr(c,b),F!=null&&R.push(li(c,F,L)))),c=c.return}R.length!==0&&s.push({event:a,listeners:R})}var bM=/\r\n?/g,xM=/\u0000|\uFFFD/g;function Hy(s){return(typeof s=="string"?s:""+s).replace(bM,`
`).replace(xM,"")}function Uy(s,a){return a=Hy(a),Hy(s)===a}function ut(s,a,c,d,v,b){switch(c){case"children":typeof d=="string"?a==="body"||a==="textarea"&&d===""||Ro(s,d):(typeof d=="number"||typeof d=="bigint")&&a!=="body"&&Ro(s,""+d);break;case"className":Vi(s,"class",d);break;case"tabIndex":Vi(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":Vi(s,c,d);break;case"style":Up(s,d,b);break;case"data":if(a!=="object"){Vi(s,"data",d);break}case"src":case"href":if(d===""&&(a!=="a"||c!=="href")){s.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=Yi(""+d),s.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(c==="formAction"?(a!=="input"&&ut(s,a,"name",v.name,v,null),ut(s,a,"formEncType",v.formEncType,v,null),ut(s,a,"formMethod",v.formMethod,v,null),ut(s,a,"formTarget",v.formTarget,v,null)):(ut(s,a,"encType",v.encType,v,null),ut(s,a,"method",v.method,v,null),ut(s,a,"target",v.target,v,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=Yi(""+d),s.setAttribute(c,d);break;case"onClick":d!=null&&(s.onclick=Ds);break;case"onScroll":d!=null&&Ge("scroll",s);break;case"onScrollEnd":d!=null&&Ge("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}c=Yi(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""+d):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":d===!0?s.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,d):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(c,d):s.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(c):s.setAttribute(c,d);break;case"popover":Ge("beforetoggle",s),Ge("toggle",s),Fi(s,"popover",d);break;case"xlinkActuate":ks(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":ks(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":ks(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":ks(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":ks(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":ks(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":ks(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":ks(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":ks(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Fi(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=KS.get(c)||c,Fi(s,c,d))}}function mf(s,a,c,d,v,b){switch(c){case"style":Up(s,d,b);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"children":typeof d=="string"?Ro(s,d):(typeof d=="number"||typeof d=="bigint")&&Ro(s,""+d);break;case"onScroll":d!=null&&Ge("scroll",s);break;case"onScrollEnd":d!=null&&Ge("scrollend",s);break;case"onClick":d!=null&&(s.onclick=Ds);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!jp.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(v=c.endsWith("Capture"),a=c.slice(2,v?c.length-7:void 0),b=s[Ht]||null,b=b!=null?b[c]:null,typeof b=="function"&&s.removeEventListener(a,b,v),typeof d=="function")){typeof b!="function"&&b!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(a,d,v);break e}c in s?s[c]=d:d===!0?s.setAttribute(c,""):Fi(s,c,d)}}}function tn(s,a,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",s),Ge("load",s);var d=!1,v=!1,b;for(b in c)if(c.hasOwnProperty(b)){var R=c[b];if(R!=null)switch(b){case"src":d=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:ut(s,a,b,R,c,null)}}v&&ut(s,a,"srcSet",c.srcSet,c,null),d&&ut(s,a,"src",c.src,c,null);return;case"input":Ge("invalid",s);var k=b=R=v=null,L=null,F=null;for(d in c)if(c.hasOwnProperty(d)){var ne=c[d];if(ne!=null)switch(d){case"name":v=ne;break;case"type":R=ne;break;case"checked":L=ne;break;case"defaultChecked":F=ne;break;case"value":b=ne;break;case"defaultValue":k=ne;break;case"children":case"dangerouslySetInnerHTML":if(ne!=null)throw Error(n(137,a));break;default:ut(s,a,d,ne,c,null)}}Pp(s,b,k,L,F,R,v,!1);return;case"select":Ge("invalid",s),d=R=b=null;for(v in c)if(c.hasOwnProperty(v)&&(k=c[v],k!=null))switch(v){case"value":b=k;break;case"defaultValue":R=k;break;case"multiple":d=k;default:ut(s,a,v,k,c,null)}a=b,c=R,s.multiple=!!d,a!=null?Eo(s,!!d,a,!1):c!=null&&Eo(s,!!d,c,!0);return;case"textarea":Ge("invalid",s),b=v=d=null;for(R in c)if(c.hasOwnProperty(R)&&(k=c[R],k!=null))switch(R){case"value":d=k;break;case"defaultValue":v=k;break;case"children":b=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(n(91));break;default:ut(s,a,R,k,c,null)}qp(s,d,v,b);return;case"option":for(L in c)if(c.hasOwnProperty(L)&&(d=c[L],d!=null))switch(L){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:ut(s,a,L,d,c,null)}return;case"dialog":Ge("beforetoggle",s),Ge("toggle",s),Ge("cancel",s),Ge("close",s);break;case"iframe":case"object":Ge("load",s);break;case"video":case"audio":for(d=0;d<ci.length;d++)Ge(ci[d],s);break;case"image":Ge("error",s),Ge("load",s);break;case"details":Ge("toggle",s);break;case"embed":case"source":case"link":Ge("error",s),Ge("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(F in c)if(c.hasOwnProperty(F)&&(d=c[F],d!=null))switch(F){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:ut(s,a,F,d,c,null)}return;default:if(Nu(a)){for(ne in c)c.hasOwnProperty(ne)&&(d=c[ne],d!==void 0&&mf(s,a,ne,d,c,void 0));return}}for(k in c)c.hasOwnProperty(k)&&(d=c[k],d!=null&&ut(s,a,k,d,c,null))}function wM(s,a,c,d){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,b=null,R=null,k=null,L=null,F=null,ne=null;for(W in c){var ie=c[W];if(c.hasOwnProperty(W)&&ie!=null)switch(W){case"checked":break;case"value":break;case"defaultValue":L=ie;default:d.hasOwnProperty(W)||ut(s,a,W,null,d,ie)}}for(var K in d){var W=d[K];if(ie=c[K],d.hasOwnProperty(K)&&(W!=null||ie!=null))switch(K){case"type":b=W;break;case"name":v=W;break;case"checked":F=W;break;case"defaultChecked":ne=W;break;case"value":R=W;break;case"defaultValue":k=W;break;case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(n(137,a));break;default:W!==ie&&ut(s,a,K,W,d,ie)}}Tu(s,R,k,L,F,ne,b,v);return;case"select":W=R=k=K=null;for(b in c)if(L=c[b],c.hasOwnProperty(b)&&L!=null)switch(b){case"value":break;case"multiple":W=L;default:d.hasOwnProperty(b)||ut(s,a,b,null,d,L)}for(v in d)if(b=d[v],L=c[v],d.hasOwnProperty(v)&&(b!=null||L!=null))switch(v){case"value":K=b;break;case"defaultValue":k=b;break;case"multiple":R=b;default:b!==L&&ut(s,a,v,b,d,L)}a=k,c=R,d=W,K!=null?Eo(s,!!c,K,!1):!!d!=!!c&&(a!=null?Eo(s,!!c,a,!0):Eo(s,!!c,c?[]:"",!1));return;case"textarea":W=K=null;for(k in c)if(v=c[k],c.hasOwnProperty(k)&&v!=null&&!d.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:ut(s,a,k,null,d,v)}for(R in d)if(v=d[R],b=c[R],d.hasOwnProperty(R)&&(v!=null||b!=null))switch(R){case"value":K=v;break;case"defaultValue":W=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(n(91));break;default:v!==b&&ut(s,a,R,v,d,b)}Ip(s,K,W);return;case"option":for(var xe in c)if(K=c[xe],c.hasOwnProperty(xe)&&K!=null&&!d.hasOwnProperty(xe))switch(xe){case"selected":s.selected=!1;break;default:ut(s,a,xe,null,d,K)}for(L in d)if(K=d[L],W=c[L],d.hasOwnProperty(L)&&K!==W&&(K!=null||W!=null))switch(L){case"selected":s.selected=K&&typeof K!="function"&&typeof K!="symbol";break;default:ut(s,a,L,K,d,W)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in c)K=c[ke],c.hasOwnProperty(ke)&&K!=null&&!d.hasOwnProperty(ke)&&ut(s,a,ke,null,d,K);for(F in d)if(K=d[F],W=c[F],d.hasOwnProperty(F)&&K!==W&&(K!=null||W!=null))switch(F){case"children":case"dangerouslySetInnerHTML":if(K!=null)throw Error(n(137,a));break;default:ut(s,a,F,K,d,W)}return;default:if(Nu(a)){for(var dt in c)K=c[dt],c.hasOwnProperty(dt)&&K!==void 0&&!d.hasOwnProperty(dt)&&mf(s,a,dt,void 0,d,K);for(ne in d)K=d[ne],W=c[ne],!d.hasOwnProperty(ne)||K===W||K===void 0&&W===void 0||mf(s,a,ne,K,d,W);return}}for(var U in c)K=c[U],c.hasOwnProperty(U)&&K!=null&&!d.hasOwnProperty(U)&&ut(s,a,U,null,d,K);for(ie in d)K=d[ie],W=c[ie],!d.hasOwnProperty(ie)||K===W||K==null&&W==null||ut(s,a,ie,K,d,W)}function $y(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function SM(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,c=performance.getEntriesByType("resource"),d=0;d<c.length;d++){var v=c[d],b=v.transferSize,R=v.initiatorType,k=v.duration;if(b&&k&&$y(R)){for(R=0,k=v.responseEnd,d+=1;d<c.length;d++){var L=c[d],F=L.startTime;if(F>k)break;var ne=L.transferSize,ie=L.initiatorType;ne&&$y(ie)&&(L=L.responseEnd,R+=ne*(L<k?1:(k-F)/(L-F)))}if(--d,a+=8*(b+R)/(v.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var yf=null,vf=null;function Qc(s){return s.nodeType===9?s:s.ownerDocument}function By(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Qy(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function bf(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var xf=null;function CM(){var s=window.event;return s&&s.type==="popstate"?s===xf?!1:(xf=s,!0):(xf=null,!1)}var Gy=typeof setTimeout=="function"?setTimeout:void 0,MM=typeof clearTimeout=="function"?clearTimeout:void 0,Fy=typeof Promise=="function"?Promise:void 0,EM=typeof queueMicrotask=="function"?queueMicrotask:typeof Fy<"u"?function(s){return Fy.resolve(null).then(s).catch(RM)}:Gy;function RM(s){setTimeout(function(){throw s})}function Ca(s){return s==="head"}function Vy(s,a){var c=a,d=0;do{var v=c.nextSibling;if(s.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"||c==="/&"){if(d===0){s.removeChild(v),sr(a);return}d--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")d++;else if(c==="html")ui(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,ui(c);for(var b=c.firstChild;b;){var R=b.nextSibling,k=b.nodeName;b[Ar]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&b.rel.toLowerCase()==="stylesheet"||c.removeChild(b),b=R}}else c==="body"&&ui(s.ownerDocument.body);c=v}while(c);sr(a)}function Ky(s,a){var c=s;s=0;do{var d=c.nextSibling;if(c.nodeType===1?a?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(a?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),d&&d.nodeType===8)if(c=d.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=d}while(c)}function wf(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var c=a;switch(a=a.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":wf(c),Eu(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function TM(s,a,c,d){for(;s.nodeType===1;){var v=c;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[Ar])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(b=s.getAttribute("rel"),b==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(b!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(b=s.getAttribute("src"),(b!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&b&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var b=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===b)return s}else return s;if(s=Un(s.nextSibling),s===null)break}return null}function AM(s,a,c){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Un(s.nextSibling),s===null))return null;return s}function Yy(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=Un(s.nextSibling),s===null))return null;return s}function Sf(s){return s.data==="$?"||s.data==="$~"}function Cf(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function NM(s,a){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||c.readyState!=="loading")a();else{var d=function(){a(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function Un(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var Mf=null;function Xy(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(a===0)return Un(s.nextSibling);a--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||a++}s=s.nextSibling}return null}function Wy(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(a===0)return s;a--}else c!=="/$"&&c!=="/&"||a++}s=s.previousSibling}return null}function Zy(s,a,c){switch(a=Qc(c),s){case"html":if(s=a.documentElement,!s)throw Error(n(452));return s;case"head":if(s=a.head,!s)throw Error(n(453));return s;case"body":if(s=a.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function ui(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);Eu(s)}var $n=new Map,Jy=new Set;function Gc(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Vs=j.d;j.d={f:kM,r:DM,D:jM,C:_M,L:zM,m:LM,X:PM,S:OM,M:IM};function kM(){var s=Vs.f(),a=Oc();return s||a}function DM(s){var a=So(s);a!==null&&a.tag===5&&a.type==="form"?mm(a):Vs.r(s)}var er=typeof document>"u"?null:document;function e0(s,a,c){var d=er;if(d&&typeof a=="string"&&a){var v=zn(a);v='link[rel="'+s+'"][href="'+v+'"]',typeof c=="string"&&(v+='[crossorigin="'+c+'"]'),Jy.has(v)||(Jy.add(v),s={rel:s,crossOrigin:c,href:a},d.querySelector(v)===null&&(a=d.createElement("link"),tn(a,"link",s),Vt(a),d.head.appendChild(a)))}}function jM(s){Vs.D(s),e0("dns-prefetch",s,null)}function _M(s,a){Vs.C(s,a),e0("preconnect",s,a)}function zM(s,a,c){Vs.L(s,a,c);var d=er;if(d&&s&&a){var v='link[rel="preload"][as="'+zn(a)+'"]';a==="image"&&c&&c.imageSrcSet?(v+='[imagesrcset="'+zn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(v+='[imagesizes="'+zn(c.imageSizes)+'"]')):v+='[href="'+zn(s)+'"]';var b=v;switch(a){case"style":b=tr(s);break;case"script":b=nr(s)}$n.has(b)||(s=m({rel:"preload",href:a==="image"&&c&&c.imageSrcSet?void 0:s,as:a},c),$n.set(b,s),d.querySelector(v)!==null||a==="style"&&d.querySelector(di(b))||a==="script"&&d.querySelector(fi(b))||(a=d.createElement("link"),tn(a,"link",s),Vt(a),d.head.appendChild(a)))}}function LM(s,a){Vs.m(s,a);var c=er;if(c&&s){var d=a&&typeof a.as=="string"?a.as:"script",v='link[rel="modulepreload"][as="'+zn(d)+'"][href="'+zn(s)+'"]',b=v;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=nr(s)}if(!$n.has(b)&&(s=m({rel:"modulepreload",href:s},a),$n.set(b,s),c.querySelector(v)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(fi(b)))return}d=c.createElement("link"),tn(d,"link",s),Vt(d),c.head.appendChild(d)}}}function OM(s,a,c){Vs.S(s,a,c);var d=er;if(d&&s){var v=Co(d).hoistableStyles,b=tr(s);a=a||"default";var R=v.get(b);if(!R){var k={loading:0,preload:null};if(R=d.querySelector(di(b)))k.loading=5;else{s=m({rel:"stylesheet",href:s,"data-precedence":a},c),(c=$n.get(b))&&Ef(s,c);var L=R=d.createElement("link");Vt(L),tn(L,"link",s),L._p=new Promise(function(F,ne){L.onload=F,L.onerror=ne}),L.addEventListener("load",function(){k.loading|=1}),L.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Fc(R,a,d)}R={type:"stylesheet",instance:R,count:1,state:k},v.set(b,R)}}}function PM(s,a){Vs.X(s,a);var c=er;if(c&&s){var d=Co(c).hoistableScripts,v=nr(s),b=d.get(v);b||(b=c.querySelector(fi(v)),b||(s=m({src:s,async:!0},a),(a=$n.get(v))&&Rf(s,a),b=c.createElement("script"),Vt(b),tn(b,"link",s),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(v,b))}}function IM(s,a){Vs.M(s,a);var c=er;if(c&&s){var d=Co(c).hoistableScripts,v=nr(s),b=d.get(v);b||(b=c.querySelector(fi(v)),b||(s=m({src:s,async:!0,type:"module"},a),(a=$n.get(v))&&Rf(s,a),b=c.createElement("script"),Vt(b),tn(b,"link",s),c.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},d.set(v,b))}}function t0(s,a,c,d){var v=(v=oe.current)?Gc(v):null;if(!v)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(a=tr(c.href),c=Co(v).hoistableStyles,d=c.get(a),d||(d={type:"style",instance:null,count:0,state:null},c.set(a,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=tr(c.href);var b=Co(v).hoistableStyles,R=b.get(s);if(R||(v=v.ownerDocument||v,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(s,R),(b=v.querySelector(di(s)))&&!b._p&&(R.instance=b,R.state.loading=5),$n.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},$n.set(s,c),b||qM(v,s,c,R.state))),a&&d===null)throw Error(n(528,""));return R}if(a&&d!==null)throw Error(n(529,""));return null;case"script":return a=c.async,c=c.src,typeof c=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=nr(c),c=Co(v).hoistableScripts,d=c.get(a),d||(d={type:"script",instance:null,count:0,state:null},c.set(a,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function tr(s){return'href="'+zn(s)+'"'}function di(s){return'link[rel="stylesheet"]['+s+"]"}function n0(s){return m({},s,{"data-precedence":s.precedence,precedence:null})}function qM(s,a,c,d){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?d.loading=1:(a=s.createElement("link"),d.preload=a,a.addEventListener("load",function(){return d.loading|=1}),a.addEventListener("error",function(){return d.loading|=2}),tn(a,"link",c),Vt(a),s.head.appendChild(a))}function nr(s){return'[src="'+zn(s)+'"]'}function fi(s){return"script[async]"+s}function s0(s,a,c){if(a.count++,a.instance===null)switch(a.type){case"style":var d=s.querySelector('style[data-href~="'+zn(c.href)+'"]');if(d)return a.instance=d,Vt(d),d;var v=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),Vt(d),tn(d,"style",v),Fc(d,c.precedence,s),a.instance=d;case"stylesheet":v=tr(c.href);var b=s.querySelector(di(v));if(b)return a.state.loading|=4,a.instance=b,Vt(b),b;d=n0(c),(v=$n.get(v))&&Ef(d,v),b=(s.ownerDocument||s).createElement("link"),Vt(b);var R=b;return R._p=new Promise(function(k,L){R.onload=k,R.onerror=L}),tn(b,"link",d),a.state.loading|=4,Fc(b,c.precedence,s),a.instance=b;case"script":return b=nr(c.src),(v=s.querySelector(fi(b)))?(a.instance=v,Vt(v),v):(d=c,(v=$n.get(b))&&(d=m({},c),Rf(d,v)),s=s.ownerDocument||s,v=s.createElement("script"),Vt(v),tn(v,"link",d),s.head.appendChild(v),a.instance=v);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(d=a.instance,a.state.loading|=4,Fc(d,c.precedence,s));return a.instance}function Fc(s,a,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=d.length?d[d.length-1]:null,b=v,R=0;R<d.length;R++){var k=d[R];if(k.dataset.precedence===a)b=k;else if(b!==v)break}b?b.parentNode.insertBefore(s,b.nextSibling):(a=c.nodeType===9?c.head:c,a.insertBefore(s,a.firstChild))}function Ef(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function Rf(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var Vc=null;function a0(s,a,c){if(Vc===null){var d=new Map,v=Vc=new Map;v.set(c,d)}else v=Vc,d=v.get(c),d||(d=new Map,v.set(c,d));if(d.has(s))return d;for(d.set(s,null),c=c.getElementsByTagName(s),v=0;v<c.length;v++){var b=c[v];if(!(b[Ar]||b[mt]||s==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var R=b.getAttribute(a)||"";R=s+R;var k=d.get(R);k?k.push(b):d.set(R,[b])}}return d}function o0(s,a,c){s=s.ownerDocument||s,s.head.insertBefore(c,a==="title"?s.querySelector("head > title"):null)}function HM(s,a,c){if(c===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function r0(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function UM(s,a,c,d){if(c.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var v=tr(d.href),b=a.querySelector(di(v));if(b){a=b._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=Kc.bind(s),a.then(s,s)),c.state.loading|=4,c.instance=b,Vt(b);return}b=a.ownerDocument||a,d=n0(d),(v=$n.get(v))&&Ef(d,v),b=b.createElement("link"),Vt(b);var R=b;R._p=new Promise(function(k,L){R.onload=k,R.onerror=L}),tn(b,"link",d),c.instance=b}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,a),(a=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=Kc.bind(s),a.addEventListener("load",c),a.addEventListener("error",c))}}var Tf=0;function $M(s,a){return s.stylesheets&&s.count===0&&Xc(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var d=setTimeout(function(){if(s.stylesheets&&Xc(s,s.stylesheets),s.unsuspend){var b=s.unsuspend;s.unsuspend=null,b()}},6e4+a);0<s.imgBytes&&Tf===0&&(Tf=62500*SM());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Xc(s,s.stylesheets),s.unsuspend)){var b=s.unsuspend;s.unsuspend=null,b()}},(s.imgBytes>Tf?50:800)+a);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(d),clearTimeout(v)}}:null}function Kc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Xc(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Yc=null;function Xc(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Yc=new Map,a.forEach(BM,s),Yc=null,Kc.call(s))}function BM(s,a){if(!(a.state.loading&4)){var c=Yc.get(s);if(c)var d=c.get(null);else{c=new Map,Yc.set(s,c);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<v.length;b++){var R=v[b];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(c.set(R.dataset.precedence,R),d=R)}d&&c.set(null,d)}v=a.instance,R=v.getAttribute("data-precedence"),b=c.get(R)||d,b===d&&c.set(null,v),c.set(R,v),this.count++,d=Kc.bind(this),v.addEventListener("load",d),v.addEventListener("error",d),b?b.parentNode.insertBefore(v,b.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),a.state.loading|=4}}var hi={$$typeof:T,Provider:null,Consumer:null,_currentValue:O,_currentValue2:O,_threadCount:0};function QM(s,a,c,d,v,b,R,k,L){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=fe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=fe(0),this.hiddenUpdates=fe(null),this.identifierPrefix=d,this.onUncaughtError=v,this.onCaughtError=b,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function i0(s,a,c,d,v,b,R,k,L,F,ne,ie){return s=new QM(s,a,c,R,L,F,ne,ie,k),a=1,b===!0&&(a|=24),b=wn(3,null,null,a),s.current=b,b.stateNode=s,a=od(),a.refCount++,s.pooledCache=a,a.refCount++,b.memoizedState={element:d,isDehydrated:c,cache:a},ld(b),s}function c0(s){return s?(s=_o,s):_o}function l0(s,a,c,d,v,b){v=c0(v),d.context===null?d.context=v:d.pendingContext=v,d=fa(a),d.payload={element:c},b=b===void 0?null:b,b!==null&&(d.callback=b),c=ha(s,d,a),c!==null&&(yn(c,s,a),Gr(c,s,a))}function u0(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<a?c:a}}function Af(s,a){u0(s,a),(s=s.alternate)&&u0(s,a)}function d0(s){if(s.tag===13||s.tag===31){var a=Ka(s,67108864);a!==null&&yn(a,s,67108864),Af(s,67108864)}}function f0(s){if(s.tag===13||s.tag===31){var a=Rn();a=Wt(a);var c=Ka(s,a);c!==null&&yn(c,s,a),Af(s,a)}}var Wc=!0;function GM(s,a,c,d){var v=z.T;z.T=null;var b=j.p;try{j.p=2,Nf(s,a,c,d)}finally{j.p=b,z.T=v}}function FM(s,a,c,d){var v=z.T;z.T=null;var b=j.p;try{j.p=8,Nf(s,a,c,d)}finally{j.p=b,z.T=v}}function Nf(s,a,c,d){if(Wc){var v=kf(d);if(v===null)gf(s,a,d,Zc,c),p0(s,d);else if(KM(v,s,a,c,d))d.stopPropagation();else if(p0(s,d),a&4&&-1<VM.indexOf(s)){for(;v!==null;){var b=So(v);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var R=Xn(b.pendingLanes);if(R!==0){var k=b;for(k.pendingLanes|=2,k.entangledLanes|=2;R;){var L=1<<31-_t(R);k.entanglements[1]|=L,R&=~L}ds(b),(nt&6)===0&&(zc=Je()+500,ii(0))}}break;case 31:case 13:k=Ka(b,2),k!==null&&yn(k,b,2),Oc(),Af(b,2)}if(b=kf(d),b===null&&gf(s,a,d,Zc,c),b===v)break;v=b}v!==null&&d.stopPropagation()}else gf(s,a,d,null,c)}}function kf(s){return s=Du(s),Df(s)}var Zc=null;function Df(s){if(Zc=null,s=wo(s),s!==null){var a=i(s);if(a===null)s=null;else{var c=a.tag;if(c===13){if(s=l(a),s!==null)return s;s=null}else if(c===31){if(s=u(a),s!==null)return s;s=null}else if(c===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return Zc=s,null}function h0(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(jt()){case vt:return 2;case gt:return 8;case Yt:case Gt:return 32;case Rs:return 268435456;default:return 32}default:return 32}}var jf=!1,Ma=null,Ea=null,Ra=null,pi=new Map,gi=new Map,Ta=[],VM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function p0(s,a){switch(s){case"focusin":case"focusout":Ma=null;break;case"dragenter":case"dragleave":Ea=null;break;case"mouseover":case"mouseout":Ra=null;break;case"pointerover":case"pointerout":pi.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":gi.delete(a.pointerId)}}function mi(s,a,c,d,v,b){return s===null||s.nativeEvent!==b?(s={blockedOn:a,domEventName:c,eventSystemFlags:d,nativeEvent:b,targetContainers:[v]},a!==null&&(a=So(a),a!==null&&d0(a)),s):(s.eventSystemFlags|=d,a=s.targetContainers,v!==null&&a.indexOf(v)===-1&&a.push(v),s)}function KM(s,a,c,d,v){switch(a){case"focusin":return Ma=mi(Ma,s,a,c,d,v),!0;case"dragenter":return Ea=mi(Ea,s,a,c,d,v),!0;case"mouseover":return Ra=mi(Ra,s,a,c,d,v),!0;case"pointerover":var b=v.pointerId;return pi.set(b,mi(pi.get(b)||null,s,a,c,d,v)),!0;case"gotpointercapture":return b=v.pointerId,gi.set(b,mi(gi.get(b)||null,s,a,c,d,v)),!0}return!1}function g0(s){var a=wo(s.target);if(a!==null){var c=i(a);if(c!==null){if(a=c.tag,a===13){if(a=l(c),a!==null){s.blockedOn=a,wt(s.priority,function(){f0(c)});return}}else if(a===31){if(a=u(c),a!==null){s.blockedOn=a,wt(s.priority,function(){f0(c)});return}}else if(a===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Jc(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var c=kf(s.nativeEvent);if(c===null){c=s.nativeEvent;var d=new c.constructor(c.type,c);ku=d,c.target.dispatchEvent(d),ku=null}else return a=So(c),a!==null&&d0(a),s.blockedOn=c,!1;a.shift()}return!0}function m0(s,a,c){Jc(s)&&c.delete(a)}function YM(){jf=!1,Ma!==null&&Jc(Ma)&&(Ma=null),Ea!==null&&Jc(Ea)&&(Ea=null),Ra!==null&&Jc(Ra)&&(Ra=null),pi.forEach(m0),gi.forEach(m0)}function el(s,a){s.blockedOn===a&&(s.blockedOn=null,jf||(jf=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,YM)))}var tl=null;function y0(s){tl!==s&&(tl=s,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){tl===s&&(tl=null);for(var a=0;a<s.length;a+=3){var c=s[a],d=s[a+1],v=s[a+2];if(typeof d!="function"){if(Df(d||c)===null)continue;break}var b=So(c);b!==null&&(s.splice(a,3),a-=3,Nd(b,{pending:!0,data:v,method:c.method,action:d},d,v))}}))}function sr(s){function a(L){return el(L,s)}Ma!==null&&el(Ma,s),Ea!==null&&el(Ea,s),Ra!==null&&el(Ra,s),pi.forEach(a),gi.forEach(a);for(var c=0;c<Ta.length;c++){var d=Ta[c];d.blockedOn===s&&(d.blockedOn=null)}for(;0<Ta.length&&(c=Ta[0],c.blockedOn===null);)g0(c),c.blockedOn===null&&Ta.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var v=c[d],b=c[d+1],R=v[Ht]||null;if(typeof b=="function")R||y0(c);else if(R){var k=null;if(b&&b.hasAttribute("formAction")){if(v=b,R=b[Ht]||null)k=R.formAction;else if(Df(v)!==null)continue}else k=R.action;typeof k=="function"?c[d+1]=k:(c.splice(d,3),d-=3),y0(c)}}}function v0(){function s(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(R){return v=R})},focusReset:"manual",scroll:"manual"})}function a(){v!==null&&(v(),v=null),d||setTimeout(c,20)}function c(){if(!d&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(c,100),function(){d=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),v!==null&&(v(),v=null)}}}function _f(s){this._internalRoot=s}nl.prototype.render=_f.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(n(409));var c=a.current,d=Rn();l0(c,d,s,a,null,null)},nl.prototype.unmount=_f.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;l0(s.current,2,null,s,null,null),Oc(),a[is]=null}};function nl(s){this._internalRoot=s}nl.prototype.unstable_scheduleHydration=function(s){if(s){var a=cn();s={blockedOn:null,target:s,priority:a};for(var c=0;c<Ta.length&&a!==0&&a<Ta[c].priority;c++);Ta.splice(c,0,s),c===0&&g0(s)}};var b0=e.version;if(b0!=="19.2.0")throw Error(n(527,b0,"19.2.0"));j.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=p(a),s=s!==null?g(s):null,s=s===null?null:s.stateNode,s};var XM={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sl.isDisabled&&sl.supportsFiber)try{rs=sl.inject(XM),Xt=sl}catch{}}return vi.createRoot=function(s,a){if(!o(s))throw Error(n(299));var c=!1,d="",v=Rm,b=Tm,R=Am;return a!=null&&(a.unstable_strictMode===!0&&(c=!0),a.identifierPrefix!==void 0&&(d=a.identifierPrefix),a.onUncaughtError!==void 0&&(v=a.onUncaughtError),a.onCaughtError!==void 0&&(b=a.onCaughtError),a.onRecoverableError!==void 0&&(R=a.onRecoverableError)),a=i0(s,1,!1,null,null,c,d,null,v,b,R,v0),s[is]=a.current,pf(s),new _f(a)},vi.hydrateRoot=function(s,a,c){if(!o(s))throw Error(n(299));var d=!1,v="",b=Rm,R=Tm,k=Am,L=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onUncaughtError!==void 0&&(b=c.onUncaughtError),c.onCaughtError!==void 0&&(R=c.onCaughtError),c.onRecoverableError!==void 0&&(k=c.onRecoverableError),c.formState!==void 0&&(L=c.formState)),a=i0(s,1,!0,a,c??null,d,v,L,b,R,k,v0),a.context=c0(null),c=a.current,d=Rn(),d=Wt(d),v=fa(d),v.callback=null,ha(c,v,d),c=d,a.current.lanes=c,be(a,c),ds(a),s[is]=a.current,pf(s),new nl(a)},vi.version="19.2.0",vi}var N0;function rE(){if(N0)return Of.exports;N0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Of.exports=oE(),Of.exports}var iE=rE();const cE=Th(iE);let lE={data:""},uE=r=>{if(typeof window=="object"){let e=(r?r.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(r||document.head).appendChild(e),e.firstChild}return r||lE},dE=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,fE=/\/\*[^]*?\*\/|  +/g,k0=/\n+/g,Da=(r,e)=>{let t="",n="",o="";for(let i in r){let l=r[i];i[0]=="@"?i[1]=="i"?t=i+" "+l+";":n+=i[1]=="f"?Da(l,i):i+"{"+Da(l,i[1]=="k"?"":e)+"}":typeof l=="object"?n+=Da(l,e?e.replace(/([^,])+/g,u=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,f=>/&/.test(f)?f.replace(/&/g,u):u?u+" "+f:f)):i):l!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),o+=Da.p?Da.p(i,l):i+":"+l+";")}return t+(e&&o?e+"{"+o+"}":o)+n},Ks={},jv=r=>{if(typeof r=="object"){let e="";for(let t in r)e+=t+jv(r[t]);return e}return r},hE=(r,e,t,n,o)=>{let i=jv(r),l=Ks[i]||(Ks[i]=(f=>{let p=0,g=11;for(;p<f.length;)g=101*g+f.charCodeAt(p++)>>>0;return"go"+g})(i));if(!Ks[l]){let f=i!==r?r:(p=>{let g,m,y=[{}];for(;g=dE.exec(p.replace(fE,""));)g[4]?y.shift():g[3]?(m=g[3].replace(k0," ").trim(),y.unshift(y[0][m]=y[0][m]||{})):y[0][g[1]]=g[2].replace(k0," ").trim();return y[0]})(r);Ks[l]=Da(o?{["@keyframes "+l]:f}:f,t?"":"."+l)}let u=t&&Ks.g?Ks.g:null;return t&&(Ks.g=Ks[l]),((f,p,g,m)=>{m?p.data=p.data.replace(m,f):p.data.indexOf(f)===-1&&(p.data=g?f+p.data:p.data+f)})(Ks[l],e,n,u),l},pE=(r,e,t)=>r.reduce((n,o,i)=>{let l=e[i];if(l&&l.call){let u=l(t),f=u&&u.props&&u.props.className||/^go/.test(u)&&u;l=f?"."+f:u&&typeof u=="object"?u.props?"":Da(u,""):u===!1?"":u}return n+o+(l??"")},"");function ql(r){let e=this||{},t=r.call?r(e.p):r;return hE(t.unshift?t.raw?pE(t,[].slice.call(arguments,1),e.p):t.reduce((n,o)=>Object.assign(n,o&&o.call?o(e.p):o),{}):t,uE(e.target),e.g,e.o,e.k)}let _v,oh,rh;ql.bind({g:1});let ea=ql.bind({k:1});function gE(r,e,t,n){Da.p=e,_v=r,oh=t,rh=n}function Pa(r,e){let t=this||{};return function(){let n=arguments;function o(i,l){let u=Object.assign({},i),f=u.className||o.className;t.p=Object.assign({theme:oh&&oh()},u),t.o=/ *go\d+/.test(f),u.className=ql.apply(t,n)+(f?" "+f:"");let p=r;return r[0]&&(p=u.as||r,delete u.as),rh&&p[0]&&rh(u),_v(p,u)}return o}}var mE=r=>typeof r=="function",Ml=(r,e)=>mE(r)?r(e):r,yE=(()=>{let r=0;return()=>(++r).toString()})(),zv=(()=>{let r;return()=>{if(r===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");r=!e||e.matches}return r}})(),vE=20,kh="default",Lv=(r,e)=>{let{toastLimit:t}=r.settings;switch(e.type){case 0:return{...r,toasts:[e.toast,...r.toasts].slice(0,t)};case 1:return{...r,toasts:r.toasts.map(l=>l.id===e.toast.id?{...l,...e.toast}:l)};case 2:let{toast:n}=e;return Lv(r,{type:r.toasts.find(l=>l.id===n.id)?1:0,toast:n});case 3:let{toastId:o}=e;return{...r,toasts:r.toasts.map(l=>l.id===o||o===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return e.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(l=>l.id!==e.toastId)};case 5:return{...r,pausedAt:e.time};case 6:let i=e.time-(r.pausedAt||0);return{...r,pausedAt:void 0,toasts:r.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+i}))}}},yl=[],Ov={toasts:[],pausedAt:void 0,settings:{toastLimit:vE}},ps={},Pv=(r,e=kh)=>{ps[e]=Lv(ps[e]||Ov,r),yl.forEach(([t,n])=>{t===e&&n(ps[e])})},Iv=r=>Object.keys(ps).forEach(e=>Pv(r,e)),bE=r=>Object.keys(ps).find(e=>ps[e].toasts.some(t=>t.id===r)),Hl=(r=kh)=>e=>{Pv(e,r)},xE={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},wE=(r={},e=kh)=>{let[t,n]=w.useState(ps[e]||Ov),o=w.useRef(ps[e]);w.useEffect(()=>(o.current!==ps[e]&&n(ps[e]),yl.push([e,n]),()=>{let l=yl.findIndex(([u])=>u===e);l>-1&&yl.splice(l,1)}),[e]);let i=t.toasts.map(l=>{var u,f,p;return{...r,...r[l.type],...l,removeDelay:l.removeDelay||((u=r[l.type])==null?void 0:u.removeDelay)||r?.removeDelay,duration:l.duration||((f=r[l.type])==null?void 0:f.duration)||r?.duration||xE[l.type],style:{...r.style,...(p=r[l.type])==null?void 0:p.style,...l.style}}});return{...t,toasts:i}},SE=(r,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:r,pauseDuration:0,...t,id:t?.id||yE()}),_i=r=>(e,t)=>{let n=SE(e,r,t);return Hl(n.toasterId||bE(n.id))({type:2,toast:n}),n.id},Bt=(r,e)=>_i("blank")(r,e);Bt.error=_i("error");Bt.success=_i("success");Bt.loading=_i("loading");Bt.custom=_i("custom");Bt.dismiss=(r,e)=>{let t={type:3,toastId:r};e?Hl(e)(t):Iv(t)};Bt.dismissAll=r=>Bt.dismiss(void 0,r);Bt.remove=(r,e)=>{let t={type:4,toastId:r};e?Hl(e)(t):Iv(t)};Bt.removeAll=r=>Bt.remove(void 0,r);Bt.promise=(r,e,t)=>{let n=Bt.loading(e.loading,{...t,...t?.loading});return typeof r=="function"&&(r=r()),r.then(o=>{let i=e.success?Ml(e.success,o):void 0;return i?Bt.success(i,{id:n,...t,...t?.success}):Bt.dismiss(n),o}).catch(o=>{let i=e.error?Ml(e.error,o):void 0;i?Bt.error(i,{id:n,...t,...t?.error}):Bt.dismiss(n)}),r};var CE=1e3,ME=(r,e="default")=>{let{toasts:t,pausedAt:n}=wE(r,e),o=w.useRef(new Map).current,i=w.useCallback((m,y=CE)=>{if(o.has(m))return;let x=setTimeout(()=>{o.delete(m),l({type:4,toastId:m})},y);o.set(m,x)},[]);w.useEffect(()=>{if(n)return;let m=Date.now(),y=t.map(x=>{if(x.duration===1/0)return;let S=(x.duration||0)+x.pauseDuration-(m-x.createdAt);if(S<0){x.visible&&Bt.dismiss(x.id);return}return setTimeout(()=>Bt.dismiss(x.id,e),S)});return()=>{y.forEach(x=>x&&clearTimeout(x))}},[t,n,e]);let l=w.useCallback(Hl(e),[e]),u=w.useCallback(()=>{l({type:5,time:Date.now()})},[l]),f=w.useCallback((m,y)=>{l({type:1,toast:{id:m,height:y}})},[l]),p=w.useCallback(()=>{n&&l({type:6,time:Date.now()})},[n,l]),g=w.useCallback((m,y)=>{let{reverseOrder:x=!1,gutter:S=8,defaultPosition:C}=y||{},E=t.filter(T=>(T.position||C)===(m.position||C)&&T.height),M=E.findIndex(T=>T.id===m.id),A=E.filter((T,N)=>N<M&&T.visible).length;return E.filter(T=>T.visible).slice(...x?[A+1]:[0,A]).reduce((T,N)=>T+(N.height||0)+S,0)},[t]);return w.useEffect(()=>{t.forEach(m=>{if(m.dismissed)i(m.id,m.removeDelay);else{let y=o.get(m.id);y&&(clearTimeout(y),o.delete(m.id))}})},[t,i]),{toasts:t,handlers:{updateHeight:f,startPause:u,endPause:p,calculateOffset:g}}},EE=ea`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,RE=ea`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,TE=ea`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,AE=Pa("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${EE} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${RE} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${r=>r.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${TE} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,NE=ea`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,kE=Pa("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${r=>r.secondary||"#e0e0e0"};
  border-right-color: ${r=>r.primary||"#616161"};
  animation: ${NE} 1s linear infinite;
`,DE=ea`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,jE=ea`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,_E=Pa("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${r=>r.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${DE} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${jE} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${r=>r.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,zE=Pa("div")`
  position: absolute;
`,LE=Pa("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,OE=ea`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,PE=Pa("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${OE} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,IE=({toast:r})=>{let{icon:e,type:t,iconTheme:n}=r;return e!==void 0?typeof e=="string"?w.createElement(PE,null,e):e:t==="blank"?null:w.createElement(LE,null,w.createElement(kE,{...n}),t!=="loading"&&w.createElement(zE,null,t==="error"?w.createElement(AE,{...n}):w.createElement(_E,{...n})))},qE=r=>`
0% {transform: translate3d(0,${r*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,HE=r=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${r*-150}%,-1px) scale(.6); opacity:0;}
`,UE="0%{opacity:0;} 100%{opacity:1;}",$E="0%{opacity:1;} 100%{opacity:0;}",BE=Pa("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,QE=Pa("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,GE=(r,e)=>{let t=r.includes("top")?1:-1,[n,o]=zv()?[UE,$E]:[qE(t),HE(t)];return{animation:e?`${ea(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ea(o)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},FE=w.memo(({toast:r,position:e,style:t,children:n})=>{let o=r.height?GE(r.position||e||"top-center",r.visible):{opacity:0},i=w.createElement(IE,{toast:r}),l=w.createElement(QE,{...r.ariaProps},Ml(r.message,r));return w.createElement(BE,{className:r.className,style:{...o,...t,...r.style}},typeof n=="function"?n({icon:i,message:l}):w.createElement(w.Fragment,null,i,l))});gE(w.createElement);var VE=({id:r,className:e,style:t,onHeightUpdate:n,children:o})=>{let i=w.useCallback(l=>{if(l){let u=()=>{let f=l.getBoundingClientRect().height;n(r,f)};u(),new MutationObserver(u).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[r,n]);return w.createElement("div",{ref:i,className:e,style:t},o)},KE=(r,e)=>{let t=r.includes("top"),n=t?{top:0}:{bottom:0},o=r.includes("center")?{justifyContent:"center"}:r.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:zv()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...n,...o}},YE=ql`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,al=16,XE=({reverseOrder:r,position:e="top-center",toastOptions:t,gutter:n,children:o,toasterId:i,containerStyle:l,containerClassName:u})=>{let{toasts:f,handlers:p}=ME(t,i);return w.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:al,left:al,right:al,bottom:al,pointerEvents:"none",...l},className:u,onMouseEnter:p.startPause,onMouseLeave:p.endPause},f.map(g=>{let m=g.position||e,y=p.calculateOffset(g,{reverseOrder:r,gutter:n,defaultPosition:e}),x=KE(m,y);return w.createElement(VE,{id:g.id,key:g.id,onHeightUpdate:p.updateHeight,className:g.visible?YE:"",style:x},g.type==="custom"?Ml(g.message,g):o?o(g):w.createElement(FE,{toast:g,position:m}))}))},p3=Bt;function D0(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function Ss(...r){return e=>{let t=!1;const n=r.map(o=>{const i=D0(o,e);return!t&&typeof i=="function"&&(t=!0),i});if(t)return()=>{for(let o=0;o<n.length;o++){const i=n[o];typeof i=="function"?i():D0(r[o],null)}}}}function je(...r){return w.useCallback(Ss(...r),r)}var WE=Symbol.for("react.lazy"),El=Nh[" use ".trim().toString()];function ZE(r){return typeof r=="object"&&r!==null&&"then"in r}function qv(r){return r!=null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===WE&&"_payload"in r&&ZE(r._payload)}function Dh(r){const e=eR(r),t=w.forwardRef((n,o)=>{let{children:i,...l}=n;qv(i)&&typeof El=="function"&&(i=El(i._payload));const u=w.Children.toArray(i),f=u.find(nR);if(f){const p=f.props.children,g=u.map(m=>m===f?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:m);return h.jsx(e,{...l,ref:o,children:w.isValidElement(p)?w.cloneElement(p,void 0,g):null})}return h.jsx(e,{...l,ref:o,children:i})});return t.displayName=`${r}.Slot`,t}var JE=Dh("Slot");function eR(r){const e=w.forwardRef((t,n)=>{let{children:o,...i}=t;if(qv(o)&&typeof El=="function"&&(o=El(o._payload)),w.isValidElement(o)){const l=aR(o),u=sR(i,o.props);return o.type!==w.Fragment&&(u.ref=n?Ss(n,l):l),w.cloneElement(o,u)}return w.Children.count(o)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var tR=Symbol("radix.slottable");function nR(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===tR}function sR(r,e){const t={...e};for(const n in e){const o=r[n],i=e[n];/^on[A-Z]/.test(n)?o&&i?t[n]=(...u)=>{const f=i(...u);return o(...u),f}:o&&(t[n]=o):n==="style"?t[n]={...o,...i}:n==="className"&&(t[n]=[o,i].filter(Boolean).join(" "))}return{...r,...t}}function aR(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function Hv(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var o=r.length;for(e=0;e<o;e++)r[e]&&(t=Hv(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Uv(){for(var r,e,t=0,n="",o=arguments.length;t<o;t++)(r=arguments[t])&&(e=Hv(r))&&(n&&(n+=" "),n+=e);return n}const j0=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,_0=Uv,jh=(r,e)=>t=>{var n;if(e?.variants==null)return _0(r,t?.class,t?.className);const{variants:o,defaultVariants:i}=e,l=Object.keys(o).map(p=>{const g=t?.[p],m=i?.[p];if(g===null)return null;const y=j0(g)||j0(m);return o[p][y]}),u=t&&Object.entries(t).reduce((p,g)=>{let[m,y]=g;return y===void 0||(p[m]=y),p},{}),f=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((p,g)=>{let{class:m,className:y,...x}=g;return Object.entries(x).every(S=>{let[C,E]=S;return Array.isArray(E)?E.includes({...i,...u}[C]):{...i,...u}[C]===E})?[...p,m,y]:p},[]);return _0(r,l,f,t?.class,t?.className)},oR=(r,e)=>{const t=new Array(r.length+e.length);for(let n=0;n<r.length;n++)t[n]=r[n];for(let n=0;n<e.length;n++)t[r.length+n]=e[n];return t},rR=(r,e)=>({classGroupId:r,validator:e}),$v=(r=new Map,e=null,t)=>({nextPart:r,validators:e,classGroupId:t}),Rl="-",z0=[],iR="arbitrary..",cR=r=>{const e=uR(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=r;return{getClassGroupId:l=>{if(l.startsWith("[")&&l.endsWith("]"))return lR(l);const u=l.split(Rl),f=u[0]===""&&u.length>1?1:0;return Bv(u,f,e)},getConflictingClassGroupIds:(l,u)=>{if(u){const f=n[l],p=t[l];return f?p?oR(p,f):f:p||z0}return t[l]||z0}}},Bv=(r,e,t)=>{if(r.length-e===0)return t.classGroupId;const o=r[e],i=t.nextPart.get(o);if(i){const p=Bv(r,e+1,i);if(p)return p}const l=t.validators;if(l===null)return;const u=e===0?r.join(Rl):r.slice(e).join(Rl),f=l.length;for(let p=0;p<f;p++){const g=l[p];if(g.validator(u))return g.classGroupId}},lR=r=>r.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const e=r.slice(1,-1),t=e.indexOf(":"),n=e.slice(0,t);return n?iR+n:void 0})(),uR=r=>{const{theme:e,classGroups:t}=r;return dR(t,e)},dR=(r,e)=>{const t=$v();for(const n in r){const o=r[n];_h(o,t,n,e)}return t},_h=(r,e,t,n)=>{const o=r.length;for(let i=0;i<o;i++){const l=r[i];fR(l,e,t,n)}},fR=(r,e,t,n)=>{if(typeof r=="string"){hR(r,e,t);return}if(typeof r=="function"){pR(r,e,t,n);return}gR(r,e,t,n)},hR=(r,e,t)=>{const n=r===""?e:Qv(e,r);n.classGroupId=t},pR=(r,e,t,n)=>{if(mR(r)){_h(r(n),e,t,n);return}e.validators===null&&(e.validators=[]),e.validators.push(rR(t,r))},gR=(r,e,t,n)=>{const o=Object.entries(r),i=o.length;for(let l=0;l<i;l++){const[u,f]=o[l];_h(f,Qv(e,u),t,n)}},Qv=(r,e)=>{let t=r;const n=e.split(Rl),o=n.length;for(let i=0;i<o;i++){const l=n[i];let u=t.nextPart.get(l);u||(u=$v(),t.nextPart.set(l,u)),t=u}return t},mR=r=>"isThemeGetter"in r&&r.isThemeGetter===!0,yR=r=>{if(r<1)return{get:()=>{},set:()=>{}};let e=0,t=Object.create(null),n=Object.create(null);const o=(i,l)=>{t[i]=l,e++,e>r&&(e=0,n=t,t=Object.create(null))};return{get(i){let l=t[i];if(l!==void 0)return l;if((l=n[i])!==void 0)return o(i,l),l},set(i,l){i in t?t[i]=l:o(i,l)}}},ih="!",L0=":",vR=[],O0=(r,e,t,n,o)=>({modifiers:r,hasImportantModifier:e,baseClassName:t,maybePostfixModifierPosition:n,isExternal:o}),bR=r=>{const{prefix:e,experimentalParseClassName:t}=r;let n=o=>{const i=[];let l=0,u=0,f=0,p;const g=o.length;for(let C=0;C<g;C++){const E=o[C];if(l===0&&u===0){if(E===L0){i.push(o.slice(f,C)),f=C+1;continue}if(E==="/"){p=C;continue}}E==="["?l++:E==="]"?l--:E==="("?u++:E===")"&&u--}const m=i.length===0?o:o.slice(f);let y=m,x=!1;m.endsWith(ih)?(y=m.slice(0,-1),x=!0):m.startsWith(ih)&&(y=m.slice(1),x=!0);const S=p&&p>f?p-f:void 0;return O0(i,x,y,S)};if(e){const o=e+L0,i=n;n=l=>l.startsWith(o)?i(l.slice(o.length)):O0(vR,!1,l,void 0,!0)}if(t){const o=n;n=i=>t({className:i,parseClassName:o})}return n},xR=r=>{const e=new Map;return r.orderSensitiveModifiers.forEach((t,n)=>{e.set(t,1e6+n)}),t=>{const n=[];let o=[];for(let i=0;i<t.length;i++){const l=t[i],u=l[0]==="[",f=e.has(l);u||f?(o.length>0&&(o.sort(),n.push(...o),o=[]),n.push(l)):o.push(l)}return o.length>0&&(o.sort(),n.push(...o)),n}},wR=r=>({cache:yR(r.cacheSize),parseClassName:bR(r),sortModifiers:xR(r),...cR(r)}),SR=/\s+/,CR=(r,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:o,sortModifiers:i}=e,l=[],u=r.trim().split(SR);let f="";for(let p=u.length-1;p>=0;p-=1){const g=u[p],{isExternal:m,modifiers:y,hasImportantModifier:x,baseClassName:S,maybePostfixModifierPosition:C}=t(g);if(m){f=g+(f.length>0?" "+f:f);continue}let E=!!C,M=n(E?S.substring(0,C):S);if(!M){if(!E){f=g+(f.length>0?" "+f:f);continue}if(M=n(S),!M){f=g+(f.length>0?" "+f:f);continue}E=!1}const A=y.length===0?"":y.length===1?y[0]:i(y).join(":"),T=x?A+ih:A,N=T+M;if(l.indexOf(N)>-1)continue;l.push(N);const D=o(M,E);for(let q=0;q<D.length;++q){const P=D[q];l.push(T+P)}f=g+(f.length>0?" "+f:f)}return f},MR=(...r)=>{let e=0,t,n,o="";for(;e<r.length;)(t=r[e++])&&(n=Gv(t))&&(o&&(o+=" "),o+=n);return o},Gv=r=>{if(typeof r=="string")return r;let e,t="";for(let n=0;n<r.length;n++)r[n]&&(e=Gv(r[n]))&&(t&&(t+=" "),t+=e);return t},ER=(r,...e)=>{let t,n,o,i;const l=f=>{const p=e.reduce((g,m)=>m(g),r());return t=wR(p),n=t.cache.get,o=t.cache.set,i=u,u(f)},u=f=>{const p=n(f);if(p)return p;const g=CR(f,t);return o(f,g),g};return i=l,(...f)=>i(MR(...f))},RR=[],$t=r=>{const e=t=>t[r]||RR;return e.isThemeGetter=!0,e},Fv=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Vv=/^\((?:(\w[\w-]*):)?(.+)\)$/i,TR=/^\d+\/\d+$/,AR=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,NR=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,kR=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,DR=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,jR=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ar=r=>TR.test(r),qe=r=>!!r&&!Number.isNaN(Number(r)),Na=r=>!!r&&Number.isInteger(Number(r)),Hf=r=>r.endsWith("%")&&qe(r.slice(0,-1)),Ys=r=>AR.test(r),_R=()=>!0,zR=r=>NR.test(r)&&!kR.test(r),Kv=()=>!1,LR=r=>DR.test(r),OR=r=>jR.test(r),PR=r=>!we(r)&&!Se(r),IR=r=>xr(r,Wv,Kv),we=r=>Fv.test(r),io=r=>xr(r,Zv,zR),Uf=r=>xr(r,BR,qe),P0=r=>xr(r,Yv,Kv),qR=r=>xr(r,Xv,OR),ol=r=>xr(r,Jv,LR),Se=r=>Vv.test(r),bi=r=>wr(r,Zv),HR=r=>wr(r,QR),I0=r=>wr(r,Yv),UR=r=>wr(r,Wv),$R=r=>wr(r,Xv),rl=r=>wr(r,Jv,!0),xr=(r,e,t)=>{const n=Fv.exec(r);return n?n[1]?e(n[1]):t(n[2]):!1},wr=(r,e,t=!1)=>{const n=Vv.exec(r);return n?n[1]?e(n[1]):t:!1},Yv=r=>r==="position"||r==="percentage",Xv=r=>r==="image"||r==="url",Wv=r=>r==="length"||r==="size"||r==="bg-size",Zv=r=>r==="length",BR=r=>r==="number",QR=r=>r==="family-name",Jv=r=>r==="shadow",GR=()=>{const r=$t("color"),e=$t("font"),t=$t("text"),n=$t("font-weight"),o=$t("tracking"),i=$t("leading"),l=$t("breakpoint"),u=$t("container"),f=$t("spacing"),p=$t("radius"),g=$t("shadow"),m=$t("inset-shadow"),y=$t("text-shadow"),x=$t("drop-shadow"),S=$t("blur"),C=$t("perspective"),E=$t("aspect"),M=$t("ease"),A=$t("animate"),T=()=>["auto","avoid","all","avoid-page","page","left","right","column"],N=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],D=()=>[...N(),Se,we],q=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto","contain","none"],H=()=>[Se,we,f],J=()=>[ar,"full","auto",...H()],se=()=>[Na,"none","subgrid",Se,we],ce=()=>["auto",{span:["full",Na,Se,we]},Na,Se,we],Z=()=>[Na,"auto",Se,we],te=()=>["auto","min","max","fr",Se,we],le=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],ue=()=>["start","end","center","stretch","center-safe","end-safe"],z=()=>["auto",...H()],j=()=>[ar,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...H()],O=()=>[r,Se,we],X=()=>[...N(),I0,P0,{position:[Se,we]}],he=()=>["no-repeat",{repeat:["","x","y","space","round"]}],_=()=>["auto","cover","contain",UR,IR,{size:[Se,we]}],Q=()=>[Hf,bi,io],Y=()=>["","none","full",p,Se,we],ae=()=>["",qe,bi,io],B=()=>["solid","dashed","dotted","double"],oe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],$=()=>[qe,Hf,I0,P0],V=()=>["","none",S,Se,we],pe=()=>["none",qe,Se,we],me=()=>["none",qe,Se,we],ye=()=>[qe,Se,we],ve=()=>[ar,"full",...H()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ys],breakpoint:[Ys],color:[_R],container:[Ys],"drop-shadow":[Ys],ease:["in","out","in-out"],font:[PR],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ys],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ys],shadow:[Ys],spacing:["px",qe],text:[Ys],"text-shadow":[Ys],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ar,we,Se,E]}],container:["container"],columns:[{columns:[qe,we,Se,u]}],"break-after":[{"break-after":T()}],"break-before":[{"break-before":T()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:D()}],overflow:[{overflow:q()}],"overflow-x":[{"overflow-x":q()}],"overflow-y":[{"overflow-y":q()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:J()}],"inset-x":[{"inset-x":J()}],"inset-y":[{"inset-y":J()}],start:[{start:J()}],end:[{end:J()}],top:[{top:J()}],right:[{right:J()}],bottom:[{bottom:J()}],left:[{left:J()}],visibility:["visible","invisible","collapse"],z:[{z:[Na,"auto",Se,we]}],basis:[{basis:[ar,"full","auto",u,...H()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[qe,ar,"auto","initial","none",we]}],grow:[{grow:["",qe,Se,we]}],shrink:[{shrink:["",qe,Se,we]}],order:[{order:[Na,"first","last","none",Se,we]}],"grid-cols":[{"grid-cols":se()}],"col-start-end":[{col:ce()}],"col-start":[{"col-start":Z()}],"col-end":[{"col-end":Z()}],"grid-rows":[{"grid-rows":se()}],"row-start-end":[{row:ce()}],"row-start":[{"row-start":Z()}],"row-end":[{"row-end":Z()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":te()}],"auto-rows":[{"auto-rows":te()}],gap:[{gap:H()}],"gap-x":[{"gap-x":H()}],"gap-y":[{"gap-y":H()}],"justify-content":[{justify:[...le(),"normal"]}],"justify-items":[{"justify-items":[...ue(),"normal"]}],"justify-self":[{"justify-self":["auto",...ue()]}],"align-content":[{content:["normal",...le()]}],"align-items":[{items:[...ue(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...ue(),{baseline:["","last"]}]}],"place-content":[{"place-content":le()}],"place-items":[{"place-items":[...ue(),"baseline"]}],"place-self":[{"place-self":["auto",...ue()]}],p:[{p:H()}],px:[{px:H()}],py:[{py:H()}],ps:[{ps:H()}],pe:[{pe:H()}],pt:[{pt:H()}],pr:[{pr:H()}],pb:[{pb:H()}],pl:[{pl:H()}],m:[{m:z()}],mx:[{mx:z()}],my:[{my:z()}],ms:[{ms:z()}],me:[{me:z()}],mt:[{mt:z()}],mr:[{mr:z()}],mb:[{mb:z()}],ml:[{ml:z()}],"space-x":[{"space-x":H()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":H()}],"space-y-reverse":["space-y-reverse"],size:[{size:j()}],w:[{w:[u,"screen",...j()]}],"min-w":[{"min-w":[u,"screen","none",...j()]}],"max-w":[{"max-w":[u,"screen","none","prose",{screen:[l]},...j()]}],h:[{h:["screen","lh",...j()]}],"min-h":[{"min-h":["screen","lh","none",...j()]}],"max-h":[{"max-h":["screen","lh",...j()]}],"font-size":[{text:["base",t,bi,io]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,Se,Uf]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Hf,we]}],"font-family":[{font:[HR,we,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[o,Se,we]}],"line-clamp":[{"line-clamp":[qe,"none",Se,Uf]}],leading:[{leading:[i,...H()]}],"list-image":[{"list-image":["none",Se,we]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Se,we]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:O()}],"text-color":[{text:O()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...B(),"wavy"]}],"text-decoration-thickness":[{decoration:[qe,"from-font","auto",Se,io]}],"text-decoration-color":[{decoration:O()}],"underline-offset":[{"underline-offset":[qe,"auto",Se,we]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:H()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Se,we]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Se,we]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:X()}],"bg-repeat":[{bg:he()}],"bg-size":[{bg:_()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Na,Se,we],radial:["",Se,we],conic:[Na,Se,we]},$R,qR]}],"bg-color":[{bg:O()}],"gradient-from-pos":[{from:Q()}],"gradient-via-pos":[{via:Q()}],"gradient-to-pos":[{to:Q()}],"gradient-from":[{from:O()}],"gradient-via":[{via:O()}],"gradient-to":[{to:O()}],rounded:[{rounded:Y()}],"rounded-s":[{"rounded-s":Y()}],"rounded-e":[{"rounded-e":Y()}],"rounded-t":[{"rounded-t":Y()}],"rounded-r":[{"rounded-r":Y()}],"rounded-b":[{"rounded-b":Y()}],"rounded-l":[{"rounded-l":Y()}],"rounded-ss":[{"rounded-ss":Y()}],"rounded-se":[{"rounded-se":Y()}],"rounded-ee":[{"rounded-ee":Y()}],"rounded-es":[{"rounded-es":Y()}],"rounded-tl":[{"rounded-tl":Y()}],"rounded-tr":[{"rounded-tr":Y()}],"rounded-br":[{"rounded-br":Y()}],"rounded-bl":[{"rounded-bl":Y()}],"border-w":[{border:ae()}],"border-w-x":[{"border-x":ae()}],"border-w-y":[{"border-y":ae()}],"border-w-s":[{"border-s":ae()}],"border-w-e":[{"border-e":ae()}],"border-w-t":[{"border-t":ae()}],"border-w-r":[{"border-r":ae()}],"border-w-b":[{"border-b":ae()}],"border-w-l":[{"border-l":ae()}],"divide-x":[{"divide-x":ae()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ae()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...B(),"hidden","none"]}],"divide-style":[{divide:[...B(),"hidden","none"]}],"border-color":[{border:O()}],"border-color-x":[{"border-x":O()}],"border-color-y":[{"border-y":O()}],"border-color-s":[{"border-s":O()}],"border-color-e":[{"border-e":O()}],"border-color-t":[{"border-t":O()}],"border-color-r":[{"border-r":O()}],"border-color-b":[{"border-b":O()}],"border-color-l":[{"border-l":O()}],"divide-color":[{divide:O()}],"outline-style":[{outline:[...B(),"none","hidden"]}],"outline-offset":[{"outline-offset":[qe,Se,we]}],"outline-w":[{outline:["",qe,bi,io]}],"outline-color":[{outline:O()}],shadow:[{shadow:["","none",g,rl,ol]}],"shadow-color":[{shadow:O()}],"inset-shadow":[{"inset-shadow":["none",m,rl,ol]}],"inset-shadow-color":[{"inset-shadow":O()}],"ring-w":[{ring:ae()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:O()}],"ring-offset-w":[{"ring-offset":[qe,io]}],"ring-offset-color":[{"ring-offset":O()}],"inset-ring-w":[{"inset-ring":ae()}],"inset-ring-color":[{"inset-ring":O()}],"text-shadow":[{"text-shadow":["none",y,rl,ol]}],"text-shadow-color":[{"text-shadow":O()}],opacity:[{opacity:[qe,Se,we]}],"mix-blend":[{"mix-blend":[...oe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":oe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[qe]}],"mask-image-linear-from-pos":[{"mask-linear-from":$()}],"mask-image-linear-to-pos":[{"mask-linear-to":$()}],"mask-image-linear-from-color":[{"mask-linear-from":O()}],"mask-image-linear-to-color":[{"mask-linear-to":O()}],"mask-image-t-from-pos":[{"mask-t-from":$()}],"mask-image-t-to-pos":[{"mask-t-to":$()}],"mask-image-t-from-color":[{"mask-t-from":O()}],"mask-image-t-to-color":[{"mask-t-to":O()}],"mask-image-r-from-pos":[{"mask-r-from":$()}],"mask-image-r-to-pos":[{"mask-r-to":$()}],"mask-image-r-from-color":[{"mask-r-from":O()}],"mask-image-r-to-color":[{"mask-r-to":O()}],"mask-image-b-from-pos":[{"mask-b-from":$()}],"mask-image-b-to-pos":[{"mask-b-to":$()}],"mask-image-b-from-color":[{"mask-b-from":O()}],"mask-image-b-to-color":[{"mask-b-to":O()}],"mask-image-l-from-pos":[{"mask-l-from":$()}],"mask-image-l-to-pos":[{"mask-l-to":$()}],"mask-image-l-from-color":[{"mask-l-from":O()}],"mask-image-l-to-color":[{"mask-l-to":O()}],"mask-image-x-from-pos":[{"mask-x-from":$()}],"mask-image-x-to-pos":[{"mask-x-to":$()}],"mask-image-x-from-color":[{"mask-x-from":O()}],"mask-image-x-to-color":[{"mask-x-to":O()}],"mask-image-y-from-pos":[{"mask-y-from":$()}],"mask-image-y-to-pos":[{"mask-y-to":$()}],"mask-image-y-from-color":[{"mask-y-from":O()}],"mask-image-y-to-color":[{"mask-y-to":O()}],"mask-image-radial":[{"mask-radial":[Se,we]}],"mask-image-radial-from-pos":[{"mask-radial-from":$()}],"mask-image-radial-to-pos":[{"mask-radial-to":$()}],"mask-image-radial-from-color":[{"mask-radial-from":O()}],"mask-image-radial-to-color":[{"mask-radial-to":O()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":N()}],"mask-image-conic-pos":[{"mask-conic":[qe]}],"mask-image-conic-from-pos":[{"mask-conic-from":$()}],"mask-image-conic-to-pos":[{"mask-conic-to":$()}],"mask-image-conic-from-color":[{"mask-conic-from":O()}],"mask-image-conic-to-color":[{"mask-conic-to":O()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:X()}],"mask-repeat":[{mask:he()}],"mask-size":[{mask:_()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Se,we]}],filter:[{filter:["","none",Se,we]}],blur:[{blur:V()}],brightness:[{brightness:[qe,Se,we]}],contrast:[{contrast:[qe,Se,we]}],"drop-shadow":[{"drop-shadow":["","none",x,rl,ol]}],"drop-shadow-color":[{"drop-shadow":O()}],grayscale:[{grayscale:["",qe,Se,we]}],"hue-rotate":[{"hue-rotate":[qe,Se,we]}],invert:[{invert:["",qe,Se,we]}],saturate:[{saturate:[qe,Se,we]}],sepia:[{sepia:["",qe,Se,we]}],"backdrop-filter":[{"backdrop-filter":["","none",Se,we]}],"backdrop-blur":[{"backdrop-blur":V()}],"backdrop-brightness":[{"backdrop-brightness":[qe,Se,we]}],"backdrop-contrast":[{"backdrop-contrast":[qe,Se,we]}],"backdrop-grayscale":[{"backdrop-grayscale":["",qe,Se,we]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[qe,Se,we]}],"backdrop-invert":[{"backdrop-invert":["",qe,Se,we]}],"backdrop-opacity":[{"backdrop-opacity":[qe,Se,we]}],"backdrop-saturate":[{"backdrop-saturate":[qe,Se,we]}],"backdrop-sepia":[{"backdrop-sepia":["",qe,Se,we]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":H()}],"border-spacing-x":[{"border-spacing-x":H()}],"border-spacing-y":[{"border-spacing-y":H()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Se,we]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[qe,"initial",Se,we]}],ease:[{ease:["linear","initial",M,Se,we]}],delay:[{delay:[qe,Se,we]}],animate:[{animate:["none",A,Se,we]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[C,Se,we]}],"perspective-origin":[{"perspective-origin":D()}],rotate:[{rotate:pe()}],"rotate-x":[{"rotate-x":pe()}],"rotate-y":[{"rotate-y":pe()}],"rotate-z":[{"rotate-z":pe()}],scale:[{scale:me()}],"scale-x":[{"scale-x":me()}],"scale-y":[{"scale-y":me()}],"scale-z":[{"scale-z":me()}],"scale-3d":["scale-3d"],skew:[{skew:ye()}],"skew-x":[{"skew-x":ye()}],"skew-y":[{"skew-y":ye()}],transform:[{transform:[Se,we,"","none","gpu","cpu"]}],"transform-origin":[{origin:D()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:ve()}],"translate-x":[{"translate-x":ve()}],"translate-y":[{"translate-y":ve()}],"translate-z":[{"translate-z":ve()}],"translate-none":["translate-none"],accent:[{accent:O()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:O()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Se,we]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":H()}],"scroll-mx":[{"scroll-mx":H()}],"scroll-my":[{"scroll-my":H()}],"scroll-ms":[{"scroll-ms":H()}],"scroll-me":[{"scroll-me":H()}],"scroll-mt":[{"scroll-mt":H()}],"scroll-mr":[{"scroll-mr":H()}],"scroll-mb":[{"scroll-mb":H()}],"scroll-ml":[{"scroll-ml":H()}],"scroll-p":[{"scroll-p":H()}],"scroll-px":[{"scroll-px":H()}],"scroll-py":[{"scroll-py":H()}],"scroll-ps":[{"scroll-ps":H()}],"scroll-pe":[{"scroll-pe":H()}],"scroll-pt":[{"scroll-pt":H()}],"scroll-pr":[{"scroll-pr":H()}],"scroll-pb":[{"scroll-pb":H()}],"scroll-pl":[{"scroll-pl":H()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Se,we]}],fill:[{fill:["none",...O()]}],"stroke-w":[{stroke:[qe,bi,io,Uf]}],stroke:[{stroke:["none",...O()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},FR=ER(GR);function Ee(...r){return FR(Uv(r))}function g3(r,e){return r?{...e,...r}:e}const zh=jh("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Ne=w.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...o},i)=>{const l=n?JE:"button";return h.jsx(l,{className:Ee(zh({variant:e,size:t,className:r})),ref:i,...o})});Ne.displayName="Button";var zi=Dv();const VR=Th(zi);var KR=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],YR=KR.reduce((r,e)=>{const t=Dh(`Primitive.${e}`),n=w.forwardRef((o,i)=>{const{asChild:l,...u}=o,f=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(f,{...u,ref:i})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{}),XR="Separator",q0="horizontal",WR=["horizontal","vertical"],eb=w.forwardRef((r,e)=>{const{decorative:t,orientation:n=q0,...o}=r,i=ZR(n)?n:q0,u=t?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return h.jsx(YR.div,{"data-orientation":i,...u,...o,ref:e})});eb.displayName=XR;function ZR(r){return WR.includes(r)}var tb=eb;const vn=w.forwardRef(({className:r,orientation:e="horizontal",decorative:t=!0,...n},o)=>h.jsx(tb,{ref:o,decorative:t,orientation:e,className:Ee("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",r),...n}));vn.displayName=tb.displayName;const H0=r=>{let e;const t=new Set,n=(p,g)=>{const m=typeof p=="function"?p(e):p;if(!Object.is(m,e)){const y=e;e=g??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(x=>x(e,y))}},o=()=>e,u={setState:n,getState:o,getInitialState:()=>f,subscribe:p=>(t.add(p),()=>t.delete(p))},f=e=r(n,o,u);return u},JR=(r=>r?H0(r):H0),eT=r=>r;function tT(r,e=eT){const t=Et.useSyncExternalStore(r.subscribe,Et.useCallback(()=>e(r.getState()),[r,e]),Et.useCallback(()=>e(r.getInitialState()),[r,e]));return Et.useDebugValue(t),t}const U0=r=>{const e=JR(r),t=n=>tT(e,n);return Object.assign(t,e),t},Cs=(r=>r?U0(r):U0);class nT{nodes=[];connections=[];handlers=new Map;postgresQueryEngine=null;messageQueue=new Map;messageHistory=[];isRunning=!1;updateInterval=200;intervalId=null;messageIdCounter=0;MAX_HISTORY=1e3;traceContexts=new Map;traceIdCounter=0;constructor(){this.registerDefaultHandlers()}registerDefaultHandlers(){this.registerHandler("crm",this.createBusinessDataHandler("crm")),this.registerHandler("erp",this.createBusinessDataHandler("erp")),this.registerHandler("payment-gateway",this.createBusinessDataHandler("payment")),this.registerHandler("postgres",this.createDatabaseHandler("postgres")),this.registerHandler("mongodb",this.createDatabaseHandler("mongodb")),this.registerHandler("redis",this.createDatabaseHandler("redis")),this.registerHandler("cassandra",this.createDatabaseHandler("cassandra")),this.registerHandler("clickhouse",this.createDatabaseHandler("clickhouse")),this.registerHandler("snowflake",this.createDatabaseHandler("snowflake")),this.registerHandler("elasticsearch",this.createDatabaseHandler("elasticsearch")),this.registerHandler("s3-datalake",this.createStorageHandler("s3-datalake")),this.registerHandler("kafka",this.createMessageBrokerHandler("kafka")),this.registerHandler("rabbitmq",this.createMessageBrokerHandler("rabbitmq")),this.registerHandler("activemq",this.createMessageBrokerHandler("activemq")),this.registerHandler("aws-sqs",this.createMessageBrokerHandler("aws-sqs")),this.registerHandler("gcp-pubsub",this.createMessageBrokerHandler("gcp-pubsub")),this.registerHandler("rest",this.createAPIHandler("rest")),this.registerHandler("grpc",this.createAPIHandler("grpc")),this.registerHandler("graphql",this.createAPIHandler("graphql")),this.registerHandler("websocket",this.createAPIHandler("websocket")),this.registerHandler("kong",this.createIntegrationHandler("kong")),this.registerHandler("apigee",this.createIntegrationHandler("apigee")),this.registerHandler("mulesoft",this.createIntegrationHandler("mulesoft")),this.registerHandler("graphql-gateway",this.createIntegrationHandler("graphql-gateway")),this.registerHandler("bff-service",this.createIntegrationHandler("bff-service")),this.registerHandler("webhook-relay",this.createIntegrationHandler("webhook-relay")),this.registerHandler("loki",this.createLokiHandler())}registerHandler(e,t){this.handlers.set(e,t)}initialize(e,t){this.nodes=e,this.connections=t,this.messageQueue.clear(),this.messageHistory=[];for(const n of t)this.messageQueue.set(n.id,[])}updateNodesAndConnections(e,t){this.nodes=e,this.connections=t;const n=new Set(t.map(o=>o.id));for(const[o]of this.messageQueue.entries())n.has(o)||this.messageQueue.delete(o);for(const o of t)this.messageQueue.has(o.id)||this.messageQueue.set(o.id,[])}start(){this.isRunning||(this.isRunning=!0,this.intervalId=setInterval(()=>{this.processDataFlow()},this.updateInterval))}stop(){this.isRunning=!1,this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}processDataFlow(){this.generateSourceData(),this.processInTransitMessages(),this.deliverMessages()}generateSourceData(){for(const e of this.connections){const t=this.nodes.find(l=>l.id===e.source);if(!t)continue;const n=this.handlers.get(t.type);if(!n?.generateData)continue;const o=t.data.config||{},i=n.generateData(t,o);if(i&&i.length>0){const l=this.messageQueue.get(e.id)||[];for(const u of i)u.connectionId=e.id,u.target=e.target,u.status="pending",u.id=`msg-${++this.messageIdCounter}`,u.timestamp=Date.now(),l.push(u);this.messageQueue.set(e.id,l)}}}processInTransitMessages(){for(const[e,t]of this.messageQueue.entries()){const n=this.connections.find(l=>l.id===e);if(!n)continue;const o=this.nodes.find(l=>l.id===n.source),i=this.nodes.find(l=>l.id===n.target);if(!(!o||!i)){for(const l of t)if(l.status==="pending")this.transformMessageIfNeeded(l,o,i,n)&&(l.status="in-transit",l.latency=this.calculateTransitTime(n));else if(l.status==="in-transit"){const u=Date.now()-l.timestamp;l.latency&&u>=l.latency&&(l.status="delivered")}}}}deliverMessages(){for(const[e,t]of this.messageQueue.entries()){const n=this.connections.find(f=>f.id===e);if(!n)continue;const o=this.nodes.find(f=>f.id===n.target);if(!o)continue;const i=this.handlers.get(o.type);if(!i?.processData)continue;const l=o.data.config||{},u=t.filter(f=>f.status==="delivered");for(const f of u)try{const p=this.nodes.find(m=>m.id===n.source),g=i.processData(o,f,l);g&&(p&&this.generateTraceForMessage(f,p,o,n,g),this.addToHistory(f),t.splice(t.indexOf(f),1))}catch(p){f.status="failed",f.error=p instanceof Error?p.message:"Unknown error";const g=this.nodes.find(m=>m.id===n.source);g&&this.generateTraceForMessage(f,g,o,n,f),this.addToHistory(f),t.splice(t.indexOf(f),1)}this.messageQueue.set(e,t)}}transformMessageIfNeeded(e,t,n,o){const i=this.handlers.get(t.type),l=this.handlers.get(n.type),u=i?.getSupportedFormats?.(t)||[e.format],f=l?.getSupportedFormats?.(n)||[e.format];if(f.includes(e.format))return e;const p=f.find(m=>u.includes(m));if(p)return e.format=p,e.status="transformed",e;const g=this.findIntegrationHandler(o);if(g?.transformData){const m=g.transformData(t,e,n.type,t.data.config||{});if(m)return m}if(i?.transformData){const m=i.transformData(t,e,n.type,t.data.config||{});if(m)return m}return e.status="failed",e.error=`Format ${e.format} not supported by target ${n.type}`,null}findIntegrationHandler(e){const t=this.nodes.find(n=>n.id===e.source);return t&&["kong","apigee","mulesoft","bff-service"].includes(t.type)&&this.handlers.get(t.type)||null}calculateTransitTime(e){const t=e.data||{},n=t.latencyMs||10,o=(t.jitterMs||0)*(Math.random()-.5);return Math.max(1,n+o)}generateTraceForMessage(e,t,n,o,i){const l=We.getAllJaegerEngines();if(l.size===0)return;let u=e.metadata?.traceContext;if(!u){const x=this.generateTraceId(),S=this.generateSpanId();u={traceId:x,spanId:S,sampled:!0},this.traceContexts.set(x,u)}const f=e.timestamp*1e3,p=(e.timestamp+(e.latency||0))*1e3,g=p-f,m=this.getOperationName(e,t,n),y={traceId:u.traceId,spanId:u.spanId,parentSpanId:u.parentSpanId,operationName:m,serviceName:t.data.label||t.type,startTime:f,duration:g,tags:[{key:"component.type",value:t.type},{key:"target.component",value:n.data.label||n.type},{key:"target.type",value:n.type},{key:"message.format",value:e.format},{key:"message.size",value:e.size},{key:"connection.id",value:o.id},{key:"status",value:i.status}],logs:[]};if((i.status==="failed"||i.error)&&(y.tags.push({key:"error",value:!0}),y.logs.push({timestamp:p,fields:[{key:"event",value:"error"},{key:"error.message",value:i.error||"Unknown error"}]})),e.metadata)for(const[x,S]of Object.entries(e.metadata))x!=="traceContext"&&S!==void 0&&S!==null&&y.tags.push({key:`metadata.${x}`,value:String(S)});for(const[,x]of l)x.receiveSpan(y);if(i.status==="delivered"&&n){const x=this.generateSpanId(),S={traceId:u.traceId,spanId:x,parentSpanId:u.spanId,sampled:u.sampled};i.metadata||(i.metadata={}),i.metadata.traceContext=S}}generateTraceId(){return`trace-${++this.traceIdCounter}-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}generateSpanId(){return`span-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}getOperationName(e,t,n){return e.metadata?.operation?String(e.metadata.operation):t.type==="api-gateway"||t.type==="kong"||t.type==="apigee"?`HTTP ${e.metadata?.method||"REQUEST"}`:t.type.includes("database")||t.type==="postgres"||t.type==="mongodb"?`DB ${e.metadata?.queryType||"QUERY"}`:t.type.includes("queue")||t.type==="rabbitmq"||t.type==="kafka"?`MQ ${e.metadata?.queue||"SEND"}`:`${t.type} -> ${n.type}`}addToHistory(e){this.messageHistory.push(e),this.messageHistory.length>this.MAX_HISTORY&&this.messageHistory.shift()}getConnectionMessages(e){return this.messageQueue.get(e)||[]}getMessageHistory(e){const t=[...this.messageHistory].reverse();return e?t.slice(0,e):t}getComponentMessages(e){const t=[];for(const n of this.messageQueue.values())for(const o of n)(o.source===e||o.target===e)&&t.push(o);return t}createBusinessDataHandler(e){return{generateData:(t,n)=>{const o=[],i=n.generateInterval||2e3,l=t._lastGenerate||0,u=Date.now();if(u-l<i)return null;switch(t._lastGenerate=u,e){case"crm":o.push(this.createCRMDataMessage(t));break;case"erp":o.push(this.createERPDataMessage(t));break;case"payment":o.push(this.createPaymentDataMessage(t));break}return o},getSupportedFormats:()=>["json","xml"]}}validateMongoDBSchema(e,t){if(!t||!t.$jsonSchema)return{valid:!0};const n=t.$jsonSchema;if(n.required&&Array.isArray(n.required)){for(const o of n.required)if(!(o in e)||e[o]===void 0||e[o]===null)return{valid:!1,error:`Required field "${o}" is missing`}}if(n.properties){for(const[o,i]of Object.entries(n.properties))if(o in e){const l=e[o],u=i;if(u.type){const f=u.type,p=Array.isArray(l)?"array":typeof l;if(f==="string"&&p!=="string")return{valid:!1,error:`Field "${o}" must be of type string`};if(f==="number"&&p!=="number")return{valid:!1,error:`Field "${o}" must be of type number`};if(f==="boolean"&&p!=="boolean")return{valid:!1,error:`Field "${o}" must be of type boolean`};if(f==="array"&&p!=="array")return{valid:!1,error:`Field "${o}" must be of type array`};if(f==="object"&&(p!=="object"||Array.isArray(l)))return{valid:!1,error:`Field "${o}" must be of type object`}}}}return{valid:!0}}createDatabaseHandler(e){return{processData:(t,n,o)=>{if(e==="postgres"&&n.payload?.sql)return this.processPostgreSQLQuery(t,n,o);if(e==="redis")return this.processRedisCommand(t,n,o);if(e==="cassandra")return this.processCQLQuery(t,n,o);if(e==="clickhouse")return this.processClickHouseQuery(t,n,o);if(e==="snowflake")return this.processSnowflakeQuery(t,n,o);if(e==="elasticsearch")return this.processElasticsearchOperation(t,n,o);const i=n.payload?.operation||"insert";switch(i){case"insert":case"update":{const u=o.queryLatency||10;if(n.latency=u,e==="mongodb"){const p=t.data.config?.collections||[],g=n.payload;let m=g?.collection;if(!m&&p.length>0&&(g?.type?m=p.find(x=>x.name.toLowerCase().includes(g.type.toLowerCase()))?.name||p[0].name:m=p[0].name),m){const y=p.find(x=>x.name===m);if(y){if(y.validation){const x=y.validation;if(x.validationLevel!=="off"){const C={...g?.document||g?.data||g};delete C._id;const E=this.validateMongoDBSchema(C,x.validator);if(!E.valid){if(x.validationAction==="error")return n.status="failed",n.error=`Schema validation failed for collection "${m}": ${E.error}`,n;x.validationAction==="warn"&&(n.metadata={...n.metadata,validationWarning:E.error,collection:m})}}}i==="insert"?n.metadata={...n.metadata,collection:m,documentStored:!0}:i==="update"&&(n.metadata={...n.metadata,collection:m,documentUpdated:!0})}else return n.status="failed",n.error=`Collection "${m}" not found`,n}}return n.status="delivered",n}case"delete":const l=o.queryLatency||10;return n.latency=l,n.status="delivered",n;case"query":{let u=[];if(e==="mongodb"){const p=t.data.config?.collections||[],g=n.payload,m=g?.collection||p[0]?.name;if(m){const y=p.find(x=>x.name===m);if(y?.documents&&y.documents.length>0){if(u=y.documents.map(S=>({...S})),g?.filter)try{const S=typeof g.filter=="string"?JSON.parse(g.filter):g.filter;u=u.filter(C=>{for(const[E,M]of Object.entries(S))if(C[E]!==M)return!1;return!0})}catch{}const x=g?.limit||100;u=u.slice(0,x)}else u=this.generateQueryResults(e,g?.query)}else u=this.generateQueryResults(e,g?.query)}else u=this.generateQueryResults(e,n.payload?.query);return n.payload={...n.payload,results:u},n.status="delivered",n}default:return n.status="failed",n.error=`Unknown operation: ${i}`,n}},getSupportedFormats:()=>["json","binary"]}}processClickHouseQuery(e,t,n){const o=t.payload,i=We.getClickHouseRoutingEngine(e.id);if(!i)return t.status="failed",t.error="ClickHouse Routing Engine not initialized",t;let l;if(o?.sql)l=o.sql;else if(o?.query)l=o.query;else if(typeof o=="string")l=o;else{const f=o?.operation||"select",p=e.data.config,g=o?.database||p?.database||"default",m=o?.table||"default_table";switch(f.toLowerCase()){case"select":case"read":case"query":l=`SELECT * FROM ${g}.${m}`,o?.where&&(l+=` WHERE ${o.where}`),o?.limit&&(l+=` LIMIT ${o.limit}`);break;case"insert":case"write":const y=o?.columns?Object.keys(o.columns).join(", "):"id, data",x=o?.columns?Object.values(o.columns).map(S=>`'${S}'`).join(", "):`${Date.now()}, 'data'`;l=`INSERT INTO ${g}.${m} (${y}) VALUES (${x})`;break;default:return t.status="failed",t.error=`Unknown ClickHouse operation: ${f}`,t}}const u=i.executeQuery(l);return u.success?(t.status="delivered",t.latency=u.latency||45,t.payload={...t.payload,sql:l,rows:u.rows||[],rowCount:u.rowCount||0,columns:u.columns||[],dataRead:u.dataRead,dataWritten:u.dataWritten,clickHouseResult:u.rows},t.metadata={...t.metadata,clickHouseQuery:l,rowsRead:u.dataRead,rowsWritten:u.dataWritten}):(t.status="failed",t.error=u.error||"ClickHouse query execution failed",t.latency=u.latency||0),t}processSnowflakeQuery(e,t,n){const o=t.payload,i=We.getSnowflakeRoutingEngine(e.id);if(!i)return t.status="failed",t.error="Snowflake Routing Engine not initialized",t;let l,u,f,p;if(o?.sql)l=o.sql,u=o.warehouse,f=o.database,p=o.schema;else if(o?.query)l=o.query,u=o.warehouse,f=o.database,p=o.schema;else if(typeof o=="string")l=o;else{const m=o?.operation||"select",y=e.data.config;f=o?.database||y?.database||"PUBLIC",p=o?.schema||y?.schema||"PUBLIC",u=o?.warehouse||y?.warehouse;const x=o?.table||"default_table";switch(m.toLowerCase()){case"select":case"read":case"query":l=`SELECT * FROM ${f}.${p}.${x}`,o?.where&&(l+=` WHERE ${o.where}`),o?.limit&&(l+=` LIMIT ${o.limit}`);break;case"insert":case"write":const S=o?.columns?Object.keys(o.columns).join(", "):"id, data",C=o?.columns?Object.values(o.columns).map(E=>`'${E}'`).join(", "):`${Date.now()}, 'data'`;l=`INSERT INTO ${f}.${p}.${x} (${S}) VALUES (${C})`;break;default:return t.status="failed",t.error=`Unknown Snowflake operation: ${m}`,t}}const g=i.executeQuery(l,u,f,p);return g.success?(t.status="delivered",t.latency=g.latency||50,t.payload={...t.payload,sql:l,rows:g.rows||[],rowCount:g.rowCount||0,columns:g.columns||[],dataRead:g.dataRead,dataWritten:g.dataWritten,snowflakeResult:g.rows,queryId:g.queryId,warehouse:g.warehouse,resultCacheUsed:g.resultCacheUsed},t.metadata={...t.metadata,snowflakeQuery:l,rowsRead:g.dataRead,rowsWritten:g.dataWritten,warehouse:g.warehouse,queryId:g.queryId,cacheHit:g.resultCacheUsed||!1}):(t.status="failed",t.error=g.error||"Snowflake query execution failed",t.latency=g.latency||0),t}processElasticsearchOperation(e,t,n){const o=t.payload,i=We.getElasticsearchRoutingEngine(e.id);if(!i)return t.status="failed",t.error="Elasticsearch Routing Engine not initialized",t;const l=o?.operation||o?.method||"index",u=o?.index||o?._index||e.data.config?.index||"archiphoenix-index",f=o?.id||o?._id,p=o?.document||o?._source||o?.body||o,g=o?.query,m=o?.routing||o?._routing;let y;switch(l.toLowerCase()){case"index":case"create":case"update":if(!f||!p)return t.status="failed",t.error="Index operation requires id and document",t;y=i.indexDocument(u,f,p,m);break;case"get":case"read":if(!f)return t.status="failed",t.error="Get operation requires id",t;y=i.getDocument(u,f,m);break;case"search":case"query":g?y=i.search(u,g):o?.queryString?y=i.executeQuery(o.queryString):y=i.search(u,{query:{match_all:{}}});break;case"delete":if(!f)return t.status="failed",t.error="Delete operation requires id",t;y=i.deleteDocument(u,f,m);break;default:if(typeof o=="string"||o?.queryString){const x=typeof o=="string"?o:o.queryString;y=i.executeQuery(x)}else return t.status="failed",t.error=`Unsupported Elasticsearch operation: ${l}`,t}return y.success?(t.status="delivered",t.latency=y.latency||y.took||10,t.payload={...t.payload,operation:y.operation,index:y.index,id:y.id,document:y.document,hits:y.hits,took:y.took,elasticsearchResult:y},t.metadata={...t.metadata,elasticsearchOperation:y.operation,index:y.index,hits:y.hits,took:y.took}):(t.status="failed",t.error=y.error||"Elasticsearch operation failed",t.latency=y.latency||y.took||0),t}createStorageHandler(e){return e==="s3-datalake"?{processData:(t,n,o)=>this.processS3Operation(t,n,o),getSupportedFormats:()=>["json","binary","text","xml"]}:{processData:(t,n,o)=>(n.status="delivered",n.latency=50,n),getSupportedFormats:()=>["json","binary","text"]}}processS3Operation(e,t,n){const o=t.payload,i=We.getS3RoutingEngine(e.id);if(!i)return t.status="failed",t.error="S3 Routing Engine not initialized",t;const l=o?.operation||o?.method||"PUT",u=o?.bucket||o?.bucketName||e.data.config?.buckets?.[0]?.name||"default-bucket",f=o?.key||o?.objectKey||t.metadata?.key,p=o?.versionId||t.metadata?.versionId;let g;switch(l.toUpperCase()){case"PUT":case"UPLOAD":if(!f||!t.payload)return t.status="failed",t.error="PUT operation requires key and payload",t;const m=o?.data||o?.body||t.payload,y=o?.contentType||t.metadata?.contentType,x=o?.metadata||t.metadata;g=i.putObject(u,f,m,t.size,x,y);break;case"GET":case"DOWNLOAD":if(!f)return t.status="failed",t.error="GET operation requires key",t;g=i.getObject(u,f,p);break;case"DELETE":if(!f)return t.status="failed",t.error="DELETE operation requires key",t;g=i.deleteObject(u,f,p);break;case"LIST":const S=o?.prefix||t.metadata?.prefix,C=o?.maxKeys||o?.maxKeys||1e3;g=i.listObjects(u,S,C);break;case"HEAD":if(!f)return t.status="failed",t.error="HEAD operation requires key",t;g=i.headObject(u,f);break;default:return t.status="failed",t.error=`Unsupported S3 operation: ${l}`,t}return g.success?(t.status="delivered",t.latency=g.latency||50,g.object?t.payload={...t.payload,operation:l.toUpperCase(),bucket:u,key:f,object:g.object,etag:g.object.etag,versionId:g.versionId||g.object.versionId,size:g.object.size,storageClass:g.object.storageClass}:g.objects?t.payload={...t.payload,operation:"LIST",bucket:u,objects:g.objects,count:g.objects.length}:t.payload={...t.payload,operation:l.toUpperCase(),bucket:u,key:f,success:!0,versionId:g.versionId,deleteMarker:g.deleteMarker},t.metadata={...t.metadata,s3Operation:l.toUpperCase(),bucket:u,key:f,latency:g.latency}):(t.status="failed",t.error=g.error||`S3 ${l} operation failed`,t.latency=g.latency||0),t}processPostgreSQLQuery(e,t,n){if(!this.postgresQueryEngine)return t.status="failed",t.error="PostgreSQL Query Engine not initialized",t;const o=t.payload?.sql;if(!o||typeof o!="string")return t.status="failed",t.error="No SQL query provided",t;const i=e.data.config,l=i.tables||[],u=this.extractIndexesFromConfig(i,l),f=i.views||[],p=this.postgresQueryEngine.execute(o,l,u,f);return p.success?(t.status="delivered",t.latency=p.executionTime||n.queryLatency||10,t.payload={...t.payload,results:p.rows||[],rowCount:p.rowCount||0,queryPlan:p.queryPlan,indexesUsed:p.indexesUsed||[]}):(t.status="failed",t.error=p.error||"Query execution failed",t.latency=p.executionTime||0),t}processRedisCommand(e,t,n){const o=t.payload,i=We.getRedisRoutingEngine(e.id);if(!i)return t.status="failed",t.error="Redis Routing Engine not initialized",t;let l,u;if(o?.command)l=o.command,u=o.args||[];else if(o?.redisCommand){const p=String(o.redisCommand).trim().split(/\s+/);l=p[0],u=p.slice(1)}else if(typeof o=="string"){const p=o.trim().split(/\s+/);l=p[0],u=p.slice(1)}else{const p=o?.operation||"get";switch(p.toLowerCase()){case"get":l="GET",u=[o?.key||"default:key"];break;case"set":l="SET",u=[o?.key||"default:key",typeof o?.value=="string"?o.value:JSON.stringify(o?.value||"")],o?.ttl&&u.push("EX",String(o.ttl));break;case"delete":case"del":l="DEL",u=Array.isArray(o?.keys)?o.keys:[o?.key||"default:key"];break;case"exists":l="EXISTS",u=Array.isArray(o?.keys)?o.keys:[o?.key||"default:key"];break;default:return t.status="failed",t.error=`Unknown Redis operation: ${p}`,t}}const f=i.executeCommand(l,u);return f.success?(t.status="delivered",t.latency=f.latency||1,t.payload={...t.payload,command:l,args:u,result:f.value,redisResult:f.value}):(t.status="failed",t.error=f.error||"Redis command execution failed",t.latency=f.latency||0),t}processCQLQuery(e,t,n){const o=t.payload,i=We.getCassandraRoutingEngine(e.id);if(!i)return t.status="failed",t.error="Cassandra Routing Engine not initialized",t;let l,u;if(o?.cql)l=o.cql,u=o.consistency;else if(o?.query)l=o.query,u=o.consistency;else if(typeof o=="string")l=o;else{const p=o?.operation||"select",g=e.data.config,m=o?.keyspace||g?.keyspace||"system",y=o?.table||"default_table";switch(p.toLowerCase()){case"select":case"read":l=`SELECT * FROM ${m}.${y}`,o?.limit&&(l+=` LIMIT ${o.limit}`);break;case"insert":case"write":const x=o?.columns?Object.keys(o.columns).join(", "):"id, data",S=o?.columns?Object.values(o.columns).map(M=>`'${M}'`).join(", "):`${Date.now()}, 'data'`;l=`INSERT INTO ${m}.${y} (${x}) VALUES (${S})`;break;case"update":const C=o?.columns||{},E=Object.entries(C).map(([M,A])=>`${M} = '${A}'`).join(", ");l=`UPDATE ${m}.${y} SET ${E}`,o?.where&&(l+=` WHERE ${o.where}`);break;case"delete":l=`DELETE FROM ${m}.${y}`,o?.where&&(l+=` WHERE ${o.where}`);break;default:return t.status="failed",t.error=`Unknown CQL operation: ${p}`,t}}u||(u=e.data.config?.consistencyLevel||"QUORUM");const f=i.executeCQL(l,u);return f.success?(t.status="delivered",t.latency=f.latency||5,t.payload={...t.payload,cql:l,consistency:f.consistency,rows:f.rows||[],rowCount:f.rowCount||0,replicasQueried:f.replicasQueried,cqlResult:f.rows},t.metadata={...t.metadata,cassandraConsistency:f.consistency,cassandraReplicasQueried:f.replicasQueried}):(t.status="failed",t.error=f.error||"CQL query execution failed",t.latency=f.latency||0),t}extractIndexesFromConfig(e,t){const n=[];for(const o of t)for(const i of o.indexes||[]){const l=i.match(/CREATE\s+(?:UNIQUE\s+)?INDEX\s+(\w+)\s+ON\s+\w+\s*\(([^)]+)\)/i);l?n.push({name:l[1],table:o.name,schema:o.schema,columns:l[2].split(",").map(u=>u.trim()),unique:i.toUpperCase().includes("UNIQUE")}):n.push({name:i,table:o.name,schema:o.schema,columns:[i.replace(/^idx_|^index_/i,"")]})}return n}createMessageBrokerHandler(e){return e==="rabbitmq"?{processData:(t,n,o)=>{const i=We.getRabbitMQRoutingEngine(t.id);if(!i)return n.status="delivered",n;const l=o?.messaging||n.metadata?.messaging||{},u=l.exchange||"amq.topic",f=l.routingKey||n.metadata?.routingKey||"default",p=n.metadata?.headers,g=n.metadata?.priority,m=i.routeMessage(u,f,n.payload,n.size,p,g);return m.length>0?(n.status="delivered",n.metadata={...n.metadata,routedQueues:m,exchange:u,routingKey:f}):(n.status="failed",n.error=`No queues bound to exchange '${u}' with routing key '${f}'`),n},getSupportedFormats:()=>["json","binary","text"]}:e==="activemq"?{processData:(t,n,o)=>{const i=We.getActiveMQRoutingEngine(t.id);if(!i)return n.status="delivered",n;const l=o?.messaging||n.metadata?.messaging||{},u=l.queue,f=l.topic,p=n.metadata?.headers,g=n.metadata?.priority;let m=!1,y="";const x=t.data.config||{},S=x.acls||[],E=this.nodes.find(A=>A.id===n.source)?.data.config,M=n.metadata?.principal||E?.username||E?.clientId||x.username||`user-${n.source.slice(0,8)}`;if(u){if(!(We.checkActiveMQACLPermissionPublic?.(S,M,`queue://${u}`,"write")??!0))return n.status="failed",n.error=`Access denied: principal '${M}' does not have write permission for queue '${u}'`,n;i.routeToQueue(u,n.payload,n.size,p,g)&&(m=!0,y=u)}if(f){if(!(We.checkActiveMQACLPermissionPublic?.(S,M,`topic://${f}`,"write")??!0))return n.status="failed",n.error=`Access denied: principal '${M}' does not have write permission for topic '${f}'`,n;i.publishToTopic(f,n.payload,n.size,p,g).length>0&&(m=!0,y=f)}return m?(n.status="delivered",n.metadata={...n.metadata,destination:y,queue:u||void 0,topic:f||void 0}):(n.status="failed",n.error=`No queue or topic found. Queue: '${u||"none"}', Topic: '${f||"none"}'`),n},getSupportedFormats:()=>["json","binary","text"]}:e==="aws-sqs"?{processData:(t,n,o)=>{const i=We.getSQSRoutingEngine(t.id);if(!i)return n.status="delivered",n;const l=o?.messaging||n.metadata?.messaging||{},u=l.queueUrl,f=l.queueName||(u?u.split("/").pop():null)||n.metadata?.queueName||"default-queue",p=t.data.config||{},g=p.iamPolicies||[],y=this.nodes.find(T=>T.id===n.source)?.data.config,x=n.metadata?.principal||y?.accessKeyId||y?.clientId||p.accessKeyId||`arn:aws:iam::123456789012:user/${n.source.slice(0,8)}`;if(!(We.checkSQSIAMPolicy?.(g,x,f,"sqs:SendMessage")??!0))return n.status="failed",n.error=`Access denied: principal '${x}' does not have sqs:SendMessage permission for queue '${f}'`,n;const C=n.metadata?.messageGroupId,E=n.metadata?.messageDeduplicationId,M=n.metadata?.attributes,A=i.sendMessage(f,n.payload,n.size,M,C,E);return A?(n.status="delivered",n.metadata={...n.metadata,queueName:f,messageId:A,queueUrl:u||`https://sqs.${p.defaultRegion||"us-east-1"}.amazonaws.com/.../${f}`}):(n.status="failed",n.error=`Queue '${f}' not found`),n},getSupportedFormats:()=>["json","binary","text"]}:e==="azure-service-bus"?{processData:(t,n,o)=>{const i=We.getAzureServiceBusRoutingEngine(t.id);if(!i)return n.status="delivered",n;const l=o?.messaging||n.metadata?.messaging||{},u=l.queue,f=l.topic,p=n.metadata?.properties||n.metadata?.headers,g=n.metadata?.sessionId,m=n.metadata?.scheduledEnqueueTime;let y=!1,x="",S=[];if(u){const C=i.sendToQueue(u,n.payload,n.size,p,g,m);C&&(y=!0,x=u,S.push(C))}if(f){const C=i.publishToTopic(f,n.payload,n.size,p,m);C.length>0&&(y=!0,x=f,S=C)}return y?(n.status="delivered",n.metadata={...n.metadata,destination:x,queue:u||void 0,topic:f||void 0,messageIds:S,sessionId:g||void 0}):(n.status="failed",n.error=`No queue or topic found. Queue: '${u||"none"}', Topic: '${f||"none"}'`),n},getSupportedFormats:()=>["json","binary","text"]}:e==="gcp-pubsub"?{processData:(t,n,o)=>{const i=We.getPubSubRoutingEngine(t.id);if(!i)return n.status="delivered",n;const l=o?.messaging||n.metadata?.messaging||{},u=l.topic||n.metadata?.topic,f=l.orderingKey||n.metadata?.orderingKey,p=n.metadata?.attributes||n.metadata?.headers,g=t.data.config||{},m=u||g.topics&&g.topics[0]?.name||null;if(!m)return n.status="failed",n.error="No topic specified for Pub/Sub message",n;const y=i.publishToTopic(m,n.payload,n.size,p,f);return y?(n.status="delivered",n.metadata={...n.metadata,topic:m,messageId:y,orderingKey:f||void 0}):(n.status="failed",n.error=`Topic '${m}' not found`),n},getSupportedFormats:()=>["json","binary","text"]}:{processData:(t,n,o)=>(n.status="delivered",n),getSupportedFormats:()=>["json","binary","text"]}}createAPIHandler(e){return{processData:(t,n,o)=>{const i={status:"success",data:n.payload,timestamp:Date.now()};return n.payload=i,n.status="delivered",n},transformData:(t,n,o,i)=>(e==="rest"&&n.format!=="json"?(n.format="json",n.status="transformed"):e==="grpc"&&n.format!=="protobuf"&&(n.format="protobuf",n.status="transformed"),n),getSupportedFormats:()=>{switch(e){case"rest":return["json","xml"];case"grpc":return["protobuf","binary"];case"graphql":return["json"];case"websocket":return["json","text","binary"];default:return["json"]}}}}createIntegrationHandler(e){return e==="kong"?{processData:(t,n,o)=>{const i=We.getKongRoutingEngine(t.id);if(!i)return n.status="delivered",n;const l=n.payload,u=l?.path||n.metadata?.path||"/",f=l?.method||n.metadata?.method||"GET",p=l?.headers||n.metadata?.headers||{},g=l?.query||n.metadata?.query||{},m=p.apikey||p["X-API-Key"]||g.apikey,y=n.metadata?.consumerId,x=i.routeRequest({path:u,method:f,headers:p,query:g,body:l?.body,consumerId:y,apiKey:m});return x.response.status>=200&&x.response.status<300?(n.status="delivered",n.latency=x.response.latency,n.metadata={...n.metadata,kongRoute:x.match?.route.id,kongService:x.match?.service.id,kongTarget:x.target,kongResponseStatus:x.response.status}):(n.status="failed",n.error=x.response.error||`HTTP ${x.response.status}`,n.latency=x.response.latency),n},transformData:(t,n,o,i)=>{const l=this.getTargetFormats(o);return l.length>0&&!l.includes(n.format)&&(n.format=l[0],n.status="transformed"),n},getSupportedFormats:()=>["json","xml","binary"]}:e==="apigee"?{processData:(t,n,o)=>{const i=We.getApigeeRoutingEngine(t.id);if(!i)return n.status="delivered",n;const l=n.payload,u=l?.path||n.metadata?.path||"/",f=l?.method||n.metadata?.method||"GET",p=l?.headers||n.metadata?.headers||{},g=l?.query||n.metadata?.query||{},m=p.apikey||p["X-API-Key"]||g.apikey,y=p.Authorization||"",x=y.startsWith("OAuth ")?y.replace("OAuth ",""):void 0,S=y.startsWith("Bearer ")?y.replace("Bearer ",""):p["X-JWT-Token"],C=i.routeRequest({path:u,method:f,headers:p,query:g,body:l?.body,apiKey:m,oauthToken:x,jwtToken:S});return C.response.status>=200&&C.response.status<300?(n.status="delivered",n.latency=C.response.latency,n.metadata={...n.metadata,apigeeProxy:C.match?.proxy.name,apigeeTarget:C.target,apigeeResponseStatus:C.response.status,apigeeEnvironment:C.match?.proxy.environment}):(n.status="failed",n.error=C.response.error||`HTTP ${C.response.status}`,n.latency=C.response.latency),n},transformData:(t,n,o,i)=>{const l=this.getTargetFormats(o);return l.length>0&&!l.includes(n.format)&&(n.format=l[0],n.status="transformed"),n},getSupportedFormats:()=>["json","xml","binary"]}:e==="graphql-gateway"?{processData:(t,n,o)=>{const i=We.getGraphQLGatewayRoutingEngine(t.id);if(!i)return n.status="delivered",n;const l=n.payload,u=l?.query||l?.body||n.metadata?.query,f=l?.variables||n.metadata?.variables,p=l?.operationName||n.metadata?.operationName,g=l?.headers||n.metadata?.headers||{},m=i.routeRequest({query:u||"",variables:f,headers:g,operationName:p});if(n.latency=m.latency,m.status>=200&&m.status<300){n.status="delivered";const S=i.getServiceRegistry().getConnectedServices().map(C=>C.endpoint);n.metadata={...n.metadata,graphqlGatewayStatus:m.status,graphqlGatewayEndpoints:S}}else n.status="failed",n.error=m.error||`HTTP ${m.status}`;return n},transformData:(t,n,o,i)=>{const l=this.getTargetFormats(o);return l.length>0&&!l.includes(n.format)&&(n.format=l[0],n.status="transformed"),n},getSupportedFormats:()=>["json"]}:e==="mulesoft"?{processData:(t,n,o)=>{const i=We.getMuleSoftRoutingEngine(t.id);if(!i)return n.status="delivered",n;const l=n.payload,u=this.nodes.find(g=>g.id===n.source),f=this.nodes.find(g=>g.id===n.target),p=i.processData({path:l?.path||n.metadata?.path,method:l?.method||n.metadata?.method||"POST",headers:l?.headers||n.metadata?.headers||{},query:l?.query||n.metadata?.query||{},body:l?.body||l||n.payload,format:n.format,sourceComponentType:u?.type,sourceComponentId:u?.id,targetComponentType:f?.type,targetComponentId:f?.id});return p.response.status==="success"?(n.status="delivered",n.latency=p.response.latency,n.payload=p.response.data,p.response.format&&(n.format=p.response.format),n.metadata={...n.metadata,mulesoftApplication:p.response.application,mulesoftFlow:p.response.flow,mulesoftConnector:p.response.connector}):(n.status="failed",n.error=p.response.error||"MuleSoft processing failed",n.latency=p.response.latency||0),n},transformData:(t,n,o,i)=>{const l=this.getTargetFormats(o);return l.length>0&&!l.includes(n.format)&&(n.format=l[0],n.status="transformed"),n},getSupportedFormats:()=>["json","xml","binary","text"]}:e==="bff-service"?{processData:(t,n,o)=>{const i=We.getBFFRoutingEngine(t.id);if(!i)return n.status="delivered",n;const l=n.payload,u=l?.path||n.metadata?.path||"/",f=l?.method||n.metadata?.method||"GET",p=l?.headers||n.metadata?.headers||{},g=l?.query||n.metadata?.query||{},m=l?.body||l||n.payload,y=i.routeRequest({path:u,method:f,headers:p,query:g,body:m});return y.status>=200&&y.status<300?(n.status="delivered",n.latency=y.latency,n.payload=y.data,n.metadata={...n.metadata,bffCacheHit:y.cacheHit,bffBackendResponses:y.backendResponses.length,bffStatus:y.status}):(n.status="failed",n.error=y.error||`HTTP ${y.status}`,n.latency=y.latency),n},transformData:(t,n,o,i)=>{const l=this.getTargetFormats(o);return l.length>0&&!l.includes(n.format)&&(n.format=l[0],n.status="transformed"),n},getSupportedFormats:()=>["json"]}:e==="webhook-relay"?{processData:(t,n,o)=>{const i=We.getWebhookRelayRoutingEngine(t.id);if(!i)return n.status="delivered",n;const l=n.payload,u=l?.url||n.metadata?.url||l?.path||"/",f=l?.method||n.metadata?.method||"POST",p=l?.headers||n.metadata?.headers||{},g=l?.body||l||n.payload,m=l?.ip||n.metadata?.ip||p["x-forwarded-for"]?.split(",")[0]?.trim(),y=l?.event||n.metadata?.event||p["x-event"]||p["x-github-event"]||"",x=i.relayWebhook({url:u,method:f,headers:p,body:g,ip:m,event:y});return x.success?(n.status="delivered",n.latency=x.latency,n.metadata={...n.metadata,webhookRelayId:x.relayId,webhookDeliveryId:x.deliveryId,webhookAttempts:x.attempts,webhookStatus:x.status}):(n.status="failed",n.error=x.error||`Webhook relay failed (HTTP ${x.status})`,n.latency=x.latency,n.metadata={...n.metadata,webhookRelayId:x.relayId,webhookDeliveryId:x.deliveryId,webhookAttempts:x.attempts,webhookStatus:x.status}),n},transformData:(t,n,o,i)=>{const l=this.getTargetFormats(o);return l.length>0&&!l.includes(n.format)&&(n.format=l[0],n.status="transformed"),n},getSupportedFormats:()=>["json","text","binary"]}:{transformData:(t,n,o,i)=>{const l=this.getTargetFormats(o);return l.length>0&&!l.includes(n.format)&&(n.format=l[0],n.status="transformed"),n},getSupportedFormats:()=>["json","xml","binary"]}}getTargetFormats(e){return this.handlers.get(e)?.getSupportedFormats?.({type:e})||["json"]}createLokiHandler(){return{processData:(e,t,n)=>{const o=We.getLokiEmulationEngine(e.id);if(!o)return t.status="delivered",t;const i=t.payload;if(i?.query||i?.logql){const l=i.query||i.logql,u=i.startTime||i.start,f=i.endTime||i.end,p=i.limit||100,g=o.executeQuery(l,u,f,p);g.success?(t.status="delivered",t.latency=g.latency,t.payload={...t.payload,query:l,results:g.result||[],resultsCount:g.resultsCount}):(t.status="failed",t.error=g.error||"LogQL query execution failed",t.latency=g.latency||0)}else{const l=[],u=i?.stream||i?.labels||t.metadata?.labels||{app:e.data.label?.toLowerCase().replace(/\s+/g,"-")||"unknown",source:t.source.slice(0,8)};let f=[];if(i?.values&&Array.isArray(i.values))f=i.values;else if(i?.logs&&Array.isArray(i.logs)){const p=Date.now()*1e6;f=i.logs.map((g,m)=>[(p+m).toString(),String(g)])}else if(i?.log)f=[[(Date.now()*1e6).toString(),String(i.log)]];else if(typeof i=="string")f=[[(Date.now()*1e6).toString(),i]];else{const p=JSON.stringify(i);f=[[(Date.now()*1e6).toString(),p]]}if(f.length>0){l.push({stream:u,values:f});const p=o.processIngestion(l,t.source);p.success?(t.status="delivered",t.latency=10,t.payload={...t.payload,ingestedLines:p.ingestedLines,ingestedBytes:p.ingestedBytes}):(t.status="failed",t.error=p.error||"Log ingestion failed")}else t.status="failed",t.error="No log entries found in payload"}return t},getSupportedFormats:()=>["json","text"]}}createCRMDataMessage(e){const t=e.data.config||{},n=t.contacts||[],o=t.deals||[],i=Math.random()>.5?"contact":"deal";let l;if(i==="contact"&&n.length>0){const f=n[Math.floor(Math.random()*n.length)];l={operation:"create",type:"contact",data:{name:f.name,email:f.email,company:f.company,status:f.status}}}else if(o.length>0){const f=o[Math.floor(Math.random()*o.length)];l={operation:"update",type:"deal",data:{id:f.id,name:f.name,value:f.value,stage:f.stage}}}else l={operation:"create",type:"contact",data:{name:`Contact ${Date.now()}`,email:`contact${Date.now()}@example.com`}};const u=JSON.stringify(l);return{id:"",timestamp:Date.now(),source:e.id,target:"",connectionId:"",format:"json",payload:l,size:new Blob([u]).size,metadata:{contentType:"application/json",operation:l.operation},status:"pending"}}createERPDataMessage(e){const t=e.data.config||{},n=t.orders||[],o=t.inventory||[],i=Math.random()>.5?"order":"inventory";let l;if(i==="order"&&n.length>0){const f=n[Math.floor(Math.random()*n.length)];l={operation:"create",type:"order",data:{orderNumber:f.orderNumber,customer:f.customer,total:f.total,items:f.items}}}else if(o.length>0){const f=o[Math.floor(Math.random()*o.length)];l={operation:"update",type:"inventory",data:{sku:f.sku,quantity:f.quantity,status:f.status}}}else l={operation:"create",type:"order",data:{orderNumber:`ORD-${Date.now()}`,total:Math.random()*1e3}};const u=JSON.stringify(l);return{id:"",timestamp:Date.now(),source:e.id,target:"",connectionId:"",format:"json",payload:l,size:new Blob([u]).size,metadata:{contentType:"application/json",operation:l.operation},status:"pending"}}createPaymentDataMessage(e){const n=(e.data.config||{}).transactions||[];let o;if(n.length>0){const l=n[Math.floor(Math.random()*n.length)];o={operation:"process",type:"transaction",data:{id:l.id,amount:l.amount,currency:l.currency,status:l.status}}}else o={operation:"process",type:"transaction",data:{amount:Math.random()*1e3,currency:"USD"}};const i=JSON.stringify(o);return{id:"",timestamp:Date.now(),source:e.id,target:"",connectionId:"",format:"json",payload:o,size:new Blob([i]).size,metadata:{contentType:"application/json",operation:o.operation},status:"pending"}}generateQueryResults(e,t){const n=Math.floor(Math.random()*10)+1,o=[];for(let i=0;i<n;i++)o.push({id:i+1,name:`Record ${i+1}`,value:Math.random()*100,timestamp:new Date().toISOString()});return o}}const un=new nT;class sT{componentStates=new Map;setComponentState(e,t,n){const o={nodeId:e,state:t,degradedLevel:n?.degradedLevel||.5,failureRate:n?.failureRate||.1,latencyMultiplier:n?.latencyMultiplier||2,throughputMultiplier:n?.throughputMultiplier||.5};this.componentStates.set(e,o)}getComponentState(e){return this.componentStates.get(e)}isEnabled(e){const t=this.componentStates.get(e);return!t||t.state==="enabled"}applyStateEffects(e,t){const n=this.componentStates.get(e);if(!n||n.state==="enabled")return{...t};if(n.state==="disabled"||n.state==="failed")return{throughput:0,latency:1/0,errorRate:1,utilization:0};if(n.state==="degraded"){const o=n.degradedLevel||.5;return{throughput:t.throughput*(n.throughputMultiplier||.5)*(1-o*.5),latency:t.latency*(n.latencyMultiplier||2)*(1+o),errorRate:Math.min(1,t.errorRate+(n.failureRate||.1)*o),utilization:Math.min(1,t.utilization*(1+o*.3))}}return{...t}}reset(){this.componentStates.clear()}resetComponent(e){this.componentStates.delete(e)}getAllStates(){return Array.from(this.componentStates.values())}}const dr=new sT;class aT{queues=new Map;exchanges=new Map;bindings=new Map;queueMessages=new Map;unackedMessages=new Map;queueState=new Map;initialize(e){if(this.queues.clear(),this.exchanges.clear(),this.bindings.clear(),this.queueMessages.clear(),this.unackedMessages.clear(),this.queueState.clear(),e.queues)for(const t of e.queues)this.queues.set(t.name,{...t}),this.queueMessages.set(t.name,[]),this.unackedMessages.set(t.name,[]),this.queueState.set(t.name,{ready:t.ready||0,unacked:t.unacked||0,total:t.messages||0,lastUpdate:Date.now()});if(e.exchanges)for(const t of e.exchanges)this.exchanges.set(t.name,{...t}),this.bindings.set(t.name,[]);if(e.bindings)for(const t of e.bindings){const n=this.bindings.get(t.source)||[];n.push(t),this.bindings.set(t.source,n)}}routeMessage(e,t,n,o,i,l){const u=this.exchanges.get(e);if(!u)return[];const f=this.bindings.get(e)||[],p=[];for(const y of f)this.shouldRouteToQueue(u,y,t,i)&&p.push(y.destination);const g=`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,m=Date.now();for(const y of p){const x=this.queues.get(y);if(!x)continue;if(x.maxLength&&(this.queueMessages.get(y)||[]).length>=x.maxLength){x.deadLetterExchange&&this.routeToDeadLetterExchange(x.deadLetterExchange,x.deadLetterRoutingKey||t,n,o,i,l);continue}const S={id:g,timestamp:m,routingKey:t,exchange:e,payload:n,size:o,priority:l||x.maxPriority?l||0:void 0,headers:i,ttl:x.messageTtl?m+x.messageTtl:void 0},C=this.queueMessages.get(y)||[];C.push(S),x.maxPriority&&S.priority!==void 0&&C.sort((E,M)=>(M.priority||0)-(E.priority||0)),this.queueMessages.set(y,C)}return p}shouldRouteToQueue(e,t,n,o){switch(e.type){case"direct":return t.routingKey===n;case"topic":return this.matchTopicPattern(t.routingKey,n);case"fanout":return!0;case"headers":if(!o||!t.arguments)return!1;for(const[i,l]of Object.entries(t.arguments))if(!i.startsWith("x-")&&o[i]!==l)return!1;return!0;default:return!1}}matchTopicPattern(e,t){const n=e.replace(/\./g,"\\.").replace(/\*/g,"[^.]+").replace(/#/g,".*");return new RegExp(`^${n}$`).test(t)}routeToDeadLetterExchange(e,t,n,o,i,l){this.routeMessage(e,t,n,o,i,l)}processConsumption(e){const t=Date.now();for(const[n,o]of this.queues.entries()){let i=this.queueMessages.get(n)||[],l=this.unackedMessages.get(n)||[];const u=this.queueState.get(n)||{ready:0,unacked:0,total:0,lastUpdate:t};i=i.filter(E=>E.ttl&&t>E.ttl?(o.deadLetterExchange&&this.routeToDeadLetterExchange(o.deadLetterExchange,o.deadLetterRoutingKey||E.routingKey,E.payload,E.size,E.headers,E.priority),!1):!0),this.queueMessages.set(n,i);const g=(o.consumers||0)*10*e/1e3,m=Math.min(g,i.length),y=i.splice(0,m);l.push(...y),this.unackedMessages.set(n,l);const S=e/100*l.length,C=Math.min(S,l.length);l.splice(0,Math.floor(C)),this.unackedMessages.set(n,l),u.ready=i.length,u.unacked=l.length,u.total=i.length+l.length,u.lastUpdate=t,this.queueState.set(n,u)}}getQueueMetrics(e){const t=this.queues.get(e);if(!t)return null;const n=this.queueMessages.get(e)||[],o=this.unackedMessages.get(e)||[];this.queueState.get(e);const i=n.length,l=o.length;return{messages:i+l,ready:i,unacked:l,consumers:t.consumers||0}}getAllQueueMetrics(){const e=new Map;for(const t of this.queues.keys()){const n=this.getQueueMetrics(t);n&&e.set(t,n)}return e}getTotalQueueDepth(){let e=0;for(const t of this.queueMessages.values())e+=t.length;for(const t of this.unackedMessages.values())e+=t.length;return e}getActiveConnections(){let e=0;for(const t of this.queues.values())t.consumers&&(e+=t.consumers);return e+=this.exchanges.size,Math.max(1,e)}updateQueue(e,t){const n=this.queues.get(e);n&&(Object.assign(n,t),this.queues.set(e,n))}}class oT{queues=new Map;topics=new Map;subscriptions=new Map;queueMessages=new Map;topicMessages=new Map;subscriptionMessages=new Map;queueState=new Map;topicState=new Map;initialize(e){if(this.queues.clear(),this.topics.clear(),this.subscriptions.clear(),this.queueMessages.clear(),this.topicMessages.clear(),this.subscriptionMessages.clear(),this.queueState.clear(),this.topicState.clear(),e.queues)for(const t of e.queues)this.queues.set(t.name,{...t}),this.queueMessages.set(t.name,[]),this.queueState.set(t.name,{queueSize:t.queueSize||0,consumerCount:t.consumerCount||0,enqueueCount:t.enqueueCount||0,dequeueCount:t.dequeueCount||0,lastUpdate:Date.now()});if(e.topics)for(const t of e.topics)this.topics.set(t.name,{...t}),this.topicMessages.set(t.name,[]),this.subscriptions.set(t.name,[]),this.topicState.set(t.name,{subscriberCount:t.subscriberCount||0,enqueueCount:t.enqueueCount||0,dequeueCount:t.dequeueCount||0,lastUpdate:Date.now()});if(e.subscriptions)for(const t of e.subscriptions){const n=this.subscriptions.get(t.destination)||[];n.push(t),this.subscriptions.set(t.destination,n),this.subscriptionMessages.set(t.id,[])}}routeToQueue(e,t,n,o,i){if(!this.queues.get(e))return!1;const u=`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,f=Date.now(),p={id:u,timestamp:f,destination:e,payload:t,size:n,headers:o,priority:i},g=this.queueMessages.get(e)||[];g.push(p),i!==void 0&&g.sort((y,x)=>(x.priority||0)-(y.priority||0)),this.queueMessages.set(e,g);const m=this.queueState.get(e)||{queueSize:0,consumerCount:0,enqueueCount:0,dequeueCount:0,lastUpdate:f};return m.queueSize=g.length,m.enqueueCount=(m.enqueueCount||0)+1,m.lastUpdate=f,this.queueState.set(e,m),!0}publishToTopic(e,t,n,o,i){if(!this.topics.get(e))return[];const u=`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,f=Date.now(),p=this.subscriptions.get(e)||[],g=[],m={id:u,timestamp:f,destination:e,payload:t,size:n,headers:o,priority:i};for(const x of p){if(x.selector&&!this.matchesSelector(x.selector,o))continue;const S=this.subscriptionMessages.get(x.id)||[];S.push(m),this.subscriptionMessages.set(x.id,S),g.push(x.id),x.pendingQueueSize=(x.pendingQueueSize||0)+1,x.enqueueCounter=(x.enqueueCounter||0)+1}if(p.length===0){const x=this.topicMessages.get(e)||[];x.push(m),this.topicMessages.set(e,x)}const y=this.topicState.get(e)||{subscriberCount:0,enqueueCount:0,dequeueCount:0,lastUpdate:f};return y.enqueueCount=(y.enqueueCount||0)+1,y.lastUpdate=f,this.topicState.set(e,y),g}matchesSelector(e,t){if(!t||!e)return!0;try{const n=e.trim(),o=n.match(/^(\w+)\s*=\s*['"]([^'"]+)['"]$/);if(o){const l=o[1],u=o[2];return t[l]===u}const i=n.match(/^(\w+)\s*([><=]+)\s*(\d+)$/);if(i){const l=i[1],u=i[2],f=Number(i[3]),p=Number(t[l]);if(isNaN(p))return!1;switch(u){case">":return p>f;case"<":return p<f;case">=":return p>=f;case"<=":return p<=f;case"=":return p===f;default:return!1}}for(const l in t)if(n.includes(l))return!0;return!1}catch{return!0}}processConsumption(e){const t=Date.now();for(const[n,o]of this.queues.entries()){let i=this.queueMessages.get(n)||[];const l=this.queueState.get(n)||{queueSize:0,consumerCount:0,enqueueCount:0,dequeueCount:0,lastUpdate:t};i=i.filter(y=>!(y.ttl&&t>y.ttl)),this.queueMessages.set(n,i);const p=(o.consumerCount||l.consumerCount||0)*10*e/1e3,g=Math.min(p,i.length),m=i.splice(0,Math.floor(g));this.queueMessages.set(n,i),l.queueSize=i.length,l.dequeueCount=(l.dequeueCount||0)+m.length,l.lastUpdate=t,this.queueState.set(n,l)}for(const[n,o]of this.subscriptions.entries()){for(const l of o){let u=this.subscriptionMessages.get(l.id)||[];u=u.filter(y=>!(y.ttl&&t>y.ttl));const p=10*e/1e3,g=Math.min(p,u.length),m=u.splice(0,Math.floor(g));l.pendingQueueSize=u.length,l.dispatchedQueueSize=(l.dispatchedQueueSize||0)+m.length,l.dequeueCounter=(l.dequeueCounter||0)+m.length,this.subscriptionMessages.set(l.id,u)}const i=this.topicState.get(n);i&&(i.dequeueCount=o.reduce((l,u)=>l+(u.dequeueCounter||0),0),i.lastUpdate=t)}}getQueueMetrics(e){if(!this.queues.get(e))return null;const n=this.queueState.get(e);return n?{queueSize:n.queueSize,consumerCount:n.consumerCount,enqueueCount:n.enqueueCount,dequeueCount:n.dequeueCount}:null}getTopicMetrics(e){if(!this.topics.get(e))return null;const n=this.topicState.get(e);return n?{subscriberCount:n.subscriberCount,enqueueCount:n.enqueueCount,dequeueCount:n.dequeueCount}:null}getAllQueueMetrics(){const e=new Map;for(const t of this.queues.keys()){const n=this.getQueueMetrics(t);n&&e.set(t,n)}return e}getAllTopicMetrics(){const e=new Map;for(const t of this.topics.keys()){const n=this.getTopicMetrics(t);n&&e.set(t,n)}return e}getTotalQueueDepth(){let e=0;for(const t of this.queueMessages.values())e+=t.length;return e}getTotalTopicMessages(){let e=0;for(const t of this.subscriptionMessages.values())e+=t.length;for(const t of this.topicMessages.values())e+=t.length;return e}getActiveConnections(){let e=0;for(const t of this.queues.values())t.consumerCount&&(e+=t.consumerCount);for(const t of this.subscriptions.values())e+=t.length;return Math.max(1,e+1)}updateQueue(e,t){const n=this.queues.get(e);if(n){Object.assign(n,t),this.queues.set(e,n);const o=this.queueState.get(e);o&&t.consumerCount!==void 0&&(o.consumerCount=t.consumerCount)}}updateTopic(e,t){const n=this.topics.get(e);if(n){Object.assign(n,t),this.topics.set(e,n);const o=this.topicState.get(e);o&&t.subscriberCount!==void 0&&(o.subscriberCount=t.subscriberCount)}}}class rT{queues=new Map;queueMessages=new Map;inFlightMessages=new Map;dlqMessages=new Map;queueState=new Map;messageGroups=new Map;deduplicationIds=new Map;initialize(e){if(this.queues.clear(),this.queueMessages.clear(),this.inFlightMessages.clear(),this.dlqMessages.clear(),this.queueState.clear(),this.messageGroups.clear(),this.deduplicationIds.clear(),e.queues)for(const t of e.queues)this.queues.set(t.name,{...t}),this.queueMessages.set(t.name,[]),this.inFlightMessages.set(t.name,[]),this.queueState.set(t.name,{approximateMessages:0,approximateMessagesNotVisible:0,approximateMessagesDelayed:0,sentCount:0,receivedCount:0,deletedCount:0,dlqCount:0,lastUpdate:Date.now()}),t.type==="fifo"&&(this.messageGroups.set(t.name,new Map),this.deduplicationIds.set(t.name,new Set))}sendMessage(e,t,n,o,i,l){const u=this.queues.get(e);if(!u)return null;const f=Date.now(),p=`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,g=`${e}-${p}`;if(u.type==="fifo"){if(u.contentBasedDedup&&!l){const A=JSON.stringify(t);l=this.hashString(A)}if(l){const A=this.deduplicationIds.get(e);if(A&&A.has(l))return g;A?.add(l)}i||(i="default-group")}const m=u.messageRetention*24*60*60*1e3,y=f+m,x=u.delaySeconds*1e3,S=x>0?f+x:void 0,C={id:p,messageId:g,timestamp:f,queueName:e,payload:t,size:n,attributes:o,messageGroupId:i,messageDeduplicationId:l,receiveCount:0,retentionExpiresAt:y,delayUntil:S},E=this.queueMessages.get(e)||[];if(u.type==="fifo"&&i){const A=this.messageGroups.get(e);if(A){const T=A.get(i)||[];T.push(C),A.set(i,T)}}E.push(C),this.queueMessages.set(e,E);const M=this.queueState.get(e);if(M){const A=this.queueMessages.get(e)||[],T=this.inFlightMessages.get(e)||[],N=A.filter(D=>D.delayUntil&&f<D.delayUntil);M.approximateMessages=A.length,M.approximateMessagesNotVisible=T.length,M.approximateMessagesDelayed=N.length,M.sentCount=(M.sentCount||0)+1,M.lastUpdate=f}return g}receiveMessage(e,t=1,n){const o=this.queues.get(e);if(!o)return[];const i=Date.now(),u=(n!==void 0?n:o.visibilityTimeout)*1e3;let f=(this.queueMessages.get(e)||[]).filter(y=>!(y.delayUntil&&i<y.delayUntil||i>=y.retentionExpiresAt));if(o.type==="fifo"){const y=this.messageGroups.get(e);if(y){f=[];let x=0;for(const[S,C]of y.entries()){if(x>=t)break;if(C.length>0){const E=C[0];(!E.delayUntil||i>=E.delayUntil)&&i<E.retentionExpiresAt&&(f.push(E),x++)}}}}const p=Math.min(t,f.length),g=[];for(let y=0;y<p;y++){const x=f[y],S=`receipt_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;x.receiptHandle=S,x.receiveCount=(x.receiveCount||0)+1,x.firstReceivedAt||(x.firstReceivedAt=i);const C={message:x,receivedAt:i,visibilityTimeoutExpiresAt:i+u},E=this.inFlightMessages.get(e)||[];E.push(C),this.inFlightMessages.set(e,E);const M=this.queueMessages.get(e)||[],A=M.indexOf(x);if(A>-1&&M.splice(A,1),this.queueMessages.set(e,M),o.type==="fifo"&&x.messageGroupId){const T=this.messageGroups.get(e);if(T){const N=T.get(x.messageGroupId)||[],D=N.indexOf(x);D>-1&&N.splice(D,1),N.length===0?T.delete(x.messageGroupId):T.set(x.messageGroupId,N)}}g.push(x)}const m=this.queueState.get(e);return m&&(m.receivedCount=(m.receivedCount||0)+g.length,m.lastUpdate=i),g}deleteMessage(e,t){if(!this.queues.get(e))return!1;const o=this.inFlightMessages.get(e)||[],i=o.findIndex(u=>u.message.receiptHandle===t);if(i===-1)return!1;o[i],o.splice(i,1),this.inFlightMessages.set(e,o);const l=this.queueState.get(e);return l&&(l.deletedCount=(l.deletedCount||0)+1,l.lastUpdate=Date.now()),!0}processConsumption(e){const t=Date.now();for(const[n,o]of this.queues.entries()){const i=this.inFlightMessages.get(n)||[],l=[],u=[];for(const m of i)if(t>=m.visibilityTimeoutExpiresAt){const y=m.message;y.receiptHandle=void 0,o.maxReceiveCount&&y.receiveCount>=o.maxReceiveCount?this.sendToDLQ(o,y):l.push(y)}else u.push(m);if(this.inFlightMessages.set(n,u),l.length>0){const m=this.queueMessages.get(n)||[];if(o.type==="fifo"){const y=this.messageGroups.get(n);if(y)for(const x of l){const S=x.messageGroupId||"default-group",C=y.get(S)||[];C.push(x),y.set(S,C)}}m.push(...l),this.queueMessages.set(n,m)}const p=(this.queueMessages.get(n)||[]).filter(m=>t>=m.retentionExpiresAt?(o.deadLetterQueue&&this.sendToDLQ(o,m),!1):!0);if(this.queueMessages.set(n,p),o.type==="fifo"){const m=this.messageGroups.get(n);if(m)for(const[y,x]of m.entries()){const S=x.filter(C=>t>=C.retentionExpiresAt?(o.deadLetterQueue&&this.sendToDLQ(o,C),!1):!0);S.length===0?m.delete(y):m.set(y,S)}}const g=this.queueState.get(n);if(g){const m=this.queueMessages.get(n)||[],y=this.inFlightMessages.get(n)||[],x=m.filter(S=>S.delayUntil&&t<S.delayUntil);g.approximateMessages=m.length,g.approximateMessagesNotVisible=y.length,g.approximateMessagesDelayed=x.length,g.lastUpdate=t}}}sendToDLQ(e,t){if(!e.deadLetterQueue||!this.queues.get(e.deadLetterQueue))return;const o=this.dlqMessages.get(e.deadLetterQueue)||[];o.push(t),this.dlqMessages.set(e.deadLetterQueue,o);const i=this.queueState.get(e.deadLetterQueue);i&&(i.dlqCount=(i.dlqCount||0)+1,i.approximateMessages=o.length);const l=this.queueState.get(e.name);l&&(l.dlqCount=(l.dlqCount||0)+1)}hashString(e){let t=0;for(let n=0;n<e.length;n++){const o=e.charCodeAt(n);t=(t<<5)-t+o,t=t&t}return Math.abs(t).toString(36)}getQueueMetrics(e){if(!this.queues.get(e))return null;const n=this.queueState.get(e);return n?{approximateMessages:n.approximateMessages,approximateMessagesNotVisible:n.approximateMessagesNotVisible,approximateMessagesDelayed:n.approximateMessagesDelayed,sentCount:n.sentCount,receivedCount:n.receivedCount,deletedCount:n.deletedCount,dlqCount:n.dlqCount}:null}getAllQueueMetrics(){const e=new Map;for(const t of this.queues.keys()){const n=this.getQueueMetrics(t);n&&e.set(t,n)}return e}getTotalQueueDepth(){let e=0;for(const t of this.queueMessages.values())e+=t.length;for(const t of this.inFlightMessages.values())e+=t.length;return e}getActiveConnections(){let e=0;for(const t of this.queueState.values())(t.sentCount>0||t.receivedCount>0)&&(e+=1);return Math.max(1,e)}updateQueue(e,t){const n=this.queues.get(e);n&&(Object.assign(n,t),this.queues.set(e,n))}}class iT{queues=new Map;topics=new Map;subscriptions=new Map;queueMessages=new Map;topicMessages=new Map;subscriptionMessages=new Map;lockedMessages=new Map;deadLetterMessages=new Map;scheduledMessages=new Map;sessionMessages=new Map;queueState=new Map;subscriptionState=new Map;initialize(e){if(this.queues.clear(),this.topics.clear(),this.subscriptions.clear(),this.queueMessages.clear(),this.topicMessages.clear(),this.subscriptionMessages.clear(),this.lockedMessages.clear(),this.deadLetterMessages.clear(),this.scheduledMessages.clear(),this.sessionMessages.clear(),this.queueState.clear(),this.subscriptionState.clear(),e.queues)for(const t of e.queues)this.queues.set(t.name,{...t}),this.queueMessages.set(t.name,[]),this.lockedMessages.set(t.name,[]),this.deadLetterMessages.set(t.name,[]),this.scheduledMessages.set(t.name,[]),this.queueState.set(t.name,{activeMessageCount:t.activeMessageCount||0,deadLetterMessageCount:t.deadLetterMessageCount||0,scheduledMessageCount:t.scheduledMessageCount||0,sentCount:0,receivedCount:0,completedCount:0,abandonedCount:0,lastUpdate:Date.now()}),t.enableSessions&&this.sessionMessages.set(t.name,new Map);if(e.topics){for(const t of e.topics)if(this.topics.set(t.name,{...t}),this.topicMessages.set(t.name,[]),this.scheduledMessages.set(t.name,[]),this.subscriptions.set(t.name,[]),t.subscriptions)for(const n of t.subscriptions){const o=this.subscriptions.get(t.name)||[];o.push(n),this.subscriptions.set(t.name,o);const i=`${t.name}/subscriptions/${n.name}`;this.subscriptionMessages.set(i,[]),this.lockedMessages.set(i,[]),this.deadLetterMessages.set(i,[]),this.subscriptionState.set(i,{activeMessageCount:n.activeMessageCount||0,deadLetterMessageCount:0,sentCount:0,receivedCount:0,completedCount:0,abandonedCount:0,lastUpdate:Date.now()}),this.sessionMessages.set(i,new Map)}}}sendToQueue(e,t,n,o,i,l){const u=this.queues.get(e);if(!u)return null;const f=Date.now(),p=`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,g=`${e}-${p}`,m=u.defaultMessageTimeToLive*1e3,y=f+m,x={id:p,messageId:g,timestamp:f,destination:e,payload:t,size:n,properties:o,sessionId:i,scheduledEnqueueTime:l,expirationTime:y,deliveryCount:0,enqueuedTime:l||f};if(l&&l>f){const C=this.scheduledMessages.get(e)||[];C.push(x),this.scheduledMessages.set(e,C);const E=this.queueState.get(e);return E&&(E.scheduledMessageCount=C.length),g}if(u.enableSessions&&i){const C=this.sessionMessages.get(e);if(C){const E=C.get(i)||[];E.push(x),C.set(i,E)}}else{const C=this.queueMessages.get(e)||[];C.push(x),this.queueMessages.set(e,C)}const S=this.queueState.get(e);if(S){const C=this.getAvailableMessages(e);S.activeMessageCount=C.length,S.sentCount=(S.sentCount||0)+1,S.lastUpdate=f}return g}publishToTopic(e,t,n,o,i){const l=this.topics.get(e);if(!l)return[];const u=Date.now(),f=`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,p=`${e}-${f}`,g=l.defaultMessageTimeToLive*1e3,m=u+g,y={id:f,messageId:p,timestamp:u,destination:e,payload:t,size:n,properties:o,scheduledEnqueueTime:i,expirationTime:m,deliveryCount:0,enqueuedTime:i||u},x=[];if(i&&i>u){const C=this.scheduledMessages.get(e)||[];return C.push(y),this.scheduledMessages.set(e,C),[p]}const S=this.subscriptions.get(e)||[];if(S.length===0)return[];for(const C of S){const E=`${e}/subscriptions/${C.name}`,M=this.subscriptionMessages.get(E)||[],A={...y,id:`${f}-${C.name}`,messageId:`${p}-${C.name}`,subscriptionName:C.name};M.push(A),this.subscriptionMessages.set(E,M),x.push(A.messageId);const T=this.subscriptionState.get(E);if(T){const N=this.getAvailableSubscriptionMessages(E);T.activeMessageCount=N.length,T.sentCount=(T.sentCount||0)+1,T.lastUpdate=u}}return x}receiveFromQueue(e,t,n){const o=this.queues.get(e);if(!o)return null;const i=Date.now(),l=(t||o.lockDuration)*1e3,u=i+l;let f;if(o.enableSessions&&n){const y=this.sessionMessages.get(e);if(!y)return null;f=y.get(n)||[]}else f=this.getAvailableMessages(e);if(f.length===0)return null;const p=f.shift();p.deliveryCount=(p.deliveryCount||0)+1,p.lockedUntil=u,p.lockToken=`lock_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;const g=this.lockedMessages.get(e)||[];if(g.push({message:p,lockedAt:i,lockExpiresAt:u}),this.lockedMessages.set(e,g),o.enableSessions&&n){const y=this.sessionMessages.get(e);if(y){const x=y.get(n)||[],S=x.findIndex(C=>C.id===p.id);S>=0&&(x.splice(S,1),y.set(n,x))}}const m=this.queueState.get(e);if(m){const y=this.getAvailableMessages(e);m.activeMessageCount=y.length,m.receivedCount=(m.receivedCount||0)+1,m.lastUpdate=i}return p}receiveFromSubscription(e,t,n){const o=`${e}/subscriptions/${t}`,i=this.getAvailableSubscriptionMessages(o);if(i.length===0)return null;const l=this.subscriptions.get(e)?.find(x=>x.name===t);if(!l)return null;const u=Date.now(),f=(n||l.lockDuration)*1e3,p=u+f,g=i.shift();g.deliveryCount=(g.deliveryCount||0)+1,g.lockedUntil=p,g.lockToken=`lock_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;const m=this.lockedMessages.get(o)||[];m.push({message:g,lockedAt:u,lockExpiresAt:p}),this.lockedMessages.set(o,m);const y=this.subscriptionState.get(o);if(y){const x=this.getAvailableSubscriptionMessages(o);y.activeMessageCount=x.length,y.receivedCount=(y.receivedCount||0)+1,y.lastUpdate=u}return g}completeMessage(e,t){const n=this.lockedMessages.get(e)||[],o=n.findIndex(l=>l.message.lockToken===t);if(o<0)return!1;if(n.splice(o,1),this.lockedMessages.set(e,n),this.queues.has(e)){const l=this.queueState.get(e);l&&(l.completedCount=(l.completedCount||0)+1,l.lastUpdate=Date.now())}else{const l=this.subscriptionState.get(e);l&&(l.completedCount=(l.completedCount||0)+1,l.lastUpdate=Date.now())}return!0}abandonMessage(e,t){const n=this.lockedMessages.get(e)||[],o=n.findIndex(p=>p.message.lockToken===t);if(o<0)return!1;const i=n[o];n.splice(o,1),this.lockedMessages.set(e,n);const l=i.message;l.lockToken=void 0,l.lockedUntil=void 0;const u=this.queues.has(e),f=u?this.queues.get(e)?.maxDeliveryCount||10:this.subscriptions.get(l.destination)?.find(p=>p.name===l.subscriptionName)?.maxDeliveryCount||10;if(l.deliveryCount>=f){const p=this.deadLetterMessages.get(e)||[];if(p.push(l),this.deadLetterMessages.set(e,p),u){const g=this.queueState.get(e);g&&(g.deadLetterMessageCount=p.length,g.abandonedCount=(g.abandonedCount||0)+1,g.lastUpdate=Date.now())}else{const g=this.subscriptionState.get(e);g&&(g.deadLetterMessageCount=p.length,g.abandonedCount=(g.abandonedCount||0)+1,g.lastUpdate=Date.now())}}else{if(u){const p=this.queues.get(e);if(p)if(p.enableSessions&&l.sessionId){const g=this.sessionMessages.get(e);if(g){const m=g.get(l.sessionId)||[];m.push(l),g.set(l.sessionId,m)}}else{const g=this.queueMessages.get(e)||[];g.push(l),this.queueMessages.set(e,g)}}else{const p=this.subscriptionMessages.get(e)||[];p.push(l),this.subscriptionMessages.set(e,p)}if(u){const p=this.queueState.get(e);if(p){const g=this.getAvailableMessages(e);p.activeMessageCount=g.length,p.abandonedCount=(p.abandonedCount||0)+1,p.lastUpdate=Date.now()}}else{const p=this.subscriptionState.get(e);if(p){const g=this.getAvailableSubscriptionMessages(e);p.activeMessageCount=g.length,p.abandonedCount=(p.abandonedCount||0)+1,p.lastUpdate=Date.now()}}}return!0}processConsumption(e){const t=Date.now();for(const[n,o]of this.queues.entries()){const i=this.scheduledMessages.get(n)||[],l=this.queueMessages.get(n)||[],u=this.sessionMessages.get(n);for(let m=i.length-1;m>=0;m--){const y=i[m];if(y.scheduledEnqueueTime&&y.scheduledEnqueueTime<=t)if(i.splice(m,1),o.enableSessions&&y.sessionId&&u){const x=u.get(y.sessionId)||[];x.push(y),u.set(y.sessionId,x)}else l.push(y)}this.scheduledMessages.set(n,i),this.queueMessages.set(n,l);const f=this.lockedMessages.get(n)||[];for(let m=f.length-1;m>=0;m--){const y=f[m];y.lockExpiresAt<=t&&(f.splice(m,1),this.abandonMessage(n,y.message.lockToken))}this.lockedMessages.set(n,f);const p=this.getAvailableMessages(n);for(let m=p.length-1;m>=0;m--){const y=p[m];if(y.expirationTime<=t&&(p.splice(m,1),o.enableDeadLetteringOnMessageExpiration)){const x=this.deadLetterMessages.get(n)||[];x.push(y),this.deadLetterMessages.set(n,x)}}this.queueMessages.set(n,p);const g=this.queueState.get(n);g&&(g.activeMessageCount=this.getAvailableMessages(n).length,g.deadLetterMessageCount=(this.deadLetterMessages.get(n)||[]).length,g.scheduledMessageCount=i.length,g.lastUpdate=t)}for(const[n,o]of this.topics.entries()){const i=this.scheduledMessages.get(n)||[];for(let u=i.length-1;u>=0;u--){const f=i[u];f.scheduledEnqueueTime&&f.scheduledEnqueueTime<=t&&(i.splice(u,1),this.publishToTopic(n,f.payload,f.size,f.properties))}this.scheduledMessages.set(n,i);const l=this.subscriptions.get(n)||[];for(const u of l){const f=`${n}/subscriptions/${u.name}`,p=this.lockedMessages.get(f)||[];for(let y=p.length-1;y>=0;y--){const x=p[y];x.lockExpiresAt<=t&&(p.splice(y,1),this.abandonMessage(f,x.message.lockToken))}this.lockedMessages.set(f,p);const g=this.getAvailableSubscriptionMessages(f);for(let y=g.length-1;y>=0;y--){const x=g[y];if(x.expirationTime<=t&&(g.splice(y,1),u.enableDeadLetteringOnMessageExpiration)){const S=this.deadLetterMessages.get(f)||[];S.push(x),this.deadLetterMessages.set(f,S)}}this.subscriptionMessages.set(f,g);const m=this.subscriptionState.get(f);m&&(m.activeMessageCount=this.getAvailableSubscriptionMessages(f).length,m.deadLetterMessageCount=(this.deadLetterMessages.get(f)||[]).length,m.lastUpdate=t)}}}getAvailableMessages(e){if(!this.queues.get(e))return[];const n=Date.now();return(this.queueMessages.get(e)||[]).filter(i=>i.expirationTime>n)}getAvailableSubscriptionMessages(e){const t=Date.now();return(this.subscriptionMessages.get(e)||[]).filter(o=>o.expirationTime>t)}getTotalQueueDepth(){let e=0;for(const t of this.queues.keys())e+=this.getAvailableMessages(t).length;return e}getTotalSubscriptionMessages(){let e=0;for(const t of this.subscriptionMessages.keys())e+=this.getAvailableSubscriptionMessages(t).length;return e}getQueueMetrics(e){const t=this.queueState.get(e);return t?{activeMessageCount:t.activeMessageCount,deadLetterMessageCount:t.deadLetterMessageCount,scheduledMessageCount:t.scheduledMessageCount,sentCount:t.sentCount,receivedCount:t.receivedCount,completedCount:t.completedCount,abandonedCount:t.abandonedCount}:null}getSubscriptionMetrics(e,t){const n=`${e}/subscriptions/${t}`,o=this.subscriptionState.get(n);return o?{activeMessageCount:o.activeMessageCount,deadLetterMessageCount:o.deadLetterMessageCount,sentCount:o.sentCount,receivedCount:o.receivedCount,completedCount:o.completedCount,abandonedCount:o.abandonedCount}:null}getAllQueueMetrics(){const e=new Map;for(const t of this.queues.keys()){const n=this.getQueueMetrics(t);n&&e.set(t,n)}return e}getAllSubscriptionMetrics(){const e=new Map;for(const[t,n]of this.subscriptionState.entries())e.set(t,{activeMessageCount:n.activeMessageCount,deadLetterMessageCount:n.deadLetterMessageCount,sentCount:n.sentCount,receivedCount:n.receivedCount,completedCount:n.completedCount,abandonedCount:n.abandonedCount});return e}getActiveConnections(){return this.queues.size+this.topics.size}}class cT{topics=new Map;subscriptions=new Map;topicSubscriptions=new Map;topicMessages=new Map;subscriptionMessages=new Map;unackedMessages=new Map;orderingKeyQueues=new Map;topicState=new Map;subscriptionState=new Map;initialize(e){if(this.topics.clear(),this.subscriptions.clear(),this.topicSubscriptions.clear(),this.topicMessages.clear(),this.subscriptionMessages.clear(),this.unackedMessages.clear(),this.orderingKeyQueues.clear(),this.topicState.clear(),this.subscriptionState.clear(),e.topics)for(const t of e.topics)this.topics.set(t.name,{...t}),this.topicMessages.set(t.name,[]),this.topicSubscriptions.set(t.name,[]),this.orderingKeyQueues.set(t.name,new Map),this.topicState.set(t.name,{messageCount:t.messageCount||0,byteCount:t.byteCount||0,publishedCount:0,lastUpdate:Date.now()});if(e.subscriptions)for(const t of e.subscriptions){this.subscriptions.set(t.name,{...t}),this.subscriptionMessages.set(t.name,[]),this.unackedMessages.set(t.name,[]);const n=this.topicSubscriptions.get(t.topic)||[];n.includes(t.name)||n.push(t.name),this.topicSubscriptions.set(t.topic,n),this.subscriptionState.set(t.name,{messageCount:t.messageCount||0,unackedMessageCount:t.unackedMessageCount||0,deliveredCount:0,acknowledgedCount:0,nackedCount:0,lastUpdate:Date.now()})}}publishToTopic(e,t,n,o,i){if(!this.topics.get(e))return null;const u=Date.now(),f=`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,p=u,g={id:`pubsub_${f}`,messageId:f,publishTime:p,data:t,attributes:o,orderingKey:i,size:n},m=this.topicMessages.get(e)||[];if(i){const S=this.orderingKeyQueues.get(e)||new Map,C=S.get(i)||[];C.push(g),S.set(i,C),this.orderingKeyQueues.set(e,S)}else m.push(g),this.topicMessages.set(e,m);const y=this.topicSubscriptions.get(e)||[];for(const S of y){const C=this.subscriptions.get(S);if(!C)continue;const E={...g,id:`${g.id}_${S}`},M=this.subscriptionMessages.get(S)||[];C.enableMessageOrdering,M.push(E),this.subscriptionMessages.set(S,M)}const x=this.topicState.get(e)||{messageCount:0,byteCount:0,publishedCount:0,lastUpdate:u};return x.messageCount=m.length+(i&&this.orderingKeyQueues.get(e)?.get(i)?.length||0),x.byteCount=(x.byteCount||0)+n,x.publishedCount=(x.publishedCount||0)+1,x.lastUpdate=u,this.topicState.set(e,x),f}pullFromSubscription(e,t=100){const n=this.subscriptions.get(e);if(!n)return[];const o=this.subscriptionMessages.get(e)||[];if(o.length===0)return[];const i=Date.now(),l=n.ackDeadlineSeconds*1e3,u=[],f=[];if(n.enableMessageOrdering){const m=new Map;for(const y of o){const x=y.orderingKey||"__no_key__";m.has(x)||m.set(x,[]),m.get(x).push(y)}for(const[y,x]of m.entries()){if(u.length>=t)break;const S=Math.min(x.length,t-u.length),C=x.splice(0,S);u.push(...C),f.push(...x)}for(const[y,x]of m.entries())x.length>0&&f.find(S=>(S.orderingKey||"__no_key__")===y)===void 0&&f.push(...x)}else{const m=Math.min(o.length,t);u.push(...o.splice(0,m)),f.push(...o)}this.subscriptionMessages.set(e,f);const p=this.unackedMessages.get(e)||[];for(const m of u){const y=`ack_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;m.ackId=y,p.push({message:m,subscriptionName:e,ackDeadlineExpiresAt:i+l,deliveryAttempt:1,orderingKey:m.orderingKey})}this.unackedMessages.set(e,p);const g=this.subscriptionState.get(e)||{messageCount:0,unackedMessageCount:0,deliveredCount:0,acknowledgedCount:0,nackedCount:0,lastUpdate:i};return g.messageCount=f.length,g.unackedMessageCount=p.length,g.deliveredCount=(g.deliveredCount||0)+u.length,g.lastUpdate=i,this.subscriptionState.set(e,g),u}ackMessage(e,t){if(!this.subscriptions.get(e))return!1;const o=this.unackedMessages.get(e)||[],i=o.length,l=o.filter(u=>u.message.ackId!==t);if(this.unackedMessages.set(e,l),l.length<i){const u=this.subscriptionState.get(e);return u&&(u.unackedMessageCount=l.length,u.acknowledgedCount=(u.acknowledgedCount||0)+1,u.lastUpdate=Date.now()),!0}return!1}nackMessage(e,t){if(!this.subscriptions.get(e))return!1;const o=this.unackedMessages.get(e)||[],i=o.findIndex(g=>g.message.ackId===t);if(i===-1)return!1;const u=o[i].message;o.splice(i,1),this.unackedMessages.set(e,o);const f=this.subscriptionMessages.get(e)||[];u.ackId=void 0,f.push(u),this.subscriptionMessages.set(e,f);const p=this.subscriptionState.get(e);return p&&(p.unackedMessageCount=o.length,p.messageCount=f.length,p.nackedCount=(p.nackedCount||0)+1,p.lastUpdate=Date.now()),!0}processConsumption(e){const t=Date.now();for(const[n,o]of this.unackedMessages.entries()){if(!this.subscriptions.get(n))continue;const l=[],u=[];for(const f of o)t>=f.ackDeadlineExpiresAt?l.push(f):u.push(f);if(l.length>0){const f=this.subscriptionMessages.get(n)||[];for(const g of l){const m=g.message;m.ackId=void 0,f.push(m)}this.subscriptionMessages.set(n,f);const p=this.subscriptionState.get(n);p&&(p.unackedMessageCount=u.length,p.messageCount=f.length)}this.unackedMessages.set(n,u)}for(const[n,o]of this.subscriptions.entries())if(o.pushEndpoint){const i=this.subscriptionMessages.get(n)||[];if(i.length>0){const u=Math.min(i.length,10),f=i.splice(0,u),p=this.unackedMessages.get(n)||[],g=Date.now(),m=o.ackDeadlineSeconds*1e3;for(const x of f){const S=`ack_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;x.ackId=S,p.push({message:x,subscriptionName:n,ackDeadlineExpiresAt:g+m,deliveryAttempt:1,orderingKey:x.orderingKey})}this.subscriptionMessages.set(n,i),this.unackedMessages.set(n,p);const y=this.subscriptionState.get(n);y&&(y.messageCount=i.length,y.unackedMessageCount=p.length,y.deliveredCount=(y.deliveredCount||0)+f.length)}}for(const[n,o]of this.topics.entries()){const l=(o.messageRetentionDuration||604800)*1e3,u=this.topicMessages.get(n)||[],f=Date.now(),p=u.filter(g=>f-g.publishTime<l);if(p.length<u.length){u.length-p.length,this.topicMessages.set(n,p);const g=this.topicState.get(n);g&&(g.messageCount=p.length)}}}getTopicMetrics(e){if(!this.topics.get(e))return null;const n=this.topicState.get(e);return n?{messageCount:n.messageCount,byteCount:n.byteCount,publishedCount:n.publishedCount}:null}getSubscriptionMetrics(e){if(!this.subscriptions.get(e))return null;const n=this.subscriptionState.get(e);return n?{messageCount:n.messageCount,unackedMessageCount:n.unackedMessageCount,deliveredCount:n.deliveredCount,acknowledgedCount:n.acknowledgedCount,nackedCount:n.nackedCount}:null}getAllTopicMetrics(){const e=new Map;for(const t of this.topics.keys()){const n=this.getTopicMetrics(t);n&&e.set(t,n)}return e}getAllSubscriptionMetrics(){const e=new Map;for(const t of this.subscriptions.keys()){const n=this.getSubscriptionMetrics(t);n&&e.set(t,n)}return e}getTotalTopicMessages(){let e=0;for(const t of this.topicMessages.values())e+=t.length;for(const t of this.orderingKeyQueues.values())for(const n of t.values())e+=n.length;return e}getTotalUnackedMessages(){let e=0;for(const t of this.unackedMessages.values())e+=t.length;return e}getActiveConnections(){let e=0;for(const t of this.subscriptions.values())t.pushEndpoint,e+=1;return Math.max(1,e+1)}updateTopic(e,t){const n=this.topics.get(e);n&&(Object.assign(n,t),this.topics.set(e,n))}updateSubscription(e,t){const n=this.subscriptions.get(e);n&&(Object.assign(n,t),this.subscriptions.set(e,n))}}class lT{services=new Map;routes=new Map;upstreams=new Map;consumers=new Map;plugins=[];roundRobinCounters=new Map;connectionCounts=new Map;consistentHashRing=new Map;rateLimitCounters=new Map;initialize(e){if(this.services.clear(),this.routes.clear(),this.upstreams.clear(),this.consumers.clear(),this.plugins=[],this.roundRobinCounters.clear(),this.connectionCounts.clear(),this.consistentHashRing.clear(),this.rateLimitCounters.clear(),e.services)for(const t of e.services)this.services.set(t.id,{...t});if(e.routes)for(const t of e.routes)this.routes.set(t.id,{...t});if(e.upstreams){for(const t of e.upstreams)if(this.upstreams.set(t.name,{...t}),this.roundRobinCounters.set(t.name,0),t.algorithm==="consistent-hashing"&&t.targets){const n=[...t.targets].filter(o=>o.health==="healthy").sort((o,i)=>o.target.localeCompare(i.target));this.consistentHashRing.set(t.name,n.map(o=>o.target))}}if(e.consumers)for(const t of e.consumers)this.consumers.set(t.id,{...t});e.plugins&&(this.plugins=e.plugins.filter(t=>t.enabled))}routeRequest(e){const t=Date.now(),n=this.matchRoute(e);if(!n)return{match:null,response:{status:404,error:"No route matched",latency:Date.now()-t}};const o=this.executePlugins(e,n,"access");if(o.blocked)return{match:n,response:{status:o.status||403,error:o.error||"Request blocked by plugin",latency:Date.now()-t}};const i=this.selectUpstreamTarget(n.service);if(!i)return{match:n,response:{status:503,error:"No healthy upstream target available",latency:Date.now()-t}};this.transformPath(e.path,n);const l={status:200,latency:Date.now()-t};return l.latency=(l.latency||0)+this.simulateUpstreamLatency(i),{match:n,response:l,target:i}}matchRoute(e){const t=Array.from(this.routes.values()).sort((n,o)=>(o.priority||0)-(n.priority||0));for(const n of t){if(n.method&&n.method.toUpperCase()!==e.method.toUpperCase())continue;const o=this.matchPath(n.path,e.path);if(o){const i=this.services.get(n.service);if(!i||!i.enabled)continue;return{route:n,service:i,matchedPath:o.matched,remainingPath:o.remaining}}}return null}matchPath(e,t){if(t.startsWith(e))return{matched:e,remaining:t.substring(e.length)};try{if(new RegExp(`^${e}$`).test(t))return{matched:t,remaining:""}}catch{}return null}selectUpstreamTarget(e){const t=e.upstream||e.name,n=this.upstreams.get(t);if(!n||!n.targets||n.targets.length===0)return e.url;const o=n.targets.filter(l=>l.health==="healthy");if(o.length===0)return null;switch(n.algorithm||"round-robin"){case"round-robin":return this.selectRoundRobin(t,o);case"consistent-hashing":return this.selectConsistentHash(t,o,e.name);case"least-connections":return this.selectLeastConnections(o);default:return o[0].target}}selectRoundRobin(e,t){const n=this.roundRobinCounters.get(e)||0,o=t[n%t.length];return this.roundRobinCounters.set(e,(n+1)%t.length),o.target}selectConsistentHash(e,t,n){const i=this.simpleHash(n)%t.length;return t[i].target}selectLeastConnections(e){let t=1/0,n=e[0].target;for(const i of e){const l=this.connectionCounts.get(i.target)||0;l<t&&(t=l,n=i.target)}const o=this.connectionCounts.get(n)||0;return this.connectionCounts.set(n,o+1),n}simpleHash(e){let t=0;for(let n=0;n<e.length;n++){const o=e.charCodeAt(n);t=(t<<5)-t+o,t=t&t}return Math.abs(t)}transformPath(e,t){return t.route.stripPath?t.remainingPath||"/":e}executePlugins(e,t,n){const o=this.plugins.filter(i=>!(i.route&&i.route!==t.route.id||i.service&&i.service!==t.service.id));for(const i of o){const l=this.executePlugin(i,e,t,n);if(l.blocked)return l}return{blocked:!1}}executePlugin(e,t,n,o){const i=e.config||{};switch(e.name){case"rate-limiting":return this.executeRateLimiting(e,t,n,i);case"key-auth":return this.executeKeyAuth(e,t,n,i);case"jwt":return this.executeJWT(e,t,n,i);case"cors":return{blocked:!1};case"ip-restriction":return this.executeIPRestriction(e,t,n,i);default:return{blocked:!1}}}executeRateLimiting(e,t,n,o){const i=t.consumerId||n.service.id||n.route.id,l=Date.now();let u=this.rateLimitCounters.get(e.id);u||(u=new Map,this.rateLimitCounters.set(e.id,u));let f=u.get(i);(!f||f.resetAt<l)&&(f={count:0,resetAt:l+6e4},u.set(i,f));const p=o.minute||1e3;return o.hour,f.count++,f.count>p?{blocked:!0,status:429,error:"Rate limit exceeded (per minute)"}:{blocked:!1}}executeKeyAuth(e,t,n,o){const i=o.key_names||["apikey"],l=t.apiKey||t.headers?.[i[0]]||t.query?.[i[0]];return l?Array.from(this.consumers.values()).find(f=>f.credentials?.some(p=>p.type==="key-auth"&&p.key===l))?{blocked:!1}:{blocked:!0,status:401,error:"Invalid API key"}:{blocked:!0,status:401,error:"API key required"}}executeJWT(e,t,n,o){const i=t.headers?.Authorization;return!i||!i.startsWith("Bearer ")?{blocked:!0,status:401,error:"JWT token required"}:{blocked:!1}}executeIPRestriction(e,t,n,o){const i=t.headers?.["X-Forwarded-For"]||t.headers?.["X-Real-IP"]||"unknown",l=o.whitelist||[];return(o.blacklist||[]).includes(i)?{blocked:!0,status:403,error:"IP address blocked"}:l.length>0&&!l.includes(i)?{blocked:!0,status:403,error:"IP address not whitelisted"}:{blocked:!1}}simulateUpstreamLatency(e){return 10+Math.random()*40}getStats(){return{services:this.services.size,routes:this.routes.size,upstreams:this.upstreams.size,consumers:this.consumers.size,plugins:this.plugins.length}}}class uT{proxies=new Map;policies=[];organization;environment;quotaCounters=new Map;spikeArrestBuckets=new Map;apiKeyCache=new Map;oauthTokenCache=new Map;jwtTokenCache=new Map;proxyMetrics=new Map;initialize(e){if(this.proxies.clear(),this.policies=[],this.quotaCounters.clear(),this.spikeArrestBuckets.clear(),this.apiKeyCache.clear(),this.oauthTokenCache.clear(),this.jwtTokenCache.clear(),this.proxyMetrics.clear(),this.organization=e.organization||"archiphoenix-org",this.environment=e.environment||"prod",e.proxies)for(const t of e.proxies)this.proxies.set(t.name,{...t}),this.proxyMetrics.set(t.name,{requestCount:0,errorCount:0,totalLatency:0,lastRequestTime:0}),t.spikeArrest&&t.spikeArrest>0&&this.spikeArrestBuckets.set(t.name,{tokens:t.spikeArrest,lastRefill:Date.now(),rate:t.spikeArrest});e.policies&&(this.policies=e.policies.filter(t=>t.enabled))}routeRequest(e){const t=Date.now(),n=this.matchProxy(e);if(!n)return{match:null,response:{status:404,error:"No API proxy matched for path",latency:Date.now()-t}};if(n.proxy.status==="undeployed")return this.updateProxyMetrics(n.proxy.name,!1,Date.now()-t),{match:n,response:{status:503,error:`Proxy '${n.proxy.name}' is not deployed`,latency:Date.now()-t}};const o=this.policies.filter(x=>x.enabled&&(x.executionFlow==="PreFlow"||!x.executionFlow&&this.isPreFlowPolicy(x.type))),i=this.executePolicies(o,e,n,"PreFlow");if(i.blocked)return this.updateProxyMetrics(n.proxy.name,!0,Date.now()-t),{match:n,response:{status:i.status||401,error:i.error||"Authentication failed",latency:Date.now()-t}};const l=this.policies.filter(x=>x.enabled&&(x.executionFlow==="RequestFlow"||!x.executionFlow&&this.isRequestFlowPolicy(x.type))),u=this.executePolicies(l,e,n,"RequestFlow");if(u.blocked)return this.updateProxyMetrics(n.proxy.name,!0,Date.now()-t),{match:n,response:{status:u.status||429,error:u.error||"Request policy violation",latency:Date.now()-t}};const f=this.buildTargetUrl(n.proxy,n.remainingPath),p=this.simulateUpstreamLatency(f),g=Date.now()-t+p,m=this.policies.filter(x=>x.enabled&&(x.executionFlow==="PostFlow"||!x.executionFlow&&this.isPostFlowPolicy(x.type))),y={status:200,latency:g};return this.executePolicies(m,e,n,"PostFlow",y),this.updateProxyMetrics(n.proxy.name,!1,g),{match:n,response:y,target:f}}matchProxy(e){const t=Array.from(this.proxies.values()).filter(n=>n.status==="deployed"||n.status===void 0).sort((n,o)=>o.basePath.length-n.basePath.length);for(const n of t)if(e.path.startsWith(n.basePath)){const o=e.path.slice(n.basePath.length)||"/";return{proxy:n,matchedPath:n.basePath,remainingPath:o}}return null}isPreFlowPolicy(e){return["verify-api-key","oauth","jwt"].includes(e)}isRequestFlowPolicy(e){return["quota","spike-arrest"].includes(e)}isPostFlowPolicy(e){return["cors","xml-to-json"].includes(e)}evaluateCondition(e,t,n){if(!e)return!0;try{if(e.includes("request.path")){const o=e.match(/request\.path\s*[=!]=\s*['"]([^'"]+)['"]/);if(o)return t.path===o[1]}return e.length>0}catch{return!0}}executePolicies(e,t,n,o,i){for(const l of e)if(this.evaluateCondition(l.condition,t,n))if(o==="PreFlow"){const u=this.executePreFlowPolicy(l,t,n);if(u.blocked)return u}else if(o==="RequestFlow"){const u=this.executeRequestFlowPolicy(l,t,n);if(u.blocked)return u}else o==="PostFlow"&&i&&this.executePostFlowPolicy(l,t,n,i);return{blocked:!1}}executePreFlowPolicy(e,t,n){if(n.proxy,e.type==="verify-api-key"){const o=t.apiKey||t.headers?.["X-API-Key"]||t.headers?.apikey||t.query?.apikey;if(!o)return{blocked:!0,status:401,error:"API key is required"};if(!this.validateApiKey(o))return{blocked:!0,status:401,error:"Invalid API key"}}if(e.type==="oauth"&&n.proxy.enableOAuth){const i=t.oauthToken||t.headers?.Authorization?.replace("Bearer ","")||t.headers?.Authorization?.replace("OAuth ","");if(!i)return{blocked:!0,status:401,error:"OAuth token is required"};if(!this.validateOAuthToken(i))return{blocked:!0,status:401,error:"Invalid or expired OAuth token"}}if(e.type==="jwt"){const o=n.proxy;if(o.jwtIssuer){const i=t.jwtToken||t.headers?.Authorization?.replace("Bearer ","")||t.headers?.["X-JWT-Token"];if(!i)return{blocked:!0,status:401,error:"JWT token is required"};if(!this.validateJWTToken(i,o.jwtIssuer))return{blocked:!0,status:401,error:"Invalid or expired JWT token"}}}return{blocked:!1}}executeRequestFlowPolicy(e,t,n){const o=n.proxy,i=t.headers?.["X-Consumer-ID"]||"default";if(e.type==="quota"){const l=e.config?.quota||o.quota,u=e.config?.interval||o.quotaInterval;if(l&&u&&!this.checkQuota(o.name,i,l,u))return{blocked:!0,status:429,error:`Quota exceeded: ${l} requests per ${u} seconds`}}if(e.type==="spike-arrest"){const l=e.config?.rate||o.spikeArrest;if(l&&l>0&&!this.checkSpikeArrest(o.name,l))return{blocked:!0,status:429,error:`Spike arrest limit exceeded: ${l} requests per second`}}return{blocked:!1}}executePostFlowPolicy(e,t,n,o){e.type==="cors"&&(o.headers||(o.headers={}),o.headers["Access-Control-Allow-Origin"]=e.config?.origins?.[0]||"*",o.headers["Access-Control-Allow-Methods"]=e.config?.methods?.join(", ")||"GET, POST, PUT, DELETE",o.headers["Access-Control-Allow-Headers"]=e.config?.headers?.join(", ")||"Content-Type, Authorization"),e.type==="xml-to-json"&&(o.headers||(o.headers={}),o.headers["Content-Type"]="application/json")}checkQuota(e,t,n,o){const i=Date.now(),l=o*1e3;let u=this.quotaCounters.get(e);u||(u=new Map,this.quotaCounters.set(e,u));let f=u.get(t);return(!f||f.resetAt<i)&&(f={count:0,resetAt:i+l,identifier:t},u.set(t,f)),f.count>=n?!1:(f.count++,!0)}checkSpikeArrest(e,t){const n=Date.now();let o=this.spikeArrestBuckets.get(e);o||(o={tokens:t,lastRefill:n,rate:t},this.spikeArrestBuckets.set(e,o));const l=(n-o.lastRefill)/1e3*o.rate;return o.tokens=Math.min(o.rate,o.tokens+l),o.lastRefill=n,o.tokens<1?!1:(o.tokens-=1,!0)}validateApiKey(e){const t=this.apiKeyCache.get(e);if(t&&t.expiresAt>Date.now())return t.valid;const n=e.length>=10;return this.apiKeyCache.set(e,{valid:n,expiresAt:Date.now()+300*1e3}),n}validateOAuthToken(e){const t=this.oauthTokenCache.get(e);if(t&&t.expiresAt>Date.now())return t.valid;const n=e.length>=20;return this.oauthTokenCache.set(e,{valid:n,expiresAt:Date.now()+3600*1e3}),n}validateJWTToken(e,t){const n=this.jwtTokenCache.get(e);if(n&&n.expiresAt>Date.now())return n.valid&&n.issuer===t;const o=e.length>=20;return this.jwtTokenCache.set(e,{valid:o,issuer:t,expiresAt:Date.now()+3600*1e3}),o}buildTargetUrl(e,t){const n=e.targetEndpoint.replace(/\/$/,""),o=t.startsWith("/")?t:`/${t}`;return`${n}${o}`}simulateUpstreamLatency(e){const t=10+Math.random()*40,n=(Math.random()-.5)*10;return Math.max(1,t+n)}updateProxyMetrics(e,t,n){const o=this.proxyMetrics.get(e);o&&(o.requestCount++,t&&o.errorCount++,o.totalLatency+=n,o.lastRequestTime=Date.now())}getStats(){let e=0,t=0,n=0;for(const i of this.proxyMetrics.values())e+=i.requestCount,t+=i.errorCount,n+=i.totalLatency;const o=e>0?n/e:0;return{proxies:this.proxies.size,policies:this.policies.length,totalRequests:e,totalErrors:t,avgLatency:o}}getProxyMetrics(e){const t=this.proxyMetrics.get(e);return t?{requestCount:t.requestCount,errorCount:t.errorCount,avgResponseTime:t.requestCount>0?t.totalLatency/t.requestCount:0}:null}clearCaches(){this.apiKeyCache.clear(),this.oauthTokenCache.clear(),this.jwtTokenCache.clear()}}class dT{applications=new Map;connectors=new Map;organization;environment;applicationMetrics=new Map;connectorMetrics=new Map;reconnectionState=new Map;initialize(e){if(this.applications.clear(),this.connectors.clear(),this.applicationMetrics.clear(),this.connectorMetrics.clear(),this.reconnectionState.clear(),this.organization=e.organization||"archiphoenix-org",this.environment=e.environment||"production",e.applications)for(const t of e.applications)this.applications.set(t.name,{...t}),this.applicationMetrics.set(t.name,{requestCount:0,errorCount:0,totalLatency:0,lastRequestTime:0});if(e.connectors)for(const t of e.connectors)this.connectors.set(t.name,{...t}),this.connectorMetrics.set(t.name,{requestCount:0,errorCount:0,totalLatency:0,lastRequestTime:0}),this.reconnectionState.set(t.name,{attempts:0,lastAttempt:0,nextAttempt:0})}processData(e){const t=Date.now(),n=this.matchApplication(e);if(!n)return{match:null,response:{status:"error",error:"No Mule application matched for request",latency:Date.now()-t}};if(n.application.status!=="running")return this.updateApplicationMetrics(n.application.name,!1,Date.now()-t),{match:n,response:{status:"error",error:`Application '${n.application.name}' is not running (status: ${n.application.status})`,latency:Date.now()-t}};let o=0,i;try{o=this.processFlow(n,e)}catch(u){i=u instanceof Error?u.message:"Unknown error"}if(i&&!this.handleError(n.application,i))return this.updateApplicationMetrics(n.application.name,!0,Date.now()-t),{match:n,response:{status:"error",error:i,latency:Date.now()-t,application:n.application.name,flow:n.flow?.name}};const l=this.transformData(e,n);return this.updateApplicationMetrics(n.application.name,!1,Date.now()-t),n.matchedConnector&&this.updateConnectorMetrics(n.matchedConnector.name,!1,Date.now()-t),{match:n,response:{status:"success",data:l.data,format:l.format||e.format,latency:Date.now()-t,application:n.application.name,flow:n.flow?.name,connector:n.matchedConnector?.name}}}matchApplication(e){if(e.sourceComponentType||e.targetComponentType)for(const[t,n]of this.applications.entries()){if(n.status!=="running")continue;const o=this.findMatchingConnector(n,e.sourceComponentType,e.targetComponentType);if(o){const i=n.flows?.find(l=>l.source===o.name||l.target===o.name)||n.flows?.[0];return{application:n,flow:i,matchedConnector:o}}}for(const[t,n]of this.applications.entries())if(n.status==="running")return{application:n,flow:n.flows?.[0]};return null}findMatchingConnector(e,t,n){const o=e.connectors||[];for(const i of o){const l=this.connectors.get(i);if(!(!l||!l.enabled)&&(t&&this.connectorMatchesComponentType(l,t)||n&&this.connectorMatchesComponentType(l,n)))return l}return null}connectorMatchesComponentType(e,t){const n={database:["postgres","mongodb","redis","cassandra","clickhouse","snowflake","elasticsearch"],api:["rest","grpc","graphql","soap","websocket","webhook"],messaging:["kafka","rabbitmq","activemq","aws-sqs","azure-service-bus","gcp-pubsub"],file:["s3-datalake"],business:["crm","erp","payment-gateway"]};for(const[o,i]of Object.entries(n))if(e.type===o&&i.includes(t))return!0;return e.targetComponentType===t}processFlow(e,t){if(!e.flow)return this.calculateBaseProcessingTime(e.application);let n=this.calculateBaseProcessingTime(e.application);if(e.flow.processors)for(const o of e.flow.processors)n+=this.processProcessor(o,t);return e.matchedConnector&&(n+=this.calculateConnectorLatency(e.matchedConnector)),n}calculateBaseProcessingTime(e){const t=5+Math.random()*10,n=parseFloat(e.runtimeVersion)>=4.5?.9:1;return t*n}processProcessor(e,t){switch(e.type){case"transform":return 2+Math.random()*6;case"validate":return 1+Math.random()*2;case"filter":return .5+Math.random()*1.5;case"enrich":return 3+Math.random()*7;case"route":return .5+Math.random()*.5;default:return 1}}calculateConnectorLatency(e){const n={database:10,api:20,messaging:5,file:50,custom:15}[e.type]||15,o=n*.5*Math.random();return n+o}transformData(e,t){if(e.targetComponentType){const n=this.getTargetFormat(e.targetComponentType);if(n&&n!==e.format)return{data:e.body,format:n}}return{data:e.body,format:e.format}}getTargetFormat(e){return{postgres:"json",mongodb:"json",redis:"json",rest:"json",graphql:"json",soap:"xml",grpc:"binary",kafka:"json",rabbitmq:"json"}[e]}handleError(e,t){switch(e.errorStrategy||"continue"){case"continue":return!0;case"rollback":return!1;case"propagate":return!1;default:return!1}}updateApplicationMetrics(e,t,n){const o=this.applicationMetrics.get(e);o&&(o.requestCount++,t&&o.errorCount++,o.totalLatency+=n,o.lastRequestTime=Date.now())}updateConnectorMetrics(e,t,n){const o=this.connectorMetrics.get(e);o&&(o.requestCount++,t&&o.errorCount++,o.totalLatency+=n,o.lastRequestTime=Date.now())}getStats(){let e=0,t=0,n=0;for(const l of this.applicationMetrics.values())e+=l.requestCount,t+=l.errorCount,n+=l.totalLatency;const o=Array.from(this.applications.values()).filter(l=>l.status==="running").length,i=Array.from(this.connectors.values()).filter(l=>l.enabled).length;return{applications:this.applications.size,runningApplications:o,connectors:this.connectors.size,enabledConnectors:i,totalRequests:e,totalErrors:t,avgLatency:e>0?n/e:0}}getApplicationMetrics(e){const t=this.applicationMetrics.get(e);return t?{requestCount:t.requestCount,errorCount:t.errorCount,avgLatency:t.requestCount>0?t.totalLatency/t.requestCount:0}:null}getConnectorMetrics(e){const t=this.connectorMetrics.get(e);return t?{requestCount:t.requestCount,errorCount:t.errorCount,avgLatency:t.requestCount>0?t.totalLatency/t.requestCount:0}:null}}class fT{parseQuery(e){const t=e.query.trim(),n=this.extractOperationType(t),o=e.operationName||this.extractOperationName(t),i=this.extractFields(t),l=this.calculateDepth(t),u=this.estimateComplexity(t,o);return{operationName:o,operationType:n,fields:i,depth:l,complexity:u,rawQuery:t}}extractOperationType(e){const t=e.trim();return t.startsWith("mutation")?"mutation":t.startsWith("subscription")?"subscription":"query"}extractOperationName(e){const t=e.match(/(?:query|mutation|subscription)\s+([a-zA-Z0-9_]+)/);return t?t[1]:void 0}extractFields(e){const t=[],n=/([a-zA-Z0-9_]+)\s*(?:\(|\{)/g;let o;for(;(o=n.exec(e))!==null;)t.push(o[1]);return t.length>0?t:["unknown"]}calculateDepth(e){let t=0,n=0;for(const o of e)o==="{"?(t+=1,n=Math.max(n,t)):o==="}"&&(t=Math.max(0,t-1));return n}estimateComplexity(e,t){const n=e.match(/[a-zA-Z0-9_]+(\s*[({])/g),o=n?n.length:5,i=this.calculateDepth(e),l=t?Math.max(1,t.length%5):1;return Math.round(o*(1+i*.5)*l*10)}}class hT{federationConfig;constructor(e){this.federationConfig=e}planQuery(e,t){if(t.length===0)return{subqueries:[],requiresFederation:!1,estimatedLatency:0};const n=this.federationConfig?.enabled??!1,i=this.selectServices(e,t).map(f=>({serviceId:f.id,serviceName:f.name,endpoint:f.endpoint,query:e.rawQuery,fields:e.fields,estimatedLatency:this.estimateServiceLatency(f,e)})),l=i.reduce((f,p)=>f+p.estimatedLatency,0),u=n?3+Math.random()*5:0;return{subqueries:i,requiresFederation:n,estimatedLatency:l+u}}selectServices(e,t){if(this.federationConfig?.enabled&&this.federationConfig.services?.length){const i=t.filter(l=>this.federationConfig.services.includes(l.name));return i.length>0?i:t.slice(0,Math.min(2,t.length))}const n=this.hashString(e.operationName||e.rawQuery),o=Math.abs(n)%t.length;return[t[o]]}estimateServiceLatency(e,t){const n=e.avgLatencyMs,o=Math.sqrt(t.complexity)*.8,i=t.depth*1.5,l=Math.random()*5;return n+o+i+l}hashString(e){let t=0;for(let n=0;n<e.length;n++){const o=e.charCodeAt(n);t=(t<<5)-t+o,t|=0}return t}updateFederationConfig(e){this.federationConfig=e}}class pT{serviceRegistry;constructor(e){this.serviceRegistry=e}executePlan(e){if(e.subqueries.length===0)return{success:!1,totalLatency:0,error:"No services available",executedEndpoints:[]};let t=0;const n=[];for(const o of e.subqueries){const i=this.serviceRegistry.getService(o.serviceId);if(!i)return{success:!1,totalLatency:t,error:`Service ${o.serviceId} not found`,failedService:o.serviceId,executedEndpoints:n};const l=o.endpoint||i.endpoint;n.push(l);const f=this.getEndpointLatency(l,i.avgLatencyMs)+(o.estimatedLatency-i.avgLatencyMs);if(t+=f,Math.random()<i.errorRate)return this.serviceRegistry.recordRequest(i.id,f,!1),{success:!1,totalLatency:t,error:`Upstream error at ${i.name} (${l})`,failedService:i.id,executedEndpoints:n};this.serviceRegistry.recordRequest(i.id,f,!0)}return{success:!0,totalLatency:t,executedEndpoints:n}}getEndpointLatency(e,t){return e.includes("localhost")||e.includes("127.0.0.1")?t*.8:e.includes("https://")?t*1.1:t}}class gT{services=new Map;registerService(e){const t=this.services.get(e.id);this.services.set(e.id,{id:e.id,name:e.name,endpoint:e.endpoint,avgLatencyMs:e.avgLatencyMs??20,errorRate:e.errorRate??.01,status:e.status??"connected",rollingLatency:t?.rollingLatency||[],rollingErrors:t?.rollingErrors||[]})}unregisterService(e){this.services.delete(e)}getConnectedServices(){return Array.from(this.services.values()).filter(e=>e.status==="connected")}getService(e){return this.services.get(e)}getServiceByName(e){return Array.from(this.services.values()).find(t=>t.name===e)}recordRequest(e,t,n){const o=this.services.get(e);if(!o)return;o.rollingLatency.push(t),o.rollingLatency.length>50&&o.rollingLatency.shift(),n||(o.rollingErrors.push(t),o.rollingErrors.length>50&&o.rollingErrors.shift());const i=o.rollingLatency.reduce((u,f)=>u+f,0)/o.rollingLatency.length;o.avgLatencyMs=i;const l=o.rollingErrors.length/Math.max(o.rollingLatency.length,1);o.errorRate=l}initialize(e){this.services.clear();for(const t of e)this.registerService(t)}getAllServices(){return Array.from(this.services.values())}}class mT{cache=new Map;ttl;persistQueries;constructor(e=0,t=!1){this.ttl=e,this.persistQueries=t}generateCacheKey(e,t){const n=t?JSON.stringify(t):"";return this.hashString(e+n)}getCached(e,t){if(this.ttl<=0||!this.persistQueries)return{hit:!1,latencyReduction:0};const n=this.generateCacheKey(e,t),o=this.cache.get(n);return o?Date.now()-o.timestamp>o.ttl*1e3?(this.cache.delete(n),{hit:!1,latencyReduction:0}):{hit:!0,latencyReduction:.7}:{hit:!1,latencyReduction:0}}setCached(e,t,n){if(this.ttl<=0||!this.persistQueries)return;const o=this.generateCacheKey(e,n);if(this.cache.set(o,{query:e,response:t,timestamp:Date.now(),ttl:this.ttl}),this.cache.size>1e3){const i=this.cache.keys().next().value;this.cache.delete(i)}}getCacheHitProbability(e){if(this.ttl<=0||!this.persistQueries)return 0;const t=.2,n=Math.min(e.complexity/2e3,.4);return Math.min(t+n,.6)}updateConfig(e,t){e!==void 0&&(this.ttl=e),t!==void 0&&(this.persistQueries=t)}clearCache(){this.cache.clear()}hashString(e){let t=0;for(let n=0;n<e.length;n++){const o=e.charCodeAt(n);t=(t<<5)-t+o,t|=0}return Math.abs(t).toString(16)}}class yT{enabled;limits=new Map;defaultLimit=100;windowMs=6e4;constructor(e=!1,t=100){this.enabled=e,this.defaultLimit=t}checkLimit(e,t){if(!this.enabled)return{allowed:!0,remaining:1/0,resetAt:Date.now()+this.windowMs};const n=t||this.defaultLimit,o=Date.now(),i=this.limits.get(e);if(!i||o>=i.resetAt){const l={count:1,resetAt:o+this.windowMs,windowStart:o};return this.limits.set(e,l),{allowed:!0,remaining:n-1,resetAt:l.resetAt}}return i.count>=n?{allowed:!1,remaining:0,resetAt:i.resetAt}:(i.count+=1,{allowed:!0,remaining:n-i.count,resetAt:i.resetAt})}getIdentifier(e){if(!e)return"default";const t=e["x-api-key"]||e.apikey;if(t)return`key:${t}`;const n=e["x-client-id"];return n?`client:${n}`:"default"}setEnabled(e){this.enabled=e}updateDefaultLimit(e){this.defaultLimit=e}clearLimits(){this.limits.clear()}}class vT{maxQueryDepth;maxQueryComplexity;enabled;constructor(e=15,t=1e3,n=!0){this.maxQueryDepth=e,this.maxQueryComplexity=t,this.enabled=n}validateQuery(e){return this.enabled?e.depth>this.maxQueryDepth?{valid:!1,error:`Query depth ${e.depth} exceeds limit ${this.maxQueryDepth}`}:e.complexity>this.maxQueryComplexity?{valid:!1,error:`Query complexity ${e.complexity} exceeds limit ${this.maxQueryComplexity}`}:{valid:!0}:{valid:!0}}updateLimits(e,t){e!==void 0&&(this.maxQueryDepth=e),t!==void 0&&(this.maxQueryComplexity=t)}setEnabled(e){this.enabled=e}}class bT{config;constructor(e){this.config=e}isEnabled(){return this.config?.enabled??!1}getVersion(){return this.config?.version}getFederatedServices(){return this.config?.services||[]}getPlanningOverhead(){return this.isEnabled()?(this.config?.version==="2"?2:4)+Math.random()*3:0}isFederatedService(e){return this.isEnabled()?this.config?.services?.includes(e.name)??!1:!1}getSupergraphSchema(){return this.config?.supergraph}updateConfig(e){this.config=e}}class xT{queryParser;queryPlanner;queryExecutor;serviceRegistry;cacheManager;rateLimiter;complexityAnalyzer;federationComposer;constructor(){this.serviceRegistry=new gT,this.queryParser=new fT,this.queryPlanner=new hT,this.queryExecutor=new pT(this.serviceRegistry),this.cacheManager=new mT,this.rateLimiter=new yT,this.complexityAnalyzer=new vT,this.federationComposer=new bT}initialize(e){e.services&&this.serviceRegistry.initialize(e.services),this.federationComposer.updateConfig(e.federation),this.queryPlanner.updateFederationConfig(e.federation),this.cacheManager.updateConfig(e.cacheTtl??0,e.persistQueries??!1),this.rateLimiter.setEnabled(e.enableRateLimiting??!1),this.complexityAnalyzer.updateLimits(e.maxQueryDepth??15,e.maxQueryComplexity??1e3),this.complexityAnalyzer.setEnabled(e.enableQueryComplexityAnalysis??!0)}routeRequest(e){const t=Date.now();if(!e.query||e.query.trim().length===0)return{status:400,latency:Date.now()-t,error:"Empty query"};const n=this.rateLimiter.getIdentifier(e.headers);if(!this.rateLimiter.checkLimit(n).allowed)return{status:429,latency:Date.now()-t,error:"Rate limit exceeded"};const i=this.queryParser.parseQuery(e),l=this.cacheManager.getCached(e.query,e.variables);if(l.hit)return{status:200,latency:(Date.now()-t)*(1-l.latencyReduction)};const u=this.complexityAnalyzer.validateQuery(i);if(!u.valid)return{status:413,latency:Date.now()-t,error:u.error};const f=this.serviceRegistry.getConnectedServices();if(f.length===0)return{status:503,latency:Date.now()-t,error:"No connected services"};const p=this.queryPlanner.planQuery(i,f),g=this.queryExecutor.executePlan(p);return g.success?(this.cacheManager.setCached(e.query,{success:!0},e.variables),{status:200,latency:g.totalLatency+(Date.now()-t)}):{status:502,latency:g.totalLatency+(Date.now()-t),error:g.error}}getServiceRegistry(){return this.serviceRegistry}getCacheManager(){return this.cacheManager}getRateLimiter(){return this.rateLimiter}}class wT{backends=new Map;endpoints=new Map;config={};circuitBreakers=new Map;cache=new Map;cacheMode="memory";defaultCacheTtl=5;redisEngine=null;redisNodeId="";backendMetrics=new Map;batchQueue=new Map;batchTimer=null;batchSize=10;batchTimeout=50;initialize(e){if(this.config=e,this.backends.clear(),this.endpoints.clear(),this.circuitBreakers.clear(),this.cache.clear(),this.backendMetrics.clear(),this.cacheMode=e.cacheMode||"memory",this.defaultCacheTtl=e.cacheTtl||5,this.redisEngine=e.redisEngine||null,this.redisNodeId=e.redisNodeId||"",e.backends)for(const t of e.backends)this.backends.set(t.id,{...t}),this.initializeCircuitBreaker(t.id,t.circuitBreaker),this.initializeBackendMetrics(t.id);if(e.endpoints)for(const t of e.endpoints)this.endpoints.set(t.id,{...t})}initializeCircuitBreaker(e,t){t?.enabled&&this.circuitBreakers.set(e,{failures:0,successes:0,state:"closed",lastFailureTime:0,nextAttemptTime:0})}initializeBackendMetrics(e){this.backendMetrics.set(e,{requestCount:0,errorCount:0,totalLatency:0,averageLatency:0,lastRequestTime:0,cacheHits:0,cacheMisses:0})}routeRequest(e){const t=Date.now(),n=this.matchEndpoint(e);if(!n)return{status:404,error:"Endpoint not found",latency:Date.now()-t,backendResponses:[],cacheHit:!1};if(this.config.enableCaching&&this.cacheMode!=="off"){const l=this.getCacheKey(n,e),u=this.getCached(l);if(u){const f=this.backendMetrics.get(n.backends[0])||this.initializeBackendMetrics(n.backends[0]);return f&&f.cacheHits++,{status:200,data:u.data,latency:Date.now()-t,backendResponses:[],cacheHit:!0}}}const o=this.aggregateBackends(n,e),i=this.aggregateResponses(n,o);if(this.config.enableCaching&&this.cacheMode!=="off"&&i.status===200){const l=this.getCacheKey(n,e),u=n.cacheTtl||this.defaultCacheTtl;this.setCached(l,i.data,u)}for(const l of o){const u=this.backendMetrics.get(l.backendId);u&&(u.requestCount++,l.status>=400&&u.errorCount++,u.totalLatency+=l.latency,u.averageLatency=u.totalLatency/u.requestCount,u.lastRequestTime=Date.now(),l.cached||u.cacheMisses++)}return{...i,latency:Date.now()-t,backendResponses:o,cacheHit:!1}}matchEndpoint(e){for(const t of this.endpoints.values())if(t.path===e.path&&t.method===e.method)return t;return null}aggregateBackends(e,t){const n=e.backends;switch(e.aggregator){case"parallel":return this.executeBackendsParallel(n,t,e);case"sequential":return this.executeBackendsSequential(n,t,e);case"merge":default:return this.executeBackendsParallel(n,t,e)}}executeBackendsParallel(e,t,n){const o=[];for(const i of e){const l=this.executeBackend(i,t,n);o.push(l)}return o}executeBackendsSequential(e,t,n){const o=[];let i={};for(const l of e){const u={...t,body:{...typeof t.body=="object"?t.body:{},...i}},f=this.executeBackend(l,u,n);if(o.push(f),f.status>=200&&f.status<300&&f.data)typeof f.data=="object"&&(i={...i,...f.data});else break}return o}executeBackend(e,t,n){const o=this.backends.get(e);if(!o)return{backendId:e,status:503,error:"Backend not found",latency:0,cached:!1};const i=this.circuitBreakers.get(e);if(i){const g=Date.now();if(i.state==="open"){if(g<i.nextAttemptTime)return{backendId:e,status:503,error:"Circuit breaker is open",latency:0,cached:!1};i.state="half-open"}}if(this.config.enableCaching&&this.cacheMode!=="off"){const g=`${e}:${n.path}:${JSON.stringify(t.query||{})}`,m=this.getCached(g);if(m)return{backendId:e,status:200,data:m.data,latency:1,cached:!0}}n.timeout||o.timeout||this.config.defaultTimeout;const l=o.retries||0,u=o.retryBackoff||"exponential";let f,p=0;for(let g=0;g<=l;g++){if(g>0){const E=this.calculateBackoff(g,u);p+=E}const m=50+Math.random()*150,y=(Math.random()-.5)*20,x=m+y;p+=x;const S=o.status==="connected"?.95:.5;if(Math.random()<S){i&&(i.state==="half-open"?(i.successes++,i.successes>=(o.circuitBreaker?.successThreshold||2)&&(i.state="closed",i.failures=0,i.successes=0)):i.failures=Math.max(0,i.failures-1));const E=this.generateMockResponse(o,t);return{backendId:e,status:200,data:E,latency:p,cached:!1}}else f=`Backend error (attempt ${g+1}/${l+1})`,i&&(i.failures++,i.lastFailureTime=Date.now(),i.failures>=(o.circuitBreaker?.failureThreshold||5)&&(i.state="open",i.nextAttemptTime=Date.now()+(o.circuitBreaker?.timeout||6e4)))}return{backendId:e,status:503,error:f||"Backend request failed",latency:p,cached:!1}}calculateBackoff(e,t){switch(t){case"exponential":return Math.min(1e3*Math.pow(2,e-1),1e4);case"linear":return 100*e;case"constant":default:return 100}}generateMockResponse(e,t){const n=e.name.toLowerCase();return n.includes("user")||n.includes("profile")?{id:Math.floor(Math.random()*1e3),name:"John Doe",email:"john.doe@example.com",avatar:"https://example.com/avatar.jpg"}:n.includes("order")||n.includes("cart")?{id:Math.floor(Math.random()*1e3),items:[{id:1,name:"Product 1",price:29.99,quantity:2},{id:2,name:"Product 2",price:49.99,quantity:1}],total:109.97}:n.includes("product")||n.includes("catalog")?{products:[{id:1,name:"Product 1",price:29.99,inStock:!0},{id:2,name:"Product 2",price:49.99,inStock:!0}],total:2}:{data:"Mock response",timestamp:Date.now()}}aggregateResponses(e,t){if(t.length===0)return{status:503,error:"No backends configured for endpoint"};if(t.every(i=>i.status>=400))return{status:503,error:"All backends failed"};const o=t.some(i=>i.status>=400);if(e.aggregator==="merge"||e.aggregator==="parallel"){const i={};for(const l of t)if(l.status>=200&&l.status<300&&l.data){const f=this.backends.get(l.backendId)?.name||l.backendId;typeof l.data=="object"&&l.data,i[f]=l.data}return{status:o?207:200,data:i}}else{const i=t[t.length-1];return i.status>=200&&i.status<300?{status:200,data:i.data}:{status:i.status,error:i.error}}}getCacheKey(e,t){return e.cacheKey?e.cacheKey:`${e.path}:${e.method}:${JSON.stringify(t.query||{})}`}getCached(e){if(this.cacheMode==="off")return null;if(this.cacheMode==="redis"&&this.redisEngine){const n=this.getRedisCacheKey(e),o=this.redisEngine.executeCommand("GET",[n]);if(o.success&&o.value!==null)try{const i=typeof o.value=="string"?JSON.parse(o.value):o.value;return{key:e,data:i,expiresAt:Date.now()+this.defaultCacheTtl*1e3,hitCount:1}}catch{return null}return null}const t=this.cache.get(e);return t?Date.now()>t.expiresAt?(this.cache.delete(e),null):(t.hitCount++,t):null}setCached(e,t,n){if(this.cacheMode!=="off"){if(this.cacheMode==="redis"&&this.redisEngine){const o=this.getRedisCacheKey(e),i=typeof t=="string"?t:JSON.stringify(t),l=[o,i];n>0&&l.push("EX",String(n)),this.redisEngine.executeCommand("SET",l);return}this.cache.set(e,{key:e,data:t,expiresAt:Date.now()+n*1e3,hitCount:0}),this.cache.size>1e3&&this.cleanupCache()}}getRedisCacheKey(e){return`${this.redisNodeId?`bff:${this.redisNodeId}:`:"bff:"}${e}`}cleanupCache(){const e=Date.now();for(const[t,n]of this.cache.entries())e>n.expiresAt&&this.cache.delete(t)}getStats(){let e=0,t=0,n=0,o=0,i=0;const l={};for(const[u,f]of this.backendMetrics.entries())e+=f.requestCount,t+=f.errorCount,n+=f.totalLatency,o+=f.cacheHits,i+=f.cacheMisses,l[u]={...f};return{totalRequests:e,totalErrors:t,averageLatency:e>0?n/e:0,cacheHitRate:o+i>0?o/(o+i):0,backendStats:l}}getBackendMetrics(e){return this.backendMetrics.get(e)}getBackends(){return Array.from(this.backends.values())}getEndpoints(){return Array.from(this.endpoints.values())}updateBackendStatus(e,t){const n=this.backends.get(e);n&&(n.status=t)}}class ST{relays=new Map;config={};deliveries=new Map;pendingDeliveries=new Map;relayMetrics=new Map;initialize(e){if(this.config=e,this.relays.clear(),this.deliveries.clear(),this.pendingDeliveries.clear(),this.relayMetrics.clear(),e.relays)for(const t of e.relays)t.enabled&&(this.relays.set(t.id,{...t}),this.initializeRelayMetrics(t.id))}initializeRelayMetrics(e){this.relayMetrics.set(e,{totalRequests:0,successfulDeliveries:0,failedDeliveries:0,totalRetries:0,averageLatency:0,totalLatency:0,lastRequestTime:0})}relayWebhook(e){const t=Date.now(),n=this.findMatchingRelay(e);if(!n)return{success:!1,status:404,latency:Date.now()-t,attempts:0,error:"No matching relay found"};if(n.allowedIps&&n.allowedIps.length>0&&e.ip&&!this.isIpAllowed(e.ip,n.allowedIps))return this.updateRelayMetrics(n.id,!1,Date.now()-t),{success:!1,status:403,latency:Date.now()-t,attempts:0,error:"IP address not allowed",relayId:n.id};if(this.config.enableSignatureVerification&&n.signatureSecret&&!this.verifySignature(e,n.signatureSecret,n.signatureHeader||"X-Signature"))return this.updateRelayMetrics(n.id,!1,Date.now()-t),{success:!1,status:401,latency:Date.now()-t,attempts:0,error:"Invalid signature",relayId:n.id};let o=e.body;n.transformTemplate&&(o=this.transformPayload(e.body,n.transformTemplate));const i=this.deliverWebhook(n,{...e,body:o});return this.updateRelayMetrics(n.id,i.success,i.latency),{...i,relayId:n.id}}findMatchingRelay(e){for(const t of this.relays.values())if(e.url.startsWith(t.sourceUrl)||t.sourceUrl==="*"||e.url.includes(t.sourceUrl)){if(t.events&&t.events.length>0){const n=e.event||e.headers["x-event"]||e.headers["x-github-event"]||"";if(!t.events.includes(n)&&n!=="")continue}return t}return null}isIpAllowed(e,t){for(const n of t)if(this.matchesCidr(e,n))return!0;return!1}matchesCidr(e,t){if(t==="*"||t===e)return!0;if(t.includes("/")){const[n,o]=t.split("/"),i=parseInt(o,10),l=n.split("."),u=e.split(".");if(l.length!==4||u.length!==4)return!1;const f=Math.floor(i/8);for(let p=0;p<f;p++)if(l[p]!==u[p])return!1;return!0}return e===t}verifySignature(e,t,n){const o=e.headers[n.toLowerCase()]||e.headers[n]||e.headers["x-signature"]||e.headers["x-hub-signature-256"];return o?(typeof e.body=="string"?e.body:JSON.stringify(e.body),o.length>0&&t.length>0):!1}transformPayload(e,t){try{let n=t;if(n.includes("{{raw}}")){const o=typeof e=="string"?e:JSON.stringify(e);n=n.replace(/\{\{raw\}\}/g,o)}if(n.includes("{{json}}")){const o=typeof e=="string"?JSON.parse(e):e;n=n.replace(/\{\{json\}\}/g,JSON.stringify(o))}try{return JSON.parse(n)}catch{return n}}catch{return e}}deliverWebhook(e,t){const n=e.maxRetryAttempts||this.config.maxRetryAttempts||3,o=e.retryDelay||this.config.retryDelay||5,i=e.timeout||this.config.timeout||30,l=this.config.enableRetryOnFailure!==!1,u=e.retryBackoff||"exponential";let f=0,p,g;const m=Date.now();for(;f<n;){f++;const S=this.simulateHttpRequest(e.targetUrl,t,i);if(S.success){const C=`delivery-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,E={id:C,relayId:e.id,event:t.event||"unknown",payload:typeof t.body=="string"?t.body:JSON.stringify(t.body),status:"success",timestamp:new Date().toISOString(),attempts:f,responseCode:S.statusCode};return this.deliveries.set(C,E),{success:!0,status:S.statusCode||200,latency:Date.now()-m,deliveryId:C,attempts:f}}if(p=S.error,g=S.statusCode,!l||f>=n)break;this.calculateRetryDelay(f,o,u)}const y=`delivery-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,x={id:y,relayId:e.id,event:t.event||"unknown",payload:typeof t.body=="string"?t.body:JSON.stringify(t.body),status:"failed",timestamp:new Date().toISOString(),attempts:f,responseCode:g,error:p};return this.deliveries.set(y,x),{success:!1,status:g||500,latency:Date.now()-m,deliveryId:y,attempts:f,error:p||"Delivery failed after all retry attempts"}}simulateHttpRequest(e,t,n){const o=10+Math.random()*40,i=5+Math.random()*95,l=Math.random()<.05;if(Math.random()<.02)return{success:!1,statusCode:504,error:"Request timeout",latency:n*1e3};if(l){const f=[500,502,503,429],p=f[Math.floor(Math.random()*f.length)];return{success:!1,statusCode:p,error:`HTTP ${p} error`,latency:o+i}}return{success:!0,statusCode:200,latency:o+i}}calculateRetryDelay(e,t,n){switch(n){case"exponential":return t*Math.pow(2,e-1);case"linear":return t*e;case"constant":default:return t}}updateRelayMetrics(e,t,n){let o=this.relayMetrics.get(e);o||(o={totalRequests:0,successfulDeliveries:0,failedDeliveries:0,totalRetries:0,averageLatency:0,totalLatency:0,lastRequestTime:0},this.relayMetrics.set(e,o)),o.totalRequests++,o.totalLatency+=n,o.averageLatency=o.totalLatency/o.totalRequests,o.lastRequestTime=Date.now(),t?o.successfulDeliveries++:o.failedDeliveries++}getDeliveries(e){const t=Array.from(this.deliveries.values());return e?t.filter(n=>n.relayId===e):t}getRelayMetrics(e){return this.relayMetrics.get(e)}getAllRelayMetrics(){return new Map(this.relayMetrics)}getRelay(e){return this.relays.get(e)}getAllRelays(){return Array.from(this.relays.values())}}class CT{keys=new Map;config={};maxMemoryBytes=256*1024*1024;currentMemoryUsage=0;metrics={totalKeys:0,keysByType:{string:0,hash:0,list:0,set:0,zset:0,stream:0},memoryUsage:0,memoryUsagePercent:0,operationsPerSecond:0,hitCount:0,missCount:0,hitRate:0,expiredKeys:0,evictedKeys:0,connectedClients:0};operationCount=0;lastMetricsUpdate=Date.now();operationHistory=[];clusterSlots=new Map;clusterNodes=[];initialize(e){if(this.config={...e},this.keys.clear(),this.currentMemoryUsage=0,this.operationCount=0,this.lastMetricsUpdate=Date.now(),this.operationHistory=[],e.maxMemory&&(this.maxMemoryBytes=this.parseMemorySize(e.maxMemory)),e.enableCluster&&e.clusterNodes&&(this.clusterNodes=[...e.clusterNodes],this.initializeClusterSlots()),e.keys)for(const t of e.keys)this.setKey(t.key,t.type,t.value,t.ttl);this.updateMetrics()}parseMemorySize(e){const t=e.match(/^(\d+)([kmg]?b?)$/i);if(!t)return 256*1024*1024;const n=parseInt(t[1]);switch(t[2].toLowerCase()){case"kb":return n*1024;case"mb":return n*1024*1024;case"gb":return n*1024*1024*1024;default:return n}}initializeClusterSlots(){if(this.clusterNodes.length===0)return;const e=Math.floor(16384/this.clusterNodes.length);let t=0;for(let n=0;n<this.clusterNodes.length;n++){const o=n===this.clusterNodes.length-1?16383:t+e-1;for(let i=t;i<=o;i++)this.clusterSlots.set(i,this.clusterNodes[n]);t=o+1}}getClusterSlot(e){const t=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935];let n=0;for(let o=0;o<e.length;o++){const i=e.charCodeAt(o);n=(n<<8^t[(n>>8^i)&255])&65535}return n%16384}isKeyForThisNode(e){if(!this.config.enableCluster||this.clusterNodes.length===0)return!0;const t=this.getClusterSlot(e);return this.clusterSlots.get(t),!0}executeCommand(e,t){const n=Date.now(),o=e.toUpperCase();try{let i;switch(o){case"GET":i=this.get(t[0]);break;case"SET":i=this.set(t[0],t[1],t[2]?parseInt(t[2]):void 0);break;case"DEL":i=this.del(t);break;case"EXISTS":i=this.exists(t);break;case"EXPIRE":i=this.expire(t[0],parseInt(t[1]));break;case"TTL":i=this.ttl(t[0]);break;case"KEYS":i=this.keys(t[0]||"*");break;case"HGET":i=this.hget(t[0],t[1]);break;case"HSET":i=this.hset(t[0],t.slice(1));break;case"HGETALL":i=this.hgetall(t[0]);break;case"HDEL":i=this.hdel(t[0],t.slice(1));break;case"HKEYS":i=this.hkeys(t[0]);break;case"HVALS":i=this.hvals(t[0]);break;case"LPUSH":i=this.lpush(t[0],t.slice(1));break;case"RPUSH":i=this.rpush(t[0],t.slice(1));break;case"LPOP":i=this.lpop(t[0]);break;case"RPOP":i=this.rpop(t[0]);break;case"LLEN":i=this.llen(t[0]);break;case"LRANGE":i=this.lrange(t[0],parseInt(t[1]),parseInt(t[2]));break;case"SADD":i=this.sadd(t[0],t.slice(1));break;case"SREM":i=this.srem(t[0],t.slice(1));break;case"SMEMBERS":i=this.smembers(t[0]);break;case"SISMEMBER":i=this.sismember(t[0],t[1]);break;case"SCARD":i=this.scard(t[0]);break;case"ZADD":i=this.zadd(t[0],t.slice(1));break;case"ZREM":i=this.zrem(t[0],t.slice(1));break;case"ZRANGE":i=this.zrange(t[0],parseInt(t[1]),parseInt(t[2]));break;case"ZSCORE":i=this.zscore(t[0],t[1]);break;case"ZCARD":i=this.zcard(t[0]);break;case"PING":i="PONG";break;case"INFO":i=this.info(t[0]);break;case"DBSIZE":i=this.dbsize();break;default:return{success:!1,error:`Unknown command: ${e}`,latency:Date.now()-n}}const l=Date.now()-n;return this.recordOperation(),{success:!0,value:i,latency:l}}catch(i){return{success:!1,error:i instanceof Error?i.message:"Unknown error",latency:Date.now()-n}}}recordOperation(){this.operationCount++,this.operationHistory.push({timestamp:Date.now()}),this.operationHistory.length>1e3&&this.operationHistory.shift()}get(e){if(!this.isKeyForThisNode(e))throw new Error("MOVED - key belongs to different node");const t=this.keys.get(e);return t?this.isExpired(t)?(this.deleteKey(e),this.metrics.missCount++,null):(this.metrics.hitCount++,typeof t.value=="string"?t.value:JSON.stringify(t.value)):(this.metrics.missCount++,null)}set(e,t,n){if(!this.isKeyForThisNode(e))throw new Error("MOVED - key belongs to different node");this.checkMemoryAndEvict();const o=this.keys.get(e);o&&(this.currentMemoryUsage-=this.calculateKeySize(o));const i={key:e,type:"string",value:t,ttl:n!==void 0?n:o?.ttl,expiresAt:n!==void 0&&n>0?Date.now()+n*1e3:o?.expiresAt,size:this.estimateSize(t)};return this.keys.set(e,i),this.currentMemoryUsage+=this.calculateKeySize(i),"OK"}del(e){let t=0;for(const n of e)this.deleteKey(n)&&t++;return t}exists(e){let t=0;for(const n of e){const o=this.keys.get(n);o&&!this.isExpired(o)&&t++}return t}expire(e,t){const n=this.keys.get(e);return n?this.isExpired(n)?(this.deleteKey(e),0):(n.ttl=t,n.expiresAt=t>0?Date.now()+t*1e3:void 0,1):0}ttl(e){const t=this.keys.get(e);if(!t)return-2;if(this.isExpired(t))return this.deleteKey(e),-2;if(!t.expiresAt)return-1;const n=Math.floor((t.expiresAt-Date.now())/1e3);return n>0?n:-2}keys(e){const t=this.patternToRegex(e),n=[];for(const[o,i]of this.keys.entries()){if(this.isExpired(i)){this.deleteKey(o);continue}t.test(o)&&n.push(o)}return n}hget(e,t){const n=this.keys.get(e);return!n||n.type!=="hash"?null:this.isExpired(n)?(this.deleteKey(e),null):n.value[t]||null}hset(e,t){if(!this.isKeyForThisNode(e))throw new Error("MOVED - key belongs to different node");this.checkMemoryAndEvict();let n=this.keys.get(e);(!n||n.type!=="hash")&&(n&&(this.currentMemoryUsage-=this.calculateKeySize(n)),n={key:e,type:"hash",value:{},size:0});const o=n.value;let i=0;for(let l=0;l<t.length;l+=2){const u=t[l],f=t[l+1];o[u]||i++,o[u]=f}return n.size=this.estimateSize(JSON.stringify(o)),this.keys.set(e,n),this.currentMemoryUsage+=this.calculateKeySize(n),i}hgetall(e){const t=this.keys.get(e);return!t||t.type!=="hash"?{}:this.isExpired(t)?(this.deleteKey(e),{}):{...t.value}}hdel(e,t){const n=this.keys.get(e);if(!n||n.type!=="hash")return 0;if(this.isExpired(n))return this.deleteKey(e),0;const o=n.value;let i=0;for(const l of t)o[l]&&(delete o[l],i++);return i>0&&(n.size=this.estimateSize(JSON.stringify(o)),this.keys.set(e,n)),i}hkeys(e){const t=this.keys.get(e);return!t||t.type!=="hash"?[]:this.isExpired(t)?(this.deleteKey(e),[]):Object.keys(t.value)}hvals(e){const t=this.keys.get(e);return!t||t.type!=="hash"?[]:this.isExpired(t)?(this.deleteKey(e),[]):Object.values(t.value)}lpush(e,t){if(!this.isKeyForThisNode(e))throw new Error("MOVED - key belongs to different node");this.checkMemoryAndEvict();let n=this.keys.get(e);(!n||n.type!=="list")&&(n&&(this.currentMemoryUsage-=this.calculateKeySize(n)),n={key:e,type:"list",value:[],size:0});const o=n.value;return o.unshift(...t),n.size=this.estimateSize(JSON.stringify(o)),this.keys.set(e,n),this.currentMemoryUsage+=this.calculateKeySize(n),o.length}rpush(e,t){if(!this.isKeyForThisNode(e))throw new Error("MOVED - key belongs to different node");this.checkMemoryAndEvict();let n=this.keys.get(e);(!n||n.type!=="list")&&(n&&(this.currentMemoryUsage-=this.calculateKeySize(n)),n={key:e,type:"list",value:[],size:0});const o=n.value;return o.push(...t),n.size=this.estimateSize(JSON.stringify(o)),this.keys.set(e,n),this.currentMemoryUsage+=this.calculateKeySize(n),o.length}lpop(e){const t=this.keys.get(e);if(!t||t.type!=="list")return null;if(this.isExpired(t))return this.deleteKey(e),null;const n=t.value;if(n.length===0)return null;const o=n.shift();return t.size=this.estimateSize(JSON.stringify(n)),this.keys.set(e,t),o}rpop(e){const t=this.keys.get(e);if(!t||t.type!=="list")return null;if(this.isExpired(t))return this.deleteKey(e),null;const n=t.value;if(n.length===0)return null;const o=n.pop();return t.size=this.estimateSize(JSON.stringify(n)),this.keys.set(e,t),o}llen(e){const t=this.keys.get(e);return!t||t.type!=="list"?0:this.isExpired(t)?(this.deleteKey(e),0):t.value.length}lrange(e,t,n){const o=this.keys.get(e);if(!o||o.type!=="list")return[];if(this.isExpired(o))return this.deleteKey(e),[];const i=o.value,l=i.length,u=t<0?Math.max(0,l+t):Math.min(t,l),f=n<0?Math.max(0,l+n):Math.min(n,l-1);return i.slice(u,f+1)}sadd(e,t){if(!this.isKeyForThisNode(e))throw new Error("MOVED - key belongs to different node");this.checkMemoryAndEvict();let n=this.keys.get(e);(!n||n.type!=="set")&&(n&&(this.currentMemoryUsage-=this.calculateKeySize(n)),n={key:e,type:"set",value:new Set,size:0});const o=n.value;let i=0;for(const l of t)o.has(l)||(o.add(l),i++);return n.size=this.estimateSize(JSON.stringify(Array.from(o))),this.keys.set(e,n),this.currentMemoryUsage+=this.calculateKeySize(n),i}srem(e,t){const n=this.keys.get(e);if(!n||n.type!=="set")return 0;if(this.isExpired(n))return this.deleteKey(e),0;const o=n.value;let i=0;for(const l of t)o.has(l)&&(o.delete(l),i++);return i>0&&(n.size=this.estimateSize(JSON.stringify(Array.from(o))),this.keys.set(e,n)),i}smembers(e){const t=this.keys.get(e);return!t||t.type!=="set"?[]:this.isExpired(t)?(this.deleteKey(e),[]):Array.from(t.value)}sismember(e,t){const n=this.keys.get(e);return!n||n.type!=="set"?0:this.isExpired(n)?(this.deleteKey(e),0):n.value.has(t)?1:0}scard(e){const t=this.keys.get(e);return!t||t.type!=="set"?0:this.isExpired(t)?(this.deleteKey(e),0):t.value.size}zadd(e,t){if(!this.isKeyForThisNode(e))throw new Error("MOVED - key belongs to different node");this.checkMemoryAndEvict();let n=this.keys.get(e);(!n||n.type!=="zset")&&(n&&(this.currentMemoryUsage-=this.calculateKeySize(n)),n={key:e,type:"zset",value:new Map,size:0});const o=n.value;let i=0;for(let l=0;l<t.length;l+=2){const u=parseFloat(t[l]),f=t[l+1];o.has(f)||i++,o.set(f,u)}return n.size=this.estimateSize(JSON.stringify(Array.from(o.entries()))),this.keys.set(e,n),this.currentMemoryUsage+=this.calculateKeySize(n),i}zrem(e,t){const n=this.keys.get(e);if(!n||n.type!=="zset")return 0;if(this.isExpired(n))return this.deleteKey(e),0;const o=n.value;let i=0;for(const l of t)o.has(l)&&(o.delete(l),i++);return i>0&&(n.size=this.estimateSize(JSON.stringify(Array.from(o.entries()))),this.keys.set(e,n)),i}zrange(e,t,n){const o=this.keys.get(e);if(!o||o.type!=="zset")return[];if(this.isExpired(o))return this.deleteKey(e),[];const i=o.value,l=Array.from(i.entries()).sort((g,m)=>g[1]-m[1]),u=l.length,f=t<0?Math.max(0,u+t):Math.min(t,u),p=n<0?Math.max(0,u+n):Math.min(n,u-1);return l.slice(f,p+1).map(g=>g[0])}zscore(e,t){const n=this.keys.get(e);return!n||n.type!=="zset"?null:this.isExpired(n)?(this.deleteKey(e),null):n.value.get(t)??null}zcard(e){const t=this.keys.get(e);return!t||t.type!=="zset"?0:this.isExpired(t)?(this.deleteKey(e),0):t.value.size}info(e){const t=this.getMetrics();return`# Server
redis_version:7.2.0
redis_mode:${this.config.enableCluster?"cluster":"standalone"}

# Memory
used_memory:${t.memoryUsage}
used_memory_human:${this.formatBytes(t.memoryUsage)}
maxmemory:${this.maxMemoryBytes}
maxmemory_human:${this.formatBytes(this.maxMemoryBytes)}
maxmemory_policy:${this.config.maxMemoryPolicy||"noeviction"}
mem_fragmentation_ratio:1.0

# Stats
total_keys:${t.totalKeys}
expired_keys:${t.expiredKeys}
evicted_keys:${t.evictedKeys}
keyspace_hits:${t.hitCount}
keyspace_misses:${t.missCount}

# Cluster
cluster_enabled:${this.config.enableCluster?1:0}
`}dbsize(){return this.cleanupExpiredKeys(),this.keys.size}setKey(e,t,n,o){const i={key:e,type:t,value:n,ttl:o!==void 0?o:-1,expiresAt:o!==void 0&&o>0?Date.now()+o*1e3:void 0,size:this.estimateSize(typeof n=="string"?n:JSON.stringify(n))};this.keys.set(e,i),this.currentMemoryUsage+=this.calculateKeySize(i)}deleteKey(e){const t=this.keys.get(e);return t?(this.currentMemoryUsage-=this.calculateKeySize(t),this.keys.delete(e),!0):!1}isExpired(e){return e.expiresAt?Date.now()>=e.expiresAt:!1}cleanupExpiredKeys(){let e=0;for(const[t,n]of this.keys.entries())this.isExpired(n)&&(this.deleteKey(t),e++);e>0&&(this.metrics.expiredKeys+=e)}checkMemoryAndEvict(){if(this.currentMemoryUsage<=this.maxMemoryBytes)return;const e=this.config.maxMemoryPolicy||"noeviction";if(e==="noeviction")return;const t=this.selectKeysToEvict(e);let n=0;for(const o of t)if(this.deleteKey(o),n++,this.currentMemoryUsage<=this.maxMemoryBytes*.9)break;n>0&&(this.metrics.evictedKeys+=n)}selectKeysToEvict(e){const t=Array.from(this.keys.keys());switch(e){case"allkeys-lru":case"allkeys-lfu":case"allkeys-random":return t;case"volatile-lru":case"volatile-lfu":case"volatile-ttl":case"volatile-random":return t.filter(n=>{const o=this.keys.get(n);return o&&o.expiresAt!==void 0});default:return[]}}calculateKeySize(e){if(e.size)return e.size;let t=0;return typeof e.value=="string"?t=Buffer.byteLength(e.value,"utf8"):t=Buffer.byteLength(JSON.stringify(e.value),"utf8"),Buffer.byteLength(e.key,"utf8")+t+100}estimateSize(e){return Buffer.byteLength(e,"utf8")}patternToRegex(e){const t=e.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*").replace(/\?/g,".");return new RegExp(`^${t}$`)}formatBytes(e){if(e===0)return"0B";const t=1024,n=["B","KB","MB","GB"],o=Math.floor(Math.log(e)/Math.log(t));return Math.round(e/Math.pow(t,o)*100)/100+n[o]}getMetrics(){return this.cleanupExpiredKeys(),this.updateMetrics(),{...this.metrics}}updateMetrics(){const e=Date.now();(e-this.lastMetricsUpdate)/1e3;const t={string:0,hash:0,list:0,set:0,zset:0,stream:0};for(const l of this.keys.values())t[l.type]++;const n=this.operationHistory.filter(l=>l.timestamp>e-1e3).length,o=this.metrics.hitCount+this.metrics.missCount,i=o>0?this.metrics.hitCount/o:0;this.metrics={totalKeys:this.keys.size,keysByType:t,memoryUsage:this.currentMemoryUsage,memoryUsagePercent:this.maxMemoryBytes>0?this.currentMemoryUsage/this.maxMemoryBytes*100:0,operationsPerSecond:n,hitCount:this.metrics.hitCount,missCount:this.metrics.missCount,hitRate:i,expiredKeys:this.metrics.expiredKeys,evictedKeys:this.metrics.evictedKeys,connectedClients:1},this.lastMetricsUpdate=e}getAllKeys(){return this.cleanupExpiredKeys(),Array.from(this.keys.values())}getKey(e){const t=this.keys.get(e);if(t&&this.isExpired(t)){this.deleteKey(e);return}return t}syncKeysFromConfig(e){const t=new Map;for(const n of e)t.set(n.key,n);for(const[n,o]of this.keys.entries());for(const n of e){const o=this.keys.get(n.key);if(!o)this.setKey(n.key,n.type,n.value,n.ttl);else if(o.type!==n.type||JSON.stringify(o.value)!==JSON.stringify(n.value)||o.ttl!==n.ttl){this.currentMemoryUsage-=this.calculateKeySize(o);const i={...n,expiresAt:n.ttl!==void 0&&n.ttl>0?Date.now()+n.ttl*1e3:void 0,size:this.estimateSize(typeof n.value=="string"?n.value:JSON.stringify(n.value))};this.keys.set(n.key,i),this.currentMemoryUsage+=this.calculateKeySize(i)}}this.updateMetrics()}}class MT{clusterName="archiphoenix-cluster";nodes=new Map;keyspaces=new Map;tables=new Map;tableData=new Map;defaultConsistencyLevel="QUORUM";defaultReplicationFactor=3;enableCompaction=!0;compactionStrategy="SizeTieredCompactionStrategy";datacenter="dc1";metrics={readLatency:5,writeLatency:10,totalNodes:0,healthyNodes:0,totalKeyspaces:0,totalTables:0,totalRows:0,totalSize:0,readOperationsPerSecond:0,writeOperationsPerSecond:0,readConsistencyViolations:0,writeConsistencyViolations:0,pendingCompactions:0,hintedHandoffs:0};readOperations=[];writeOperations=[];lastMetricsUpdate=Date.now();initialize(e){if(this.clusterName=e.clusterName||"archiphoenix-cluster",this.defaultConsistencyLevel=e.defaultConsistencyLevel||"QUORUM",this.defaultReplicationFactor=e.defaultReplicationFactor||3,this.enableCompaction=e.enableCompaction??!0,this.compactionStrategy=e.compactionStrategy||"SizeTieredCompactionStrategy",this.datacenter=e.datacenter||"dc1",this.nodes.clear(),e.nodes)for(const t of e.nodes)this.nodes.set(t.address,{...t});else this.nodes.set("localhost:9042",{address:"localhost:9042",status:"up",load:.5,tokens:256});if(this.keyspaces.clear(),e.keyspaces)for(const t of e.keyspaces)this.keyspaces.set(t.name,{...t});else this.keyspaces.set("system",{name:"system",replication:3,replicationStrategy:"NetworkTopologyStrategy",tables:0,size:0,durableWrites:!0});if(this.tables.clear(),this.tableData.clear(),e.tables)for(const t of e.tables){const n=`${t.keyspace}.${t.name}`;this.tables.set(n,{...t}),this.tableData.set(n,[])}this.updateMetrics()}syncFromConfig(e){if(e.clusterName&&(this.clusterName=e.clusterName),e.defaultConsistencyLevel&&(this.defaultConsistencyLevel=e.defaultConsistencyLevel),e.defaultReplicationFactor!==void 0&&(this.defaultReplicationFactor=e.defaultReplicationFactor),e.nodes)for(const t of e.nodes)this.nodes.set(t.address,{...t});if(e.keyspaces){new Set(this.keyspaces.keys());for(const t of e.keyspaces)this.keyspaces.set(t.name,{...t,tables:this.countTablesInKeyspace(t.name)})}if(e.tables)for(const t of e.tables){const n=`${t.keyspace}.${t.name}`,o=this.tables.get(n);if(o){const i=this.tableData.get(n)||[];this.tables.set(n,{...t,rows:o.rows||i.length||0,size:o.size||i.length*1024||0})}else this.tables.set(n,{...t,rows:0,size:0}),this.tableData.has(n)||this.tableData.set(n,[])}this.updateMetrics()}executeCQL(e,t){const n=Date.now(),o=t||this.defaultConsistencyLevel;try{const i=e.trim().replace(/\s+/g," "),l=i.toUpperCase();return l.startsWith("SELECT")?this.executeSelect(i,o,n):l.startsWith("INSERT")?this.executeInsert(i,o,n):l.startsWith("UPDATE")?this.executeUpdate(i,o,n):l.startsWith("DELETE")?this.executeDelete(i,o,n):l.startsWith("CREATE KEYSPACE")?this.executeCreateKeyspace(i,n):l.startsWith("CREATE TABLE")?this.executeCreateTable(i,n):l.startsWith("DROP TABLE")?this.executeDropTable(i,n):l.startsWith("DROP KEYSPACE")?this.executeDropKeyspace(i,n):{success:!1,error:`Unsupported CQL statement: ${i}`,latency:Date.now()-n}}catch(i){return{success:!1,error:i instanceof Error?i.message:"Unknown error",latency:Date.now()-n}}}executeSelect(e,t,n){const o=e.match(/FROM\s+([\w.]+)/i);if(!o)return{success:!1,error:"Invalid SELECT query: missing FROM clause",latency:Date.now()-n};const i=o[1].trim(),l=this.normalizeTableKey(i),u=this.tables.get(l);if(!u)return{success:!1,error:`Table ${i} does not exist`,latency:Date.now()-n};const f=this.tableData.get(l)||[],p=e.match(/LIMIT\s+(\d+)/i),g=p?parseInt(p[1],10):void 0;let m=[...f];const y=e.match(/WHERE\s+(.+?)(?:\s+LIMIT|$)/i);if(y){const M=y[1].trim().match(/(\w+)\s*=\s*['"]?([^'"\s]+)['"]?/);if(M){const A=M[1],T=M[2];m=f.filter(N=>String(N[A])===T)}}g!==void 0&&g>0&&(m=m.slice(0,g));const x=this.calculateReadLatency(t),S=this.checkConsistencyViolation(t,u.keyspace);this.recordReadOperation(x,S);const C=this.getRequiredReplicas(t,u.keyspace);return{success:!0,latency:x,consistency:t,rows:m,rowCount:m.length,replicasQueried:C}}executeInsert(e,t,n){const o=e.match(/INTO\s+([\w.]+)/i);if(!o)return{success:!1,error:"Invalid INSERT query: missing INTO clause",latency:Date.now()-n};const i=o[1].trim(),l=this.normalizeTableKey(i);let u=this.tables.get(l);if(!u)return{success:!1,error:`Table ${i} does not exist`,latency:Date.now()-n};const f=e.match(/\(([^)]+)\)\s*VALUES/i),p=e.match(/VALUES\s*\(([^)]+)\)/i);if(!f||!p)return{success:!1,error:"Invalid INSERT query: missing columns or values",latency:Date.now()-n};const g=f[1].split(",").map(A=>A.trim()),m=p[1],y=this.parseValueList(m);if(g.length!==y.length)return{success:!1,error:"Column count does not match value count",latency:Date.now()-n};const x={};for(let A=0;A<g.length;A++)x[g[A]]=y[A];const S=this.tableData.get(l)||[];S.push(x),this.tableData.set(l,S),u.rows=S.length,u.size=S.length*1024,this.tables.set(l,u);const C=this.calculateWriteLatency(t,u.keyspace),E=this.checkConsistencyViolation(t,u.keyspace);this.recordWriteOperation(C,E);const M=this.getRequiredReplicas(t,u.keyspace);return this.updateMetrics(),{success:!0,latency:C,consistency:t,rowCount:1,replicasQueried:M}}executeUpdate(e,t,n){const o=e.match(/UPDATE\s+([\w.]+)\s+SET/i);if(!o)return{success:!1,error:"Invalid UPDATE query",latency:Date.now()-n};const i=o[1].trim(),l=this.normalizeTableKey(i),u=this.tables.get(l);if(!u)return{success:!1,error:`Table ${i} does not exist`,latency:Date.now()-n};const f=e.match(/SET\s+(.+?)(?:\s+WHERE|$)/i);if(!f)return{success:!1,error:"Invalid UPDATE query: missing SET clause",latency:Date.now()-n};const p=f[1].trim(),g={},m=p.split(",").map(q=>q.trim());for(const q of m){const P=q.match(/(\w+)\s*=\s*(.+)/);if(P){const H=P[1].trim(),J=this.parseValue(P[2].trim());g[H]=J}}const y=e.match(/WHERE\s+(.+)/i);if(!y)return{success:!1,error:"UPDATE requires WHERE clause",latency:Date.now()-n};const S=y[1].trim().match(/(\w+)\s*=\s*['"]?([^'"\s]+)['"]?/);if(!S)return{success:!1,error:"Unsupported WHERE clause format",latency:Date.now()-n};const C=S[1],E=S[2],M=this.tableData.get(l)||[];let A=0;for(const q of M)String(q[C])===E&&(Object.assign(q,g),A++);u.rows=M.length,u.size=M.length*1024,this.tables.set(l,u);const T=this.calculateWriteLatency(t,u.keyspace),N=this.checkConsistencyViolation(t,u.keyspace);this.recordWriteOperation(T,N);const D=this.getRequiredReplicas(t,u.keyspace);return this.updateMetrics(),{success:!0,latency:T,consistency:t,rowCount:A,replicasQueried:D}}executeDelete(e,t,n){const o=e.match(/FROM\s+([\w.]+)/i);if(!o)return{success:!1,error:"Invalid DELETE query: missing FROM clause",latency:Date.now()-n};const i=o[1].trim(),l=this.normalizeTableKey(i),u=this.tables.get(l);if(!u)return{success:!1,error:`Table ${i} does not exist`,latency:Date.now()-n};const f=e.match(/WHERE\s+(.+)/i);if(!f)return{success:!1,error:"DELETE requires WHERE clause",latency:Date.now()-n};const g=f[1].trim().match(/(\w+)\s*=\s*['"]?([^'"\s]+)['"]?/);if(!g)return{success:!1,error:"Unsupported WHERE clause format",latency:Date.now()-n};const m=g[1],y=g[2],x=this.tableData.get(l)||[],S=x.length,C=x.filter(N=>String(N[m])!==y);this.tableData.set(l,C),u.rows=C.length,u.size=C.length*1024,this.tables.set(l,u);const E=S-C.length,M=this.calculateWriteLatency(t,u.keyspace),A=this.checkConsistencyViolation(t,u.keyspace);this.recordWriteOperation(M,A);const T=this.getRequiredReplicas(t,u.keyspace);return this.updateMetrics(),{success:!0,latency:M,consistency:t,rowCount:E,replicasQueried:T}}executeCreateKeyspace(e,t){const n=e.match(/KEYSPACE\s+(\w+)/i);if(!n)return{success:!1,error:"Invalid CREATE KEYSPACE query",latency:Date.now()-t};const o=n[1].trim();if(this.keyspaces.has(o))return{success:!1,error:`Keyspace ${o} already exists`,latency:Date.now()-t};let i=this.defaultReplicationFactor;const l=e.match(/replication.*?(\d+)/i);return l&&(i=parseInt(l[1],10)),this.keyspaces.set(o,{name:o,replication:i,replicationStrategy:"NetworkTopologyStrategy",tables:0,size:0,durableWrites:!0}),this.updateMetrics(),{success:!0,latency:Date.now()-t,rowCount:0}}executeCreateTable(e,t){const n=e.match(/TABLE\s+([\w.]+)/i);if(!n)return{success:!1,error:"Invalid CREATE TABLE query",latency:Date.now()-t};const o=n[1].trim(),i=this.normalizeTableKey(o);if(this.tables.has(i))return{success:!1,error:`Table ${o} already exists`,latency:Date.now()-t};let l=e;const u=e.toUpperCase().indexOf(" WITH ");u>0&&(l=e.substring(0,u));const f=l.match(/\(([^)]+)\)/);if(!f)return{success:!1,error:"Invalid CREATE TABLE query: missing column definitions",latency:Date.now()-t};const p=f[1],g=[],m=p.split(",").map(M=>M.trim());for(const M of m){if(M.toUpperCase().includes("PRIMARY KEY"))continue;const A=M.match(/(\w+)\s+(\w+)/);A&&g.push({name:A[1],type:A[2]})}const y=o.split("."),x=y.length>1?y[0]:"system",S=y.length>1?y[1]:y[0];if(!this.keyspaces.has(x))return{success:!1,error:`Keyspace ${x} does not exist`,latency:Date.now()-t};const C={name:S,keyspace:x,columns:g,rows:0,size:0};this.tables.set(i,C),this.tableData.set(i,[]);const E=this.keyspaces.get(x);return E&&(E.tables=this.countTablesInKeyspace(x),this.keyspaces.set(x,E)),this.updateMetrics(),{success:!0,latency:Date.now()-t,rowCount:0}}executeDropTable(e,t){const n=e.match(/TABLE\s+([\w.]+)/i);if(!n)return{success:!1,error:"Invalid DROP TABLE query",latency:Date.now()-t};const o=n[1].trim(),i=this.normalizeTableKey(o);if(!this.tables.has(i))return{success:!1,error:`Table ${o} does not exist`,latency:Date.now()-t};const l=this.tables.get(i);this.tables.delete(i),this.tableData.delete(i);const u=this.keyspaces.get(l.keyspace);return u&&(u.tables=this.countTablesInKeyspace(l.keyspace),this.keyspaces.set(l.keyspace,u)),this.updateMetrics(),{success:!0,latency:Date.now()-t,rowCount:0}}executeDropKeyspace(e,t){const n=e.match(/KEYSPACE\s+(\w+)/i);if(!n)return{success:!1,error:"Invalid DROP KEYSPACE query",latency:Date.now()-t};const o=n[1].trim();if(!this.keyspaces.has(o))return{success:!1,error:`Keyspace ${o} does not exist`,latency:Date.now()-t};const i=[];for(const[l,u]of this.tables.entries())u.keyspace===o&&i.push(l);for(const l of i)this.tables.delete(l),this.tableData.delete(l);return this.keyspaces.delete(o),this.updateMetrics(),{success:!0,latency:Date.now()-t,rowCount:0}}getNodes(){return Array.from(this.nodes.values())}getKeyspaces(){return Array.from(this.keyspaces.values())}getTables(){return Array.from(this.tables.values())}getMetrics(){return this.updateMetrics(),{...this.metrics}}calculateReadLatency(e){const n=this.getRequiredReplicas(e,"system"),o=Math.log(n+1)*3,i=Math.random()*2;return Math.round(2+o+i)}calculateWriteLatency(e,t){const i=this.getRequiredReplicas(e,t)*2,l=Math.random()*3;return Math.round(5+i+l)}getRequiredReplicas(e,t){const o=this.keyspaces.get(t)?.replication||this.defaultReplicationFactor;switch(e){case"ONE":case"LOCAL_ONE":return 1;case"TWO":return 2;case"THREE":return 3;case"QUORUM":case"LOCAL_QUORUM":return Math.floor(o/2)+1;case"ALL":case"EACH_QUORUM":return o;case"SERIAL":case"LOCAL_SERIAL":return Math.floor(o/2)+1;default:return Math.floor(o/2)+1}}checkConsistencyViolation(e,t){const n=this.metrics.healthyNodes,o=this.getRequiredReplicas(e,t),i=n<o?.8:.05;return Math.random()<i}recordReadOperation(e,t){const n=Date.now();this.readOperations.push({timestamp:n,latency:e,violated:t}),this.readOperations.length>1e3&&this.readOperations.shift(),t&&this.metrics.readConsistencyViolations++}recordWriteOperation(e,t){const n=Date.now();this.writeOperations.push({timestamp:n,latency:e,violated:t}),this.writeOperations.length>1e3&&this.writeOperations.shift(),t&&this.metrics.writeConsistencyViolations++}updateMetrics(){const e=Date.now();(e-this.lastMetricsUpdate)/1e3,this.metrics.totalNodes=this.nodes.size,this.metrics.healthyNodes=Array.from(this.nodes.values()).filter(p=>p.status==="up").length,this.metrics.totalKeyspaces=this.keyspaces.size,this.metrics.totalTables=this.tables.size;let t=0,n=0;for(const[p,g]of this.tableData.entries())t+=g.length,n+=g.length*1024;this.metrics.totalRows=t,this.metrics.totalSize=n;const o=e-1e3,i=this.readOperations.filter(p=>p.timestamp>o),l=this.writeOperations.filter(p=>p.timestamp>o);if(this.metrics.readOperationsPerSecond=i.length,this.metrics.writeOperationsPerSecond=l.length,i.length>0){const p=i.reduce((g,m)=>g+m.latency,0)/i.length;this.metrics.readLatency=Math.round(p*10)/10}if(l.length>0){const p=l.reduce((g,m)=>g+m.latency,0)/l.length;this.metrics.writeLatency=Math.round(p*10)/10}this.metrics.pendingCompactions=Math.floor(this.metrics.totalSize/(10*1024*1024));const u=this.metrics.totalNodes-this.metrics.healthyNodes;this.metrics.hintedHandoffs=u>0?u*5:0;const f=this.metrics.readOperationsPerSecond+this.metrics.writeOperationsPerSecond;for(const p of this.nodes.values())if(p.status==="up"){const g=Math.min(.95,.3+f/100*.3);p.load=p.load*.9+g*.1,p.load+=(Math.random()-.5)*.05,p.load=Math.max(.1,Math.min(.95,p.load))}this.lastMetricsUpdate=e}countTablesInKeyspace(e){let t=0;for(const n of this.tables.values())n.keyspace===e&&t++;return t}normalizeTableKey(e){return e.includes(".")?e:`system.${e}`}parseValueList(e){const t=[];let n="",o=!1,i="";for(let l=0;l<e.length;l++){const u=e[l];if((u==='"'||u==="'")&&!o){o=!0,i=u;continue}else if(u===i&&o){o=!1,i="";continue}u===","&&!o?(t.push(this.parseValue(n.trim())),n=""):n+=u}return n.trim()&&t.push(this.parseValue(n.trim())),t}parseValue(e){return e=e.trim(),e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'")?e.slice(1,-1):/^-?\d+$/.test(e)?parseInt(e,10):/^-?\d*\.\d+$/.test(e)?parseFloat(e):e.toUpperCase()==="TRUE"?!0:e.toUpperCase()==="FALSE"?!1:e.toUpperCase()==="NULL"?null:e}}class ET{cluster="archiphoenix-cluster";replication=!1;tables=new Map;tableData=new Map;tableParts=new Map;maxMemoryUsage=10*1024*1024*1024;compression="LZ4";metrics={queryThroughput:0,avgQueryTime:45,queriesPerSecond:0,readRowsPerSecond:0,writtenRowsPerSecond:0,totalRows:0,totalSize:0,compressionRatio:5,activeQueries:0,memoryUsage:0,memoryUsagePercent:0,partsCount:0,pendingMerges:0,totalTables:0,clusterNodes:1,healthyNodes:1};queryOperations=[];lastMetricsUpdate=Date.now();activeQueriesSet=new Set;initialize(e){if(this.cluster=e.cluster||"archiphoenix-cluster",this.replication=e.replication||!1,this.maxMemoryUsage=e.maxMemoryUsage||10*1024*1024*1024,this.compression=e.compression||"LZ4",this.tables.clear(),this.tableData.clear(),this.tableParts.clear(),e.tables)for(const t of e.tables){const n=`${t.database||"default"}.${t.name}`;this.tables.set(n,{...t}),this.tableData.set(n,[]),this.tableParts.set(n,[])}this.updateMetrics()}syncFromConfig(e){if(e.cluster&&(this.cluster=e.cluster),e.replication!==void 0&&(this.replication=e.replication),e.maxMemoryUsage&&(this.maxMemoryUsage=e.maxMemoryUsage),e.compression&&(this.compression=e.compression),e.tables)for(const t of e.tables){const n=`${t.database||"default"}.${t.name}`,o=this.tables.get(n),i=this.tableData.get(n)||[];o?this.tables.set(n,{...t,rows:o.rows||i.length||0,size:o.size||i.length*512||0}):(this.tables.set(n,{...t,rows:0,size:0}),this.tableData.has(n)||(this.tableData.set(n,[]),this.tableParts.set(n,[])))}this.updateMetrics()}executeQuery(e){const t=Date.now(),n=`query-${Date.now()}-${Math.random()}`;try{const o=e.trim().replace(/\s+/g," "),i=o.toUpperCase();this.activeQueriesSet.add(n),this.metrics.activeQueries=this.activeQueriesSet.size;let l;i.startsWith("SELECT")?l=this.executeSelect(o,t):i.startsWith("INSERT")?l=this.executeInsert(o,t):i.startsWith("ALTER")?l=this.executeAlter(o,t):i.startsWith("CREATE TABLE")?l=this.executeCreateTable(o,t):i.startsWith("DROP TABLE")?l=this.executeDropTable(o,t):l={success:!1,error:`Unsupported SQL statement: ${o}`,latency:Date.now()-t};const u=l.latency||Date.now()-t;return this.queryOperations.push({timestamp:Date.now(),latency:u,rowsRead:l.dataRead||0,rowsWritten:l.dataWritten||0}),this.activeQueriesSet.delete(n),this.metrics.activeQueries=this.activeQueriesSet.size,l}catch(o){return this.activeQueriesSet.delete(n),this.metrics.activeQueries=this.activeQueriesSet.size,{success:!1,error:o instanceof Error?o.message:"Unknown error",latency:Date.now()-t}}}executeSelect(e,t){const n=e.match(/FROM\s+([\w.]+)/i);if(!n)return{success:!1,error:"Invalid SELECT query: missing FROM clause",latency:Date.now()-t};const o=n[1].trim(),i=this.normalizeTableKey(o),l=this.tables.get(i);if(!l)return{success:!1,error:`Table ${o} does not exist`,latency:Date.now()-t};const u=this.tableData.get(i)||[],f=e.match(/SELECT\s+(.+?)\s+FROM/i),p=f?f[1].trim().split(",").map(A=>A.trim()):["*"];let g=[...u];const m=e.match(/WHERE\s+(.+?)(?:\s+GROUP\s+BY|\s+ORDER\s+BY|\s+LIMIT|$)/i);if(m){const T=m[1].trim().match(/(\w+)\s*=\s*['"]?([^'"\s]+)['"]?/);if(T){const N=T[1],D=T[2];g=u.filter(q=>String(q[N])===D)}}const y=e.match(/GROUP\s+BY\s+(\w+)/i);if(y){const A=y[1],T=new Map;g.forEach(N=>{const D=String(N[A]||"null");T.set(D,(T.get(D)||0)+1)}),g=Array.from(T.entries()).map(([N,D])=>({[A]:N,count:D}))}const x=e.match(/ORDER\s+BY\s+(\w+)(?:\s+(ASC|DESC))?/i);if(x){const A=x[1],T=(x[2]||"ASC").toUpperCase();g.sort((N,D)=>{const q=N[A],P=D[A];return T==="DESC"?q>P?-1:q<P?1:0:q<P?-1:q>P?1:0})}const S=e.match(/LIMIT\s+(\d+)/i),C=S?parseInt(S[1],10):void 0;C!==void 0&&C>0&&(g=g.slice(0,C));const E=this.calculateQueryLatency(e,l,g.length);let M=g;return!p.includes("*")&&p.length>0&&(M=g.map(A=>{const T={};return p.forEach(N=>{A.hasOwnProperty(N)&&(T[N]=A[N])}),T})),{success:!0,latency:E,rows:M,rowCount:M.length,columns:p.includes("*")?Object.keys(u[0]||{}):p,dataRead:u.length}}executeInsert(e,t){const n=e.match(/INTO\s+([\w.]+)/i);if(!n)return{success:!1,error:"Invalid INSERT query: missing INTO clause",latency:Date.now()-t};const o=n[1].trim(),i=this.normalizeTableKey(o);let l=this.tables.get(i);if(!l)return{success:!1,error:`Table ${o} does not exist`,latency:Date.now()-t};const u=e.match(/VALUES\s+(.+)/i);if(!u)return{success:!1,error:"Invalid INSERT query: missing VALUES clause",latency:Date.now()-t};const f=u[1].trim(),p=this.parseValues(f),g=this.tableData.get(i)||[],m={},y=e.match(/\(([^)]+)\)\s+VALUES/i),x=y?y[1].split(",").map(C=>C.trim()):[];x.length>0&&x.length===p.length?x.forEach((C,E)=>{m[C]=p[E]}):p.forEach((C,E)=>{m[`column_${E}`]=C}),g.push(m),this.tableData.set(i,g),l.rows=g.length,l.size=g.length*512,this.tables.set(i,l);const S=10+Math.random()*5;return this.simulatePartCreation(i),this.updateMetrics(),{success:!0,latency:S,rowCount:1,dataWritten:1}}executeCreateTable(e,t){const n=e.match(/CREATE\s+TABLE\s+([\w.]+)/i);if(!n)return{success:!1,error:"Invalid CREATE TABLE query",latency:Date.now()-t};const o=n[1].trim(),i=this.normalizeTableKey(o);if(this.tables.has(i))return{success:!1,error:`Table ${o} already exists`,latency:Date.now()-t};const l=e.match(/ENGINE\s*=\s*(\w+)/i),u=l?l[1]:"MergeTree",[f,p]=i.split("."),g={name:p,database:f||"default",engine:u,rows:0,size:0,partitions:0};return this.tables.set(i,g),this.tableData.set(i,[]),this.tableParts.set(i,[]),this.updateMetrics(),{success:!0,latency:Date.now()-t}}executeDropTable(e,t){const n=e.match(/DROP\s+TABLE\s+([\w.]+)/i);if(!n)return{success:!1,error:"Invalid DROP TABLE query",latency:Date.now()-t};const o=n[1].trim(),i=this.normalizeTableKey(o);return this.tables.has(i)?(this.tables.delete(i),this.tableData.delete(i),this.tableParts.delete(i),this.updateMetrics(),{success:!0,latency:Date.now()-t}):{success:!1,error:`Table ${o} does not exist`,latency:Date.now()-t}}executeAlter(e,t){const n=e.match(/ALTER\s+TABLE\s+([\w.]+)/i);if(!n)return{success:!1,error:"Invalid ALTER TABLE query",latency:Date.now()-t};const o=n[1].trim(),i=this.normalizeTableKey(o);return this.tables.get(i)?{success:!0,latency:Date.now()-t}:{success:!1,error:`Table ${o} does not exist`,latency:Date.now()-t}}calculateQueryLatency(e,t,n){const i=n/1e6*5;let l=1;const u=e.toUpperCase();u.includes("JOIN")&&(l*=2),u.includes("GROUP BY")&&(l*=1.5),u.includes("ORDER BY")&&(l*=1.3),u.includes("COUNT")&&(l*=.8),(u.includes("SUM")||u.includes("AVG"))&&(l*=.9);const f=this.tableParts.get(`${t.database}.${t.name}`)||[],p=Math.min(1.5,1+f.length/100);return 10+i*l*p}parseValues(e){let t=e.trim();t.startsWith("(")&&t.endsWith(")")&&(t=t.slice(1,-1));const n=[];let o="",i=!1,l="";for(let u=0;u<t.length;u++){const f=t[u];(f==='"'||f==="'")&&!i?(i=!0,l=f):f===l&&i?(i=!1,l=""):f===","&&!i?(n.push(this.parseValue(o.trim())),o=""):o+=f}return o.trim()&&n.push(this.parseValue(o.trim())),n}parseValue(e){const t=e.trim();return t.startsWith('"')&&t.endsWith('"')||t.startsWith("'")&&t.endsWith("'")?t.slice(1,-1):/^-?\d+$/.test(t)?parseInt(t,10):/^-?\d*\.\d+$/.test(t)?parseFloat(t):t.toLowerCase()==="true"?!0:t.toLowerCase()==="false"?!1:t.toLowerCase()==="null"?null:t}normalizeTableKey(e){return e.includes(".")?e:`default.${e}`}simulatePartCreation(e){const t=this.tableParts.get(e)||[],n=new Date().toISOString().split("T")[0],o={name:`${n}_${t.length+1}`,minDate:n,maxDate:n,rows:1e3,size:512*1e3,level:0};if(t.push(o),this.tableParts.set(e,t),t.length>10){const i=t.splice(0,5),l={name:`merged_${Date.now()}`,minDate:i[0].minDate,maxDate:i[i.length-1].maxDate,rows:i.reduce((u,f)=>u+f.rows,0),size:i.reduce((u,f)=>u+f.size,0),level:Math.max(...i.map(u=>u.level))+1};t.unshift(l),this.tableParts.set(e,t)}}updateMetrics(){const e=Date.now(),t=(e-this.lastMetricsUpdate)/1e3;this.metrics.totalTables=this.tables.size;let n=0,o=0,i=0;for(const[p,g]of this.tables.entries()){n+=g.rows,o+=g.size;const m=this.tableParts.get(p)||[];i+=m.length}this.metrics.totalRows=n,this.metrics.totalSize=o,this.metrics.partsCount=i;const l=e-1e3,u=this.queryOperations.filter(p=>p.timestamp>l);if(this.metrics.queriesPerSecond=u.length,this.metrics.queryThroughput=u.length,u.length>0){const p=u.reduce((y,x)=>y+x.latency,0)/u.length;this.metrics.avgQueryTime=Math.round(p*10)/10;const g=u.reduce((y,x)=>y+x.rowsRead,0),m=u.reduce((y,x)=>y+x.rowsWritten,0);this.metrics.readRowsPerSecond=Math.round(g/t),this.metrics.writtenRowsPerSecond=Math.round(m/t)}const f=o/this.metrics.compressionRatio;this.metrics.memoryUsage=f,this.metrics.memoryUsagePercent=f/this.maxMemoryUsage*100,this.metrics.pendingMerges=Math.floor(i/10),this.metrics.clusterNodes=this.replication?3:1,this.metrics.healthyNodes=this.metrics.clusterNodes,this.lastMetricsUpdate=e}getMetrics(){return this.updateMetrics(),{...this.metrics}}insertData(e,t){const n=this.normalizeTableKey(e),o=this.tables.get(n);if(!o)return{success:!1,rowsInserted:0,error:`Table ${e} does not exist`};const i=this.tableData.get(n)||[];return i.push(...t),this.tableData.set(n,i),o.rows=i.length,o.size=i.length*512,this.tables.set(n,o),this.simulatePartCreation(n),this.updateMetrics(),{success:!0,rowsInserted:t.length}}}const or={"X-Small":{servers:1,creditsPerHour:1},Small:{servers:2,creditsPerHour:2},Medium:{servers:4,creditsPerHour:4},Large:{servers:8,creditsPerHour:8},"X-Large":{servers:16,creditsPerHour:16},"2X-Large":{servers:32,creditsPerHour:32},"3X-Large":{servers:64,creditsPerHour:64},"4X-Large":{servers:128,creditsPerHour:128}};class RT{account="archiphoenix";region="us-east-1";warehouses=new Map;databases=new Map;tables=new Map;tableData=new Map;queries=new Map;queryQueue=[];activeQueries=new Map;resultCache=new Map;cacheHits=0;cacheMisses=0;metrics={totalWarehouses:0,runningWarehouses:0,suspendedWarehouses:0,totalQueries:0,runningQueries:0,queuedQueries:0,queriesPerSecond:0,avgQueryTime:0,totalComputeTime:0,totalDataRead:0,totalDataWritten:0,cacheHitRate:0,warehouseUtilization:0,totalCost:0};queryOperations=[];lastMetricsUpdate=Date.now();warehouseLastUpdate=new Map;suspendTimers=new Map;initialize(e){if(this.account=e.account||"archiphoenix",this.region=e.region||"us-east-1",this.warehouses.clear(),e.warehouses&&e.warehouses.length>0)for(const t of e.warehouses)this.warehouses.set(t.name,{...t,status:t.status||"suspended",currentClusterCount:t.minClusterCount||1,runningQueries:0,queuedQueries:0,totalQueriesExecuted:0,totalComputeTime:0});else this.warehouses.set("COMPUTE_WH",{name:"COMPUTE_WH",size:"Small",status:"suspended",autoSuspend:60,autoResume:!0,minClusterCount:1,maxClusterCount:1,currentClusterCount:1,runningQueries:0,queuedQueries:0,totalQueriesExecuted:0,totalComputeTime:0});if(this.databases.clear(),this.tables.clear(),this.tableData.clear(),e.databases){for(const t of e.databases)if(this.databases.set(t.name,{...t}),t.schemas){for(const n of t.schemas)if(n.tables)for(const o of n.tables){const i=`${t.name}.${n.name}.${o.name}`;this.tables.set(i,{...o}),this.tableData.set(i,[])}}}this.databases.has("SNOWFLAKE")||this.databases.set("SNOWFLAKE",{name:"SNOWFLAKE",comment:"System database",retentionTime:1,size:0,schemas:[{name:"INFORMATION_SCHEMA",tables:[],views:0,functions:0}]}),this.updateMetrics()}syncFromConfig(e){if(e.account&&(this.account=e.account),e.region&&(this.region=e.region),e.warehouses){for(const n of e.warehouses){const o=this.warehouses.get(n.name);o?(this.warehouses.set(n.name,{...n,status:o.status,currentClusterCount:o.currentClusterCount,runningQueries:o.runningQueries,queuedQueries:o.queuedQueries,totalQueriesExecuted:o.totalQueriesExecuted,totalComputeTime:o.totalComputeTime,lastUsed:o.lastUsed}),this.updateWarehouseAutoSuspend(n.name,n)):this.warehouses.set(n.name,{...n,status:"suspended",currentClusterCount:n.minClusterCount||1,runningQueries:0,queuedQueries:0,totalQueriesExecuted:0,totalComputeTime:0})}const t=new Set(e.warehouses.map(n=>n.name));for(const[n]of this.warehouses.entries())if(!t.has(n)){this.warehouses.delete(n);const o=this.suspendTimers.get(n);o&&(clearTimeout(o),this.suspendTimers.delete(n))}}if(e.databases){for(const t of e.databases)if(this.databases.get(t.name),this.databases.set(t.name,{...t}),t.schemas){for(const n of t.schemas)if(n.tables)for(const o of n.tables){const i=`${t.name}.${n.name}.${o.name}`,l=this.tables.get(i),u=this.tableData.get(i)||[];l?this.tables.set(i,{...o,rows:l.rows||u.length||0,size:l.size||u.length*512||0}):(this.tables.set(i,{...o,rows:0,size:0}),this.tableData.set(i,[]))}}}this.updateMetrics()}executeQuery(e,t,n,o){const i=Date.now(),l=`query-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,u=this.getCacheKey(e,n,o),f=this.resultCache.get(u);if(f&&Date.now()-f.timestamp<f.ttl)return this.cacheHits++,this.updateMetrics(),{success:!0,latency:10,rows:f.data,rowCount:f.data.length,queryId:l,resultCacheUsed:!0};this.cacheMisses++;let p;if(t?p=this.warehouses.get(t):p=Array.from(this.warehouses.values()).find(m=>m.status==="running")||Array.from(this.warehouses.values())[0],!p)return{success:!1,error:"No warehouse available",latency:Date.now()-i,queryId:l};const g={id:l,queryText:e,status:"queued",warehouse:p.name,database:n,schema:o,startedAt:i};return this.queries.set(l,g),p.status==="suspended"&&p.autoResume&&this.resumeWarehouse(p.name),p.status==="running"?this.executeQueryOnWarehouse(g,p,i):(p.queuedQueries++,this.queryQueue.push(g),g.status="queued",p.autoResume&&this.resumeWarehouse(p.name),p.status==="running"&&this.processQueryQueue(p),{success:!0,latency:50,queryId:l,warehouse:p.name})}executeQueryOnWarehouse(e,t,n){e.status="running",e.startedAt=Date.now(),t.runningQueries++,this.activeQueries.set(e.id,e),1/(or[t.size]||or.Small).servers,this.estimateQueryComplexity(e.queryText);const i=this.executeSQL(e.queryText,e.database,e.schema),l=Date.now();if(e.completedAt=l,e.duration=l-(e.startedAt||n),e.status=i.success?"success":"failed",e.rowsReturned=i.rowCount,e.error=i.error,t.runningQueries--,t.totalQueriesExecuted++,t.totalComputeTime+=e.duration/1e3,t.lastUsed=l,this.activeQueries.delete(e.id),i.success&&i.rows){const u=this.getCacheKey(e.queryText,e.database,e.schema);this.resultCache.set(u,{data:i.rows,timestamp:l,ttl:3e5})}return this.queryOperations.push({timestamp:l,latency:e.duration,rowsRead:i.dataRead||0,rowsWritten:i.dataWritten||0}),t.autoSuspend&&t.runningQueries===0&&t.queuedQueries===0&&this.scheduleWarehouseSuspend(t.name,t.autoSuspend),this.updateMetrics(),{...i,queryId:e.id,warehouse:t.name,latency:e.duration}}executeSQL(e,t,n){const o=e.trim().replace(/\s+/g," "),i=o.toUpperCase();try{return i.startsWith("SELECT")?this.executeSelect(o,t,n):i.startsWith("INSERT")?this.executeInsert(o,t,n):i.startsWith("UPDATE")?this.executeUpdate(o,t,n):i.startsWith("DELETE")?this.executeDelete(o,t,n):i.startsWith("CREATE TABLE")?this.executeCreateTable(o,t,n):i.startsWith("DROP TABLE")?this.executeDropTable(o,t,n):{success:!1,error:`Unsupported SQL statement: ${o}`}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Unknown error"}}}executeSelect(e,t,n){const o=e.match(/FROM\s+([\w.]+)/i);if(!o)return{success:!1,error:"Invalid SELECT query: missing FROM clause"};const i=o[1].trim(),l=this.normalizeTableKey(i,t,n),u=this.tables.get(l);if(!u)return{success:!1,error:`Table ${i} does not exist`};const f=this.tableData.get(l)||[],p=e.match(/SELECT\s+(.+?)\s+FROM/i),g=p?p[1].trim().split(",").map(S=>S.trim()):["*"];let m=[...f];const y=e.match(/WHERE\s+(.+?)(?:\s+GROUP\s+BY|\s+ORDER\s+BY|\s+LIMIT|$)/i);if(y){const C=y[1].trim().match(/(\w+)\s*=\s*['"]?([^'"\s]+)['"]?/);if(C){const E=C[1],M=C[2];m=f.filter(A=>String(A[E])===M)}}const x=e.match(/LIMIT\s+(\d+)/i);if(x){const S=parseInt(x[1],10);m=m.slice(0,S)}return{success:!0,rows:m,rowCount:m.length,columns:g.includes("*")?u.columns?.map(S=>S.name)||[]:g,dataRead:f.length}}executeInsert(e,t,n){const o=e.match(/INTO\s+([\w.]+)/i);if(!o)return{success:!1,error:"Invalid INSERT query: missing INTO clause"};const i=o[1].trim(),l=this.normalizeTableKey(i,t,n),u=this.tables.get(l);if(!u)return{success:!1,error:`Table ${i} does not exist`};const f=e.match(/VALUES\s*\((.+?)\)/i);if(!f)return{success:!1,error:"Invalid INSERT query: missing VALUES clause"};const p=f[1].split(",").map(x=>x.trim().replace(/^['"]|['"]$/g,"")),g=u.columns||[];if(p.length!==g.length)return{success:!1,error:`Column count mismatch: expected ${g.length}, got ${p.length}`};const m={};g.forEach((x,S)=>{m[x.name]=p[S]});const y=this.tableData.get(l)||[];return y.push(m),this.tableData.set(l,y),u.rows=y.length,u.size=y.length*512,{success:!0,rowCount:1,dataWritten:1}}executeUpdate(e,t,n){return{success:!0,rowCount:0,dataWritten:0}}executeDelete(e,t,n){return{success:!0,rowCount:0,dataWritten:0}}executeCreateTable(e,t,n){const o=e.match(/CREATE\s+TABLE\s+([\w.]+)/i);if(!o)return{success:!1,error:"Invalid CREATE TABLE query"};const i=o[1].trim(),l=this.normalizeTableKey(i,t,n);if(this.tables.has(l))return{success:!1,error:`Table ${i} already exists`};const u=e.match(/\((.+?)\)/),f=[];if(u){const x=u[1].split(",").map(S=>S.trim());for(const S of x){const C=S.split(/\s+/);C.length>=2&&f.push({name:C[0],type:C[1],nullable:!S.toUpperCase().includes("NOT NULL")})}}const[p,g,m]=this.parseTableName(i,t,n),y={name:m,schema:g,database:p,columns:f,rows:0,size:0,created:Date.now()};return this.tables.set(l,y),this.tableData.set(l,[]),{success:!0,rowCount:0}}executeDropTable(e,t,n){const o=e.match(/DROP\s+TABLE\s+([\w.]+)/i);if(!o)return{success:!1,error:"Invalid DROP TABLE query"};const i=o[1].trim(),l=this.normalizeTableKey(i,t,n);return this.tables.has(l)?(this.tables.delete(l),this.tableData.delete(l),{success:!0,rowCount:0}):{success:!1,error:`Table ${i} does not exist`}}resumeWarehouse(e){const t=this.warehouses.get(e);if(!t)return!1;if(t.status==="running")return!0;const n=this.suspendTimers.get(e);return n&&(clearTimeout(n),this.suspendTimers.delete(e)),t.status="running",t.currentClusterCount=t.minClusterCount,this.processQueryQueue(t),this.updateMetrics(),!0}suspendWarehouse(e){const t=this.warehouses.get(e);return t?t.status==="suspended"?!0:t.runningQueries>0?!1:(t.status="suspended",t.currentClusterCount=0,this.updateMetrics(),!0):!1}scheduleWarehouseSuspend(e,t){const n=this.suspendTimers.get(e);n&&clearTimeout(n);const o=setTimeout(()=>{const i=this.warehouses.get(e);i&&i.runningQueries===0&&i.queuedQueries===0&&this.suspendWarehouse(e),this.suspendTimers.delete(e)},t*1e3);this.suspendTimers.set(e,o)}updateWarehouseAutoSuspend(e,t){const n=this.warehouses.get(e);if(n){if(t.autoSuspend!==void 0||t.autoResume!==void 0){const o=this.suspendTimers.get(e);o&&(clearTimeout(o),this.suspendTimers.delete(e))}n.status==="running"&&n.autoSuspend&&n.runningQueries===0&&n.queuedQueries===0&&this.scheduleWarehouseSuspend(e,n.autoSuspend)}}processQueryQueue(e){if(e.status!=="running")return;const t=this.queryQueue.filter(n=>n.warehouse===e.name&&n.status==="queued");for(const n of t)e.runningQueries<this.getMaxConcurrentQueries(e)&&(e.queuedQueries--,this.queryQueue=this.queryQueue.filter(o=>o.id!==n.id),this.executeQueryOnWarehouse(n,e,n.startedAt||Date.now()))}getMaxConcurrentQueries(e){return(or[e.size]||or.Small).servers*e.currentClusterCount*8}estimateQueryComplexity(e){let t=1;const n=(e.match(/\bJOIN\b/gi)||[]).length;t+=n*.5,e.match(/\bGROUP\s+BY\b/i)&&(t+=.3),e.match(/\bORDER\s+BY\b/i)&&(t+=.2);const o=(e.match(/\b(COUNT|SUM|AVG|MAX|MIN)\s*\(/gi)||[]).length;return t+=o*.2,Math.max(1,t)}normalizeTableKey(e,t,n){const o=e.split(".");return o.length===3?o.join("."):o.length===2?`${t||"PUBLIC"}.${o.join(".")}`:`${t||"PUBLIC"}.${n||"PUBLIC"}.${o[0]}`}parseTableName(e,t,n){const o=e.split(".");return o.length===3?[o[0],o[1],o[2]]:o.length===2?[t||"PUBLIC",o[0],o[1]]:[t||"PUBLIC",n||"PUBLIC",o[0]]}getCacheKey(e,t,n){return`${e}|${t||""}|${n||""}`}updateMetrics(){const e=Date.now(),t=(e-this.lastMetricsUpdate)/1e3;if(this.metrics.totalWarehouses=this.warehouses.size,this.metrics.runningWarehouses=Array.from(this.warehouses.values()).filter(u=>u.status==="running").length,this.metrics.suspendedWarehouses=Array.from(this.warehouses.values()).filter(u=>u.status==="suspended").length,this.metrics.totalQueries=this.queries.size,this.metrics.runningQueries=Array.from(this.warehouses.values()).reduce((u,f)=>u+f.runningQueries,0),this.metrics.queuedQueries=Array.from(this.warehouses.values()).reduce((u,f)=>u+f.queuedQueries,0),t>0){const u=this.queryOperations.filter(f=>f.timestamp>e-1e3);this.metrics.queriesPerSecond=u.length}if(this.queryOperations.length>0){const u=this.queryOperations.slice(-100),f=u.reduce((p,g)=>p+g.latency,0)/u.length;this.metrics.avgQueryTime=f}this.metrics.totalComputeTime=Array.from(this.warehouses.values()).reduce((u,f)=>u+f.totalComputeTime,0);const n=this.queryOperations.slice(-1e3);this.metrics.totalDataRead=n.reduce((u,f)=>u+f.rowsRead,0),this.metrics.totalDataWritten=n.reduce((u,f)=>u+f.rowsWritten,0);const o=this.cacheHits+this.cacheMisses;this.metrics.cacheHitRate=o>0?this.cacheHits/o:0;let i=0;for(const u of this.warehouses.values())if(u.status==="running"){const f=this.getMaxConcurrentQueries(u),p=f>0?u.runningQueries/f:0;i+=p}this.metrics.warehouseUtilization=this.metrics.runningWarehouses>0?i/this.metrics.runningWarehouses:0;let l=0;for(const u of this.warehouses.values())if(u.status==="running"&&u.totalComputeTime>0){const f=or[u.size]||or.Small,p=u.totalComputeTime/3600;l+=f.creditsPerHour*p*u.currentClusterCount}this.metrics.totalCost=l,this.lastMetricsUpdate=e}getMetrics(){return this.updateMetrics(),{...this.metrics}}getWarehouse(e){return this.warehouses.get(e)}getWarehouses(){return Array.from(this.warehouses.values())}getQuery(e){return this.queries.get(e)}getRecentQueries(e=100){return Array.from(this.queries.values()).sort((t,n)=>(n.startedAt||0)-(t.startedAt||0)).slice(0,e)}getTables(e,t){return!e&&!t?Array.from(this.tables.values()):Array.from(this.tables.values()).filter(n=>!(e&&n.database!==e||t&&n.schema!==t))}}class TT{clusterName="archiphoenix-cluster";nodes=new Map;indices=new Map;shards=new Map;documents=new Map;defaultShards=5;defaultReplicas=1;refreshInterval="1s";metrics={clusterHealth:"green",totalNodes:0,healthyNodes:0,totalIndices:0,totalDocs:0,totalSize:0,activeShards:0,relocatingShards:0,initializingShards:0,unassignedShards:0,indexOperationsPerSecond:0,searchOperationsPerSecond:0,averageIndexLatency:5,averageSearchLatency:10,averageGetLatency:2};indexOperations=[];searchOperations=[];getOperations=[];lastMetricsUpdate=Date.now();recentQueries=[];initialize(e){if(this.clusterName=e.clusterName||"archiphoenix-cluster",this.defaultShards=e.defaultShards||5,this.defaultReplicas=e.defaultReplicas||1,this.refreshInterval=e.refreshInterval||"1s",this.nodes.clear(),e.nodes&&e.nodes.length>0)for(const t of e.nodes)this.nodes.set(t,{address:t,status:"up",load:.3+Math.random()*.4,shards:0});else this.nodes.set("localhost:9200",{address:"localhost:9200",status:"up",load:.5,shards:0});if(this.indices.clear(),this.shards.clear(),this.documents.clear(),e.indices&&e.indices.length>0)for(const t of e.indices)this.createIndex(t.name,t.shards||this.defaultShards,t.replicas||this.defaultReplicas,t);else this.createIndex("archiphoenix-index",this.defaultShards,this.defaultReplicas);this.updateMetrics()}syncFromConfig(e){if(e.clusterName&&(this.clusterName=e.clusterName),e.defaultShards!==void 0&&(this.defaultShards=e.defaultShards),e.defaultReplicas!==void 0&&(this.defaultReplicas=e.defaultReplicas),e.refreshInterval&&(this.refreshInterval=e.refreshInterval),e.nodes){new Set(this.nodes.keys());for(const t of e.nodes)this.nodes.has(t)||this.nodes.set(t,{address:t,status:"up",load:.3+Math.random()*.4,shards:0})}if(e.indices){new Set(this.indices.keys());for(const t of e.indices)if(!this.indices.has(t.name))this.createIndex(t.name,t.shards||this.defaultShards,t.replicas||this.defaultReplicas,t);else{const n=this.indices.get(t.name),o=this.getTotalDocsForIndex(t.name),i=this.getTotalSizeForIndex(t.name);this.indices.set(t.name,{...t,docs:n.docs||o,size:n.size||i,health:this.calculateIndexHealth(t.name)})}}this.updateMetrics()}createIndex(e,t=5,n=1,o){const i={name:e,docs:o?.docs||0,size:o?.size||0,shards:t,replicas:n,health:"yellow",mappings:o?.mappings,settings:o?.settings};this.indices.set(e,i);const l=[],u=Array.from(this.nodes.keys());for(let f=0;f<t;f++){const p=u[f%u.length];l.push({index:e,shard:f,primary:!0,node:p,state:"STARTED",docs:0,size:0});for(let g=0;g<n;g++){const m=u[(f+g+1)%u.length];l.push({index:e,shard:f,primary:!1,node:m,state:"STARTED",docs:0,size:0})}}if(this.shards.set(e,l),!this.documents.has(e)){const f=new Map;for(let p=0;p<t;p++)f.set(p,[]);this.documents.set(e,f)}i.health=this.calculateIndexHealth(e),this.updateMetrics()}routeToShard(e,t){const n=this.indices.get(e);if(!n)return 0;let o=0;for(let i=0;i<t.length;i++){const l=t.charCodeAt(i);o=(o<<5)-o+l,o=o&o}return Math.abs(o)%n.shards}indexDocument(e,t,n,o){const i=Date.now(),l=this.indices.get(e);if(!l)return{operation:"index",index:e,id:t,document:n,routing:o,latency:Date.now()-i,success:!1,error:`Index ${e} does not exist`};const u=o||t,f=this.routeToShard(e,u),p={_id:t,_index:e,_source:n,_routing:o},g=this.documents.get(e),m=g.get(f)||[],y=m.findIndex(C=>C._id===t);y>=0?m[y]=p:m.push(p),g.set(f,m),this.documents.set(e,g),l.docs=this.getTotalDocsForIndex(e),l.size=this.getTotalSizeForIndex(e),l.health=this.calculateIndexHealth(e);const x=this.shards.get(e);for(const C of x)C.index===e&&C.shard===f&&C.primary&&(C.docs=m.length,C.size=m.length*1024);const S=this.calculateIndexLatency();return this.recordIndexOperation(S),this.updateMetrics(),{operation:"index",index:e,id:t,document:n,routing:o,latency:S,success:!0,took:S}}getDocument(e,t,n){const o=Date.now();if(!this.indices.get(e))return{operation:"get",index:e,id:t,routing:n,latency:Date.now()-o,success:!1,error:`Index ${e} does not exist`};const l=n||t,u=this.routeToShard(e,l),g=(this.documents.get(e).get(u)||[]).find(y=>y._id===t),m=this.calculateGetLatency();return this.recordGetOperation(m),this.updateMetrics(),g?{operation:"get",index:e,id:t,document:g._source,routing:n,latency:m,success:!0,took:m}:{operation:"get",index:e,id:t,routing:n,latency:m,success:!1,error:`Document ${t} not found`,took:m}}search(e,t){const n=Date.now(),o=this.indices.get(e);if(!o)return{operation:"search",index:e,query:t,latency:Date.now()-n,success:!1,error:`Index ${e} does not exist`};const i=this.documents.get(e);let l=[];for(let m=0;m<o.shards;m++){const y=i.get(m)||[];l=l.concat(y)}let u=l;if(t&&t.query){if(t.query.match_all)u=l;else if(t.query.match){const m=Object.keys(t.query.match)[0],y=t.query.match[m];y&&typeof y=="string"&&(u=l.filter(x=>{const S=x._source[m];return S&&String(S).toLowerCase().includes(y.toLowerCase())}))}}const f=t?.size||10;u=u.slice(0,f);const p=this.calculateSearchLatency(o.shards,u.length);this.recordSearchOperation(p,u.length),this.updateMetrics();const g={operation:"search",index:e,query:t,latency:p,success:!0,hits:u.length,took:p};return this.recentQueries.unshift(g),this.recentQueries.length>100&&(this.recentQueries=this.recentQueries.slice(0,100)),g}deleteDocument(e,t,n){const o=Date.now(),i=this.indices.get(e);if(!i)return{operation:"delete",index:e,id:t,routing:n,latency:Date.now()-o,success:!1,error:`Index ${e} does not exist`};const l=n||t,u=this.routeToShard(e,l),f=this.documents.get(e),p=f.get(u)||[],g=p.length,m=p.filter(S=>S._id!==t);f.set(u,m),this.documents.set(e,f),i.docs=this.getTotalDocsForIndex(e),i.size=this.getTotalSizeForIndex(e),i.health=this.calculateIndexHealth(e);const y=this.shards.get(e);for(const S of y)S.index===e&&S.shard===u&&S.primary&&(S.docs=m.length,S.size=m.length*1024);const x=this.calculateIndexLatency();return this.updateMetrics(),m.length===g?{operation:"delete",index:e,id:t,routing:n,latency:x,success:!1,error:`Document ${t} not found`,took:x}:{operation:"delete",index:e,id:t,routing:n,latency:x,success:!0,took:x}}executeQuery(e){const t=Date.now();try{let n;try{n=JSON.parse(e)}catch{const o=e.split(`
`);if(o.length>=2){const i=o[0].match(/^(GET|POST|PUT|DELETE)\s+(.+)/);if(i){const l=i[1],u=i[2].trim();if(l==="GET"&&u.includes("/_search")){n=o.length>1?JSON.parse(o.slice(1).join(`
`)):{query:{match_all:{}}};const f=u.match(/^\/([^\/]+)\/_search/),p=f?f[1]:"_all";return this.search(p,n)}else if(l==="GET"&&u.match(/\/[^\/]+\/_doc\/[^\/]+/)){const f=u.match(/\/([^\/]+)\/_doc\/([^\/]+)/);if(f)return this.getDocument(f[1],f[2])}}}return{operation:"search",query:e,latency:Date.now()-t,success:!1,error:"Invalid query format"}}return n.query||n.match_all?this.search("_all",n):{operation:"search",query:e,latency:Date.now()-t,success:!1,error:"Unsupported query format"}}catch(n){return{operation:"search",query:e,latency:Date.now()-t,success:!1,error:n instanceof Error?n.message:"Unknown error"}}}getMetrics(){return this.updateMetrics(),{...this.metrics}}getIndices(){return Array.from(this.indices.values())}getShards(e){return this.shards.get(e)||[]}getRecentQueries(e=10){return this.recentQueries.slice(0,e)}calculateIndexHealth(e){const t=this.shards.get(e)||[],n=t.filter(l=>l.state==="UNASSIGNED").length,o=t.filter(l=>l.state==="INITIALIZING").length,i=t.filter(l=>l.state==="RELOCATING").length;return n>0?"red":o>0||i>0?"yellow":"green"}calculateClusterHealth(){let e=!1,t=!1;for(const i of this.indices.values())i.health==="red"?e=!0:i.health==="yellow"&&(t=!0);const n=Array.from(this.nodes.values()).filter(i=>i.status==="up").length,o=this.nodes.size;return n===0||e?"red":n<o||t?"yellow":"green"}getTotalDocsForIndex(e){const t=this.documents.get(e);if(!t)return 0;let n=0;for(const o of t.values())n+=o.length;return n}getTotalSizeForIndex(e){const t=this.documents.get(e);if(!t)return 0;let n=0;for(const o of t.values())n+=o.length*1024;return n}calculateIndexLatency(){const t=this.metrics.totalDocs;return 5+Math.min(20,t/1e4)+Math.random()*5}calculateSearchLatency(e,t){const o=e*2,i=Math.min(50,t/100);return 10+o+i+Math.random()*10}calculateGetLatency(){return 2+Math.random()*3}recordIndexOperation(e){this.indexOperations.push({timestamp:Date.now(),latency:e}),this.indexOperations.length>500&&(this.indexOperations=this.indexOperations.slice(-500))}recordSearchOperation(e,t){this.searchOperations.push({timestamp:Date.now(),latency:e,hits:t}),this.searchOperations.length>500&&(this.searchOperations=this.searchOperations.slice(-500))}recordGetOperation(e){this.getOperations.push({timestamp:Date.now(),latency:e}),this.getOperations.length>500&&(this.getOperations=this.getOperations.slice(-500))}updateMetrics(){const e=Date.now(),t=1e3,n=this.indexOperations.filter(g=>e-g.timestamp<t),o=this.searchOperations.filter(g=>e-g.timestamp<t),i=this.getOperations.filter(g=>e-g.timestamp<t);this.metrics.indexOperationsPerSecond=n.length,this.metrics.searchOperationsPerSecond=o.length,n.length>0&&(this.metrics.averageIndexLatency=n.reduce((g,m)=>g+m.latency,0)/n.length),o.length>0&&(this.metrics.averageSearchLatency=o.reduce((g,m)=>g+m.latency,0)/o.length),i.length>0&&(this.metrics.averageGetLatency=i.reduce((g,m)=>g+m.latency,0)/i.length),this.metrics.totalNodes=this.nodes.size,this.metrics.healthyNodes=Array.from(this.nodes.values()).filter(g=>g.status==="up").length,this.metrics.totalIndices=this.indices.size,this.metrics.totalDocs=Array.from(this.indices.values()).reduce((g,m)=>g+m.docs,0),this.metrics.totalSize=Array.from(this.indices.values()).reduce((g,m)=>g+m.size,0);let l=0,u=0,f=0,p=0;for(const g of this.shards.values())for(const m of g)if(m.primary)switch(m.state){case"STARTED":l++;break;case"RELOCATING":u++;break;case"INITIALIZING":f++;break;case"UNASSIGNED":p++;break}this.metrics.activeShards=l,this.metrics.relocatingShards=u,this.metrics.initializingShards=f,this.metrics.unassignedShards=p,this.metrics.clusterHealth=this.calculateClusterHealth();for(const g of this.indices.values())g.health=this.calculateIndexHealth(g.name);this.lastMetricsUpdate=e}}class AT{buckets=new Map;objects=new Map;versions=new Map;operations=[];metrics=new Map;lifecycleTransitions=new Map;initialize(e){if(this.buckets.clear(),this.objects.clear(),this.versions.clear(),this.operations=[],this.metrics.clear(),this.lifecycleTransitions.clear(),e.buckets)for(const t of e.buckets)this.buckets.set(t.name,{...t}),this.objects.set(t.name,new Map),t.versioning&&this.versions.set(t.name,new Map),this.metrics.set(t.name,{bucket:t.name,objectCount:0,totalSize:0,versionsCount:0,putCount:0,getCount:0,deleteCount:0,listCount:0,errorCount:0,averageLatency:0}),this.lifecycleTransitions.set(t.name,new Map)}putObject(e,t,n,o,i,l){const u=Date.now(),f=this.buckets.get(e);if(!f)return{success:!1,etag:"",latency:Date.now()-u,error:`Bucket '${e}' does not exist`};const p=this.generateETag(t,o),g=f.versioning?`${Date.now()}-${Math.random().toString(36).substr(2,9)}`:void 0,m={key:t,bucket:e,size:o,lastModified:Date.now(),storageClass:"STANDARD",etag:p,contentType:l||"application/octet-stream",metadata:i||{},versionId:g,encryption:f.encryption},y=this.objects.get(e);if(f.versioning&&g){const M=this.versions.get(e),A=M.get(t)||[];A.push({versionId:g,object:m,isDeleteMarker:!1}),M.set(t,A),this.versions.set(e,M);const T=this.metrics.get(e);T.versionsCount=this.getTotalVersionsCount(e)}y.set(t,m),this.objects.set(e,y);const x=this.findMatchingLifecycleRule(f,t);if(x&&x.transitions&&x.transitions.length>0){const M=this.lifecycleTransitions.get(e),A=x.transitions[0],T=Date.now()+A.days*24*60*60*1e3;M.set(t,{currentClass:"STANDARD",transitionScheduled:T,targetClass:A.storageClass,ruleId:x.id,transitionIndex:0,allTransitions:x.transitions}),this.lifecycleTransitions.set(e,M)}else if(f.lifecycleEnabled&&f.lifecycleDays){const M=this.lifecycleTransitions.get(e),A=Date.now()+f.lifecycleDays*24*60*60*1e3;M.set(t,{currentClass:"STANDARD",transitionScheduled:A,targetClass:f.glacierEnabled?"GLACIER":"STANDARD_IA"}),this.lifecycleTransitions.set(e,M)}const S=this.metrics.get(e),C=y.get(t);C?S.totalSize-=C.size:S.objectCount++,S.totalSize+=o,S.putCount++;const E=this.calculatePutLatency(o);return this.recordOperation("PUT",e,t,!0,E),this.updateMetrics(e,E,!0),{success:!0,versionId:g,etag:p,latency:E}}getObject(e,t,n){const o=Date.now(),i=this.buckets.get(e);if(!i)return{success:!1,latency:Date.now()-o,error:`Bucket '${e}' does not exist`};const l=this.objects.get(e);if(i.versioning&&n){const m=(this.versions.get(e).get(t)||[]).find(x=>x.versionId===n);if(!m||m.isDeleteMarker){const x=this.calculateGetLatency(0);return this.recordOperation("GET",e,t,!1,x),this.updateMetrics(e,x,!1),{success:!1,latency:x,error:m?.isDeleteMarker?"Object version is a delete marker":`Object version '${n}' not found`}}if(m.object.storageClass==="GLACIER"||m.object.storageClass==="DEEP_ARCHIVE"){const x=this.calculateGlacierRestoreLatency();return this.recordOperation("GET",e,t,!1,x),this.updateMetrics(e,x,!1),{success:!1,latency:x,error:`Object is archived in ${m.object.storageClass}. Restore operation required.`}}const y=this.calculateGetLatency(m.object.size);return this.recordOperation("GET",e,t,!0,y),this.updateMetrics(e,y,!0),{success:!0,object:m.object,latency:y}}const u=l.get(t);if(!u){const p=this.calculateGetLatency(0);return this.recordOperation("GET",e,t,!1,p),this.updateMetrics(e,p,!1),{success:!1,latency:p,error:`Object '${t}' not found`}}if(u.storageClass==="GLACIER"||u.storageClass==="DEEP_ARCHIVE"){const p=this.calculateGlacierRestoreLatency();return this.recordOperation("GET",e,t,!1,p),this.updateMetrics(e,p,!1),{success:!1,latency:p,error:`Object is archived in ${u.storageClass}. Restore operation required.`}}const f=this.calculateGetLatency(u.size);return this.recordOperation("GET",e,t,!0,f),this.updateMetrics(e,f,!0),{success:!0,object:u,latency:f}}deleteObject(e,t,n){const o=Date.now(),i=this.buckets.get(e);if(!i)return{success:!1,latency:Date.now()-o,error:`Bucket '${e}' does not exist`};const l=this.objects.get(e),u=l.get(t);if(!u){const m=this.calculateDeleteLatency();return this.recordOperation("DELETE",e,t,!1,m),this.updateMetrics(e,m,!1),{success:!1,latency:m,error:`Object '${t}' not found`}}if(i.versioning){const m=this.versions.get(e),y=m.get(t)||[],x=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;y.push({versionId:x,object:{...u},isDeleteMarker:!0}),m.set(t,y),this.versions.set(e,m),l.delete(t),this.objects.set(e,l);const S=this.metrics.get(e);S.versionsCount=this.getTotalVersionsCount(e),S.deleteCount++;const C=this.calculateDeleteLatency();return this.recordOperation("DELETE",e,t,!0,C),this.updateMetrics(e,C,!0),{success:!0,deleteMarker:!0,latency:C}}const f=u.size;l.delete(t),this.objects.set(e,l);const p=this.metrics.get(e);p.objectCount--,p.totalSize-=f,p.deleteCount++;const g=this.calculateDeleteLatency();return this.recordOperation("DELETE",e,t,!0,g),this.updateMetrics(e,g,!0),{success:!0,latency:g}}listObjects(e,t,n){const o=Date.now();if(!this.buckets.get(e))return{success:!1,objects:[],latency:Date.now()-o,error:`Bucket '${e}' does not exist`};const l=this.objects.get(e);let u=Array.from(l.values());t&&(u=u.filter(g=>g.key.startsWith(t))),u.sort((g,m)=>g.key.localeCompare(m.key)),n&&(u=u.slice(0,n));const f=this.calculateListLatency(u.length);this.recordOperation("LIST",e,void 0,!0,f);const p=this.metrics.get(e);return p.listCount++,this.updateMetrics(e,f,!0),{success:!0,objects:u,latency:f}}headObject(e,t){const n=Date.now();if(!this.buckets.get(e))return{success:!1,latency:Date.now()-n,error:`Bucket '${e}' does not exist`};const l=this.objects.get(e).get(t);if(!l){const f=this.calculateHeadLatency();return this.recordOperation("HEAD",e,t,!1,f),this.updateMetrics(e,f,!1),{success:!1,latency:f,error:`Object '${t}' not found`}}const u=this.calculateHeadLatency();return this.recordOperation("HEAD",e,t,!0,u),this.updateMetrics(e,u,!0),{success:!0,object:l,latency:u}}processLifecycleTransitions(e=Date.now()){for(const[t,n]of this.lifecycleTransitions.entries()){const o=this.buckets.get(t);if(!(o&&(o.lifecycleEnabled||o.lifecycleRules&&o.lifecycleRules.some(u=>u.status==="Enabled"))))continue;const l=this.objects.get(t);for(const[u,f]of n.entries())if(e>=f.transitionScheduled){const p=l.get(u);if(p&&p.storageClass===f.currentClass)if(p.storageClass=f.targetClass,l.set(u,p),this.objects.set(t,l),f.ruleId&&f.allTransitions&&f.transitionIndex!==void 0){const g=f.transitionIndex+1;if(g<f.allTransitions.length){const m=f.allTransitions[g],y=e+m.days*24*60*60*1e3;n.set(u,{currentClass:f.targetClass,transitionScheduled:y,targetClass:m.storageClass,ruleId:f.ruleId,transitionIndex:g,allTransitions:f.allTransitions})}else{const m=this.findLifecycleRuleById(o,f.ruleId);if(m?.expiration?.days){const y=e+m.expiration.days*24*60*60*1e3;n.set(u,{currentClass:f.targetClass,transitionScheduled:y,targetClass:f.targetClass,ruleId:f.ruleId,expiration:!0})}else n.delete(u)}}else if(o.glacierEnabled&&o.glacierDays&&f.targetClass==="STANDARD_IA"){const g=e+o.glacierDays*24*60*60*1e3;n.set(u,{currentClass:"STANDARD_IA",transitionScheduled:g,targetClass:"GLACIER"})}else n.delete(u);else p||n.delete(u)}this.lifecycleTransitions.set(t,n)}this.processExpirations(e)}processExpirations(e){for(const[t,n]of this.lifecycleTransitions.entries()){if(!this.buckets.get(t))continue;const i=this.objects.get(t),l=[];for(const[u,f]of n.entries())f.expiration&&e>=f.transitionScheduled&&i.has(u)&&l.push(u);for(const u of l){const f=i.get(u);if(f){const p=this.metrics.get(t);p&&(p.objectCount=Math.max(0,p.objectCount-1),p.totalSize=Math.max(0,p.totalSize-f.size))}i.delete(u),n.delete(u)}this.objects.set(t,i),this.lifecycleTransitions.set(t,n)}}findMatchingLifecycleRule(e,t){return!e.lifecycleRules||e.lifecycleRules.length===0?void 0:e.lifecycleRules.filter(o=>o.status==="Enabled").filter(o=>!o.prefix||t.startsWith(o.prefix)).sort((o,i)=>{const l=o.prefix||"";return(i.prefix||"").length-l.length})[0]}findLifecycleRuleById(e,t){if(e.lifecycleRules)return e.lifecycleRules.find(n=>n.id===t)}findLifecycleRuleById(e,t){if(e.lifecycleRules)return e.lifecycleRules.find(n=>n.id===t)}getBucketMetrics(e){return this.metrics.get(e)}getAllBucketMetrics(){return new Map(this.metrics)}getTotalStorageSize(){let e=0;for(const t of this.metrics.values())e+=t.totalSize;return e}getTotalObjectCount(){let e=0;for(const t of this.metrics.values())e+=t.objectCount;return e}generateETag(e,t){const n=`${e}_${t}_${Date.now()}`;let o=0;for(let i=0;i<n.length;i++){const l=n.charCodeAt(i);o=(o<<5)-o+l,o=o&o}return Math.abs(o).toString(16)}calculatePutLatency(e){const n=e/1024*.1,o=(Math.random()-.5)*10;return Math.max(10,50+n+o)}calculateGetLatency(e){const n=e/1024*.15,o=(Math.random()-.5)*10;return Math.max(10,30+n+o)}calculateDeleteLatency(){const t=(Math.random()-.5)*5;return Math.max(5,20+t)}calculateListLatency(e){const n=e*.01,o=(Math.random()-.5)*10;return Math.max(20,40+n+o)}calculateHeadLatency(){const t=(Math.random()-.5)*5;return Math.max(5,15+t)}calculateGlacierRestoreLatency(){return 5e3}recordOperation(e,t,n,o,i){this.operations.push({operation:e,bucket:t,key:n,success:o,latency:i,timestamp:Date.now()}),this.operations.length>1e3&&this.operations.shift()}updateMetrics(e,t,n){const o=this.metrics.get(e);if(!o)return;const i=o.putCount+o.getCount+o.deleteCount+o.listCount;i>0?o.averageLatency=(o.averageLatency*(i-1)+t)/i:o.averageLatency=t,n||o.errorCount++,o.lastOperation=Date.now()}getTotalVersionsCount(e){const t=this.versions.get(e);if(!t)return 0;let n=0;for(const o of t.values())n+=o.length;return n}}class NT{connections=new Map;config;connectionCounter=0;queryHistory=[];MAX_HISTORY=1e3;constructor(e){this.config={maxConnections:e.maxConnections||100,minConnections:e.minConnections||0,idleTimeout:e.idleTimeout||3e5,maxLifetime:e.maxLifetime||36e5,connectionTimeout:e.connectionTimeout||5e3}}acquireConnection(e){const t=Date.now();this.cleanupIdleConnections(t);for(const[n,o]of this.connections.entries())if(o.status==="idle")return o.status="active",o.lastActivity=t,o.currentQuery=e,o.queryCount++,n;return this.connections.size<this.config.maxConnections?this.createConnection(e,t):null}releaseConnection(e,t){const n=this.connections.get(e);n&&(n.status="idle",n.lastActivity=Date.now(),n.currentQuery=void 0,t!==void 0&&this.recordQuery(t))}terminateConnection(e){const t=this.connections.get(e);t&&(t.status="terminated",this.connections.delete(e))}createConnection(e,t){const n=`conn_${++this.connectionCounter}_${t}`,o={id:n,status:"active",createdAt:t,lastActivity:t,queryCount:1,currentQuery:e};return this.connections.set(n,o),n}cleanupIdleConnections(e){const t=[];for(const[n,o]of this.connections.entries())o.status==="idle"&&(e-o.lastActivity>this.config.idleTimeout||e-o.createdAt>this.config.maxLifetime)&&t.push(n);for(const n of t)this.connections.delete(n)}recordQuery(e){const t=Date.now();this.queryHistory.push({timestamp:t,duration:e}),this.queryHistory.length>this.MAX_HISTORY&&this.queryHistory.shift()}getMetrics(){const e=Date.now();let t=0,n=0,o=0;for(const y of this.connections.values())switch(y.status){case"active":t++;break;case"idle":n++;break;case"waiting":o++;break}const i=this.connections.size,l=i>0?t/this.config.maxConnections:0,u=this.queryHistory.filter(y=>e-y.timestamp<6e4),f=u.length>0?u.reduce((y,x)=>y+x.duration,0)/u.length:0,g=this.queryHistory.filter(y=>e-y.timestamp<1e3).length,m=i>=this.config.maxConnections?this.config.connectionTimeout/2:0;return{totalConnections:i,activeConnections:t,idleConnections:n,waitingConnections:o,utilization:l,averageQueryTime:f,queriesPerSecond:g,connectionWaitTime:m}}getConnection(e){return this.connections.get(e)}getAllConnections(){return Array.from(this.connections.values())}updateConfig(e){if(this.config={...this.config,...e},e.maxConnections!==void 0&&e.maxConnections<this.connections.size){const t=this.connections.size-e.maxConnections,n=Array.from(this.connections.entries()).filter(([o,i])=>i.status==="idle").slice(0,t);for(const[o]of n)this.terminateConnection(o)}}reset(){this.connections.clear(),this.connectionCounter=0,this.queryHistory=[]}}class kT{static exportMetrics(e,t){const n=[],o=this.buildLabels(e,t),i=t.timestamp||Date.now();if(n.push("# HELP component_throughput_total Component throughput in operations per second"),n.push("# TYPE component_throughput_total gauge"),n.push(`component_throughput_total{${o}} ${t.throughput||0} ${i}`),n.push("# HELP component_latency_ms Component latency in milliseconds"),n.push("# TYPE component_latency_ms gauge"),n.push(`component_latency_ms{${o}} ${t.latency||0} ${i}`),t.latencyP50!==void 0&&(n.push("# HELP component_latency_p50_ms Component 50th percentile latency in milliseconds"),n.push("# TYPE component_latency_p50_ms gauge"),n.push(`component_latency_p50_ms{${o}} ${t.latencyP50} ${i}`)),t.latencyP99!==void 0&&(n.push("# HELP component_latency_p99_ms Component 99th percentile latency in milliseconds"),n.push("# TYPE component_latency_p99_ms gauge"),n.push(`component_latency_p99_ms{${o}} ${t.latencyP99} ${i}`)),n.push("# HELP component_error_rate Component error rate (0-1)"),n.push("# TYPE component_error_rate gauge"),n.push(`component_error_rate{${o}} ${t.errorRate||0} ${i}`),n.push("# HELP component_utilization Component utilization (0-1)"),n.push("# TYPE component_utilization gauge"),n.push(`component_utilization{${o}} ${t.utilization||0} ${i}`),t.customMetrics)for(const[l,u]of Object.entries(t.customMetrics)){const f=this.sanitizeMetricName(l);n.push(`# HELP component_${f} Component custom metric: ${l}`),n.push(`# TYPE component_${f} gauge`),n.push(`component_${f}{${o}} ${u} ${i}`)}return n.join(`
`)+`
`}static buildLabels(e,t){const n=[];n.push(`component_id="${this.escapeLabelValue(e.id)}"`),n.push(`component_type="${this.escapeLabelValue(e.type)}"`),e.data.label&&n.push(`component_name="${this.escapeLabelValue(e.data.label)}"`);const o=e.data.config||{};return o.environment&&n.push(`environment="${this.escapeLabelValue(String(o.environment))}"`),o.namespace&&n.push(`namespace="${this.escapeLabelValue(String(o.namespace))}"`),n.join(",")}static escapeLabelValue(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n")}static sanitizeMetricName(e){return e.replace(/[^a-zA-Z0-9_:]/g,"_").replace(/^[^a-zA-Z]/,"_")}static exportAllMetrics(e,t){const n=[];for(const o of e){const i=t.get(o.id);i&&n.push(this.exportMetrics(o,i))}return n.join(`
`)}static exportEndpointMetrics(e,t){return t?this.exportMetrics(e,t):""}}class DT{config=null;targetStatuses=new Map;scrapedMetrics=new Map;lastScrapeTimes=new Map;prometheusMetrics={scrapeRequestsTotal:0,scrapeErrorsTotal:0,scrapeDurationTotal:0,targetsUp:0,targetsDown:0,samplesScraped:0};initializeConfig(e){const t=e.data.config||{};this.config={global:{scrape_interval:t.scrapeInterval||"15s",evaluation_interval:t.evaluationInterval||"15s",external_labels:{prometheus:"archiphoenix"}},scrape_configs:this.buildScrapeConfigs(t),alerting:t.enableAlertmanager?{alertmanagers:[{static_configs:[{targets:[t.alertmanagerUrl||"http://alertmanager:9093"].map(n=>{const o=n.match(/^https?:\/\/([^\/]+)/);return o?o[1]:n})}]}]}:void 0,remote_write:t.enableRemoteWrite&&t.remoteWrite?t.remoteWrite.map(n=>({url:n.url})):void 0},this.initializeTargetStatuses()}buildScrapeConfigs(e){if(e.scrape_configs&&Array.isArray(e.scrape_configs))return e.scrape_configs.map(o=>({job_name:o.job_name,scrape_interval:o.scrape_interval,scrape_timeout:o.scrape_timeout,metrics_path:o.metrics_path,static_configs:o.static_configs||[]}));const t=[],n=e.scrapeInterval||"15s";if(e.targets&&Array.isArray(e.targets)){const o=new Map;for(const i of e.targets){const l=i.job||"default";o.has(l)||o.set(l,[]),o.get(l).push(i)}for(const[i,l]of o.entries()){const u=l[0],f=u.interval||n,p=u.metricsPath||"/metrics",g=l.map(m=>{try{const y=new URL(m.endpoint);return`${y.hostname}${y.port?":"+y.port:""}`}catch{const y=m.endpoint.match(/^https?:\/\/([^\/]+)/);return y?y[1]:m.endpoint}});t.push({job_name:i,scrape_interval:f,metrics_path:p,static_configs:[{targets:g,labels:u.labels||{}}]})}}return t}initializeTargetStatuses(){if(this.targetStatuses.clear(),!!this.config){for(const e of this.config.scrape_configs)if(e.static_configs)for(const t of e.static_configs)for(const n of t.targets){const o=e.metrics_path?`http://${n}${e.metrics_path}`:`http://${n}/metrics`,i=`${e.job_name}:${n}`;this.targetStatuses.set(i,{job:e.job_name,endpoint:o,lastScrape:0,lastSuccess:null,lastError:null,scrapeDuration:null,up:!1,labels:t.labels})}}}performScraping(e,t,n){if(this.config){this.parseDuration(this.config.global.scrape_interval||"15s"),this.prometheusMetrics.targetsUp=0,this.prometheusMetrics.targetsDown=0;for(const[o,i]of this.targetStatuses.entries()){const l=this.lastScrapeTimes.get(o)||0,u=this.getScrapeIntervalForTarget(i.job),f=this.parseDuration(u);e-l>=f&&(this.scrapeTarget(o,i,e,t,n),this.lastScrapeTimes.set(o,e)),i.up?this.prometheusMetrics.targetsUp++:this.prometheusMetrics.targetsDown++}}}scrapeTarget(e,t,n,o,i){const l=performance.now();this.prometheusMetrics.scrapeRequestsTotal++;try{const u=this.findNodeByEndpoint(t.endpoint,o);if(!u)throw new Error(`Target not found: ${t.endpoint}`);const f=i.get(u.id);if(!f)throw new Error(`Metrics not available for component: ${u.id}`);const p=kT.exportMetrics(u,f);t.lastScrape=n,t.lastSuccess=n,t.lastError=null,t.up=!0;const g=performance.now()-l;t.scrapeDuration=g,this.prometheusMetrics.scrapeDurationTotal+=g,this.prometheusMetrics.samplesScraped+=this.countSamples(p),this.scrapedMetrics.set(e,f)}catch(u){const f=performance.now()-l;t.lastScrape=n,t.lastSuccess=null,t.lastError=u instanceof Error?u.message:String(u),t.up=!1,t.scrapeDuration=f,this.prometheusMetrics.scrapeErrorsTotal++}}findNodeByEndpoint(e,t){try{const n=new URL(e),o=n.hostname,i=n.port?parseInt(n.port):null;for(const l of t){const u=l.data.config||{},f=u.port||u.metricsPort||u.metrics?.port;if(l.data.label?.toLowerCase().replace(/\s+/g,"-")===o||i&&f===i)return l}}catch{}return null}getScrapeIntervalForTarget(e){return this.config&&(this.config.scrape_configs.find(n=>n.job_name===e)?.scrape_interval||this.config.global.scrape_interval)||"15s"}parseDuration(e){const t=e.match(/^(\d+)([smhd])$/);if(!t)return 15e3;const n=parseInt(t[1]);switch(t[2]){case"s":return n*1e3;case"m":return n*60*1e3;case"h":return n*60*60*1e3;case"d":return n*24*60*60*1e3;default:return 15e3}}countSamples(e){return e.split(`
`).filter(t=>t.trim()&&!t.startsWith("#")).length}getTargetStatuses(){return Array.from(this.targetStatuses.values())}getPrometheusMetrics(){return{...this.prometheusMetrics}}calculateLoad(){const e=this.prometheusMetrics.scrapeRequestsTotal,t=this.prometheusMetrics.scrapeErrorsTotal,n=this.prometheusMetrics.scrapeDurationTotal,o=this.prometheusMetrics.samplesScraped,i=this.targetStatuses.size,l=this.parseDuration(this.config?.global.scrape_interval||"15s"),u=i>0?1e3/l*i:0,f=e>0?n/e:0,p=e>0?t/e:0,g=u*(o/e||0);return{scrapeRequestsPerSecond:u,averageScrapeDuration:f,errorRate:p,samplesPerSecond:g}}}class jT{config=null;lastRefreshTimes=new Map;lastAlertEvaluationTimes=new Map;grafanaMetrics={queriesPerSecond:0,dashboardRefreshesPerSecond:0,alertEvaluationsPerSecond:0,datasourceErrors:0,activeDashboards:0,activePanels:0,totalQueries:0,cachedQueries:0,queryLatency:0,renderingLatency:0};queryLatencyHistory=[];MAX_LATENCY_HISTORY=100;initializeConfig(e){const t=e.data.config||{};this.config=t,this.initializeRefreshTimes(),this.initializeAlertEvaluationTimes()}initializeRefreshTimes(){if(this.lastRefreshTimes.clear(),!this.config?.dashboards)return;const e=this.normalizeDashboards(this.config.dashboards);for(const t of e)this.lastRefreshTimes.set(t.id,0)}initializeAlertEvaluationTimes(){if(this.lastAlertEvaluationTimes.clear(),!(!this.config?.alerts||!this.config.enableAlerting))for(const e of this.config.alerts)this.lastAlertEvaluationTimes.set(e.id,0)}normalizeDashboards(e){return!e||!Array.isArray(e)?[]:e.map(t=>{if(t&&typeof t=="object"){if(typeof t.panels=="number")return{id:t.id||String(Date.now()),name:t.name||"Dashboard",panels:[],tags:Array.isArray(t.tags)?t.tags:[],refresh:t.refresh||"30s"};if(Array.isArray(t.panels))return{id:t.id||String(Date.now()),name:t.name||"Dashboard",panels:t.panels.map(n=>({id:n.id||`panel-${Date.now()}`,title:n.title||"Panel",type:n.type||"graph",datasource:n.datasource||"Prometheus",queries:Array.isArray(n.queries)?n.queries:[{refId:"A",expr:"up"}],gridPos:n.gridPos||{x:0,y:0,w:12,h:8}})),tags:Array.isArray(t.tags)?t.tags:[],variables:t.variables,refresh:t.refresh||"30s",timeRange:t.timeRange}}return t}).filter(t=>t&&typeof t=="object"&&t.id)}performUpdate(e,t=!0,n){this.config&&(this.updateDashboards(e,t,n),this.config.enableAlerting&&this.evaluateAlerts(e,t),this.updateMetrics())}updateDashboards(e,t,n){if(!this.config?.dashboards)return;const o=this.normalizeDashboards(this.config.dashboards);let i=0,l=0;for(const u of o){const f=this.parseDuration(u.refresh||"30s"),p=this.lastRefreshTimes.get(u.id)||0;if(e-p>=f){this.lastRefreshTimes.set(u.id,e);for(const g of u.panels){const m=g.datasource,y=m&&this.isLokiDatasource(m);for(const C of g.queries){i++;const E=this.simulateQueryExecution(C,t,y,n);l+=E,this.queryLatencyHistory.push(E),this.queryLatencyHistory.length>this.MAX_LATENCY_HISTORY&&this.queryLatencyHistory.shift()}const x=this.simulatePanelRendering(g),S=this.grafanaMetrics.renderingLatency;this.grafanaMetrics.renderingLatency=S*.9+x*.1}}}this.grafanaMetrics.totalQueries+=i,i>0&&(this.grafanaMetrics.queryLatency=l/i)}isLokiDatasource(e){if(!this.config?.datasources)return!1;const n=(Array.isArray(this.config.datasources)?this.config.datasources:[]).find(o=>typeof o=="string"?o===e:o.name===e);return typeof n=="object"&&n.type?n.type==="loki":!1}evaluateAlerts(e,t){if(this.config?.alerts)for(const n of this.config.alerts){const o=this.parseDuration(n.for||"1m"),i=this.lastAlertEvaluationTimes.get(n.id)||0;e-i>=o&&(this.lastAlertEvaluationTimes.set(n.id,e),this.simulateQueryExecution({refId:"A",expr:n.condition.query},t),t||this.grafanaMetrics.datasourceErrors++)}}simulateQueryExecution(e,t,n=!1,o){if(n&&o)try{const f=Date.now()-36e5,p=Date.now(),g=o(e.expr,f,p,100);return g.success||this.grafanaMetrics.datasourceErrors++,g.latency}catch{return this.grafanaMetrics.datasourceErrors++,1e3}if(!t)return this.grafanaMetrics.datasourceErrors++,1e3;let i=50;const l=this.estimateQueryComplexity(e.expr);i+=l*10;const u=(Math.random()-.5)*20;return Math.max(10,i+u)}estimateQueryComplexity(e){if(!e)return 0;let t=1;e.includes("[")&&(t+=2);const n=["sum","avg","max","min","count","rate","irate","increase"];for(const i of n)e.toLowerCase().includes(i)&&(t+=1);const o=(e.match(/\|/g)||[]).length;return t+=o,t}simulatePanelRendering(e){const n={stat:5,gauge:10,piechart:15,bargraph:20,table:25,graph:30}[e.type]||20,o=Math.sqrt(e.queries.length);return n*o}updateMetrics(){if(!this.config)return;const e=this.normalizeDashboards(this.config.dashboards);this.grafanaMetrics.activeDashboards=e.length,this.grafanaMetrics.activePanels=e.reduce((o,i)=>o+i.panels.length,0);let t=0,n=0;for(const o of e){const l=1e3/this.parseDuration(o.refresh||"30s");n+=l;const u=o.panels.reduce((f,p)=>f+p.queries.length,0);t+=l*u}if(this.grafanaMetrics.queriesPerSecond=t,this.grafanaMetrics.dashboardRefreshesPerSecond=n,this.config.enableAlerting&&this.config.alerts){let o=0;for(const i of this.config.alerts){const u=1e3/this.parseDuration(i.for||"1m");o+=u}this.grafanaMetrics.alertEvaluationsPerSecond=o}else this.grafanaMetrics.alertEvaluationsPerSecond=0;if(this.queryLatencyHistory.length>0){const o=this.queryLatencyHistory.reduce((i,l)=>i+l,0)/this.queryLatencyHistory.length;this.grafanaMetrics.queryLatency=o}}parseDuration(e){const t=e.match(/^(\d+)([smhd])$/);if(!t)return 3e4;const n=parseInt(t[1]);switch(t[2]){case"s":return n*1e3;case"m":return n*60*1e3;case"h":return n*60*60*1e3;case"d":return n*24*60*60*1e3;default:return 3e4}}getGrafanaMetrics(){return{...this.grafanaMetrics}}calculateLoad(){const e=this.grafanaMetrics,t=.1,n=Math.min(.7,e.queriesPerSecond/100),o=Math.min(.1,e.alertEvaluationsPerSecond/10),i=Math.min(.1,e.activePanels/100),l=Math.min(.95,t+n+o+i),u=.2,f=Math.min(.4,e.activeDashboards/50),p=Math.min(.3,e.cachedQueries/1e3),g=Math.min(.95,u+f+p),m=e.totalQueries+e.alertEvaluationsPerSecond,y=m>0?e.datasourceErrors/m:0;return{queriesPerSecond:e.queriesPerSecond,dashboardRefreshesPerSecond:e.dashboardRefreshesPerSecond,alertEvaluationsPerSecond:e.alertEvaluationsPerSecond,averageQueryLatency:e.queryLatency,averageRenderingLatency:e.renderingLatency,errorRate:y,cpuUtilization:l,memoryUtilization:g}}getActiveDatasources(){return this.config?.datasources?this.config.datasources.length>0&&typeof this.config.datasources[0]=="string"?this.config.datasources.map(e=>({name:e,type:"prometheus",url:"http://localhost:9090",access:"proxy",isDefault:e===this.config.datasources[0]})):this.config.datasources.filter(e=>e&&typeof e=="object"&&e.name):[]}isPrometheusAvailable(e){return!(!e||!this.getActiveDatasources().find(o=>o.type==="prometheus"))}}class _T{config=null;streams=new Map;queryStatuses=new Map;lastIngestionTimes=new Map;lokiMetrics={ingestionRequestsTotal:0,ingestionErrorsTotal:0,ingestionLinesTotal:0,ingestionBytesTotal:0,queryRequestsTotal:0,queryErrorsTotal:0,queryDurationTotal:0,activeStreams:0,totalStorageSize:0,retentionDeletions:0};ingestionLatencyHistory=[];queryLatencyHistory=[];MAX_LATENCY_HISTORY=100;initializeConfig(e){const t=e.data.config||{};this.config={serverUrl:t.serverUrl||"http://loki:3100",retentionPeriod:t.retentionPeriod||"168h",maxStreams:t.maxStreams||1e4,maxLineSize:t.maxLineSize||256e3,enableCompression:t.enableCompression??!0,compressionType:t.compressionType||"gzip",enableAuth:t.enableAuth??!1,enableMultiTenancy:t.enableMultiTenancy??!1,tenants:t.tenants||[],ingestionRateLimit:t.ingestionRateLimit,queryRateLimit:t.queryRateLimit},this.initializeStreamsFromConfig(t),this.initializeQueriesFromConfig(t)}initializeStreamsFromConfig(e){if(e.streams&&Array.isArray(e.streams))for(const t of e.streams){const n=this.getStreamKey(t.labels||{}),o=[];if(t.entries&&Array.isArray(t.entries))for(const l of t.entries)o.push({timestamp:l.timestamp||Date.now().toString()+"000000",line:l.line||""});const i=t.size?t.size*1024*1024*1024:0;this.streams.set(n,{labels:t.labels||{},entries:o,size:i,lastEntryTime:Date.now()})}}initializeQueriesFromConfig(e){if(e.queries&&Array.isArray(e.queries))for(const t of e.queries){const n=t.id||`query-${Date.now()}-${Math.random()}`;this.queryStatuses.set(n,{id:n,query:t.query||"",lastExecution:0,lastSuccess:null,lastError:null,executionDuration:null,resultsCount:t.results||0,success:!0})}}processIngestion(e,t){if(!this.config)return{success:!1,error:"Loki not configured",ingestedLines:0,ingestedBytes:0};const n=performance.now();this.lokiMetrics.ingestionRequestsTotal++;try{if(this.config.ingestionRateLimit){const u=t||"default",f=this.lastIngestionTimes.get(u)||0,p=Date.now();p-f<1e3,this.lastIngestionTimes.set(u,p)}let o=0,i=0;for(const u of e){const f=this.getStreamKey(u.stream);if(!this.streams.has(f)&&this.streams.size>=(this.config.maxStreams||1e4)){this.lokiMetrics.ingestionErrorsTotal++;continue}let p=this.streams.get(f);p||(p={labels:u.stream,entries:[],size:0,lastEntryTime:Date.now()},this.streams.set(f,p));for(const[g,m]of u.values){const y=new Blob([m]).size;if(y>(this.config.maxLineSize||256e3)){this.lokiMetrics.ingestionErrorsTotal++;continue}p.entries.push({timestamp:g,line:m}),p.size+=y,p.lastEntryTime=Math.max(p.lastEntryTime,this.parseTimestamp(g)),o++,i+=y}if(this.config.enableCompression){const g=this.getCompressionRatio(this.config.compressionType||"gzip");p.size=Math.floor(p.size*g)}}this.lokiMetrics.ingestionLinesTotal+=o,this.lokiMetrics.ingestionBytesTotal+=i,this.lokiMetrics.totalStorageSize+=i,this.lokiMetrics.activeStreams=this.streams.size;const l=performance.now()-n;return this.ingestionLatencyHistory.push(l),this.ingestionLatencyHistory.length>this.MAX_LATENCY_HISTORY&&this.ingestionLatencyHistory.shift(),{success:!0,ingestedLines:o,ingestedBytes:i}}catch(o){return performance.now()-n,this.lokiMetrics.ingestionErrorsTotal++,{success:!1,error:o instanceof Error?o.message:String(o),ingestedLines:0,ingestedBytes:0}}}executeQuery(e,t,n,o){if(!this.config)return{success:!1,error:"Loki not configured",latency:0,resultsCount:0};const i=performance.now();this.lokiMetrics.queryRequestsTotal++;try{this.config.queryRateLimit;const l=this.parseLogQL(e),u=this.executeLogQLQuery(l,t,n,o),f=performance.now()-i;return this.lokiMetrics.queryDurationTotal+=f,this.queryLatencyHistory.push(f),this.queryLatencyHistory.length>this.MAX_LATENCY_HISTORY&&this.queryLatencyHistory.shift(),{success:!0,result:u,latency:f,resultsCount:u.reduce((p,g)=>p+g.values.length,0)}}catch(l){const u=performance.now()-i;return this.lokiMetrics.queryErrorsTotal++,{success:!1,error:l instanceof Error?l.message:String(l),latency:u,resultsCount:0}}}parseLogQL(e){const t={},n=[],o=[],i=e.match(/^\{([^}]+)\}/);if(i){const x=i[1].matchAll(/(\w+)=["']([^"']+)["']/g);for(const S of x)t[S[1]]=S[2]}const l=e.match(/\|\s*=\s*["']([^"']+)["']/);l&&n.push({type:"contains",pattern:l[1]});const u=e.match(/!\s*=\s*["']([^"']+)["']/);u&&n.push({type:"not_contains",pattern:u[1]});const f=e.match(/\|\s*~\s*["']([^"']+)["']/);f&&n.push({type:"regex",pattern:f[1]});const p=e.matchAll(/\|\s*(\w+)\s*(=|=~|!=|!~)\s*["']([^"']+)["']/g);for(const y of p)o.push({label:y[1],operator:y[2],value:y[3]});let g;const m=e.match(/\|\s*(\w+)\(([^)]*)\)/);return m&&(g={function:m[1],params:m[2]?m[2].split(",").map(y=>y.trim()):[]}),{streamSelector:t,lineFilters:n,labelFilters:o,aggregation:g}}executeLogQLQuery(e,t,n,o){const i=[],l=Date.now(),u=t||l-36e5,f=n||l;for(const[p,g]of this.streams.entries()){let m=!0;for(const[S,C]of Object.entries(e.streamSelector))if(g.labels[S]!==C){m=!1;break}if(!m)continue;let x=g.entries.filter(S=>{const C=this.parseTimestamp(S.timestamp);return C>=u&&C<=f});for(const S of e.lineFilters)x=x.filter(C=>{switch(S.type){case"contains":return C.line.includes(S.pattern);case"not_contains":return!C.line.includes(S.pattern);case"regex":try{return new RegExp(S.pattern).test(C.line)}catch{return!1}}});for(const S of e.labelFilters){const C=g.labels[S.label];if(C===void 0){x=[];break}switch(S.operator){case"=":C!==S.value&&(x=[]);break;case"!=":C===S.value&&(x=[]);break;case"=~":try{new RegExp(S.value).test(C)||(x=[])}catch{x=[]}break;case"!~":try{new RegExp(S.value).test(C)&&(x=[])}catch{}break}}if(o&&x.length>o&&(x=x.slice(0,o)),e.aggregation){const S=this.applyAggregation(e.aggregation,x);i.push({stream:g.labels,values:[[Date.now().toString()+"000000",S.toString()]]})}else x.length>0&&i.push({stream:g.labels,values:x.map(S=>[S.timestamp,S.line])})}return i}applyAggregation(e,t){switch(e.function.toLowerCase()){case"rate":if(t.length<2)return 0;const n=this.parseTimestamp(t[0].timestamp),i=(this.parseTimestamp(t[t.length-1].timestamp)-n)/1e3;return i>0?t.length/i:0;case"count_over_time":return t.length;case"sum":return t.reduce((u,f)=>{const p=parseFloat(f.line);return u+(isNaN(p)?0:p)},0);case"avg":case"average":const l=t.map(u=>parseFloat(u.line)).filter(u=>!isNaN(u));return l.length>0?l.reduce((u,f)=>u+f,0)/l.length:0;default:return t.length}}performRetention(e){if(!this.config)return;const t=this.parseDuration(this.config.retentionPeriod||"168h"),n=e-t;let o=0,i=0;for(const[l,u]of this.streams.entries()){const f=u.entries.length;u.entries=u.entries.filter(p=>this.parseTimestamp(p.timestamp)>n),u.entries.length<f&&(o+=f-u.entries.length,u.size=u.entries.reduce((p,g)=>p+new Blob([g.line]).size,0),i+=u.size),u.entries.length===0&&this.streams.delete(l)}this.lokiMetrics.retentionDeletions+=o,this.lokiMetrics.totalStorageSize=Math.max(0,this.lokiMetrics.totalStorageSize-i),this.lokiMetrics.activeStreams=this.streams.size}getStreams(){return Array.from(this.streams.values())}getLokiMetrics(){return{...this.lokiMetrics}}calculateLoad(){const e=this.lokiMetrics.ingestionRequestsTotal,t=this.lokiMetrics.ingestionErrorsTotal,n=this.lokiMetrics.ingestionLinesTotal,o=this.lokiMetrics.ingestionBytesTotal,i=this.lokiMetrics.queryRequestsTotal,l=this.lokiMetrics.queryErrorsTotal,u=this.lokiMetrics.queryDurationTotal,f=this.ingestionLatencyHistory.length>0?this.ingestionLatencyHistory.reduce((M,A)=>M+A,0)/this.ingestionLatencyHistory.length:0,p=this.queryLatencyHistory.length>0?this.queryLatencyHistory.reduce((M,A)=>M+A,0)/this.queryLatencyHistory.length:i>0?u/i:0,g=e>0?t/e:0,m=i>0?l/i:0,y=n>0?n/100:0,x=o>0?o/100:0,S=i>0?i/100:0,C=(this.config?.maxStreams||1e4)*100*1024*1024,E=Math.min(1,this.lokiMetrics.totalStorageSize/C);return{ingestionLinesPerSecond:y,ingestionBytesPerSecond:x,averageIngestionLatency:f,ingestionErrorRate:g,queriesPerSecond:S,averageQueryLatency:p,queryErrorRate:m,storageUtilization:E,streamCount:this.streams.size}}getStreamKey(e){return Object.keys(e).sort().map(n=>`${n}=${e[n]}`).join(",")}parseTimestamp(e){const t=BigInt(e);return Number(t/BigInt(1e6))}parseDuration(e){const t=e.match(/^(\d+)([smhd])$/);if(!t)return 10080*60*1e3;const n=parseInt(t[1]);switch(t[2]){case"s":return n*1e3;case"m":return n*60*1e3;case"h":return n*60*60*1e3;case"d":return n*24*60*60*1e3;default:return 10080*60*1e3}}getCompressionRatio(e){switch(e){case"gzip":return .3;case"snappy":return .5;case"lz4":return .4;default:return .3}}}class zT{config=null;traces=new Map;serviceStats=new Map;jaegerMetrics={spansReceivedTotal:0,spansDroppedTotal:0,spansProcessedTotal:0,samplingDecisionsTotal:0,samplingErrorsTotal:0,tracesStoredTotal:0,tracesDroppedTotal:0,storageSizeBytes:0,queryRequestsTotal:0,queryErrorsTotal:0,queryDurationTotal:0,spansSentTotal:0,spansFailedTotal:0};samplingState={};queryHistory=[];MAX_QUERY_HISTORY=100;lastCleanupTime=0;CLEANUP_INTERVAL=6e4;initializeConfig(e){const t=e.data.config||{};this.config={serverUrl:t.serverUrl||"http://jaeger:16686",agentEndpoint:t.agentEndpoint||"http://jaeger-agent:6831",collectorEndpoint:t.collectorEndpoint||"http://jaeger-collector:14268",queryEndpoint:t.queryEndpoint||"http://jaeger-query:16686",samplingType:t.samplingType||"probabilistic",samplingParam:t.samplingParam??.001,storageBackend:t.storageBackend||"elasticsearch",storageUrl:t.storageUrl||"http://elasticsearch:9200",enableUIGraphQL:t.enableUIGraphQL??!0,enableMetrics:t.enableMetrics??!0,metricsBackend:t.metricsBackend||"prometheus",metricsUrl:t.metricsUrl||"http://prometheus:9090",maxTraces:t.maxTraces||1e4,traceTTL:t.traceTTL||864e5},this.initializeSampling()}initializeSampling(){if(!this.config)return;const{samplingType:e,samplingParam:t}=this.config;switch(e){case"probabilistic":this.samplingState.probabilistic={probability:Math.max(0,Math.min(1,t||.001))};break;case"ratelimiting":this.samplingState.rateLimiting={maxTracesPerSecond:Math.max(1,t||10),bucket:{tokens:t||10,lastRefill:Date.now()}};break;case"peroperation":this.samplingState.perOperation=new Map;break}}receiveSpan(e){if(!this.config)return{sample:!1};this.jaegerMetrics.spansReceivedTotal++;const t=this.makeSamplingDecision(e);return this.jaegerMetrics.samplingDecisionsTotal++,t.sample?(this.processSpan(e),t):(this.jaegerMetrics.spansDroppedTotal++,t)}receiveSpansFromDataFlow(e){for(const t of e)this.receiveSpan(t)}makeSamplingDecision(e){if(!this.config)return{sample:!1};const{samplingType:t}=this.config;try{switch(t){case"probabilistic":return this.probabilisticSampling(e);case"ratelimiting":return this.rateLimitingSampling(e);case"peroperation":return this.perOperationSampling(e);default:return{sample:!0}}}catch{return this.jaegerMetrics.samplingErrorsTotal++,{sample:!1}}}probabilisticSampling(e){const t=this.samplingState.probabilistic;if(!t)return{sample:!0};const n=Math.random()<t.probability;return{sample:n,tags:n?[{key:"sampler.type",value:"probabilistic"},{key:"sampler.param",value:t.probability.toString()}]:void 0}}rateLimitingSampling(e){const t=this.samplingState.rateLimiting;if(!t)return{sample:!0};const n=Date.now(),o=n-t.bucket.lastRefill,i=1e3/t.maxTracesPerSecond,l=Math.floor(o/i);return l>0&&(t.bucket.tokens=Math.min(t.maxTracesPerSecond,t.bucket.tokens+l),t.bucket.lastRefill=n),t.bucket.tokens>0?(t.bucket.tokens--,{sample:!0,tags:[{key:"sampler.type",value:"ratelimiting"},{key:"sampler.param",value:t.maxTracesPerSecond.toString()}]}):{sample:!1}}perOperationSampling(e){this.samplingState.perOperation||(this.samplingState.perOperation=new Map);const t=`${e.serviceName}:${e.operationName}`;let n=this.samplingState.perOperation.get(t);if(!n){const f=this.config?.samplingParam||10;n={maxTracesPerSecond:f,bucket:{tokens:f,lastRefill:Date.now()}},this.samplingState.perOperation.set(t,n)}const o=Date.now(),i=o-n.bucket.lastRefill,l=1e3/n.maxTracesPerSecond,u=Math.floor(i/l);return u>0&&(n.bucket.tokens=Math.min(n.maxTracesPerSecond,n.bucket.tokens+u),n.bucket.lastRefill=o),n.bucket.tokens>0?(n.bucket.tokens--,{sample:!0,tags:[{key:"sampler.type",value:"peroperation"},{key:"sampler.param",value:n.maxTracesPerSecond.toString()}]}):{sample:!1}}processSpan(e){this.jaegerMetrics.spansProcessedTotal++;let t=this.traces.get(e.traceId);t||(t={traceId:e.traceId,spans:[],startTime:e.startTime,duration:e.duration,serviceCount:0,spanCount:0,hasErrors:!1},this.traces.set(e.traceId,t),this.jaegerMetrics.tracesStoredTotal++),t.spans.push(e),t.spanCount=t.spans.length,e.startTime<t.startTime&&(t.startTime=e.startTime);const n=Math.max(...t.spans.map(i=>i.startTime+i.duration));t.duration=n-t.startTime,!e.parentSpanId&&!t.rootService&&(t.rootService=e.serviceName,t.rootOperation=e.operationName),(e.tags.some(i=>i.key==="error"&&i.value===!0)||e.logs.some(i=>i.fields.some(l=>l.key==="error")))&&(t.hasErrors=!0),this.updateServiceStats(e,t),this.config&&this.traces.size>this.config.maxTraces&&this.evictOldestTraces()}updateServiceStats(e,t){let n=this.serviceStats.get(e.serviceName);n||(n={name:e.serviceName,tracesTotal:0,errorsTotal:0,avgDuration:0,spansTotal:0,lastTraceTime:0},this.serviceStats.set(e.serviceName,n)),n.spansTotal++,n.lastTraceTime=Math.max(n.lastTraceTime,e.startTime/1e3);const o=n.avgDuration*(n.spansTotal-1)+e.duration;n.avgDuration=o/n.spansTotal,(t.spans.length===1||t.spans[0].serviceName===e.serviceName)&&(n.tracesTotal++,t.hasErrors&&n.errorsTotal++)}evictOldestTraces(){if(!this.config)return;const e=Date.now()*1e3,t=this.config.traceTTL*1e3,n=this.config.maxTraces,o=[];for(const[i,l]of this.traces.entries())e-l.startTime>t&&o.push(i);if(this.traces.size-o.length>n){const l=Array.from(this.traces.entries()).filter(([u])=>!o.includes(u)).sort(([,u],[,f])=>u.startTime-f.startTime).slice(0,this.traces.size-o.length-n);o.push(...l.map(([u])=>u))}for(const i of o){const l=this.traces.get(i);if(l){for(const f of l.spans){const p=this.serviceStats.get(f.serviceName);p&&(p.tracesTotal=Math.max(0,p.tracesTotal-1),l.hasErrors&&(p.errorsTotal=Math.max(0,p.errorsTotal-1)))}const u=this.calculateTraceSize(l);this.jaegerMetrics.storageSizeBytes=Math.max(0,this.jaegerMetrics.storageSizeBytes-u),this.jaegerMetrics.tracesDroppedTotal++,this.traces.delete(i)}}}performCleanup(e){e-this.lastCleanupTime<this.CLEANUP_INTERVAL||(this.lastCleanupTime=e,this.evictOldestTraces())}queryTraces(e){const t=performance.now();this.jaegerMetrics.queryRequestsTotal++;try{let n=Array.from(this.traces.values());if(e.service&&(n=n.filter(u=>u.spans.some(f=>f.serviceName===e.service))),e.operation&&(n=n.filter(u=>u.spans.some(f=>f.operationName===e.operation))),e.tags&&(n=n.filter(u=>u.spans.some(f=>Object.entries(e.tags).every(([p,g])=>f.tags.some(m=>m.key===p&&String(m.value)===String(g)))))),e.startTime){const u=e.startTime*1e3;n=n.filter(f=>f.startTime>=u)}if(e.endTime){const u=e.endTime*1e3;n=n.filter(f=>f.startTime+f.duration<=u)}n.sort((u,f)=>f.startTime-u.startTime);const o=e.limit||20,i=n.length;n=n.slice(0,o);const l=performance.now()-t;return this.jaegerMetrics.queryDurationTotal+=l,this.queryHistory.push({params:e,timestamp:Date.now(),duration:l,resultsCount:n.length}),this.queryHistory.length>this.MAX_QUERY_HISTORY&&this.queryHistory.shift(),{traces:n,total:i,limit:o}}catch(n){return this.jaegerMetrics.queryErrorsTotal++,{traces:[],total:0,limit:e.limit||20,errors:[n instanceof Error?n.message:String(n)]}}}getServiceStats(){return Array.from(this.serviceStats.values())}getRecentTraces(e=20){const t=Array.from(this.traces.values());return t.sort((n,o)=>o.startTime-n.startTime),t.slice(0,e)}getTraceById(e){return this.traces.get(e)}getJaegerMetrics(){return{...this.jaegerMetrics}}calculateTraceSize(e){let t=0;for(const n of e.spans)t+=100,t+=n.operationName.length,t+=n.serviceName.length,t+=n.tags.length*50,t+=n.logs.length*100;return t}calculateLoad(){const e=this.jaegerMetrics.spansReceivedTotal,t=this.jaegerMetrics.tracesStoredTotal,n=this.jaegerMetrics.spansDroppedTotal,o=this.jaegerMetrics.queryRequestsTotal,i=this.jaegerMetrics.queryDurationTotal,l=this.jaegerMetrics.queryErrorsTotal,u=e>0?1-n/e:0,f=o>0?i/o:0,p=o>0?l/o:0,g=this.config?.maxTraces||1e4,m=this.traces.size/g,y=e/60,x=t/60;return{spansPerSecond:y,tracesPerSecond:x,samplingRate:u,storageUtilization:m,queryLatency:f,errorRate:p}}getConfig(){return this.config?{...this.config}:null}}class LT{nodes=[];connections=[];metrics=new Map;connectionMetrics=new Map;isRunning=!1;simulationTime=0;baseTime=Date.now();pausedTime=0;updateInterval=100;intervalId=null;latencyHistory=new Map;connectionLatencyHistory=new Map;HISTORY_SIZE=500;rabbitMQRoutingEngines=new Map;lastRabbitMQUpdate=new Map;activeMQRoutingEngines=new Map;lastActiveMQUpdate=new Map;sqsRoutingEngines=new Map;lastSQSUpdate=new Map;azureServiceBusRoutingEngines=new Map;lastAzureServiceBusUpdate=new Map;pubSubRoutingEngines=new Map;lastPubSubUpdate=new Map;kongRoutingEngines=new Map;apigeeRoutingEngines=new Map;mulesoftRoutingEngines=new Map;graphQLGatewayRoutingEngines=new Map;lastGraphQLGatewayUpdate=new Map;bffRoutingEngines=new Map;webhookRelayRoutingEngines=new Map;redisRoutingEngines=new Map;cassandraRoutingEngines=new Map;clickHouseRoutingEngines=new Map;snowflakeRoutingEngines=new Map;elasticsearchRoutingEngines=new Map;s3RoutingEngines=new Map;postgresConnectionPools=new Map;prometheusEngines=new Map;grafanaEngines=new Map;lokiEngines=new Map;jaegerEngines=new Map;constructor(){this.initializeMetrics()}calculatePercentile(e,t){if(e.length===0)return 0;const n=t/100*(e.length-1),o=Math.floor(n),i=Math.ceil(n),l=n-o;return o===i?e[o]:e[o]*(1-l)+e[i]*l}updateLatencyPercentiles(e,t,n){let o=this.latencyHistory.get(e);if(o||(o=[],this.latencyHistory.set(e,o)),o.push(t),o.length>this.HISTORY_SIZE&&o.shift(),o.length>0){const i=[...o].sort((l,u)=>l-u);n.latencyP50=this.calculatePercentile(i,50),n.latencyP99=this.calculatePercentile(i,99)}}updateConnectionLatencyPercentiles(e,t,n){let o=this.connectionLatencyHistory.get(e);if(o||(o=[],this.connectionLatencyHistory.set(e,o)),o.push(t),o.length>this.HISTORY_SIZE&&o.shift(),o.length>0){const i=[...o].sort((l,u)=>l-u);n.latencyP50=this.calculatePercentile(i,50),n.latencyP99=this.calculatePercentile(i,99)}}initialize(e,t){this.nodes=e,this.connections=t,this.initializeMetrics();for(const n of e)n.type==="rabbitmq"&&this.initializeRabbitMQRoutingEngine(n),n.type==="activemq"&&this.initializeActiveMQRoutingEngine(n),n.type==="aws-sqs"&&this.initializeSQSRoutingEngine(n),n.type==="azure-service-bus"&&this.initializeAzureServiceBusRoutingEngine(n),n.type==="gcp-pubsub"&&this.initializePubSubRoutingEngine(n),n.type==="kong"&&this.initializeKongRoutingEngine(n),n.type==="apigee"&&this.initializeApigeeRoutingEngine(n),n.type==="mulesoft"&&this.initializeMuleSoftRoutingEngine(n),n.type==="graphql-gateway"&&this.initializeGraphQLGatewayRoutingEngine(n),n.type==="bff-service"&&this.initializeBFFRoutingEngine(n),n.type==="webhook-relay"&&this.initializeWebhookRelayRoutingEngine(n),n.type==="postgres"&&this.initializePostgreSQLConnectionPool(n),n.type==="redis"&&this.initializeRedisRoutingEngine(n),n.type==="cassandra"&&this.initializeCassandraRoutingEngine(n),n.type==="clickhouse"&&this.initializeClickHouseRoutingEngine(n),n.type==="snowflake"&&this.initializeSnowflakeRoutingEngine(n),n.type==="elasticsearch"&&this.initializeElasticsearchRoutingEngine(n),n.type==="s3-datalake"&&this.initializeS3RoutingEngine(n),n.type==="prometheus"&&this.initializePrometheusEngine(n),n.type==="grafana"&&this.initializeGrafanaEngine(n),n.type==="jaeger"&&this.initializeJaegerEngine(n);for(const n of e)if(n.type==="postgres"){const o=this.postgresConnectionPools.get(n.id);if(o){const i=n.data.config;o.updateConfig({maxConnections:i.maxConnections||100,minConnections:i.minConnections||0,idleTimeout:i.idleTimeout||3e5,maxLifetime:i.maxLifetime||36e5,connectionTimeout:i.connectionTimeout||5e3})}}un.initialize(e,t)}updateNodesAndConnections(e,t){this.nodes=e,this.connections=t;for(const i of e)this.metrics.has(i.id)||this.metrics.set(i.id,this.createDefaultMetrics(i.id,i.type)),i.type==="rabbitmq"&&this.initializeRabbitMQRoutingEngine(i),i.type==="activemq"&&this.initializeActiveMQRoutingEngine(i),i.type==="aws-sqs"&&this.initializeSQSRoutingEngine(i),i.type==="azure-service-bus"&&this.initializeAzureServiceBusRoutingEngine(i),i.type==="gcp-pubsub"&&this.initializePubSubRoutingEngine(i),i.type==="kong"&&this.initializeKongRoutingEngine(i),i.type==="apigee"&&this.initializeApigeeRoutingEngine(i),i.type==="mulesoft"&&this.initializeMuleSoftRoutingEngine(i),i.type==="graphql-gateway"&&this.initializeGraphQLGatewayRoutingEngine(i),i.type==="bff-service"&&this.initializeBFFRoutingEngine(i),i.type==="webhook-relay"&&this.initializeWebhookRelayRoutingEngine(i),i.type==="clickhouse"&&this.initializeClickHouseRoutingEngine(i),i.type==="snowflake"&&this.initializeSnowflakeRoutingEngine(i);const n=new Set(e.map(i=>i.id));for(const[i]of this.metrics.entries())n.has(i)||(this.metrics.delete(i),this.rabbitMQRoutingEngines.delete(i),this.activeMQRoutingEngines.delete(i),this.sqsRoutingEngines.delete(i),this.azureServiceBusRoutingEngines.delete(i),this.pubSubRoutingEngines.delete(i),this.kongRoutingEngines.delete(i),this.apigeeRoutingEngines.delete(i),this.mulesoftRoutingEngines.delete(i),this.graphQLGatewayRoutingEngines.delete(i),this.bffRoutingEngines.delete(i),this.webhookRelayRoutingEngines.delete(i),this.redisRoutingEngines.delete(i),this.cassandraRoutingEngines.delete(i),this.clickHouseRoutingEngines.delete(i),this.snowflakeRoutingEngines.delete(i),this.elasticsearchRoutingEngines.delete(i),this.s3RoutingEngines.delete(i),this.graphQLGatewayRoutingEngines.delete(i),this.lastRabbitMQUpdate.delete(i),this.lastActiveMQUpdate.delete(i),this.lastSQSUpdate.delete(i),this.lastAzureServiceBusUpdate.delete(i),this.lastPubSubUpdate.delete(i),this.lastGraphQLGatewayUpdate.delete(i));for(const i of t)this.connectionMetrics.has(i.id)||this.connectionMetrics.set(i.id,this.createDefaultConnectionMetrics(i));const o=new Set(t.map(i=>i.id));for(const[i]of this.connectionMetrics.entries())o.has(i)||this.connectionMetrics.delete(i);un.updateNodesAndConnections(e,t)}start(){this.isRunning||(this.isRunning=!0,this.baseTime=Date.now()-this.pausedTime,un.start(),this.intervalId=setInterval(()=>{this.simulate()},this.updateInterval))}stop(){this.isRunning&&(this.isRunning=!1,this.pausedTime=this.simulationTime,this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),un.stop())}resetSimulation(){this.stop(),this.simulationTime=0,this.pausedTime=0,this.baseTime=Date.now(),this.initializeMetrics()}simulate(){this.simulationTime=Date.now()-this.baseTime;const e=Date.now();for(const[t,n]of this.rabbitMQRoutingEngines.entries()){const o=this.lastRabbitMQUpdate.get(t)||e,i=e-o;i>0&&(n.processConsumption(i),this.lastRabbitMQUpdate.set(t,e))}for(const[t,n]of this.activeMQRoutingEngines.entries()){const o=this.lastActiveMQUpdate.get(t)||e,i=e-o;i>0&&(n.processConsumption(i),this.lastActiveMQUpdate.set(t,e))}for(const[t,n]of this.sqsRoutingEngines.entries()){const o=this.lastSQSUpdate.get(t)||e,i=e-o;i>0&&(n.processConsumption(i),this.lastSQSUpdate.set(t,e))}for(const[t,n]of this.azureServiceBusRoutingEngines.entries()){const o=this.lastAzureServiceBusUpdate.get(t)||e,i=e-o;i>0&&(n.processConsumption(i),this.lastAzureServiceBusUpdate.set(t,e))}for(const[t,n]of this.pubSubRoutingEngines.entries()){const o=this.lastPubSubUpdate.get(t)||e,i=e-o;i>0&&(n.processConsumption(i),this.lastPubSubUpdate.set(t,e))}for(const t of this.nodes)this.updateComponentMetrics(t);for(const[t,n]of this.prometheusEngines.entries())n.performScraping(e,this.nodes,this.metrics);for(const[t,n]of this.grafanaEngines.entries()){const o=this.nodes.find(i=>i.id===t);if(o){const i=this.isPrometheusAvailableForGrafana(o),l=this.createLokiQueryExecutor(o);n.performUpdate(e,i,l)}}for(const[t,n]of this.lokiEngines.entries())n.performRetention(e);for(const[t,n]of this.jaegerEngines.entries())n.performCleanup(e);for(const t of this.connections)this.updateConnectionMetrics(t)}updateComponentMetrics(e){const t=e.data.config||{},n=this.metrics.get(e.id)||this.createDefaultMetrics(e.id,e.type),o=this.connections.some(f=>f.target===e.id),i=this.connections.some(f=>f.source===e.id);if(!(o||i))n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=0,n.customMetrics={};else switch(e.type){case"kafka":this.simulateKafka(e,t,n,o);break;case"rabbitmq":this.simulateRabbitMQ(e,t,n,o);break;case"activemq":this.simulateActiveMQ(e,t,n,o);break;case"aws-sqs":this.simulateSQS(e,t,n,o);break;case"azure-service-bus":this.simulateAzureServiceBus(e,t,n,o);break;case"gcp-pubsub":this.simulatePubSub(e,t,n,o);break;case"postgres":case"mongodb":case"redis":case"cassandra":this.simulateDatabase(e,t,n,o);break;case"nginx":this.simulateNginx(e,t,n,o);break;case"docker":case"kubernetes":this.simulateInfrastructure(e,t,n,o);break;case"rest":case"grpc":case"websocket":this.simulateAPI(e,t,n,o);break;case"kong":this.simulateKong(e,t,n,o);break;case"apigee":this.simulateApigee(e,t,n,o);break;case"mulesoft":this.simulateMuleSoft(e,t,n,o);break;case"bff-service":this.simulateBFF(e,t,n,o);break;case"prometheus":this.simulatePrometheus(e,t,n,o);break;case"grafana":this.simulateGrafana(e,t,n,o);break;case"loki":this.simulateLoki(e,t,n,o);break}this.applyCascadeEffects(e,n);const u=dr.applyStateEffects(e.id,{throughput:n.throughput,latency:n.latency,errorRate:n.errorRate,utilization:n.utilization});n.throughput=u.throughput,n.latency=u.latency,n.errorRate=u.errorRate,n.utilization=u.utilization,this.updateLatencyPercentiles(e.id,n.latency,n),n.timestamp=Date.now(),this.metrics.set(e.id,n)}applyCascadeEffects(e,t){const n=this.connections.filter(g=>g.target===e.id);if(n.length===0)return;let o=0,i=0,l=0;const u=t.latency;for(const g of n){const m=this.metrics.get(g.source),y=this.connectionMetrics.get(g.id);if(!m||!y)continue;const x=y.throughputDependency||.5;l+=x;const S=m.errorRate*x*.3;o+=S*x;const E=Math.min(m.latency,500)*x*.2;i+=E*x,(m.errorRate>.5||m.utilization>.95)&&(o+=.1*x,i+=100*x)}l>0&&(o/=l,i/=l),i=Math.min(i,500),t.errorRate=Math.min(1,t.errorRate+o),t.latency=u+i;const p=1e4;t.latency=Math.min(t.latency,p),i>50&&(t.utilization=Math.min(1,t.utilization+.1)),o>.1&&(t.throughput=t.throughput*(1-o*.5))}updateConnectionMetrics(e){const t=this.metrics.get(e.source),n=this.metrics.get(e.target);if(!t||!n)return;const o=this.connectionMetrics.get(e.id)||{id:e.id,source:e.source,target:e.target,traffic:0,latency:0,errorRate:0,utilization:0,timestamp:Date.now(),throughputDependency:0,backpressure:0,bottleneck:!1,effectiveThroughput:0,congestion:0},i=this.nodes.find(f=>f.id===e.source),l=this.nodes.find(f=>f.id===e.target),u=i?.data.config?.avgPayloadSize||1024;o.traffic=t.throughput*u/1024,o.latency=this.calculateConnectionLatency(e,t,n),o.errorRate=t.errorRate*.1,this.calculateInteractionMetrics(e,o,t,n,i,l),this.updateConnectionLatencyPercentiles(e.id,o.latency,o),o.timestamp=Date.now(),this.connectionMetrics.set(e.id,o)}calculateInteractionMetrics(e,t,n,o,i,l){const u=e.data||{},p=(u.bandwidthMbps||1e3)*1024*1024/8;this.getComponentCapacity(i);const g=this.getComponentCapacity(l),m=n.throughput,y=i?.data.config?.avgPayloadSize||1024,x=m*y,S=Math.min(x,p),C=g*y,E=Math.min(S,C);t.effectiveThroughput=E/y;const A=this.connections.filter(Z=>Z.target===e.target).reduce((Z,te)=>{const le=this.metrics.get(te.source);return Z+(le?.throughput||0)},0);t.throughputDependency=A>0?m/A:0;const T=o.utilization,N=x/p,D=m/g,q=(u.packetLossPercent||0)/100;t.backpressure=Math.min(1,T*.4+N*.3+D*.2+q*.1);const P=x>p*.8,H=m>g*.8,J=t.backpressure>.7;t.bottleneck=P||H||J;const se=this.getBaseLatency(e.type),ce=Math.max(0,t.latency-se)/se;t.congestion=Math.min(1,N*.4+ce*.3+q*.3),t.utilization=Math.min(1,t.effectiveThroughput/g)}getComponentCapacity(e){if(!e)return 1e3;const t=e.data.config||{};switch(e.type){case"kafka":case"rabbitmq":case"activemq":return t.throughputMsgs||1e3;case"postgres":case"mongodb":case"redis":return t.maxConnections?t.maxConnections*10:1e3;case"nginx":case"rest":case"grpc":case"websocket":return t.requestsPerSecond||1e3;case"docker":case"kubernetes":return(t.workerThreads||1)*500;default:return 1e3}}getBaseLatency(e){return{sync:5,async:2,http:10,grpc:5,websocket:3}[e]||10}simulateKafka(e,t,n,o){const i=e.data.config,l=i?.brokers||["localhost:9092"],u=i?.topics||[],f=i?.consumerGroups||[],p=u.length||t.topicCount||5,g=u.reduce((j,O)=>j+(O.partitions||3),0)||t.partitions||3,m=u.length>0?u.reduce((j,O)=>j+(O.replication||1),0)/u.length:t.replicationFactor||1,y=this.connections.filter(j=>j.target===e.id);let x=0;for(const j of y){const O=this.metrics.get(j.source);O&&(x+=O.throughput||0)}const S=t.throughputMsgs||Math.max(1e3,x);if(!o&&S<=0){if(n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=0,u.length>0)for(const j of u)j.messages=j.messages||0,j.size=j.size||0;for(const j of f)j.lag=0;n.customMetrics={topics:p,partitions:g,replication:Math.round(m*10)/10,brokers:l.length,consumer_groups:f.length,total_lag:0};return}const C=.2*Math.sin(this.simulationTime/1e3);n.throughput=S*(1+C);const E=3,M=Math.min(g/10,10),A=Math.max(1,(m-1)*2),T=Math.max(0,(m-1)*1),N=this.calculateCompressionOverhead(u);if(n.latency=E+M+A+T+N,l.length>1){const j=Math.min(5,l.length*.5);n.latency+=j}const D=this.calculateUnderReplicatedPartitions(u,l.length),q=m>1?(m-1)*5e-4:0,P=D>0?D*.001:0,H=i?.acls||[];let J=0,se=0;for(const j of y){const O=this.nodes.find(Y=>Y.id===j.source);if(!O)continue;const X=O.data.config||{},he=X.messaging?.producerId||X.clientId||`User:${O.id.slice(0,8)}`,_=X.messaging?.topic||u[0]?.name||"default-topic";if(!this.checkACLPermission(H,he,"Topic",_,"Write")){const Y=this.metrics.get(j.source);Y&&(se+=Y.throughput*.9,J+=.45)}}se>0&&(n.throughput=Math.max(0,n.throughput-se)),n.errorRate=Math.max(0,Math.min(.1,q+P+J+1e-4));const Z=Math.min(1,n.throughput/1e4),te=Math.min(1,g/200);n.utilization=Math.min(1,Z*.7+te*.3);const le=t.avgPayloadSize||1024,ue=this.updateInterval/1e3;for(const j of u){const O=n.throughput/p,X=O*ue;j.messages=(j.messages||0)+X;const he=this.getCompressionRatio(j.config?.compressionType),_=X*le*he;if(j.size=(j.size||0)+_,j.config?.retentionMs&&j.config.retentionMs>0){const Q=j.config.retentionMs/1e3,ae=O*Q;if(j.messages>ae){const B=j.messages-ae;j.messages=ae,j.size=Math.max(0,j.size-B*le*he)}}if(j.config?.retentionBytes&&j.config.retentionBytes>0&&j.size>j.config.retentionBytes){const Q=1-j.config.retentionBytes/j.size;j.size=j.config.retentionBytes,j.messages=Math.max(0,j.messages*(1-Q))}if((j.config?.cleanupPolicy==="compact"||j.config?.cleanupPolicy==="delete,compact")&&this.simulationTime%3e5<this.updateInterval){const ae=Math.round(j.messages*.85),B=j.messages-ae;j.messages=ae,j.size=Math.max(0,j.size-B*le*he)}if(j.config?.minInsyncReplicas){const Q=j.config.minInsyncReplicas,Y=this.getAverageISRCount(j,l.length);if(Y<Q){const ae=Q-Y;n.errorRate+=ae*.01}}if(j.config?.maxMessageBytes&&le>j.config.maxMessageBytes){const Q=Math.min(.1,(le-j.config.maxMessageBytes)/j.config.maxMessageBytes);n.errorRate+=Q*.5}}let z=0;for(const j of f){const O=u.find(at=>at.name===j.topic);if(!O)continue;const X=j.members||1,he=O.partitions||1,_=this.assignPartitionsToConsumers(X,he),Q=300;let Y=0;for(const at of _){const Ze=at.partitions.length;Y+=Ze*Q}const ae=Math.min(Y,X*Q),B=n.throughput/p||0,oe=j.id||`Group:${j.id}`,$=this.checkACLPermission(H,oe,"Topic",j.topic,"Read"),V=this.checkACLPermission(H,oe,"Group",j.id,"Read");let pe=ae;(!$||!V)&&(pe=0);const me=B,ye=pe,ve=Math.max(0,(me-ye)*ue),_e=j.lag||0,Ue=Math.max(0,_e+ve-ye*ue);j.lag=Ue,z+=Ue,this.isRebalancing(e.id,j.id)&&(j.lag=Math.min(Ue*1.2,Ue+me*ue*.3),z+=Ue*.2)}n.customMetrics={topics:p,partitions:g,replication:Math.round(m*10)/10,brokers:l.length,consumer_groups:f.length,total_lag:Math.round(z),avg_topic_messages:p>0?Math.round(u.reduce((j,O)=>j+(O.messages||0),0)/p):0,total_topic_size_mb:Math.round(u.reduce((j,O)=>j+(O.size||0),0)/1024/1024*100)/100,under_replicated_partitions:D}}calculateCompressionOverhead(e){if(e.length===0)return 0;const t={uncompressed:0,gzip:2,snappy:.5,lz4:.3,zstd:1};let n=0,o=0;for(const i of e){const l=i.config?.compressionType||"gzip",u=t[l]||0;u>0&&(n+=u,o++)}return o>0?n/o:0}getCompressionRatio(e){return{uncompressed:1,gzip:.3,snappy:.5,lz4:.4,zstd:.25}[e||"gzip"]||.3}calculateUnderReplicatedPartitions(e,t){let n=0;for(const o of e){const i=o.replication||1,l=o.partitions||1;if(o.partitionInfo&&Array.isArray(o.partitionInfo))for(const u of o.partitionInfo){const f=i;(u.isr?.length||u.replicas?.length||1)<f&&n++}else i>t&&(n+=l*Math.max(0,1-t/i)),Math.random()<.05&&i>1&&(n+=l*.1)}return Math.round(n)}assignPartitionsToConsumers(e,t){if(e===0||t===0)return[];const n=[],o=Math.floor(t/e),i=t%e;let l=0;for(let u=0;u<e;u++){const f=[],p=o+(u<i?1:0);for(let g=0;g<p;g++)l<t&&(f.push(l),l++);n.push({consumerId:u,partitions:f})}return n}consumerGroupMemberCounts=new Map;rebalancingGroups=new Map;isRebalancing(e,t){const n=`${e}:${t}`,o=this.rebalancingGroups.get(n);if(o&&Date.now()<o)return!0;const i=this.getCurrentGroupMembers(e,t),l=this.consumerGroupMemberCounts.get(n);return l!==void 0&&i!==l?(this.rebalancingGroups.set(n,Date.now()+2e3),this.consumerGroupMemberCounts.set(n,i),!0):((l===void 0||i!==l)&&this.consumerGroupMemberCounts.set(n,i),!1)}getCurrentGroupMembers(e,t){const n=this.nodes.find(u=>u.id===e);return n&&(n.data.config?.consumerGroups||[]).find(u=>u.id===t)?.members||0}getAverageISRCount(e,t){if(!e.partitionInfo||!Array.isArray(e.partitionInfo)||e.partitionInfo.length===0){const i=e.replication||1;return Math.min(i,t)*.95}let n=0,o=0;for(const i of e.partitionInfo){const l=i.isr?.length||i.replicas?.length||1;n+=l,o++}return o>0?n/o:1}checkACLPermission(e,t,n,o,i,l){if(!e||e.length===0)return!0;const u=t.includes(":")?t:`User:${t}`,f=e.filter(m=>{const y=m.principal||"";if(y!==u&&y!=="*"&&!u.includes(y)||m.resourceType!==n)return!1;const x=m.resourcePatternType||"Literal",S=m.resourceName||"";let C=!1;switch(x){case"Literal":C=S===o||S==="*";break;case"Prefixed":if(S==="*")C=!0;else if(S.endsWith("*")){const E=S.slice(0,-1);C=o.startsWith(E)}else C=o.startsWith(S);break;case"Match":if(S==="*")C=!0;else{const E=S.replace(/\./g,"\\.").replace(/\*/g,".*");C=new RegExp(`^${E}$`).test(o)}break;default:C=S===o||S==="*"}return!(!C||m.operation!==i&&m.operation!=="All"||m.host&&m.host!=="*"&&l&&m.host!==l)});return f.length===0||f.filter(m=>m.permission==="Deny").length>0?!1:f.filter(m=>m.permission==="Allow").length>0}simulateRabbitMQ(e,t,n,o){this.rabbitMQRoutingEngines.has(e.id)||this.initializeRabbitMQRoutingEngine(e);const i=this.rabbitMQRoutingEngines.get(e.id);if(e.data.config,!o){n.throughput=0,n.latency=2,n.errorRate=0;const T=i.getTotalQueueDepth();n.utilization=Math.min(1,T/1e5);const N=i.getAllQueueMetrics(),D=i.getActiveConnections();n.customMetrics={queue_depth:T,connections:D,replication:t.replicationFactor||1},this.updateQueueMetricsInConfig(e,N);return}const l=this.connections.filter(T=>T.target===e.id);let u=0;for(const T of l){const N=this.connectionMetrics.get(T.id);if(N){const q=N.traffic/1024;u+=q}}const f=t.throughputMsgs||u||1e3,p=t.replicationFactor||1,g=(Math.random()-.5)*.1;n.throughput=f*(1+g);const m=i.getTotalQueueDepth(),y=2,x=Math.min(50,m/1e3);n.latency=y+p*5+x+Math.random()*5;const S=5e-4,C=Math.min(.01,m/1e6);n.errorRate=S+C,n.utilization=Math.min(1,m/1e5);const E=i.getAllQueueMetrics(),M=i.getActiveConnections();let A=0;for(const T of E.values())A+=T.consumers;n.customMetrics={queue_depth:m,connections:M,replication:p,queues:E.size,consumers:A},this.updateQueueMetricsInConfig(e,E)}initializeRabbitMQRoutingEngine(e){const t=e.data.config||{},n=new aT;n.initialize({queues:t.queues||[],exchanges:t.exchanges||[{name:"amq.direct",type:"direct",durable:!0,autoDelete:!1,internal:!1},{name:"amq.topic",type:"topic",durable:!0,autoDelete:!1,internal:!1},{name:"amq.fanout",type:"fanout",durable:!0,autoDelete:!1,internal:!1}],bindings:t.bindings||[]}),this.rabbitMQRoutingEngines.set(e.id,n),this.lastRabbitMQUpdate.set(e.id,Date.now())}updateQueueMetricsInConfig(e,t){const n=e.data.config||{},o=n.queues||[];for(let i=0;i<o.length;i++){const l=o[i],u=t.get(l.name);u&&(o[i]={...l,messages:u.messages,ready:u.ready,unacked:u.unacked,consumers:u.consumers})}n.queues=o}simulateActiveMQ(e,t,n,o){this.activeMQRoutingEngines.has(e.id)||this.initializeActiveMQRoutingEngine(e);const i=this.activeMQRoutingEngines.get(e.id),l=e.data.config||{},u=l.protocol||"openwire",f=l.persistenceEnabled??!0,p=l.maxConnections||1e3,g=l.memoryLimit||1024,m=l.storeUsage||0,y=l.tempUsage||0,x=l.connections||[];if(!o){n.throughput=0,n.latency=this.getProtocolBaseLatency(u),n.errorRate=0;const B=i.getTotalQueueDepth(),oe=i.getTotalTopicMessages(),$=B+oe;n.utilization=Math.min(1,$/1e5);const V=i.getAllQueueMetrics(),pe=i.getAllTopicMetrics(),me=i.getActiveConnections();let ye=0;for(const _e of V.values())ye+=_e.consumerCount;let ve=0;for(const _e of pe.values())ve+=_e.subscriberCount;n.customMetrics={queue_depth:B,topic_messages:oe,connections:me,queues:V.size,topics:pe.size,consumers:ye,subscribers:ve,memory_usage:m+y,memory_percent:g>0?(m+y)/g*100:0},this.updateActiveMQMetricsInConfig(e,V,pe);return}const S=this.connections.filter(B=>B.target===e.id);let C=0;for(const B of S){const oe=this.connectionMetrics.get(B.id);if(oe){const V=oe.traffic/1024;C+=V}}const E=t.throughputMsgs||C||1e3,M=(Math.random()-.5)*.1;n.throughput=E*(1+M);const A=i.getTotalQueueDepth(),T=i.getTotalTopicMessages(),N=A+T,D=this.getProtocolBaseLatency(u),q=f?5:0,P=Math.min(50,N/1e3),H=g>0&&m+y>g*.8?10:0;n.latency=D+q+P+H+Math.random()*5;const J=l.acls||[];let se=0,ce=0;for(const B of S){const oe=this.nodes.find(me=>me.id===B.source);if(!oe)continue;const $=oe.data.config,V=$?.messaging||{},pe=$?.username||$?.clientId||l.username||`user-${B.source.slice(0,8)}`;if(V.queue&&!this.checkActiveMQACLPermission(J,pe,`queue://${V.queue}`,"write")){const ye=this.metrics.get(B.source);ye&&(ce+=ye.throughput*.9,se+=.45)}if(V.topic&&!this.checkActiveMQACLPermission(J,pe,`topic://${V.topic}`,"write")){const ye=this.metrics.get(B.source);ye&&(ce+=ye.throughput*.9,se+=.45)}}const Z=l.queues||[];for(const B of Z)B.consumerCount&&B.consumerCount>0&&(this.checkActiveMQACLPermission(J,l.username||"admin",`queue://${B.name}`,"read")||(se+=.1));const te=5e-4,le=Math.min(.01,N/1e6),ue=g>0&&m+y>g?.01:0,z=x.length>=p?.005:0;ce>0&&(n.throughput=Math.max(0,n.throughput-ce)),n.errorRate=Math.min(1,te+le+ue+z+se);const j=Math.min(1,N/1e5),O=g>0?Math.min(1,(m+y)/g):0,X=Math.min(1,x.length/p);n.utilization=Math.max(j,O,X);const he=i.getAllQueueMetrics(),_=i.getAllTopicMetrics(),Q=i.getActiveConnections();let Y=0;for(const B of he.values())Y+=B.consumerCount;let ae=0;for(const B of _.values())ae+=B.subscriberCount;n.customMetrics={queue_depth:A,topic_messages:T,connections:Q,queues:he.size,topics:_.size,consumers:Y,subscribers:ae,memory_usage:m+y,memory_percent:g>0?(m+y)/g*100:0,protocol:u},this.updateActiveMQMetricsInConfig(e,he,_)}checkActiveMQACLPermission(e,t,n,o){if(!e||e.length===0)return!0;const i=e.filter(f=>{const p=f.principal||"";if(p!==t&&p!=="*"&&!t.includes(p))return!1;const g=f.resource||"";let m=!1;if(g==="*"||g===n)m=!0;else if(g.endsWith("*")){const S=g.slice(0,-1);m=n.startsWith(S)}else g.includes("://")?m=g===n:m=n.includes(g);if(!m)return!1;const y=(f.operation||"").toLowerCase(),x=o.toLowerCase();return!(y!==x&&y!=="all"&&y!=="*")});return i.length===0?!0:i.filter(f=>f.permission==="deny").length>0?!1:(i.filter(f=>f.permission==="allow").length>0,!0)}getProtocolBaseLatency(e){return{openwire:2,amqp:5,mqtt:8,stomp:10,ws:12}[e]||5}initializeActiveMQRoutingEngine(e){const t=e.data.config||{},n=new oT;n.initialize({queues:t.queues||[],topics:t.topics||[],subscriptions:t.subscriptions||[]}),this.activeMQRoutingEngines.set(e.id,n),this.lastActiveMQUpdate.set(e.id,Date.now())}updateActiveMQMetricsInConfig(e,t,n){const o=e.data.config||{},i=o,l=o.queues||[];for(let m=0;m<l.length;m++){const y=l[m],x=t.get(y.name);x&&(l[m]={...y,queueSize:x.queueSize,consumerCount:x.consumerCount,enqueueCount:x.enqueueCount,dequeueCount:x.dequeueCount})}o.queues=l;const u=o.topics||[];for(let m=0;m<u.length;m++){const y=u[m],x=n.get(y.name);x&&(u[m]={...y,subscriberCount:x.subscriberCount,enqueueCount:x.enqueueCount,dequeueCount:x.dequeueCount})}o.topics=u;const f=this.connections.filter(m=>m.target===e.id),p=[];for(const m of f){const y=this.nodes.find(M=>M.id===m.source);if(!y)continue;y.data.config?.messaging;const S=i.protocol||"openwire",C=this.connectionMetrics.get(m.id),E=C?Math.floor(C.traffic/1024):0;p.push({id:m.id,remoteAddress:`${y.data.label||y.id}`,clientId:`client-${m.source.slice(0,8)}`,userName:i.username||"admin",connectedSince:new Date().toISOString(),messageCount:E,protocol:S==="openwire"?"OpenWire":S==="amqp"?"AMQP":S==="mqtt"?"MQTT":S==="stomp"?"STOMP":S==="ws"?"WebSocket":"OpenWire"})}o.connections=p;const g=[];for(const m of u)for(const y of f){const x=this.nodes.find(E=>E.id===y.source);if(!x)continue;const C=x.data.config?.messaging||{};if(C.topic===m.name||!C.queue){const E=n.get(m.name);g.push({id:`sub-${y.id}-${m.name}`,destination:m.name,clientId:`client-${y.source.slice(0,8)}`,pendingQueueSize:0,dispatchedQueueSize:0,dispatchedCounter:E?.enqueueCount||0,enqueueCounter:E?.enqueueCount||0,dequeueCounter:E?.dequeueCount||0})}}o.subscriptions=g}simulateAzureServiceBus(e,t,n,o){this.azureServiceBusRoutingEngines.has(e.id)||this.initializeAzureServiceBusRoutingEngine(e);const i=this.azureServiceBusRoutingEngines.get(e.id),l=e.data.config||{};if(!o){n.throughput=0,n.latency=5,n.errorRate=0;const se=i.getTotalQueueDepth(),ce=i.getTotalSubscriptionMessages(),Z=se+ce;n.utilization=Math.min(1,Z/1e5);const te=i.getAllQueueMetrics(),le=i.getAllSubscriptionMetrics(),ue=i.getActiveConnections();n.customMetrics={queue_depth:se,subscription_messages:ce,connections:ue,queues:l.queues?.length||0,topics:l.topics?.length||0},this.updateAzureServiceBusMetricsInConfig(e,te,le);return}const u=this.connections.filter(se=>se.target===e.id);let f=0;for(const se of u){const ce=this.connectionMetrics.get(se.id);if(ce){const te=ce.traffic/1024;f+=te}}const p=t.throughputMsgs||f||1e3,g=(Math.random()-.5)*.1;n.throughput=p*(1+g);const m=i.getTotalQueueDepth(),y=i.getTotalSubscriptionMessages(),x=m+y,S=5,C=Math.min(50,x/1e3),E=2;n.latency=S+C+E+Math.random()*5;const M=i.getAllQueueMetrics(),A=i.getAllSubscriptionMetrics(),T=i.getActiveConnections(),N=5e-4,D=Math.min(.01,x/1e6);let q=0;for(const se of M.values())q+=se.deadLetterMessageCount||0;for(const se of A.values())q+=se.deadLetterMessageCount||0;const P=q>0?Math.min(.05,q/1e4):0;n.errorRate=Math.min(1,N+D+P),n.utilization=Math.min(1,x/1e5);let H=0;const J=l.topics||[];for(const se of J)H+=(se.subscriptions||[]).length;n.customMetrics={queue_depth:m,subscription_messages:y,dead_letter_messages:q,connections:T,queues:l.queues?.length||0,topics:l.topics?.length||0,subscriptions:H},this.updateAzureServiceBusMetricsInConfig(e,M,A)}initializeAzureServiceBusRoutingEngine(e){const t=e.data.config||{},n=new iT,o=(t.queues||[]).map(l=>({name:l.name,namespace:l.namespace||t.namespace||"archiphoenix.servicebus.windows.net",maxSizeInMegabytes:l.maxSizeInMegabytes||1024,defaultMessageTimeToLive:l.defaultMessageTimeToLive||2592e3,lockDuration:l.lockDuration||30,maxDeliveryCount:l.maxDeliveryCount||10,enablePartitioning:l.enablePartitioning||!1,enableDeadLetteringOnMessageExpiration:l.enableDeadLetteringOnMessageExpiration!==void 0?l.enableDeadLetteringOnMessageExpiration:!0,enableSessions:l.enableSessions||!1,activeMessageCount:l.activeMessageCount||0,deadLetterMessageCount:l.deadLetterMessageCount||0,scheduledMessageCount:l.scheduledMessageCount||0})),i=(t.topics||[]).map(l=>({name:l.name,namespace:l.namespace||t.namespace||"archiphoenix.servicebus.windows.net",maxSizeInMegabytes:l.maxSizeInMegabytes||1024,defaultMessageTimeToLive:l.defaultMessageTimeToLive||2592e3,enablePartitioning:l.enablePartitioning||!1,subscriptions:(l.subscriptions||[]).map(u=>({name:u.name,maxDeliveryCount:u.maxDeliveryCount||10,lockDuration:u.lockDuration||30,enableDeadLetteringOnMessageExpiration:u.enableDeadLetteringOnMessageExpiration!==void 0?u.enableDeadLetteringOnMessageExpiration:!0,activeMessageCount:u.activeMessageCount||0}))}));n.initialize({queues:o,topics:i}),this.azureServiceBusRoutingEngines.set(e.id,n),this.lastAzureServiceBusUpdate.set(e.id,Date.now())}updateAzureServiceBusMetricsInConfig(e,t,n){const o=e.data.config||{},i=o.queues||[];for(let u=0;u<i.length;u++){const f=i[u],p=t.get(f.name);p&&(i[u]={...f,activeMessageCount:p.activeMessageCount,deadLetterMessageCount:p.deadLetterMessageCount,scheduledMessageCount:p.scheduledMessageCount})}o.queues=i;const l=o.topics||[];for(let u=0;u<l.length;u++){const f=l[u],p=f.subscriptions||[];for(let g=0;g<p.length;g++){const m=p[g],y=`${f.name}/subscriptions/${m.name}`,x=n.get(y);x&&(p[g]={...m,activeMessageCount:x.activeMessageCount})}l[u]={...f,subscriptions:p}}o.topics=l}simulatePubSub(e,t,n,o){this.pubSubRoutingEngines.has(e.id)||this.initializePubSubRoutingEngine(e);const i=this.pubSubRoutingEngines.get(e.id),l=e.data.config||{},u=l.topics||[],f=l.subscriptions||[];if(!o){n.throughput=0,n.latency=3,n.errorRate=0;const z=i.getTotalTopicMessages(),j=i.getTotalUnackedMessages(),O=z+j;n.utilization=Math.min(1,O/1e5);const X=i.getAllTopicMetrics(),he=i.getAllSubscriptionMetrics(),_=i.getActiveConnections();n.customMetrics={topic_messages:z,unacked_messages:j,connections:_,topics:u.length,subscriptions:f.length},this.updatePubSubMetricsInConfig(e,X,he);return}const p=this.connections.filter(z=>z.target===e.id);let g=0;for(const z of p){const j=this.connectionMetrics.get(z.id);if(j){const X=j.traffic/1024;g+=X}}const m=t.throughputMsgs||g||1e3,y=(Math.random()-.5)*.1;n.throughput=m*(1+y);const x=i.getTotalTopicMessages(),S=i.getTotalUnackedMessages(),C=x+S,E=3,M=Math.min(15,C/1e4),A=f.filter(z=>z.pushEndpoint).length,T=A>0?2:0,N=S>0?.5:0;n.latency=E+M+T+N+Math.random()*2;const D=i.getAllTopicMetrics(),q=i.getAllSubscriptionMetrics(),P=i.getActiveConnections(),H=1e-4,J=Math.min(.001,C/5e6),se=A>0&&S>0?Math.min(.002,S/1e5):0,ce=f.length>0?f.reduce((z,j)=>z+(j.ackDeadlineSeconds||10),0)/f.length:10,Z=S>0&&ce<60?Math.min(.005,S/1e5):0;n.errorRate=Math.min(1,H+J+se+Z);const te=Math.min(1,n.throughput/1e5),le=Math.min(.3,C/5e5);n.utilization=Math.min(1,te*.7+le*.3);const ue=f.length-A;n.customMetrics={topic_messages:x,unacked_messages:S,connections:P,topics:u.length,subscriptions:f.length,push_subscriptions:A,pull_subscriptions:ue,total_bytes:Array.from(D.values()).reduce((z,j)=>z+j.byteCount,0)},this.updatePubSubMetricsInConfig(e,D,q)}initializePubSubRoutingEngine(e){const t=e.data.config||{},n=new cT,o=(t.topics||[]).map(l=>({name:l.name,projectId:l.projectId||t.projectId||"archiphoenix-lab",messageRetentionDuration:l.messageRetentionDuration||604800,labels:l.labels||{},messageCount:l.messageCount||0,byteCount:l.byteCount||0})),i=(t.subscriptions||[]).map(l=>({name:l.name,topic:l.topic,projectId:l.projectId||t.projectId||"archiphoenix-lab",ackDeadlineSeconds:l.ackDeadlineSeconds||10,messageRetentionDuration:l.messageRetentionDuration,enableMessageOrdering:l.enableMessageOrdering||!1,pushEndpoint:l.pushEndpoint,pushAttributes:l.pushAttributes||{},messageCount:l.messageCount||0,unackedMessageCount:l.unackedMessageCount||0}));n.initialize({topics:o,subscriptions:i}),this.pubSubRoutingEngines.set(e.id,n),this.lastPubSubUpdate.set(e.id,Date.now())}updatePubSubMetricsInConfig(e,t,n){const o=e.data.config||{},i=o.topics||[];for(let u=0;u<i.length;u++){const f=i[u],p=t.get(f.name);p&&(i[u]={...f,messageCount:p.messageCount,byteCount:p.byteCount})}o.topics=i;const l=o.subscriptions||[];for(let u=0;u<l.length;u++){const f=l[u],p=n.get(f.name);p&&(l[u]={...f,messageCount:p.messageCount,unackedMessageCount:p.unackedMessageCount})}o.subscriptions=l}simulateSQS(e,t,n,o){this.sqsRoutingEngines.has(e.id)||this.initializeSQSRoutingEngine(e);const i=this.sqsRoutingEngines.get(e.id);if(e.data.config,!o){n.throughput=0,n.latency=5,n.errorRate=0;const M=i.getTotalQueueDepth();n.utilization=Math.min(1,M/1e5);const A=i.getAllQueueMetrics(),T=i.getActiveConnections();n.customMetrics={queue_depth:M,connections:T,queues:A.size},this.updateSQSQueueMetricsInConfig(e,A);return}const l=this.connections.filter(M=>M.target===e.id);let u=0;for(const M of l){const A=this.connectionMetrics.get(M.id);if(A){const N=A.traffic/1024;u+=N}}const f=t.throughputMsgs||u||1e3,p=(Math.random()-.5)*.1;n.throughput=f*(1+p);const g=i.getTotalQueueDepth(),m=5,y=Math.min(50,g/1e3);n.latency=m+y+Math.random()*5;const x=5e-4,S=Math.min(.01,g/1e6);n.errorRate=x+S,n.utilization=Math.min(1,g/1e5);const C=i.getAllQueueMetrics(),E=i.getActiveConnections();n.customMetrics={queue_depth:g,connections:E,queues:C.size},this.updateSQSQueueMetricsInConfig(e,C)}initializeSQSRoutingEngine(e){const t=e.data.config||{},n=new rT,o=(t.queues||[]).map(i=>({name:i.name,type:i.type||"standard",region:i.region||t.defaultRegion||"us-east-1",visibilityTimeout:i.visibilityTimeout||30,messageRetention:i.messageRetention||4,delaySeconds:i.delaySeconds||0,maxReceiveCount:i.maxReceiveCount,deadLetterQueue:i.deadLetterQueue,contentBasedDedup:i.contentBasedDedup,fifoThroughputLimit:i.fifoThroughputLimit||"perQueue"}));n.initialize({queues:o}),this.sqsRoutingEngines.set(e.id,n),this.lastSQSUpdate.set(e.id,Date.now())}updateSQSQueueMetricsInConfig(e,t){const n=e.data.config||{},o=n.queues||[];for(let i=0;i<o.length;i++){const l=o[i],u=t.get(l.name);u&&(o[i]={...l,approximateMessages:u.approximateMessages,approximateMessagesNotVisible:u.approximateMessagesNotVisible,approximateMessagesDelayed:u.approximateMessagesDelayed})}n.queues=o}simulateDatabase(e,t,n,o){if(!o){if(n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=0,n.customMetrics={},e.type==="postgres"){const y=this.postgresConnectionPools.get(e.id);y&&y.reset()}return}const i=t.maxConnections||100,l=t.queryLatency||10;if(e.type==="postgres"){const y=this.postgresConnectionPools.get(e.id);if(y){const S=this.connections.filter(q=>q.target===e.id).reduce((q,P)=>{const H=this.metrics.get(P.source);return q+(H?.throughput||0)},0),E=Math.min(S,i*10)*this.updateInterval/1e3;for(let q=0;q<Math.floor(E);q++){const P=y.acquireConnection("SELECT");if(P){const H=l+Math.random()*20;setTimeout(()=>{y.releaseConnection(P,H)},H)}}const M=y.getMetrics();n.throughput=M.queriesPerSecond,n.latency=M.averageQueryTime||l,n.utilization=M.utilization,n.errorRate=M.waitingConnections>0?.01:.001;const T=e.data.config.tables||[];let N=0;for(const q of T)N+=(q.indexes||[]).length;N===0&&(N=5);const D=this.calculateCacheHitRatio(e,M.queriesPerSecond);n.customMetrics={active_connections:M.activeConnections,idle_connections:M.idleConnections,waiting_connections:M.waitingConnections,total_connections:M.totalConnections,max_connections:i,indexes:N,cache_hit_ratio:D,connection_wait_time:M.connectionWaitTime};return}}if(e.type==="redis"){this.redisRoutingEngines.has(e.id)||this.initializeRedisRoutingEngine(e);const y=this.redisRoutingEngines.get(e.id),x=e.data.config;x?.keys&&y.syncKeysFromConfig(x.keys);const S=y.getMetrics(),E=this.connections.filter(N=>N.target===e.id).reduce((N,D)=>{const q=this.metrics.get(D.source);return N+(q?.throughput||0)},0);n.throughput=Math.max(S.operationsPerSecond,E);const M=.5,A=S.memoryUsagePercent/100,T=Math.min(1,S.totalKeys/1e5);n.latency=M+A*2+T*1,n.errorRate=A>.95?.01:.001,n.utilization=S.memoryUsagePercent/100,n.customMetrics={total_keys:S.totalKeys,keys_string:S.keysByType.string,keys_hash:S.keysByType.hash,keys_list:S.keysByType.list,keys_set:S.keysByType.set,keys_zset:S.keysByType.zset,keys_stream:S.keysByType.stream,memory_usage:S.memoryUsage,memory_usage_percent:S.memoryUsagePercent,operations_per_second:S.operationsPerSecond,hit_count:S.hitCount,miss_count:S.missCount,hit_rate:S.hitRate,expired_keys:S.expiredKeys,evicted_keys:S.evictedKeys,connected_clients:S.connectedClients};return}if(e.type==="cassandra"){this.cassandraRoutingEngines.has(e.id)||this.initializeCassandraRoutingEngine(e);const y=this.cassandraRoutingEngines.get(e.id),x=e.data.config;x&&y.syncFromConfig({clusterName:x.clusterName,nodes:x.nodes,keyspaces:x.keyspaces,tables:x.tables,defaultConsistencyLevel:x.consistencyLevel,defaultReplicationFactor:x.replicationFactor});const S=y.getMetrics(),E=this.connections.filter(D=>D.target===e.id).reduce((D,q)=>{const P=this.metrics.get(q.source);return D+(P?.throughput||0)},0);n.throughput=Math.max(S.readOperationsPerSecond+S.writeOperationsPerSecond,E);const M=S.readOperationsPerSecond+S.writeOperationsPerSecond;if(M>0){const D=S.readOperationsPerSecond/M,q=S.writeOperationsPerSecond/M;n.latency=S.readLatency*D+S.writeLatency*q}else n.latency=(S.readLatency+S.writeLatency)/2;const A=S.readConsistencyViolations+S.writeConsistencyViolations;n.errorRate=Math.min(.1,A/Math.max(1,M))||.001;const T=S.totalNodes>0?(S.totalNodes-S.healthyNodes)/S.totalNodes:0,N=Math.min(1,S.pendingCompactions/100);n.utilization=Math.min(1,T*.7+N*.3),n.customMetrics={total_nodes:S.totalNodes,healthy_nodes:S.healthyNodes,total_keyspaces:S.totalKeyspaces,total_tables:S.totalTables,total_rows:S.totalRows,total_size_gb:S.totalSize/(1024*1024*1024),read_latency_ms:S.readLatency,write_latency_ms:S.writeLatency,read_ops_per_sec:S.readOperationsPerSecond,write_ops_per_sec:S.writeOperationsPerSecond,pending_compactions:S.pendingCompactions,read_consistency_violations:S.readConsistencyViolations,write_consistency_violations:S.writeConsistencyViolations,hinted_handoffs:S.hintedHandoffs};return}if(e.type==="clickhouse"){this.clickHouseRoutingEngines.has(e.id)||this.initializeClickHouseRoutingEngine(e);const y=this.clickHouseRoutingEngines.get(e.id),x=e.data.config;x&&y.syncFromConfig({cluster:x.cluster,replication:x.replication,tables:x.tables?.map(N=>({name:N.name,database:x.database||"default",engine:N.engine||"MergeTree",rows:N.rows||0,size:N.size||0,partitions:N.partitions||0,columns:N.columns||[]})),maxMemoryUsage:x.maxMemoryUsage,compression:x.compression});const S=y.getMetrics(),E=this.connections.filter(N=>N.target===e.id).reduce((N,D)=>{const q=this.metrics.get(D.source);return N+(q?.throughput||0)},0);n.throughput=Math.max(S.queriesPerSecond,E),n.latency=S.avgQueryTime;const M=S.memoryUsagePercent/100;n.errorRate=M>.95?.01:.001;const A=Math.min(1,S.activeQueries/10),T=M;n.utilization=Math.max(A,T),n.customMetrics={total_tables:S.totalTables,total_rows:S.totalRows,total_size_gb:S.totalSize/(1024*1024*1024),queries_per_sec:S.queriesPerSecond,read_rows_per_sec:S.readRowsPerSecond,written_rows_per_sec:S.writtenRowsPerSecond,avg_query_time_ms:S.avgQueryTime,active_queries:S.activeQueries,memory_usage_bytes:S.memoryUsage,memory_usage_percent:S.memoryUsagePercent,parts_count:S.partsCount,pending_merges:S.pendingMerges,compression_ratio:S.compressionRatio,cluster_nodes:S.clusterNodes,healthy_nodes:S.healthyNodes};return}if(e.type==="snowflake"){this.snowflakeRoutingEngines.has(e.id)||this.initializeSnowflakeRoutingEngine(e);const y=this.snowflakeRoutingEngines.get(e.id),x=e.data.config;x&&y.syncFromConfig({account:x.account,region:x.region,warehouses:x.warehouses,databases:x.databases,role:x.role,enableAutoSuspend:x.enableAutoSuspend,autoSuspendSeconds:x.autoSuspendSeconds,enableAutoResume:x.enableAutoResume});const S=y.getMetrics(),E=this.connections.filter(M=>M.target===e.id).reduce((M,A)=>{const T=this.metrics.get(A.source);return M+(T?.throughput||0)},0);n.throughput=Math.max(S.queriesPerSecond,E),n.latency=S.avgQueryTime,n.errorRate=.001,n.utilization=S.warehouseUtilization,n.customMetrics={total_warehouses:S.totalWarehouses,running_warehouses:S.runningWarehouses,suspended_warehouses:S.suspendedWarehouses,total_queries:S.totalQueries,running_queries:S.runningQueries,queued_queries:S.queuedQueries,queries_per_sec:S.queriesPerSecond,avg_query_time_ms:S.avgQueryTime,total_compute_time_sec:S.totalComputeTime,total_data_read:S.totalDataRead,total_data_written:S.totalDataWritten,cache_hit_rate:S.cacheHitRate,warehouse_utilization:S.warehouseUtilization,total_cost_credits:S.totalCost};return}if(e.type==="elasticsearch"){this.elasticsearchRoutingEngines.has(e.id)||this.initializeElasticsearchRoutingEngine(e);const y=this.elasticsearchRoutingEngines.get(e.id),x=e.data.config;x&&y.syncFromConfig({clusterName:x.clusterName,nodes:x.nodes,indices:x.indices,defaultShards:x.shards,defaultReplicas:x.replicas,refreshInterval:x.refreshInterval});const S=y.getMetrics(),E=this.connections.filter(D=>D.target===e.id).reduce((D,q)=>{const P=this.metrics.get(q.source);return D+(P?.throughput||0)},0);n.throughput=Math.max(S.indexOperationsPerSecond+S.searchOperationsPerSecond,E);const M=S.indexOperationsPerSecond+S.searchOperationsPerSecond;if(M>0){const D=S.indexOperationsPerSecond/M,q=S.searchOperationsPerSecond/M;n.latency=S.averageIndexLatency*D+S.averageSearchLatency*q}else n.latency=S.averageSearchLatency||10;const A=S.clusterHealth==="red"?.01:S.clusterHealth==="yellow"?.002:.001;n.errorRate=A;const T=S.unassignedShards>0?1:S.relocatingShards>0?.7:S.initializingShards>0?.5:.3,N=S.healthyNodes/S.totalNodes;n.utilization=Math.max(T,1-N),this.updateElasticsearchMetricsInConfig(e,S),n.customMetrics={cluster_health:S.clusterHealth==="green"?1:S.clusterHealth==="yellow"?.5:0,total_nodes:S.totalNodes,healthy_nodes:S.healthyNodes,total_indices:S.totalIndices,total_docs:S.totalDocs,total_size_gb:S.totalSize/(1024*1024*1024),active_shards:S.activeShards,relocating_shards:S.relocatingShards,initializing_shards:S.initializingShards,unassigned_shards:S.unassignedShards,index_ops_per_sec:S.indexOperationsPerSecond,search_ops_per_sec:S.searchOperationsPerSecond,avg_index_latency_ms:S.averageIndexLatency,avg_search_latency_ms:S.averageSearchLatency,avg_get_latency_ms:S.averageGetLatency};return}if(e.type==="s3-datalake"){this.s3RoutingEngines.has(e.id)||this.initializeS3RoutingEngine(e);const y=this.s3RoutingEngines.get(e.id);if(y.processLifecycleTransitions(),!o){n.throughput=0,n.latency=50,n.errorRate=0;const Z=y.getAllBucketMetrics(),te=y.getTotalStorageSize(),le=y.getTotalObjectCount(),ue=1024*1024*1024*1024,z=Z.size,j=ue*z;n.utilization=j>0?Math.min(1,te/j):0,n.customMetrics={buckets:z,total_objects:le,total_size:te,total_size_mb:Math.round(te/(1024*1024)*100)/100},this.updateS3BucketMetricsInConfig(e,Z);return}const x=this.connections.filter(Z=>Z.target===e.id);let S=0,C=0;for(const Z of x){const te=this.connectionMetrics.get(Z.id);te&&(S+=te.traffic/1024,C+=te.traffic)}const E=1024*1024,M=C>0?C/E:0;n.throughput=Math.max(0,M),n.latency=50+(M>100?(M-100)*.1:0),n.errorRate=.001;const A=y.getAllBucketMetrics(),T=y.getTotalStorageSize(),N=y.getTotalObjectCount(),D=A.size,P=1024*1024*1024*1024*D,H=P>0?Math.min(1,T/P):0,se=3500*D,ce=se>0?Math.min(1,M/se):0;n.utilization=Math.max(H,ce),n.customMetrics={buckets:D,total_objects:N,total_size:T,total_size_mb:Math.round(T/(1024*1024)*100)/100,total_size_gb:Math.round(T/(1024*1024*1024)*100)/100,estimated_ops_per_sec:Math.round(M*100)/100,storage_utilization:Math.round(H*1e3)/10,ops_utilization:Math.round(ce*1e3)/10},this.updateS3BucketMetricsInConfig(e,A);return}let u=t.indexCount||5;e.type==="mongodb"&&(u=(e.data.config?.collections||[]).reduce((S,C)=>S+(C.indexes?.length||0),0),u===0&&(u=1));const p=this.connections.filter(y=>y.target===e.id).reduce((y,x)=>{const S=this.metrics.get(x.source);return y+(S?.throughput||0)},0),g=Math.min(i,Math.floor(p/10)||Math.floor(i*.3));n.throughput=g*(1e3/(l+Math.random()*20));const m=Math.min(.3,u*.02);if(n.latency=l+g/i*50*(1-m),n.errorRate=.001,n.utilization=g/i,n.customMetrics={active_connections:g,max_connections:i,indexes:u,cache_hit_ratio:Math.random()*.8+.2},e.type==="mongodb"){const y=e.data.config,x=y?.collections||[],S=x.filter(T=>T.validation&&T.validation.validationLevel!=="off").length;if(S>0){const T=Math.min(.05,S*.01);n.errorRate=Math.max(n.errorRate,T)}const C=y?.enableReplicaSet||!1,E=y?.replicaSetMembers||[];if(C&&E.length>1){const T=E.length,N=Math.min(.3,(T-1)*.1);n.errorRate=Math.max(0,n.errorRate*(1-N)),n.latency=n.latency*(1+.05*(T-1))}const M=y?.enableSharding||!1,A=y?.shardConfig;if(M&&A?.shards){const T=A.shards.length,N=1+(T-1)*.3;n.throughput=n.throughput*N,n.latency=n.latency*(1+.02*(T-1))}n.customMetrics={...n.customMetrics,collections:x.length,collections_with_validation:S,total_documents:x.reduce((T,N)=>T+(N.documentCount||0),0),replica_set_enabled:C,replica_members:C?E.length:0,sharding_enabled:M,shard_count:M&&A?.shards?.length||0}}}simulateNginx(e,t,n,o){if(!o){n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=0;return}const i=t.workerThreads||4,l=t.requestsPerSecond||1e4,u=.5*Math.sin(this.simulationTime/2e3)+.5;n.throughput=l*u,n.latency=1+(1-u)*4,n.errorRate=1e-5,n.utilization=Math.min(1,n.throughput/l*(i/4)),n.customMetrics={worker_threads:i,active_connections:Math.floor(n.throughput*.1),cache_hits:Math.floor(Math.random()*1e4),cache_misses:Math.floor(Math.random()*1e3)}}simulateInfrastructure(e,t,n,o){if(!o){n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=0;return}const i=t.workerThreads||1;n.throughput=100*i+Math.random()*50,n.latency=50+Math.random()*100,n.errorRate=1e-4,n.utilization=Math.random()*.8,n.customMetrics={replicas:i,cpu_percent:Math.random()*80,memory_percent:Math.random()*70}}simulateAPI(e,t,n,o){if(!o){n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=0;return}const i=t.requestsPerSecond||100,l=t.responseLatency||50,u=Math.sin(this.simulationTime/1500)*.1+1;n.throughput=i*u,n.latency=l+Math.random()*30,n.errorRate=.005,n.utilization=n.throughput/i*Math.random(),n.customMetrics={rps:i,p50_latency:Math.round(l*.5),p99_latency:Math.round(l*2),errors:Math.round(n.throughput*n.errorRate)}}simulateKong(e,t,n,o){if(!o){n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=0;return}const i=this.kongRoutingEngines.get(e.id);if(!i){this.simulateAPI(e,t,n,o);return}const l=t||{},u=l.requestsPerSecond||t.requestsPerSecond||450,f=i.getStats(),p=.5*Math.sin(this.simulationTime/2e3)+.5;let g=u*p;const m=(l.plugins||[]).filter(M=>M.name==="rate-limiting"&&M.enabled);if(m.length>0){const M=Math.min(...m.map(A=>A.config?.minute||1e3));g=Math.min(g,M*p)}n.throughput=g;const y=2+Math.random()*3,x=f.plugins*.5,S=10+Math.random()*40;n.latency=y+x+S;const C=.001,E=f.consumers>0?.02:0;n.errorRate=Math.min(1,C+E),n.utilization=Math.min(1,n.throughput/u),n.customMetrics={services:f.services,routes:f.routes,upstreams:f.upstreams,consumers:f.consumers,plugins:f.plugins,requests_per_second:u,gateway_latency:y+x,upstream_latency:S}}simulateApigee(e,t,n,o){if(!o){n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=0;return}const i=this.apigeeRoutingEngines.get(e.id);if(!i){this.simulateAPI(e,t,n,o);return}const l=t||{},u=l.proxies||[],f=l.requestsPerSecond||t.requestsPerSecond||500,p=i.getStats(),g=.5*Math.sin(this.simulationTime/2e3)+.5;let m=f*g;const y=u.filter(T=>T.status!=="undeployed");if(y.length>0){const T=y.filter(D=>D.quota&&D.quotaInterval).map(D=>D.quota/D.quotaInterval*g);if(T.length>0){const D=Math.min(...T);m=Math.min(m,D)}const N=y.filter(D=>D.spikeArrest&&D.spikeArrest>0).map(D=>D.spikeArrest);if(N.length>0){const D=Math.min(...N);m=Math.min(m,D*g)}}n.throughput=m;const x=3+Math.random()*2,S=p.policies*.8,C=15+Math.random()*35;n.latency=x+S+C;const E=.001,M=p.policies>0?.015:0,A=p.totalErrors>0?p.totalErrors/Math.max(p.totalRequests,1)*.1:0;n.errorRate=Math.min(1,E+M+A),n.utilization=Math.min(1,n.throughput/f),n.customMetrics={proxies:p.proxies,policies:p.policies,total_requests:p.totalRequests,total_errors:p.totalErrors,avg_latency:Math.round(p.avgLatency),requests_per_second:f,gateway_latency:x+S,upstream_latency:C}}simulateMuleSoft(e,t,n,o){if(!o){n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=0;return}const i=this.mulesoftRoutingEngines.get(e.id);if(!i){this.simulateAPI(e,t,n,o);return}const u=(t||{}).applications||[],f=i.getStats(),p=.5*Math.sin(this.simulationTime/2e3)+.5;let g=0,m=0;for(const D of u)if(D.status==="running"){const q=D.workerCount||2;m+=q,g+=q*75}g===0&&(g=100);let y=g*p;n.throughput=y;const x=5+Math.random()*10,S=f.enabledConnectors*2,C=3+Math.random()*5,E=15+Math.random()*25;n.latency=x+S+C+E;const M=.002,A=f.totalErrors>0?f.totalErrors/Math.max(f.totalRequests,1)*.15:0,T=f.runningApplications>0?.005:.01;n.errorRate=Math.min(1,M+A+T);const N=m>0?Math.min(1,n.throughput/(m*75)):.5;n.utilization=Math.min(1,N),n.customMetrics={applications:f.applications,running_applications:f.runningApplications,connectors:f.connectors,enabled_connectors:f.enabledConnectors,total_requests:f.totalRequests,total_errors:f.totalErrors,avg_latency:Math.round(f.avgLatency),total_workers:m,runtime_latency:x,connector_latency:E,transformation_latency:C}}simulateGrafana(e,t,n,o){const i=this.grafanaEngines.get(e.id);if(!i){n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=.1;return}const l=i.getGrafanaMetrics(),u=i.calculateLoad();n.throughput=u.queriesPerSecond+u.alertEvaluationsPerSecond,n.latency=u.averageQueryLatency+u.averageRenderingLatency,n.errorRate=u.errorRate,n.utilization=(u.cpuUtilization+u.memoryUtilization)/2,n.customMetrics={queries_per_second:u.queriesPerSecond,dashboard_refreshes_per_second:u.dashboardRefreshesPerSecond,alert_evaluations_per_second:u.alertEvaluationsPerSecond,average_query_latency:u.averageQueryLatency,average_rendering_latency:u.averageRenderingLatency,datasource_errors:l.datasourceErrors,active_dashboards:l.activeDashboards,active_panels:l.activePanels,total_queries:l.totalQueries,cpu_utilization:u.cpuUtilization,memory_utilization:u.memoryUtilization}}simulatePrometheus(e,t,n,o){const i=this.prometheusEngines.get(e.id);if(!i){n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=.1;return}const l=i.getPrometheusMetrics(),u=i.calculateLoad();n.throughput=u.scrapeRequestsPerSecond,n.latency=u.averageScrapeDuration,n.errorRate=u.errorRate;const f=i.getTargetStatuses().length,p=Math.min(.95,.1+f/100*.5+u.scrapeRequestsPerSecond/10*.2);n.utilization=p,n.customMetrics={scrape_requests_total:l.scrapeRequestsTotal,scrape_errors_total:l.scrapeErrorsTotal,targets_up:l.targetsUp,targets_down:l.targetsDown,samples_scraped:l.samplesScraped,scrape_requests_per_second:u.scrapeRequestsPerSecond,samples_per_second:u.samplesPerSecond}}simulateLoki(e,t,n,o){if(!this.lokiEngines.has(e.id)){const m=new _T;m.initializeConfig(e),this.lokiEngines.set(e.id,m)}const i=this.lokiEngines.get(e.id);o&&this.processLokiIngestion(e,i);const l=i.getLokiMetrics(),u=i.calculateLoad();n.throughput=u.ingestionLinesPerSecond+u.queriesPerSecond;const f=u.ingestionLinesPerSecond/(u.ingestionLinesPerSecond+u.queriesPerSecond||1),p=1-f;n.latency=u.averageIngestionLatency*f+u.averageQueryLatency*p,n.errorRate=u.ingestionErrorRate*f+u.queryErrorRate*p;const g=Math.min(1,u.streamCount/(t.maxStreams||1e4));n.utilization=Math.max(u.storageUtilization,g),n.customMetrics={ingestion_lines_per_second:u.ingestionLinesPerSecond,ingestion_bytes_per_second:u.ingestionBytesPerSecond,ingestion_requests_total:l.ingestionRequestsTotal,ingestion_errors_total:l.ingestionErrorsTotal,ingestion_lines_total:l.ingestionLinesTotal,ingestion_bytes_total:l.ingestionBytesTotal,queries_per_second:u.queriesPerSecond,query_requests_total:l.queryRequestsTotal,query_errors_total:l.queryErrorsTotal,average_query_latency:u.averageQueryLatency,average_ingestion_latency:u.averageIngestionLatency,active_streams:u.streamCount,total_storage_size:l.totalStorageSize,storage_utilization:u.storageUtilization,retention_deletions:l.retentionDeletions}}processLokiIngestion(e,t){const n=this.connections.filter(o=>o.target===e.id);for(const o of n){const i=this.nodes.find(g=>g.id===o.source);if(!i)continue;const l=this.connectionMetrics.get(o.id);if(!l||l.traffic===0)continue;const f=l.traffic/200,p=this.generateLogsFromComponent(i,f);p.length>0&&t.processIngestion(p,i.id)}}generateLogsFromComponent(e,t){const n=[],o=e.type,i=e.data.label||e.id,l={app:i.toLowerCase().replace(/\s+/g,"-"),component:o,source:e.id.slice(0,8)},u=this.metrics.get(e.id),f=Math.ceil(t/100),p=Math.floor(t/f)||1;for(let g=0;g<f&&g<10;g++){const m=[];for(let y=0;y<p;y++){const x=Date.now()*1e6+y,S=this.getLogLevel(u),C=this.generateLogMessage(o,i,S,u);m.push([x.toString(),C])}m.length>0&&n.push({stream:{...l,level:this.getLogLevel(u)},values:m})}return n}getLogLevel(e){return e?e.errorRate>.1?"error":e.errorRate>.05||e.utilization>.9?"warn":"info":"info"}generateLogMessage(e,t,n,o){const i=new Date().toISOString();return n==="error"&&o?`[${i}] ERROR ${e}: Request failed, error rate: ${(o.errorRate*100).toFixed(2)}%`:n==="warn"&&o?`[${i}] WARN ${e}: High utilization: ${(o.utilization*100).toFixed(2)}%`:`[${i}] INFO ${e}: ${t} processing requests, throughput: ${o?.throughput.toFixed(2)||0}/s`}simulateBFF(e,t,n,o){if(!o){n.throughput=0,n.latency=0,n.errorRate=0,n.utilization=0;return}const i=this.bffRoutingEngines.get(e.id);if(!i){this.simulateAPI(e,t,n,o);return}const l=t||{},u=l.endpoints||[],f=l.backends||[],p=this.connections.filter(J=>J.target===e.id);let g=0;for(const J of p){const se=this.connectionMetrics.get(J.id);if(se){const Z=se.traffic/2048;g+=Z}}const m=t.requestsPerSecond||g||100,y=i.getStats(),x=.3*Math.sin(this.simulationTime/2e3)+.7;n.throughput=m*x;let S=y.averageLatency||100;const C=5+Math.random()*10,E=y.cacheHitRate||0,M=E*.8,A=S*(1-M)+C;n.latency=A+Math.random()*20;const T=y.totalRequests>0?y.totalErrors/y.totalRequests:.005,N=.001;n.errorRate=Math.min(1,T+N);const D=l.maxConcurrentRequests||100,q=n.throughput*(n.latency/1e3);n.utilization=Math.min(1,q/D);const P=u.reduce((J,se)=>J+(se.requests||0),0),H=f.filter(J=>J.status==="connected").length;n.customMetrics={endpoints:u.length,backends:f.length,connected_backends:H,total_requests:y.totalRequests,total_errors:y.totalErrors,avg_latency:Math.round(y.averageLatency),cache_hit_rate:Math.round(E*100)/100,endpoint_requests:P,aggregation_overhead:Math.round(C),concurrent_requests:Math.round(q)}}initializeKongRoutingEngine(e){const t=e.data.config||{},n=new lT;n.initialize({services:t.services||[],routes:t.routes||[],upstreams:t.upstreams||[],consumers:t.consumers||[],plugins:t.plugins||[]}),this.kongRoutingEngines.set(e.id,n)}initializeApigeeRoutingEngine(e){const t=e.data.config||{},n=new uT;n.initialize({organization:t.organization,environment:t.environment,proxies:t.proxies||[],policies:t.policies||[]}),this.apigeeRoutingEngines.set(e.id,n)}initializeMuleSoftRoutingEngine(e){const t=e.data.config||{},n=new dT,o=(t.applications||[]).map(l=>({name:l.name,runtimeVersion:l.runtimeVersion||"4.6.0",workerCount:l.workerCount||2,status:l.status||"stopped",connectors:l.connectors||[],errorStrategy:l.errorStrategy||"continue",reconnectionStrategy:l.reconnectionStrategy||"exponential",auditLogging:l.auditLogging||!1,flows:l.flows||[]})),i=(t.connectors||[]).map(l=>({name:l.name,type:l.type||"api",enabled:l.enabled!==!1,config:l.config||{},targetComponentType:l.targetComponentType,targetComponentId:l.targetComponentId}));n.initialize({organization:t.organization,environment:t.environment,applications:o,connectors:i}),this.mulesoftRoutingEngines.set(e.id,n)}initializeGraphQLGatewayRoutingEngine(e){const t=e.data.config||{},n=new xT;n.initialize({services:t.services||[],federation:t.federation,cacheTtl:t.cacheTtl,persistQueries:t.persistQueries,subscriptions:t.subscriptions,enableIntrospection:t.enableIntrospection,enableQueryComplexityAnalysis:t.enableQueryComplexityAnalysis,enableRateLimiting:t.enableRateLimiting,maxQueryDepth:t.maxQueryDepth,maxQueryComplexity:t.maxQueryComplexity,endpoint:t.endpoint}),this.graphQLGatewayRoutingEngines.set(e.id,n),this.lastGraphQLGatewayUpdate.set(e.id,Date.now())}initializeBFFRoutingEngine(e){const t=e.data.config||{},n=new wT;let o=null,i="";if(t.cacheMode==="redis"){const l=this.connections.find(u=>(u.source===e.id||u.target===e.id)&&this.nodes.find(f=>f.id===(u.source===e.id?u.target:u.source))?.type==="redis");if(l){const u=this.nodes.find(f=>f.id===(l.source===e.id?l.target:l.source));u&&u.type==="redis"&&(this.redisRoutingEngines.has(u.id)||this.initializeRedisRoutingEngine(u),o=this.redisRoutingEngines.get(u.id),i=u.id)}}n.initialize({backends:t.backends||[],endpoints:t.endpoints||[],enableCaching:t.enableCaching??!0,enableRequestBatching:t.enableRequestBatching??!1,enableResponseCompression:t.enableResponseCompression??!0,defaultTimeout:t.defaultTimeout||5e3,maxConcurrentRequests:t.maxConcurrentRequests||100,cacheMode:t.cacheMode||"memory",cacheTtl:t.cacheTtl||5,fallbackEnabled:t.fallbackEnabled??!0,fallbackComponent:t.fallbackComponent,redisEngine:o||void 0,redisNodeId:i||void 0}),this.bffRoutingEngines.set(e.id,n)}initializeWebhookRelayRoutingEngine(e){const t=e.data.config||{},n=new ST;n.initialize({relays:t.relays||[],enableRetryOnFailure:t.enableRetryOnFailure??!0,enableSignatureVerification:t.enableSignatureVerification??!0,enableRequestLogging:t.enableRequestLogging??!0,maxRetryAttempts:t.maxRetryAttempts||3,retryDelay:t.retryDelay||5,timeout:t.timeout||30}),this.webhookRelayRoutingEngines.set(e.id,n)}initializeRedisRoutingEngine(e){const t=e.data.config||{},n=new CT;n.initialize({host:t.host||"localhost",port:t.port||6379,password:t.password||"",database:t.database||0,maxMemory:t.maxMemory||"256mb",maxMemoryPolicy:t.maxMemoryPolicy||"noeviction",enablePersistence:t.enablePersistence??!0,persistenceType:t.persistenceType||"rdb",enableCluster:t.enableCluster??!1,clusterNodes:t.clusterNodes||[],keys:t.keys||[]}),this.redisRoutingEngines.set(e.id,n)}initializeCassandraRoutingEngine(e){const t=e.data.config||{},n=new MT;n.initialize({clusterName:t.clusterName||"archiphoenix-cluster",nodes:t.nodes||[],keyspaces:t.keyspaces||[],tables:t.tables||[],defaultConsistencyLevel:t.consistencyLevel||"QUORUM",defaultReplicationFactor:t.replicationFactor||3,datacenter:t.datacenter||"dc1"}),this.cassandraRoutingEngines.set(e.id,n)}initializeClickHouseRoutingEngine(e){const t=e.data.config||{},n=new ET;n.initialize({cluster:t.cluster||"archiphoenix-cluster",replication:t.replication||!1,tables:t.tables?.map(o=>({name:o.name,database:t.database||"default",engine:o.engine||"MergeTree",rows:o.rows||0,size:o.size||0,partitions:o.partitions||0,columns:o.columns||[]}))||[],maxMemoryUsage:t.maxMemoryUsage||10*1024*1024*1024,compression:t.compression||"LZ4"}),this.clickHouseRoutingEngines.set(e.id,n)}initializeSnowflakeRoutingEngine(e){const t=e.data.config||{},n=new RT;n.initialize({account:t.account||"archiphoenix",region:t.region||"us-east-1",warehouses:t.warehouses?.map(o=>({name:o.name,size:o.size||"Small",status:o.status||"suspended",autoSuspend:o.autoSuspend||(t.enableAutoSuspend?t.autoSuspendSeconds:void 0),autoResume:o.autoResume!==void 0?o.autoResume:t.enableAutoResume!==!1,minClusterCount:o.minClusterCount||1,maxClusterCount:o.maxClusterCount||1,currentClusterCount:o.minClusterCount||1,runningQueries:0,queuedQueries:0,totalQueriesExecuted:0,totalComputeTime:0}))||[],databases:t.databases?.map(o=>({name:o.name,comment:o.comment,retentionTime:o.retentionTime,size:o.size,schemas:o.schemas?.map(i=>({name:i.name,tables:i.tables||[],views:i.views||0,functions:i.functions||0}))||[]}))||[],role:t.role||"ACCOUNTADMIN",enableAutoSuspend:t.enableAutoSuspend,autoSuspendSeconds:t.autoSuspendSeconds,enableAutoResume:t.enableAutoResume}),this.snowflakeRoutingEngines.set(e.id,n)}initializeElasticsearchRoutingEngine(e){const t=e.data.config||{},n=new TT;n.initialize({clusterName:t.clusterName||"archiphoenix-cluster",nodes:t.nodes||["localhost:9200"],indices:t.indices||[],defaultShards:t.shards||5,defaultReplicas:t.replicas||1,refreshInterval:t.refreshInterval||"1s",enableSSL:t.enableSSL??!1,enableAuth:t.enableAuth??!1,username:t.username||"elastic",password:t.password||""}),this.elasticsearchRoutingEngines.set(e.id,n)}initializeS3RoutingEngine(e){const t=e.data.config||{},n=new AT,o=(t.buckets||[]).map(i=>({name:i.name,region:i.region||t.defaultRegion||"us-east-1",versioning:i.versioning||!1,encryption:i.encryption||"AES256",lifecycleEnabled:i.lifecycleEnabled||!1,lifecycleDays:i.lifecycleDays,glacierEnabled:i.glacierEnabled||!1,glacierDays:i.glacierDays,publicAccess:i.publicAccess||!1,lifecycleRules:t.lifecycleRules||[]}));n.initialize({buckets:o,defaultRegion:t.defaultRegion||"us-east-1"}),this.s3RoutingEngines.set(e.id,n)}initializePrometheusEngine(e){const t=new DT;t.initializeConfig(e),this.prometheusEngines.set(e.id,t)}initializeGrafanaEngine(e){const t=new jT;t.initializeConfig(e),this.grafanaEngines.set(e.id,t)}initializeJaegerEngine(e){const t=new zT;t.initializeConfig(e),this.jaegerEngines.set(e.id,t)}createLokiQueryExecutor(e){const o=((e.data.config||{}).datasources||[]).find(f=>typeof f=="string"?!1:f.type==="loki");if(!o||typeof o=="string")return;const i=o.url||"",l=this.nodes.find(f=>f.type!=="loki"?!1:((f.data.config||{}).serverUrl||"http://loki:3100")===i||i.includes(f.id)||i.includes(f.data.label||""));if(!l)return;const u=this.lokiEngines.get(l.id);if(u)return(f,p,g,m)=>{const y=u.executeQuery(f,p,g,m);return{success:y.success,latency:y.latency,resultsCount:y.resultsCount,error:y.error}}}isPrometheusAvailableForGrafana(e){const t=this.connections.find(l=>l.source===e.id&&this.nodes.find(u=>u.id===l.target)?.type==="prometheus");if(!t)return!1;const n=this.nodes.find(l=>l.id===t.target);if(!n||!this.prometheusEngines.get(n.id))return!1;const i=this.metrics.get(n.id);return!(i&&i.errorRate>.5)}initializePostgreSQLConnectionPool(e){const t=e.data.config||{},n={maxConnections:t.maxConnections||100,minConnections:t.minConnections||0,idleTimeout:t.idleTimeout||3e5,maxLifetime:t.maxLifetime||36e5,connectionTimeout:t.connectionTimeout||5e3},o=new NT(n);this.postgresConnectionPools.set(e.id,o)}updateElasticsearchMetricsInConfig(e,t){const n=e.data.config||{};n.clusterHealth=t.clusterHealth,n.activeShards=t.activeShards,n.relocatingShards=t.relocatingShards,n.initializingShards=t.initializingShards;const o=n.indices||[],i=this.elasticsearchRoutingEngines.get(e.id)?.getIndices()||[];for(let l=0;l<o.length;l++){const u=o[l],f=i.find(p=>p.name===u.name);f&&(o[l]={...u,docs:f.docs,size:f.size,health:f.health})}n.indices=o,n.totalDocs=t.totalDocs,n.totalSize=t.totalSize}updateS3BucketMetricsInConfig(e,t){const n=e.data.config||{},o=n.buckets||[];for(let i=0;i<o.length;i++){const l=o[i],u=t.get(l.name);u&&(o[i]={...l,objectCount:u.objectCount,totalSize:u.totalSize})}n.buckets=o}calculateConnectionLatency(e,t,n){const i={sync:5,async:2,http:10,grpc:5,websocket:3}[e.type]||10,l=t.latency||0,u=n.latency||0,f=e.data||{},p=f.latencyMs||0,g=(f.jitterMs||0)*(Math.random()-.5),m=2+Math.random()*8+p+g;return i+(l+u)/2+m}calculateCacheHitRatio(e,t){let n=.95;t>0&&t<100?n=.9+Math.random()*.05:t>=100&&t<1e3?n=.95+Math.random()*.04:t>=1e3&&(n=.92+Math.random()*.05);const o=Math.sin(this.simulationTime/1e4)*.02;return Math.max(.85,Math.min(.99,n+o))}createDefaultMetrics(e,t){return{id:e,type:t,throughput:0,latency:0,errorRate:0,utilization:0,timestamp:Date.now()}}createDefaultConnectionMetrics(e){return{id:e.id,source:e.source,target:e.target,traffic:0,latency:0,errorRate:0,utilization:0,timestamp:Date.now(),throughputDependency:0,backpressure:0,bottleneck:!1,effectiveThroughput:0,congestion:0}}initializeMetrics(){this.metrics.clear(),this.connectionMetrics.clear(),this.latencyHistory.clear(),this.connectionLatencyHistory.clear();for(const e of this.nodes)this.metrics.set(e.id,this.createDefaultMetrics(e.id,e.type))}getComponentMetrics(e){return this.metrics.get(e)}getRabbitMQRoutingEngine(e){return this.rabbitMQRoutingEngines.get(e)}getActiveMQRoutingEngine(e){return this.activeMQRoutingEngines.get(e)}getSQSRoutingEngine(e){return this.sqsRoutingEngines.get(e)}getAzureServiceBusRoutingEngine(e){return this.azureServiceBusRoutingEngines.get(e)}getPubSubRoutingEngine(e){return this.pubSubRoutingEngines.get(e)}getRedisRoutingEngine(e){return this.redisRoutingEngines.get(e)}getCassandraRoutingEngine(e){return this.cassandraRoutingEngines.get(e)}getClickHouseRoutingEngine(e){return this.clickHouseRoutingEngines.get(e)}getSnowflakeRoutingEngine(e){return this.snowflakeRoutingEngines.get(e)}getElasticsearchRoutingEngine(e){return this.elasticsearchRoutingEngines.get(e)}getKongRoutingEngine(e){return this.kongRoutingEngines.get(e)}getApigeeRoutingEngine(e){return this.apigeeRoutingEngines.get(e)}getMuleSoftRoutingEngine(e){return this.mulesoftRoutingEngines.get(e)}getGraphQLGatewayRoutingEngine(e){return this.graphQLGatewayRoutingEngines.get(e)}getBFFRoutingEngine(e){return this.bffRoutingEngines.get(e)}getWebhookRelayRoutingEngine(e){return this.webhookRelayRoutingEngines.get(e)}getLokiEmulationEngine(e){return this.lokiEngines.get(e)}getJaegerEmulationEngine(e){return this.jaegerEngines.get(e)}getAllJaegerEngines(){return new Map(this.jaegerEngines)}checkSQSIAMPolicy(e,t,n,o){if(!e||e.length===0)return!0;const i=e.filter(f=>{const p=f.principal||"";if(p!==t&&p!=="*"&&!t.includes(p))return!1;const g=f.resource||"";let m=!1;if(g==="*"||g===n)m=!0;else if(g.endsWith("*")){const x=g.slice(0,-1);m=n.startsWith(x.replace(/.*:/,""))}else if(g.includes("sqs:")||g.includes("arn:aws:sqs")){const x=g.split(":").pop()||g.split("/").pop()||"";m=x===n||x==="*"||n.includes(x)}else m=n.includes(g)||g==="*";if(!m)return!1;const y=f.action||"";return!(y!==o&&y!=="*"&&!y.includes(o))});return i.length===0?!0:i.filter(f=>f.effect==="Deny").length>0?!1:(i.filter(f=>f.effect==="Allow").length>0,!0)}checkActiveMQACLPermissionPublic(e,t,n,o){return this.checkActiveMQACLPermission(e,t,n,o)}getConnectionMetrics(e){return this.connectionMetrics.get(e)}getAllComponentMetrics(){return Array.from(this.metrics.values())}getAllConnectionMetrics(){return Array.from(this.connectionMetrics.values())}getIsRunning(){return this.isRunning}getSimulationTime(){return this.simulationTime}}const We=new LT;function OT(r,e){let t=null;return function(...o){const i=()=>{t=null,r(...o)};t!==null&&clearTimeout(t),t=setTimeout(i,e)}}class PT{logLevel;logs=[];maxLogs=100;constructor(){this.logLevel=2}debug(e,t){this.log(0,e,void 0,t)}info(e,t){this.log(1,e,void 0,t)}warn(e,t,n){this.log(2,e,t,n)}error(e,t,n){this.log(3,e,t,n)}log(e,t,n,o){if(e<this.logLevel)return;const i={level:e,message:t,error:n,timestamp:Date.now(),context:o};this.logs.push(i),this.logs.length>this.maxLogs&&this.logs.shift();const l=`[${this.getLevelName(e)}] ${t}`,u=o?{...o,error:n}:n;switch(e){case 0:console.debug(l,u||"");break;case 1:console.info(l,u||"");break;case 2:console.warn(l,u||"");break;case 3:console.error(l,u||"");break}}getLevelName(e){switch(e){case 0:return"DEBUG";case 1:return"INFO";case 2:return"WARN";case 3:return"ERROR";default:return"UNKNOWN"}}getRecentLogs(e,t=50){let n=this.logs;return e!==void 0&&(n=this.logs.filter(o=>o.level>=e)),n.slice(-t)}clearLogs(){this.logs=[]}setLogLevel(e){this.logLevel=e}}const nb=new PT,sb=(r,e,t)=>nb.warn(r,e,t),ta=(r,e,t)=>nb.error(r,e,t),vl="archiphoenix_diagram",Lh=1,IT=500,qT=()=>{try{const r=localStorage.getItem(vl);if(!r)return null;const e=JSON.parse(r);return e.version!==Lh?(sb("Diagram version mismatch, using defaults"),null):e}catch(r){return ta("Failed to load diagram from storage",r instanceof Error?r:new Error(String(r))),null}},HT=(r,e="My Diagram")=>{try{const t={...r,version:Lh,name:e,createdAt:localStorage.getItem(`${vl}_createdAt`)||new Date().toISOString(),updatedAt:new Date().toISOString()};localStorage.setItem(vl,JSON.stringify(t)),localStorage.setItem(`${vl}_createdAt`,t.createdAt)}catch(t){ta("Failed to save diagram to storage",t instanceof Error?t:new Error(String(t)))}},ht=OT(HT,IT),UT=(r,e="diagram.json")=>{try{const t={...r,version:Lh,name:e.replace(".json",""),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},n=JSON.stringify(t,null,2),o=new Blob([n],{type:"application/json"}),i=URL.createObjectURL(o),l=document.createElement("a");l.href=i,l.download=e,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i)}catch(t){ta("Failed to export diagram",t instanceof Error?t:new Error(String(t)))}},$T=r=>new Promise(e=>{try{const t=new FileReader;t.onload=n=>{try{const o=n.target?.result,i=JSON.parse(o);if(!i.nodes||!i.connections||typeof i.zoom!="number"||!i.pan)throw new Error("Invalid diagram format");i.groups||(i.groups=[]),e(i)}catch(o){ta("Failed to parse diagram file",o instanceof Error?o:new Error(String(o))),e(null)}},t.readAsText(r)}catch(t){ta("Failed to import diagram",t instanceof Error?t:new Error(String(t))),e(null)}}),BT=50,Mi=Cs((r,e)=>({past:[],future:[],canUndo:!1,canRedo:!1,pushState:t=>{r(n=>{const o=[...n.past,t];return o.length>BT&&o.shift(),{past:o,future:[],canUndo:!0,canRedo:!1}})},undo:()=>{const{past:t,future:n}=e();if(t.length===0)return null;const o=t[t.length-1],i=t.slice(0,-1);return r({past:i,future:[o,...n],canUndo:i.length>0,canRedo:!0}),o},redo:()=>{const{past:t,future:n}=e();if(n.length===0)return null;const o=n[0],i=n.slice(1);return r({past:[...t,o],future:i,canUndo:!0,canRedo:i.length>0}),o},clearHistory:()=>{r({past:[],future:[],canUndo:!1,canRedo:!1})}}));class QT{rules=new Map;allRules=[];register(e){const t=e.sourceType;this.rules.has(t)||this.rules.set(t,[]);const n=this.rules.get(t);n&&(n.push(e),this.allRules.push(e),n.sort((o,i)=>(i.priority||0)-(o.priority||0)))}registerMany(e){e.forEach(t=>this.register(t))}findRules(e,t){const n=[],o=this.rules.get(e)||[];for(const l of o)(l.targetTypes==="*"||Array.isArray(l.targetTypes)&&l.targetTypes.includes(t))&&n.push(l);const i=this.rules.get("*")||[];for(const l of i)(l.targetTypes==="*"||Array.isArray(l.targetTypes)&&l.targetTypes.includes(t))&&n.push(l);return n.sort((l,u)=>(u.priority||0)-(l.priority||0))}getAllRules(){return[...this.allRules]}getRulesForSource(e){return this.rules.get(e)||[]}clear(){this.rules.clear(),this.allRules=[]}}const GT={postgres:5432,mongodb:27017,redis:6379,cassandra:9042,clickhouse:8123,elasticsearch:9200,rest:8080,grpc:50051,graphql:4e3,websocket:8080,webhook:8080,soap:8080,nginx:80,envoy:80,haproxy:80,traefik:80,docker:2375,kubernetes:6443,kafka:9092,rabbitmq:5672,activemq:61616,"aws-sqs":9324,prometheus:9090,grafana:3e3,loki:3100,jaeger:16686,keycloak:8080,"secrets-vault":8200,crm:8080,erp:8080,"payment-gateway":443},FT={"api-gateway":9100,postgres:9187,redis:9121,"service-mesh":15014,istio:15014,envoy:9901,cdn:9101,"aws-sqs":9102};class ab{getHost(e){return e.data.label?e.data.label.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):e.id.slice(0,8)}getPort(e,t){const n=e.data.config||{};switch(t){case"main":return n.port||n.host?.split(":")[1]||GT[e.type];case"metrics":return n.metricsPort||n.metrics?.port||FT[e.type];case"admin":return n.adminPort||n.admin?.port}}getEndpoint(e,t="main"){const n=this.getHost(e),o=this.getPort(e,t);if(!o)throw new Error(`Port not found for ${e.type}:${t}`);return`${n}:${o}`}getURL(e,t="main",n="http"){const o=this.getEndpoint(e,t);return`${n}://${o}`}getConnectionMetadata(e,t,n){const o=this.getHost(e),i=this.getHost(t),l=this.getPort(e,"main"),u=this.getPort(t,"main");let f="http";return n.type==="grpc"?f="grpc":n.type==="websocket"?f="websocket":t.type==="kafka"?f="kafka":t.type==="rabbitmq"||t.type==="activemq"?f="rabbitmq":n.type==="async"?f="async":n.type==="sync"&&(f="sync"),{protocol:f,sourceHost:o,targetHost:i,sourcePort:l,targetPort:u,endpoint:u?`${i}:${u}`:void 0}}getCapabilities(e){return{defaultPort:this.getPort(e,"main"),metricsPort:this.getPort(e,"metrics"),adminPort:this.getPort(e,"admin"),getHost:t=>this.getHost(t),getPort:(t,n)=>this.getPort(t,n)}}}class VT{registry;discovery;constructor(){this.registry=new QT,this.discovery=new ab}initialize(e){this.registry.registerMany(e)}handleConnectionCreated(e,t,n,o){const i=this.registry.findRules(e.type,t.type);if(i.length===0)return{sourceUpdated:!1,targetUpdated:!1};let l=!1,u=!1;const f=this.discovery.getConnectionMetadata(e,t,n);for(const p of i)try{const g=p.updateSourceConfig(e,t,n,f);if(g&&Object.keys(g).length>0&&(o(e.id,{data:{...e.data,config:{...e.data.config,...g}}}),l=!0),p.updateTargetConfig){const m=p.updateTargetConfig(e,t,n,f);m&&Object.keys(m).length>0&&(o(t.id,{data:{...t.data,config:{...t.data.config,...m}}}),u=!0)}}catch(g){ta(`Error applying rule for ${e.type} -> ${t.type}`,g instanceof Error?g:new Error(String(g)),{sourceType:e.type,targetType:t.type})}return{sourceUpdated:l,targetUpdated:u}}handleConnectionDeleted(e,t,n,o){const i=this.registry.findRules(e.type,t.type);if(i.length===0)return{sourceUpdated:!1,targetUpdated:!1};let l=!1,u=!1;const f=this.discovery.getConnectionMetadata(e,t,n);for(const p of i)try{if(p.cleanupSourceConfig){const g=p.cleanupSourceConfig(e,t,n,f);g&&Object.keys(g).length>0&&(o(e.id,{data:{...e.data,config:{...e.data.config,...g}}}),l=!0)}if(p.cleanupTargetConfig){const g=p.cleanupTargetConfig(e,t,n,f);g&&Object.keys(g).length>0&&(o(t.id,{data:{...t.data,config:{...t.data.config,...g}}}),u=!0)}}catch(g){ta(`Error cleaning up rule for ${e.type} -> ${t.type}`,g instanceof Error?g:new Error(String(g)),{sourceType:e.type,targetType:t.type})}return{sourceUpdated:l,targetUpdated:u}}getDiscovery(){return this.discovery}getRegistry(){return this.registry}}function KT(r){return{sourceType:"envoy",targetTypes:["rest","grpc","graphql","websocket","soap","webhook","postgres","mongodb","redis","cassandra","clickhouse","crm","erp","payment-gateway","bpmn-engine"],priority:10,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const l=(e.data.config||{}).clusters||[],u=l.find(m=>!m.hosts||!Array.isArray(m.hosts)?!1:m.hosts.some(y=>y.address===o.targetHost&&y.port===o.targetPort));if(u)return u.hosts.some(y=>y.address===o.targetHost&&y.port===o.targetPort)?null:{clusters:l.map(y=>y===u?{...y,hosts:[...y.hosts||[],{address:o.targetHost,port:o.targetPort}]}:y)};t.data.label||t.type;const f=`${t.type}-${t.id.slice(0,8)}-cluster`;let p="STRICT_DNS";o.protocol==="grpc"?p="STRICT_DNS":(t.type==="postgres"||t.type==="mongodb"||t.type==="redis")&&(p="STATIC_DNS");const g={name:f,type:p,hosts:[{address:o.targetHost,port:o.targetPort}],healthChecks:!0,connectTimeout:5e3,requests:0,errors:0};return{clusters:[...l,g],totalClusters:l.length+1}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function YT(r){return{sourceType:"api-gateway",targetTypes:["rest","grpc","graphql","websocket","soap","webhook"],priority:10,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const l=(e.data.config||{}).apis||[];if(l.find(C=>C.backendUrl===`http://${o.targetHost}:${o.targetPort}`||C.backendUrl===`https://${o.targetHost}:${o.targetPort}`))return null;const p=`${t.data.label||t.type}-api`,g=`/api/${t.type}`;let m="GET";t.type==="grpc"?m="POST":t.type==="websocket"&&(m="GET");const x=`${o.protocol==="grpc","http"}://${o.targetHost}:${o.targetPort}`,S={name:p,path:g,method:m,backendUrl:x,enabled:!0,requests:0,errors:0};return{apis:[...l,S]}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function XT(r){return{sourceType:"kong",targetTypes:["rest","grpc","graphql","websocket","soap","webhook"],priority:10,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const i=e.data.config||{},l=i.services||[],u=i.routes||[],p=`${o.protocol==="grpc","http"}://${o.targetHost}:${o.targetPort}`,m=`${t.data.label||t.type}-service`;let y=l.find(M=>M.name===m||M.url===p);y||(y={id:String(l.length+1),name:m,url:p,routes:0,enabled:!0},l.push(y));const x=`/api/${t.type}`;if(u.find(M=>M.service===y.name&&M.path===x))return null;let C="GET";t.type==="grpc"?C="POST":(t.type==="websocket"||t.type==="rest"||t.type==="graphql")&&(C="GET");const E={id:String(u.length+1),path:x,method:C,service:y.name,stripPath:!0,protocols:["http","https"]};return y.routes=(y.routes||0)+1,{services:l,routes:[...u,E]}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function WT(r){return{sourceType:"service-mesh",targetTypes:"*",priority:10,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const l=(e.data.config||{}).services||[];if(l.find(y=>y.host===o.targetHost&&y.port===o.targetPort))return null;const p=(t.data.label||t.type).toLowerCase().replace(/\s+/g,"-");let g="http";o.protocol==="grpc"?g="grpc":(t.type==="postgres"||t.type==="mongodb"||t.type==="redis")&&(g="tcp");const m={name:p,namespace:"default",host:o.targetHost,port:o.targetPort,protocol:g,enabled:!0};return{services:[...l,m]}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function ZT(r){return{sourceType:"istio",targetTypes:"*",priority:10,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const l=(e.data.config||{}).services||[];if(l.find(y=>y.host===o.targetHost&&y.port===o.targetPort))return null;const p=(t.data.label||t.type).toLowerCase().replace(/\s+/g,"-");let g="http";o.protocol==="grpc"?g="grpc":(t.type==="postgres"||t.type==="mongodb"||t.type==="redis")&&(g="tcp");const m={name:p,namespace:"default",host:o.targetHost,port:o.targetPort,protocol:g,enabled:!0};return{services:[...l,m]}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function JT(r){return{sourceType:"nginx",targetTypes:["rest","grpc","graphql","websocket","postgres","mongodb","redis","crm","erp","payment-gateway"],priority:10,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const l=(e.data.config||{}).upstreams||[],u=`${t.type}-upstream`;let f=l.find(g=>g.name===u);if(f)return f.servers?.some(m=>(m.host===o.targetHost||m.address===`${o.targetHost}:${o.targetPort}`)&&(m.port===o.targetPort||m.address?.includes(`:${o.targetPort}`)))?null:{upstreams:l.map(m=>m.name===u?{...m,servers:[...m.servers||[],{host:o.targetHost,port:o.targetPort}]}:m)};const p={name:u,servers:[{host:o.targetHost,port:o.targetPort}],loadBalancing:"round-robin"};return{upstreams:[...l,p]}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function eA(r){return{sourceType:"haproxy",targetTypes:["rest","grpc","graphql","websocket","postgres","mongodb","redis","crm","erp","payment-gateway"],priority:10,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const l=(e.data.config||{}).backends||[],u=`${t.type}-backend`;let f=l.find(g=>g.name===u);if(f)return f.servers?.some(m=>(m.host===o.targetHost||m.address===`${o.targetHost}:${o.targetPort}`)&&(m.port===o.targetPort||m.address?.includes(`:${o.targetPort}`)))?null:{backends:l.map(m=>m.name===u?{...m,servers:[...m.servers||[],{host:o.targetHost,port:o.targetPort}]}:m)};const p={name:u,servers:[{host:o.targetHost,port:o.targetPort}],balance:"roundrobin"};return{backends:[...l,p]}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function tA(r){return{sourceType:"traefik",targetTypes:["rest","grpc","graphql","websocket","postgres","mongodb","redis","crm","erp","payment-gateway"],priority:10,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const i=e.data.config||{},l=i.services||{},u=i.routers||{},f=`${t.type}-service`,p=`${t.type}-router`;if(l[f])return l[f].servers?.some(x=>x.url===`http://${o.targetHost}:${o.targetPort}`)?null:{services:{...l,[f]:{...l[f],servers:[...l[f].servers||[],{url:`http://${o.targetHost}:${o.targetPort}`}]}}};const m=`Host(\`${(t.data.label||t.type).toLowerCase()}.local\`)`;return{services:{...l,[f]:{loadBalancer:{servers:[{url:`http://${o.targetHost}:${o.targetPort}`}]}}},routers:{...u,[p]:{rule:m,service:f}}}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function nA(r){return{sourceType:"*",targetTypes:["postgres","mongodb","redis","cassandra","clickhouse","elasticsearch"],priority:5,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const i=e.data.config||{},l=t.type;let u={};switch(l){case"postgres":u={database:{host:o.targetHost,port:o.targetPort,database:i.database?.database||"postgres",username:i.database?.username||"postgres",password:i.database?.password||""}};break;case"mongodb":u={database:{connectionString:`mongodb://${o.targetHost}:${o.targetPort}`,database:i.database?.database||"admin"}};break;case"redis":u={database:{host:o.targetHost,port:o.targetPort,password:i.database?.password||""}};break;case"cassandra":u={database:{hosts:[`${o.targetHost}:${o.targetPort}`],keyspace:i.database?.keyspace||"system"}};break;case"clickhouse":u={database:{host:o.targetHost,port:o.targetPort,database:i.database?.database||"default"}};break;case"elasticsearch":u={database:{hosts:[`http://${o.targetHost}:${o.targetPort}`]}};break;default:return null}return u},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function sA(r){return{sourceType:"*",targetTypes:["kafka","rabbitmq","activemq","aws-sqs","azure-service-bus","gcp-pubsub"],priority:5,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const i=e.data.config||{},l=t.type;let u={};switch(l){case"kafka":u={messaging:{broker:`${o.targetHost}:${o.targetPort}`,topic:i.messaging?.topic||t.data.config?.defaultTopic||"default-topic",producerId:i.messaging?.producerId||e.id.slice(0,8)}};break;case"rabbitmq":u={messaging:{broker:`${o.targetHost}:${o.targetPort}`,exchange:i.messaging?.exchange||t.data.config?.defaultExchange||"amq.topic",routingKey:i.messaging?.routingKey||"default"}};break;case"activemq":const f=t.data.config?.queues||[],p=f.length>0&&typeof f[0]=="object"?f[0].name:f.length>0?f[0]:null;u={messaging:{broker:`${o.targetHost}:${o.targetPort}`,queue:i.messaging?.queue||p||"default-queue"}};break;case"aws-sqs":{const g=t.data.config?.queues||[],m=g.length>0&&typeof g[0]=="object"?g[0].name:g.length>0?g[0]:null,y=g.length>0&&typeof g[0]=="object"?g[0].region:t.data.config?.defaultRegion||"us-east-1";u={messaging:{queueUrl:`https://sqs.${y}.amazonaws.com/account/${m||"default-queue"}`,queueName:m||"default-queue",region:i.messaging?.region||y}};break}case"azure-service-bus":{const g=t.data.config||{},m=g.namespace||"archiphoenix.servicebus.windows.net";g.connectionString||`${m}`;const y=i.messaging?.entityType||g.entityType||"queue",x=i.messaging?.entityName||i.messaging?.queue||i.messaging?.topic||g.entityName||(y==="queue"?"events":"events-topic"),S=i.messaging?.subscriptionName||g.subscriptionName;u={messaging:{connectionString:g.connectionString||`Endpoint=sb://${m}/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=...`,namespace:m,entityType:y,queue:y==="queue"?x:void 0,topic:y==="topic"?x:void 0,subscriptionName:y==="topic"&&S?S:void 0}};break}case"gcp-pubsub":u={messaging:{projectId:i.messaging?.projectId||"default-project",topic:i.messaging?.topic||t.data.config?.defaultTopic||"default-topic"}};break;default:return null}return u},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function aA(r,e){const t=r.data.config||{};return t.metrics?.port?t.metrics.port:t.metricsPort?t.metricsPort:(r.type==="service-mesh"||r.type==="istio")&&t.metrics?.controlPlanePort?t.metrics.controlPlanePort:e.getPort(r,"metrics")}function oA(r){const e=r.data.config||{};return e.metrics?.path?e.metrics.path:e.metricsPath?e.metricsPath:r.type==="envoy"?e.metrics?.prometheusPath||"/stats/prometheus":"/metrics"}function $0(r){return r.data.label?r.data.label.toLowerCase().replace(/\s+/g,"-"):`${r.type}-${r.id.slice(0,8)}`}function B0(r,e){const t=e.getHost(r),n=aA(r,e);if(!n){const o=e.getPort(r,"main");return o?`${t}:${o}`:null}return`${t}:${n}`}function rA(r){return{sourceType:"*",targetTypes:["prometheus"],priority:5,updateTargetConfig:(e,t,n,o)=>{const i=t.data.config||{},l=i.scrape_configs||[],u=i.scrapeInterval||"15s",f=oA(e),p=B0(e,r);if(!p)return null;const g=$0(e),m={component:e.type,componentId:e.id},y=l.findIndex(S=>S.job_name===g);if(y>=0){const S=l[y];let C=!1;for(const E of S.static_configs||[]){if(E.targets&&E.targets.includes(p)){C=!0;break}if(E.labels?.componentId===e.id){E.targets.includes(p)||E.targets.push(p),C=!0;break}}if(!C){const E=[...l],M=[...S.static_configs||[]];return M.push({targets:[p],labels:m}),E[y]={...S,static_configs:M},{scrape_configs:E}}return null}const x={job_name:g,scrape_interval:u!=="15s"?u:void 0,metrics_path:f!=="/metrics"?f:void 0,static_configs:[{targets:[p],labels:m}]};return{scrape_configs:[...l,x]}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n),cleanupTargetConfig:(e,t,n,o)=>{const l=(t.data.config||{}).scrape_configs||[];if(!l||l.length===0)return null;const u=B0(e,r),f=$0(e),p=e.id;let g=!1;const m=l.map(y=>{if(y.job_name!==f)return y;const x=(y.static_configs||[]).map(S=>{if(S.labels?.componentId===p)return g=!0,null;if(u&&S.targets&&S.targets.includes(u)){const C=S.targets.filter(E=>E!==u);return C.length===0?(g=!0,null):(g=!0,{...S,targets:C})}return S}).filter(S=>S!==null);return x.length===0?(g=!0,null):{...y,static_configs:x}}).filter(y=>y!==null);return g?{scrape_configs:m}:null}}}function iA(r){return{sourceType:"grafana",targetTypes:["prometheus"],priority:10,updateSourceConfig:(e,t,n,o)=>{let l=(e.data.config||{}).datasources||[];l.length>0&&typeof l[0]=="string"&&(l=l.map(y=>({name:y,type:"prometheus",url:"http://localhost:9090",access:"proxy",isDefault:y===l[0]})));const u=r.getURL(t,"main"),f=o.targetHost||r.getHost(t),p=o.targetPort||r.getPort(t,"main")||9090,g=p===9090?`http://${f}:${p}`:u,m=l.findIndex(y=>y&&typeof y=="object"&&(y.type==="prometheus"||y.name?.toLowerCase().includes("prometheus")));if(m>=0){const y=[...l];return y[m]={...y[m],url:g,type:"prometheus",isDefault:y[m].isDefault??!0},{datasources:y}}else{const y={name:"Prometheus",type:"prometheus",url:g,access:"proxy",isDefault:l.length===0};return{datasources:[...l,y]}}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n),cleanupSourceConfig:(e,t,n,o)=>{let l=(e.data.config||{}).datasources||[];if(l.length>0&&typeof l[0]=="string")return null;const u=r.getURL(t,"main"),f=o.targetHost||r.getHost(t),p=o.targetPort||r.getPort(t,"main")||9090,g=p===9090?`http://${f}:${p}`:u,m=l.filter(y=>!(y&&typeof y=="object"&&y.url===g&&y.type==="prometheus"));return m.length!==l.length?{datasources:m}:null}}}function ob(r){const e=["postgres","mongodb","redis","cassandra","clickhouse","snowflake","elasticsearch"],t=["rest","grpc","graphql","soap","websocket","webhook"],n=["kafka","rabbitmq","activemq","aws-sqs","azure-service-bus","gcp-pubsub"],o=["s3-datalake"],i=["crm","erp","payment-gateway"];return e.includes(r)?"database":t.includes(r)?"api":n.includes(r)?"messaging":o.includes(r)?"file":i.includes(r)?"api":"custom"}function Tl(r,e,t){const n=t?r.label||r.type:e.label||e.type,o=t?r.id.slice(0,8):e.id.slice(0,8);return`${n}-${o}`.toLowerCase().replace(/\s+/g,"-")}function cA(r){return{sourceType:"*",targetTypes:["mulesoft"],priority:5,updateTargetConfig:(e,t,n,o)=>{const l=(t.data.config||{}).connectors||[];if(l.find(m=>m.targetComponentId===e.id||m.name===Tl(e,t,!0)))return null;const f=ob(e.type),g={name:Tl(e,t,!0),type:f,enabled:!0,config:{},targetComponentType:e.type,targetComponentId:e.id};return f==="database"&&o.targetHost&&o.targetPort?g.config={host:o.targetHost,port:o.targetPort}:f==="api"&&o.targetHost&&o.targetPort?g.config={baseUrl:`http://${o.targetHost}:${o.targetPort}`}:f==="messaging"&&(g.config={broker:o.targetHost&&o.targetPort?`${o.targetHost}:${o.targetPort}`:void 0}),{connectors:[...l,g]}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function lA(r){return{sourceType:"mulesoft",targetTypes:"*",priority:5,updateSourceConfig:(e,t,n,o)=>{const l=(e.data.config||{}).connectors||[];if(l.find(m=>m.targetComponentId===t.id||m.name===Tl(e,t,!1)))return null;const f=ob(t.type),g={name:Tl(e,t,!1),type:f,enabled:!0,config:{},targetComponentType:t.type,targetComponentId:t.id};return f==="database"&&o.targetHost&&o.targetPort?g.config={host:o.targetHost,port:o.targetPort}:f==="api"&&o.targetHost&&o.targetPort?g.config={baseUrl:`http://${o.targetHost}:${o.targetPort}`}:f==="messaging"&&o.targetHost&&o.targetPort&&(g.config={broker:`${o.targetHost}:${o.targetPort}`}),{connectors:[...l,g]}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function uA(r){return{sourceType:"graphql-gateway",targetTypes:["graphql"],priority:10,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const l=(e.data.config||{}).services||[],u=`http://${o.targetHost}:${o.targetPort}/graphql`;if(l.find(m=>m.endpoint===u||m.name===t.data.label))return null;const p=t.data.label||t.type,g={id:`svc-${l.length+1}`,name:p,endpoint:u,status:"connected",requests:0,errors:0};return{services:[...l,g]}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function dA(r){return{sourceType:"bff-service",targetTypes:["rest","grpc","graphql","websocket","soap","webhook"],priority:10,updateSourceConfig:(e,t,n,o)=>{if(!o.targetHost||!o.targetPort)return null;const l=(e.data.config||{}).backends||[],u=t.data.label||t.type;if(l.find(m=>m.name===u||m.endpoint===`http://${o.targetHost}:${o.targetPort}`||m.id===t.id))return null;let p="http";t.type==="grpc"?p="grpc":t.type==="graphql"&&(p="graphql");const g={id:t.id||`backend-${Date.now()}`,name:u,endpoint:`http://${o.targetHost}:${o.targetPort}`,protocol:p,status:"connected",timeout:5e3,retries:3,retryBackoff:"exponential",circuitBreaker:{enabled:!0,failureThreshold:5,successThreshold:2,timeout:6e4}};return{backends:[...l,g]}},extractMetadata:(e,t,n)=>r.getConnectionMetadata(e,t,n)}}function fA(r){return[KT(r),JT(r),eA(r),tA(r),YT(r),XT(r),uA(r),dA(r),WT(r),ZT(r),nA(r),sA(r),rA(r),iA(r),cA(r),lA(r)]}let $f=null;function Q0(){if(!$f){const r=new ab,e=new VT,t=fA(r);e.initialize(t),$f=e}return $f}const Fn=2e3,G0=140,F0=200,il=(r,e)=>({x:Math.floor(r/Fn),y:Math.floor(e/Fn)}),hA=(r,e,t,n,o,i)=>{const l=o*Fn,u=(o+1)*Fn,f=i*Fn,p=(i+1)*Fn,g=r,m=r+t,y=e,x=e+n;return!(m<l||g>u||x<f||y>p)},Bf=r=>{const e=new Set,t=G0+F0,n=G0+F0,o=r.position.x,i=o+t,l=r.position.y,u=l+n,f=il(o,l).x,p=il(i,u).x,g=il(o,l).y,m=il(i,u).y;for(let y=f;y<=p;y++)for(let x=g;x<=m;x++)hA(o,l,t,n,y,x)&&e.add(`${y},${x}`);return e},Bn=(r,e=[])=>{if(r.length===0)return[];const t=new Set,n=new Map(r.map(o=>[o.id,o]));return r.forEach(o=>{Bf(o).forEach(l=>t.add(l))}),e.forEach(o=>{const i=n.get(o.source),l=n.get(o.target);i&&Bf(i).forEach(f=>t.add(f)),l&&Bf(l).forEach(f=>t.add(f))}),Array.from(t).map(o=>{const[i,l]=o.split(",").map(Number);return{x:i,y:l}})},Qn=r=>{if(r.length===0)return{minX:0,minY:0,maxX:Fn,maxY:Fn};const e=r.map(u=>u.x),t=r.map(u=>u.y),n=Math.min(...e),o=Math.min(...t),i=Math.max(...e),l=Math.max(...t);return{minX:n*Fn,minY:o*Fn,maxX:(i+1)*Fn,maxY:(l+1)*Fn}},Qf={nodes:[],connections:[],groups:[],zoom:1,pan:{x:0,y:0}},Re=Cs((r,e)=>{const t=qT(),n=t?{...Qf,...t,groups:t.groups||[]}:Qf;let o=!1,i=!1;const l=()=>{const g=e();return{nodes:g.nodes,connections:g.connections,groups:g.groups||[],zoom:g.zoom,pan:g.pan}},u=()=>{Mi.getState().pushState(l())},f=Bn(n.nodes,n.connections||[]),p=Qn(f);return{...n,selectedNodeId:null,selectedConnectionId:null,diagramName:t?.name||"Untitled Diagram",viewportWidth:0,viewportHeight:0,canvasBounds:p,canvasChunks:f,getDiagramState:l,updateCanvasBounds:()=>r(g=>{const m=Bn(g.nodes,g.connections);return{canvasChunks:m,canvasBounds:Qn(m)}}),addNode:g=>r(m=>{u();const y=[...m.nodes,g],x=Bn(y,m.connections),S={nodes:y,canvasChunks:x,canvasBounds:Qn(x)};return ht({...m,...S},m.diagramName),S}),updateNode:(g,m,y=!1)=>r(x=>{!y&&!o&&u();const S=x.nodes.map(M=>M.id===g?{...M,...m}:M),C=Bn(S,x.connections),E={nodes:S,canvasChunks:C,canvasBounds:Qn(C)};return(!o||!y)&&ht({...x,...E},x.diagramName),E}),updateNodes:(g,m=!1)=>r(y=>{!m&&!o&&!i&&u();const x=new Map(g.map(M=>[M.id,M.updates])),S=y.nodes.map(M=>{const A=x.get(M.id);return A?{...M,...A}:M}),C=Bn(S,y.connections),E={nodes:S,canvasChunks:C,canvasBounds:Qn(C)};return(!i||!m)&&ht({...y,...E},y.diagramName),E}),deleteNode:g=>r(m=>{u();const y=m.nodes.filter(E=>E.id!==g),x=m.connections.filter(E=>E.source!==g&&E.target!==g),S=Bn(y,x),C={nodes:y,connections:x,selectedNodeId:m.selectedNodeId===g?null:m.selectedNodeId,canvasChunks:S,canvasBounds:Qn(S)};return ht({...m,...C},m.diagramName),C}),selectNode:(g,m=!1)=>r(y=>m&&g&&y.nodes.find(S=>S.id===g)?{selectedNodeId:g,nodes:y.nodes.map(S=>({...S,selected:S.id===g?!S.selected:S.selected||!1}))}:{selectedNodeId:g,nodes:y.nodes.map(x=>({...x,selected:x.id===g}))}),selectNodesByIds:g=>r(m=>({selectedNodeId:g.length>0?g[0]:null,nodes:m.nodes.map(y=>({...y,selected:g.includes(y.id)}))})),addConnection:g=>r(m=>{u();const y={...g,type:g.type||"async"},x=m.nodes.find(T=>T.id===y.source),S=m.nodes.find(T=>T.id===y.target);let C=[...m.nodes];if(x&&S){const T=Q0(),N=(D,q)=>{const P=C.findIndex(H=>H.id===D);P!==-1&&(C[P]={...C[P],...q})};T.handleConnectionCreated(x,S,y,N)}const E=[...m.connections,y],M=Bn(C,E),A={nodes:C,connections:E,canvasChunks:M,canvasBounds:Qn(M)};return ht({...m,...A},m.diagramName),A}),updateConnection:(g,m)=>r(y=>{u();const x={connections:y.connections.map(S=>S.id===g?{...S,...m}:S)};return ht({...y,...x},y.diagramName),x}),deleteConnection:g=>r(m=>{u();const y=m.connections.find(M=>M.id===g);let x=[...m.nodes];if(y){const M=m.nodes.find(T=>T.id===y.source),A=m.nodes.find(T=>T.id===y.target);if(M&&A){const T=Q0(),N=(D,q)=>{const P=x.findIndex(H=>H.id===D);P!==-1&&(x[P]={...x[P],...q})};T.handleConnectionDeleted(M,A,y,N)}}const S=m.connections.filter(M=>M.id!==g),C=Bn(x,S),E={nodes:x,connections:S,selectedConnectionId:m.selectedConnectionId===g?null:m.selectedConnectionId,canvasChunks:C,canvasBounds:Qn(C)};return ht({...m,...E},m.diagramName),E}),selectConnection:g=>r(m=>({selectedConnectionId:g,selectedNodeId:null,selectedGroupId:null,connections:m.connections.map(y=>({...y,selected:y.id===g}))})),addGroup:g=>r(m=>{u();const y={groups:[...m.groups,g]};return ht({...m,...y},m.diagramName),y}),updateGroup:(g,m)=>r(y=>{u();const x={groups:y.groups.map(S=>S.id===g?{...S,...m}:S)};return ht({...y,...x},y.diagramName),x}),deleteGroup:g=>r(m=>{u();const y={groups:m.groups.filter(x=>x.id!==g)};return ht({...m,...y},m.diagramName),y}),addNodeToGroup:(g,m)=>r(y=>{u();const x={groups:y.groups.map(S=>S.id===g&&!S.nodeIds.includes(m)?{...S,nodeIds:[...S.nodeIds,m]}:S)};return ht({...y,...x},y.diagramName),x}),removeNodeFromGroup:(g,m)=>r(y=>{u();const x={groups:y.groups.map(S=>S.id===g?{...S,nodeIds:S.nodeIds.filter(C=>C!==m)}:S)};return ht({...y,...x},y.diagramName),x}),selectGroup:g=>r(m=>({selectedGroupId:g,selectedNodeId:null,selectedConnectionId:null})),createGroupFromSelection:g=>r(m=>{u();const y=m.nodes.filter(C=>C.selected||C.id===m.selectedNodeId).map(C=>C.id);if(y.length===0)return m;const x={id:`group-${Date.now()}`,name:g,nodeIds:y,color:`hsl(${Math.random()*360}, 70%, 50%)`},S={groups:[...m.groups,x],nodes:m.nodes.map(C=>({...C,selected:!1})),selectedNodeId:null};return ht({...m,...S},m.diagramName),S}),autoGroupByConnections:()=>r(g=>{u();const m=new Set;g.groups.forEach(T=>{T.nodeIds.forEach(N=>m.add(N))});const y=new Map,x=T=>{y.has(T)||y.set(T,T);const N=y.get(T);if(N!==void 0&&N!==T){const D=x(N);return y.set(T,D),D}return N??T},S=(T,N)=>{const D=x(T),q=x(N);D!==q&&y.set(D,q)};g.connections.forEach(T=>{!m.has(T.source)&&!m.has(T.target)&&S(T.source,T.target)});const C=new Map;g.nodes.forEach(T=>{if(!m.has(T.id)){const N=x(T.id);C.has(N)||C.set(N,[]);const D=C.get(N);D&&D.push(T.id)}});const E=[];let M=g.groups.length+1;C.forEach((T,N)=>{T.length>=2&&E.push({id:`group-${Date.now()}-${E.length}`,name:`Group ${M++}`,nodeIds:T,color:`hsl(${Math.random()*360}, 70%, 50%)`})});const A={groups:[...g.groups,...E]};return ht({...g,...A},g.diagramName),A}),setZoom:g=>r(m=>(ht({...m,zoom:g},m.diagramName),{zoom:g})),setPan:g=>r(m=>(ht({...m,pan:g},m.diagramName),{pan:g})),setViewportSize:g=>r(()=>({viewportWidth:g.width,viewportHeight:g.height})),setDiagramName:g=>r(m=>(ht(m,g),{diagramName:g})),loadDiagramState:(g,m=!1)=>r(()=>{m||u();const y=Bn(g.nodes||[],g.connections||[]),x={...g,canvasChunks:y,canvasBounds:Qn(y)};return ht(x,e().diagramName),x}),saveDiagram:()=>{const g=e();ht(g,g.diagramName)},resetCanvas:()=>{u();const g=Bn([],[]);r({...Qf,canvasChunks:g,canvasBounds:Qn(g)})},undo:()=>{const g=Mi.getState().undo();g&&r(()=>{const m=Bn(g.nodes||[],g.connections||[]),y={...g,canvasChunks:m,canvasBounds:Qn(m)};return ht(y,e().diagramName),y})},redo:()=>{const g=Mi.getState().redo();g&&r(()=>{const m=Bn(g.nodes||[],g.connections||[]),y={...g,canvasChunks:m,canvasBounds:Qn(m)};return ht(y,e().diagramName),y})},startDragOperation:g=>{const m=e();o=!0,m.nodes.find(y=>y.id===g),u()},endDragOperation:()=>{o=!1;const g=e();ht(g,g.diagramName)},setGroupDragging:g=>{i=g},getIsGroupDragging:()=>i,bringToFront:g=>r(m=>{u();const y=m.nodes.findIndex(E=>E.id===g);if(y===-1)return m;const x=[...m.nodes],[S]=x.splice(y,1);x.push(S);const C={nodes:x};return ht({...m,...C},m.diagramName),C}),sendToBack:g=>r(m=>{u();const y=m.nodes.findIndex(E=>E.id===g);if(y===-1)return m;const x=[...m.nodes],[S]=x.splice(y,1);x.unshift(S);const C={nodes:x};return ht({...m,...C},m.diagramName),C}),bringForward:g=>r(m=>{u();const y=m.nodes.findIndex(C=>C.id===g);if(y===-1||y===m.nodes.length-1)return m;const x=[...m.nodes];[x[y],x[y+1]]=[x[y+1],x[y]];const S={nodes:x};return ht({...m,...S},m.diagramName),S}),sendBackward:g=>r(m=>{u();const y=m.nodes.findIndex(C=>C.id===g);if(y===-1||y===0)return m;const x=[...m.nodes];[x[y],x[y-1]]=[x[y-1],x[y]];const S={nodes:x};return ht({...m,...S},m.diagramName),S})}}),ja=Cs((r,e)=>({isRunning:!1,messages:new Map,messageHistory:[],initialize:(t,n)=>{un.initialize(t,n),e().updateMessages(t,n)},start:()=>{un.start(),r({isRunning:!0});const t=setInterval(()=>{const{nodes:n,connections:o}=Re.getState();e().updateMessages(n,o)},200);un._pollInterval=t},stop:()=>{un.stop();const t=un._pollInterval;t&&clearInterval(t),r({isRunning:!1})},updateMessages:(t,n)=>{un.updateNodesAndConnections(t,n);const o=new Map;for(const l of n)o.set(l.id,un.getConnectionMessages(l.id));const i=un.getMessageHistory(100);r({messages:o,messageHistory:i})},getConnectionMessages:t=>un.getConnectionMessages(t),getComponentMessages:t=>un.getComponentMessages(t),getMessageHistory:t=>un.getMessageHistory(t)}));class pA{alerts=new Map;alertCallbacks=[];onAlert(e){this.alertCallbacks.push(e)}analyze(e,t,n,o){const i=[];for(const l of e){const u=t.get(l.id),f=o.find(p=>p.nodeId===l.id);if(!(!u||!f)){if(f.health==="down"){const p=`down-${l.id}`;if(!this.alerts.has(p)){const g={id:p,type:"critical",title:"Component Down",message:`${l.data.label} is down and not responding`,nodeId:l.id,nodeLabel:l.data.label,timestamp:Date.now(),acknowledged:!1,severity:1};this.addAlert(g),i.push(g)}}if(u.errorRate>.1){const p=`error-${l.id}`,g=this.alerts.get(p);if(!g||g.acknowledged){const m={id:p,type:"critical",title:"High Error Rate",message:`${l.data.label} has ${(u.errorRate*100).toFixed(1)}% error rate`,nodeId:l.id,nodeLabel:l.data.label,timestamp:Date.now(),acknowledged:!1,severity:.9};this.addAlert(m),i.push(m)}}if(u.latency>2e3){const p=`latency-${l.id}`,g=this.alerts.get(p);if(!g||g.acknowledged){const m={id:p,type:"warning",title:"High Latency",message:`${l.data.label} has latency of ${u.latency.toFixed(0)}ms`,nodeId:l.id,nodeLabel:l.data.label,timestamp:Date.now(),acknowledged:!1,severity:.7};this.addAlert(m),i.push(m)}}if(u.utilization>.9){const p=`utilization-${l.id}`,g=this.alerts.get(p);if(!g||g.acknowledged){const m={id:p,type:"warning",title:"High Utilization",message:`${l.data.label} is at ${(u.utilization*100).toFixed(0)}% capacity`,nodeId:l.id,nodeLabel:l.data.label,timestamp:Date.now(),acknowledged:!1,severity:.6};this.addAlert(m),i.push(m)}}}}for(const[l,u]of n.entries())if(u.bottleneck){const f=`bottleneck-${l}`,p=this.alerts.get(f);if(!p||p.acknowledged){const g={id:f,type:"critical",title:"Connection Bottleneck",message:"Bottleneck detected in connection",timestamp:Date.now(),acknowledged:!1,severity:.85};this.addAlert(g),i.push(g)}}return this.cleanupResolvedAlerts(e,t,n,o),i}addAlert(e){this.alerts.set(e.id,e),this.alertCallbacks.forEach(t=>t(e))}cleanupResolvedAlerts(e,t,n,o){new Set(e.map(i=>i.id)),new Set(n.keys());for(const[i,l]of this.alerts.entries()){if(l.acknowledged)continue;let u=!1;if(l.nodeId)if(!e.find(p=>p.id===l.nodeId))u=!0;else{const p=t.get(l.nodeId),g=o.find(m=>m.nodeId===l.nodeId);(i.startsWith("down-")&&g&&g.health!=="down"||i.startsWith("error-")&&p&&p.errorRate<=.1||i.startsWith("latency-")&&p&&p.latency<=2e3||i.startsWith("utilization-")&&p&&p.utilization<=.9)&&(u=!0)}else if(i.startsWith("bottleneck-")){const f=i.replace("bottleneck-",""),p=n.get(f);(!p||!p.bottleneck)&&(u=!0)}u&&this.alerts.delete(i)}}acknowledge(e){const t=this.alerts.get(e);t&&(t.acknowledged=!0,this.alerts.set(e,t))}getAlerts(){return Array.from(this.alerts.values()).filter(e=>!e.acknowledged).sort((e,t)=>t.severity-e.severity)}getAlertsByType(e){return this.getAlerts().filter(t=>t.type===e)}clear(){this.alerts.clear()}}const rr=new pA;class gA{nodes=[];connections=[];componentMetrics=new Map;connectionMetrics=new Map;dependencyGraph=new Map;componentStatuses=new Map;update(e,t,n,o){this.nodes=e,this.connections=t,this.componentMetrics=n,this.connectionMetrics=o,this.buildDependencyGraph(),this.analyzeComponentHealth(),this.identifyCriticalPaths(),this.calculateImpactScores()}buildDependencyGraph(){this.dependencyGraph.clear();for(const e of this.nodes){const t=[],n=this.connections.filter(o=>o.target===e.id);for(const o of n){const i=this.connectionMetrics.get(o.id),l=this.componentMetrics.get(o.source);if(!i||!l)continue;const u=Math.max(i.throughputDependency,i.utilization,i.backpressure);let f="direct";i.bottleneck?f="critical":u>.7&&(f="indirect"),t.push({sourceId:o.source,targetId:e.id,connectionId:o.id,type:f,strength:u,impact:this.calculateDependencyImpact(o,l)})}this.dependencyGraph.set(e.id,t)}}calculateDependencyImpact(e,t){const n=this.connectionMetrics.get(e.id);if(!n)return 0;const o=t.errorRate,i=Math.min(1,n.latency/1e3),l=n.backpressure,u=t.utilization>.8?.5:0;return Math.min(1,o*.4+i*.2+l*.3+u*.1)}analyzeComponentHealth(){this.componentStatuses.clear();for(const e of this.nodes){const t=this.componentMetrics.get(e.id),n=this.dependencyGraph.get(e.id)||[];if(!t){this.componentStatuses.set(e.id,{nodeId:e.id,health:"down",dependencies:n,dependents:[],criticalPath:!1,impactScore:0,failureRisk:1});continue}let o="healthy",i=0;t.errorRate>.1?(o="critical",i+=.4):t.errorRate>.05&&(o="degraded",i+=.2),t.utilization>.9?(o==="healthy"&&(o="degraded"),i+=.3):t.utilization>.8&&(i+=.15),t.latency>1e3?(o==="healthy"&&(o="degraded"),i+=.2):t.latency>500&&(i+=.1);for(const u of n){const f=this.componentStatuses.get(u.sourceId);f&&(f.health==="critical"||f.health==="down"?(o==="healthy"&&(o="degraded"),i+=u.impact*.3):f.health==="degraded"&&(i+=u.impact*.15))}i=Math.min(1,i);const l=[];for(const u of this.connections)if(u.source===e.id){const f=this.connectionMetrics.get(u.id);f&&l.push({sourceId:e.id,targetId:u.target,connectionId:u.id,type:f.bottleneck?"critical":"direct",strength:f.throughputDependency,impact:this.calculateDependencyImpact(u,t)})}this.componentStatuses.set(e.id,{nodeId:e.id,health:o,dependencies:n,dependents:l,criticalPath:!1,impactScore:0,failureRisk:i})}}identifyCriticalPaths(){const e=this.nodes.filter(n=>!this.connections.some(o=>o.target===n.id)),t=this.nodes.filter(n=>!this.connections.some(o=>o.source===n.id));for(const n of e)for(const o of t){const i=this.findPath(n.id,o.id);i&&i.length>1&&i.some(u=>{const f=this.componentStatuses.get(u),p=this.connections.find(g=>i.includes(g.source)&&i.includes(g.target)&&i.indexOf(g.source)<i.indexOf(g.target));if(p){const g=this.connectionMetrics.get(p.id);return g?.bottleneck||(g?.backpressure||0)>.7}return f?.health==="critical"||f?.health==="down"})&&i.forEach(u=>{const f=this.componentStatuses.get(u);f&&(f.criticalPath=!0)})}}findPath(e,t){if(e===t)return[e];const n=[{nodeId:e,path:[e]}],o=new Set([e]);for(;n.length>0;){const{nodeId:i,path:l}=n.shift(),u=this.connections.filter(f=>f.source===i);for(const f of u){if(f.target===t)return[...l,t];o.has(f.target)||(o.add(f.target),n.push({nodeId:f.target,path:[...l,f.target]}))}}return null}calculateImpactScores(){for(const[e,t]of this.componentStatuses.entries()){let n=0;n+=Math.min(1,t.dependents.length/5)*.3,t.health==="critical"||t.health==="down"?n+=.4:t.health==="degraded"&&(n+=.2),t.criticalPath&&(n+=.2),n+=t.failureRisk*.1,t.impactScore=Math.min(1,n),this.componentStatuses.set(e,t)}}analyzeSystem(){const e=[],t=[],n=[],o=[];for(const[f,p]of this.componentStatuses.entries())if(p.criticalPath){const g=this.findPathToSink(f);g&&!e.some(m=>JSON.stringify(m)===JSON.stringify(g))&&e.push(g)}for(const[f,p]of this.connectionMetrics.entries())if(p.bottleneck){const g=this.connections.find(m=>m.id===f);g&&(t.includes(g.source)||t.push(g.source),t.includes(g.target)||t.push(g.target))}for(const[f,p]of this.componentStatuses.entries())(p.failureRisk>.6||p.health==="critical"||p.health==="down")&&n.push(f);this.generateRecommendations(o);const i=Array.from(this.componentStatuses.values()).map(f=>{switch(f.health){case"down":return 0;case"critical":return .25;case"degraded":return .5;case"healthy":return 1}}),l=i.length>0?i.reduce((f,p)=>f+p,0)/i.length:1;let u="healthy";return l<.25?u="down":l<.5?u="critical":l<.75&&(u="degraded"),{criticalPaths:e,bottlenecks:t,riskComponents:n,recommendations:o,overallHealth:u}}findPathToSink(e){const t=this.nodes.filter(n=>!this.connections.some(o=>o.source===n.id));for(const n of t){const o=this.findPath(e,n.id);if(o)return o}return null}generateRecommendations(e){for(const[n,o]of this.componentStatuses.entries()){const i=this.nodes.find(u=>u.id===n),l=this.componentMetrics.get(n);!i||!l||(l.utilization>.85&&e.push({type:"scaling",priority:l.utilization>.95?"critical":"high",componentId:n,message:`${i.data.label} is highly utilized (${(l.utilization*100).toFixed(0)}%)`,impact:"May cause performance degradation and increased latency",suggestion:`Consider scaling ${i.data.label} horizontally or vertically`}),l.errorRate>.05&&e.push({type:"monitoring",priority:l.errorRate>.1?"critical":"high",componentId:n,message:`${i.data.label} has high error rate (${(l.errorRate*100).toFixed(1)}%)`,impact:"Affects system reliability and user experience",suggestion:`Investigate error logs and implement error handling for ${i.data.label}`}),l.latency>500&&e.push({type:"optimization",priority:l.latency>1e3?"high":"medium",componentId:n,message:`${i.data.label} has high latency (${l.latency.toFixed(0)}ms)`,impact:"Affects end-to-end response time",suggestion:`Optimize ${i.data.label} performance or add caching`}),o.criticalPath&&o.failureRisk>.5&&e.push({type:"redundancy",priority:"high",componentId:n,message:`${i.data.label} is on a critical path and at risk`,impact:"Failure would significantly impact system",suggestion:`Add redundancy or failover for ${i.data.label}`}))}for(const[n,o]of this.connectionMetrics.entries()){const i=this.connections.find(f=>f.id===n);if(!i)continue;const l=this.nodes.find(f=>f.id===i.source),u=this.nodes.find(f=>f.id===i.target);o.bottleneck&&e.push({type:"optimization",priority:"critical",connectionId:n,message:`Connection between ${l?.data.label||"source"} and ${u?.data.label||"target"} is a bottleneck`,impact:"Limiting overall system throughput",suggestion:"Increase bandwidth or optimize data transfer between these components"}),o.backpressure>.7&&e.push({type:"optimization",priority:"high",connectionId:n,message:`High backpressure (${(o.backpressure*100).toFixed(0)}%) on connection`,impact:"Target component cannot process data fast enough",suggestion:"Scale target component or implement buffering/queuing"})}const t={critical:0,high:1,medium:2,low:3};e.sort((n,o)=>t[n.priority]-t[o.priority])}getComponentStatus(e){return this.componentStatuses.get(e)}getAllComponentStatuses(){return Array.from(this.componentStatuses.values())}getDependencies(e){return this.dependencyGraph.get(e)||[]}}const Gf=new gA,fo=Cs((r,e)=>({componentStatuses:new Map,systemAnalysis:null,updateAnalysis:()=>{const{nodes:t,connections:n}=Re.getState(),{componentMetrics:o,connectionMetrics:i}=kt.getState();Gf.update(t,n,o,i);const l=Gf.analyzeSystem(),u=new Map(Gf.getAllComponentStatuses().map(f=>[f.nodeId,f]));r({componentStatuses:u,systemAnalysis:l})},getComponentStatus:t=>e().componentStatuses.get(t),getAllComponentStatuses:()=>Array.from(e().componentStatuses.values()),getSystemAnalysis:()=>e().systemAnalysis})),Oh=Cs((r,e)=>(rr.onAlert(t=>{e().updateAlerts()}),{alerts:[],updateAlerts:()=>{const{nodes:t,connections:n}=Re.getState(),{componentMetrics:o,connectionMetrics:i}=kt.getState(),l=fo.getState().getAllComponentStatuses();rr.analyze(t,o,i,l);const u=rr.getAlerts();r({alerts:u})},acknowledgeAlert:t=>{rr.acknowledge(t);const n=rr.getAlerts();r({alerts:n})},clearAlerts:()=>{rr.clear(),r({alerts:[]})},getCriticalAlerts:()=>e().alerts.filter(t=>t.type==="critical"),getWarningAlerts:()=>e().alerts.filter(t=>t.type==="warning")})),kt=Cs((r,e)=>({isRunning:!1,simulationTime:0,updateInterval:100,componentMetrics:new Map,connectionMetrics:new Map,initialize:(t,n)=>{We.initialize(t,n),r({componentMetrics:new Map(We.getAllComponentMetrics().map(o=>[o.id,o])),connectionMetrics:new Map(We.getAllConnectionMetrics().map(o=>[o.id,o]))}),ja.getState().initialize(t,n)},start:()=>{We.start(),r({isRunning:!0}),ja.getState().start();const t=setInterval(()=>{e().updateMetrics()},e().updateInterval);We._pollInterval=t},stop:()=>{We.stop();const t=We._pollInterval;t&&clearInterval(t),ja.getState().stop(),r({isRunning:!1})},reset:()=>{We.resetSimulation();const t=We._pollInterval;t&&clearInterval(t),ja.getState().stop(),r({isRunning:!1,simulationTime:0,componentMetrics:new Map,connectionMetrics:new Map})},setUpdateInterval:t=>{r({updateInterval:t})},updateMetrics:()=>{const{nodes:t,connections:n}=Re.getState();We.updateNodesAndConnections(t,n),r(o=>({simulationTime:We.getSimulationTime(),componentMetrics:new Map(We.getAllComponentMetrics().map(i=>[i.id,i])),connectionMetrics:new Map(We.getAllConnectionMetrics().map(i=>[i.id,i]))})),ja.getState().updateMessages(t,n),fo.getState().updateAnalysis(),Oh.getState().updateAlerts()},getComponentMetrics:t=>e().componentMetrics.get(t),getConnectionMetrics:t=>e().connectionMetrics.get(t)}));const mA=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),yA=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),V0=r=>{const e=yA(r);return e.charAt(0).toUpperCase()+e.slice(1)},rb=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),vA=r=>{for(const e in r)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var bA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const xA=w.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:o="",children:i,iconNode:l,...u},f)=>w.createElement("svg",{ref:f,...bA,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:rb("lucide",o),...!i&&!vA(u)&&{"aria-hidden":"true"},...u},[...l.map(([p,g])=>w.createElement(p,g)),...Array.isArray(i)?i:[i]]));const De=(r,e)=>{const t=w.forwardRef(({className:n,...o},i)=>w.createElement(xA,{ref:i,iconNode:e,className:rb(`lucide-${mA(V0(r))}`,`lucide-${r}`,n),...o}));return t.displayName=V0(r),t};const wA=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],ho=De("activity",wA);const SA=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],CA=De("arrow-down",SA);const MA=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],EA=De("arrow-right",MA);const RA=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],TA=De("arrow-up",RA);const AA=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ph=De("check",AA);const NA=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ul=De("chevron-down",NA);const kA=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Ih=De("chevron-right",kA);const DA=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ib=De("chevron-up",DA);const jA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ri=De("circle-alert",jA);const _A=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],qh=De("circle-check",_A);const zA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],LA=De("circle-question-mark",zA);const OA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],uo=De("circle-x",OA);const PA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],IA=De("circle",PA);const qA=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],cb=De("copy",qA);const HA=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],UA=De("download",HA);const $A=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],BA=De("eye",$A);const QA=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],K0=De("file-text",QA);const GA=[["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],FA=De("folder-minus",GA);const VA=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ch=De("folder-plus",VA);const KA=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],YA=De("funnel",KA);const XA=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],WA=De("grip-vertical",XA);const ZA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],JA=De("info",ZA);const e2=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],lb=De("layers",e2);const t2=[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]],n2=De("map",t2);const s2=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],a2=De("maximize-2",s2);const o2=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],r2=De("network",o2);const i2=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],c2=De("pause",i2);const l2=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],u2=De("play",l2);const d2=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Al=De("plus",d2);const f2=[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],bl=De("power-off",f2);const h2=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],Ff=De("power",h2);const p2=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],g2=De("redo-2",p2);const m2=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],y2=De("refresh-cw",m2);const v2=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ub=De("rotate-ccw",v2);const b2=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],x2=De("ruler",b2);const w2=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],S2=De("save",w2);const C2=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],$l=De("search",C2);const M2=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Vf=De("settings-2",M2);const E2=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],R2=De("settings",E2);const T2=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],A2=De("sparkles",T2);const N2=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],k2=De("square-pen",N2);const D2=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],j2=De("star",D2);const _2=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Hh=De("trash-2",_2);const z2=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],db=De("trending-down",z2);const L2=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ys=De("triangle-alert",L2);const O2=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],P2=De("undo-2",O2);const I2=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],q2=De("upload",I2);const H2=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],vs=De("x",H2);const U2=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],fb=De("zap",U2);const $2=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],B2=De("zoom-in",$2);const Q2=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],G2=De("zoom-out",Q2);function F2(){const{isRunning:r,simulationTime:e,initialize:t,start:n,stop:o,reset:i}=kt(),{nodes:l,connections:u}=Re(),f=()=>{e===0&&t(l,u),n()},p=()=>{o()},g=()=>{i()},m=y=>{const x=Math.floor(y/1e3),S=Math.floor(x/60),C=x%60;return`${S}:${C.toString().padStart(2,"0")}`};return h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("div",{className:"text-sm text-muted-foreground w-12",children:m(e)}),h.jsx(Ne,{size:"sm",variant:r?"default":"outline",onClick:f,disabled:r,title:"Start emulation",children:h.jsx(u2,{className:"w-4 h-4"})}),h.jsx(Ne,{size:"sm",variant:r?"default":"outline",onClick:p,disabled:!r,title:"Stop emulation",children:h.jsx(c2,{className:"w-4 h-4"})}),h.jsx(Ne,{size:"sm",variant:"outline",onClick:g,title:"Reset simulation",children:h.jsx(ub,{className:"w-4 h-4"})})]})}const Nt=w.forwardRef(({className:r,type:e,...t},n)=>h.jsx("input",{type:e,className:Ee("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:n,...t}));Nt.displayName="Input";function V2(r){const e=K2(r),t=w.forwardRef((n,o)=>{const{children:i,...l}=n,u=w.Children.toArray(i),f=u.find(X2);if(f){const p=f.props.children,g=u.map(m=>m===f?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:m);return h.jsx(e,{...l,ref:o,children:w.isValidElement(p)?w.cloneElement(p,void 0,g):null})}return h.jsx(e,{...l,ref:o,children:i})});return t.displayName=`${r}.Slot`,t}function K2(r){const e=w.forwardRef((t,n)=>{const{children:o,...i}=t;if(w.isValidElement(o)){const l=Z2(o),u=W2(i,o.props);return o.type!==w.Fragment&&(u.ref=n?Ss(n,l):l),w.cloneElement(o,u)}return w.Children.count(o)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var Y2=Symbol("radix.slottable");function X2(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===Y2}function W2(r,e){const t={...e};for(const n in e){const o=r[n],i=e[n];/^on[A-Z]/.test(n)?o&&i?t[n]=(...u)=>{const f=i(...u);return o(...u),f}:o&&(t[n]=o):n==="style"?t[n]={...o,...i}:n==="className"&&(t[n]=[o,i].filter(Boolean).join(" "))}return{...r,...t}}function Z2(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var J2=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Ae=J2.reduce((r,e)=>{const t=V2(`Primitive.${e}`),n=w.forwardRef((o,i)=>{const{asChild:l,...u}=o,f=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(f,{...u,ref:i})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{});function hb(r,e){r&&zi.flushSync(()=>r.dispatchEvent(e))}var sn=globalThis?.document?w.useLayoutEffect:()=>{};function eN(r,e){return w.useReducer((t,n)=>e[t][n]??t,r)}var rn=r=>{const{present:e,children:t}=r,n=tN(e),o=typeof t=="function"?t({present:n.isPresent}):w.Children.only(t),i=je(n.ref,nN(o));return typeof t=="function"||n.isPresent?w.cloneElement(o,{ref:i}):null};rn.displayName="Presence";function tN(r){const[e,t]=w.useState(),n=w.useRef(null),o=w.useRef(r),i=w.useRef("none"),l=r?"mounted":"unmounted",[u,f]=eN(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const p=cl(n.current);i.current=u==="mounted"?p:"none"},[u]),sn(()=>{const p=n.current,g=o.current;if(g!==r){const y=i.current,x=cl(p);r?f("MOUNT"):x==="none"||p?.display==="none"?f("UNMOUNT"):f(g&&y!==x?"ANIMATION_OUT":"UNMOUNT"),o.current=r}},[r,f]),sn(()=>{if(e){let p;const g=e.ownerDocument.defaultView??window,m=x=>{const C=cl(n.current).includes(CSS.escape(x.animationName));if(x.target===e&&C&&(f("ANIMATION_END"),!o.current)){const E=e.style.animationFillMode;e.style.animationFillMode="forwards",p=g.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=E)})}},y=x=>{x.target===e&&(i.current=cl(n.current))};return e.addEventListener("animationstart",y),e.addEventListener("animationcancel",m),e.addEventListener("animationend",m),()=>{g.clearTimeout(p),e.removeEventListener("animationstart",y),e.removeEventListener("animationcancel",m),e.removeEventListener("animationend",m)}}else f("ANIMATION_END")},[e,f]),{isPresent:["mounted","unmountSuspended"].includes(u),ref:w.useCallback(p=>{n.current=p?getComputedStyle(p):null,t(p)},[])}}function cl(r){return r?.animationName||"none"}function nN(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function sN(r,e){const t=w.createContext(e),n=i=>{const{children:l,...u}=i,f=w.useMemo(()=>u,Object.values(u));return h.jsx(t.Provider,{value:f,children:l})};n.displayName=r+"Provider";function o(i){const l=w.useContext(t);if(l)return l;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${r}\``)}return[n,o]}function bn(r,e=[]){let t=[];function n(i,l){const u=w.createContext(l),f=t.length;t=[...t,l];const p=m=>{const{scope:y,children:x,...S}=m,C=y?.[r]?.[f]||u,E=w.useMemo(()=>S,Object.values(S));return h.jsx(C.Provider,{value:E,children:x})};p.displayName=i+"Provider";function g(m,y){const x=y?.[r]?.[f]||u,S=w.useContext(x);if(S)return S;if(l!==void 0)return l;throw new Error(`\`${m}\` must be used within \`${i}\``)}return[p,g]}const o=()=>{const i=t.map(l=>w.createContext(l));return function(u){const f=u?.[r]||i;return w.useMemo(()=>({[`__scope${r}`]:{...u,[r]:f}}),[u,f])}};return o.scopeName=r,[n,aN(o,...e)]}function aN(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(i){const l=n.reduce((u,{useScope:f,scopeName:p})=>{const m=f(i)[`__scope${p}`];return{...u,...m}},{});return w.useMemo(()=>({[`__scope${e.scopeName}`]:l}),[l])}};return t.scopeName=e.scopeName,t}function nn(r){const e=w.useRef(r);return w.useEffect(()=>{e.current=r}),w.useMemo(()=>(...t)=>e.current?.(...t),[])}var oN=w.createContext(void 0);function Sr(r){const e=w.useContext(oN);return r||e||"ltr"}function Ti(r,[e,t]){return Math.min(t,Math.max(e,r))}function ge(r,e,{checkForDefaultPrevented:t=!0}={}){return function(o){if(r?.(o),t===!1||!o.defaultPrevented)return e?.(o)}}function rN(r,e){return w.useReducer((t,n)=>e[t][n]??t,r)}var Uh="ScrollArea",[pb]=bn(Uh),[iN,Kn]=pb(Uh),gb=w.forwardRef((r,e)=>{const{__scopeScrollArea:t,type:n="hover",dir:o,scrollHideDelay:i=600,...l}=r,[u,f]=w.useState(null),[p,g]=w.useState(null),[m,y]=w.useState(null),[x,S]=w.useState(null),[C,E]=w.useState(null),[M,A]=w.useState(0),[T,N]=w.useState(0),[D,q]=w.useState(!1),[P,H]=w.useState(!1),J=je(e,ce=>f(ce)),se=Sr(o);return h.jsx(iN,{scope:t,type:n,dir:se,scrollHideDelay:i,scrollArea:u,viewport:p,onViewportChange:g,content:m,onContentChange:y,scrollbarX:x,onScrollbarXChange:S,scrollbarXEnabled:D,onScrollbarXEnabledChange:q,scrollbarY:C,onScrollbarYChange:E,scrollbarYEnabled:P,onScrollbarYEnabledChange:H,onCornerWidthChange:A,onCornerHeightChange:N,children:h.jsx(Ae.div,{dir:se,...l,ref:J,style:{position:"relative","--radix-scroll-area-corner-width":M+"px","--radix-scroll-area-corner-height":T+"px",...r.style}})})});gb.displayName=Uh;var mb="ScrollAreaViewport",yb=w.forwardRef((r,e)=>{const{__scopeScrollArea:t,children:n,nonce:o,...i}=r,l=Kn(mb,t),u=w.useRef(null),f=je(e,u,l.onViewportChange);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:o}),h.jsx(Ae.div,{"data-radix-scroll-area-viewport":"",...i,ref:f,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...r.style},children:h.jsx("div",{ref:l.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});yb.displayName=mb;var Ms="ScrollAreaScrollbar",$h=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,o=Kn(Ms,r.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:l}=o,u=r.orientation==="horizontal";return w.useEffect(()=>(u?i(!0):l(!0),()=>{u?i(!1):l(!1)}),[u,i,l]),o.type==="hover"?h.jsx(cN,{...n,ref:e,forceMount:t}):o.type==="scroll"?h.jsx(lN,{...n,ref:e,forceMount:t}):o.type==="auto"?h.jsx(vb,{...n,ref:e,forceMount:t}):o.type==="always"?h.jsx(Bh,{...n,ref:e}):null});$h.displayName=Ms;var cN=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,o=Kn(Ms,r.__scopeScrollArea),[i,l]=w.useState(!1);return w.useEffect(()=>{const u=o.scrollArea;let f=0;if(u){const p=()=>{window.clearTimeout(f),l(!0)},g=()=>{f=window.setTimeout(()=>l(!1),o.scrollHideDelay)};return u.addEventListener("pointerenter",p),u.addEventListener("pointerleave",g),()=>{window.clearTimeout(f),u.removeEventListener("pointerenter",p),u.removeEventListener("pointerleave",g)}}},[o.scrollArea,o.scrollHideDelay]),h.jsx(rn,{present:t||i,children:h.jsx(vb,{"data-state":i?"visible":"hidden",...n,ref:e})})}),lN=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,o=Kn(Ms,r.__scopeScrollArea),i=r.orientation==="horizontal",l=Ql(()=>f("SCROLL_END"),100),[u,f]=rN("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return w.useEffect(()=>{if(u==="idle"){const p=window.setTimeout(()=>f("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(p)}},[u,o.scrollHideDelay,f]),w.useEffect(()=>{const p=o.viewport,g=i?"scrollLeft":"scrollTop";if(p){let m=p[g];const y=()=>{const x=p[g];m!==x&&(f("SCROLL"),l()),m=x};return p.addEventListener("scroll",y),()=>p.removeEventListener("scroll",y)}},[o.viewport,i,f,l]),h.jsx(rn,{present:t||u!=="hidden",children:h.jsx(Bh,{"data-state":u==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:ge(r.onPointerEnter,()=>f("POINTER_ENTER")),onPointerLeave:ge(r.onPointerLeave,()=>f("POINTER_LEAVE"))})})}),vb=w.forwardRef((r,e)=>{const t=Kn(Ms,r.__scopeScrollArea),{forceMount:n,...o}=r,[i,l]=w.useState(!1),u=r.orientation==="horizontal",f=Ql(()=>{if(t.viewport){const p=t.viewport.offsetWidth<t.viewport.scrollWidth,g=t.viewport.offsetHeight<t.viewport.scrollHeight;l(u?p:g)}},10);return mr(t.viewport,f),mr(t.content,f),h.jsx(rn,{present:n||i,children:h.jsx(Bh,{"data-state":i?"visible":"hidden",...o,ref:e})})}),Bh=w.forwardRef((r,e)=>{const{orientation:t="vertical",...n}=r,o=Kn(Ms,r.__scopeScrollArea),i=w.useRef(null),l=w.useRef(0),[u,f]=w.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),p=Cb(u.viewport,u.content),g={...n,sizes:u,onSizesChange:f,hasThumb:p>0&&p<1,onThumbChange:y=>i.current=y,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:y=>l.current=y};function m(y,x){return gN(y,l.current,u,x)}return t==="horizontal"?h.jsx(uN,{...g,ref:e,onThumbPositionChange:()=>{if(o.viewport&&i.current){const y=o.viewport.scrollLeft,x=Y0(y,u,o.dir);i.current.style.transform=`translate3d(${x}px, 0, 0)`}},onWheelScroll:y=>{o.viewport&&(o.viewport.scrollLeft=y)},onDragScroll:y=>{o.viewport&&(o.viewport.scrollLeft=m(y,o.dir))}}):t==="vertical"?h.jsx(dN,{...g,ref:e,onThumbPositionChange:()=>{if(o.viewport&&i.current){const y=o.viewport.scrollTop,x=Y0(y,u);i.current.style.transform=`translate3d(0, ${x}px, 0)`}},onWheelScroll:y=>{o.viewport&&(o.viewport.scrollTop=y)},onDragScroll:y=>{o.viewport&&(o.viewport.scrollTop=m(y))}}):null}),uN=w.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...o}=r,i=Kn(Ms,r.__scopeScrollArea),[l,u]=w.useState(),f=w.useRef(null),p=je(e,f,i.onScrollbarXChange);return w.useEffect(()=>{f.current&&u(getComputedStyle(f.current))},[f]),h.jsx(xb,{"data-orientation":"horizontal",...o,ref:p,sizes:t,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Bl(t)+"px",...r.style},onThumbPointerDown:g=>r.onThumbPointerDown(g.x),onDragScroll:g=>r.onDragScroll(g.x),onWheelScroll:(g,m)=>{if(i.viewport){const y=i.viewport.scrollLeft+g.deltaX;r.onWheelScroll(y),Eb(y,m)&&g.preventDefault()}},onResize:()=>{f.current&&i.viewport&&l&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:f.current.clientWidth,paddingStart:kl(l.paddingLeft),paddingEnd:kl(l.paddingRight)}})}})}),dN=w.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...o}=r,i=Kn(Ms,r.__scopeScrollArea),[l,u]=w.useState(),f=w.useRef(null),p=je(e,f,i.onScrollbarYChange);return w.useEffect(()=>{f.current&&u(getComputedStyle(f.current))},[f]),h.jsx(xb,{"data-orientation":"vertical",...o,ref:p,sizes:t,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Bl(t)+"px",...r.style},onThumbPointerDown:g=>r.onThumbPointerDown(g.y),onDragScroll:g=>r.onDragScroll(g.y),onWheelScroll:(g,m)=>{if(i.viewport){const y=i.viewport.scrollTop+g.deltaY;r.onWheelScroll(y),Eb(y,m)&&g.preventDefault()}},onResize:()=>{f.current&&i.viewport&&l&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:f.current.clientHeight,paddingStart:kl(l.paddingTop),paddingEnd:kl(l.paddingBottom)}})}})}),[fN,bb]=pb(Ms),xb=w.forwardRef((r,e)=>{const{__scopeScrollArea:t,sizes:n,hasThumb:o,onThumbChange:i,onThumbPointerUp:l,onThumbPointerDown:u,onThumbPositionChange:f,onDragScroll:p,onWheelScroll:g,onResize:m,...y}=r,x=Kn(Ms,t),[S,C]=w.useState(null),E=je(e,J=>C(J)),M=w.useRef(null),A=w.useRef(""),T=x.viewport,N=n.content-n.viewport,D=nn(g),q=nn(f),P=Ql(m,10);function H(J){if(M.current){const se=J.clientX-M.current.left,ce=J.clientY-M.current.top;p({x:se,y:ce})}}return w.useEffect(()=>{const J=se=>{const ce=se.target;S?.contains(ce)&&D(se,N)};return document.addEventListener("wheel",J,{passive:!1}),()=>document.removeEventListener("wheel",J,{passive:!1})},[T,S,N,D]),w.useEffect(q,[n,q]),mr(S,P),mr(x.content,P),h.jsx(fN,{scope:t,scrollbar:S,hasThumb:o,onThumbChange:nn(i),onThumbPointerUp:nn(l),onThumbPositionChange:q,onThumbPointerDown:nn(u),children:h.jsx(Ae.div,{...y,ref:E,style:{position:"absolute",...y.style},onPointerDown:ge(r.onPointerDown,J=>{J.button===0&&(J.target.setPointerCapture(J.pointerId),M.current=S.getBoundingClientRect(),A.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",x.viewport&&(x.viewport.style.scrollBehavior="auto"),H(J))}),onPointerMove:ge(r.onPointerMove,H),onPointerUp:ge(r.onPointerUp,J=>{const se=J.target;se.hasPointerCapture(J.pointerId)&&se.releasePointerCapture(J.pointerId),document.body.style.webkitUserSelect=A.current,x.viewport&&(x.viewport.style.scrollBehavior=""),M.current=null})})})}),Nl="ScrollAreaThumb",wb=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,o=bb(Nl,r.__scopeScrollArea);return h.jsx(rn,{present:t||o.hasThumb,children:h.jsx(hN,{ref:e,...n})})}),hN=w.forwardRef((r,e)=>{const{__scopeScrollArea:t,style:n,...o}=r,i=Kn(Nl,t),l=bb(Nl,t),{onThumbPositionChange:u}=l,f=je(e,m=>l.onThumbChange(m)),p=w.useRef(void 0),g=Ql(()=>{p.current&&(p.current(),p.current=void 0)},100);return w.useEffect(()=>{const m=i.viewport;if(m){const y=()=>{if(g(),!p.current){const x=mN(m,u);p.current=x,u()}};return u(),m.addEventListener("scroll",y),()=>m.removeEventListener("scroll",y)}},[i.viewport,g,u]),h.jsx(Ae.div,{"data-state":l.hasThumb?"visible":"hidden",...o,ref:f,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:ge(r.onPointerDownCapture,m=>{const x=m.target.getBoundingClientRect(),S=m.clientX-x.left,C=m.clientY-x.top;l.onThumbPointerDown({x:S,y:C})}),onPointerUp:ge(r.onPointerUp,l.onThumbPointerUp)})});wb.displayName=Nl;var Qh="ScrollAreaCorner",Sb=w.forwardRef((r,e)=>{const t=Kn(Qh,r.__scopeScrollArea),n=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&n?h.jsx(pN,{...r,ref:e}):null});Sb.displayName=Qh;var pN=w.forwardRef((r,e)=>{const{__scopeScrollArea:t,...n}=r,o=Kn(Qh,t),[i,l]=w.useState(0),[u,f]=w.useState(0),p=!!(i&&u);return mr(o.scrollbarX,()=>{const g=o.scrollbarX?.offsetHeight||0;o.onCornerHeightChange(g),f(g)}),mr(o.scrollbarY,()=>{const g=o.scrollbarY?.offsetWidth||0;o.onCornerWidthChange(g),l(g)}),p?h.jsx(Ae.div,{...n,ref:e,style:{width:i,height:u,position:"absolute",right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function kl(r){return r?parseInt(r,10):0}function Cb(r,e){const t=r/e;return isNaN(t)?0:t}function Bl(r){const e=Cb(r.viewport,r.content),t=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,n=(r.scrollbar.size-t)*e;return Math.max(n,18)}function gN(r,e,t,n="ltr"){const o=Bl(t),i=o/2,l=e||i,u=o-l,f=t.scrollbar.paddingStart+l,p=t.scrollbar.size-t.scrollbar.paddingEnd-u,g=t.content-t.viewport,m=n==="ltr"?[0,g]:[g*-1,0];return Mb([f,p],m)(r)}function Y0(r,e,t="ltr"){const n=Bl(e),o=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-o,l=e.content-e.viewport,u=i-n,f=t==="ltr"?[0,l]:[l*-1,0],p=Ti(r,f);return Mb([0,l],[0,u])(p)}function Mb(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function Eb(r,e){return r>0&&r<e}var mN=(r,e=()=>{})=>{let t={left:r.scrollLeft,top:r.scrollTop},n=0;return(function o(){const i={left:r.scrollLeft,top:r.scrollTop},l=t.left!==i.left,u=t.top!==i.top;(l||u)&&e(),t=i,n=window.requestAnimationFrame(o)})(),()=>window.cancelAnimationFrame(n)};function Ql(r,e){const t=nn(r),n=w.useRef(0);return w.useEffect(()=>()=>window.clearTimeout(n.current),[]),w.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(t,e)},[t,e])}function mr(r,e){const t=nn(e);sn(()=>{let n=0;if(r){const o=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(t)});return o.observe(r),()=>{window.cancelAnimationFrame(n),o.unobserve(r)}}},[r,t])}var Rb=gb,yN=yb,vN=Sb;const on=w.forwardRef(({className:r,children:e,...t},n)=>h.jsxs(Rb,{ref:n,className:Ee("relative overflow-hidden",r),scrollHideDelay:0,...t,children:[h.jsx(yN,{className:"h-full w-full rounded-[inherit]",children:e}),h.jsx(Gl,{}),h.jsx(vN,{})]}));on.displayName=Rb.displayName;const Gl=w.forwardRef(({className:r,orientation:e="vertical",...t},n)=>h.jsx($h,{ref:n,orientation:e,className:Ee("flex touch-none select-none",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]","data-[state=visible]:bg-accent/20 data-[state=visible]:hover:bg-accent/30","[&[data-state=hidden]]:opacity-0 [&[data-state=visible]]:opacity-100",r),style:{transition:"none !important",transitionDelay:"0ms !important",transitionDuration:"0ms !important"},...t,children:h.jsx(wb,{className:"relative flex-1 rounded-full bg-accent/80 hover:bg-accent",style:{transition:"none !important"}})}));Gl.displayName=$h.displayName;const Li=Cs(r=>({showMinimap:!0,setShowMinimap:e=>r({showMinimap:e}),toggleMinimap:()=>r(e=>({showMinimap:!e.showMinimap})),showHeatMapLegend:!0,setShowHeatMapLegend:e=>r({showHeatMapLegend:e}),toggleHeatMapLegend:()=>r(e=>({showHeatMapLegend:!e.showHeatMapLegend})),showRuler:!1,setShowRuler:e=>r({showRuler:e}),toggleRuler:()=>r(e=>({showRuler:!e.showRuler})),autoCenterOnSelect:!0,setAutoCenterOnSelect:e=>r({autoCenterOnSelect:e}),searchQuery:"",setSearchQuery:e=>r({searchQuery:e}),highlightedNodeId:null,setHighlightedNodeId:e=>r({highlightedNodeId:e})})),Ai=[{id:"kafka",type:"kafka",label:"Apache Kafka",icon:"",color:"#000000",category:"messaging"},{id:"rabbitmq",type:"rabbitmq",label:"RabbitMQ",icon:"",color:"#FF6600",category:"messaging"},{id:"activemq",type:"activemq",label:"ActiveMQ",icon:"",color:"#A1005A",category:"messaging"},{id:"aws-sqs",type:"aws-sqs",label:"AWS SQS",icon:"",color:"#FF9900",category:"messaging"},{id:"azure-service-bus",type:"azure-service-bus",label:"Azure Service Bus",icon:"",color:"#0078D7",category:"messaging"},{id:"gcp-pubsub",type:"gcp-pubsub",label:"Google Pub/Sub",icon:"",color:"#4285F4",category:"messaging"},{id:"kong",type:"kong",label:"Kong Gateway",icon:"",color:"#003459",category:"integration"},{id:"apigee",type:"apigee",label:"Apigee",icon:"",color:"#F26522",category:"integration"},{id:"mulesoft",type:"mulesoft",label:"MuleSoft",icon:"",color:"#00A0DF",category:"integration"},{id:"graphql-gateway",type:"graphql-gateway",label:"GraphQL Gateway",icon:"",color:"#E10098",category:"integration"},{id:"bff-service",type:"bff-service",label:"BFF Service",icon:"",color:"#6C5CE7",category:"integration"},{id:"webhook-relay",type:"webhook-relay",label:"Webhook Relay",icon:"",color:"#1ABC9C",category:"integration"},{id:"postgres",type:"postgres",label:"PostgreSQL",icon:"",color:"#336791",category:"data"},{id:"mongodb",type:"mongodb",label:"MongoDB",icon:"",color:"#47A248",category:"data"},{id:"redis",type:"redis",label:"Redis",icon:"",color:"#DC382D",category:"data"},{id:"cassandra",type:"cassandra",label:"Apache Cassandra",icon:"",color:"#1287B1",category:"data"},{id:"clickhouse",type:"clickhouse",label:"ClickHouse",icon:"",color:"#FFCC00",category:"data"},{id:"snowflake",type:"snowflake",label:"Snowflake",icon:"",color:"#29B5E8",category:"data"},{id:"elasticsearch",type:"elasticsearch",label:"Elasticsearch",icon:"",color:"#00A79D",category:"data"},{id:"s3-datalake",type:"s3-datalake",label:"S3 Data Lake",icon:"",color:"#FF9900",category:"data"},{id:"prometheus",type:"prometheus",label:"Prometheus",icon:"",color:"#E6522C",category:"observability"},{id:"grafana",type:"grafana",label:"Grafana",icon:"",color:"#F56815",category:"observability"},{id:"loki",type:"loki",label:"Loki",icon:"",color:"#7CBA3C",category:"observability"},{id:"jaeger",type:"jaeger",label:"Jaeger",icon:"",color:"#65D6AD",category:"observability"},{id:"otel-collector",type:"otel-collector",label:"OpenTelemetry Collector",icon:"",color:"#6E56CF",category:"observability"},{id:"pagerduty",type:"pagerduty",label:"PagerDuty",icon:"",color:"#06AC38",category:"observability"},{id:"keycloak",type:"keycloak",label:"Keycloak",icon:"",color:"#5C6BC0",category:"security"},{id:"waf",type:"waf",label:"WAF / API Shield",icon:"",color:"#F44336",category:"security"},{id:"firewall",type:"firewall",label:"Firewall",icon:"",color:"#FF7043",category:"security"},{id:"secrets-vault",type:"secrets-vault",label:"Secrets Vault",icon:"",color:"#009688",category:"security"},{id:"ids-ips",type:"ids-ips",label:"IDS / IPS",icon:"",color:"#512DA8",category:"security"},{id:"jenkins",type:"jenkins",label:"Jenkins",icon:"",color:"#D24939",category:"devops"},{id:"gitlab-ci",type:"gitlab-ci",label:"GitLab CI",icon:"",color:"#FC6D26",category:"devops"},{id:"argo-cd",type:"argo-cd",label:"Argo CD",icon:"",color:"#EF7B45",category:"devops"},{id:"terraform",type:"terraform",label:"Terraform",icon:"",color:"#7B42BC",category:"devops"},{id:"ansible",type:"ansible",label:"Ansible",icon:"",color:"#000000",category:"devops"},{id:"harbor",type:"harbor",label:"Harbor Registry",icon:"",color:"#3BC1C4",category:"devops"},{id:"nginx",type:"nginx",label:"NGINX",icon:"",color:"#009639",category:"infrastructure"},{id:"docker",type:"docker",label:"Docker",icon:"",color:"#2496ED",category:"infrastructure"},{id:"kubernetes",type:"kubernetes",label:"Kubernetes",icon:"",color:"#326CE5",category:"infrastructure"},{id:"haproxy",type:"haproxy",label:"HAProxy",icon:"",color:"#009FDF",category:"infrastructure"},{id:"envoy",type:"envoy",label:"Envoy Proxy",icon:"",color:"#D63384",category:"infrastructure"},{id:"traefik",type:"traefik",label:"Traefik",icon:"",color:"#24A1DE",category:"infrastructure"},{id:"istio",type:"istio",label:"Istio Mesh",icon:"",color:"#466BB0",category:"edge"},{id:"service-mesh",type:"service-mesh",label:"Service Mesh",icon:"",color:"#5E81AC",category:"edge"},{id:"api-gateway",type:"api-gateway",label:"Cloud API Gateway",icon:"",color:"#FFB300",category:"edge"},{id:"vpn",type:"vpn",label:"VPN Concentrator",icon:"",color:"#2D9CDB",category:"edge"},{id:"cdn",type:"cdn",label:"CDN Edge",icon:"",color:"#FF5A5F",category:"edge"},{id:"rest",type:"rest",label:"REST API",icon:"",color:"#61DAFB",category:"api"},{id:"grpc",type:"grpc",label:"gRPC",icon:"",color:"#244C5A",category:"api"},{id:"graphql",type:"graphql",label:"GraphQL",icon:"",color:"#DE33A6",category:"api"},{id:"soap",type:"soap",label:"SOAP",icon:"",color:"#2196F3",category:"api"},{id:"websocket",type:"websocket",label:"WebSocket",icon:"",color:"#010101",category:"api"},{id:"webhook",type:"webhook",label:"Webhook Endpoint",icon:"",color:"#0FA3B1",category:"api"},{id:"spark",type:"spark",label:"Apache Spark",icon:"",color:"#E25A1C",category:"ml"},{id:"tensorflow-serving",type:"tensorflow-serving",label:"TensorFlow Serving",icon:"",color:"#FF6F00",category:"ml"},{id:"pytorch-serve",type:"pytorch-serve",label:"PyTorch Serve",icon:"",color:"#EE4C2C",category:"ml"},{id:"mlflow",type:"mlflow",label:"MLflow",icon:"",color:"#4285F4",category:"ml"},{id:"feature-store",type:"feature-store",label:"Feature Store",icon:"",color:"#8E44AD",category:"ml"},{id:"crm",type:"crm",label:"CRM System",icon:"",color:"#F39C12",category:"business"},{id:"erp",type:"erp",label:"ERP / SAP",icon:"",color:"#1B75BC",category:"business"},{id:"payment-gateway",type:"payment-gateway",label:"Payment Gateway",icon:"",color:"#4CAF50",category:"business"},{id:"bpmn-engine",type:"bpmn-engine",label:"BPMN Engine",icon:"",color:"#34495E",category:"business"},{id:"rpa-bot",type:"rpa-bot",label:"RPA Bot",icon:"",color:"#9B59B6",category:"business"}],xi=[{id:"messaging",label:"Messaging & Event Bus",icon:""},{id:"integration",label:"Integration & API",icon:""},{id:"data",label:"Data & Storage",icon:""},{id:"observability",label:"Observability",icon:""},{id:"security",label:"Security & IAM",icon:""},{id:"devops",label:"DevOps & Platform",icon:""},{id:"infrastructure",label:"Runtime & Infra",icon:""},{id:"edge",label:"Edge & Networking",icon:""},{id:"api",label:"Protocols & APIs",icon:""},{id:"ml",label:"ML & Analytics",icon:""},{id:"business",label:"Business Systems",icon:""}];function bN(){const{nodes:r,selectNode:e,zoom:t,pan:n,setPan:o,setZoom:i}=Re(),{searchQuery:l,setSearchQuery:u,highlightedNodeId:f,setHighlightedNodeId:p}=Li(),[g,m]=w.useState(!1),y=w.useRef(null);w.useEffect(()=>{const C=E=>{y.current&&!y.current.contains(E.target)&&m(!1)};return document.addEventListener("mousedown",C),()=>{document.removeEventListener("mousedown",C)}},[]);const x=w.useMemo(()=>{if(!l.trim())return[];const C=l.toLowerCase();return r.filter(E=>{const M=Ai.find(D=>D.type===E.type),A=E.data?.label||"",T=E.type||"",N=M?.category||"";return A.toLowerCase().includes(C)||T.toLowerCase().includes(C)||N.toLowerCase().includes(C)})},[r,l]),S=C=>{e(C),p(C);const E=r.find(M=>M.id===C);if(E&&g){const M=window.innerWidth/2,A=window.innerHeight/2,T=E.position.x+70,N=E.position.y+70,D=M-T*t,q=A-N*t;o({x:D,y:q}),t<.8&&i(1)}setTimeout(()=>p(null),2e3)};return h.jsxs("div",{className:"relative",ref:y,children:[h.jsxs("div",{className:"relative",children:[h.jsx($l,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),h.jsx(Nt,{type:"text",placeholder:"Search components...",value:l,onChange:C=>{u(C.target.value),m(!0)},onFocus:()=>m(!0),className:"pl-8 pr-8 w-64"}),l&&h.jsx(Ne,{variant:"ghost",size:"icon",className:"absolute right-0 top-1/2 transform -translate-y-1/2 h-6 w-6",onClick:()=>{u(""),m(!1),p(null)},children:h.jsx(vs,{className:"h-3 w-3"})})]}),g&&l&&h.jsx("div",{className:"absolute top-full left-0 mt-1 w-64 bg-card border border-border rounded-md shadow-lg z-50 max-h-80 overflow-hidden",children:x.length>0?h.jsx(on,{className:"max-h-80",children:h.jsx("div",{className:"p-1",children:x.map(C=>{const E=Ai.find(A=>A.type===C.type),M=f===C.id;return h.jsxs("button",{onClick:()=>S(C.id),className:Ee("w-full text-left px-3 py-2 rounded-sm hover:bg-accent transition-colors flex items-center justify-between",M&&"bg-accent"),children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm font-medium truncate",children:C.data?.label||C.type}),h.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[E?.category||"Unknown","  ",C.type]})]}),h.jsx(Ih,{className:"h-4 w-4 text-muted-foreground flex-shrink-0 ml-2"})]},C.id)})})}):h.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"No components found"})})]})}function xN(r){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.appendChild(t),t.styleSheet?t.styleSheet.cssText=r:t.appendChild(document.createTextNode(r))}Array(12).fill(0);let lh=1;class wN{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:n,...o}=e,i=typeof e?.id=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:lh++,l=this.toasts.find(f=>f.id===i),u=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),l?this.toasts=this.toasts.map(f=>f.id===i?(this.publish({...f,...e,id:i,title:n}),{...f,...e,id:i,dismissible:u,title:n}):f):this.addToast({title:n,...o,dismissible:u,id:i}),i},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));const o=Promise.resolve(e instanceof Function?e():e);let i=n!==void 0,l;const u=o.then(async p=>{if(l=["resolve",p],Et.isValidElement(p))i=!1,this.create({id:n,type:"default",message:p});else if(CN(p)&&!p.ok){i=!1;const m=typeof t.error=="function"?await t.error(`HTTP error! status: ${p.status}`):t.error,y=typeof t.description=="function"?await t.description(`HTTP error! status: ${p.status}`):t.description,S=typeof m=="object"&&!Et.isValidElement(m)?m:{message:m};this.create({id:n,type:"error",description:y,...S})}else if(p instanceof Error){i=!1;const m=typeof t.error=="function"?await t.error(p):t.error,y=typeof t.description=="function"?await t.description(p):t.description,S=typeof m=="object"&&!Et.isValidElement(m)?m:{message:m};this.create({id:n,type:"error",description:y,...S})}else if(t.success!==void 0){i=!1;const m=typeof t.success=="function"?await t.success(p):t.success,y=typeof t.description=="function"?await t.description(p):t.description,S=typeof m=="object"&&!Et.isValidElement(m)?m:{message:m};this.create({id:n,type:"success",description:y,...S})}}).catch(async p=>{if(l=["reject",p],t.error!==void 0){i=!1;const g=typeof t.error=="function"?await t.error(p):t.error,m=typeof t.description=="function"?await t.description(p):t.description,x=typeof g=="object"&&!Et.isValidElement(g)?g:{message:g};this.create({id:n,type:"error",description:m,...x})}}).finally(()=>{i&&(this.dismiss(n),n=void 0),t.finally==null||t.finally.call(t)}),f=()=>new Promise((p,g)=>u.then(()=>l[0]==="reject"?g(l[1]):p(l[1])).catch(g));return typeof n!="string"&&typeof n!="number"?{unwrap:f}:Object.assign(n,{unwrap:f})},this.custom=(e,t)=>{const n=t?.id||lh++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Gn=new wN,SN=(r,e)=>{const t=e?.id||lh++;return Gn.addToast({title:r,...e,id:t}),t},CN=r=>r&&typeof r=="object"&&"ok"in r&&typeof r.ok=="boolean"&&"status"in r&&typeof r.status=="number",MN=SN,EN=()=>Gn.toasts,RN=()=>Gn.getActiveToasts(),Ke=Object.assign(MN,{success:Gn.success,info:Gn.info,warning:Gn.warning,error:Gn.error,custom:Gn.custom,message:Gn.message,promise:Gn.promise,dismiss:Gn.dismiss,loading:Gn.loading},{getHistory:EN,getToasts:RN});xN("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");var TN=Nh[" useId ".trim().toString()]||(()=>{}),AN=0;function ns(r){const[e,t]=w.useState(TN());return sn(()=>{t(n=>n??String(AN++))},[r]),e?`radix-${e}`:""}var NN=Nh[" useInsertionEffect ".trim().toString()]||sn;function xs({prop:r,defaultProp:e,onChange:t=()=>{},caller:n}){const[o,i,l]=kN({defaultProp:e,onChange:t}),u=r!==void 0,f=u?r:o;{const g=w.useRef(r!==void 0);w.useEffect(()=>{const m=g.current;m!==u&&console.warn(`${n} is changing from ${m?"controlled":"uncontrolled"} to ${u?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),g.current=u},[u,n])}const p=w.useCallback(g=>{if(u){const m=DN(g)?g(r):g;m!==r&&l.current?.(m)}else i(g)},[u,r,i,l]);return[f,p]}function kN({defaultProp:r,onChange:e}){const[t,n]=w.useState(r),o=w.useRef(t),i=w.useRef(e);return NN(()=>{i.current=e},[e]),w.useEffect(()=>{o.current!==t&&(i.current?.(t),o.current=t)},[t,o]),[t,n,i]}function DN(r){return typeof r=="function"}function jN(r,e=globalThis?.document){const t=nn(r);w.useEffect(()=>{const n=o=>{o.key==="Escape"&&t(o)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var _N="DismissableLayer",uh="dismissableLayer.update",zN="dismissableLayer.pointerDownOutside",LN="dismissableLayer.focusOutside",X0,Tb=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Oi=w.forwardRef((r,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:o,onFocusOutside:i,onInteractOutside:l,onDismiss:u,...f}=r,p=w.useContext(Tb),[g,m]=w.useState(null),y=g?.ownerDocument??globalThis?.document,[,x]=w.useState({}),S=je(e,P=>m(P)),C=Array.from(p.layers),[E]=[...p.layersWithOutsidePointerEventsDisabled].slice(-1),M=C.indexOf(E),A=g?C.indexOf(g):-1,T=p.layersWithOutsidePointerEventsDisabled.size>0,N=A>=M,D=IN(P=>{const H=P.target,J=[...p.branches].some(se=>se.contains(H));!N||J||(o?.(P),l?.(P),P.defaultPrevented||u?.())},y),q=qN(P=>{const H=P.target;[...p.branches].some(se=>se.contains(H))||(i?.(P),l?.(P),P.defaultPrevented||u?.())},y);return jN(P=>{A===p.layers.size-1&&(n?.(P),!P.defaultPrevented&&u&&(P.preventDefault(),u()))},y),w.useEffect(()=>{if(g)return t&&(p.layersWithOutsidePointerEventsDisabled.size===0&&(X0=y.body.style.pointerEvents,y.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(g)),p.layers.add(g),W0(),()=>{t&&p.layersWithOutsidePointerEventsDisabled.size===1&&(y.body.style.pointerEvents=X0)}},[g,y,t,p]),w.useEffect(()=>()=>{g&&(p.layers.delete(g),p.layersWithOutsidePointerEventsDisabled.delete(g),W0())},[g,p]),w.useEffect(()=>{const P=()=>x({});return document.addEventListener(uh,P),()=>document.removeEventListener(uh,P)},[]),h.jsx(Ae.div,{...f,ref:S,style:{pointerEvents:T?N?"auto":"none":void 0,...r.style},onFocusCapture:ge(r.onFocusCapture,q.onFocusCapture),onBlurCapture:ge(r.onBlurCapture,q.onBlurCapture),onPointerDownCapture:ge(r.onPointerDownCapture,D.onPointerDownCapture)})});Oi.displayName=_N;var ON="DismissableLayerBranch",PN=w.forwardRef((r,e)=>{const t=w.useContext(Tb),n=w.useRef(null),o=je(e,n);return w.useEffect(()=>{const i=n.current;if(i)return t.branches.add(i),()=>{t.branches.delete(i)}},[t.branches]),h.jsx(Ae.div,{...r,ref:o})});PN.displayName=ON;function IN(r,e=globalThis?.document){const t=nn(r),n=w.useRef(!1),o=w.useRef(()=>{});return w.useEffect(()=>{const i=u=>{if(u.target&&!n.current){let f=function(){Ab(zN,t,p,{discrete:!0})};const p={originalEvent:u};u.pointerType==="touch"?(e.removeEventListener("click",o.current),o.current=f,e.addEventListener("click",o.current,{once:!0})):f()}else e.removeEventListener("click",o.current);n.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",i),e.removeEventListener("click",o.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function qN(r,e=globalThis?.document){const t=nn(r),n=w.useRef(!1);return w.useEffect(()=>{const o=i=>{i.target&&!n.current&&Ab(LN,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",o),()=>e.removeEventListener("focusin",o)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function W0(){const r=new CustomEvent(uh);document.dispatchEvent(r)}function Ab(r,e,t,{discrete:n}){const o=t.originalEvent.target,i=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&o.addEventListener(r,e,{once:!0}),n?hb(o,i):o.dispatchEvent(i)}var Kf="focusScope.autoFocusOnMount",Yf="focusScope.autoFocusOnUnmount",Z0={bubbles:!1,cancelable:!0},HN="FocusScope",Pi=w.forwardRef((r,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:o,onUnmountAutoFocus:i,...l}=r,[u,f]=w.useState(null),p=nn(o),g=nn(i),m=w.useRef(null),y=je(e,C=>f(C)),x=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(n){let C=function(T){if(x.paused||!u)return;const N=T.target;u.contains(N)?m.current=N:ka(m.current,{select:!0})},E=function(T){if(x.paused||!u)return;const N=T.relatedTarget;N!==null&&(u.contains(N)||ka(m.current,{select:!0}))},M=function(T){if(document.activeElement===document.body)for(const D of T)D.removedNodes.length>0&&ka(u)};document.addEventListener("focusin",C),document.addEventListener("focusout",E);const A=new MutationObserver(M);return u&&A.observe(u,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",C),document.removeEventListener("focusout",E),A.disconnect()}}},[n,u,x.paused]),w.useEffect(()=>{if(u){ev.add(x);const C=document.activeElement;if(!u.contains(C)){const M=new CustomEvent(Kf,Z0);u.addEventListener(Kf,p),u.dispatchEvent(M),M.defaultPrevented||(UN(FN(Nb(u)),{select:!0}),document.activeElement===C&&ka(u))}return()=>{u.removeEventListener(Kf,p),setTimeout(()=>{const M=new CustomEvent(Yf,Z0);u.addEventListener(Yf,g),u.dispatchEvent(M),M.defaultPrevented||ka(C??document.body,{select:!0}),u.removeEventListener(Yf,g),ev.remove(x)},0)}}},[u,p,g,x]);const S=w.useCallback(C=>{if(!t&&!n||x.paused)return;const E=C.key==="Tab"&&!C.altKey&&!C.ctrlKey&&!C.metaKey,M=document.activeElement;if(E&&M){const A=C.currentTarget,[T,N]=$N(A);T&&N?!C.shiftKey&&M===N?(C.preventDefault(),t&&ka(T,{select:!0})):C.shiftKey&&M===T&&(C.preventDefault(),t&&ka(N,{select:!0})):M===A&&C.preventDefault()}},[t,n,x.paused]);return h.jsx(Ae.div,{tabIndex:-1,...l,ref:y,onKeyDown:S})});Pi.displayName=HN;function UN(r,{select:e=!1}={}){const t=document.activeElement;for(const n of r)if(ka(n,{select:e}),document.activeElement!==t)return}function $N(r){const e=Nb(r),t=J0(e,r),n=J0(e.reverse(),r);return[t,n]}function Nb(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const o=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||o?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function J0(r,e){for(const t of r)if(!BN(t,{upTo:e}))return t}function BN(r,{upTo:e}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e!==void 0&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function QN(r){return r instanceof HTMLInputElement&&"select"in r}function ka(r,{select:e=!1}={}){if(r&&r.focus){const t=document.activeElement;r.focus({preventScroll:!0}),r!==t&&QN(r)&&e&&r.select()}}var ev=GN();function GN(){let r=[];return{add(e){const t=r[0];e!==t&&t?.pause(),r=tv(r,e),r.unshift(e)},remove(e){r=tv(r,e),r[0]?.resume()}}}function tv(r,e){const t=[...r],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function FN(r){return r.filter(e=>e.tagName!=="A")}var VN="Portal",Ii=w.forwardRef((r,e)=>{const{container:t,...n}=r,[o,i]=w.useState(!1);sn(()=>i(!0),[]);const l=t||o&&globalThis?.document?.body;return l?VR.createPortal(h.jsx(Ae.div,{...n,ref:e}),l):null});Ii.displayName=VN;var Xf=0;function Fl(){w.useEffect(()=>{const r=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",r[0]??nv()),document.body.insertAdjacentElement("beforeend",r[1]??nv()),Xf++,()=>{Xf===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Xf--}},[])}function nv(){const r=document.createElement("span");return r.setAttribute("data-radix-focus-guard",""),r.tabIndex=0,r.style.outline="none",r.style.opacity="0",r.style.position="fixed",r.style.pointerEvents="none",r}var fs=function(){return fs=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},fs.apply(this,arguments)};function kb(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(t[n[o]]=r[n[o]]);return t}function KN(r,e,t){if(t||arguments.length===2)for(var n=0,o=e.length,i;n<o;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}var xl="right-scroll-bar-position",wl="width-before-scroll-bar",YN="with-scroll-bars-hidden",XN="--removed-body-scroll-bar-size";function Wf(r,e){return typeof r=="function"?r(e):r&&(r.current=e),r}function WN(r,e){var t=w.useState(function(){return{value:r,callback:e,facade:{get current(){return t.value},set current(n){var o=t.value;o!==n&&(t.value=n,t.callback(n,o))}}}})[0];return t.callback=e,t.facade}var ZN=typeof window<"u"?w.useLayoutEffect:w.useEffect,sv=new WeakMap;function JN(r,e){var t=WN(null,function(n){return r.forEach(function(o){return Wf(o,n)})});return ZN(function(){var n=sv.get(t);if(n){var o=new Set(n),i=new Set(r),l=t.current;o.forEach(function(u){i.has(u)||Wf(u,null)}),i.forEach(function(u){o.has(u)||Wf(u,l)})}sv.set(t,r)},[r]),t}function ek(r){return r}function tk(r,e){e===void 0&&(e=ek);var t=[],n=!1,o={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:r},useMedium:function(i){var l=e(i,n);return t.push(l),function(){t=t.filter(function(u){return u!==l})}},assignSyncMedium:function(i){for(n=!0;t.length;){var l=t;t=[],l.forEach(i)}t={push:function(u){return i(u)},filter:function(){return t}}},assignMedium:function(i){n=!0;var l=[];if(t.length){var u=t;t=[],u.forEach(i),l=t}var f=function(){var g=l;l=[],g.forEach(i)},p=function(){return Promise.resolve().then(f)};p(),t={push:function(g){l.push(g),p()},filter:function(g){return l=l.filter(g),t}}}};return o}function nk(r){r===void 0&&(r={});var e=tk(null);return e.options=fs({async:!0,ssr:!1},r),e}var Db=function(r){var e=r.sideCar,t=kb(r,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return w.createElement(n,fs({},t))};Db.isSideCarExport=!0;function sk(r,e){return r.useMedium(e),Db}var jb=nk(),Zf=function(){},Vl=w.forwardRef(function(r,e){var t=w.useRef(null),n=w.useState({onScrollCapture:Zf,onWheelCapture:Zf,onTouchMoveCapture:Zf}),o=n[0],i=n[1],l=r.forwardProps,u=r.children,f=r.className,p=r.removeScrollBar,g=r.enabled,m=r.shards,y=r.sideCar,x=r.noRelative,S=r.noIsolation,C=r.inert,E=r.allowPinchZoom,M=r.as,A=M===void 0?"div":M,T=r.gapMode,N=kb(r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),D=y,q=JN([t,e]),P=fs(fs({},N),o);return w.createElement(w.Fragment,null,g&&w.createElement(D,{sideCar:jb,removeScrollBar:p,shards:m,noRelative:x,noIsolation:S,inert:C,setCallbacks:i,allowPinchZoom:!!E,lockRef:t,gapMode:T}),l?w.cloneElement(w.Children.only(u),fs(fs({},P),{ref:q})):w.createElement(A,fs({},P,{className:f,ref:q}),u))});Vl.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Vl.classNames={fullWidth:wl,zeroRight:xl};var ak=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function ok(){if(!document)return null;var r=document.createElement("style");r.type="text/css";var e=ak();return e&&r.setAttribute("nonce",e),r}function rk(r,e){r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}function ik(r){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(r)}var ck=function(){var r=0,e=null;return{add:function(t){r==0&&(e=ok())&&(rk(e,t),ik(e)),r++},remove:function(){r--,!r&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},lk=function(){var r=ck();return function(e,t){w.useEffect(function(){return r.add(e),function(){r.remove()}},[e&&t])}},_b=function(){var r=lk(),e=function(t){var n=t.styles,o=t.dynamic;return r(n,o),null};return e},uk={left:0,top:0,right:0,gap:0},Jf=function(r){return parseInt(r||"",10)||0},dk=function(r){var e=window.getComputedStyle(document.body),t=e[r==="padding"?"paddingLeft":"marginLeft"],n=e[r==="padding"?"paddingTop":"marginTop"],o=e[r==="padding"?"paddingRight":"marginRight"];return[Jf(t),Jf(n),Jf(o)]},fk=function(r){if(r===void 0&&(r="margin"),typeof window>"u")return uk;var e=dk(r),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},hk=_b(),fr="data-scroll-locked",pk=function(r,e,t,n){var o=r.left,i=r.top,l=r.right,u=r.gap;return t===void 0&&(t="margin"),`
  .`.concat(YN,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(u,"px ").concat(n,`;
  }
  body[`).concat(fr,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(o,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(l,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(u,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(u,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(xl,` {
    right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(wl,` {
    margin-right: `).concat(u,"px ").concat(n,`;
  }
  
  .`).concat(xl," .").concat(xl,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(wl," .").concat(wl,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(fr,`] {
    `).concat(XN,": ").concat(u,`px;
  }
`)},av=function(){var r=parseInt(document.body.getAttribute(fr)||"0",10);return isFinite(r)?r:0},gk=function(){w.useEffect(function(){return document.body.setAttribute(fr,(av()+1).toString()),function(){var r=av()-1;r<=0?document.body.removeAttribute(fr):document.body.setAttribute(fr,r.toString())}},[])},mk=function(r){var e=r.noRelative,t=r.noImportant,n=r.gapMode,o=n===void 0?"margin":n;gk();var i=w.useMemo(function(){return fk(o)},[o]);return w.createElement(hk,{styles:pk(i,!e,o,t?"":"!important")})},dh=!1;if(typeof window<"u")try{var ll=Object.defineProperty({},"passive",{get:function(){return dh=!0,!0}});window.addEventListener("test",ll,ll),window.removeEventListener("test",ll,ll)}catch{dh=!1}var ir=dh?{passive:!1}:!1,yk=function(r){return r.tagName==="TEXTAREA"},zb=function(r,e){if(!(r instanceof Element))return!1;var t=window.getComputedStyle(r);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!yk(r)&&t[e]==="visible")},vk=function(r){return zb(r,"overflowY")},bk=function(r){return zb(r,"overflowX")},ov=function(r,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var o=Lb(r,n);if(o){var i=Ob(r,n),l=i[1],u=i[2];if(l>u)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},xk=function(r){var e=r.scrollTop,t=r.scrollHeight,n=r.clientHeight;return[e,t,n]},wk=function(r){var e=r.scrollLeft,t=r.scrollWidth,n=r.clientWidth;return[e,t,n]},Lb=function(r,e){return r==="v"?vk(e):bk(e)},Ob=function(r,e){return r==="v"?xk(e):wk(e)},Sk=function(r,e){return r==="h"&&e==="rtl"?-1:1},Ck=function(r,e,t,n,o){var i=Sk(r,window.getComputedStyle(e).direction),l=i*n,u=t.target,f=e.contains(u),p=!1,g=l>0,m=0,y=0;do{if(!u)break;var x=Ob(r,u),S=x[0],C=x[1],E=x[2],M=C-E-i*S;(S||M)&&Lb(r,u)&&(m+=M,y+=S);var A=u.parentNode;u=A&&A.nodeType===Node.DOCUMENT_FRAGMENT_NODE?A.host:A}while(!f&&u!==document.body||f&&(e.contains(u)||e===u));return(g&&Math.abs(m)<1||!g&&Math.abs(y)<1)&&(p=!0),p},ul=function(r){return"changedTouches"in r?[r.changedTouches[0].clientX,r.changedTouches[0].clientY]:[0,0]},rv=function(r){return[r.deltaX,r.deltaY]},iv=function(r){return r&&"current"in r?r.current:r},Mk=function(r,e){return r[0]===e[0]&&r[1]===e[1]},Ek=function(r){return`
  .block-interactivity-`.concat(r,` {pointer-events: none;}
  .allow-interactivity-`).concat(r,` {pointer-events: all;}
`)},Rk=0,cr=[];function Tk(r){var e=w.useRef([]),t=w.useRef([0,0]),n=w.useRef(),o=w.useState(Rk++)[0],i=w.useState(_b)[0],l=w.useRef(r);w.useEffect(function(){l.current=r},[r]),w.useEffect(function(){if(r.inert){document.body.classList.add("block-interactivity-".concat(o));var C=KN([r.lockRef.current],(r.shards||[]).map(iv),!0).filter(Boolean);return C.forEach(function(E){return E.classList.add("allow-interactivity-".concat(o))}),function(){document.body.classList.remove("block-interactivity-".concat(o)),C.forEach(function(E){return E.classList.remove("allow-interactivity-".concat(o))})}}},[r.inert,r.lockRef.current,r.shards]);var u=w.useCallback(function(C,E){if("touches"in C&&C.touches.length===2||C.type==="wheel"&&C.ctrlKey)return!l.current.allowPinchZoom;var M=ul(C),A=t.current,T="deltaX"in C?C.deltaX:A[0]-M[0],N="deltaY"in C?C.deltaY:A[1]-M[1],D,q=C.target,P=Math.abs(T)>Math.abs(N)?"h":"v";if("touches"in C&&P==="h"&&q.type==="range")return!1;var H=ov(P,q);if(!H)return!0;if(H?D=P:(D=P==="v"?"h":"v",H=ov(P,q)),!H)return!1;if(!n.current&&"changedTouches"in C&&(T||N)&&(n.current=D),!D)return!0;var J=n.current||D;return Ck(J,E,C,J==="h"?T:N)},[]),f=w.useCallback(function(C){var E=C;if(!(!cr.length||cr[cr.length-1]!==i)){var M="deltaY"in E?rv(E):ul(E),A=e.current.filter(function(D){return D.name===E.type&&(D.target===E.target||E.target===D.shadowParent)&&Mk(D.delta,M)})[0];if(A&&A.should){E.cancelable&&E.preventDefault();return}if(!A){var T=(l.current.shards||[]).map(iv).filter(Boolean).filter(function(D){return D.contains(E.target)}),N=T.length>0?u(E,T[0]):!l.current.noIsolation;N&&E.cancelable&&E.preventDefault()}}},[]),p=w.useCallback(function(C,E,M,A){var T={name:C,delta:E,target:M,should:A,shadowParent:Ak(M)};e.current.push(T),setTimeout(function(){e.current=e.current.filter(function(N){return N!==T})},1)},[]),g=w.useCallback(function(C){t.current=ul(C),n.current=void 0},[]),m=w.useCallback(function(C){p(C.type,rv(C),C.target,u(C,r.lockRef.current))},[]),y=w.useCallback(function(C){p(C.type,ul(C),C.target,u(C,r.lockRef.current))},[]);w.useEffect(function(){return cr.push(i),r.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:y}),document.addEventListener("wheel",f,ir),document.addEventListener("touchmove",f,ir),document.addEventListener("touchstart",g,ir),function(){cr=cr.filter(function(C){return C!==i}),document.removeEventListener("wheel",f,ir),document.removeEventListener("touchmove",f,ir),document.removeEventListener("touchstart",g,ir)}},[]);var x=r.removeScrollBar,S=r.inert;return w.createElement(w.Fragment,null,S?w.createElement(i,{styles:Ek(o)}):null,x?w.createElement(mk,{noRelative:r.noRelative,gapMode:r.gapMode}):null)}function Ak(r){for(var e=null;r!==null;)r instanceof ShadowRoot&&(e=r.host,r=r.host),r=r.parentNode;return e}const Nk=sk(jb,Tk);var qi=w.forwardRef(function(r,e){return w.createElement(Vl,fs({},r,{ref:e,sideCar:Nk}))});qi.classNames=Vl.classNames;var kk=function(r){if(typeof document>"u")return null;var e=Array.isArray(r)?r[0]:r;return e.ownerDocument.body},lr=new WeakMap,dl=new WeakMap,fl={},eh=0,Pb=function(r){return r&&(r.host||Pb(r.parentNode))},Dk=function(r,e){return e.map(function(t){if(r.contains(t))return t;var n=Pb(t);return n&&r.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",r,". Doing nothing"),null)}).filter(function(t){return!!t})},jk=function(r,e,t,n){var o=Dk(e,Array.isArray(r)?r:[r]);fl[t]||(fl[t]=new WeakMap);var i=fl[t],l=[],u=new Set,f=new Set(o),p=function(m){!m||u.has(m)||(u.add(m),p(m.parentNode))};o.forEach(p);var g=function(m){!m||f.has(m)||Array.prototype.forEach.call(m.children,function(y){if(u.has(y))g(y);else try{var x=y.getAttribute(n),S=x!==null&&x!=="false",C=(lr.get(y)||0)+1,E=(i.get(y)||0)+1;lr.set(y,C),i.set(y,E),l.push(y),C===1&&S&&dl.set(y,!0),E===1&&y.setAttribute(t,"true"),S||y.setAttribute(n,"true")}catch(M){console.error("aria-hidden: cannot operate on ",y,M)}})};return g(e),u.clear(),eh++,function(){l.forEach(function(m){var y=lr.get(m)-1,x=i.get(m)-1;lr.set(m,y),i.set(m,x),y||(dl.has(m)||m.removeAttribute(n),dl.delete(m)),x||m.removeAttribute(t)}),eh--,eh||(lr=new WeakMap,lr=new WeakMap,dl=new WeakMap,fl={})}},Kl=function(r,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(r)?r:[r]),o=kk(r);return o?(n.push.apply(n,Array.from(o.querySelectorAll("[aria-live], script"))),jk(n,o,t,"aria-hidden")):function(){return null}};function _k(r){const e=zk(r),t=w.forwardRef((n,o)=>{const{children:i,...l}=n,u=w.Children.toArray(i),f=u.find(Ok);if(f){const p=f.props.children,g=u.map(m=>m===f?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:m);return h.jsx(e,{...l,ref:o,children:w.isValidElement(p)?w.cloneElement(p,void 0,g):null})}return h.jsx(e,{...l,ref:o,children:i})});return t.displayName=`${r}.Slot`,t}function zk(r){const e=w.forwardRef((t,n)=>{const{children:o,...i}=t;if(w.isValidElement(o)){const l=Ik(o),u=Pk(i,o.props);return o.type!==w.Fragment&&(u.ref=n?Ss(n,l):l),w.cloneElement(o,u)}return w.Children.count(o)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var Lk=Symbol("radix.slottable");function Ok(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===Lk}function Pk(r,e){const t={...e};for(const n in e){const o=r[n],i=e[n];/^on[A-Z]/.test(n)?o&&i?t[n]=(...u)=>{const f=i(...u);return o(...u),f}:o&&(t[n]=o):n==="style"?t[n]={...o,...i}:n==="className"&&(t[n]=[o,i].filter(Boolean).join(" "))}return{...r,...t}}function Ik(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var Yl="Dialog",[Ib,qb]=bn(Yl),[qk,os]=Ib(Yl),Hb=r=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:o,onOpenChange:i,modal:l=!0}=r,u=w.useRef(null),f=w.useRef(null),[p,g]=xs({prop:n,defaultProp:o??!1,onChange:i,caller:Yl});return h.jsx(qk,{scope:e,triggerRef:u,contentRef:f,contentId:ns(),titleId:ns(),descriptionId:ns(),open:p,onOpenChange:g,onOpenToggle:w.useCallback(()=>g(m=>!m),[g]),modal:l,children:t})};Hb.displayName=Yl;var Ub="DialogTrigger",$b=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,o=os(Ub,t),i=je(e,o.triggerRef);return h.jsx(Ae.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":Vh(o.open),...n,ref:i,onClick:ge(r.onClick,o.onOpenToggle)})});$b.displayName=Ub;var Gh="DialogPortal",[Hk,Bb]=Ib(Gh,{forceMount:void 0}),Qb=r=>{const{__scopeDialog:e,forceMount:t,children:n,container:o}=r,i=os(Gh,e);return h.jsx(Hk,{scope:e,forceMount:t,children:w.Children.map(n,l=>h.jsx(rn,{present:t||i.open,children:h.jsx(Ii,{asChild:!0,container:o,children:l})}))})};Qb.displayName=Gh;var Dl="DialogOverlay",Gb=w.forwardRef((r,e)=>{const t=Bb(Dl,r.__scopeDialog),{forceMount:n=t.forceMount,...o}=r,i=os(Dl,r.__scopeDialog);return i.modal?h.jsx(rn,{present:n||i.open,children:h.jsx($k,{...o,ref:e})}):null});Gb.displayName=Dl;var Uk=_k("DialogOverlay.RemoveScroll"),$k=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,o=os(Dl,t);return h.jsx(qi,{as:Uk,allowPinchZoom:!0,shards:[o.contentRef],children:h.jsx(Ae.div,{"data-state":Vh(o.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),po="DialogContent",Fb=w.forwardRef((r,e)=>{const t=Bb(po,r.__scopeDialog),{forceMount:n=t.forceMount,...o}=r,i=os(po,r.__scopeDialog);return h.jsx(rn,{present:n||i.open,children:i.modal?h.jsx(Bk,{...o,ref:e}):h.jsx(Qk,{...o,ref:e})})});Fb.displayName=po;var Bk=w.forwardRef((r,e)=>{const t=os(po,r.__scopeDialog),n=w.useRef(null),o=je(e,t.contentRef,n);return w.useEffect(()=>{const i=n.current;if(i)return Kl(i)},[]),h.jsx(Vb,{...r,ref:o,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(r.onCloseAutoFocus,i=>{i.preventDefault(),t.triggerRef.current?.focus()}),onPointerDownOutside:ge(r.onPointerDownOutside,i=>{const l=i.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0;(l.button===2||u)&&i.preventDefault()}),onFocusOutside:ge(r.onFocusOutside,i=>i.preventDefault())})}),Qk=w.forwardRef((r,e)=>{const t=os(po,r.__scopeDialog),n=w.useRef(!1),o=w.useRef(!1);return h.jsx(Vb,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{r.onCloseAutoFocus?.(i),i.defaultPrevented||(n.current||t.triggerRef.current?.focus(),i.preventDefault()),n.current=!1,o.current=!1},onInteractOutside:i=>{r.onInteractOutside?.(i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const l=i.target;t.triggerRef.current?.contains(l)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&o.current&&i.preventDefault()}})}),Vb=w.forwardRef((r,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:i,...l}=r,u=os(po,t),f=w.useRef(null),p=je(e,f);return Fl(),h.jsxs(h.Fragment,{children:[h.jsx(Pi,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:o,onUnmountAutoFocus:i,children:h.jsx(Oi,{role:"dialog",id:u.contentId,"aria-describedby":u.descriptionId,"aria-labelledby":u.titleId,"data-state":Vh(u.open),...l,ref:p,onDismiss:()=>u.onOpenChange(!1)})}),h.jsxs(h.Fragment,{children:[h.jsx(Fk,{titleId:u.titleId}),h.jsx(Kk,{contentRef:f,descriptionId:u.descriptionId})]})]})}),Fh="DialogTitle",Kb=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,o=os(Fh,t);return h.jsx(Ae.h2,{id:o.titleId,...n,ref:e})});Kb.displayName=Fh;var Yb="DialogDescription",Xb=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,o=os(Yb,t);return h.jsx(Ae.p,{id:o.descriptionId,...n,ref:e})});Xb.displayName=Yb;var Wb="DialogClose",Zb=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,o=os(Wb,t);return h.jsx(Ae.button,{type:"button",...n,ref:e,onClick:ge(r.onClick,()=>o.onOpenChange(!1))})});Zb.displayName=Wb;function Vh(r){return r?"open":"closed"}var Jb="DialogTitleWarning",[Gk,ex]=sN(Jb,{contentName:po,titleName:Fh,docsSlug:"dialog"}),Fk=({titleId:r})=>{const e=ex(Jb),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return w.useEffect(()=>{r&&(document.getElementById(r)||console.error(t))},[t,r]),null},Vk="DialogDescriptionWarning",Kk=({contentRef:r,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${ex(Vk).contentName}}.`;return w.useEffect(()=>{const o=r.current?.getAttribute("aria-describedby");e&&o&&(document.getElementById(e)||console.warn(n))},[n,r,e]),null},tx=Hb,Yk=$b,nx=Qb,Kh=Gb,Yh=Fb,Xh=Kb,Wh=Xb,Zh=Zb,Xk=Symbol("radix.slottable");function Wk(r){const e=({children:t})=>h.jsx(h.Fragment,{children:t});return e.displayName=`${r}.Slottable`,e.__radixId=Xk,e}var sx="AlertDialog",[Zk]=bn(sx,[qb]),aa=qb(),ax=r=>{const{__scopeAlertDialog:e,...t}=r,n=aa(e);return h.jsx(tx,{...n,...t,modal:!0})};ax.displayName=sx;var Jk="AlertDialogTrigger",eD=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,o=aa(t);return h.jsx(Yk,{...o,...n,ref:e})});eD.displayName=Jk;var tD="AlertDialogPortal",ox=r=>{const{__scopeAlertDialog:e,...t}=r,n=aa(e);return h.jsx(nx,{...n,...t})};ox.displayName=tD;var nD="AlertDialogOverlay",rx=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,o=aa(t);return h.jsx(Kh,{...o,...n,ref:e})});rx.displayName=nD;var hr="AlertDialogContent",[sD,aD]=Zk(hr),oD=Wk("AlertDialogContent"),ix=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,children:n,...o}=r,i=aa(t),l=w.useRef(null),u=je(e,l),f=w.useRef(null);return h.jsx(Gk,{contentName:hr,titleName:cx,docsSlug:"alert-dialog",children:h.jsx(sD,{scope:t,cancelRef:f,children:h.jsxs(Yh,{role:"alertdialog",...i,...o,ref:u,onOpenAutoFocus:ge(o.onOpenAutoFocus,p=>{p.preventDefault(),f.current?.focus({preventScroll:!0})}),onPointerDownOutside:p=>p.preventDefault(),onInteractOutside:p=>p.preventDefault(),children:[h.jsx(oD,{children:n}),h.jsx(iD,{contentRef:l})]})})})});ix.displayName=hr;var cx="AlertDialogTitle",lx=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,o=aa(t);return h.jsx(Xh,{...o,...n,ref:e})});lx.displayName=cx;var ux="AlertDialogDescription",dx=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,o=aa(t);return h.jsx(Wh,{...o,...n,ref:e})});dx.displayName=ux;var rD="AlertDialogAction",fx=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,o=aa(t);return h.jsx(Zh,{...o,...n,ref:e})});fx.displayName=rD;var hx="AlertDialogCancel",px=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,{cancelRef:o}=aD(hx,t),i=aa(t),l=je(e,o);return h.jsx(Zh,{...i,...n,ref:l})});px.displayName=hx;var iD=({contentRef:r})=>{const e=`\`${hr}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${hr}\` by passing a \`${ux}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${hr}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return w.useEffect(()=>{document.getElementById(r.current?.getAttribute("aria-describedby"))||console.warn(e)},[e,r]),null},cD=ax,lD=ox,gx=rx,mx=ix,yx=fx,vx=px,bx=lx,xx=dx;const wx=cD,uD=lD,Sx=w.forwardRef(({className:r,...e},t)=>h.jsx(gx,{className:Ee("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e,ref:t}));Sx.displayName=gx.displayName;const Jh=w.forwardRef(({className:r,...e},t)=>h.jsxs(uD,{children:[h.jsx(Sx,{}),h.jsx(mx,{ref:t,className:Ee("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...e})]}));Jh.displayName=mx.displayName;const Cx=({className:r,...e})=>h.jsx("div",{className:Ee("flex flex-col space-y-2 text-center sm:text-left",r),...e});Cx.displayName="AlertDialogHeader";const Mx=({className:r,...e})=>h.jsx("div",{className:Ee("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...e});Mx.displayName="AlertDialogFooter";const ep=w.forwardRef(({className:r,...e},t)=>h.jsx(bx,{ref:t,className:Ee("text-lg font-semibold",r),...e}));ep.displayName=bx.displayName;const tp=w.forwardRef(({className:r,...e},t)=>h.jsx(xx,{ref:t,className:Ee("text-sm text-muted-foreground",r),...e}));tp.displayName=xx.displayName;const np=w.forwardRef(({className:r,...e},t)=>h.jsx(yx,{ref:t,className:Ee(zh(),r),...e}));np.displayName=yx.displayName;const sp=w.forwardRef(({className:r,...e},t)=>h.jsx(vx,{ref:t,className:Ee(zh({variant:"outline"}),"mt-2 sm:mt-0",r),...e}));sp.displayName=vx.displayName;const ap=tx,dD=nx,Ex=w.forwardRef(({className:r,...e},t)=>h.jsx(Kh,{ref:t,className:Ee("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e}));Ex.displayName=Kh.displayName;const Xl=w.forwardRef(({className:r,children:e,...t},n)=>h.jsxs(dD,{children:[h.jsx(Ex,{}),h.jsxs(Yh,{ref:n,className:Ee("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...t,children:[e,h.jsxs(Zh,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[h.jsx(vs,{className:"h-4 w-4"}),h.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Xl.displayName=Yh.displayName;const Wl=({className:r,...e})=>h.jsx("div",{className:Ee("flex flex-col space-y-1.5 text-center sm:text-left",r),...e});Wl.displayName="DialogHeader";const Zl=({className:r,...e})=>h.jsx("div",{className:Ee("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...e});Zl.displayName="DialogFooter";const Jl=w.forwardRef(({className:r,...e},t)=>h.jsx(Xh,{ref:t,className:Ee("text-lg font-semibold leading-none tracking-tight",r),...e}));Jl.displayName=Xh.displayName;const eu=w.forwardRef(({className:r,...e},t)=>h.jsx(Wh,{ref:t,className:Ee("text-sm text-muted-foreground",r),...e}));eu.displayName=Wh.displayName;var fD=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],hD=fD.reduce((r,e)=>{const t=Dh(`Primitive.${e}`),n=w.forwardRef((o,i)=>{const{asChild:l,...u}=o,f=l?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),h.jsx(f,{...u,ref:i})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{}),pD="Label",Rx=w.forwardRef((r,e)=>h.jsx(hD.label,{...r,ref:e,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(r.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));Rx.displayName=pD;var Tx=Rx;const gD=jh("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),st=w.forwardRef(({className:r,...e},t)=>h.jsx(Tx,{ref:t,className:Ee(gD(),r),...e}));st.displayName=Tx.displayName;function op({open:r,initialName:e="",onConfirm:t,onCancel:n}){const[o,i]=w.useState(e);w.useEffect(()=>{r&&i(e)},[r,e]);const l=()=>{o.trim()&&t(o.trim())};return h.jsx(ap,{open:r,onOpenChange:u=>!u&&n(),children:h.jsxs(Xl,{children:[h.jsxs(Wl,{children:[h.jsx(Jl,{children:e?"Rename Group":"Create Group"}),h.jsx(eu,{children:e?"Enter a new name for the group":"Enter a name for the new group"})]}),h.jsxs("div",{className:"py-4",children:[h.jsx(st,{htmlFor:"group-name",children:"Group Name"}),h.jsx(Nt,{id:"group-name",value:o,onChange:u=>i(u.target.value),onKeyDown:u=>{u.key==="Enter"&&l()},className:"mt-2",autoFocus:!0})]}),h.jsxs(Zl,{children:[h.jsx(Ne,{variant:"outline",onClick:n,children:"Cancel"}),h.jsx(Ne,{onClick:l,disabled:!o.trim(),children:e?"Save":"Create"})]})]})})}function mD(){const{zoom:r,setZoom:e,diagramName:t,setDiagramName:n,saveDiagram:o,loadDiagramState:i,undo:l,redo:u,selectedNodeId:f,createGroupFromSelection:p,autoGroupByConnections:g,nodes:m,pan:y,setPan:x,viewportWidth:S,viewportHeight:C}=Re(),{canUndo:E,canRedo:M}=Mi(),A=w.useRef(null),[T,N]=w.useState(!1),[D,q]=w.useState(t),[P,H]=w.useState(!1),{showMinimap:J,toggleMinimap:se,showHeatMapLegend:ce,toggleHeatMapLegend:Z,showRuler:te,toggleRuler:le}=Li(),ue=()=>e(Math.min(r+.1,2)),z=()=>e(r-.1),j=()=>{const oe=m;if(!oe.length){e(1),x({x:0,y:0});return}const $=100,V=oe.map(Gt=>Gt.position.x),pe=oe.map(Gt=>Gt.position.y),me=oe.map(Gt=>Gt.position.x+140),ye=oe.map(Gt=>Gt.position.y+140),ve=Math.min(...V)-$,_e=Math.min(...pe)-$,Ue=Math.max(...me)+$,at=Math.max(...ye)+$,Ze=Ue-ve,Dt=at-_e,de=S||window.innerWidth,He=C||window.innerHeight-56,$e=de/Ze,yt=He/Dt;let pt=Math.min($e,yt);pt=Math.min(Math.max(pt,.2),2.5);const qt=ve+Ze/2,Je=_e+Dt/2,jt=de/2,vt=He/2,gt=jt-qt*pt,Yt=vt-Je*pt;e(pt),x({x:gt,y:Yt})},O=()=>{o(),Ke.success("Diagram saved to browser storage")},X=()=>{const oe=`${t.replace(/\s+/g,"_")}_${Date.now()}.json`;UT(Re.getState(),oe),Ke.success("Diagram exported as JSON")},he=()=>{A.current?.click()},_=async oe=>{const $=oe.target.files?.[0];if($){try{const V=await $T($);if(!V){Ke.error("Failed to import diagram: Invalid file format");return}i({nodes:V.nodes||[],connections:V.connections||[],groups:V.groups||[],zoom:V.zoom||1,pan:V.pan||{x:0,y:0}}),n(V.name),Ke.success(`Diagram "${V.name}" imported successfully`)}catch(V){Ke.error("Failed to import diagram"),ta("Failed to import diagram",V instanceof Error?V:new Error(String(V)))}A.current&&(A.current.value="")}},Q=()=>{D.trim()&&(n(D.trim()),Ke.success("Diagram renamed")),N(!1)},Y=()=>{const{nodes:oe}=Re.getState();if(oe.filter(V=>V.selected||V.id===f).length===0){Ke.error("Select at least one component to create a group");return}H(!0)},ae=oe=>{p(oe),Ke.success(`Group "${oe}" created`),H(!1)},B=()=>{g(),Ke.success("Groups created automatically from connections")};return h.jsxs(h.Fragment,{children:[h.jsx(op,{open:P,onConfirm:ae,onCancel:()=>H(!1)}),h.jsxs("div",{className:"h-14 bg-toolbar-bg border-b border-border flex items-center justify-between px-4",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("button",{onClick:()=>N(!0),className:"text-lg font-semibold text-foreground hover:text-primary transition-colors cursor-pointer",title:"Click to rename diagram",children:[h.jsx("span",{className:"text-primary",children:"Archi"}),"Phoenix",h.jsxs("span",{className:"text-xs text-secondary-foreground ml-2",children:[" ",t]})]}),h.jsx(vn,{orientation:"vertical",className:"h-6 mx-2"}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:l,disabled:!E,title:"Undo (Ctrl/Cmd+Z)",children:h.jsx(P2,{className:"h-4 w-4"})}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:u,disabled:!M,title:"Redo (Ctrl/Cmd+Shift+Z or Ctrl/Cmd+Y)",children:h.jsx(g2,{className:"h-4 w-4"})})]}),h.jsx(vn,{orientation:"vertical",className:"h-6 mx-2"}),h.jsx(bN,{})]}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsxs("div",{className:"flex items-center gap-1 bg-secondary/50 rounded-md p-1",children:[h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:ue,title:"Zoom In",children:h.jsx(B2,{className:"h-4 w-4"})}),h.jsxs("span",{className:"text-sm font-mono px-2 min-w-[60px] text-center",children:[Math.round(r*100),"%"]}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:z,title:"Zoom Out",children:h.jsx(G2,{className:"h-4 w-4"})}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:j,title:"Fit to View",children:h.jsx(a2,{className:"h-4 w-4"})})]}),h.jsx(vn,{orientation:"vertical",className:"h-6"}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:O,title:"Save diagram to browser storage (auto-saves on changes)",children:h.jsx(S2,{className:"h-4 w-4"})}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:X,title:"Export diagram as JSON file",children:h.jsx(UA,{className:"h-4 w-4"})}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-9 w-9",onClick:he,title:"Import diagram from JSON file",children:h.jsx(q2,{className:"h-4 w-4"})}),h.jsx(vn,{orientation:"vertical",className:"h-6"}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-9 w-9",title:"Create group from selection",onClick:Y,disabled:!f,children:h.jsx(lb,{className:"h-4 w-4"})}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-9 w-9",title:"Auto-group by connections",onClick:B,children:h.jsx(A2,{className:"h-4 w-4"})}),h.jsx(vn,{orientation:"vertical",className:"h-6"}),h.jsx(F2,{}),h.jsx(Ne,{variant:J?"default":"ghost",size:"icon",className:"h-9 w-9",title:J?"Hide minimap":"Show minimap",onClick:se,children:h.jsx(n2,{className:"h-4 w-4"})}),h.jsx(Ne,{variant:ce?"default":"ghost",size:"icon",className:"h-9 w-9",title:ce?"Hide heat map legend":"Show heat map legend",onClick:Z,children:h.jsx(ho,{className:"h-4 w-4"})}),h.jsx(Ne,{variant:te?"default":"ghost",size:"icon",className:"h-9 w-9",title:te?"Hide ruler":"Show ruler",onClick:le,children:h.jsx(x2,{className:"h-4 w-4"})}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-9 w-9",title:"Settings",children:h.jsx(R2,{className:"h-4 w-4"})})]})]}),h.jsx("input",{ref:A,type:"file",accept:".json",onChange:_,className:"hidden","aria-label":"Import diagram from file"}),h.jsx(wx,{open:T,onOpenChange:N,children:h.jsxs(Jh,{children:[h.jsx(ep,{children:"Rename Diagram"}),h.jsx(tp,{children:"Enter a new name for your diagram"}),h.jsx("div",{className:"py-4",children:h.jsx(Nt,{value:D,onChange:oe=>q(oe.target.value),placeholder:"Diagram name",onKeyDown:oe=>{oe.key==="Enter"&&Q()},autoFocus:!0})}),h.jsxs("div",{className:"flex gap-2 justify-end",children:[h.jsx(sp,{children:"Cancel"}),h.jsx(np,{onClick:Q,children:"Save"})]})]})})]})}function cv(r){const e=yD(r),t=w.forwardRef((n,o)=>{const{children:i,...l}=n,u=w.Children.toArray(i),f=u.find(bD);if(f){const p=f.props.children,g=u.map(m=>m===f?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:m);return h.jsx(e,{...l,ref:o,children:w.isValidElement(p)?w.cloneElement(p,void 0,g):null})}return h.jsx(e,{...l,ref:o,children:i})});return t.displayName=`${r}.Slot`,t}function yD(r){const e=w.forwardRef((t,n)=>{const{children:o,...i}=t;if(w.isValidElement(o)){const l=wD(o),u=xD(i,o.props);return o.type!==w.Fragment&&(u.ref=n?Ss(n,l):l),w.cloneElement(o,u)}return w.Children.count(o)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var vD=Symbol("radix.slottable");function bD(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===vD}function xD(r,e){const t={...e};for(const n in e){const o=r[n],i=e[n];/^on[A-Z]/.test(n)?o&&i?t[n]=(...u)=>{const f=i(...u);return o(...u),f}:o&&(t[n]=o):n==="style"?t[n]={...o,...i}:n==="className"&&(t[n]=[o,i].filter(Boolean).join(" "))}return{...r,...t}}function wD(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function tu(r){const e=r+"CollectionProvider",[t,n]=bn(e),[o,i]=t(e,{collectionRef:{current:null},itemMap:new Map}),l=C=>{const{scope:E,children:M}=C,A=Et.useRef(null),T=Et.useRef(new Map).current;return h.jsx(o,{scope:E,itemMap:T,collectionRef:A,children:M})};l.displayName=e;const u=r+"CollectionSlot",f=cv(u),p=Et.forwardRef((C,E)=>{const{scope:M,children:A}=C,T=i(u,M),N=je(E,T.collectionRef);return h.jsx(f,{ref:N,children:A})});p.displayName=u;const g=r+"CollectionItemSlot",m="data-radix-collection-item",y=cv(g),x=Et.forwardRef((C,E)=>{const{scope:M,children:A,...T}=C,N=Et.useRef(null),D=je(E,N),q=i(g,M);return Et.useEffect(()=>(q.itemMap.set(N,{ref:N,...T}),()=>void q.itemMap.delete(N))),h.jsx(y,{[m]:"",ref:D,children:A})});x.displayName=g;function S(C){const E=i(r+"CollectionConsumer",C);return Et.useCallback(()=>{const A=E.collectionRef.current;if(!A)return[];const T=Array.from(A.querySelectorAll(`[${m}]`));return Array.from(E.itemMap.values()).sort((q,P)=>T.indexOf(q.ref.current)-T.indexOf(P.ref.current))},[E.collectionRef,E.itemMap])}return[{Provider:l,Slot:p,ItemSlot:x},S,n]}var th="rovingFocusGroup.onEntryFocus",SD={bubbles:!1,cancelable:!0},Hi="RovingFocusGroup",[fh,Ax,CD]=tu(Hi),[MD,nu]=bn(Hi,[CD]),[ED,RD]=MD(Hi),Nx=w.forwardRef((r,e)=>h.jsx(fh.Provider,{scope:r.__scopeRovingFocusGroup,children:h.jsx(fh.Slot,{scope:r.__scopeRovingFocusGroup,children:h.jsx(TD,{...r,ref:e})})}));Nx.displayName=Hi;var TD=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:o=!1,dir:i,currentTabStopId:l,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:f,onEntryFocus:p,preventScrollOnEntryFocus:g=!1,...m}=r,y=w.useRef(null),x=je(e,y),S=Sr(i),[C,E]=xs({prop:l,defaultProp:u??null,onChange:f,caller:Hi}),[M,A]=w.useState(!1),T=nn(p),N=Ax(t),D=w.useRef(!1),[q,P]=w.useState(0);return w.useEffect(()=>{const H=y.current;if(H)return H.addEventListener(th,T),()=>H.removeEventListener(th,T)},[T]),h.jsx(ED,{scope:t,orientation:n,dir:S,loop:o,currentTabStopId:C,onItemFocus:w.useCallback(H=>E(H),[E]),onItemShiftTab:w.useCallback(()=>A(!0),[]),onFocusableItemAdd:w.useCallback(()=>P(H=>H+1),[]),onFocusableItemRemove:w.useCallback(()=>P(H=>H-1),[]),children:h.jsx(Ae.div,{tabIndex:M||q===0?-1:0,"data-orientation":n,...m,ref:x,style:{outline:"none",...r.style},onMouseDown:ge(r.onMouseDown,()=>{D.current=!0}),onFocus:ge(r.onFocus,H=>{const J=!D.current;if(H.target===H.currentTarget&&J&&!M){const se=new CustomEvent(th,SD);if(H.currentTarget.dispatchEvent(se),!se.defaultPrevented){const ce=N().filter(z=>z.focusable),Z=ce.find(z=>z.active),te=ce.find(z=>z.id===C),ue=[Z,te,...ce].filter(Boolean).map(z=>z.ref.current);jx(ue,g)}}D.current=!1}),onBlur:ge(r.onBlur,()=>A(!1))})})}),kx="RovingFocusGroupItem",Dx=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:o=!1,tabStopId:i,children:l,...u}=r,f=ns(),p=i||f,g=RD(kx,t),m=g.currentTabStopId===p,y=Ax(t),{onFocusableItemAdd:x,onFocusableItemRemove:S,currentTabStopId:C}=g;return w.useEffect(()=>{if(n)return x(),()=>S()},[n,x,S]),h.jsx(fh.ItemSlot,{scope:t,id:p,focusable:n,active:o,children:h.jsx(Ae.span,{tabIndex:m?0:-1,"data-orientation":g.orientation,...u,ref:e,onMouseDown:ge(r.onMouseDown,E=>{n?g.onItemFocus(p):E.preventDefault()}),onFocus:ge(r.onFocus,()=>g.onItemFocus(p)),onKeyDown:ge(r.onKeyDown,E=>{if(E.key==="Tab"&&E.shiftKey){g.onItemShiftTab();return}if(E.target!==E.currentTarget)return;const M=kD(E,g.orientation,g.dir);if(M!==void 0){if(E.metaKey||E.ctrlKey||E.altKey||E.shiftKey)return;E.preventDefault();let T=y().filter(N=>N.focusable).map(N=>N.ref.current);if(M==="last")T.reverse();else if(M==="prev"||M==="next"){M==="prev"&&T.reverse();const N=T.indexOf(E.currentTarget);T=g.loop?DD(T,N+1):T.slice(N+1)}setTimeout(()=>jx(T))}}),children:typeof l=="function"?l({isCurrentTabStop:m,hasTabStop:C!=null}):l})})});Dx.displayName=kx;var AD={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ND(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function kD(r,e,t){const n=ND(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return AD[n]}function jx(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function DD(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var _x=Nx,zx=Dx,su="Tabs",[jD]=bn(su,[nu]),Lx=nu(),[_D,rp]=jD(su),Ox=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:o,defaultValue:i,orientation:l="horizontal",dir:u,activationMode:f="automatic",...p}=r,g=Sr(u),[m,y]=xs({prop:n,onChange:o,defaultProp:i??"",caller:su});return h.jsx(_D,{scope:t,baseId:ns(),value:m,onValueChange:y,orientation:l,dir:g,activationMode:f,children:h.jsx(Ae.div,{dir:g,"data-orientation":l,...p,ref:e})})});Ox.displayName=su;var Px="TabsList",Ix=w.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...o}=r,i=rp(Px,t),l=Lx(t);return h.jsx(_x,{asChild:!0,...l,orientation:i.orientation,dir:i.dir,loop:n,children:h.jsx(Ae.div,{role:"tablist","aria-orientation":i.orientation,...o,ref:e})})});Ix.displayName=Px;var qx="TabsTrigger",Hx=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:o=!1,...i}=r,l=rp(qx,t),u=Lx(t),f=Bx(l.baseId,n),p=Qx(l.baseId,n),g=n===l.value;return h.jsx(zx,{asChild:!0,...u,focusable:!o,active:g,children:h.jsx(Ae.button,{type:"button",role:"tab","aria-selected":g,"aria-controls":p,"data-state":g?"active":"inactive","data-disabled":o?"":void 0,disabled:o,id:f,...i,ref:e,onMouseDown:ge(r.onMouseDown,m=>{!o&&m.button===0&&m.ctrlKey===!1?l.onValueChange(n):m.preventDefault()}),onKeyDown:ge(r.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&l.onValueChange(n)}),onFocus:ge(r.onFocus,()=>{const m=l.activationMode!=="manual";!g&&!o&&m&&l.onValueChange(n)})})})});Hx.displayName=qx;var Ux="TabsContent",$x=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:o,children:i,...l}=r,u=rp(Ux,t),f=Bx(u.baseId,n),p=Qx(u.baseId,n),g=n===u.value,m=w.useRef(g);return w.useEffect(()=>{const y=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(y)},[]),h.jsx(rn,{present:o||g,children:({present:y})=>h.jsx(Ae.div,{"data-state":g?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":f,hidden:!y,id:p,tabIndex:0,...l,ref:e,style:{...r.style,animationDuration:m.current?"0s":void 0},children:y&&i})})});$x.displayName=Ux;function Bx(r,e){return`${r}-trigger-${e}`}function Qx(r,e){return`${r}-content-${e}`}var zD=Ox,Gx=Ix,Fx=Hx,Vx=$x;const ip=zD,au=w.forwardRef(({className:r,...e},t)=>h.jsx(Gx,{ref:t,className:Ee("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",r),...e}));au.displayName=Gx.displayName;const hs=w.forwardRef(({className:r,...e},t)=>h.jsx(Fx,{ref:t,className:Ee("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",r),...e}));hs.displayName=Fx.displayName;const _a=w.forwardRef(({className:r,...e},t)=>h.jsx(Vx,{ref:t,className:Ee("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));_a.displayName=Vx.displayName;const LD=["top","right","bottom","left"],La=Math.min,Tn=Math.max,jl=Math.round,hl=Math.floor,bs=r=>({x:r,y:r}),OD={left:"right",right:"left",bottom:"top",top:"bottom"},PD={start:"end",end:"start"};function hh(r,e,t){return Tn(r,La(e,t))}function na(r,e){return typeof r=="function"?r(e):r}function sa(r){return r.split("-")[0]}function Cr(r){return r.split("-")[1]}function cp(r){return r==="x"?"y":"x"}function lp(r){return r==="y"?"height":"width"}const ID=new Set(["top","bottom"]);function gs(r){return ID.has(sa(r))?"y":"x"}function up(r){return cp(gs(r))}function qD(r,e,t){t===void 0&&(t=!1);const n=Cr(r),o=up(r),i=lp(o);let l=o==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(l=_l(l)),[l,_l(l)]}function HD(r){const e=_l(r);return[ph(r),e,ph(e)]}function ph(r){return r.replace(/start|end/g,e=>PD[e])}const lv=["left","right"],uv=["right","left"],UD=["top","bottom"],$D=["bottom","top"];function BD(r,e,t){switch(r){case"top":case"bottom":return t?e?uv:lv:e?lv:uv;case"left":case"right":return e?UD:$D;default:return[]}}function QD(r,e,t,n){const o=Cr(r);let i=BD(sa(r),t==="start",n);return o&&(i=i.map(l=>l+"-"+o),e&&(i=i.concat(i.map(ph)))),i}function _l(r){return r.replace(/left|right|bottom|top/g,e=>OD[e])}function GD(r){return{top:0,right:0,bottom:0,left:0,...r}}function Kx(r){return typeof r!="number"?GD(r):{top:r,right:r,bottom:r,left:r}}function zl(r){const{x:e,y:t,width:n,height:o}=r;return{width:n,height:o,top:t,left:e,right:e+n,bottom:t+o,x:e,y:t}}function dv(r,e,t){let{reference:n,floating:o}=r;const i=gs(e),l=up(e),u=lp(l),f=sa(e),p=i==="y",g=n.x+n.width/2-o.width/2,m=n.y+n.height/2-o.height/2,y=n[u]/2-o[u]/2;let x;switch(f){case"top":x={x:g,y:n.y-o.height};break;case"bottom":x={x:g,y:n.y+n.height};break;case"right":x={x:n.x+n.width,y:m};break;case"left":x={x:n.x-o.width,y:m};break;default:x={x:n.x,y:n.y}}switch(Cr(e)){case"start":x[l]-=y*(t&&p?-1:1);break;case"end":x[l]+=y*(t&&p?-1:1);break}return x}const FD=async(r,e,t)=>{const{placement:n="bottom",strategy:o="absolute",middleware:i=[],platform:l}=t,u=i.filter(Boolean),f=await(l.isRTL==null?void 0:l.isRTL(e));let p=await l.getElementRects({reference:r,floating:e,strategy:o}),{x:g,y:m}=dv(p,n,f),y=n,x={},S=0;for(let C=0;C<u.length;C++){const{name:E,fn:M}=u[C],{x:A,y:T,data:N,reset:D}=await M({x:g,y:m,initialPlacement:n,placement:y,strategy:o,middlewareData:x,rects:p,platform:l,elements:{reference:r,floating:e}});g=A??g,m=T??m,x={...x,[E]:{...x[E],...N}},D&&S<=50&&(S++,typeof D=="object"&&(D.placement&&(y=D.placement),D.rects&&(p=D.rects===!0?await l.getElementRects({reference:r,floating:e,strategy:o}):D.rects),{x:g,y:m}=dv(p,y,f)),C=-1)}return{x:g,y:m,placement:y,strategy:o,middlewareData:x}};async function Ni(r,e){var t;e===void 0&&(e={});const{x:n,y:o,platform:i,rects:l,elements:u,strategy:f}=r,{boundary:p="clippingAncestors",rootBoundary:g="viewport",elementContext:m="floating",altBoundary:y=!1,padding:x=0}=na(e,r),S=Kx(x),E=u[y?m==="floating"?"reference":"floating":m],M=zl(await i.getClippingRect({element:(t=await(i.isElement==null?void 0:i.isElement(E)))==null||t?E:E.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(u.floating)),boundary:p,rootBoundary:g,strategy:f})),A=m==="floating"?{x:n,y:o,width:l.floating.width,height:l.floating.height}:l.reference,T=await(i.getOffsetParent==null?void 0:i.getOffsetParent(u.floating)),N=await(i.isElement==null?void 0:i.isElement(T))?await(i.getScale==null?void 0:i.getScale(T))||{x:1,y:1}:{x:1,y:1},D=zl(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:A,offsetParent:T,strategy:f}):A);return{top:(M.top-D.top+S.top)/N.y,bottom:(D.bottom-M.bottom+S.bottom)/N.y,left:(M.left-D.left+S.left)/N.x,right:(D.right-M.right+S.right)/N.x}}const VD=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:o,rects:i,platform:l,elements:u,middlewareData:f}=e,{element:p,padding:g=0}=na(r,e)||{};if(p==null)return{};const m=Kx(g),y={x:t,y:n},x=up(o),S=lp(x),C=await l.getDimensions(p),E=x==="y",M=E?"top":"left",A=E?"bottom":"right",T=E?"clientHeight":"clientWidth",N=i.reference[S]+i.reference[x]-y[x]-i.floating[S],D=y[x]-i.reference[x],q=await(l.getOffsetParent==null?void 0:l.getOffsetParent(p));let P=q?q[T]:0;(!P||!await(l.isElement==null?void 0:l.isElement(q)))&&(P=u.floating[T]||i.floating[S]);const H=N/2-D/2,J=P/2-C[S]/2-1,se=La(m[M],J),ce=La(m[A],J),Z=se,te=P-C[S]-ce,le=P/2-C[S]/2+H,ue=hh(Z,le,te),z=!f.arrow&&Cr(o)!=null&&le!==ue&&i.reference[S]/2-(le<Z?se:ce)-C[S]/2<0,j=z?le<Z?le-Z:le-te:0;return{[x]:y[x]+j,data:{[x]:ue,centerOffset:le-ue-j,...z&&{alignmentOffset:j}},reset:z}}}),KD=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:o,middlewareData:i,rects:l,initialPlacement:u,platform:f,elements:p}=e,{mainAxis:g=!0,crossAxis:m=!0,fallbackPlacements:y,fallbackStrategy:x="bestFit",fallbackAxisSideDirection:S="none",flipAlignment:C=!0,...E}=na(r,e);if((t=i.arrow)!=null&&t.alignmentOffset)return{};const M=sa(o),A=gs(u),T=sa(u)===u,N=await(f.isRTL==null?void 0:f.isRTL(p.floating)),D=y||(T||!C?[_l(u)]:HD(u)),q=S!=="none";!y&&q&&D.push(...QD(u,C,S,N));const P=[u,...D],H=await Ni(e,E),J=[];let se=((n=i.flip)==null?void 0:n.overflows)||[];if(g&&J.push(H[M]),m){const le=qD(o,l,N);J.push(H[le[0]],H[le[1]])}if(se=[...se,{placement:o,overflows:J}],!J.every(le=>le<=0)){var ce,Z;const le=(((ce=i.flip)==null?void 0:ce.index)||0)+1,ue=P[le];if(ue&&(!(m==="alignment"?A!==gs(ue):!1)||se.every(O=>gs(O.placement)===A?O.overflows[0]>0:!0)))return{data:{index:le,overflows:se},reset:{placement:ue}};let z=(Z=se.filter(j=>j.overflows[0]<=0).sort((j,O)=>j.overflows[1]-O.overflows[1])[0])==null?void 0:Z.placement;if(!z)switch(x){case"bestFit":{var te;const j=(te=se.filter(O=>{if(q){const X=gs(O.placement);return X===A||X==="y"}return!0}).map(O=>[O.placement,O.overflows.filter(X=>X>0).reduce((X,he)=>X+he,0)]).sort((O,X)=>O[1]-X[1])[0])==null?void 0:te[0];j&&(z=j);break}case"initialPlacement":z=u;break}if(o!==z)return{reset:{placement:z}}}return{}}}};function fv(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function hv(r){return LD.some(e=>r[e]>=0)}const YD=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t}=e,{strategy:n="referenceHidden",...o}=na(r,e);switch(n){case"referenceHidden":{const i=await Ni(e,{...o,elementContext:"reference"}),l=fv(i,t.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:hv(l)}}}case"escaped":{const i=await Ni(e,{...o,altBoundary:!0}),l=fv(i,t.floating);return{data:{escapedOffsets:l,escaped:hv(l)}}}default:return{}}}}},Yx=new Set(["left","top"]);async function XD(r,e){const{placement:t,platform:n,elements:o}=r,i=await(n.isRTL==null?void 0:n.isRTL(o.floating)),l=sa(t),u=Cr(t),f=gs(t)==="y",p=Yx.has(l)?-1:1,g=i&&f?-1:1,m=na(e,r);let{mainAxis:y,crossAxis:x,alignmentAxis:S}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return u&&typeof S=="number"&&(x=u==="end"?S*-1:S),f?{x:x*g,y:y*p}:{x:y*p,y:x*g}}const WD=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:o,y:i,placement:l,middlewareData:u}=e,f=await XD(e,r);return l===((t=u.offset)==null?void 0:t.placement)&&(n=u.arrow)!=null&&n.alignmentOffset?{}:{x:o+f.x,y:i+f.y,data:{...f,placement:l}}}}},ZD=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:o}=e,{mainAxis:i=!0,crossAxis:l=!1,limiter:u={fn:E=>{let{x:M,y:A}=E;return{x:M,y:A}}},...f}=na(r,e),p={x:t,y:n},g=await Ni(e,f),m=gs(sa(o)),y=cp(m);let x=p[y],S=p[m];if(i){const E=y==="y"?"top":"left",M=y==="y"?"bottom":"right",A=x+g[E],T=x-g[M];x=hh(A,x,T)}if(l){const E=m==="y"?"top":"left",M=m==="y"?"bottom":"right",A=S+g[E],T=S-g[M];S=hh(A,S,T)}const C=u.fn({...e,[y]:x,[m]:S});return{...C,data:{x:C.x-t,y:C.y-n,enabled:{[y]:i,[m]:l}}}}}},JD=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:n,placement:o,rects:i,middlewareData:l}=e,{offset:u=0,mainAxis:f=!0,crossAxis:p=!0}=na(r,e),g={x:t,y:n},m=gs(o),y=cp(m);let x=g[y],S=g[m];const C=na(u,e),E=typeof C=="number"?{mainAxis:C,crossAxis:0}:{mainAxis:0,crossAxis:0,...C};if(f){const T=y==="y"?"height":"width",N=i.reference[y]-i.floating[T]+E.mainAxis,D=i.reference[y]+i.reference[T]-E.mainAxis;x<N?x=N:x>D&&(x=D)}if(p){var M,A;const T=y==="y"?"width":"height",N=Yx.has(sa(o)),D=i.reference[m]-i.floating[T]+(N&&((M=l.offset)==null?void 0:M[m])||0)+(N?0:E.crossAxis),q=i.reference[m]+i.reference[T]+(N?0:((A=l.offset)==null?void 0:A[m])||0)-(N?E.crossAxis:0);S<D?S=D:S>q&&(S=q)}return{[y]:x,[m]:S}}}},ej=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:o,rects:i,platform:l,elements:u}=e,{apply:f=()=>{},...p}=na(r,e),g=await Ni(e,p),m=sa(o),y=Cr(o),x=gs(o)==="y",{width:S,height:C}=i.floating;let E,M;m==="top"||m==="bottom"?(E=m,M=y===(await(l.isRTL==null?void 0:l.isRTL(u.floating))?"start":"end")?"left":"right"):(M=m,E=y==="end"?"top":"bottom");const A=C-g.top-g.bottom,T=S-g.left-g.right,N=La(C-g[E],A),D=La(S-g[M],T),q=!e.middlewareData.shift;let P=N,H=D;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(H=T),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(P=A),q&&!y){const se=Tn(g.left,0),ce=Tn(g.right,0),Z=Tn(g.top,0),te=Tn(g.bottom,0);x?H=S-2*(se!==0||ce!==0?se+ce:Tn(g.left,g.right)):P=C-2*(Z!==0||te!==0?Z+te:Tn(g.top,g.bottom))}await f({...e,availableWidth:H,availableHeight:P});const J=await l.getDimensions(u.floating);return S!==J.width||C!==J.height?{reset:{rects:!0}}:{}}}};function ou(){return typeof window<"u"}function Mr(r){return Xx(r)?(r.nodeName||"").toLowerCase():"#document"}function An(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Es(r){var e;return(e=(Xx(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function Xx(r){return ou()?r instanceof Node||r instanceof An(r).Node:!1}function ss(r){return ou()?r instanceof Element||r instanceof An(r).Element:!1}function ws(r){return ou()?r instanceof HTMLElement||r instanceof An(r).HTMLElement:!1}function pv(r){return!ou()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof An(r).ShadowRoot}const tj=new Set(["inline","contents"]);function Ui(r){const{overflow:e,overflowX:t,overflowY:n,display:o}=as(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!tj.has(o)}const nj=new Set(["table","td","th"]);function sj(r){return nj.has(Mr(r))}const aj=[":popover-open",":modal"];function ru(r){return aj.some(e=>{try{return r.matches(e)}catch{return!1}})}const oj=["transform","translate","scale","rotate","perspective"],rj=["transform","translate","scale","rotate","perspective","filter"],ij=["paint","layout","strict","content"];function dp(r){const e=fp(),t=ss(r)?as(r):r;return oj.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||rj.some(n=>(t.willChange||"").includes(n))||ij.some(n=>(t.contain||"").includes(n))}function cj(r){let e=Oa(r);for(;ws(e)&&!yr(e);){if(dp(e))return e;if(ru(e))return null;e=Oa(e)}return null}function fp(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const lj=new Set(["html","body","#document"]);function yr(r){return lj.has(Mr(r))}function as(r){return An(r).getComputedStyle(r)}function iu(r){return ss(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function Oa(r){if(Mr(r)==="html")return r;const e=r.assignedSlot||r.parentNode||pv(r)&&r.host||Es(r);return pv(e)?e.host:e}function Wx(r){const e=Oa(r);return yr(e)?r.ownerDocument?r.ownerDocument.body:r.body:ws(e)&&Ui(e)?e:Wx(e)}function ki(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const o=Wx(r),i=o===((n=r.ownerDocument)==null?void 0:n.body),l=An(o);if(i){const u=gh(l);return e.concat(l,l.visualViewport||[],Ui(o)?o:[],u&&t?ki(u):[])}return e.concat(o,ki(o,[],t))}function gh(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function Zx(r){const e=as(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const o=ws(r),i=o?r.offsetWidth:t,l=o?r.offsetHeight:n,u=jl(t)!==i||jl(n)!==l;return u&&(t=i,n=l),{width:t,height:n,$:u}}function hp(r){return ss(r)?r:r.contextElement}function pr(r){const e=hp(r);if(!ws(e))return bs(1);const t=e.getBoundingClientRect(),{width:n,height:o,$:i}=Zx(e);let l=(i?jl(t.width):t.width)/n,u=(i?jl(t.height):t.height)/o;return(!l||!Number.isFinite(l))&&(l=1),(!u||!Number.isFinite(u))&&(u=1),{x:l,y:u}}const uj=bs(0);function Jx(r){const e=An(r);return!fp()||!e.visualViewport?uj:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function dj(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==An(r)?!1:e}function go(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const o=r.getBoundingClientRect(),i=hp(r);let l=bs(1);e&&(n?ss(n)&&(l=pr(n)):l=pr(r));const u=dj(i,t,n)?Jx(i):bs(0);let f=(o.left+u.x)/l.x,p=(o.top+u.y)/l.y,g=o.width/l.x,m=o.height/l.y;if(i){const y=An(i),x=n&&ss(n)?An(n):n;let S=y,C=gh(S);for(;C&&n&&x!==S;){const E=pr(C),M=C.getBoundingClientRect(),A=as(C),T=M.left+(C.clientLeft+parseFloat(A.paddingLeft))*E.x,N=M.top+(C.clientTop+parseFloat(A.paddingTop))*E.y;f*=E.x,p*=E.y,g*=E.x,m*=E.y,f+=T,p+=N,S=An(C),C=gh(S)}}return zl({width:g,height:m,x:f,y:p})}function cu(r,e){const t=iu(r).scrollLeft;return e?e.left+t:go(Es(r)).left+t}function ew(r,e){const t=r.getBoundingClientRect(),n=t.left+e.scrollLeft-cu(r,t),o=t.top+e.scrollTop;return{x:n,y:o}}function fj(r){let{elements:e,rect:t,offsetParent:n,strategy:o}=r;const i=o==="fixed",l=Es(n),u=e?ru(e.floating):!1;if(n===l||u&&i)return t;let f={scrollLeft:0,scrollTop:0},p=bs(1);const g=bs(0),m=ws(n);if((m||!m&&!i)&&((Mr(n)!=="body"||Ui(l))&&(f=iu(n)),ws(n))){const x=go(n);p=pr(n),g.x=x.x+n.clientLeft,g.y=x.y+n.clientTop}const y=l&&!m&&!i?ew(l,f):bs(0);return{width:t.width*p.x,height:t.height*p.y,x:t.x*p.x-f.scrollLeft*p.x+g.x+y.x,y:t.y*p.y-f.scrollTop*p.y+g.y+y.y}}function hj(r){return Array.from(r.getClientRects())}function pj(r){const e=Es(r),t=iu(r),n=r.ownerDocument.body,o=Tn(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=Tn(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let l=-t.scrollLeft+cu(r);const u=-t.scrollTop;return as(n).direction==="rtl"&&(l+=Tn(e.clientWidth,n.clientWidth)-o),{width:o,height:i,x:l,y:u}}const gv=25;function gj(r,e){const t=An(r),n=Es(r),o=t.visualViewport;let i=n.clientWidth,l=n.clientHeight,u=0,f=0;if(o){i=o.width,l=o.height;const g=fp();(!g||g&&e==="fixed")&&(u=o.offsetLeft,f=o.offsetTop)}const p=cu(n);if(p<=0){const g=n.ownerDocument,m=g.body,y=getComputedStyle(m),x=g.compatMode==="CSS1Compat"&&parseFloat(y.marginLeft)+parseFloat(y.marginRight)||0,S=Math.abs(n.clientWidth-m.clientWidth-x);S<=gv&&(i-=S)}else p<=gv&&(i+=p);return{width:i,height:l,x:u,y:f}}const mj=new Set(["absolute","fixed"]);function yj(r,e){const t=go(r,!0,e==="fixed"),n=t.top+r.clientTop,o=t.left+r.clientLeft,i=ws(r)?pr(r):bs(1),l=r.clientWidth*i.x,u=r.clientHeight*i.y,f=o*i.x,p=n*i.y;return{width:l,height:u,x:f,y:p}}function mv(r,e,t){let n;if(e==="viewport")n=gj(r,t);else if(e==="document")n=pj(Es(r));else if(ss(e))n=yj(e,t);else{const o=Jx(r);n={x:e.x-o.x,y:e.y-o.y,width:e.width,height:e.height}}return zl(n)}function tw(r,e){const t=Oa(r);return t===e||!ss(t)||yr(t)?!1:as(t).position==="fixed"||tw(t,e)}function vj(r,e){const t=e.get(r);if(t)return t;let n=ki(r,[],!1).filter(u=>ss(u)&&Mr(u)!=="body"),o=null;const i=as(r).position==="fixed";let l=i?Oa(r):r;for(;ss(l)&&!yr(l);){const u=as(l),f=dp(l);!f&&u.position==="fixed"&&(o=null),(i?!f&&!o:!f&&u.position==="static"&&!!o&&mj.has(o.position)||Ui(l)&&!f&&tw(r,l))?n=n.filter(g=>g!==l):o=u,l=Oa(l)}return e.set(r,n),n}function bj(r){let{element:e,boundary:t,rootBoundary:n,strategy:o}=r;const l=[...t==="clippingAncestors"?ru(e)?[]:vj(e,this._c):[].concat(t),n],u=l[0],f=l.reduce((p,g)=>{const m=mv(e,g,o);return p.top=Tn(m.top,p.top),p.right=La(m.right,p.right),p.bottom=La(m.bottom,p.bottom),p.left=Tn(m.left,p.left),p},mv(e,u,o));return{width:f.right-f.left,height:f.bottom-f.top,x:f.left,y:f.top}}function xj(r){const{width:e,height:t}=Zx(r);return{width:e,height:t}}function wj(r,e,t){const n=ws(e),o=Es(e),i=t==="fixed",l=go(r,!0,i,e);let u={scrollLeft:0,scrollTop:0};const f=bs(0);function p(){f.x=cu(o)}if(n||!n&&!i)if((Mr(e)!=="body"||Ui(o))&&(u=iu(e)),n){const x=go(e,!0,i,e);f.x=x.x+e.clientLeft,f.y=x.y+e.clientTop}else o&&p();i&&!n&&o&&p();const g=o&&!n&&!i?ew(o,u):bs(0),m=l.left+u.scrollLeft-f.x-g.x,y=l.top+u.scrollTop-f.y-g.y;return{x:m,y,width:l.width,height:l.height}}function nh(r){return as(r).position==="static"}function yv(r,e){if(!ws(r)||as(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Es(r)===t&&(t=t.ownerDocument.body),t}function nw(r,e){const t=An(r);if(ru(r))return t;if(!ws(r)){let o=Oa(r);for(;o&&!yr(o);){if(ss(o)&&!nh(o))return o;o=Oa(o)}return t}let n=yv(r,e);for(;n&&sj(n)&&nh(n);)n=yv(n,e);return n&&yr(n)&&nh(n)&&!dp(n)?t:n||cj(r)||t}const Sj=async function(r){const e=this.getOffsetParent||nw,t=this.getDimensions,n=await t(r.floating);return{reference:wj(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Cj(r){return as(r).direction==="rtl"}const Mj={convertOffsetParentRelativeRectToViewportRelativeRect:fj,getDocumentElement:Es,getClippingRect:bj,getOffsetParent:nw,getElementRects:Sj,getClientRects:hj,getDimensions:xj,getScale:pr,isElement:ss,isRTL:Cj};function sw(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function Ej(r,e){let t=null,n;const o=Es(r);function i(){var u;clearTimeout(n),(u=t)==null||u.disconnect(),t=null}function l(u,f){u===void 0&&(u=!1),f===void 0&&(f=1),i();const p=r.getBoundingClientRect(),{left:g,top:m,width:y,height:x}=p;if(u||e(),!y||!x)return;const S=hl(m),C=hl(o.clientWidth-(g+y)),E=hl(o.clientHeight-(m+x)),M=hl(g),T={rootMargin:-S+"px "+-C+"px "+-E+"px "+-M+"px",threshold:Tn(0,La(1,f))||1};let N=!0;function D(q){const P=q[0].intersectionRatio;if(P!==f){if(!N)return l();P?l(!1,P):n=setTimeout(()=>{l(!1,1e-7)},1e3)}P===1&&!sw(p,r.getBoundingClientRect())&&l(),N=!1}try{t=new IntersectionObserver(D,{...T,root:o.ownerDocument})}catch{t=new IntersectionObserver(D,T)}t.observe(r)}return l(!0),i}function Rj(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:o=!0,ancestorResize:i=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:f=!1}=n,p=hp(r),g=o||i?[...p?ki(p):[],...ki(e)]:[];g.forEach(M=>{o&&M.addEventListener("scroll",t,{passive:!0}),i&&M.addEventListener("resize",t)});const m=p&&u?Ej(p,t):null;let y=-1,x=null;l&&(x=new ResizeObserver(M=>{let[A]=M;A&&A.target===p&&x&&(x.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var T;(T=x)==null||T.observe(e)})),t()}),p&&!f&&x.observe(p),x.observe(e));let S,C=f?go(r):null;f&&E();function E(){const M=go(r);C&&!sw(C,M)&&t(),C=M,S=requestAnimationFrame(E)}return t(),()=>{var M;g.forEach(A=>{o&&A.removeEventListener("scroll",t),i&&A.removeEventListener("resize",t)}),m?.(),(M=x)==null||M.disconnect(),x=null,f&&cancelAnimationFrame(S)}}const Tj=WD,Aj=ZD,Nj=KD,kj=ej,Dj=YD,vv=VD,jj=JD,_j=(r,e,t)=>{const n=new Map,o={platform:Mj,...t},i={...o.platform,_c:n};return FD(r,e,{...o,platform:i})};var zj=typeof document<"u",Lj=function(){},Sl=zj?w.useLayoutEffect:Lj;function Ll(r,e){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(typeof r=="function"&&r.toString()===e.toString())return!0;let t,n,o;if(r&&e&&typeof r=="object"){if(Array.isArray(r)){if(t=r.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!Ll(r[n],e[n]))return!1;return!0}if(o=Object.keys(r),t=o.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,o[n]))return!1;for(n=t;n--!==0;){const i=o[n];if(!(i==="_owner"&&r.$$typeof)&&!Ll(r[i],e[i]))return!1}return!0}return r!==r&&e!==e}function aw(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function bv(r,e){const t=aw(r);return Math.round(e*t)/t}function sh(r){const e=w.useRef(r);return Sl(()=>{e.current=r}),e}function Oj(r){r===void 0&&(r={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:o,elements:{reference:i,floating:l}={},transform:u=!0,whileElementsMounted:f,open:p}=r,[g,m]=w.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[y,x]=w.useState(n);Ll(y,n)||x(n);const[S,C]=w.useState(null),[E,M]=w.useState(null),A=w.useCallback(O=>{O!==q.current&&(q.current=O,C(O))},[]),T=w.useCallback(O=>{O!==P.current&&(P.current=O,M(O))},[]),N=i||S,D=l||E,q=w.useRef(null),P=w.useRef(null),H=w.useRef(g),J=f!=null,se=sh(f),ce=sh(o),Z=sh(p),te=w.useCallback(()=>{if(!q.current||!P.current)return;const O={placement:e,strategy:t,middleware:y};ce.current&&(O.platform=ce.current),_j(q.current,P.current,O).then(X=>{const he={...X,isPositioned:Z.current!==!1};le.current&&!Ll(H.current,he)&&(H.current=he,zi.flushSync(()=>{m(he)}))})},[y,e,t,ce,Z]);Sl(()=>{p===!1&&H.current.isPositioned&&(H.current.isPositioned=!1,m(O=>({...O,isPositioned:!1})))},[p]);const le=w.useRef(!1);Sl(()=>(le.current=!0,()=>{le.current=!1}),[]),Sl(()=>{if(N&&(q.current=N),D&&(P.current=D),N&&D){if(se.current)return se.current(N,D,te);te()}},[N,D,te,se,J]);const ue=w.useMemo(()=>({reference:q,floating:P,setReference:A,setFloating:T}),[A,T]),z=w.useMemo(()=>({reference:N,floating:D}),[N,D]),j=w.useMemo(()=>{const O={position:t,left:0,top:0};if(!z.floating)return O;const X=bv(z.floating,g.x),he=bv(z.floating,g.y);return u?{...O,transform:"translate("+X+"px, "+he+"px)",...aw(z.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:X,top:he}},[t,u,z.floating,g.x,g.y]);return w.useMemo(()=>({...g,update:te,refs:ue,elements:z,floatingStyles:j}),[g,te,ue,z,j])}const Pj=r=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:r,fn(t){const{element:n,padding:o}=typeof r=="function"?r(t):r;return n&&e(n)?n.current!=null?vv({element:n.current,padding:o}).fn(t):{}:n?vv({element:n,padding:o}).fn(t):{}}}},Ij=(r,e)=>({...Tj(r),options:[r,e]}),qj=(r,e)=>({...Aj(r),options:[r,e]}),Hj=(r,e)=>({...jj(r),options:[r,e]}),Uj=(r,e)=>({...Nj(r),options:[r,e]}),$j=(r,e)=>({...kj(r),options:[r,e]}),Bj=(r,e)=>({...Dj(r),options:[r,e]}),Qj=(r,e)=>({...Pj(r),options:[r,e]});var Gj="Arrow",ow=w.forwardRef((r,e)=>{const{children:t,width:n=10,height:o=5,...i}=r;return h.jsx(Ae.svg,{...i,ref:e,width:n,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?t:h.jsx("polygon",{points:"0,0 30,0 15,10"})})});ow.displayName=Gj;var Fj=ow;function lu(r){const[e,t]=w.useState(void 0);return sn(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(o=>{if(!Array.isArray(o)||!o.length)return;const i=o[0];let l,u;if("borderBoxSize"in i){const f=i.borderBoxSize,p=Array.isArray(f)?f[0]:f;l=p.inlineSize,u=p.blockSize}else l=r.offsetWidth,u=r.offsetHeight;t({width:l,height:u})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var pp="Popper",[rw,Er]=bn(pp),[Vj,iw]=rw(pp),cw=r=>{const{__scopePopper:e,children:t}=r,[n,o]=w.useState(null);return h.jsx(Vj,{scope:e,anchor:n,onAnchorChange:o,children:t})};cw.displayName=pp;var lw="PopperAnchor",uw=w.forwardRef((r,e)=>{const{__scopePopper:t,virtualRef:n,...o}=r,i=iw(lw,t),l=w.useRef(null),u=je(e,l),f=w.useRef(null);return w.useEffect(()=>{const p=f.current;f.current=n?.current||l.current,p!==f.current&&i.onAnchorChange(f.current)}),n?null:h.jsx(Ae.div,{...o,ref:u})});uw.displayName=lw;var gp="PopperContent",[Kj,Yj]=rw(gp),dw=w.forwardRef((r,e)=>{const{__scopePopper:t,side:n="bottom",sideOffset:o=0,align:i="center",alignOffset:l=0,arrowPadding:u=0,avoidCollisions:f=!0,collisionBoundary:p=[],collisionPadding:g=0,sticky:m="partial",hideWhenDetached:y=!1,updatePositionStrategy:x="optimized",onPlaced:S,...C}=r,E=iw(gp,t),[M,A]=w.useState(null),T=je(e,$=>A($)),[N,D]=w.useState(null),q=lu(N),P=q?.width??0,H=q?.height??0,J=n+(i!=="center"?"-"+i:""),se=typeof g=="number"?g:{top:0,right:0,bottom:0,left:0,...g},ce=Array.isArray(p)?p:[p],Z=ce.length>0,te={padding:se,boundary:ce.filter(Wj),altBoundary:Z},{refs:le,floatingStyles:ue,placement:z,isPositioned:j,middlewareData:O}=Oj({strategy:"fixed",placement:J,whileElementsMounted:(...$)=>Rj(...$,{animationFrame:x==="always"}),elements:{reference:E.anchor},middleware:[Ij({mainAxis:o+H,alignmentAxis:l}),f&&qj({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?Hj():void 0,...te}),f&&Uj({...te}),$j({...te,apply:({elements:$,rects:V,availableWidth:pe,availableHeight:me})=>{const{width:ye,height:ve}=V.reference,_e=$.floating.style;_e.setProperty("--radix-popper-available-width",`${pe}px`),_e.setProperty("--radix-popper-available-height",`${me}px`),_e.setProperty("--radix-popper-anchor-width",`${ye}px`),_e.setProperty("--radix-popper-anchor-height",`${ve}px`)}}),N&&Qj({element:N,padding:u}),Zj({arrowWidth:P,arrowHeight:H}),y&&Bj({strategy:"referenceHidden",...te})]}),[X,he]=pw(z),_=nn(S);sn(()=>{j&&_?.()},[j,_]);const Q=O.arrow?.x,Y=O.arrow?.y,ae=O.arrow?.centerOffset!==0,[B,oe]=w.useState();return sn(()=>{M&&oe(window.getComputedStyle(M).zIndex)},[M]),h.jsx("div",{ref:le.setFloating,"data-radix-popper-content-wrapper":"",style:{...ue,transform:j?ue.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:B,"--radix-popper-transform-origin":[O.transformOrigin?.x,O.transformOrigin?.y].join(" "),...O.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:h.jsx(Kj,{scope:t,placedSide:X,onArrowChange:D,arrowX:Q,arrowY:Y,shouldHideArrow:ae,children:h.jsx(Ae.div,{"data-side":X,"data-align":he,...C,ref:T,style:{...C.style,animation:j?void 0:"none"}})})})});dw.displayName=gp;var fw="PopperArrow",Xj={top:"bottom",right:"left",bottom:"top",left:"right"},hw=w.forwardRef(function(e,t){const{__scopePopper:n,...o}=e,i=Yj(fw,n),l=Xj[i.placedSide];return h.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:h.jsx(Fj,{...o,ref:t,style:{...o.style,display:"block"}})})});hw.displayName=fw;function Wj(r){return r!==null}var Zj=r=>({name:"transformOrigin",options:r,fn(e){const{placement:t,rects:n,middlewareData:o}=e,l=o.arrow?.centerOffset!==0,u=l?0:r.arrowWidth,f=l?0:r.arrowHeight,[p,g]=pw(t),m={start:"0%",center:"50%",end:"100%"}[g],y=(o.arrow?.x??0)+u/2,x=(o.arrow?.y??0)+f/2;let S="",C="";return p==="bottom"?(S=l?m:`${y}px`,C=`${-f}px`):p==="top"?(S=l?m:`${y}px`,C=`${n.floating.height+f}px`):p==="right"?(S=`${-f}px`,C=l?m:`${x}px`):p==="left"&&(S=`${n.floating.width+f}px`,C=l?m:`${x}px`),{data:{x:S,y:C}}}});function pw(r){const[e,t="center"]=r.split("-");return[e,t]}var mp=cw,uu=uw,yp=dw,vp=hw;function Jj(r){const e=e_(r),t=w.forwardRef((n,o)=>{const{children:i,...l}=n,u=w.Children.toArray(i),f=u.find(n_);if(f){const p=f.props.children,g=u.map(m=>m===f?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:m);return h.jsx(e,{...l,ref:o,children:w.isValidElement(p)?w.cloneElement(p,void 0,g):null})}return h.jsx(e,{...l,ref:o,children:i})});return t.displayName=`${r}.Slot`,t}function e_(r){const e=w.forwardRef((t,n)=>{const{children:o,...i}=t;if(w.isValidElement(o)){const l=a_(o),u=s_(i,o.props);return o.type!==w.Fragment&&(u.ref=n?Ss(n,l):l),w.cloneElement(o,u)}return w.Children.count(o)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var t_=Symbol("radix.slottable");function n_(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===t_}function s_(r,e){const t={...e};for(const n in e){const o=r[n],i=e[n];/^on[A-Z]/.test(n)?o&&i?t[n]=(...u)=>{const f=i(...u);return o(...u),f}:o&&(t[n]=o):n==="style"?t[n]={...o,...i}:n==="className"&&(t[n]=[o,i].filter(Boolean).join(" "))}return{...r,...t}}function a_(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var mh=["Enter"," "],o_=["ArrowDown","PageUp","Home"],gw=["ArrowUp","PageDown","End"],r_=[...o_,...gw],i_={ltr:[...mh,"ArrowRight"],rtl:[...mh,"ArrowLeft"]},c_={ltr:["ArrowLeft"],rtl:["ArrowRight"]},$i="Menu",[Di,l_,u_]=tu($i),[vo,mw]=bn($i,[u_,Er,nu]),du=Er(),yw=nu(),[d_,bo]=vo($i),[f_,Bi]=vo($i),vw=r=>{const{__scopeMenu:e,open:t=!1,children:n,dir:o,onOpenChange:i,modal:l=!0}=r,u=du(e),[f,p]=w.useState(null),g=w.useRef(!1),m=nn(i),y=Sr(o);return w.useEffect(()=>{const x=()=>{g.current=!0,document.addEventListener("pointerdown",S,{capture:!0,once:!0}),document.addEventListener("pointermove",S,{capture:!0,once:!0})},S=()=>g.current=!1;return document.addEventListener("keydown",x,{capture:!0}),()=>{document.removeEventListener("keydown",x,{capture:!0}),document.removeEventListener("pointerdown",S,{capture:!0}),document.removeEventListener("pointermove",S,{capture:!0})}},[]),h.jsx(mp,{...u,children:h.jsx(d_,{scope:e,open:t,onOpenChange:m,content:f,onContentChange:p,children:h.jsx(f_,{scope:e,onClose:w.useCallback(()=>m(!1),[m]),isUsingKeyboardRef:g,dir:y,modal:l,children:n})})})};vw.displayName=$i;var h_="MenuAnchor",bp=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,o=du(t);return h.jsx(uu,{...o,...n,ref:e})});bp.displayName=h_;var xp="MenuPortal",[p_,bw]=vo(xp,{forceMount:void 0}),xw=r=>{const{__scopeMenu:e,forceMount:t,children:n,container:o}=r,i=bo(xp,e);return h.jsx(p_,{scope:e,forceMount:t,children:h.jsx(rn,{present:t||i.open,children:h.jsx(Ii,{asChild:!0,container:o,children:n})})})};xw.displayName=xp;var Vn="MenuContent",[g_,wp]=vo(Vn),ww=w.forwardRef((r,e)=>{const t=bw(Vn,r.__scopeMenu),{forceMount:n=t.forceMount,...o}=r,i=bo(Vn,r.__scopeMenu),l=Bi(Vn,r.__scopeMenu);return h.jsx(Di.Provider,{scope:r.__scopeMenu,children:h.jsx(rn,{present:n||i.open,children:h.jsx(Di.Slot,{scope:r.__scopeMenu,children:l.modal?h.jsx(m_,{...o,ref:e}):h.jsx(y_,{...o,ref:e})})})})}),m_=w.forwardRef((r,e)=>{const t=bo(Vn,r.__scopeMenu),n=w.useRef(null),o=je(e,n);return w.useEffect(()=>{const i=n.current;if(i)return Kl(i)},[]),h.jsx(Sp,{...r,ref:o,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:ge(r.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),y_=w.forwardRef((r,e)=>{const t=bo(Vn,r.__scopeMenu);return h.jsx(Sp,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),v_=Jj("MenuContent.ScrollLock"),Sp=w.forwardRef((r,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:o,onOpenAutoFocus:i,onCloseAutoFocus:l,disableOutsidePointerEvents:u,onEntryFocus:f,onEscapeKeyDown:p,onPointerDownOutside:g,onFocusOutside:m,onInteractOutside:y,onDismiss:x,disableOutsideScroll:S,...C}=r,E=bo(Vn,t),M=Bi(Vn,t),A=du(t),T=yw(t),N=l_(t),[D,q]=w.useState(null),P=w.useRef(null),H=je(e,P,E.onContentChange),J=w.useRef(0),se=w.useRef(""),ce=w.useRef(0),Z=w.useRef(null),te=w.useRef("right"),le=w.useRef(0),ue=S?qi:w.Fragment,z=S?{as:v_,allowPinchZoom:!0}:void 0,j=X=>{const he=se.current+X,_=N().filter($=>!$.disabled),Q=document.activeElement,Y=_.find($=>$.ref.current===Q)?.textValue,ae=_.map($=>$.textValue),B=k_(ae,he,Y),oe=_.find($=>$.textValue===B)?.ref.current;(function $(V){se.current=V,window.clearTimeout(J.current),V!==""&&(J.current=window.setTimeout(()=>$(""),1e3))})(he),oe&&setTimeout(()=>oe.focus())};w.useEffect(()=>()=>window.clearTimeout(J.current),[]),Fl();const O=w.useCallback(X=>te.current===Z.current?.side&&j_(X,Z.current?.area),[]);return h.jsx(g_,{scope:t,searchRef:se,onItemEnter:w.useCallback(X=>{O(X)&&X.preventDefault()},[O]),onItemLeave:w.useCallback(X=>{O(X)||(P.current?.focus(),q(null))},[O]),onTriggerLeave:w.useCallback(X=>{O(X)&&X.preventDefault()},[O]),pointerGraceTimerRef:ce,onPointerGraceIntentChange:w.useCallback(X=>{Z.current=X},[]),children:h.jsx(ue,{...z,children:h.jsx(Pi,{asChild:!0,trapped:o,onMountAutoFocus:ge(i,X=>{X.preventDefault(),P.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:h.jsx(Oi,{asChild:!0,disableOutsidePointerEvents:u,onEscapeKeyDown:p,onPointerDownOutside:g,onFocusOutside:m,onInteractOutside:y,onDismiss:x,children:h.jsx(_x,{asChild:!0,...T,dir:M.dir,orientation:"vertical",loop:n,currentTabStopId:D,onCurrentTabStopIdChange:q,onEntryFocus:ge(f,X=>{M.isUsingKeyboardRef.current||X.preventDefault()}),preventScrollOnEntryFocus:!0,children:h.jsx(yp,{role:"menu","aria-orientation":"vertical","data-state":Pw(E.open),"data-radix-menu-content":"",dir:M.dir,...A,...C,ref:H,style:{outline:"none",...C.style},onKeyDown:ge(C.onKeyDown,X=>{const _=X.target.closest("[data-radix-menu-content]")===X.currentTarget,Q=X.ctrlKey||X.altKey||X.metaKey,Y=X.key.length===1;_&&(X.key==="Tab"&&X.preventDefault(),!Q&&Y&&j(X.key));const ae=P.current;if(X.target!==ae||!r_.includes(X.key))return;X.preventDefault();const oe=N().filter($=>!$.disabled).map($=>$.ref.current);gw.includes(X.key)&&oe.reverse(),A_(oe)}),onBlur:ge(r.onBlur,X=>{X.currentTarget.contains(X.target)||(window.clearTimeout(J.current),se.current="")}),onPointerMove:ge(r.onPointerMove,ji(X=>{const he=X.target,_=le.current!==X.clientX;if(X.currentTarget.contains(he)&&_){const Q=X.clientX>le.current?"right":"left";te.current=Q,le.current=X.clientX}}))})})})})})})});ww.displayName=Vn;var b_="MenuGroup",Cp=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return h.jsx(Ae.div,{role:"group",...n,ref:e})});Cp.displayName=b_;var x_="MenuLabel",Sw=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return h.jsx(Ae.div,{...n,ref:e})});Sw.displayName=x_;var Ol="MenuItem",xv="menu.itemSelect",fu=w.forwardRef((r,e)=>{const{disabled:t=!1,onSelect:n,...o}=r,i=w.useRef(null),l=Bi(Ol,r.__scopeMenu),u=wp(Ol,r.__scopeMenu),f=je(e,i),p=w.useRef(!1),g=()=>{const m=i.current;if(!t&&m){const y=new CustomEvent(xv,{bubbles:!0,cancelable:!0});m.addEventListener(xv,x=>n?.(x),{once:!0}),hb(m,y),y.defaultPrevented?p.current=!1:l.onClose()}};return h.jsx(Cw,{...o,ref:f,disabled:t,onClick:ge(r.onClick,g),onPointerDown:m=>{r.onPointerDown?.(m),p.current=!0},onPointerUp:ge(r.onPointerUp,m=>{p.current||m.currentTarget?.click()}),onKeyDown:ge(r.onKeyDown,m=>{const y=u.searchRef.current!=="";t||y&&m.key===" "||mh.includes(m.key)&&(m.currentTarget.click(),m.preventDefault())})})});fu.displayName=Ol;var Cw=w.forwardRef((r,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:o,...i}=r,l=wp(Ol,t),u=yw(t),f=w.useRef(null),p=je(e,f),[g,m]=w.useState(!1),[y,x]=w.useState("");return w.useEffect(()=>{const S=f.current;S&&x((S.textContent??"").trim())},[i.children]),h.jsx(Di.ItemSlot,{scope:t,disabled:n,textValue:o??y,children:h.jsx(zx,{asChild:!0,...u,focusable:!n,children:h.jsx(Ae.div,{role:"menuitem","data-highlighted":g?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:p,onPointerMove:ge(r.onPointerMove,ji(S=>{n?l.onItemLeave(S):(l.onItemEnter(S),S.defaultPrevented||S.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ge(r.onPointerLeave,ji(S=>l.onItemLeave(S))),onFocus:ge(r.onFocus,()=>m(!0)),onBlur:ge(r.onBlur,()=>m(!1))})})})}),w_="MenuCheckboxItem",Mw=w.forwardRef((r,e)=>{const{checked:t=!1,onCheckedChange:n,...o}=r;return h.jsx(Nw,{scope:r.__scopeMenu,checked:t,children:h.jsx(fu,{role:"menuitemcheckbox","aria-checked":Pl(t)?"mixed":t,...o,ref:e,"data-state":Ep(t),onSelect:ge(o.onSelect,()=>n?.(Pl(t)?!0:!t),{checkForDefaultPrevented:!1})})})});Mw.displayName=w_;var Ew="MenuRadioGroup",[S_,C_]=vo(Ew,{value:void 0,onValueChange:()=>{}}),Rw=w.forwardRef((r,e)=>{const{value:t,onValueChange:n,...o}=r,i=nn(n);return h.jsx(S_,{scope:r.__scopeMenu,value:t,onValueChange:i,children:h.jsx(Cp,{...o,ref:e})})});Rw.displayName=Ew;var Tw="MenuRadioItem",Aw=w.forwardRef((r,e)=>{const{value:t,...n}=r,o=C_(Tw,r.__scopeMenu),i=t===o.value;return h.jsx(Nw,{scope:r.__scopeMenu,checked:i,children:h.jsx(fu,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":Ep(i),onSelect:ge(n.onSelect,()=>o.onValueChange?.(t),{checkForDefaultPrevented:!1})})})});Aw.displayName=Tw;var Mp="MenuItemIndicator",[Nw,M_]=vo(Mp,{checked:!1}),kw=w.forwardRef((r,e)=>{const{__scopeMenu:t,forceMount:n,...o}=r,i=M_(Mp,t);return h.jsx(rn,{present:n||Pl(i.checked)||i.checked===!0,children:h.jsx(Ae.span,{...o,ref:e,"data-state":Ep(i.checked)})})});kw.displayName=Mp;var E_="MenuSeparator",Dw=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return h.jsx(Ae.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});Dw.displayName=E_;var R_="MenuArrow",jw=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,o=du(t);return h.jsx(vp,{...o,...n,ref:e})});jw.displayName=R_;var T_="MenuSub",[m3,_w]=vo(T_),wi="MenuSubTrigger",zw=w.forwardRef((r,e)=>{const t=bo(wi,r.__scopeMenu),n=Bi(wi,r.__scopeMenu),o=_w(wi,r.__scopeMenu),i=wp(wi,r.__scopeMenu),l=w.useRef(null),{pointerGraceTimerRef:u,onPointerGraceIntentChange:f}=i,p={__scopeMenu:r.__scopeMenu},g=w.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return w.useEffect(()=>g,[g]),w.useEffect(()=>{const m=u.current;return()=>{window.clearTimeout(m),f(null)}},[u,f]),h.jsx(bp,{asChild:!0,...p,children:h.jsx(Cw,{id:o.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":o.contentId,"data-state":Pw(t.open),...r,ref:Ss(e,o.onTriggerChange),onClick:m=>{r.onClick?.(m),!(r.disabled||m.defaultPrevented)&&(m.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:ge(r.onPointerMove,ji(m=>{i.onItemEnter(m),!m.defaultPrevented&&!r.disabled&&!t.open&&!l.current&&(i.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{t.onOpenChange(!0),g()},100))})),onPointerLeave:ge(r.onPointerLeave,ji(m=>{g();const y=t.content?.getBoundingClientRect();if(y){const x=t.content?.dataset.side,S=x==="right",C=S?-5:5,E=y[S?"left":"right"],M=y[S?"right":"left"];i.onPointerGraceIntentChange({area:[{x:m.clientX+C,y:m.clientY},{x:E,y:y.top},{x:M,y:y.top},{x:M,y:y.bottom},{x:E,y:y.bottom}],side:x}),window.clearTimeout(u.current),u.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(m),m.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:ge(r.onKeyDown,m=>{const y=i.searchRef.current!=="";r.disabled||y&&m.key===" "||i_[n.dir].includes(m.key)&&(t.onOpenChange(!0),t.content?.focus(),m.preventDefault())})})})});zw.displayName=wi;var Lw="MenuSubContent",Ow=w.forwardRef((r,e)=>{const t=bw(Vn,r.__scopeMenu),{forceMount:n=t.forceMount,...o}=r,i=bo(Vn,r.__scopeMenu),l=Bi(Vn,r.__scopeMenu),u=_w(Lw,r.__scopeMenu),f=w.useRef(null),p=je(e,f);return h.jsx(Di.Provider,{scope:r.__scopeMenu,children:h.jsx(rn,{present:n||i.open,children:h.jsx(Di.Slot,{scope:r.__scopeMenu,children:h.jsx(Sp,{id:u.contentId,"aria-labelledby":u.triggerId,...o,ref:p,align:"start",side:l.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:g=>{l.isUsingKeyboardRef.current&&f.current?.focus(),g.preventDefault()},onCloseAutoFocus:g=>g.preventDefault(),onFocusOutside:ge(r.onFocusOutside,g=>{g.target!==u.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:ge(r.onEscapeKeyDown,g=>{l.onClose(),g.preventDefault()}),onKeyDown:ge(r.onKeyDown,g=>{const m=g.currentTarget.contains(g.target),y=c_[l.dir].includes(g.key);m&&y&&(i.onOpenChange(!1),u.trigger?.focus(),g.preventDefault())})})})})})});Ow.displayName=Lw;function Pw(r){return r?"open":"closed"}function Pl(r){return r==="indeterminate"}function Ep(r){return Pl(r)?"indeterminate":r?"checked":"unchecked"}function A_(r){const e=document.activeElement;for(const t of r)if(t===e||(t.focus(),document.activeElement!==e))return}function N_(r,e){return r.map((t,n)=>r[(e+n)%r.length])}function k_(r,e,t){const o=e.length>1&&Array.from(e).every(p=>p===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let l=N_(r,Math.max(i,0));o.length===1&&(l=l.filter(p=>p!==t));const f=l.find(p=>p.toLowerCase().startsWith(o.toLowerCase()));return f!==t?f:void 0}function D_(r,e){const{x:t,y:n}=r;let o=!1;for(let i=0,l=e.length-1;i<e.length;l=i++){const u=e[i],f=e[l],p=u.x,g=u.y,m=f.x,y=f.y;g>n!=y>n&&t<(m-p)*(n-g)/(y-g)+p&&(o=!o)}return o}function j_(r,e){if(!e)return!1;const t={x:r.clientX,y:r.clientY};return D_(t,e)}function ji(r){return e=>e.pointerType==="mouse"?r(e):void 0}var __=vw,z_=bp,L_=xw,O_=ww,P_=Cp,I_=Sw,q_=fu,H_=Mw,U_=Rw,$_=Aw,B_=kw,Q_=Dw,G_=jw,F_=zw,V_=Ow,hu="DropdownMenu",[K_]=bn(hu,[mw]),dn=mw(),[Y_,Iw]=K_(hu),qw=r=>{const{__scopeDropdownMenu:e,children:t,dir:n,open:o,defaultOpen:i,onOpenChange:l,modal:u=!0}=r,f=dn(e),p=w.useRef(null),[g,m]=xs({prop:o,defaultProp:i??!1,onChange:l,caller:hu});return h.jsx(Y_,{scope:e,triggerId:ns(),triggerRef:p,contentId:ns(),open:g,onOpenChange:m,onOpenToggle:w.useCallback(()=>m(y=>!y),[m]),modal:u,children:h.jsx(__,{...f,open:g,onOpenChange:m,dir:n,modal:u,children:t})})};qw.displayName=hu;var Hw="DropdownMenuTrigger",Uw=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,disabled:n=!1,...o}=r,i=Iw(Hw,t),l=dn(t);return h.jsx(z_,{asChild:!0,...l,children:h.jsx(Ae.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...o,ref:Ss(e,i.triggerRef),onPointerDown:ge(r.onPointerDown,u=>{!n&&u.button===0&&u.ctrlKey===!1&&(i.onOpenToggle(),i.open||u.preventDefault())}),onKeyDown:ge(r.onKeyDown,u=>{n||(["Enter"," "].includes(u.key)&&i.onOpenToggle(),u.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(u.key)&&u.preventDefault())})})})});Uw.displayName=Hw;var X_="DropdownMenuPortal",$w=r=>{const{__scopeDropdownMenu:e,...t}=r,n=dn(e);return h.jsx(L_,{...n,...t})};$w.displayName=X_;var Bw="DropdownMenuContent",Qw=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=Iw(Bw,t),i=dn(t),l=w.useRef(!1);return h.jsx(O_,{id:o.contentId,"aria-labelledby":o.triggerId,...i,...n,ref:e,onCloseAutoFocus:ge(r.onCloseAutoFocus,u=>{l.current||o.triggerRef.current?.focus(),l.current=!1,u.preventDefault()}),onInteractOutside:ge(r.onInteractOutside,u=>{const f=u.detail.originalEvent,p=f.button===0&&f.ctrlKey===!0,g=f.button===2||p;(!o.modal||g)&&(l.current=!0)}),style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Qw.displayName=Bw;var W_="DropdownMenuGroup",Z_=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=dn(t);return h.jsx(P_,{...o,...n,ref:e})});Z_.displayName=W_;var J_="DropdownMenuLabel",Gw=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=dn(t);return h.jsx(I_,{...o,...n,ref:e})});Gw.displayName=J_;var ez="DropdownMenuItem",Fw=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=dn(t);return h.jsx(q_,{...o,...n,ref:e})});Fw.displayName=ez;var tz="DropdownMenuCheckboxItem",Vw=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=dn(t);return h.jsx(H_,{...o,...n,ref:e})});Vw.displayName=tz;var nz="DropdownMenuRadioGroup",sz=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=dn(t);return h.jsx(U_,{...o,...n,ref:e})});sz.displayName=nz;var az="DropdownMenuRadioItem",Kw=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=dn(t);return h.jsx($_,{...o,...n,ref:e})});Kw.displayName=az;var oz="DropdownMenuItemIndicator",Yw=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=dn(t);return h.jsx(B_,{...o,...n,ref:e})});Yw.displayName=oz;var rz="DropdownMenuSeparator",Xw=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=dn(t);return h.jsx(Q_,{...o,...n,ref:e})});Xw.displayName=rz;var iz="DropdownMenuArrow",cz=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=dn(t);return h.jsx(G_,{...o,...n,ref:e})});cz.displayName=iz;var lz="DropdownMenuSubTrigger",Ww=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=dn(t);return h.jsx(F_,{...o,...n,ref:e})});Ww.displayName=lz;var uz="DropdownMenuSubContent",Zw=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,o=dn(t);return h.jsx(V_,{...o,...n,ref:e,style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Zw.displayName=uz;var dz=qw,fz=Uw,hz=$w,Jw=Qw,e1=Gw,t1=Fw,n1=Vw,s1=Kw,a1=Yw,o1=Xw,r1=Ww,i1=Zw;const pz=dz,gz=fz,mz=w.forwardRef(({className:r,inset:e,children:t,...n},o)=>h.jsxs(r1,{ref:o,className:Ee("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",r),...n,children:[t,h.jsx(Ih,{className:"ml-auto"})]}));mz.displayName=r1.displayName;const yz=w.forwardRef(({className:r,...e},t)=>h.jsx(i1,{ref:t,className:Ee("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",r),...e}));yz.displayName=i1.displayName;const c1=w.forwardRef(({className:r,sideOffset:e=4,...t},n)=>h.jsx(hz,{children:h.jsx(Jw,{ref:n,sideOffset:e,className:Ee("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",r),...t})}));c1.displayName=Jw.displayName;const Cl=w.forwardRef(({className:r,inset:e,...t},n)=>h.jsx(t1,{ref:n,className:Ee("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",e&&"pl-8",r),...t}));Cl.displayName=t1.displayName;const vz=w.forwardRef(({className:r,children:e,checked:t,...n},o)=>h.jsxs(n1,{ref:o,className:Ee("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:t,...n,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(a1,{children:h.jsx(Ph,{className:"h-4 w-4"})})}),e]}));vz.displayName=n1.displayName;const bz=w.forwardRef(({className:r,children:e,...t},n)=>h.jsxs(s1,{ref:n,className:Ee("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[h.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(a1,{children:h.jsx(IA,{className:"h-2 w-2 fill-current"})})}),e]}));bz.displayName=s1.displayName;const yh=w.forwardRef(({className:r,inset:e,...t},n)=>h.jsx(e1,{ref:n,className:Ee("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",r),...t}));yh.displayName=e1.displayName;const l1=w.forwardRef(({className:r,...e},t)=>h.jsx(o1,{ref:t,className:Ee("-mx-1 my-1 h-px bg-muted",r),...e}));l1.displayName=o1.displayName;const u1="archiphoenix_component_library",wv=()=>{if(typeof window>"u")return{favorites:[],collections:[]};try{const r=window.localStorage.getItem(u1);if(!r)return{favorites:[],collections:[]};const e=JSON.parse(r);return{favorites:Array.isArray(e.favorites)?e.favorites:[],collections:Array.isArray(e.collections)?e.collections:[]}}catch(r){return sb("Failed to load component library state",r instanceof Error?r:new Error(String(r))),{favorites:[],collections:[]}}},ur=r=>{typeof window>"u"||window.localStorage.setItem(u1,JSON.stringify(r))},xz=Cs((r,e)=>({favorites:wv().favorites,collections:wv().collections,toggleFavorite:t=>{r(n=>{const i=n.favorites.includes(t)?n.favorites.filter(l=>l!==t):[...n.favorites,t];return ur({favorites:i,collections:n.collections}),{favorites:i}})},createCollection:t=>{const n=t.trim();if(!n)return null;const o={id:`collection-${Date.now()}`,name:n,componentIds:[]};return r(i=>{const l=[...i.collections,o];return ur({favorites:i.favorites,collections:l}),{collections:l}}),o.id},renameCollection:(t,n)=>{r(o=>{const i=o.collections.map(l=>l.id===t?{...l,name:n}:l);return ur({favorites:o.favorites,collections:i}),{collections:i}})},deleteCollection:t=>{r(n=>{const o=n.collections.filter(i=>i.id!==t);return ur({favorites:n.favorites,collections:o}),{collections:o}})},addComponentToCollection:(t,n)=>{r(o=>{const i=o.collections.map(l=>l.id!==t||l.componentIds.includes(n)?l:{...l,componentIds:[...l.componentIds,n]});return ur({favorites:o.favorites,collections:i}),{collections:i}})},removeComponentFromCollection:(t,n)=>{r(o=>{const i=o.collections.map(l=>l.id!==t?l:{...l,componentIds:l.componentIds.filter(u=>u!==n)});return ur({favorites:o.favorites,collections:i}),{collections:i}})}}));function Sv({open:r,initialName:e="",onConfirm:t,onCancel:n}){const[o,i]=w.useState(e);w.useEffect(()=>{r&&i(e)},[r,e]);const l=()=>{o.trim()&&t(o.trim())};return h.jsx(ap,{open:r,onOpenChange:u=>!u&&n(),children:h.jsxs(Xl,{children:[h.jsxs(Wl,{children:[h.jsx(Jl,{children:e?"Rename Collection":"Create Collection"}),h.jsx(eu,{children:e?"Enter a new name for the collection":"Enter a name for the new collection"})]}),h.jsxs("div",{className:"py-4",children:[h.jsx(st,{htmlFor:"collection-name",children:"Collection Name"}),h.jsx(Nt,{id:"collection-name",value:o,onChange:u=>i(u.target.value),onKeyDown:u=>{u.key==="Enter"&&l()},className:"mt-2",autoFocus:!0})]}),h.jsxs(Zl,{children:[h.jsx(Ne,{variant:"outline",onClick:n,children:"Cancel"}),h.jsx(Ne,{onClick:l,disabled:!o.trim(),children:e?"Save":"Create"})]})]})})}function wz(){const[r,e]=w.useState(""),[t,n]=w.useState("all"),[o,i]=w.useState(!1),[l,u]=w.useState(!1),[f,p]=w.useState(null),[g,m]=w.useState(null),[y,x]=w.useState(180),[S,C]=w.useState(!1),E=w.useRef(null),[M,A]=w.useState(()=>{const B=localStorage.getItem("sidebar-expanded-categories");if(B)try{const oe=JSON.parse(B);return xi.reduce(($,V)=>($[V.id]=oe[V.id]!==void 0?oe[V.id]:!0,$),{})}catch{}return xi.reduce((oe,$)=>(oe[$.id]=!0,oe),{})}),{favorites:T,collections:N,toggleFavorite:D,createCollection:q,renameCollection:P,deleteCollection:H,addComponentToCollection:J,removeComponentFromCollection:se}=xz(),ce=B=>{A(oe=>({...oe,[B]:!oe[B]}))},Z=r.toLowerCase(),te=w.useMemo(()=>Ai.filter(B=>B.label.toLowerCase().includes(Z)),[Z]),le=w.useMemo(()=>te.filter(B=>T.includes(B.id)),[T,te]),ue=(B,oe)=>{B.dataTransfer.setData("application/json",JSON.stringify(oe)),B.dataTransfer.effectAllowed="copy"},z=()=>{p(null),i(!0)},j=B=>{if(f)P(f.id,B),p(null);else{if(N.some(V=>V.name.toLowerCase()===B.toLowerCase())){alert("A collection with this name already exists");return}q(B)||alert("Failed to create collection")}i(!1)},O=()=>{i(!1),p(null)},X=B=>{m(B),p(null),u(!0)},he=B=>{if(!g)return;if(N.some(V=>V.name.toLowerCase()===B.toLowerCase())){alert("A collection with this name already exists");return}const $=q(B);$?J($,g):alert("Failed to create collection"),u(!1),m(null)},_=()=>{u(!1),m(null)},Q=B=>{p(B),i(!0)};w.useEffect(()=>{localStorage.setItem("sidebar-expanded-categories",JSON.stringify(M))},[M]),w.useEffect(()=>{if(!S)return;const B=$=>{if(!E.current)return;const V=E.current.closest(".h-full");if(!V)return;const pe=V.getBoundingClientRect();E.current.getBoundingClientRect();const me=pe.bottom-$.clientY,ye=70,ve=pe.height*.8;x(Math.max(ye,Math.min(ve,me)))},oe=()=>{C(!1)};return document.addEventListener("mousemove",B),document.addEventListener("mouseup",oe),()=>{document.removeEventListener("mousemove",B),document.removeEventListener("mouseup",oe)}},[S]);const Y=(B,oe)=>{const $=T.includes(B.id);return h.jsxs("div",{draggable:!0,onDragStart:V=>ue(V,B),className:`flex items-center gap-1 px-1 ${oe?.compact?"py-0.5 text-[10px]":"py-1 text-xs"} rounded-md bg-secondary/50 hover:bg-secondary cursor-move transition-colors border border-border/50`,children:[h.jsxs("div",{className:"flex items-center gap-0.5 flex-1 min-w-0",children:[h.jsx("span",{className:"text-sm flex-shrink-0",children:B.icon}),h.jsx("span",{className:"text-foreground truncate min-w-0",children:B.label})]}),h.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[h.jsx("button",{type:"button",onClick:V=>{V.preventDefault(),V.stopPropagation(),D(B.id)},onMouseDown:V=>V.stopPropagation(),className:"p-1 rounded-md hover:bg-muted transition-colors",title:$?"Remove from favorites":"Add to favorites",children:h.jsx(j2,{className:`h-4 w-4 ${$?"text-yellow-400":"text-muted-foreground"}`,fill:$?"currentColor":"none"})}),h.jsxs(pz,{children:[h.jsx(gz,{asChild:!0,children:h.jsx("button",{type:"button",onMouseDown:V=>V.stopPropagation(),className:"p-1 rounded-md hover:bg-muted transition-colors",title:"Add to collection",children:h.jsx(Al,{className:"h-4 w-4 text-muted-foreground"})})}),h.jsxs(c1,{align:"end",className:"w-48",children:[N.length===0&&h.jsxs(h.Fragment,{children:[h.jsx(yh,{children:"No collections"}),h.jsxs(Cl,{onSelect:V=>{V.preventDefault(),X(B.id)},children:[h.jsx(ch,{className:"h-4 w-4 mr-2"}),"Create and add"]})]}),N.length>0&&h.jsxs(h.Fragment,{children:[h.jsx(yh,{children:"Add to collection"}),N.map(V=>h.jsx(Cl,{onSelect:pe=>{pe.preventDefault(),J(V.id,B.id)},children:V.name},V.id)),h.jsx(l1,{}),h.jsxs(Cl,{onSelect:V=>{V.preventDefault(),X(B.id)},children:[h.jsx(ch,{className:"h-4 w-4 mr-2"}),"New collection"]})]})]})]}),oe?.onRemove&&h.jsx("button",{type:"button",onClick:V=>{V.preventDefault(),V.stopPropagation(),oe.onRemove?.()},onMouseDown:V=>V.stopPropagation(),className:"p-1 rounded-md hover:bg-muted transition-colors",title:"Remove from collection",children:h.jsx(vs,{className:"h-4 w-4 text-muted-foreground"})})]})]},`${B.id}-${oe?.compact?"compact":"default"}`)},ae=t==="all"?xi:xi.filter(B=>B.id===t);return h.jsxs("div",{className:"w-60 h-full bg-sidebar-bg border-r border-border flex flex-col",children:[h.jsxs("div",{className:"p-3 border-b border-border",children:[h.jsx("h2",{className:"text-xs font-semibold text-foreground mb-2",children:"Components"}),h.jsxs("div",{className:"relative",children:[h.jsx($l,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"}),h.jsx(Nt,{type:"text",placeholder:"Search...",value:r,onChange:B=>e(B.target.value),className:"pl-7 h-8 text-xs"})]})]}),h.jsx("div",{className:"px-3 py-1.5 border-b border-border pb-2",children:h.jsx(ip,{value:t,onValueChange:n,children:h.jsxs(on,{orientation:"horizontal",className:"w-full",children:[h.jsxs(au,{className:"flex w-max gap-0.5",children:[h.jsx(hs,{value:"all",className:"text-xs px-2 py-1",children:"All"}),xi.map(B=>h.jsx(hs,{value:B.id,className:"text-xs px-2 py-1",children:B.icon},B.id))]}),h.jsx(Gl,{orientation:"horizontal",className:"data-[state=visible]:bg-accent/20 data-[state=visible]:hover:bg-accent/30 [&>[data-radix-scroll-area-thumb]]:bg-accent/80 hover:[&>[data-radix-scroll-area-thumb]]:bg-accent rounded-full",style:{transition:"none"}})]})})}),le.length>0&&h.jsxs("div",{className:"px-3 py-2 border-b border-border",children:[h.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[h.jsx("span",{className:"text-[10px] font-semibold uppercase text-muted-foreground",children:"Favorites"}),h.jsx("span",{className:"text-[10px] text-muted-foreground",children:le.length})]}),h.jsx("div",{className:"space-y-1",children:le.map(B=>Y(B,{compact:!0}))})]}),h.jsx(on,{className:"flex-1",children:h.jsx("div",{className:"pl-3 pr-6 py-2",children:ae.map(B=>{const oe=te.filter($=>$.category===B.id);return oe.length===0&&r?null:h.jsxs("div",{className:"mb-1.5",children:[h.jsxs(Ne,{variant:"ghost",className:"w-full justify-start px-1 h-7 text-xs",onClick:()=>ce(B.id),children:[M[B.id]?h.jsx(Ul,{className:"h-3.5 w-3.5 mr-0.5"}):h.jsx(Ih,{className:"h-3.5 w-3.5 mr-0.5"}),h.jsx("span",{className:"mr-1",children:B.icon}),h.jsx("span",{className:"flex-1 text-left truncate min-w-0 mr-1",children:B.label}),h.jsx("span",{className:"text-[10px] text-muted-foreground flex-shrink-0",children:oe.length})]}),M[B.id]&&h.jsx("div",{className:"ml-1.5 mt-1 space-y-1",children:oe.map($=>Y($,{compact:!0}))})]},B.id)})})}),h.jsx("div",{ref:E,className:"h-2 border-t border-border cursor-row-resize hover:bg-accent/50 transition-colors relative group flex items-center justify-center",onMouseDown:B=>{B.preventDefault(),C(!0)},style:{userSelect:"none"},children:h.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:h.jsx(WA,{className:"h-3 w-3 text-muted-foreground"})})}),h.jsxs("div",{className:"border-t border-border overflow-hidden flex flex-col",style:{height:`${y}px`},children:[h.jsx("div",{className:"p-2 pb-1.5 flex-shrink-0",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx("span",{className:"text-[10px] uppercase font-semibold text-muted-foreground",children:"Collections"}),h.jsxs(Ne,{size:"xs",variant:"outline",className:"h-6 text-[10px] px-2",onClick:B=>{B.preventDefault(),B.stopPropagation(),z()},type:"button",children:[h.jsx(Al,{className:"h-3 w-3 mr-0.5"}),"New"]})]})}),h.jsx(on,{className:"flex-1",children:h.jsx("div",{className:"pl-1.5 pr-4 pb-2 space-y-1.5",children:N.length===0?h.jsx("p",{className:"text-[10px] text-muted-foreground px-0.5",children:"Create collections to quickly build typical architectures."}):N.map(B=>{const oe=B.componentIds.map($=>Ai.find(V=>V.id===$)).filter($=>!!$).filter($=>$.label.toLowerCase().includes(Z));return h.jsxs("div",{className:"rounded-md border border-border/60 p-1.5",children:[h.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-xs font-medium text-foreground truncate",children:B.name}),h.jsxs("p",{className:"text-[10px] text-muted-foreground",children:[oe.length," items"]})]}),h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(Ne,{size:"icon",variant:"ghost",className:"h-7 w-7",title:"Rename",onClick:()=>Q(B),children:""}),h.jsx(Ne,{size:"icon",variant:"ghost",className:"h-7 w-7",title:"Delete collection",onClick:()=>H(B.id),children:h.jsx(vs,{className:"h-4 w-4"})})]})]}),oe.length===0?h.jsx("p",{className:"text-[10px] text-muted-foreground",children:'Add components via "+" menu.'}):h.jsx("div",{className:"space-y-1",children:oe.map($=>Y($,{compact:!0,onRemove:()=>se(B.id,$.id)}))})]},B.id)})})})]}),h.jsx(Sv,{open:o,initialName:f?.name||"",onConfirm:j,onCancel:O}),h.jsx(Sv,{open:l,initialName:"",onConfirm:he,onCancel:_})]})}const pu=Cs(r=>({tabs:[{id:"diagram-1",title:"Untitled Diagram",type:"diagram",active:!0}],addTab:e=>r(t=>{if(e.componentId){const o=t.tabs.find(i=>i.componentId===e.componentId);if(o)return{tabs:t.tabs.map(i=>({...i,active:i.id===o.id}))}}const n={...e,id:`${e.type}-${Date.now()}`,active:!0};return{tabs:[...t.tabs.map(o=>({...o,active:!1})),n]}}),closeTab:e=>r(t=>{const n=t.tabs.filter(l=>l.id!==e);if(n.length===0)return{tabs:[{id:"diagram-1",title:"Untitled Diagram",type:"diagram",active:!0}]};const o=t.tabs.findIndex(l=>l.id===e);if(t.tabs[o]?.active&&n.length>0){const l=Math.min(o,n.length-1);n[l].active=!0}return{tabs:n}}),setActiveTab:e=>r(t=>({tabs:t.tabs.map(n=>({...n,active:n.id===e}))})),updateTab:(e,t)=>r(n=>({tabs:n.tabs.map(o=>o.id===e?{...o,...t}:o)}))}));function Sz(r){const e=Cz(r),t=w.forwardRef((n,o)=>{const{children:i,...l}=n,u=w.Children.toArray(i),f=u.find(Ez);if(f){const p=f.props.children,g=u.map(m=>m===f?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:m);return h.jsx(e,{...l,ref:o,children:w.isValidElement(p)?w.cloneElement(p,void 0,g):null})}return h.jsx(e,{...l,ref:o,children:i})});return t.displayName=`${r}.Slot`,t}function Cz(r){const e=w.forwardRef((t,n)=>{const{children:o,...i}=t;if(w.isValidElement(o)){const l=Tz(o),u=Rz(i,o.props);return o.type!==w.Fragment&&(u.ref=n?Ss(n,l):l),w.cloneElement(o,u)}return w.Children.count(o)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var Mz=Symbol("radix.slottable");function Ez(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===Mz}function Rz(r,e){const t={...e};for(const n in e){const o=r[n],i=e[n];/^on[A-Z]/.test(n)?o&&i?t[n]=(...u)=>{const f=i(...u);return o(...u),f}:o&&(t[n]=o):n==="style"?t[n]={...o,...i}:n==="className"&&(t[n]=[o,i].filter(Boolean).join(" "))}return{...r,...t}}function Tz(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function gu(r){const e=w.useRef({value:r,previous:r});return w.useMemo(()=>(e.current.value!==r&&(e.current.previous=e.current.value,e.current.value=r),e.current.previous),[r])}var d1=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Az="VisuallyHidden",Nz=w.forwardRef((r,e)=>h.jsx(Ae.span,{...r,ref:e,style:{...d1,...r.style}}));Nz.displayName=Az;var kz=[" ","Enter","ArrowUp","ArrowDown"],Dz=[" ","Enter"],mo="Select",[mu,yu,jz]=tu(mo),[Rr]=bn(mo,[jz,Er]),vu=Er(),[_z,Ia]=Rr(mo),[zz,Lz]=Rr(mo),f1=r=>{const{__scopeSelect:e,children:t,open:n,defaultOpen:o,onOpenChange:i,value:l,defaultValue:u,onValueChange:f,dir:p,name:g,autoComplete:m,disabled:y,required:x,form:S}=r,C=vu(e),[E,M]=w.useState(null),[A,T]=w.useState(null),[N,D]=w.useState(!1),q=Sr(p),[P,H]=xs({prop:n,defaultProp:o??!1,onChange:i,caller:mo}),[J,se]=xs({prop:l,defaultProp:u,onChange:f,caller:mo}),ce=w.useRef(null),Z=E?S||!!E.closest("form"):!0,[te,le]=w.useState(new Set),ue=Array.from(te).map(z=>z.props.value).join(";");return h.jsx(mp,{...C,children:h.jsxs(_z,{required:x,scope:e,trigger:E,onTriggerChange:M,valueNode:A,onValueNodeChange:T,valueNodeHasChildren:N,onValueNodeHasChildrenChange:D,contentId:ns(),value:J,onValueChange:se,open:P,onOpenChange:H,dir:q,triggerPointerDownPosRef:ce,disabled:y,children:[h.jsx(mu.Provider,{scope:e,children:h.jsx(zz,{scope:r.__scopeSelect,onNativeOptionAdd:w.useCallback(z=>{le(j=>new Set(j).add(z))},[]),onNativeOptionRemove:w.useCallback(z=>{le(j=>{const O=new Set(j);return O.delete(z),O})},[]),children:t})}),Z?h.jsxs(O1,{"aria-hidden":!0,required:x,tabIndex:-1,name:g,autoComplete:m,value:J,onChange:z=>se(z.target.value),disabled:y,form:S,children:[J===void 0?h.jsx("option",{value:""}):null,Array.from(te)]},ue):null]})})};f1.displayName=mo;var h1="SelectTrigger",p1=w.forwardRef((r,e)=>{const{__scopeSelect:t,disabled:n=!1,...o}=r,i=vu(t),l=Ia(h1,t),u=l.disabled||n,f=je(e,l.onTriggerChange),p=yu(t),g=w.useRef("touch"),[m,y,x]=I1(C=>{const E=p().filter(T=>!T.disabled),M=E.find(T=>T.value===l.value),A=q1(E,C,M);A!==void 0&&l.onValueChange(A.value)}),S=C=>{u||(l.onOpenChange(!0),x()),C&&(l.triggerPointerDownPosRef.current={x:Math.round(C.pageX),y:Math.round(C.pageY)})};return h.jsx(uu,{asChild:!0,...i,children:h.jsx(Ae.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:u,"data-disabled":u?"":void 0,"data-placeholder":P1(l.value)?"":void 0,...o,ref:f,onClick:ge(o.onClick,C=>{C.currentTarget.focus(),g.current!=="mouse"&&S(C)}),onPointerDown:ge(o.onPointerDown,C=>{g.current=C.pointerType;const E=C.target;E.hasPointerCapture(C.pointerId)&&E.releasePointerCapture(C.pointerId),C.button===0&&C.ctrlKey===!1&&C.pointerType==="mouse"&&(S(C),C.preventDefault())}),onKeyDown:ge(o.onKeyDown,C=>{const E=m.current!=="";!(C.ctrlKey||C.altKey||C.metaKey)&&C.key.length===1&&y(C.key),!(E&&C.key===" ")&&kz.includes(C.key)&&(S(),C.preventDefault())})})})});p1.displayName=h1;var g1="SelectValue",m1=w.forwardRef((r,e)=>{const{__scopeSelect:t,className:n,style:o,children:i,placeholder:l="",...u}=r,f=Ia(g1,t),{onValueNodeHasChildrenChange:p}=f,g=i!==void 0,m=je(e,f.onValueNodeChange);return sn(()=>{p(g)},[p,g]),h.jsx(Ae.span,{...u,ref:m,style:{pointerEvents:"none"},children:P1(f.value)?h.jsx(h.Fragment,{children:l}):i})});m1.displayName=g1;var Oz="SelectIcon",y1=w.forwardRef((r,e)=>{const{__scopeSelect:t,children:n,...o}=r;return h.jsx(Ae.span,{"aria-hidden":!0,...o,ref:e,children:n||""})});y1.displayName=Oz;var Pz="SelectPortal",v1=r=>h.jsx(Ii,{asChild:!0,...r});v1.displayName=Pz;var yo="SelectContent",b1=w.forwardRef((r,e)=>{const t=Ia(yo,r.__scopeSelect),[n,o]=w.useState();if(sn(()=>{o(new DocumentFragment)},[]),!t.open){const i=n;return i?zi.createPortal(h.jsx(x1,{scope:r.__scopeSelect,children:h.jsx(mu.Slot,{scope:r.__scopeSelect,children:h.jsx("div",{children:r.children})})}),i):null}return h.jsx(w1,{...r,ref:e})});b1.displayName=yo;var es=10,[x1,qa]=Rr(yo),Iz="SelectContentImpl",qz=Sz("SelectContent.RemoveScroll"),w1=w.forwardRef((r,e)=>{const{__scopeSelect:t,position:n="item-aligned",onCloseAutoFocus:o,onEscapeKeyDown:i,onPointerDownOutside:l,side:u,sideOffset:f,align:p,alignOffset:g,arrowPadding:m,collisionBoundary:y,collisionPadding:x,sticky:S,hideWhenDetached:C,avoidCollisions:E,...M}=r,A=Ia(yo,t),[T,N]=w.useState(null),[D,q]=w.useState(null),P=je(e,$=>N($)),[H,J]=w.useState(null),[se,ce]=w.useState(null),Z=yu(t),[te,le]=w.useState(!1),ue=w.useRef(!1);w.useEffect(()=>{if(T)return Kl(T)},[T]),Fl();const z=w.useCallback($=>{const[V,...pe]=Z().map(ve=>ve.ref.current),[me]=pe.slice(-1),ye=document.activeElement;for(const ve of $)if(ve===ye||(ve?.scrollIntoView({block:"nearest"}),ve===V&&D&&(D.scrollTop=0),ve===me&&D&&(D.scrollTop=D.scrollHeight),ve?.focus(),document.activeElement!==ye))return},[Z,D]),j=w.useCallback(()=>z([H,T]),[z,H,T]);w.useEffect(()=>{te&&j()},[te,j]);const{onOpenChange:O,triggerPointerDownPosRef:X}=A;w.useEffect(()=>{if(T){let $={x:0,y:0};const V=me=>{$={x:Math.abs(Math.round(me.pageX)-(X.current?.x??0)),y:Math.abs(Math.round(me.pageY)-(X.current?.y??0))}},pe=me=>{$.x<=10&&$.y<=10?me.preventDefault():T.contains(me.target)||O(!1),document.removeEventListener("pointermove",V),X.current=null};return X.current!==null&&(document.addEventListener("pointermove",V),document.addEventListener("pointerup",pe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",V),document.removeEventListener("pointerup",pe,{capture:!0})}}},[T,O,X]),w.useEffect(()=>{const $=()=>O(!1);return window.addEventListener("blur",$),window.addEventListener("resize",$),()=>{window.removeEventListener("blur",$),window.removeEventListener("resize",$)}},[O]);const[he,_]=I1($=>{const V=Z().filter(ye=>!ye.disabled),pe=V.find(ye=>ye.ref.current===document.activeElement),me=q1(V,$,pe);me&&setTimeout(()=>me.ref.current.focus())}),Q=w.useCallback(($,V,pe)=>{const me=!ue.current&&!pe;(A.value!==void 0&&A.value===V||me)&&(J($),me&&(ue.current=!0))},[A.value]),Y=w.useCallback(()=>T?.focus(),[T]),ae=w.useCallback(($,V,pe)=>{const me=!ue.current&&!pe;(A.value!==void 0&&A.value===V||me)&&ce($)},[A.value]),B=n==="popper"?vh:S1,oe=B===vh?{side:u,sideOffset:f,align:p,alignOffset:g,arrowPadding:m,collisionBoundary:y,collisionPadding:x,sticky:S,hideWhenDetached:C,avoidCollisions:E}:{};return h.jsx(x1,{scope:t,content:T,viewport:D,onViewportChange:q,itemRefCallback:Q,selectedItem:H,onItemLeave:Y,itemTextRefCallback:ae,focusSelectedItem:j,selectedItemText:se,position:n,isPositioned:te,searchRef:he,children:h.jsx(qi,{as:qz,allowPinchZoom:!0,children:h.jsx(Pi,{asChild:!0,trapped:A.open,onMountAutoFocus:$=>{$.preventDefault()},onUnmountAutoFocus:ge(o,$=>{A.trigger?.focus({preventScroll:!0}),$.preventDefault()}),children:h.jsx(Oi,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:l,onFocusOutside:$=>$.preventDefault(),onDismiss:()=>A.onOpenChange(!1),children:h.jsx(B,{role:"listbox",id:A.contentId,"data-state":A.open?"open":"closed",dir:A.dir,onContextMenu:$=>$.preventDefault(),...M,...oe,onPlaced:()=>le(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...M.style},onKeyDown:ge(M.onKeyDown,$=>{const V=$.ctrlKey||$.altKey||$.metaKey;if($.key==="Tab"&&$.preventDefault(),!V&&$.key.length===1&&_($.key),["ArrowUp","ArrowDown","Home","End"].includes($.key)){let me=Z().filter(ye=>!ye.disabled).map(ye=>ye.ref.current);if(["ArrowUp","End"].includes($.key)&&(me=me.slice().reverse()),["ArrowUp","ArrowDown"].includes($.key)){const ye=$.target,ve=me.indexOf(ye);me=me.slice(ve+1)}setTimeout(()=>z(me)),$.preventDefault()}})})})})})})});w1.displayName=Iz;var Hz="SelectItemAlignedPosition",S1=w.forwardRef((r,e)=>{const{__scopeSelect:t,onPlaced:n,...o}=r,i=Ia(yo,t),l=qa(yo,t),[u,f]=w.useState(null),[p,g]=w.useState(null),m=je(e,P=>g(P)),y=yu(t),x=w.useRef(!1),S=w.useRef(!0),{viewport:C,selectedItem:E,selectedItemText:M,focusSelectedItem:A}=l,T=w.useCallback(()=>{if(i.trigger&&i.valueNode&&u&&p&&C&&E&&M){const P=i.trigger.getBoundingClientRect(),H=p.getBoundingClientRect(),J=i.valueNode.getBoundingClientRect(),se=M.getBoundingClientRect();if(i.dir!=="rtl"){const ye=se.left-H.left,ve=J.left-ye,_e=P.left-ve,Ue=P.width+_e,at=Math.max(Ue,H.width),Ze=window.innerWidth-es,Dt=Ti(ve,[es,Math.max(es,Ze-at)]);u.style.minWidth=Ue+"px",u.style.left=Dt+"px"}else{const ye=H.right-se.right,ve=window.innerWidth-J.right-ye,_e=window.innerWidth-P.right-ve,Ue=P.width+_e,at=Math.max(Ue,H.width),Ze=window.innerWidth-es,Dt=Ti(ve,[es,Math.max(es,Ze-at)]);u.style.minWidth=Ue+"px",u.style.right=Dt+"px"}const ce=y(),Z=window.innerHeight-es*2,te=C.scrollHeight,le=window.getComputedStyle(p),ue=parseInt(le.borderTopWidth,10),z=parseInt(le.paddingTop,10),j=parseInt(le.borderBottomWidth,10),O=parseInt(le.paddingBottom,10),X=ue+z+te+O+j,he=Math.min(E.offsetHeight*5,X),_=window.getComputedStyle(C),Q=parseInt(_.paddingTop,10),Y=parseInt(_.paddingBottom,10),ae=P.top+P.height/2-es,B=Z-ae,oe=E.offsetHeight/2,$=E.offsetTop+oe,V=ue+z+$,pe=X-V;if(V<=ae){const ye=ce.length>0&&E===ce[ce.length-1].ref.current;u.style.bottom="0px";const ve=p.clientHeight-C.offsetTop-C.offsetHeight,_e=Math.max(B,oe+(ye?Y:0)+ve+j),Ue=V+_e;u.style.height=Ue+"px"}else{const ye=ce.length>0&&E===ce[0].ref.current;u.style.top="0px";const _e=Math.max(ae,ue+C.offsetTop+(ye?Q:0)+oe)+pe;u.style.height=_e+"px",C.scrollTop=V-ae+C.offsetTop}u.style.margin=`${es}px 0`,u.style.minHeight=he+"px",u.style.maxHeight=Z+"px",n?.(),requestAnimationFrame(()=>x.current=!0)}},[y,i.trigger,i.valueNode,u,p,C,E,M,i.dir,n]);sn(()=>T(),[T]);const[N,D]=w.useState();sn(()=>{p&&D(window.getComputedStyle(p).zIndex)},[p]);const q=w.useCallback(P=>{P&&S.current===!0&&(T(),A?.(),S.current=!1)},[T,A]);return h.jsx($z,{scope:t,contentWrapper:u,shouldExpandOnScrollRef:x,onScrollButtonChange:q,children:h.jsx("div",{ref:f,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:N},children:h.jsx(Ae.div,{...o,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...o.style}})})})});S1.displayName=Hz;var Uz="SelectPopperPosition",vh=w.forwardRef((r,e)=>{const{__scopeSelect:t,align:n="start",collisionPadding:o=es,...i}=r,l=vu(t);return h.jsx(yp,{...l,...i,ref:e,align:n,collisionPadding:o,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});vh.displayName=Uz;var[$z,Rp]=Rr(yo,{}),bh="SelectViewport",C1=w.forwardRef((r,e)=>{const{__scopeSelect:t,nonce:n,...o}=r,i=qa(bh,t),l=Rp(bh,t),u=je(e,i.onViewportChange),f=w.useRef(0);return h.jsxs(h.Fragment,{children:[h.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),h.jsx(mu.Slot,{scope:t,children:h.jsx(Ae.div,{"data-radix-select-viewport":"",role:"presentation",...o,ref:u,style:{position:"relative",flex:1,overflow:"hidden auto",...o.style},onScroll:ge(o.onScroll,p=>{const g=p.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:y}=l;if(y?.current&&m){const x=Math.abs(f.current-g.scrollTop);if(x>0){const S=window.innerHeight-es*2,C=parseFloat(m.style.minHeight),E=parseFloat(m.style.height),M=Math.max(C,E);if(M<S){const A=M+x,T=Math.min(S,A),N=A-T;m.style.height=T+"px",m.style.bottom==="0px"&&(g.scrollTop=N>0?N:0,m.style.justifyContent="flex-end")}}}f.current=g.scrollTop})})})]})});C1.displayName=bh;var M1="SelectGroup",[Bz,Qz]=Rr(M1),Gz=w.forwardRef((r,e)=>{const{__scopeSelect:t,...n}=r,o=ns();return h.jsx(Bz,{scope:t,id:o,children:h.jsx(Ae.div,{role:"group","aria-labelledby":o,...n,ref:e})})});Gz.displayName=M1;var E1="SelectLabel",R1=w.forwardRef((r,e)=>{const{__scopeSelect:t,...n}=r,o=Qz(E1,t);return h.jsx(Ae.div,{id:o.id,...n,ref:e})});R1.displayName=E1;var Il="SelectItem",[Fz,T1]=Rr(Il),A1=w.forwardRef((r,e)=>{const{__scopeSelect:t,value:n,disabled:o=!1,textValue:i,...l}=r,u=Ia(Il,t),f=qa(Il,t),p=u.value===n,[g,m]=w.useState(i??""),[y,x]=w.useState(!1),S=je(e,A=>f.itemRefCallback?.(A,n,o)),C=ns(),E=w.useRef("touch"),M=()=>{o||(u.onValueChange(n),u.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return h.jsx(Fz,{scope:t,value:n,disabled:o,textId:C,isSelected:p,onItemTextChange:w.useCallback(A=>{m(T=>T||(A?.textContent??"").trim())},[]),children:h.jsx(mu.ItemSlot,{scope:t,value:n,disabled:o,textValue:g,children:h.jsx(Ae.div,{role:"option","aria-labelledby":C,"data-highlighted":y?"":void 0,"aria-selected":p&&y,"data-state":p?"checked":"unchecked","aria-disabled":o||void 0,"data-disabled":o?"":void 0,tabIndex:o?void 0:-1,...l,ref:S,onFocus:ge(l.onFocus,()=>x(!0)),onBlur:ge(l.onBlur,()=>x(!1)),onClick:ge(l.onClick,()=>{E.current!=="mouse"&&M()}),onPointerUp:ge(l.onPointerUp,()=>{E.current==="mouse"&&M()}),onPointerDown:ge(l.onPointerDown,A=>{E.current=A.pointerType}),onPointerMove:ge(l.onPointerMove,A=>{E.current=A.pointerType,o?f.onItemLeave?.():E.current==="mouse"&&A.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ge(l.onPointerLeave,A=>{A.currentTarget===document.activeElement&&f.onItemLeave?.()}),onKeyDown:ge(l.onKeyDown,A=>{f.searchRef?.current!==""&&A.key===" "||(Dz.includes(A.key)&&M(),A.key===" "&&A.preventDefault())})})})})});A1.displayName=Il;var Si="SelectItemText",N1=w.forwardRef((r,e)=>{const{__scopeSelect:t,className:n,style:o,...i}=r,l=Ia(Si,t),u=qa(Si,t),f=T1(Si,t),p=Lz(Si,t),[g,m]=w.useState(null),y=je(e,M=>m(M),f.onItemTextChange,M=>u.itemTextRefCallback?.(M,f.value,f.disabled)),x=g?.textContent,S=w.useMemo(()=>h.jsx("option",{value:f.value,disabled:f.disabled,children:x},f.value),[f.disabled,f.value,x]),{onNativeOptionAdd:C,onNativeOptionRemove:E}=p;return sn(()=>(C(S),()=>E(S)),[C,E,S]),h.jsxs(h.Fragment,{children:[h.jsx(Ae.span,{id:f.textId,...i,ref:y}),f.isSelected&&l.valueNode&&!l.valueNodeHasChildren?zi.createPortal(i.children,l.valueNode):null]})});N1.displayName=Si;var k1="SelectItemIndicator",D1=w.forwardRef((r,e)=>{const{__scopeSelect:t,...n}=r;return T1(k1,t).isSelected?h.jsx(Ae.span,{"aria-hidden":!0,...n,ref:e}):null});D1.displayName=k1;var xh="SelectScrollUpButton",j1=w.forwardRef((r,e)=>{const t=qa(xh,r.__scopeSelect),n=Rp(xh,r.__scopeSelect),[o,i]=w.useState(!1),l=je(e,n.onScrollButtonChange);return sn(()=>{if(t.viewport&&t.isPositioned){let u=function(){const p=f.scrollTop>0;i(p)};const f=t.viewport;return u(),f.addEventListener("scroll",u),()=>f.removeEventListener("scroll",u)}},[t.viewport,t.isPositioned]),o?h.jsx(z1,{...r,ref:l,onAutoScroll:()=>{const{viewport:u,selectedItem:f}=t;u&&f&&(u.scrollTop=u.scrollTop-f.offsetHeight)}}):null});j1.displayName=xh;var wh="SelectScrollDownButton",_1=w.forwardRef((r,e)=>{const t=qa(wh,r.__scopeSelect),n=Rp(wh,r.__scopeSelect),[o,i]=w.useState(!1),l=je(e,n.onScrollButtonChange);return sn(()=>{if(t.viewport&&t.isPositioned){let u=function(){const p=f.scrollHeight-f.clientHeight,g=Math.ceil(f.scrollTop)<p;i(g)};const f=t.viewport;return u(),f.addEventListener("scroll",u),()=>f.removeEventListener("scroll",u)}},[t.viewport,t.isPositioned]),o?h.jsx(z1,{...r,ref:l,onAutoScroll:()=>{const{viewport:u,selectedItem:f}=t;u&&f&&(u.scrollTop=u.scrollTop+f.offsetHeight)}}):null});_1.displayName=wh;var z1=w.forwardRef((r,e)=>{const{__scopeSelect:t,onAutoScroll:n,...o}=r,i=qa("SelectScrollButton",t),l=w.useRef(null),u=yu(t),f=w.useCallback(()=>{l.current!==null&&(window.clearInterval(l.current),l.current=null)},[]);return w.useEffect(()=>()=>f(),[f]),sn(()=>{u().find(g=>g.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[u]),h.jsx(Ae.div,{"aria-hidden":!0,...o,ref:e,style:{flexShrink:0,...o.style},onPointerDown:ge(o.onPointerDown,()=>{l.current===null&&(l.current=window.setInterval(n,50))}),onPointerMove:ge(o.onPointerMove,()=>{i.onItemLeave?.(),l.current===null&&(l.current=window.setInterval(n,50))}),onPointerLeave:ge(o.onPointerLeave,()=>{f()})})}),Vz="SelectSeparator",L1=w.forwardRef((r,e)=>{const{__scopeSelect:t,...n}=r;return h.jsx(Ae.div,{"aria-hidden":!0,...n,ref:e})});L1.displayName=Vz;var Sh="SelectArrow",Kz=w.forwardRef((r,e)=>{const{__scopeSelect:t,...n}=r,o=vu(t),i=Ia(Sh,t),l=qa(Sh,t);return i.open&&l.position==="popper"?h.jsx(vp,{...o,...n,ref:e}):null});Kz.displayName=Sh;var Yz="SelectBubbleInput",O1=w.forwardRef(({__scopeSelect:r,value:e,...t},n)=>{const o=w.useRef(null),i=je(n,o),l=gu(e);return w.useEffect(()=>{const u=o.current;if(!u)return;const f=window.HTMLSelectElement.prototype,g=Object.getOwnPropertyDescriptor(f,"value").set;if(l!==e&&g){const m=new Event("change",{bubbles:!0});g.call(u,e),u.dispatchEvent(m)}},[l,e]),h.jsx(Ae.select,{...t,style:{...d1,...t.style},ref:i,defaultValue:e})});O1.displayName=Yz;function P1(r){return r===""||r===void 0}function I1(r){const e=nn(r),t=w.useRef(""),n=w.useRef(0),o=w.useCallback(l=>{const u=t.current+l;e(u),(function f(p){t.current=p,window.clearTimeout(n.current),p!==""&&(n.current=window.setTimeout(()=>f(""),1e3))})(u)},[e]),i=w.useCallback(()=>{t.current="",window.clearTimeout(n.current)},[]);return w.useEffect(()=>()=>window.clearTimeout(n.current),[]),[t,o,i]}function q1(r,e,t){const o=e.length>1&&Array.from(e).every(p=>p===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let l=Xz(r,Math.max(i,0));o.length===1&&(l=l.filter(p=>p!==t));const f=l.find(p=>p.textValue.toLowerCase().startsWith(o.toLowerCase()));return f!==t?f:void 0}function Xz(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var Wz=f1,H1=p1,Zz=m1,Jz=y1,e5=v1,U1=b1,t5=C1,$1=R1,B1=A1,n5=N1,s5=D1,Q1=j1,G1=_1,F1=L1;const a5=Wz,o5=Zz,V1=w.forwardRef(({className:r,children:e,...t},n)=>h.jsxs(H1,{ref:n,className:Ee("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...t,children:[e,h.jsx(Jz,{asChild:!0,children:h.jsx(Ul,{className:"h-4 w-4 opacity-50"})})]}));V1.displayName=H1.displayName;const K1=w.forwardRef(({className:r,...e},t)=>h.jsx(Q1,{ref:t,className:Ee("flex cursor-default items-center justify-center py-1",r),...e,children:h.jsx(ib,{className:"h-4 w-4"})}));K1.displayName=Q1.displayName;const Y1=w.forwardRef(({className:r,...e},t)=>h.jsx(G1,{ref:t,className:Ee("flex cursor-default items-center justify-center py-1",r),...e,children:h.jsx(Ul,{className:"h-4 w-4"})}));Y1.displayName=G1.displayName;const X1=w.forwardRef(({className:r,children:e,position:t="popper",...n},o)=>h.jsx(e5,{children:h.jsxs(U1,{ref:o,className:Ee("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:t,...n,children:[h.jsx(K1,{}),h.jsx(t5,{className:Ee("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),h.jsx(Y1,{})]})}));X1.displayName=U1.displayName;const r5=w.forwardRef(({className:r,...e},t)=>h.jsx($1,{ref:t,className:Ee("px-2 py-1.5 text-sm font-semibold",r),...e}));r5.displayName=$1.displayName;const Ci=w.forwardRef(({className:r,children:e,...t},n)=>h.jsxs(B1,{ref:n,className:Ee("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[h.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:h.jsx(s5,{children:h.jsx(Ph,{className:"h-4 w-4"})})}),h.jsx(n5,{children:e})]}));Ci.displayName=B1.displayName;const i5=w.forwardRef(({className:r,...e},t)=>h.jsx(F1,{ref:t,className:Ee("-mx-1 my-1 h-px bg-muted",r),...e}));i5.displayName=F1.displayName;var W1=["PageUp","PageDown"],Z1=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],J1={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Tr="Slider",[Ch,c5,l5]=tu(Tr),[eS]=bn(Tr,[l5]),[u5,bu]=eS(Tr),tS=w.forwardRef((r,e)=>{const{name:t,min:n=0,max:o=100,step:i=1,orientation:l="horizontal",disabled:u=!1,minStepsBetweenThumbs:f=0,defaultValue:p=[n],value:g,onValueChange:m=()=>{},onValueCommit:y=()=>{},inverted:x=!1,form:S,...C}=r,E=w.useRef(new Set),M=w.useRef(0),T=l==="horizontal"?d5:f5,[N=[],D]=xs({prop:g,defaultProp:p,onChange:ce=>{[...E.current][M.current]?.focus(),m(ce)}}),q=w.useRef(N);function P(ce){const Z=y5(N,ce);se(ce,Z)}function H(ce){se(ce,M.current)}function J(){const ce=q.current[M.current];N[M.current]!==ce&&y(N)}function se(ce,Z,{commit:te}={commit:!1}){const le=w5(i),ue=S5(Math.round((ce-n)/i)*i+n,le),z=Ti(ue,[n,o]);D((j=[])=>{const O=g5(j,z,Z);if(x5(O,f*i)){M.current=O.indexOf(z);const X=String(O)!==String(j);return X&&te&&y(O),X?O:j}else return j})}return h.jsx(u5,{scope:r.__scopeSlider,name:t,disabled:u,min:n,max:o,valueIndexToChangeRef:M,thumbs:E.current,values:N,orientation:l,form:S,children:h.jsx(Ch.Provider,{scope:r.__scopeSlider,children:h.jsx(Ch.Slot,{scope:r.__scopeSlider,children:h.jsx(T,{"aria-disabled":u,"data-disabled":u?"":void 0,...C,ref:e,onPointerDown:ge(C.onPointerDown,()=>{u||(q.current=N)}),min:n,max:o,inverted:x,onSlideStart:u?void 0:P,onSlideMove:u?void 0:H,onSlideEnd:u?void 0:J,onHomeKeyDown:()=>!u&&se(n,0,{commit:!0}),onEndKeyDown:()=>!u&&se(o,N.length-1,{commit:!0}),onStepKeyDown:({event:ce,direction:Z})=>{if(!u){const ue=W1.includes(ce.key)||ce.shiftKey&&Z1.includes(ce.key)?10:1,z=M.current,j=N[z],O=i*ue*Z;se(j+O,z,{commit:!0})}}})})})})});tS.displayName=Tr;var[nS,sS]=eS(Tr,{startEdge:"left",endEdge:"right",size:"width",direction:1}),d5=w.forwardRef((r,e)=>{const{min:t,max:n,dir:o,inverted:i,onSlideStart:l,onSlideMove:u,onSlideEnd:f,onStepKeyDown:p,...g}=r,[m,y]=w.useState(null),x=je(e,T=>y(T)),S=w.useRef(void 0),C=Sr(o),E=C==="ltr",M=E&&!i||!E&&i;function A(T){const N=S.current||m.getBoundingClientRect(),D=[0,N.width],P=Tp(D,M?[t,n]:[n,t]);return S.current=N,P(T-N.left)}return h.jsx(nS,{scope:r.__scopeSlider,startEdge:M?"left":"right",endEdge:M?"right":"left",direction:M?1:-1,size:"width",children:h.jsx(aS,{dir:C,"data-orientation":"horizontal",...g,ref:x,style:{...g.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:T=>{const N=A(T.clientX);l?.(N)},onSlideMove:T=>{const N=A(T.clientX);u?.(N)},onSlideEnd:()=>{S.current=void 0,f?.()},onStepKeyDown:T=>{const D=J1[M?"from-left":"from-right"].includes(T.key);p?.({event:T,direction:D?-1:1})}})})}),f5=w.forwardRef((r,e)=>{const{min:t,max:n,inverted:o,onSlideStart:i,onSlideMove:l,onSlideEnd:u,onStepKeyDown:f,...p}=r,g=w.useRef(null),m=je(e,g),y=w.useRef(void 0),x=!o;function S(C){const E=y.current||g.current.getBoundingClientRect(),M=[0,E.height],T=Tp(M,x?[n,t]:[t,n]);return y.current=E,T(C-E.top)}return h.jsx(nS,{scope:r.__scopeSlider,startEdge:x?"bottom":"top",endEdge:x?"top":"bottom",size:"height",direction:x?1:-1,children:h.jsx(aS,{"data-orientation":"vertical",...p,ref:m,style:{...p.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:C=>{const E=S(C.clientY);i?.(E)},onSlideMove:C=>{const E=S(C.clientY);l?.(E)},onSlideEnd:()=>{y.current=void 0,u?.()},onStepKeyDown:C=>{const M=J1[x?"from-bottom":"from-top"].includes(C.key);f?.({event:C,direction:M?-1:1})}})})}),aS=w.forwardRef((r,e)=>{const{__scopeSlider:t,onSlideStart:n,onSlideMove:o,onSlideEnd:i,onHomeKeyDown:l,onEndKeyDown:u,onStepKeyDown:f,...p}=r,g=bu(Tr,t);return h.jsx(Ae.span,{...p,ref:e,onKeyDown:ge(r.onKeyDown,m=>{m.key==="Home"?(l(m),m.preventDefault()):m.key==="End"?(u(m),m.preventDefault()):W1.concat(Z1).includes(m.key)&&(f(m),m.preventDefault())}),onPointerDown:ge(r.onPointerDown,m=>{const y=m.target;y.setPointerCapture(m.pointerId),m.preventDefault(),g.thumbs.has(y)?y.focus():n(m)}),onPointerMove:ge(r.onPointerMove,m=>{m.target.hasPointerCapture(m.pointerId)&&o(m)}),onPointerUp:ge(r.onPointerUp,m=>{const y=m.target;y.hasPointerCapture(m.pointerId)&&(y.releasePointerCapture(m.pointerId),i(m))})})}),oS="SliderTrack",rS=w.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,o=bu(oS,t);return h.jsx(Ae.span,{"data-disabled":o.disabled?"":void 0,"data-orientation":o.orientation,...n,ref:e})});rS.displayName=oS;var Mh="SliderRange",iS=w.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,o=bu(Mh,t),i=sS(Mh,t),l=w.useRef(null),u=je(e,l),f=o.values.length,p=o.values.map(y=>uS(y,o.min,o.max)),g=f>1?Math.min(...p):0,m=100-Math.max(...p);return h.jsx(Ae.span,{"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,...n,ref:u,style:{...r.style,[i.startEdge]:g+"%",[i.endEdge]:m+"%"}})});iS.displayName=Mh;var Eh="SliderThumb",cS=w.forwardRef((r,e)=>{const t=c5(r.__scopeSlider),[n,o]=w.useState(null),i=je(e,u=>o(u)),l=w.useMemo(()=>n?t().findIndex(u=>u.ref.current===n):-1,[t,n]);return h.jsx(h5,{...r,ref:i,index:l})}),h5=w.forwardRef((r,e)=>{const{__scopeSlider:t,index:n,name:o,...i}=r,l=bu(Eh,t),u=sS(Eh,t),[f,p]=w.useState(null),g=je(e,A=>p(A)),m=f?l.form||!!f.closest("form"):!0,y=lu(f),x=l.values[n],S=x===void 0?0:uS(x,l.min,l.max),C=m5(n,l.values.length),E=y?.[u.size],M=E?v5(E,S,u.direction):0;return w.useEffect(()=>{if(f)return l.thumbs.add(f),()=>{l.thumbs.delete(f)}},[f,l.thumbs]),h.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[u.startEdge]:`calc(${S}% + ${M}px)`},children:[h.jsx(Ch.ItemSlot,{scope:r.__scopeSlider,children:h.jsx(Ae.span,{role:"slider","aria-label":r["aria-label"]||C,"aria-valuemin":l.min,"aria-valuenow":x,"aria-valuemax":l.max,"aria-orientation":l.orientation,"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,tabIndex:l.disabled?void 0:0,...i,ref:g,style:x===void 0?{display:"none"}:r.style,onFocus:ge(r.onFocus,()=>{l.valueIndexToChangeRef.current=n})})}),m&&h.jsx(lS,{name:o??(l.name?l.name+(l.values.length>1?"[]":""):void 0),form:l.form,value:x},n)]})});cS.displayName=Eh;var p5="RadioBubbleInput",lS=w.forwardRef(({__scopeSlider:r,value:e,...t},n)=>{const o=w.useRef(null),i=je(o,n),l=gu(e);return w.useEffect(()=>{const u=o.current;if(!u)return;const f=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(f,"value").set;if(l!==e&&g){const m=new Event("input",{bubbles:!0});g.call(u,e),u.dispatchEvent(m)}},[l,e]),h.jsx(Ae.input,{style:{display:"none"},...t,ref:i,defaultValue:e})});lS.displayName=p5;function g5(r=[],e,t){const n=[...r];return n[t]=e,n.sort((o,i)=>o-i)}function uS(r,e,t){const i=100/(t-e)*(r-e);return Ti(i,[0,100])}function m5(r,e){return e>2?`Value ${r+1} of ${e}`:e===2?["Minimum","Maximum"][r]:void 0}function y5(r,e){if(r.length===1)return 0;const t=r.map(o=>Math.abs(o-e)),n=Math.min(...t);return t.indexOf(n)}function v5(r,e,t){const n=r/2,i=Tp([0,50],[0,n]);return(n-i(e)*t)*t}function b5(r){return r.slice(0,-1).map((e,t)=>r[t+1]-e)}function x5(r,e){if(e>0){const t=b5(r);return Math.min(...t)>=e}return!0}function Tp(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function w5(r){return(String(r).split(".")[1]||"").length}function S5(r,e){const t=Math.pow(10,e);return Math.round(r*t)/t}var dS=tS,C5=rS,M5=iS,E5=cS;const ts=w.forwardRef(({className:r,...e},t)=>h.jsxs(dS,{ref:t,className:Ee("relative flex w-full touch-none select-none items-center",r),...e,children:[h.jsx(C5,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:h.jsx(M5,{className:"absolute h-full bg-primary"})}),h.jsx(E5,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]}));ts.displayName=dS.displayName;var xu="Switch",[R5]=bn(xu),[T5,A5]=R5(xu),fS=w.forwardRef((r,e)=>{const{__scopeSwitch:t,name:n,checked:o,defaultChecked:i,required:l,disabled:u,value:f="on",onCheckedChange:p,form:g,...m}=r,[y,x]=w.useState(null),S=je(e,T=>x(T)),C=w.useRef(!1),E=y?g||!!y.closest("form"):!0,[M,A]=xs({prop:o,defaultProp:i??!1,onChange:p,caller:xu});return h.jsxs(T5,{scope:t,checked:M,disabled:u,children:[h.jsx(Ae.button,{type:"button",role:"switch","aria-checked":M,"aria-required":l,"data-state":mS(M),"data-disabled":u?"":void 0,disabled:u,value:f,...m,ref:S,onClick:ge(r.onClick,T=>{A(N=>!N),E&&(C.current=T.isPropagationStopped(),C.current||T.stopPropagation())})}),E&&h.jsx(gS,{control:y,bubbles:!C.current,name:n,value:f,checked:M,required:l,disabled:u,form:g,style:{transform:"translateX(-100%)"}})]})});fS.displayName=xu;var hS="SwitchThumb",pS=w.forwardRef((r,e)=>{const{__scopeSwitch:t,...n}=r,o=A5(hS,t);return h.jsx(Ae.span,{"data-state":mS(o.checked),"data-disabled":o.disabled?"":void 0,...n,ref:e})});pS.displayName=hS;var N5="SwitchBubbleInput",gS=w.forwardRef(({__scopeSwitch:r,control:e,checked:t,bubbles:n=!0,...o},i)=>{const l=w.useRef(null),u=je(l,i),f=gu(t),p=lu(e);return w.useEffect(()=>{const g=l.current;if(!g)return;const m=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(m,"checked").set;if(f!==t&&x){const S=new Event("click",{bubbles:n});x.call(g,t),g.dispatchEvent(S)}},[f,t,n]),h.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...o,tabIndex:-1,ref:u,style:{...o.style,...p,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});gS.displayName=N5;function mS(r){return r?"checked":"unchecked"}var yS=fS,k5=pS;const lo=w.forwardRef(({className:r,...e},t)=>h.jsx(yS,{className:Ee("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...e,ref:t,children:h.jsx(k5,{className:Ee("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));lo.displayName=yS.displayName;const Nn=w.forwardRef(({className:r,...e},t)=>h.jsx("div",{ref:t,className:Ee("rounded-xl border bg-card text-card-foreground shadow",r),...e}));Nn.displayName="Card";const Ws=w.forwardRef(({className:r,...e},t)=>h.jsx("div",{ref:t,className:Ee("flex flex-col space-y-1.5 p-6",r),...e}));Ws.displayName="CardHeader";const Zs=w.forwardRef(({className:r,...e},t)=>h.jsx("div",{ref:t,className:Ee("font-semibold leading-none tracking-tight",r),...e}));Zs.displayName="CardTitle";const gr=w.forwardRef(({className:r,...e},t)=>h.jsx("div",{ref:t,className:Ee("text-sm text-muted-foreground",r),...e}));gr.displayName="CardDescription";const Js=w.forwardRef(({className:r,...e},t)=>h.jsx("div",{ref:t,className:Ee("p-6 pt-0",r),...e}));Js.displayName="CardContent";const D5=w.forwardRef(({className:r,...e},t)=>h.jsx("div",{ref:t,className:Ee("flex items-center p-6 pt-0",r),...e}));D5.displayName="CardFooter";const j5=jh("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Qt({className:r,variant:e,...t}){return h.jsx("div",{className:Ee(j5({variant:e}),r),...t})}const Ei={heading:{h1:"text-2xl font-bold text-foreground",h2:"text-lg font-semibold text-foreground",h3:"text-sm font-semibold text-foreground",h4:"text-xs font-semibold text-foreground",h5:"text-[10px] font-semibold text-muted-foreground uppercase"},body:{base:"text-sm text-foreground",small:"text-xs text-foreground",micro:"text-[10px] text-foreground"},muted:{base:"text-sm text-muted-foreground",small:"text-xs text-muted-foreground",micro:"text-[10px] text-muted-foreground"},mono:{base:"font-mono text-sm text-foreground",small:"font-mono text-xs text-foreground",micro:"font-mono text-[10px] text-foreground"},status:{success:"text-success",warning:"text-warning",error:"text-destructive",info:"text-primary"}},ms=w.forwardRef(({level:r,as:e,className:t,children:n,...o},i)=>{const l=e||`h${r}`,u=`h${r}`;return h.jsx(l,{ref:i,className:Ee(Ei.heading[u],t),...o,children:n})});ms.displayName="Heading";const Ye=w.forwardRef(({size:r="base",muted:e=!1,mono:t=!1,as:n="p",className:o,children:i,...l},u)=>{const f=n;let p;return t?p=Ei.mono[r]:e?p=Ei.muted[r]:p=Ei.body[r],h.jsx(f,{ref:u,className:Ee(p,o),...l,children:i})});Ye.displayName="Text";const co=w.forwardRef(({status:r,size:e="base",weight:t="normal",as:n="span",className:o,children:i,...l},u)=>{const f=n,p={base:"text-sm",small:"text-xs",micro:"text-[10px]"},g={normal:"font-normal",medium:"font-medium",semibold:"font-semibold",bold:"font-bold"};return h.jsx(f,{ref:u,className:Ee(p[e],g[t],Ei.status[r],o),...l,children:i})});co.displayName="StatusText";const _5=w.forwardRef(({as:r="h2",className:e,children:t,...n},o)=>h.jsx(ms,{ref:o,level:1,as:r,className:e,...n,children:t}));_5.displayName="PageTitle";const z5=w.forwardRef(({as:r="h3",className:e,children:t,...n},o)=>h.jsx(ms,{ref:o,level:2,as:r,className:e,...n,children:t}));z5.displayName="SectionTitle";const Xs=w.forwardRef(({as:r="h3",className:e,children:t,...n},o)=>h.jsx(ms,{ref:o,level:3,as:r,className:e,...n,children:t}));Xs.displayName="PanelTitle";const L5=w.forwardRef(({as:r="p",className:e,children:t,...n},o)=>h.jsx(Ye,{ref:o,size:"base",muted:!0,as:r,className:Ee("mt-1",e),...n,children:t}));L5.displayName="Description";function O5({connection:r,onUpdate:e}){const t=r.data||{},{isRunning:n}=kt(),{getConnectionMessages:o,getMessageHistory:i}=ja(),[l,u]=w.useState([]),[f,p]=w.useState([]);w.useEffect(()=>{if(!n){u([]),p([]);return}const M=setInterval(()=>{const A=o(r.id),T=i(50).filter(N=>N.connectionId===r.id);u(A),p(T)},200);return()=>clearInterval(M)},[n,r.id,o,i]);const g=M=>{const A={...t,...M};e(r.id,{data:A})},m=M=>{g({latencyMs:Math.max(0,M)})},y=M=>{g({bandwidthMbps:Math.max(1,M)})},x=M=>{g({packetLossPercent:Math.max(0,Math.min(100,M))})},S=M=>{g({jitterMs:Math.max(0,M)})},C=M=>{g({retryCount:Math.max(0,M)})},E=M=>{g({timeoutMs:Math.max(1e3,M)})};return h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"space-y-1",children:[h.jsx(Xs,{children:"Connection"}),h.jsxs("div",{className:"space-y-0.5",children:[h.jsxs(Ye,{size:"micro",muted:!0,children:["From: ",r.source]}),h.jsxs(Ye,{size:"micro",muted:!0,children:["To: ",r.target]}),h.jsxs(Ye,{size:"micro",muted:!0,children:["Type: ",r.type]})]})]}),h.jsxs("div",{className:"border-t border-border pt-2 space-y-2",children:[h.jsxs("div",{children:[h.jsx(ms,{level:5,className:"mb-1.5 opacity-70",children:"Network Parameters"}),h.jsxs("div",{className:"space-y-1 mb-2",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx(st,{className:"text-xs",children:"Latency (ms)"}),h.jsx(Ye,{mono:!0,size:"micro",className:"text-primary",children:t.latencyMs??0})]}),h.jsx(ts,{value:[t.latencyMs??0],onValueChange:M=>m(M[0]),min:0,max:5e3,step:10,className:"w-full"}),h.jsx(Nt,{type:"number",value:t.latencyMs??0,onChange:M=>m(parseInt(M.target.value)||0),placeholder:"0-5000",className:"h-7 text-xs"})]}),h.jsxs("div",{className:"space-y-1 mb-2",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx(st,{className:"text-xs",children:"Bandwidth (Mbps)"}),h.jsx(Ye,{mono:!0,size:"micro",className:"text-primary",children:t.bandwidthMbps??1e3})]}),h.jsx(ts,{value:[t.bandwidthMbps??1e3],onValueChange:M=>y(M[0]),min:1,max:1e5,step:10,className:"w-full"}),h.jsx(Nt,{type:"number",value:t.bandwidthMbps??1e3,onChange:M=>y(parseInt(M.target.value)||1e3),placeholder:"1-100000",className:"h-7 text-xs"})]}),h.jsxs("div",{className:"space-y-1 mb-2",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx(st,{className:"text-xs",children:"Packet Loss (%)"}),h.jsx(Ye,{mono:!0,size:"micro",className:"text-primary",children:t.packetLossPercent??0})]}),h.jsx(ts,{value:[t.packetLossPercent??0],onValueChange:M=>x(M[0]),min:0,max:100,step:.1,className:"w-full"}),h.jsx(Nt,{type:"number",step:"0.1",value:t.packetLossPercent??0,onChange:M=>x(parseFloat(M.target.value)||0),placeholder:"0-100",className:"h-7 text-xs"})]}),h.jsxs("div",{className:"space-y-1 mb-2",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx(st,{className:"text-xs",children:"Jitter (ms)"}),h.jsx(Ye,{mono:!0,size:"micro",className:"text-primary",children:t.jitterMs??0})]}),h.jsx(ts,{value:[t.jitterMs??0],onValueChange:M=>S(M[0]),min:0,max:1e3,step:5,className:"w-full"}),h.jsx(Nt,{type:"number",value:t.jitterMs??0,onChange:M=>S(parseInt(M.target.value)||0),placeholder:"0-1000",className:"h-7 text-xs"})]})]}),h.jsxs("div",{className:"border-t border-border pt-2",children:[h.jsx("h4",{className:"text-[9px] font-semibold text-foreground mb-1.5 uppercase opacity-70",children:"Traffic Characteristics"}),h.jsxs("div",{className:"space-y-1 mb-2",children:[h.jsx(st,{className:"text-xs",children:"Priority Level"}),h.jsxs(a5,{value:t.priorityLevel||"medium",onValueChange:M=>g({priorityLevel:M}),children:[h.jsx(V1,{className:"h-7 text-[11px]",children:h.jsx(o5,{})}),h.jsxs(X1,{children:[h.jsx(Ci,{value:"low",children:"Low"}),h.jsx(Ci,{value:"medium",children:"Medium"}),h.jsx(Ci,{value:"high",children:"High"}),h.jsx(Ci,{value:"critical",children:"Critical"})]})]})]}),h.jsxs("div",{className:"space-y-1 mb-2",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx(st,{className:"text-xs",children:"Retry Count"}),h.jsx(Ye,{mono:!0,size:"micro",className:"text-primary",children:t.retryCount??3})]}),h.jsx(ts,{value:[t.retryCount??3],onValueChange:M=>C(M[0]),min:0,max:10,step:1,className:"w-full"}),h.jsx(Nt,{type:"number",value:t.retryCount??3,onChange:M=>C(parseInt(M.target.value)||0),placeholder:"0-10",className:"h-7 text-xs"})]}),h.jsxs("div",{className:"space-y-1 mb-2",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx(st,{className:"text-xs",children:"Timeout (ms)"}),h.jsx(Ye,{mono:!0,size:"micro",className:"text-primary",children:t.timeoutMs??3e4})]}),h.jsx(ts,{value:[t.timeoutMs??3e4],onValueChange:M=>E(M[0]),min:1e3,max:12e4,step:1e3,className:"w-full"}),h.jsx(Nt,{type:"number",value:t.timeoutMs??3e4,onChange:M=>E(parseInt(M.target.value)||3e4),placeholder:"1000-120000",className:"h-7 text-xs"})]})]}),h.jsxs("div",{className:"border-t border-border pt-2",children:[h.jsx(ms,{level:5,className:"mb-1.5 opacity-70",children:"Monitoring"}),h.jsxs("div",{className:"flex items-center justify-between p-1.5 bg-accent/20 rounded-md",children:[h.jsx(st,{className:"text-xs cursor-pointer",children:"Enable Monitoring"}),h.jsx(lo,{checked:t.enableMonitoring??!1,onCheckedChange:M=>g({enableMonitoring:M})})]})]}),h.jsx(Nn,{className:"bg-card/50 border-border/50 p-1.5 mt-2",children:h.jsxs("div",{className:"space-y-0.5",children:[h.jsxs("div",{className:"flex justify-between",children:[h.jsx(Ye,{size:"micro",muted:!0,children:"Effective Bandwidth:"}),h.jsxs(Ye,{mono:!0,size:"micro",children:[Math.max(1,(t.bandwidthMbps??1e3)*(1-(t.packetLossPercent??0)/100)).toFixed(2)," Mbps"]})]}),h.jsxs("div",{className:"flex justify-between",children:[h.jsx(Ye,{size:"micro",muted:!0,children:"Effective Latency:"}),h.jsxs(Ye,{mono:!0,size:"micro",children:[((t.latencyMs??0)+(t.jitterMs??0)/2).toFixed(0)," ms"]})]})]})}),n&&h.jsx("div",{className:"border-t border-border pt-2 mt-2",children:h.jsxs(ip,{defaultValue:"active",className:"w-full",children:[h.jsxs(au,{className:"grid w-full grid-cols-2 h-7",children:[h.jsxs(hs,{value:"active",className:"text-xs px-2",children:[h.jsx(ho,{className:"h-3 w-3 mr-1"}),"Active (",l.length,")"]}),h.jsxs(hs,{value:"history",className:"text-xs px-2",children:[h.jsx(K0,{className:"h-3 w-3 mr-1"}),"History (",f.length,")"]})]}),h.jsx(_a,{value:"active",className:"mt-1.5 space-y-1",children:l.length===0?h.jsxs("div",{className:"text-center py-3",children:[h.jsx(ho,{className:"h-5 w-5 mx-auto mb-1 opacity-50"}),h.jsx(Ye,{size:"micro",muted:!0,children:"No active messages"})]}):h.jsx("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:l.map((M,A)=>h.jsxs(Nn,{className:"p-1 border-border/50",children:[h.jsx("div",{className:"flex items-start justify-between gap-1.5",children:h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[h.jsx(Qt,{variant:"outline",className:"text-xs px-0.5 py-0",children:M.format}),h.jsx(Qt,{variant:M.status==="delivered"?"default":M.status==="failed"?"destructive":M.status==="transformed"?"secondary":"outline",className:"text-xs px-0.5 py-0",children:M.status})]}),h.jsxs("div",{className:"text-[9px] text-muted-foreground space-y-0.5",children:[h.jsxs("div",{children:["Size: ",(M.size/1024).toFixed(2)," KB"]}),M.latency&&h.jsxs("div",{children:["Latency: ",M.latency.toFixed(0)," ms"]})]}),M.error&&h.jsxs("div",{className:"text-[10px] text-destructive mt-0.5 flex items-center gap-0.5",children:[h.jsx(Ri,{className:"h-2.5 w-2.5"}),M.error]})]})}),M.payload&&h.jsxs("details",{className:"mt-1",children:[h.jsx("summary",{className:"text-[9px] cursor-pointer text-muted-foreground hover:text-foreground",children:"Show Data"}),h.jsx("pre",{className:"mt-1 p-1 bg-muted rounded text-[9px] overflow-x-auto max-h-32 overflow-y-auto",children:JSON.stringify(M.payload,null,2)})]})]},M.id||A))})}),h.jsx(_a,{value:"history",className:"mt-1.5 space-y-1",children:f.length===0?h.jsxs("div",{className:"text-center py-3",children:[h.jsx(K0,{className:"h-5 w-5 mx-auto mb-1 opacity-50"}),h.jsx(Ye,{size:"micro",muted:!0,children:"History is empty"})]}):h.jsx("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:f.map((M,A)=>h.jsxs(Nn,{className:"p-1 border-border/50",children:[h.jsx("div",{className:"flex items-start justify-between gap-1.5",children:h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[h.jsx(Qt,{variant:"outline",className:"text-xs px-0.5 py-0",children:M.format}),h.jsx(Qt,{variant:M.status==="delivered"?"default":M.status==="failed"?"destructive":"outline",className:"text-xs px-0.5 py-0",children:M.status}),h.jsx("span",{className:"text-[9px] text-muted-foreground",children:new Date(M.timestamp).toLocaleTimeString()})]}),h.jsxs("div",{className:"text-[9px] text-muted-foreground space-y-0.5",children:[h.jsxs("div",{children:["Size: ",(M.size/1024).toFixed(2)," KB"]}),M.latency&&h.jsxs("div",{children:["Latency: ",M.latency.toFixed(0)," ms"]})]}),M.error&&h.jsxs("div",{className:"text-[10px] text-destructive mt-0.5 flex items-center gap-0.5",children:[h.jsx(Ri,{className:"h-2.5 w-2.5"}),M.error]})]})}),M.payload&&h.jsxs("details",{className:"mt-1",children:[h.jsx("summary",{className:"text-[9px] cursor-pointer text-muted-foreground hover:text-foreground",children:"Show Data"}),h.jsx("pre",{className:"mt-1 p-1 bg-muted rounded text-[9px] overflow-x-auto max-h-32 overflow-y-auto",children:JSON.stringify(M.payload,null,2)})]})]},M.id||A))})})]})})]})]})}function P5(r){const e=I5(r),t=w.forwardRef((n,o)=>{const{children:i,...l}=n,u=w.Children.toArray(i),f=u.find(H5);if(f){const p=f.props.children,g=u.map(m=>m===f?w.Children.count(p)>1?w.Children.only(null):w.isValidElement(p)?p.props.children:null:m);return h.jsx(e,{...l,ref:o,children:w.isValidElement(p)?w.cloneElement(p,void 0,g):null})}return h.jsx(e,{...l,ref:o,children:i})});return t.displayName=`${r}.Slot`,t}function I5(r){const e=w.forwardRef((t,n)=>{const{children:o,...i}=t;if(w.isValidElement(o)){const l=$5(o),u=U5(i,o.props);return o.type!==w.Fragment&&(u.ref=n?Ss(n,l):l),w.cloneElement(o,u)}return w.Children.count(o)>1?w.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var q5=Symbol("radix.slottable");function H5(r){return w.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===q5}function U5(r,e){const t={...e};for(const n in e){const o=r[n],i=e[n];/^on[A-Z]/.test(n)?o&&i?t[n]=(...u)=>{const f=i(...u);return o(...u),f}:o&&(t[n]=o):n==="style"?t[n]={...o,...i}:n==="className"&&(t[n]=[o,i].filter(Boolean).join(" "))}return{...r,...t}}function $5(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var wu="Popover",[vS]=bn(wu,[Er]),Qi=Er(),[B5,Ha]=vS(wu),bS=r=>{const{__scopePopover:e,children:t,open:n,defaultOpen:o,onOpenChange:i,modal:l=!1}=r,u=Qi(e),f=w.useRef(null),[p,g]=w.useState(!1),[m,y]=xs({prop:n,defaultProp:o??!1,onChange:i,caller:wu});return h.jsx(mp,{...u,children:h.jsx(B5,{scope:e,contentId:ns(),triggerRef:f,open:m,onOpenChange:y,onOpenToggle:w.useCallback(()=>y(x=>!x),[y]),hasCustomAnchor:p,onCustomAnchorAdd:w.useCallback(()=>g(!0),[]),onCustomAnchorRemove:w.useCallback(()=>g(!1),[]),modal:l,children:t})})};bS.displayName=wu;var xS="PopoverAnchor",Q5=w.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,o=Ha(xS,t),i=Qi(t),{onCustomAnchorAdd:l,onCustomAnchorRemove:u}=o;return w.useEffect(()=>(l(),()=>u()),[l,u]),h.jsx(uu,{...i,...n,ref:e})});Q5.displayName=xS;var wS="PopoverTrigger",SS=w.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,o=Ha(wS,t),i=Qi(t),l=je(e,o.triggerRef),u=h.jsx(Ae.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":TS(o.open),...n,ref:l,onClick:ge(r.onClick,o.onOpenToggle)});return o.hasCustomAnchor?u:h.jsx(uu,{asChild:!0,...i,children:u})});SS.displayName=wS;var Ap="PopoverPortal",[G5,F5]=vS(Ap,{forceMount:void 0}),CS=r=>{const{__scopePopover:e,forceMount:t,children:n,container:o}=r,i=Ha(Ap,e);return h.jsx(G5,{scope:e,forceMount:t,children:h.jsx(rn,{present:t||i.open,children:h.jsx(Ii,{asChild:!0,container:o,children:n})})})};CS.displayName=Ap;var vr="PopoverContent",MS=w.forwardRef((r,e)=>{const t=F5(vr,r.__scopePopover),{forceMount:n=t.forceMount,...o}=r,i=Ha(vr,r.__scopePopover);return h.jsx(rn,{present:n||i.open,children:i.modal?h.jsx(K5,{...o,ref:e}):h.jsx(Y5,{...o,ref:e})})});MS.displayName=vr;var V5=P5("PopoverContent.RemoveScroll"),K5=w.forwardRef((r,e)=>{const t=Ha(vr,r.__scopePopover),n=w.useRef(null),o=je(e,n),i=w.useRef(!1);return w.useEffect(()=>{const l=n.current;if(l)return Kl(l)},[]),h.jsx(qi,{as:V5,allowPinchZoom:!0,children:h.jsx(ES,{...r,ref:o,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ge(r.onCloseAutoFocus,l=>{l.preventDefault(),i.current||t.triggerRef.current?.focus()}),onPointerDownOutside:ge(r.onPointerDownOutside,l=>{const u=l.detail.originalEvent,f=u.button===0&&u.ctrlKey===!0,p=u.button===2||f;i.current=p},{checkForDefaultPrevented:!1}),onFocusOutside:ge(r.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1})})})}),Y5=w.forwardRef((r,e)=>{const t=Ha(vr,r.__scopePopover),n=w.useRef(!1),o=w.useRef(!1);return h.jsx(ES,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{r.onCloseAutoFocus?.(i),i.defaultPrevented||(n.current||t.triggerRef.current?.focus(),i.preventDefault()),n.current=!1,o.current=!1},onInteractOutside:i=>{r.onInteractOutside?.(i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(o.current=!0));const l=i.target;t.triggerRef.current?.contains(l)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&o.current&&i.preventDefault()}})}),ES=w.forwardRef((r,e)=>{const{__scopePopover:t,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:p,onInteractOutside:g,...m}=r,y=Ha(vr,t),x=Qi(t);return Fl(),h.jsx(Pi,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:o,onUnmountAutoFocus:i,children:h.jsx(Oi,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:g,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:p,onDismiss:()=>y.onOpenChange(!1),children:h.jsx(yp,{"data-state":TS(y.open),role:"dialog",id:y.contentId,...x,...m,ref:e,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),RS="PopoverClose",X5=w.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,o=Ha(RS,t);return h.jsx(Ae.button,{type:"button",...n,ref:e,onClick:ge(r.onClick,()=>o.onOpenChange(!1))})});X5.displayName=RS;var W5="PopoverArrow",Z5=w.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,o=Qi(t);return h.jsx(vp,{...o,...n,ref:e})});Z5.displayName=W5;function TS(r){return r?"open":"closed"}var J5=bS,eL=SS,tL=CS,AS=MS;const nL=J5,sL=eL,NS=w.forwardRef(({className:r,align:e="center",sideOffset:t=4,...n},o)=>h.jsx(tL,{children:h.jsx(AS,{ref:o,align:e,sideOffset:t,className:Ee("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",r),...n})}));NS.displayName=AS.displayName;const kS=Cs((r,e)=>({componentStates:new Map,setComponentState:(t,n,o)=>{dr.setComponentState(t,n,o);const i=dr.getComponentState(t);i&&r(l=>({componentStates:new Map(l.componentStates).set(t,i)}))},resetComponent:t=>{dr.resetComponent(t),r(n=>{const o=new Map(n.componentStates);return o.delete(t),{componentStates:o}})},resetAll:()=>{dr.reset(),r({componentStates:new Map})},getComponentState:t=>e().componentStates.get(t),isEnabled:t=>dr.isEnabled(t),getAllStates:()=>Array.from(e().componentStates.values())}));function aL({componentId:r,componentLabel:e}){const{isRunning:t}=kt(),{getComponentState:n,setComponentState:o,resetComponent:i}=kS(),l=n(r),u=l?.state||"enabled",[f,p]=w.useState(l?.degradedLevel||.5),[g,m]=w.useState(l?.failureRate||.1),[y,x]=w.useState(l?.latencyMultiplier||2),[S,C]=w.useState(l?.throughputMultiplier||.5),E=N=>{N==="degraded"?o(r,N,{degradedLevel:f,failureRate:g,latencyMultiplier:y,throughputMultiplier:S}):o(r,N)},M=()=>{i(r),p(.5),m(.1),x(2),C(.5)},A=N=>{switch(N){case"enabled":return"bg-green-500/20 text-green-500 border-green-500/50";case"disabled":return"bg-gray-500/20 text-gray-500 border-gray-500/50";case"degraded":return"bg-yellow-500/20 text-yellow-500 border-yellow-500/50";case"failed":return"bg-red-500/20 text-red-500 border-red-500/50"}},T=N=>{switch(N){case"enabled":return h.jsx(Ff,{className:"w-4 h-4"});case"disabled":return h.jsx(bl,{className:"w-4 h-4"});case"degraded":return h.jsx(ys,{className:"w-4 h-4"});case"failed":return h.jsx(uo,{className:"w-4 h-4"})}};return h.jsxs(Nn,{className:"border",children:[h.jsx(Ws,{className:"p-2 pb-1.5",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsxs(Zs,{className:"text-[11px] flex items-center gap-1",children:[h.jsx(ho,{className:"w-3 h-3"}),"Component State",h.jsxs(nL,{children:[h.jsx(sL,{asChild:!0,children:h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-3.5 w-3.5 rounded-full",children:h.jsx(LA,{className:"w-2.5 h-2.5 text-muted-foreground"})})}),h.jsx(NS,{className:"w-72 text-xs",align:"start",children:h.jsxs("div",{className:"space-y-2",children:[h.jsx("h4",{className:"font-semibold text-sm",children:"Component States"}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsx(Ff,{className:"w-3.5 h-3.5 text-green-500 mt-0.5 flex-shrink-0"}),h.jsxs("div",{children:[h.jsx("span",{className:"font-medium text-green-500",children:"Enabled"}),h.jsx("span",{className:"text-muted-foreground",children:"  normal operation"})]})]}),h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsx(bl,{className:"w-3.5 h-3.5 text-gray-500 mt-0.5 flex-shrink-0"}),h.jsxs("div",{children:[h.jsx("span",{className:"font-medium text-gray-500",children:"Disabled"}),h.jsx("span",{className:"text-muted-foreground",children:"  turned off. Throughput=0, Errors=100%"})]})]}),h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsx(ys,{className:"w-3.5 h-3.5 text-yellow-500 mt-0.5 flex-shrink-0"}),h.jsxs("div",{children:[h.jsx("span",{className:"font-medium text-yellow-500",children:"Degraded"}),h.jsx("span",{className:"text-muted-foreground",children:"  partial failure. Throughput 50%, Latency 2x, Errors 10%"})]})]}),h.jsxs("div",{className:"flex items-start gap-2",children:[h.jsx(uo,{className:"w-3.5 h-3.5 text-red-500 mt-0.5 flex-shrink-0"}),h.jsxs("div",{children:[h.jsx("span",{className:"font-medium text-red-500",children:"Failed"}),h.jsx("span",{className:"text-muted-foreground",children:"  crashed. Same as Disabled but indicates failure"})]})]})]}),h.jsx("p",{className:"text-muted-foreground pt-1 border-t border-border",children:"Use to simulate failures and test architecture resilience."})]})})]})]}),h.jsx(gr,{className:"text-[9px] mt-0.5",children:"Control operational state"})]}),l&&h.jsxs(Qt,{variant:"outline",className:`${A(u)} text-xs px-1 py-0.5`,children:[T(u),h.jsx("span",{className:"ml-0.5",children:u.toUpperCase()})]})]})}),h.jsxs(Js,{className:"p-2 pt-1.5 space-y-2",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[h.jsxs(Ne,{variant:u==="enabled"?"default":"outline",size:"sm",onClick:()=>E("enabled"),className:"flex items-center gap-1 h-7 text-xs",disabled:!t,children:[h.jsx(Ff,{className:"w-3.5 h-3.5"}),"Enabled"]}),h.jsxs(Ne,{variant:u==="disabled"?"destructive":"outline",size:"sm",onClick:()=>E("disabled"),className:"flex items-center gap-1 h-7 text-xs",disabled:!t,children:[h.jsx(bl,{className:"w-3.5 h-3.5"}),"Disabled"]}),h.jsxs(Ne,{variant:u==="degraded"?"default":"outline",size:"sm",onClick:()=>E("degraded"),className:"flex items-center gap-1 h-7 text-xs bg-yellow-500/20 hover:bg-yellow-500/30 text-yellow-600 dark:text-yellow-400",disabled:!t,children:[h.jsx(ys,{className:"w-3.5 h-3.5"}),"Degraded"]}),h.jsxs(Ne,{variant:u==="failed"?"destructive":"outline",size:"sm",onClick:()=>E("failed"),className:"flex items-center gap-1 h-7 text-xs",disabled:!t,children:[h.jsx(uo,{className:"w-3.5 h-3.5"}),"Failed"]})]}),u==="degraded"&&h.jsxs("div",{className:"space-y-2 p-2 bg-yellow-500/10 rounded-lg border border-yellow-500/20",children:[h.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[h.jsx(db,{className:"w-3 h-3 text-yellow-600 dark:text-yellow-400"}),h.jsx(st,{className:"text-[11px] font-semibold text-yellow-600 dark:text-yellow-400",children:"Degradation Settings"})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[h.jsx(st,{className:"text-[10px]",children:"Degradation Level"}),h.jsxs("span",{className:"text-[9px] text-muted-foreground",children:[(f*100).toFixed(0),"%"]})]}),h.jsx(ts,{value:[f],onValueChange:N=>{p(N[0]),E("degraded")},min:0,max:1,step:.1,className:"w-full"})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[h.jsx(st,{className:"text-[10px]",children:"Failure Rate"}),h.jsxs("span",{className:"text-[9px] text-muted-foreground",children:[(g*100).toFixed(0),"%"]})]}),h.jsx(ts,{value:[g],onValueChange:N=>{m(N[0]),E("degraded")},min:0,max:1,step:.05,className:"w-full"})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[h.jsx(st,{className:"text-[10px]",children:"Latency Multiplier"}),h.jsxs("span",{className:"text-[9px] text-muted-foreground",children:[y.toFixed(1),"x"]})]}),h.jsx(ts,{value:[y],onValueChange:N=>{x(N[0]),E("degraded")},min:1,max:5,step:.1,className:"w-full"})]}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-0.5",children:[h.jsx(st,{className:"text-[10px]",children:"Throughput Multiplier"}),h.jsxs("span",{className:"text-[9px] text-muted-foreground",children:[(S*100).toFixed(0),"%"]})]}),h.jsx(ts,{value:[S],onValueChange:N=>{C(N[0]),E("degraded")},min:0,max:1,step:.05,className:"w-full"})]})]})]}),l&&h.jsxs(Ne,{variant:"outline",size:"sm",onClick:M,className:"w-full flex items-center gap-1 h-7 text-xs",disabled:!t,children:[h.jsx(ub,{className:"w-3.5 h-3.5"}),"Reset to Normal"]}),!t&&h.jsxs("div",{className:"flex items-center gap-1 p-1 bg-muted rounded text-[9px] text-muted-foreground",children:[h.jsx(Ri,{className:"w-3 h-3"}),"Start emulation to control component state"]})]})]})}function oL({onFilterChange:r}){const{nodes:e,connections:t,selectNode:n}=Re(),{isRunning:o,getComponentMetrics:i}=kt(),{getAllComponentStatuses:l}=fo(),[u,f]=w.useState(""),[p,g]=w.useState(!1),[m,y]=w.useState(!0),[x,S]=w.useState(!0),[C,E]=w.useState(!0),[M,A]=w.useState(!0),[T,N]=w.useState(100),[D,q]=w.useState(5),[P,H]=w.useState(new Set),J=Et.useMemo(()=>o?e.filter(te=>{if(u&&!te.data.label.toLowerCase().includes(u.toLowerCase()))return!1;if(!p)return!0;const le=i(te.id),z=l().find(j=>j.nodeId===te.id);return!!(m&&t.some(O=>O.source===te.id||O.target===te.id?kt.getState().getConnectionMetrics(O.id)?.bottleneck:!1)||x&&le&&le.errorRate*100>=D||M&&le&&le.latency>=T||C&&z?.criticalPath||z&&(z.health==="critical"||z.health==="down"))}):e,[u,p,m,x,M,C,T,D,o,e,t]);Et.useEffect(()=>{if(p){const te=new Set(J.map(le=>le.id));H(te),r?.(Array.from(te))}else H(new Set),r?.(e.map(te=>te.id))},[p,J,e,r]);const se=te=>{n(te)},ce=J.length,Z=e.filter(te=>{if(!o)return!1;const le=i(te.id),z=l().find(j=>j.nodeId===te.id);return le&&(le.errorRate*100>=D||le.latency>=T)||z?.criticalPath||z&&(z.health==="critical"||z.health==="down")||t.some(j=>j.source===te.id||j.target===te.id?kt.getState().getConnectionMetrics(j.id)?.bottleneck:!1)}).length;return h.jsxs(Nn,{className:"h-full border-2",children:[h.jsx(Ws,{className:"pb-3",children:h.jsxs(Zs,{className:"text-sm flex items-center gap-2",children:[h.jsx(YA,{className:"w-4 h-4"}),"Problem Filters",ce>0&&h.jsx(Qt,{variant:"destructive",className:"ml-auto",children:ce})]})}),h.jsxs(Js,{className:"space-y-4",children:[h.jsxs("div",{className:"space-y-2",children:[h.jsx(st,{className:"text-xs",children:"Search Components"}),h.jsxs("div",{className:"relative",children:[h.jsx($l,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),h.jsx(Nt,{placeholder:"Search by name...",value:u,onChange:te=>f(te.target.value),className:"pl-8 h-8 text-xs"})]})]}),h.jsxs("div",{className:"space-y-2",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs(st,{className:"text-xs flex items-center gap-2",children:[h.jsx(BA,{className:"w-4 h-4"}),"Show Only Problems"]}),h.jsx(lo,{checked:p,onCheckedChange:g})]}),p&&h.jsxs("div",{className:"pl-6 space-y-2 border-l-2 border-border",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs(st,{className:"text-xs flex items-center gap-2",children:[h.jsx(db,{className:"w-4 h-4 text-red-500"}),"Bottlenecks"]}),h.jsx(lo,{checked:m,onCheckedChange:y})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs(st,{className:"text-xs flex items-center gap-2",children:[h.jsx(uo,{className:"w-4 h-4 text-orange-500"}),"High Error Rate (>",D,"%)"]}),h.jsx(lo,{checked:x,onCheckedChange:S})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs(st,{className:"text-xs flex items-center gap-2",children:[h.jsx(fb,{className:"w-4 h-4 text-yellow-500"}),"High Latency (>",T,"ms)"]}),h.jsx(lo,{checked:M,onCheckedChange:A})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs(st,{className:"text-xs flex items-center gap-2",children:[h.jsx(ho,{className:"w-4 h-4 text-purple-500"}),"Critical Paths"]}),h.jsx(lo,{checked:C,onCheckedChange:E})]})]})]}),p&&h.jsxs("div",{className:"space-y-2 pt-2 border-t border-border",children:[h.jsxs("div",{children:[h.jsx(st,{className:"text-xs",children:"Min Latency (ms)"}),h.jsx(Nt,{type:"number",value:T,onChange:te=>N(Number(te.target.value)),className:"h-8 text-xs mt-1",min:0})]}),h.jsxs("div",{children:[h.jsx(st,{className:"text-xs",children:"Min Error Rate (%)"}),h.jsx(Nt,{type:"number",value:D,onChange:te=>q(Number(te.target.value)),className:"h-8 text-xs mt-1",min:0,max:100})]})]}),o&&h.jsx("div",{className:"pt-2 border-t border-border",children:h.jsxs("div",{className:"text-xs text-muted-foreground",children:["Total problems detected: ",h.jsx("span",{className:"font-semibold text-foreground",children:Z})]})}),p&&J.length>0&&h.jsx(on,{className:"h-48 border border-border rounded p-2",children:h.jsx("div",{className:"space-y-1",children:J.map(te=>{const le=i(te.id),z=l().find(j=>j.nodeId===te.id);return h.jsx(Ne,{variant:"ghost",size:"sm",className:"w-full justify-start text-xs h-auto py-1.5",onClick:()=>se(te.id),children:h.jsxs("div",{className:"flex items-center gap-2 w-full",children:[z?.criticalPath&&h.jsx(Qt,{variant:"outline",className:"bg-purple-500/20 text-purple-500 border-purple-500/50 text-xs px-1",children:"Critical"}),h.jsx("span",{className:"flex-1 text-left truncate",children:te.data.label}),le&&le.errorRate*100>=D&&h.jsxs(Qt,{variant:"destructive",className:"text-xs px-1",children:[(le.errorRate*100).toFixed(0),"%"]})]})},te.id)})})}),!o&&h.jsx("div",{className:"text-xs text-muted-foreground text-center py-4",children:"Start emulation to see problems"})]})]})}function rL(){const{nodes:r,connections:e}=Re(),{isRunning:t,getComponentMetrics:n,getConnectionMetrics:o}=kt(),{getAllComponentStatuses:i,getSystemAnalysis:l}=fo(),[u,f]=w.useState(""),[p,g]=w.useState("all");if(!t)return h.jsx(Nn,{className:"h-full",children:h.jsxs(Ws,{children:[h.jsx(Zs,{children:"Diagnostics"}),h.jsx(gr,{children:"Start emulation to see diagnostics"})]})});const m=[],y=i();l(),r.forEach(E=>{const M=n(E.id),A=y.find(D=>D.nodeId===E.id);if(!M||!A)return;const T={nodeId:E.id,nodeLabel:E.data.label,problem:"",severity:"info",metrics:{throughput:M.throughput,latency:M.latency,errorRate:M.errorRate,utilization:M.utilization},affectedConnections:[],recommendations:[]},N=e.filter(D=>D.source===E.id||D.target===E.id?o(D.id)?.bottleneck:!1);if(N.length>0){T.problem=`Bottleneck detected in ${N.length} connection(s)`,T.severity="critical",T.affectedConnections=N.map(D=>D.id),T.rootCause="High throughput dependency or backpressure",T.recommendations=["Consider scaling this component horizontally","Optimize data processing logic","Check for connection bandwidth limits"],m.push(T);return}if(M.errorRate>.05){T.problem=`High error rate: ${(M.errorRate*100).toFixed(1)}%`,T.severity=M.errorRate>.1?"critical":"warning",T.rootCause="Component is experiencing failures",T.recommendations=["Check component logs for error details","Verify input data format and validation","Review retry and error handling logic"],m.push(T);return}if(M.latency>1e3){T.problem=`High latency: ${M.latency.toFixed(0)}ms`,T.severity=M.latency>2e3?"critical":"warning",T.rootCause="Component processing is slow",T.recommendations=["Optimize database queries or data processing","Consider caching frequently accessed data","Review component configuration for performance"],m.push(T);return}if(M.utilization>.9){T.problem=`High utilization: ${(M.utilization*100).toFixed(0)}%`,T.severity="warning",T.rootCause="Component is near capacity",T.recommendations=["Consider scaling this component","Optimize resource usage","Monitor for potential failures"],m.push(T);return}(A.health==="critical"||A.health==="down")&&(T.problem=`Component health: ${A.health}`,T.severity="critical",T.rootCause="Component is in critical state or down",T.recommendations=["Immediately check component status","Review error logs and metrics","Consider failover or restart"],m.push(T))});const x=m.filter(E=>!(p!=="all"&&E.severity!==p||u&&!E.nodeLabel.toLowerCase().includes(u.toLowerCase()))),S=E=>{switch(E){case"critical":return h.jsx(uo,{className:"w-4 h-4 text-red-500"});case"warning":return h.jsx(ys,{className:"w-4 h-4 text-yellow-500"});default:return h.jsx(Ri,{className:"w-4 h-4 text-blue-500"})}},C=E=>{switch(E){case"critical":return h.jsx(Qt,{variant:"destructive",className:"text-xs",children:"Critical"});case"warning":return h.jsx(Qt,{variant:"outline",className:"border-yellow-500 text-yellow-600 text-xs",children:"Warning"});default:return h.jsx(Qt,{variant:"outline",className:"text-xs",children:"Info"})}};return h.jsxs(Nn,{className:"h-full flex flex-col",children:[h.jsxs(Ws,{className:"pb-3",children:[h.jsx(Zs,{className:"text-sm font-semibold",children:"Diagnostics"}),h.jsxs(gr,{className:"text-xs text-muted-foreground",children:[x.length," problem",x.length!==1?"s":""," detected"]})]}),h.jsxs(Js,{className:"flex-1 flex flex-col overflow-hidden p-0",children:[h.jsxs("div",{className:"p-4 border-b border-border space-y-2",children:[h.jsxs("div",{className:"relative",children:[h.jsx($l,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),h.jsx(Nt,{placeholder:"Search components...",value:u,onChange:E=>f(E.target.value),className:"pl-8 h-8 text-xs"})]}),h.jsxs("div",{className:"flex gap-1",children:[h.jsx(Ne,{variant:p==="all"?"default":"outline",size:"sm",className:"h-7 text-xs px-2",onClick:()=>g("all"),children:"All"}),h.jsx(Ne,{variant:p==="critical"?"default":"outline",size:"sm",className:"h-7 text-xs px-2",onClick:()=>g("critical"),children:"Critical"}),h.jsx(Ne,{variant:p==="warning"?"default":"outline",size:"sm",className:"h-7 text-xs px-2",onClick:()=>g("warning"),children:"Warning"})]})]}),h.jsx(on,{className:"flex-1",children:h.jsx("div",{className:"p-4 space-y-2",children:x.length===0?h.jsxs("div",{className:"text-center text-sm text-muted-foreground py-6",children:[h.jsx(ho,{className:"w-6 h-6 mx-auto mb-1.5 opacity-50"}),h.jsx("p",{children:"No problems detected"})]}):x.map((E,M)=>h.jsxs(Nn,{className:`border-l-4 ${E.severity==="critical"?"border-l-red-500":E.severity==="warning"?"border-l-yellow-500":"border-l-blue-500"}`,children:[h.jsxs(Ws,{className:"pb-2 p-3",children:[h.jsxs("div",{className:"flex items-start justify-between",children:[h.jsxs("div",{className:"flex items-center gap-1.5",children:[S(E.severity),h.jsx(Zs,{className:"text-xs font-semibold",children:E.nodeLabel}),C(E.severity)]}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>{r.find(T=>T.id===E.nodeId)&&Re.getState().selectNode(E.nodeId)},children:h.jsx(EA,{className:"w-3.5 h-3.5"})})]}),h.jsx(gr,{className:"text-xs mt-0.5",children:E.problem})]}),h.jsxs(Js,{className:"pt-0 p-3 space-y-2",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[E.metrics.throughput!==void 0&&h.jsxs("div",{children:[h.jsx("span",{className:"text-muted-foreground",children:"Throughput: "}),h.jsxs("span",{className:"font-mono",children:[E.metrics.throughput.toFixed(0)," ops/s"]})]}),E.metrics.latency!==void 0&&h.jsxs("div",{children:[h.jsx("span",{className:"text-muted-foreground",children:"Latency: "}),h.jsxs("span",{className:"font-mono",children:[E.metrics.latency.toFixed(0),"ms"]})]}),E.metrics.errorRate!==void 0&&h.jsxs("div",{children:[h.jsx("span",{className:"text-muted-foreground",children:"Error Rate: "}),h.jsxs("span",{className:"font-mono",children:[(E.metrics.errorRate*100).toFixed(1),"%"]})]}),E.metrics.utilization!==void 0&&h.jsxs("div",{children:[h.jsx("span",{className:"text-muted-foreground",children:"Utilization: "}),h.jsxs("span",{className:"font-mono",children:[(E.metrics.utilization*100).toFixed(0),"%"]})]})]}),E.rootCause&&h.jsxs("div",{children:[h.jsx("div",{className:"text-xs font-semibold text-muted-foreground mb-0.5",children:"Root Cause:"}),h.jsx("div",{className:"text-xs",children:E.rootCause})]}),E.recommendations.length>0&&h.jsxs("div",{children:[h.jsx("div",{className:"text-xs font-semibold text-muted-foreground mb-0.5",children:"Recommendations:"}),h.jsx("ul",{className:"text-xs space-y-0.5 list-disc list-inside",children:E.recommendations.map((A,T)=>h.jsx("li",{className:"text-muted-foreground",children:A},T))})]})]})]},M))})})]})]})}function iL(){const{alerts:r,acknowledgeAlert:e,clearAlerts:t,getCriticalAlerts:n,getWarningAlerts:o}=Oh(),{selectNode:i}=Re(),l=n(),u=o();r.filter(g=>g.type==="info");const f=g=>{switch(g){case"critical":return h.jsx(uo,{className:"w-4 h-4 text-red-500"});case"warning":return h.jsx(ys,{className:"w-4 h-4 text-yellow-500"});default:return h.jsx(JA,{className:"w-4 h-4 text-blue-500"})}},p=g=>{i(g)};return r.length===0?h.jsxs(Nn,{className:"h-full",children:[h.jsx(Ws,{children:h.jsx(Zs,{className:"text-sm",children:"Alerts"})}),h.jsx(Js,{children:h.jsxs("div",{className:"text-center text-sm text-muted-foreground py-8",children:[h.jsx(qh,{className:"w-8 h-8 mx-auto mb-2 opacity-50 text-green-500"}),h.jsx("p",{children:"No active alerts"})]})})]}):h.jsxs(Nn,{className:"h-full flex flex-col",children:[h.jsx(Ws,{className:"pb-3",children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{children:[h.jsx(Zs,{className:"text-sm",children:"Alerts"}),h.jsxs("div",{className:"flex gap-2 mt-1",children:[l.length>0&&h.jsxs(Qt,{variant:"destructive",className:"text-xs",children:[l.length," Critical"]}),u.length>0&&h.jsxs(Qt,{variant:"outline",className:"text-xs border-yellow-500 text-yellow-600",children:[u.length," Warning"]})]})]}),h.jsx(Ne,{variant:"ghost",size:"sm",className:"h-7 text-xs",onClick:t,children:"Clear All"})]})}),h.jsx(Js,{className:"flex-1 overflow-hidden p-0",children:h.jsx(on,{className:"h-full",children:h.jsx("div",{className:"p-4 space-y-2",children:r.map(g=>h.jsx(Nn,{className:`border-l-4 ${g.type==="critical"?"border-l-red-500 bg-red-500/5":g.type==="warning"?"border-l-yellow-500 bg-yellow-500/5":"border-l-blue-500 bg-blue-500/5"}`,children:h.jsx(Js,{className:"p-3",children:h.jsxs("div",{className:"flex items-start justify-between gap-2",children:[h.jsxs("div",{className:"flex items-start gap-2 flex-1",children:[f(g.type),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[h.jsx("h4",{className:"text-xs font-semibold",children:g.title}),h.jsx(Qt,{variant:g.type==="critical"?"destructive":g.type==="warning"?"outline":"secondary",className:"text-xs",children:g.type})]}),h.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:g.message}),g.nodeLabel&&h.jsxs(Ne,{variant:"ghost",size:"sm",className:"h-6 text-xs p-1",onClick:()=>g.nodeId&&p(g.nodeId),children:["View: ",g.nodeLabel]}),h.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(g.timestamp).toLocaleTimeString()})]})]}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>e(g.id),children:h.jsx(vs,{className:"w-3 h-3"})})]})})},g.id))})})})]})}function cL(){const{nodes:r,connections:e}=Re(),{isRunning:t,componentMetrics:n,connectionMetrics:o}=kt(),{getSystemAnalysis:i}=fo(),{getCriticalAlerts:l,getWarningAlerts:u}=Oh(),f=w.useMemo(()=>{if(!t)return{totalThroughput:0,averageLatency:0,totalErrorRate:0,activeComponents:0,activeConnections:0,bottlenecks:0,healthyComponents:0,degradedComponents:0,criticalComponents:0};let m=0,y=0,x=0,S=0,C=0,E=0,M=0,A=0,T=0;n.forEach(P=>{(P.throughput>.1||P.errorRate>.001)&&(S++,m+=P.throughput||0,y+=P.latency||0,x+=P.errorRate||0)}),o.forEach(P=>{(P.effectiveThroughput>0||P.traffic>0)&&(C++,P.bottleneck&&E++)});const N=fo.getState();r.forEach(P=>{const H=N.getComponentStatus(P.id);if(H)switch(H.health){case"healthy":M++;break;case"degraded":A++;break;case"critical":case"down":T++;break}});const D=S>0?y/S:0,q=S>0?x/S:0;return{totalThroughput:m,averageLatency:D,totalErrorRate:q,activeComponents:S,activeConnections:C,bottlenecks:E,healthyComponents:M,degradedComponents:A,criticalComponents:T}},[t,n,o,r]),p=l(),g=u();return t?h.jsxs("div",{className:"space-y-2.5",children:[h.jsxs("div",{className:"space-y-1.5",children:[h.jsx(ms,{level:5,children:"Performance"}),h.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[h.jsxs("div",{className:"p-1.5 bg-card border border-border rounded",children:[h.jsx(Ye,{size:"micro",muted:!0,className:"mb-0.5",children:"Total Throughput"}),h.jsxs(co,{status:"success",size:"base",weight:"bold",children:[f.totalThroughput.toFixed(0),h.jsx(Ye,{size:"micro",muted:!0,className:"ml-0.5",children:"ops/s"})]})]}),h.jsxs("div",{className:"p-1.5 bg-card border border-border rounded",children:[h.jsx(Ye,{size:"micro",muted:!0,className:"mb-0.5",children:"Avg Latency"}),h.jsxs(co,{status:"warning",size:"base",weight:"bold",children:[f.averageLatency.toFixed(0),h.jsx(Ye,{size:"micro",muted:!0,className:"ml-0.5",children:"ms"})]})]}),h.jsxs("div",{className:"p-1.5 bg-card border border-border rounded",children:[h.jsx(Ye,{size:"micro",muted:!0,className:"mb-0.5",children:"Error Rate"}),h.jsxs(co,{status:"error",size:"base",weight:"bold",children:[(f.totalErrorRate*100).toFixed(2),h.jsx(Ye,{size:"micro",muted:!0,className:"ml-0.5",children:"%"})]})]}),h.jsxs("div",{className:"p-1.5 bg-card border border-border rounded",children:[h.jsx(Ye,{size:"micro",muted:!0,className:"mb-0.5",children:"Bottlenecks"}),h.jsxs(co,{status:"warning",size:"base",weight:"bold",children:[f.bottlenecks,h.jsx(Ye,{size:"micro",muted:!0,className:"ml-0.5",children:"conn"})]})]})]})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx(ms,{level:5,children:"Component Health"}),h.jsxs("div",{className:"space-y-0.5",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx(qh,{className:"w-4 h-4 text-success"}),h.jsx(Ye,{size:"micro",children:"Healthy"})]}),h.jsx(Qt,{variant:"outline",className:"bg-success/20 border-success/50 text-success text-xs px-1 py-0",children:f.healthyComponents})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx(ys,{className:"w-4 h-4 text-warning"}),h.jsx(Ye,{size:"micro",children:"Degraded"})]}),h.jsx(Qt,{variant:"outline",className:"bg-warning/20 border-warning/50 text-warning text-xs px-1 py-0",children:f.degradedComponents})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx(ys,{className:"w-4 h-4 text-destructive"}),h.jsx(Ye,{size:"micro",children:"Critical/Down"})]}),h.jsx(Qt,{variant:"outline",className:"bg-destructive/20 border-destructive/50 text-destructive text-xs px-1 py-0",children:f.criticalComponents})]})]})]}),h.jsxs("div",{className:"space-y-1.5",children:[h.jsx(ms,{level:5,children:"Activity"}),h.jsxs("div",{className:"space-y-0.5",children:[h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx(r2,{className:"w-4 h-4 text-muted-foreground"}),h.jsx(Ye,{size:"micro",children:"Active Components"})]}),h.jsxs(Ye,{mono:!0,size:"micro",children:[f.activeComponents," / ",r.length]})]}),h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx(fb,{className:"w-4 h-4 text-muted-foreground"}),h.jsx(Ye,{size:"micro",children:"Active Connections"})]}),h.jsxs(Ye,{mono:!0,size:"micro",children:[f.activeConnections," / ",e.length]})]})]})]}),(p.length>0||g.length>0)&&h.jsxs("div",{className:"space-y-1.5",children:[h.jsx(ms,{level:5,children:"Alerts"}),h.jsxs("div",{className:"space-y-0.5",children:[p.length>0&&h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx(co,{status:"error",size:"micro",children:"Critical"}),h.jsx(Qt,{variant:"destructive",className:"text-xs px-1 py-0",children:p.length})]}),g.length>0&&h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsx(co,{status:"warning",size:"micro",children:"Warnings"}),h.jsx(Qt,{variant:"outline",className:"border-warning text-warning text-xs px-1 py-0",children:g.length})]})]})]})]}):h.jsxs("div",{className:"text-center text-sm text-muted-foreground py-8",children:[h.jsx(ho,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),h.jsx("p",{children:"Start emulation to see system statistics"})]})}var Su="Checkbox",[lL]=bn(Su),[uL,Np]=lL(Su);function dL(r){const{__scopeCheckbox:e,checked:t,children:n,defaultChecked:o,disabled:i,form:l,name:u,onCheckedChange:f,required:p,value:g="on",internal_do_not_use_render:m}=r,[y,x]=xs({prop:t,defaultProp:o??!1,onChange:f,caller:Su}),[S,C]=w.useState(null),[E,M]=w.useState(null),A=w.useRef(!1),T=S?!!l||!!S.closest("form"):!0,N={checked:y,disabled:i,setChecked:x,control:S,setControl:C,name:u,form:l,value:g,hasConsumerStoppedPropagationRef:A,required:p,defaultChecked:za(o)?!1:o,isFormControl:T,bubbleInput:E,setBubbleInput:M};return h.jsx(uL,{scope:e,...N,children:fL(m)?m(N):n})}var DS="CheckboxTrigger",jS=w.forwardRef(({__scopeCheckbox:r,onKeyDown:e,onClick:t,...n},o)=>{const{control:i,value:l,disabled:u,checked:f,required:p,setControl:g,setChecked:m,hasConsumerStoppedPropagationRef:y,isFormControl:x,bubbleInput:S}=Np(DS,r),C=je(o,g),E=w.useRef(f);return w.useEffect(()=>{const M=i?.form;if(M){const A=()=>m(E.current);return M.addEventListener("reset",A),()=>M.removeEventListener("reset",A)}},[i,m]),h.jsx(Ae.button,{type:"button",role:"checkbox","aria-checked":za(f)?"mixed":f,"aria-required":p,"data-state":PS(f),"data-disabled":u?"":void 0,disabled:u,value:l,...n,ref:C,onKeyDown:ge(e,M=>{M.key==="Enter"&&M.preventDefault()}),onClick:ge(t,M=>{m(A=>za(A)?!0:!A),S&&x&&(y.current=M.isPropagationStopped(),y.current||M.stopPropagation())})})});jS.displayName=DS;var kp=w.forwardRef((r,e)=>{const{__scopeCheckbox:t,name:n,checked:o,defaultChecked:i,required:l,disabled:u,value:f,onCheckedChange:p,form:g,...m}=r;return h.jsx(dL,{__scopeCheckbox:t,checked:o,defaultChecked:i,disabled:u,required:l,onCheckedChange:p,name:n,form:g,value:f,internal_do_not_use_render:({isFormControl:y})=>h.jsxs(h.Fragment,{children:[h.jsx(jS,{...m,ref:e,__scopeCheckbox:t}),y&&h.jsx(OS,{__scopeCheckbox:t})]})})});kp.displayName=Su;var _S="CheckboxIndicator",zS=w.forwardRef((r,e)=>{const{__scopeCheckbox:t,forceMount:n,...o}=r,i=Np(_S,t);return h.jsx(rn,{present:n||za(i.checked)||i.checked===!0,children:h.jsx(Ae.span,{"data-state":PS(i.checked),"data-disabled":i.disabled?"":void 0,...o,ref:e,style:{pointerEvents:"none",...r.style}})})});zS.displayName=_S;var LS="CheckboxBubbleInput",OS=w.forwardRef(({__scopeCheckbox:r,...e},t)=>{const{control:n,hasConsumerStoppedPropagationRef:o,checked:i,defaultChecked:l,required:u,disabled:f,name:p,value:g,form:m,bubbleInput:y,setBubbleInput:x}=Np(LS,r),S=je(t,x),C=gu(i),E=lu(n);w.useEffect(()=>{const A=y;if(!A)return;const T=window.HTMLInputElement.prototype,D=Object.getOwnPropertyDescriptor(T,"checked").set,q=!o.current;if(C!==i&&D){const P=new Event("click",{bubbles:q});A.indeterminate=za(i),D.call(A,za(i)?!1:i),A.dispatchEvent(P)}},[y,C,i,o]);const M=w.useRef(za(i)?!1:i);return h.jsx(Ae.input,{type:"checkbox","aria-hidden":!0,defaultChecked:l??M.current,required:u,disabled:f,name:p,value:g,form:m,...e,tabIndex:-1,ref:S,style:{...e.style,...E,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});OS.displayName=LS;function fL(r){return typeof r=="function"}function za(r){return r==="indeterminate"}function PS(r){return za(r)?"indeterminate":r?"checked":"unchecked"}const Rh=w.forwardRef(({className:r,...e},t)=>h.jsx(kp,{ref:t,className:Ee("grid place-content-center peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...e,children:h.jsx(zS,{className:Ee("grid place-content-center text-current"),children:h.jsx(Ph,{className:"h-4 w-4"})})}));Rh.displayName=kp.displayName;function IS({open:r,groupName:e,onConfirm:t,onCancel:n}){return h.jsx(wx,{open:r,onOpenChange:o=>!o&&n(),children:h.jsxs(Jh,{children:[h.jsxs(Cx,{children:[h.jsx(ep,{children:"Delete Group?"}),h.jsxs(tp,{children:['Are you sure you want to delete the group "',e,'"? This action cannot be undone.']})]}),h.jsxs(Mx,{children:[h.jsx(sp,{onClick:n,children:"Cancel"}),h.jsx(np,{onClick:t,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})}function hL({group:r}){const{nodes:e,updateGroup:t,deleteGroup:n,removeNodeFromGroup:o,addNodeToGroup:i,selectGroup:l}=Re(),[u,f]=w.useState(!1),[p,g]=w.useState(!1),[m,y]=w.useState(!1),[x,S]=w.useState(new Set),C=N=>{t(r.id,{name:N}),Ke.success("Group renamed"),g(!1)},E=()=>{f(!0)},M=()=>{n(r.id),l(null),Ke.success("Group deleted"),f(!1)},A=N=>{o(r.id,N),Ke.success("Component removed from group")},T=e.filter(N=>r.nodeIds.includes(N.id));return h.jsxs("div",{className:"space-y-2.5",children:[h.jsxs("div",{children:[h.jsx(st,{htmlFor:"group-name",className:"text-xs font-medium",children:"Group Name"}),h.jsxs("div",{className:"flex items-center gap-1.5 mt-1",children:[h.jsx(Nt,{id:"group-name",value:r.name,onChange:N=>t(r.id,{name:N.target.value}),className:"flex-1 h-8 text-xs"}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:E,children:h.jsx(Hh,{className:"h-3.5 w-3.5 text-destructive"})})]})]}),h.jsx(IS,{open:u,groupName:r.name,onConfirm:M,onCancel:()=>f(!1)}),h.jsx(op,{open:p,initialName:r.name,onConfirm:C,onCancel:()=>g(!1)}),h.jsx(vn,{}),h.jsxs("div",{className:"flex items-center space-x-2",children:[h.jsx(Rh,{id:"show-name",checked:r.showName!==!1,onCheckedChange:N=>t(r.id,{showName:N!==!1})}),h.jsx(st,{htmlFor:"show-name",className:"text-xs font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Show name on canvas"})]}),h.jsx(vn,{}),h.jsxs("div",{children:[h.jsx(st,{className:"text-xs font-medium mb-1.5 block",children:"Color"}),h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx("input",{type:"color",value:r.color||"#3b82f6",onChange:N=>t(r.id,{color:N.target.value}),className:"w-10 h-8 rounded border border-border cursor-pointer"}),h.jsx(Nt,{value:r.color||"#3b82f6",onChange:N=>t(r.id,{color:N.target.value}),className:"flex-1 font-mono text-xs h-8",placeholder:"#3b82f6"})]})]}),h.jsx(vn,{}),h.jsxs("div",{children:[h.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[h.jsxs(st,{className:"text-xs font-medium",children:["Components (",r.nodeIds.length,")"]}),h.jsxs(Ne,{variant:"outline",size:"sm",className:"h-7 text-xs",onClick:()=>{if(Re.getState().nodes.filter(q=>!r.nodeIds.includes(q.id)).length===0){Ke.info("All components are already in this group");return}S(new Set),y(!0)},children:[h.jsx(Al,{className:"h-3 w-3 mr-1"}),"Add"]})]}),h.jsxs("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:[T.map(N=>h.jsxs("div",{className:"flex items-center justify-between p-1.5 bg-secondary/50 rounded border border-border",children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-xs font-medium truncate",children:N.data?.label||N.type}),h.jsx("div",{className:"text-[10px] text-muted-foreground truncate",children:N.type})]}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-6 w-6 flex-shrink-0",onClick:()=>A(N.id),title:"Remove from group",children:h.jsx(vs,{className:"h-3 w-3"})})]},N.id)),T.length===0&&h.jsx("div",{className:"text-xs text-muted-foreground text-center py-3",children:"No components in group"})]})]}),h.jsx(vn,{}),h.jsxs("div",{className:"flex items-center justify-between text-[10px] text-muted-foreground",children:[h.jsx("span",{children:"Group ID:"}),h.jsx("code",{className:"font-mono bg-secondary/50 px-1.5 py-0.5 rounded text-[10px]",children:r.id})]}),h.jsx(ap,{open:m,onOpenChange:y,children:h.jsxs(Xl,{className:"max-w-md",children:[h.jsxs(Wl,{children:[h.jsx(Jl,{children:"Add Components to Group"}),h.jsxs(eu,{children:['Select components to add to "',r.name,'"']})]}),h.jsx(on,{className:"max-h-96",children:h.jsxs("div",{className:"space-y-2 py-2",children:[e.filter(N=>!r.nodeIds.includes(N.id)).map(N=>h.jsxs("div",{className:"flex items-center space-x-2 p-2 rounded border border-border hover:bg-secondary/50 cursor-pointer",onClick:()=>{const D=new Set(x);D.has(N.id)?D.delete(N.id):D.add(N.id),S(D)},children:[h.jsx(Rh,{checked:x.has(N.id),onCheckedChange:D=>{const q=new Set(x);D?q.add(N.id):q.delete(N.id),S(q)}}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("div",{className:"text-sm font-medium truncate",children:N.data?.label||N.type}),h.jsx("div",{className:"text-xs text-muted-foreground truncate",children:N.type})]})]},N.id)),e.filter(N=>!r.nodeIds.includes(N.id)).length===0&&h.jsx("div",{className:"text-sm text-muted-foreground text-center py-4",children:"All components are already in this group"})]})}),h.jsxs(Zl,{children:[h.jsx(Ne,{variant:"outline",onClick:()=>{y(!1),S(new Set)},children:"Cancel"}),h.jsxs(Ne,{onClick:()=>{if(x.size===0){Ke.error("Select at least one component");return}x.forEach(N=>{i(r.id,N)}),Ke.success(`${x.size} component(s) added to group`),y(!1),S(new Set)},children:["Add Selected (",x.size,")"]})]})]})})]})}function pL(){const{selectedNodeId:r,nodes:e,updateNode:t,selectNode:n,connections:o,updateConnection:i,selectedConnectionId:l,selectConnection:u,selectedGroupId:f,groups:p,selectGroup:g}=Re(),{addTab:m}=pu(),y=e.find(C=>C.id===r),x=o.find(C=>C.id===l),S=p.find(C=>C.id===f);return S?h.jsxs("div",{className:"w-60 h-full bg-card border-l border-border flex flex-col",children:[h.jsxs("div",{className:"p-1.5 border-b border-border flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(Vf,{className:"h-3 w-3 text-muted-foreground"}),h.jsx(Xs,{children:"Group Properties"})]}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>g(null),children:h.jsx(vs,{className:"h-3 w-3"})})]}),h.jsx(on,{className:"flex-1",children:h.jsx("div",{className:"p-1.5",children:h.jsx(hL,{group:S})})})]}):!y&&!x?h.jsx("div",{className:"w-60 h-full bg-card border-l border-border flex flex-col",children:h.jsxs(ip,{defaultValue:"stats",className:"h-full flex flex-col",children:[h.jsx("div",{className:"p-1 border-b border-border",children:h.jsxs(au,{className:"grid w-full grid-cols-5 h-6 gap-0.5 p-0.5",children:[h.jsx(hs,{value:"stats",className:"text-xs px-1 py-0.5",children:"Stats"}),h.jsx(hs,{value:"diagnostics",className:"text-xs px-1 py-0.5",children:"Diag"}),h.jsx(hs,{value:"alerts",className:"text-xs px-1 py-0.5",children:"Alerts"}),h.jsx(hs,{value:"filters",className:"text-xs px-1 py-0.5",children:"Filter"}),h.jsx(hs,{value:"properties",className:"text-xs px-1 py-0.5",children:"Groups"})]})}),h.jsx(_a,{value:"stats",className:"flex-1 m-0 p-0 overflow-hidden",children:h.jsx(on,{className:"h-full",children:h.jsx("div",{className:"p-1.5",children:h.jsx(cL,{})})})}),h.jsx(_a,{value:"diagnostics",className:"flex-1 m-0 p-0 overflow-hidden",children:h.jsx(rL,{})}),h.jsx(_a,{value:"alerts",className:"flex-1 m-0 p-0 overflow-hidden",children:h.jsx(iL,{})}),h.jsx(_a,{value:"filters",className:"flex-1 m-0 p-0 overflow-hidden",children:h.jsx(on,{className:"h-full",children:h.jsx("div",{className:"p-1.5",children:h.jsx(oL,{})})})}),h.jsx(_a,{value:"properties",className:"flex-1 m-0 p-0 overflow-hidden",children:h.jsx(on,{className:"h-full",children:h.jsx("div",{className:"p-1.5 space-y-1.5",children:h.jsxs("div",{children:[h.jsxs(Xs,{as:"h4",className:"mb-1",children:["Groups (",p.length,")"]}),p.length>0?h.jsx("div",{className:"space-y-1",children:p.map(C=>h.jsx("div",{className:"p-1.5 bg-secondary/50 rounded border border-border cursor-pointer hover:bg-secondary transition-colors",onClick:()=>g(C.id),children:h.jsxs("div",{className:"flex items-center justify-between",children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx(Ye,{size:"small",className:"font-medium truncate",children:C.name}),h.jsxs(Ye,{size:"micro",muted:!0,children:[C.nodeIds.length," component",C.nodeIds.length!==1?"s":""]})]}),h.jsx("div",{className:"w-2.5 h-2.5 rounded border-2 border-border flex-shrink-0 ml-1",style:{backgroundColor:C.color||"hsl(var(--primary))"}})]})},C.id))}):h.jsx(Ye,{size:"micro",muted:!0,className:"text-center py-2",children:"No groups created yet"})]})})})})]})}):x?h.jsxs("div",{className:"w-60 h-full bg-card border-l border-border flex flex-col",children:[h.jsxs("div",{className:"p-1.5 border-b border-border flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(Vf,{className:"h-3 w-3 text-muted-foreground"}),h.jsx(Xs,{children:"Connection"})]}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>u(null),children:h.jsx(vs,{className:"h-3 w-3"})})]}),h.jsx(on,{className:"flex-1",children:h.jsx("div",{className:"p-1.5",children:h.jsx(O5,{connection:x,onUpdate:(C,E)=>i(C,E)})})})]}):h.jsxs("div",{className:"w-60 h-full bg-card border-l border-border flex flex-col",children:[h.jsxs("div",{className:"p-1.5 border-b border-border flex items-center justify-between",children:[h.jsxs("div",{className:"flex items-center gap-1",children:[h.jsx(Vf,{className:"h-3 w-3 text-muted-foreground"}),h.jsx(Xs,{children:"Properties"})]}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:()=>n(null),children:h.jsx(vs,{className:"h-3 w-3"})})]}),h.jsx(on,{className:"flex-1",children:h.jsxs("div",{className:"p-1.5 space-y-1.5",children:[h.jsx(aL,{componentId:y.id,componentLabel:y.data.label}),h.jsx(vn,{}),h.jsxs("div",{children:[h.jsx(st,{htmlFor:"label",className:"text-xs font-medium",children:"Label"}),h.jsx(Nt,{id:"label",value:y.data.label,onChange:C=>t(y.id,{data:{...y.data,label:C.target.value}}),className:"mt-0.5 h-7 text-xs"})]}),h.jsx(vn,{}),h.jsxs("div",{children:[h.jsx(Xs,{as:"h4",className:"mb-1",children:"Position"}),h.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[h.jsxs("div",{children:[h.jsx(st,{htmlFor:"pos-x",className:"text-xs text-muted-foreground",children:"X"}),h.jsx(Nt,{id:"pos-x",type:"number",value:Math.round(y.position.x),onChange:C=>t(y.id,{position:{...y.position,x:parseInt(C.target.value)||0}}),className:"mt-0.5 h-7 text-xs"})]}),h.jsxs("div",{children:[h.jsx(st,{htmlFor:"pos-y",className:"text-xs text-muted-foreground",children:"Y"}),h.jsx(Nt,{id:"pos-y",type:"number",value:Math.round(y.position.y),onChange:C=>t(y.id,{position:{...y.position,y:parseInt(C.target.value)||0}}),className:"mt-0.5 h-7 text-xs"})]})]})]}),h.jsx(vn,{}),h.jsxs("div",{children:[h.jsx(Xs,{as:"h4",className:"mb-1",children:"Component Type"}),h.jsx("div",{className:"bg-secondary/50 rounded-md p-1.5 border border-border",children:h.jsx(Ye,{mono:!0,size:"small",children:y.type})})]}),h.jsx(vn,{}),h.jsxs("div",{children:[h.jsx(Xs,{as:"h4",className:"mb-1",children:"Configuration"}),h.jsx(Ne,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:()=>{m({title:`${y.data.label} Config`,type:"component",componentId:y.id,componentType:y.type})},children:"Open Configuration Panel"})]})]})})]})}function gL(){const{tabs:r,setActiveTab:e,closeTab:t,addTab:n}=pu(),o=()=>{n({title:"Untitled Diagram",type:"diagram"})};return h.jsx("div",{className:"h-10 bg-secondary/30 border-b border-border flex items-center",children:h.jsxs(on,{className:"flex-1",children:[h.jsxs("div",{className:"flex items-center",children:[r.map(i=>h.jsxs("div",{className:`
                flex items-center gap-2 px-4 h-10 border-r border-border cursor-pointer group
                transition-colors
                ${i.active?"bg-canvas-bg text-foreground":"text-muted-foreground hover:bg-secondary/50"}
              `,onClick:()=>e(i.id),children:[h.jsx("span",{className:"text-sm",children:i.title}),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-5 w-5 opacity-0 group-hover:opacity-100 hover:bg-destructive/10",onClick:l=>{l.stopPropagation(),t(i.id)},children:h.jsx(vs,{className:"h-3 w-3"})})]},i.id)),h.jsx(Ne,{variant:"ghost",size:"icon",className:"h-10 w-10 rounded-none",onClick:o,children:h.jsx(Al,{className:"h-4 w-4"})})]}),h.jsx(Gl,{orientation:"horizontal"})]})})}const Cv=r=>Symbol.iterator in r,Mv=r=>"entries"in r,Ev=(r,e)=>{const t=r instanceof Map?r:new Map(r.entries()),n=e instanceof Map?e:new Map(e.entries());if(t.size!==n.size)return!1;for(const[o,i]of t)if(!n.has(o)||!Object.is(i,n.get(o)))return!1;return!0},mL=(r,e)=>{const t=r[Symbol.iterator](),n=e[Symbol.iterator]();let o=t.next(),i=n.next();for(;!o.done&&!i.done;){if(!Object.is(o.value,i.value))return!1;o=t.next(),i=n.next()}return!!o.done&&!!i.done};function yL(r,e){return Object.is(r,e)?!0:typeof r!="object"||r===null||typeof e!="object"||e===null||Object.getPrototypeOf(r)!==Object.getPrototypeOf(e)?!1:Cv(r)&&Cv(e)?Mv(r)&&Mv(e)?Ev(r,e):mL(r,e):Ev({entries:()=>Object.entries(r)},{entries:()=>Object.entries(e)})}function qS(r){const e=Et.useRef(void 0);return t=>{const n=r(t);return yL(e.current,n)?e.current:e.current=n}}const Rv=globalThis;function pl(r){try{if(typeof Rv.structuredClone=="function")return Rv.structuredClone(r)}catch{}return JSON.parse(JSON.stringify(r))}function br(r,e,t=140,n=100,o=16){const i=[],l=t/2,u=n/2,f=r+l,p=e+u;for(let g=0;g<o;g++){const m=g/o*2*Math.PI-Math.PI/2;let y,x;const S=(m%(2*Math.PI)+2*Math.PI)%(2*Math.PI);if(S>=0&&S<Math.PI/2){const C=S/(Math.PI/2);y=f+l,x=p-u+C*n}else if(S>=Math.PI/2&&S<Math.PI){const C=(S-Math.PI/2)/(Math.PI/2);y=f+l-C*t,x=p+u}else if(S>=Math.PI&&S<3*Math.PI/2){const C=(S-Math.PI)/(Math.PI/2);y=f-l,x=p+u-C*n}else{const C=(S-3*Math.PI/2)/(Math.PI/2);y=f-l+C*t,x=p-u}i.push({x:y,y:x,index:g})}return i}function vL(r,e,t){let n=1/0,o=0;for(let i=0;i<r.length;i++){const l=r[i],u=Math.sqrt(Math.pow(e-l.x,2)+Math.pow(t-l.y,2));u<n&&(n=u,o=i)}return o}function Tv(r,e,t,n,o,i,l,u=140,f=100){const p=br(i,l,u,f),g=vL(p,t,n);if(o.filter(y=>y.source===r&&y.target===e&&y.sourcePort===g||y.target===r&&y.source===e&&y.targetPort===g).length===0)return g;for(let y=1;y<p.length;y++){const x=(g+y)%p.length,S=(g-y+p.length)%p.length;if(o.filter(M=>M.source===r&&M.target===e&&M.sourcePort===x||M.target===r&&M.source===e&&M.targetPort===x).length===0)return x;if(o.filter(M=>M.source===r&&M.target===e&&M.sourcePort===S||M.target===r&&M.source===e&&M.targetPort===S).length===0)return S}return g}const HS=w.createContext(null);function bL({children:r}){const e=w.useRef(new Map),t=w.useCallback((l,u)=>{u?e.current.set(l,u):e.current.delete(l)},[]),n=w.useCallback(l=>e.current.get(l)||null,[]),o=w.useCallback(l=>{e.current.delete(l)},[]),i={registerNodeRef:t,getNodeRef:n,unregisterNodeRef:o};return h.jsx(HS.Provider,{value:i,children:r})}function Cu(){const r=w.useContext(HS);if(!r)throw new Error("useNodeRefs must be used within NodeRefsProvider");return r}function xL({node:r,onConnectionStart:e,onConnectionEnd:t,isConnecting:n=!1,onContextMenu:o}){const{registerNodeRef:i,unregisterNodeRef:l}=Cu(),u=w.useRef(null);w.useEffect(()=>(u.current&&i(r.id,u.current),()=>{l(r.id)}),[r.id,i,l]);const f=Re(de=>de.selectNode),p=Re(de=>de.updateNode),g=Re(de=>de.updateNodes),m=Re(de=>de.deleteNode);Re(de=>de.addNode);const y=Re(de=>de.startDragOperation),x=Re(de=>de.endDragOperation);Re(de=>de.bringToFront),Re(de=>de.sendToBack),Re(de=>de.bringForward),Re(de=>de.sendBackward);const{connections:S,zoom:C,pan:E,nodes:M}=Re(qS(de=>({connections:de.connections,zoom:de.zoom,pan:de.pan,nodes:de.nodes}))),{addTab:A}=pu(),[T,N]=w.useState(!1),[D,q]=w.useState(!1),P=w.useRef({x:0,y:0}),H=w.useRef({x:0,y:0}),J=w.useRef({x:0,y:0}),se=w.useRef({x:0,y:0}),ce=w.useRef(null),Z=w.useRef(null),te=w.useRef(!1),le=w.useRef(!1),ue=w.useRef({}),z=w.useMemo(()=>Ai.find(de=>de.type===r.type),[r.type]),{isRunning:j,getComponentMetrics:O}=kt(),X=fo(de=>de.getComponentStatus(r.id)),he=kS(de=>de.getComponentState(r.id)),_=j?O(r.id):void 0,Y=Li(de=>de.highlightedNodeId)===r.id,ae=w.useMemo(()=>S.some(de=>de.source===r.id||de.target===r.id),[S,r.id]),B=_&&(_.throughput&&_.throughput>.1||_.errorRate&&_.errorRate>.001||_.utilization&&_.utilization>.01),oe=()=>{if(!j||!_||!ae||!B)return"";const de=_.utilization||0,He=_.errorRate||0,$e=Math.min(1,de*.7+He*.3);return $e>.8?"border-red-500":$e>.6?"border-orange-500":$e>.4?"border-yellow-500":$e>.2?"border-green-500":""},$=()=>{if(!j)return null;if(he)switch(he.state){case"disabled":case"failed":return h.jsx(bl,{className:"text-red-500",size:16});case"degraded":return h.jsx(ys,{className:"text-yellow-500",size:16})}if(!ae||!B||!X)return null;const de=X.health,He=16;switch(de){case"healthy":return h.jsx(qh,{className:"text-green-500",size:He});case"degraded":return h.jsx(ys,{className:"text-yellow-500",size:He});case"critical":return h.jsx(Ri,{className:"text-orange-500",size:He});case"down":return h.jsx(uo,{className:"text-red-500",size:He});default:return null}},V=()=>{if(!j)return r.selected?"border-primary":"border-border";if(he)switch(he.state){case"disabled":case"failed":return"border-red-500 border-2";case"degraded":return"border-yellow-500 border-2"}if(!X)return r.selected?"border-primary":"border-border";if(X.criticalPath)return"border-purple-500 border-2";switch(X.health){case"down":return"border-red-500 border-2";case"critical":return"border-orange-500";case"degraded":return"border-yellow-500";default:return r.selected?"border-primary":"border-border"}},pe=w.useRef(C),me=w.useRef(E);w.useEffect(()=>{pe.current=C,me.current=E},[C,E]),w.useEffect(()=>{const de=$e=>{if(!te.current)return;if(Re.getState().getIsGroupDragging()){te.current=!1,le.current=!1,N(!1);return}const pt=$e.clientX-H.current.x,qt=$e.clientY-H.current.y,Je=Math.sqrt(pt*pt+qt*qt);if(!le.current&&Je>3){le.current=!0,N(!0),y(r.id);const vt=Re.getState().nodes.filter(gt=>gt.selected);ue.current={},vt.forEach(gt=>{ue.current[gt.id]={x:gt.position.x,y:gt.position.y}})}if(le.current&&ce.current){const jt=pe.current,vt=me.current,gt=ce.current.getBoundingClientRect(),Yt=($e.clientX-gt.left-vt.x)/jt,Gt=($e.clientY-gt.top-vt.y)/jt,Rs=Yt-J.current.x,Yn=Gt-J.current.y,rs=Re.getState().nodes.filter(Ft=>Ft.selected),Xt=Object.keys(ue.current).length>0;if(rs.length>1&&Xt){const Ft=[];rs.forEach(_t=>{const Ua=ue.current[_t.id];Ua&&Ft.push({id:_t.id,updates:{position:{x:Ua.x+Rs,y:Ua.y+Yn}}})}),Ft.length>0&&g(Ft,!0)}else{const Ft=se.current.x+Rs,_t=se.current.y+Yn;p(r.id,{position:{x:Ft,y:_t}},!0)}}},He=()=>{te.current&&(te.current=!1,le.current&&(le.current=!1,N(!1),x()))};return document.addEventListener("mousemove",de),document.addEventListener("mouseup",He),()=>{document.removeEventListener("mousemove",de),document.removeEventListener("mouseup",He)}},[r.id,p,g,y,x]);const ye=de=>{if(de.button!==0)return;const $e=Re.getState().nodes.filter(kn=>kn.selected),yt=r.selected,pt=$e.some(kn=>kn.id!==r.id);if(!(yt&&pt&&!de.ctrlKey&&!de.metaKey)){const kn=de.ctrlKey||de.metaKey;f(r.id,kn)}const qt=document.querySelector(".flex-1.overflow-hidden.relative");if(!qt){P.current={x:0,y:0},J.current={x:0,y:0},se.current={x:0,y:0},ce.current=null,Z.current=null;return}ce.current=qt;const Je=pe.current,jt=me.current,vt=qt.getBoundingClientRect();Z.current=vt;const gt=(de.clientX-vt.left-jt.x)/Je,Yt=(de.clientY-vt.top-jt.y)/Je;J.current={x:gt,y:Yt};const Yn=Re.getState().nodes.find(kn=>kn.id===r.id)?.position||r.position;se.current={x:Yn.x,y:Yn.y},P.current={x:gt-Yn.x,y:Yt-Yn.y},H.current={x:de.clientX,y:de.clientY},te.current=!0,le.current=!1,de.stopPropagation()},ve=de=>{de.stopPropagation(),de.preventDefault(),T&&(N(!1),x()),A({title:`${r.data.label} Config`,type:"component",componentId:r.id,componentType:r.type})},_e=de=>{de.key==="Delete"&&r.selected&&m(r.id)},Ue=de=>{if(de.preventDefault(),de.stopPropagation(),!r.selected){const He=M.some($e=>$e.id!==r.id&&$e.selected);f(r.id,He)}o?.(de.clientX,de.clientY)},at=(de,He)=>{de.stopPropagation(),e?.(He)},Ze=w.useCallback(()=>{if(!u.current)return{width:140,height:100};const $e=(u.current.querySelector(".bg-card")||u.current).getBoundingClientRect();return{width:$e.width/C,height:$e.height/C}},[C]),Dt=de=>{if(n){de.stopPropagation();const He=Ze(),$e=br(r.position.x,r.position.y,He.width,He.height,16),yt=document.querySelector(".flex-1.overflow-hidden.relative");if(yt){const pt=yt.getBoundingClientRect(),qt=(de.clientX-pt.left-E.x)/C,Je=(de.clientY-pt.top-E.y)/C;let jt=1/0,vt=0;for(let gt=0;gt<$e.length;gt++){const Yt=$e[gt],Gt=Math.sqrt(Math.pow(qt-Yt.x,2)+Math.pow(Je-Yt.y,2));Gt<jt&&(jt=Gt,vt=gt)}t?.(vt)}else t?.()}};return h.jsx(h.Fragment,{children:h.jsx("div",{ref:u,"data-node-id":r.id,className:`
          absolute cursor-move select-none
          transition-shadow
          ${r.selected?"glow-primary":""}
          ${T?"pointer-events-none":""}
        `,style:{left:`${r.position.x}px`,top:`${r.position.y}px`},onMouseDown:ye,onMouseUp:Dt,onDoubleClick:ve,onContextMenu:Ue,onKeyDown:_e,onMouseEnter:()=>q(!0),onMouseLeave:()=>q(!1),tabIndex:0,children:h.jsxs("div",{className:Ee("bg-card border-2 rounded-lg p-4 min-w-[140px] relative",V(),oe(),"hover:border-primary/50 transition-colors",X?.criticalPath&&"shadow-lg shadow-purple-500/20",Y&&"ring-4 ring-yellow-400 ring-offset-2 animate-pulse"),children:[j&&X&&h.jsx("div",{className:"absolute -top-2 -right-2 bg-card rounded-full p-0.5 border border-border",children:$()}),j&&X?.criticalPath&&h.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 bg-purple-500 text-white text-[10px] px-1.5 py-0.5 rounded-full font-semibold",children:"CRITICAL"}),h.jsxs("div",{className:"flex flex-col items-center gap-2 select-none",children:[h.jsx("div",{className:"text-3xl select-none pointer-events-none",children:z?.icon}),h.jsx("div",{className:"text-sm font-medium text-center text-foreground select-none pointer-events-none",children:r.data.label})]}),(D||n)&&(()=>{const de=u.current?(()=>{const pt=(u.current.querySelector(".bg-card")||u.current).getBoundingClientRect();return{width:pt.width/C,height:pt.height/C}})():{width:140,height:100},He=br(r.position.x,r.position.y,de.width,de.height,16);return h.jsx(h.Fragment,{children:He.map(($e,yt)=>{const pt=$e.x-r.position.x,qt=$e.y-r.position.y;return h.jsx("div",{className:"absolute w-3 h-3 rounded-full bg-primary/80 border-2 border-card cursor-crosshair hover:scale-150 hover:bg-primary transition-all z-10",style:{left:`${pt-6}px`,top:`${qt-6}px`},onMouseDown:Je=>{Je.stopPropagation(),at(Je,yt)},onMouseUp:Je=>{Je.stopPropagation(),n&&t?.(yt)},title:"Connection point"},yt)})})})()]})})})}const wL=w.memo(xL,(r,e)=>!(r.node.id!==e.node.id||r.node.position.x!==e.node.position.x||r.node.position.y!==e.node.position.y||r.node.selected!==e.node.selected||r.node.type!==e.node.type||r.node.data.label!==e.node.data.label||r.isConnecting!==e.isConnecting||r.onConnectionStart!==e.onConnectionStart||r.onConnectionEnd!==e.onConnectionEnd||r.onContextMenu!==e.onContextMenu));function SL({selectedNodeId:r,highlightPath:e=!0}){const{nodes:t,connections:n}=Re(),{isRunning:o}=kt(),{getConnectionMessages:i}=ja(),[l,u]=w.useState(new Set),[f,p]=w.useState(new Map);return w.useEffect(()=>{if(!r||!e||!o){u(new Set),p(new Map);return}const g=new Set,m=new Map,y=[{nodeId:r,path:[r]}];for(;y.length>0;){const{nodeId:x,path:S}=y.shift();if(g.has(x))continue;g.add(x);const C=n.filter(E=>E.source===x);for(const E of C){const M=E.target,A=[...S,M];m.set(E.id,A),g.has(M)||y.push({nodeId:M,path:A})}}p(m),u(new Set(m.keys()))},[r,n,e,o]),w.useEffect(()=>{if(!r||!e||!o)return;const g=new Set,m=[{nodeId:r,path:[r]}];for(;m.length>0;){const{nodeId:y,path:x}=m.shift();if(g.has(y))continue;g.add(y);const S=n.filter(C=>C.target===y);for(const C of S){const E=C.source,M=[E,...x],A=f.get(C.id)||[];(A.length===0||M.length<A.length)&&(f.set(C.id,M),p(new Map(f))),g.has(E)||m.push({nodeId:E,path:M})}}u(new Set(f.keys()))},[r,n,e,o]),null}function CL(r){const{selectedNodeId:e}=Re(),{isRunning:t}=kt(),[n,o]=w.useState(!1);return w.useEffect(()=>{if(!e||!t){o(!1);return}const{nodes:i,connections:l}=Re.getState();if(!i.find(p=>p.id===e)){o(!1);return}const f=l.find(p=>p.id===r);f&&(f.source===e||f.target===e)?o(!0):o(!1)},[e,r,t]),n}const US=w.createContext(null);function ML({children:r}){const e=w.useRef(null),t=w.useRef(new WeakMap);w.useEffect(()=>(e.current=new ResizeObserver(i=>{i.forEach(l=>{const u=t.current.get(l.target);u&&u()})}),()=>{e.current&&(e.current.disconnect(),e.current=null)}),[]);const o={observe:w.useCallback((i,l)=>e.current?(t.current.set(i,l),e.current.observe(i),()=>{e.current&&(e.current.unobserve(i),t.current.delete(i))}):()=>{},[])};return h.jsx(US.Provider,{value:o,children:r})}function $S(){const r=w.useContext(US);if(!r)throw new Error("useResizeObserver must be used within ResizeObserverProvider");return r}function EL({connection:r,sourceNode:e,targetNode:t,zoom:n,pan:o,isSelected:i=!1,onClick:l,onContextMenu:u}){const[f,p]=w.useState(!1),{isRunning:g,connectionMetrics:m}=kt(qS(V=>({isRunning:V.isRunning,connectionMetrics:V.connectionMetrics}))),y=g?m.get(r.id):void 0,{getConnectionMessages:x}=ja(),S=Re(V=>V.selectedNodeId),C=Re(V=>V.connections),E=g?x(r.id):[],M=w.useMemo(()=>E.filter(V=>V.status==="in-transit"||V.status==="pending"),[E]),A=CL(r.id);w.useMemo(()=>C.some(V=>V.source===r.target&&V.target===r.source),[C,r.target,r.source]);const{getNodeRef:T}=Cu(),{observe:N}=$S(),[D,q]=w.useState(()=>{const V=pe=>{const me=T(pe);if(!me)return{width:140,height:100};const _e=(me.querySelector(".bg-card")||me).getBoundingClientRect();return{width:_e.width/n,height:_e.height/n}};return{source:V(e.id),target:V(t.id)}});w.useEffect(()=>{const V=()=>{const Ze=Dt=>{const de=T(Dt);if(!de)return{width:140,height:100};const yt=(de.querySelector(".bg-card")||de).getBoundingClientRect();return{width:yt.width/n,height:yt.height/n}};q({source:Ze(e.id),target:Ze(t.id)})};V();const pe=T(e.id),me=T(t.id),ye=pe?.querySelector(".bg-card"),ve=me?.querySelector(".bg-card"),_e=ye||pe,Ue=ve||me,at=[];if(_e){const Ze=N(_e,V);at.push(Ze)}if(Ue){const Ze=N(Ue,V);at.push(Ze)}return()=>{at.forEach(Ze=>Ze())}},[e.id,t.id,n,T,N]);const P=D.source.width,H=D.source.height,J=D.target.width,se=D.target.height,ce=P/2,Z=H/2,te=J/2,le=se/2;let ue,z,j,O;if(r.sourcePort!==void 0&&r.targetPort!==void 0){const V=br(e.position.x,e.position.y,P,H,16),pe=br(t.position.x,t.position.y,J,se,16),me=V[r.sourcePort],ye=pe[r.targetPort];ue=me.x,z=me.y,j=ye.x,O=ye.y}else{const V=e.position.x+ce,pe=e.position.y+Z,me=t.position.x+te,ye=t.position.y+le,ve=Math.atan2(ye-pe,me-V),_e=(Ze,Dt,de,He)=>{const $e=Math.abs(de),yt=He?ce:te,pt=He?Z:le,qt=Math.atan2(pt,yt);let Je,jt;if($e<qt||$e>Math.PI-qt){const vt=He?1:-1;Je=Ze+vt*yt*Math.sign(Math.cos(de)),jt=Dt+vt*yt*Math.tan(de)*Math.sign(Math.cos(de))}else{const vt=He?1:-1;Je=Ze+vt*pt/Math.tan(de)*Math.sign(Math.sin(de)),jt=Dt+vt*pt*Math.sign(Math.sin(de))}return{x:Je,y:jt}},Ue=_e(V,pe,ve,!0),at=_e(me,ye,ve,!1);ue=Ue.x,z=Ue.y,j=at.x,O=at.y}const X=j-ue,he=O-z,_=Math.min(Math.abs(X),Math.abs(he))*.3+30,Q=`
    M ${ue},${z}
    C ${ue+_*Math.sign(X)},${z}
      ${j-_*Math.sign(X)},${O}
      ${j},${O}
  `;let Y="hsl(var(--border))",ae=2;A&&S?(Y="hsl(280 100% 70%)",ae=3):i?(Y="hsl(var(--primary))",ae=2.5):f?(Y="hsl(var(--accent))",ae=2.5):y&&g&&(y.effectiveThroughput>0||y.traffic>0)&&(y.bottleneck?(Y="hsl(0 84% 60%)",ae=3):y.backpressure>.7?(Y="hsl(25 95% 53%)",ae=2.5):y.congestion>.6?(Y="hsl(45 93% 47%)",ae=2.5):y.throughputDependency>.5?(Y="hsl(142 76% 36%)",ae=2):y.effectiveThroughput>0&&(Y="hsl(var(--primary))",ae=2));const B=V=>{V.stopPropagation(),l?.()},oe=V=>{V.preventDefault(),V.stopPropagation(),u?.(V)},$=g&&y&&y.effectiveThroughput>0?y.effectiveThroughput%40/2:0;return h.jsxs("g",{children:[h.jsx("path",{d:Q,fill:"none",stroke:"transparent",strokeWidth:20/n,style:{cursor:"pointer"},onClick:B,onContextMenu:oe,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1)}),g&&y&&y.effectiveThroughput>0&&y.traffic>0&&h.jsx("path",{d:Q,fill:"none",stroke:Y,strokeWidth:Math.max(1,ae/n),strokeLinecap:"round",strokeDasharray:`${Math.max(4,8/n)} ${Math.max(2,4/n)}`,strokeDashoffset:-$,style:{opacity:.4,pointerEvents:"none",animation:"flow 2s linear infinite"}}),g&&M.map((V,pe)=>{const me=Date.now()-V.timestamp,ve=V.latency?Math.min(1,me/V.latency):0,_e=ue+(j-ue)*ve,Ue=z+(O-z)*ve,Ze={json:"hsl(142 76% 36%)",xml:"hsl(25 95% 53%)",binary:"hsl(221 83% 53%)",protobuf:"hsl(280 100% 70%)",text:"hsl(210 40% 50%)"}[V.format]||"hsl(var(--primary))";return h.jsxs("g",{children:[h.jsx("circle",{cx:_e,cy:Ue,r:4/n,fill:Ze,stroke:"hsl(var(--background))",strokeWidth:1/n,style:{pointerEvents:"none",filter:"drop-shadow(0 0 2px rgba(0,0,0,0.3))"},children:h.jsx("animate",{attributeName:"opacity",values:"0.5;1;0.5",dur:"1s",repeatCount:"indefinite"})}),V.size>1e3&&h.jsx("text",{x:_e,y:Ue-8/n,fill:Ze,fontSize:8/n,textAnchor:"middle",style:{pointerEvents:"none",userSelect:"none"},children:V.format})]},V.id||pe)}),h.jsx("path",{d:Q,fill:"none",stroke:Y,strokeWidth:Math.max(1,ae/n),strokeLinecap:"round",markerEnd:g&&y&&(y.effectiveThroughput>0||y.traffic>0)?`url(#arrowhead-${i?"selected":y?.bottleneck?"bottleneck":"default"})`:i?"url(#arrowhead-selected)":"url(#arrowhead-default)",style:{transition:"stroke 0.3s, stroke-width 0.3s",pointerEvents:"none"}}),g&&y&&(y.effectiveThroughput>0||y.traffic>0)?h.jsxs("g",{children:[h.jsx("text",{x:(ue+j)/2,y:(z+O)/2-10/n,fill:"hsl(var(--primary))",fontSize:Math.max(8,11/n),textAnchor:"middle",fontWeight:"500",style:{pointerEvents:"none",userSelect:"none"},children:r.label||`${y.latency.toFixed(1)}ms`}),h.jsx("text",{x:(ue+j)/2,y:(z+O)/2+8/n,fill:"hsl(var(--muted-foreground))",fontSize:Math.max(7,9/n),textAnchor:"middle",style:{pointerEvents:"none",userSelect:"none"},children:y.traffic>0?`${y.traffic.toFixed(1)} KB/s`:`${y.effectiveThroughput.toFixed(0)} msg/s`}),r.data?.bandwidthMbps&&y.traffic>0&&h.jsxs("text",{x:(ue+j)/2,y:(z+O)/2+20/n,fill:"hsl(var(--muted-foreground))",fontSize:Math.max(6,8/n),textAnchor:"middle",style:{pointerEvents:"none",userSelect:"none",opacity:.7},children:["Limit: ",r.data.bandwidthMbps,"Mbps"]})]}):r.label?h.jsx("g",{children:h.jsx("text",{x:(ue+j)/2,y:(z+O)/2-10/n,fill:"hsl(var(--primary))",fontSize:Math.max(8,11/n),textAnchor:"middle",fontWeight:"500",style:{pointerEvents:"none",userSelect:"none"},children:r.label})}):null]})}const RL=w.memo(EL,(r,e)=>!(r.connection.id!==e.connection.id||r.connection.sourcePort!==e.connection.sourcePort||r.connection.targetPort!==e.connection.targetPort||r.connection.label!==e.connection.label||r.sourceNode.id!==e.sourceNode.id||r.sourceNode.position.x!==e.sourceNode.position.x||r.sourceNode.position.y!==e.sourceNode.position.y||r.targetNode.id!==e.targetNode.id||r.targetNode.position.x!==e.targetNode.position.x||r.targetNode.position.y!==e.targetNode.position.y||r.zoom!==e.zoom||r.pan.x!==e.pan.x||r.pan.y!==e.pan.y||r.isSelected!==e.isSelected||r.onClick!==e.onClick||r.onContextMenu!==e.onContextMenu)),TL=140,AL=140,NL=16;function kL({nodeId:r,position:e}){const t=kt(g=>g.componentMetrics.get(r)),{connections:n}=Re(),{isRunning:o}=kt(),i=n.some(g=>g.source===r||g.target===r),l=t&&(t.throughput&&t.throughput>.1||t.errorRate&&t.errorRate>.001||t.utilization&&t.utilization>.01),u=w.useMemo(()=>{if(!t)return[];const g=[{label:"Throughput",value:`${Math.round(t.throughput)}`,unit:"ops/s",color:"text-blue-400"},{label:"Latency (avg)",value:`${Math.round(t.latency)}`,unit:"ms",color:"text-yellow-400"}];return t.latencyP50!==void 0&&g.push({label:"Latency (p50)",value:`${Math.round(t.latencyP50)}`,unit:"ms",color:"text-green-400"}),t.latencyP99!==void 0&&g.push({label:"Latency (p99)",value:`${Math.round(t.latencyP99)}`,unit:"ms",color:"text-red-400"}),g.push({label:"Error Rate",value:`${(t.errorRate*100).toFixed(2)}`,unit:"%",color:"text-orange-400"},{label:"Utilization",value:`${Math.round(t.utilization*100)}`,unit:"%",color:"text-purple-400"}),g},[t]);if(!o||!t||!i||!l||u.length===0)return null;const f=e.x+TL/2,p=e.y+AL+NL;return h.jsx("div",{className:"absolute pointer-events-none",style:{left:`${f}px`,top:`${p}px`,transform:"translateX(-50%)",zIndex:10},children:h.jsx("div",{className:"bg-slate-900 border border-slate-700 rounded-lg p-2 shadow-lg min-w-max",children:h.jsx("div",{className:"text-xs space-y-1",children:u.map(g=>h.jsxs("div",{className:"flex items-center justify-between gap-3",children:[h.jsxs("span",{className:"text-slate-400",children:[g.label,":"]}),h.jsxs("span",{className:`font-mono font-semibold ${g.color}`,children:[g.value," ",g.unit]})]},g.label))})})})}function DL({isVisible:r=!0}){return r?h.jsx("div",{className:"absolute bottom-4 right-4 bg-card/95 backdrop-blur-sm border border-border rounded-md p-2 z-10 pointer-events-none",children:h.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-muted-foreground",children:[h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx("div",{className:"w-3 h-3 rounded bg-green-500/20 border border-green-500/30"}),h.jsx("span",{children:"<20%"})]}),h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx("div",{className:"w-3 h-3 rounded bg-yellow-500/20 border border-yellow-500/30"}),h.jsx("span",{children:"20-40%"})]}),h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx("div",{className:"w-3 h-3 rounded bg-orange-500/20 border border-orange-500/30"}),h.jsx("span",{children:"40-60%"})]}),h.jsxs("div",{className:"flex items-center gap-1.5",children:[h.jsx("div",{className:"w-3 h-3 rounded bg-red-500/20 border border-red-500/30"}),h.jsx("span",{children:">60%"})]})]})}):null}function jL({isVisible:r=!0}){const{nodes:e,connections:t,zoom:n,pan:o}=Re(),{isRunning:i}=kt(),l=Et.useMemo(()=>{if(e.length===0)return{minX:0,minY:0,maxX:2e3,maxY:2e3};const A=e.map(H=>H.position.x),T=e.map(H=>H.position.y),N=Math.min(...A)-200,D=Math.min(...T)-200,q=Math.max(...A)+200,P=Math.max(...T)+200;return{minX:N,minY:D,maxX:q,maxY:P}},[e]),u=l.maxX-l.minX,f=l.maxY-l.minY,p=120,g=80,m=p/Math.max(u,1e3),y=g/Math.max(f,1e3),x=Math.min(m,y),S=window.innerWidth/n*x,C=window.innerHeight/n*x,E=(-o.x/n-l.minX)*x,M=(-o.y/n-l.minY)*x;return r?h.jsx("div",{className:"absolute bottom-4 left-4 bg-card/95 backdrop-blur-sm border border-border rounded-md p-2 z-10 pointer-events-none",children:h.jsxs("svg",{width:p,height:g,className:"border border-border/50 rounded",style:{background:"hsl(var(--background))"},children:[t.map(A=>{const T=e.find(J=>J.id===A.source),N=e.find(J=>J.id===A.target);if(!T||!N)return null;const D=(T.position.x-l.minX)*x,q=(T.position.y-l.minY)*x,P=(N.position.x-l.minX)*x,H=(N.position.y-l.minY)*x;return h.jsx("line",{x1:D,y1:q,x2:P,y2:H,stroke:"hsl(var(--border))",strokeWidth:.3,opacity:.2},A.id)}),e.map(A=>h.jsx("circle",{cx:(A.position.x-l.minX)*x,cy:(A.position.y-l.minY)*x,r:1.5,fill:"hsl(var(--muted-foreground))",opacity:.5},A.id)),h.jsx("rect",{x:E,y:M,width:S,height:C,fill:"hsl(var(--primary))",fillOpacity:.2,stroke:"hsl(var(--primary))",strokeWidth:1.5,strokeDasharray:"2 2"})]})}):null}function _L({x:r,y:e,onDelete:t,onRename:n,onCopyId:o,onClose:i}){const l=w.useRef(null),[u,f]=w.useState({x:r,y:e});return w.useEffect(()=>{if(l.current){const p=l.current.getBoundingClientRect(),g=window.innerWidth,m=window.innerHeight;let y=r,x=e;r+p.width>g&&(y=g-p.width-10),e+p.height>m&&(x=m-p.height-10),y=Math.max(10,y),x=Math.max(10,x),f({x:y,y:x})}},[r,e]),w.useEffect(()=>{const p=m=>{l.current&&!l.current.contains(m.target)&&i()},g=m=>{m.key==="Escape"&&i()};return document.addEventListener("mousedown",p),document.addEventListener("keydown",g),()=>{document.removeEventListener("mousedown",p),document.removeEventListener("keydown",g)}},[i]),h.jsxs("div",{ref:l,className:"fixed bg-popover border border-border rounded-md shadow-lg z-50 py-0.5 min-w-[120px]",style:{left:`${u.x}px`,top:`${u.y}px`},children:[h.jsxs("button",{onClick:()=>{n(),i()},className:"w-full px-2 py-1 text-xs text-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(k2,{className:"w-3.5 h-3.5"}),"Rename"]}),h.jsxs("button",{onClick:()=>{o(),i()},className:"w-full px-2 py-1 text-xs text-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(cb,{className:"w-3.5 h-3.5"}),"Copy ID"]}),h.jsx("div",{className:"border-t border-border my-0.5"}),h.jsxs("button",{onClick:()=>{t(),i()},className:"w-full px-2.5 py-1.5 text-xs text-destructive hover:bg-destructive hover:text-destructive-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(Hh,{className:"w-3.5 h-3.5"}),"Delete"]})]})}const zL=140,LL=100;function OL(r,e,t){const n=t(r);if(!n)return{width:zL,height:LL};const l=(n.querySelector(".bg-card")||n).getBoundingClientRect();return{width:l.width/e,height:l.height/e}}function PL(r,e){const{getNodeRef:t}=Cu(),{observe:n}=$S(),[o,i]=w.useState({}),l=w.useCallback(()=>{const u={};r.forEach(f=>{const p=OL(f,e,t);p&&(u[f]=p)}),i(f=>({...f,...u}))},[r,e,t]);return w.useEffect(()=>{if(r.length===0)return;l();const u=[];return r.forEach(f=>{const p=t(f);if(p){const m=p.querySelector(".bg-card")||p;if(m){const y=n(m,l);u.push(y)}}}),()=>{u.forEach(f=>f())}},[r,e,l,t,n]),o}const ah=20,IL=140,qL=100,HL=18,UL=6,$L=HL+UL*2;function BL(r,e,t,n){return w.useMemo(()=>{const o=e.filter(y=>r.nodeIds.includes(y.id));if(o.length===0)return null;const i=ah,l=ah,u=r.showName!==!1?$L:ah;let f=1/0,p=1/0,g=-1/0,m=-1/0;return o.forEach(y=>{const x=t[y.id]||{width:IL,height:qL},S=y.position.x,C=y.position.y,E=S+x.width,M=C+x.height;f=Math.min(f,S),p=Math.min(p,C),g=Math.max(g,E),m=Math.max(m,M)}),{x:f-i,y:p-u,width:g-f+i*2,height:m-p+u+l}},[e,r.nodeIds,t,n,r.showName])}function QL(r,e){const{nodes:t,updateNodes:n}=Re(),[o,i]=w.useState(!1),l=w.useRef({x:0,y:0}),u=w.useRef({}),f=w.useCallback(p=>{if(p.button!==0||p.target.closest("[data-node-id]"))return;p.stopPropagation();const y=Re.getState();y.selectGroup(r.id),i(!0),l.current.x=p.clientX,l.current.y=p.clientY,y.setGroupDragging(!0);const x=t.filter(S=>r.nodeIds.includes(S.id));u.current={},x.forEach(S=>{u.current[S.id]={...S.position}})},[r.id,r.nodeIds,t]);return w.useEffect(()=>{if(!o)return;let p=null,g=null,m=!0;const y=S=>{if(!m)return;const C=(S.clientX-l.current.x)/e,E=(S.clientY-l.current.y)/e;g={dx:C,dy:E},p===null&&(p=requestAnimationFrame(()=>{if(!m||!g){p=null,g=null;return}const{dx:M,dy:A}=g,T=Re.getState(),N=r.nodeIds.map(D=>{const q=u.current[D];return q?{id:D,updates:{position:{x:q.x+M,y:q.y+A}}}:null}).filter(D=>D!==null);N.length>0&&T.updateNodes(N,!0),p=null,g=null}))},x=S=>{if(S&&S.button!==0)return;m=!1,p!==null&&(cancelAnimationFrame(p),p=null);const C=Re.getState();if(g){const{dx:E,dy:M}=g,A=r.nodeIds.map(T=>{const N=u.current[T];return N?{id:T,updates:{position:{x:N.x+E,y:N.y+M}}}:null}).filter(T=>T!==null);if(C.setGroupDragging(!1),A.length>0){C.updateNodes(A,!0);const T=Re.getState();ht(T,T.diagramName)}}else C.setGroupDragging(!1);g=null,i(!1)};return document.addEventListener("mousemove",y,{passive:!0}),document.addEventListener("mouseup",x,{capture:!0}),()=>{m=!1,p!==null&&cancelAnimationFrame(p),document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",x,{capture:!0}),Re.getState().setGroupDragging(!1)}},[o,r.nodeIds,e]),{isDragging:o,handleMouseDown:f}}const Av=18,gl=6;function GL({group:r,zoom:e}){const{nodes:t,selectedGroupId:n,selectGroup:o,deleteGroup:i,updateGroup:l}=Re(),[u,f]=w.useState(null),[p,g]=w.useState(!1),[m,y]=w.useState(!1),x=PL(r.nodeIds,e),S=BL(r,t,x,e),{handleMouseDown:C}=QL(r,e);if(!S)return null;const E=n===r.id,M=r.color||"hsl(var(--primary))",A=H=>{H.preventDefault(),H.stopPropagation(),o(r.id),f({x:H.clientX,y:H.clientY})},T=()=>{g(!0)},N=()=>{i(r.id),Ke.success("Group deleted"),g(!1)},D=()=>{y(!0)},q=H=>{l(r.id,{name:H}),Ke.success("Group renamed"),y(!1)},P=()=>{navigator.clipboard.writeText(r.id),Ke.success("Group ID copied to clipboard")};return h.jsxs(h.Fragment,{children:[h.jsxs("g",{children:[h.jsx("rect",{x:S.x,y:S.y,width:S.width,height:S.height,fill:M,fillOpacity:E?.1:.05,stroke:M,strokeWidth:E?3/e:2/e,strokeDasharray:E?"0":"5,5",rx:8/e,ry:8/e,style:{cursor:"pointer",transition:"all 0.2s"},onMouseDown:C,onContextMenu:A}),r.showName!==!1&&h.jsxs("g",{onClick:H=>{H.stopPropagation(),o(r.id)},onContextMenu:A,style:{cursor:"pointer"},children:[h.jsx("rect",{x:S.x+gl,y:S.y+gl,width:Math.max(80,r.name.length*6.5+16),height:Av,fill:M,fillOpacity:.85,rx:3,ry:3,stroke:M,strokeWidth:.5}),h.jsx("text",{x:S.x+gl+8,y:S.y+gl+Av/2,fill:"white",fontSize:11,fontWeight:"600",dominantBaseline:"middle",style:{pointerEvents:"none",userSelect:"none"},children:r.name})]})]}),u&&h.jsx(_L,{x:u.x,y:u.y,onDelete:T,onRename:D,onCopyId:P,onClose:()=>f(null)}),h.jsx(IS,{open:p,groupName:r.name,onConfirm:N,onCancel:()=>g(!1)}),h.jsx(op,{open:m,initialName:r.name,onConfirm:q,onCancel:()=>y(!1)})]})}const FL=w.memo(GL,(r,e)=>!(r.group.id!==e.group.id||r.group.name!==e.group.name||r.group.color!==e.group.color||r.group.nodeIds.length!==e.group.nodeIds.length||r.group.nodeIds.some((t,n)=>t!==e.group.nodeIds[n])||r.zoom!==e.zoom));function VL({isVisible:r,canvasRef:e}){const{zoom:t,pan:n}=Re(),[o,i]=w.useState(null),l=w.useRef(null);if(w.useEffect(()=>{if(!r){i(null);return}const D=()=>{if(e?.current)i(e.current.getBoundingClientRect());else if(l.current?.parentElement){const se=l.current.parentElement.getBoundingClientRect(),ce=24;i({...se,width:se.width-ce,height:se.height-ce,left:se.left+ce,top:se.top+ce})}},q=setTimeout(D,10),P=requestAnimationFrame(D),H=requestAnimationFrame(()=>{requestAnimationFrame(D)});return window.addEventListener("resize",D),()=>{clearTimeout(q),cancelAnimationFrame(P),cancelAnimationFrame(H),window.removeEventListener("resize",D)}},[r,e]),w.useEffect(()=>{if(!r)return;const q=requestAnimationFrame(()=>{e?.current&&i(e.current.getBoundingClientRect())});return()=>cancelAnimationFrame(q)},[t,n,r,e]),!r)return null;if(!o)return h.jsx("div",{ref:l,className:"absolute inset-0 pointer-events-none z-20"});const u=20,f=u*t;let p=1;f<10?p=10:f<20?p=5:f<40&&(p=2);const g=u*p,m=24,y=24,x=o.width,S=o.height,C=Math.floor(-n.x/t/g)*g,E=Math.floor(-n.y/t/g)*g,M=C+x/t+g*2,A=E+S/t+g*2,T=[];for(let D=C;D<=M;D+=g)T.push(D);const N=[];for(let D=E;D<=A;D+=g)N.push(D);return h.jsxs("div",{ref:l,className:"absolute inset-0 pointer-events-none z-20",children:[h.jsx("div",{className:"absolute bg-card/90 backdrop-blur-sm border-b border-border pointer-events-none",style:{top:0,left:`${m}px`,right:0,height:`${y}px`,transform:`translate(${n.x}px, 0) scale(${t})`,transformOrigin:"0 0"},children:T.map(D=>h.jsx("div",{className:"absolute top-0 bottom-0 border-l border-border/60",style:{left:`${D}px`,width:"1px"},children:h.jsx("span",{className:"absolute top-0.5 left-1 text-[10px] text-muted-foreground font-mono whitespace-nowrap",style:{transform:`scale(${1/t})`,transformOrigin:"0 0"},children:D})},`h-${D}`))}),h.jsx("div",{className:"absolute bg-card/90 backdrop-blur-sm border-r border-border pointer-events-none",style:{top:`${y}px`,left:0,bottom:0,width:`${m}px`,transform:`translate(0, ${n.y}px) scale(${t})`,transformOrigin:"0 0"},children:N.map(D=>h.jsx("div",{className:"absolute left-0 right-0 border-t border-border/60",style:{top:`${D}px`,height:"1px"},children:h.jsx("span",{className:"absolute left-0.5 top-1 text-[10px] text-muted-foreground font-mono whitespace-nowrap",style:{transform:`scale(${1/t})`,transformOrigin:"0 0"},children:D})},`v-${D}`))}),h.jsx("div",{className:"absolute bg-card/90 backdrop-blur-sm border-b border-r border-border pointer-events-none",style:{top:0,left:0,width:`${m}px`,height:`${y}px`}})]})}function KL({x:r,y:e,onDelete:t,onDuplicate:n,onCopyId:o,onBringToFront:i,onSendToBack:l,onBringForward:u,onSendBackward:f,onAddToGroup:p,onRemoveFromGroup:g,onClose:m}){const y=w.useRef(null);w.useEffect(()=>{const q=H=>{y.current&&!y.current.contains(H.target)&&m()},P=H=>{H.key==="Escape"&&m()};return document.addEventListener("mousedown",q),document.addEventListener("keydown",P),()=>{document.removeEventListener("mousedown",q),document.removeEventListener("keydown",P)}},[m]);const x=()=>{t(),m()},S=()=>{n(),m()},C=()=>{o(),m()},E=()=>{i?.(),m()},M=()=>{l?.(),m()},A=()=>{u?.(),m()},T=()=>{f?.(),m()},N=()=>{p?.(),m()},D=()=>{g?.(),m()};return h.jsxs("div",{ref:y,className:"fixed bg-popover border border-border rounded-md shadow-lg z-50 py-0.5 min-w-[140px]",style:{left:`${r}px`,top:`${e}px`},children:[h.jsxs("button",{onClick:S,className:"w-full px-2 py-1.5 text-xs text-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(lb,{className:"w-3.5 h-3.5"}),"Duplicate"]}),h.jsxs("button",{onClick:C,className:"w-full px-2 py-1.5 text-xs text-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(cb,{className:"w-3.5 h-3.5"}),"Copy ID"]}),(p||g)&&h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"border-t border-border my-0.5"}),g&&h.jsxs("button",{onClick:D,className:"w-full px-2 py-1.5 text-xs text-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(FA,{className:"w-3.5 h-3.5"}),"Remove from Group"]}),p&&h.jsxs("button",{onClick:N,className:"w-full px-2 py-1.5 text-xs text-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(ch,{className:"w-3.5 h-3.5"}),"Add to Group"]})]}),h.jsx("div",{className:"border-t border-border my-0.5"}),(i||l||u||f)&&h.jsxs(h.Fragment,{children:[h.jsxs("button",{onClick:E,className:"w-full px-2 py-1.5 text-xs text-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(TA,{className:"w-3.5 h-3.5"}),"Bring to Front"]}),h.jsxs("button",{onClick:M,className:"w-full px-2 py-1.5 text-xs text-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(CA,{className:"w-3.5 h-3.5"}),"Send to Back"]}),h.jsxs("button",{onClick:A,className:"w-full px-2 py-1.5 text-xs text-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(ib,{className:"w-3.5 h-3.5"}),"Bring Forward"]}),h.jsxs("button",{onClick:T,className:"w-full px-2 py-1.5 text-xs text-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(Ul,{className:"w-3.5 h-3.5"}),"Send Backward"]}),h.jsx("div",{className:"border-t border-border my-0.5"})]}),h.jsxs("button",{onClick:x,className:"w-full px-2.5 py-1.5 text-xs text-destructive hover:bg-destructive hover:text-destructive-foreground flex items-center gap-1.5 transition-colors",children:[h.jsx(Hh,{className:"w-3.5 h-3.5"}),"Delete"]})]})}function YL({nodeId:r,x:e,y:t,onClose:n}){const o=w.useRef(null),{groups:i,addNodeToGroup:l}=Re();return w.useEffect(()=>{const u=p=>{o.current&&!o.current.contains(p.target)&&n()},f=p=>{p.key==="Escape"&&n()};return document.addEventListener("mousedown",u),document.addEventListener("keydown",f),()=>{document.removeEventListener("mousedown",u),document.removeEventListener("keydown",f)}},[n]),h.jsxs("div",{ref:o,className:"fixed bg-popover border border-border rounded-md shadow-lg z-50 py-1 min-w-[180px]",style:{left:`${e}px`,top:`${t}px`},children:[h.jsx("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground border-b border-border",children:"Add to Group"}),h.jsx("div",{className:"max-h-60 overflow-y-auto",children:(()=>{const u=i.filter(f=>!f.nodeIds.includes(r));return u.length>0?u.map(f=>h.jsxs("button",{onClick:()=>{l(f.id,r),Ke.success(`Added to "${f.name}"`),n()},className:"w-full px-2 py-1.5 text-xs text-left text-foreground hover:bg-accent hover:text-accent-foreground flex items-center gap-2 transition-colors",children:[h.jsx("div",{className:"w-3 h-3 rounded border border-border flex-shrink-0",style:{backgroundColor:f.color||"hsl(var(--primary))"}}),h.jsx("span",{className:"truncate flex-1",children:f.name})]},f.id)):h.jsx("div",{className:"px-2 py-4 text-xs text-muted-foreground text-center",children:i.length===0?"No groups available":"Already in all groups"})})()}),h.jsx("div",{className:"border-t border-border mt-1",children:h.jsx("button",{onClick:n,className:"w-full px-2 py-1.5 text-xs text-muted-foreground hover:bg-accent hover:text-accent-foreground transition-colors",children:"Cancel"})})]})}function XL({nodeId:r,x:e,y:t,onClose:n}){const o=w.useRef(null),{groups:i,removeNodeFromGroup:l}=Re(),u=i.filter(f=>f.nodeIds.includes(r));return w.useEffect(()=>{const f=g=>{o.current&&!o.current.contains(g.target)&&n()},p=g=>{g.key==="Escape"&&n()};return document.addEventListener("mousedown",f),document.addEventListener("keydown",p),()=>{document.removeEventListener("mousedown",f),document.removeEventListener("keydown",p)}},[n]),h.jsxs("div",{ref:o,className:"fixed bg-popover border border-border rounded-md shadow-lg z-50 py-1 min-w-[180px]",style:{left:`${e}px`,top:`${t}px`},children:[h.jsx("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground border-b border-border",children:"Remove from Group"}),h.jsx("div",{className:"max-h-60 overflow-y-auto",children:u.length>0?u.map(f=>h.jsxs("button",{onClick:()=>{l(f.id,r),Ke.success(`Removed from "${f.name}"`),n()},className:"w-full px-2 py-1.5 text-xs text-left text-destructive hover:bg-destructive/10 hover:text-destructive flex items-center gap-2 transition-colors",children:[h.jsx("div",{className:"w-3 h-3 rounded border border-border flex-shrink-0",style:{backgroundColor:f.color||"hsl(var(--primary))"}}),h.jsx("span",{className:"truncate flex-1",children:f.name})]},f.id)):h.jsx("div",{className:"px-2 py-4 text-xs text-muted-foreground text-center",children:"Not in any groups"})}),h.jsx("div",{className:"border-t border-border mt-1",children:h.jsx("button",{onClick:n,className:"w-full px-2 py-1.5 text-xs text-muted-foreground hover:bg-accent hover:text-accent-foreground transition-colors",children:"Cancel"})})]})}function WL({x:r,y:e,onDelete:t,onClose:n}){const o=w.useRef(null),[i,l]=w.useState({x:r,y:e});return w.useEffect(()=>{if(o.current){const u=o.current.getBoundingClientRect(),f=window.innerWidth,p=window.innerHeight;let g=r,m=e;r+u.width>f&&(g=f-u.width-8),e+u.height>p&&(m=p-u.height-8),g=Math.max(8,g),m=Math.max(8,m),l({x:g,y:m})}},[r,e]),w.useEffect(()=>{const u=p=>{o.current&&!o.current.contains(p.target)&&n()},f=p=>{p.key==="Escape"&&n()};return document.addEventListener("mousedown",u),document.addEventListener("keydown",f),()=>{document.removeEventListener("mousedown",u),document.removeEventListener("keydown",f)}},[n]),h.jsx("div",{ref:o,className:"fixed bg-card border border-border rounded-md shadow-lg z-50",style:{left:`${i.x}px`,top:`${i.y}px`},children:h.jsx("button",{className:"w-full px-3 py-2 text-sm text-left hover:bg-accent transition-colors first:rounded-t-md last:rounded-b-md",onClick:t,children:"Delete"})})}function Nv(){const r=w.useRef(null),{nodes:e,connections:t,groups:n=[],addNode:o,addConnection:i,deleteConnection:l,zoom:u,pan:f,setPan:p,setZoom:g,selectNode:m,selectConnection:y,selectGroup:x,selectNodesByIds:S,selectedConnectionId:C,selectedNodeId:E,setViewportSize:M,deleteNode:A,updateNode:T,bringToFront:N,sendToBack:D,bringForward:q,sendBackward:P,canvasBounds:H,canvasChunks:J,addNodeToGroup:se,removeNodeFromGroup:ce}=Re(),{isRunning:Z}=kt(),{showMinimap:te,showHeatMapLegend:le,showRuler:ue}=Li(),{getNodeRef:z}=Cu(),[j,O]=w.useState(!1),[X,he]=w.useState({x:0,y:0}),[_,Q]=w.useState(!1),[Y,ae]=w.useState(null),[B,oe]=w.useState(void 0),[$,V]=w.useState(null),[pe,me]=w.useState(null),[ye,ve]=w.useState(null),[_e,Ue]=w.useState(null),[at,Ze]=w.useState(null),[Dt,de]=w.useState(null),[He,$e]=w.useState(null);w.useEffect(()=>{if(!r.current)return;const ee=()=>{if(!r.current)return;const be=r.current.getBoundingClientRect();M({width:be.width,height:be.height})};ee();const fe=new ResizeObserver(()=>{ee()});return fe.observe(r.current),window.addEventListener("resize",ee),()=>{fe.disconnect(),window.removeEventListener("resize",ee)}},[M]),w.useEffect(()=>{const ee=fe=>{if((fe.ctrlKey||fe.metaKey)&&r.current){const be=r.current.getBoundingClientRect();fe.clientX>=be.left&&fe.clientX<=be.right&&fe.clientY>=be.top&&fe.clientY<=be.bottom&&fe.preventDefault()}};return document.addEventListener("wheel",ee,{passive:!1,capture:!0}),()=>{document.removeEventListener("wheel",ee,{capture:!0})}},[]);const yt=ee=>{if(ee.preventDefault(),!r.current)return;const fe=ee.dataTransfer.getData("application/json");if(!fe)return;const be=JSON.parse(fe),ze=r.current.getBoundingClientRect(),Oe=(ee.clientX-ze.left-f.x)/u,ct=(ee.clientY-ze.top-f.y)/u,zt={id:`node-${Date.now()}`,type:be.type,position:{x:Oe,y:ct},data:{label:be.label}};o(zt)},pt=ee=>{ee.preventDefault(),ee.dataTransfer.dropEffect="copy"},qt=ee=>{const fe=ee.button===0;if(ee.button===1||fe&&ee.ctrlKey){O(!0),he({x:ee.clientX-f.x,y:ee.clientY-f.y}),ee.preventDefault();return}if(fe&&!_&&!ee.ctrlKey&&!ee.metaKey){if(r.current){const ze=r.current.getBoundingClientRect(),Oe=(ee.clientX-ze.left-f.x)/u,ct=(ee.clientY-ze.top-f.y)/u;Ue({x:Oe,y:ct}),Ze({x:Oe,y:ct,width:0,height:0})}m(null),y(null),x(null)}},Je=ee=>{if(j)p({x:ee.clientX-X.x,y:ee.clientY-X.y});else if(_&&r.current){const fe=r.current.getBoundingClientRect();V({x:(ee.clientX-fe.left-f.x)/u,y:(ee.clientY-fe.top-f.y)/u})}else if(_e&&r.current){const fe=r.current.getBoundingClientRect(),be=(ee.clientX-fe.left-f.x)/u,ze=(ee.clientY-fe.top-f.y)/u,Oe=Math.min(_e.x,be),ct=Math.min(_e.y,ze),zt=Math.abs(be-_e.x),Wt=Math.abs(ze-_e.y),Rt={x:Oe,y:ct,width:zt,height:Wt};Ze(Rt);const cn=e.filter(wt=>{const ot=wt.position.x,mt=wt.position.y,Ht=wt.position.x+140,is=wt.position.y+140;return Ht>=Rt.x&&ot<=Rt.x+Rt.width&&is>=Rt.y&&mt<=Rt.y+Rt.height}).map(wt=>wt.id);S(cn)}},jt=()=>{O(!1),_&&(Q(!1),ae(null),V(null)),_e&&(Ue(null),Ze(null))},vt=w.useCallback((ee,fe)=>{Q(!0),ae(ee),oe(fe)},[]),gt=w.useCallback(ee=>{const fe=z(ee);if(!fe)return{width:140,height:100};const Oe=(fe.querySelector(".bg-card")||fe).getBoundingClientRect();return{width:Oe.width/u,height:Oe.height/u}},[z,u]),Yt=w.useCallback((ee,fe)=>{if(_&&Y&&Y!==ee){const be=e.find(Oe=>Oe.id===Y),ze=e.find(Oe=>Oe.id===ee);if(be&&ze){const Oe=gt(Y),ct=gt(ee),zt=$?.x??ze.position.x+ct.width/2,Wt=$?.y??ze.position.y+ct.height/2,Rt=be.position.x+Oe.width/2,cn=be.position.y+Oe.height/2,wt=B!==void 0?B:Tv(Y,ee,zt,Wt,t,be.position.x,be.position.y,Oe.width,Oe.height),ot=fe!==void 0?fe:Tv(ee,Y,Rt,cn,t,ze.position.x,ze.position.y,ct.width,ct.height),mt={id:`conn-${Date.now()}`,source:Y,target:ee,type:"async",sourcePort:wt,targetPort:ot};i(mt)}}Q(!1),ae(null),oe(void 0),V(null)},[_,Y,B,e,t,i,$,gt]),Gt=w.useCallback(ee=>{y(ee)},[y]),Rs=w.useCallback((ee,fe,be)=>{me({connectionId:ee,x:fe,y:be})},[]),Yn=w.useCallback(ee=>{const fe=ee.target,be=fe.closest?.("[data-node-id]"),ze=fe.closest?.("[data-connection-id]"),Oe=fe instanceof SVGElement,ct=fe.closest?.("svg")!==null;if(be||ze||Oe||ct)return;const zt=e.filter(Wt=>Wt.selected);zt.length>0&&(ee.preventDefault(),ee.stopPropagation(),ve({nodeId:zt[0].id,x:ee.clientX,y:ee.clientY}))},[e]),kn=w.useCallback(()=>{pe&&(l(pe.connectionId),me(null))},[pe,l]),rs=w.useMemo(()=>e.map(ee=>ee.id).join(","),[e]),Xt=w.useMemo(()=>{const ee=new Map;return e.forEach(fe=>{const be=fe.id;ee.set(be,{onConnectionStart:ze=>vt(be,ze),onConnectionEnd:ze=>Yt(be,ze),onContextMenu:(ze,Oe)=>ve({nodeId:be,x:ze,y:Oe})})}),ee},[rs,vt,Yt,e]),Ft=w.useMemo(()=>t.map(ee=>ee.id).join(","),[t]),_t=w.useMemo(()=>{const ee=new Map;return t.forEach(fe=>{const be=fe.id;ee.set(be,{onClick:()=>Gt(be),onContextMenu:ze=>Rs(be,ze.clientX,ze.clientY)})}),ee},[Ft,Gt,Rs,t]),Ua=ee=>{if(ee.ctrlKey&&r.current){ee.preventDefault();const{left:fe,top:be,width:ze,height:Oe}=r.current.getBoundingClientRect(),ct=ee.clientX-fe,zt=ee.clientY-be,Wt=(ct-f.x)/u,Rt=(zt-f.y)/u,cn=1+Math.min(Math.max(-ee.deltaY/500,-.5),.5);let wt=u*cn;wt=Math.min(Math.max(wt,.3),2.5);const ot=ct-Wt*wt,mt=zt-Rt*wt;g(wt),p({x:ot,y:mt})}},Dn=20,Gi=ue?24:0,Ts=2e3,$a=u<.5,oa=Re(ee=>ee.viewportWidth),Xn=Re(ee=>ee.viewportHeight),As=w.useMemo(()=>{if(oa===0||Xn===0)return e;const ee=-f.x/u,fe=-f.y/u,be=(oa-f.x)/u,ze=(Xn-f.y)/u,Oe=200,ct=ee-Oe,zt=fe-Oe,Wt=be+Oe,Rt=ze+Oe;return e.filter(cn=>{const wt=cn.position.x,ot=cn.position.y;return wt+140>=ct&&wt<=Wt&&ot+100>=zt&&ot<=Rt})},[e,u,f,oa,Xn]),Ns=w.useMemo(()=>new Set(As.map(ee=>ee.id)),[As]),Mu=w.useMemo(()=>t.filter(ee=>Ns.has(ee.source)&&Ns.has(ee.target)),[t,Ns]);return h.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[h.jsx(VL,{isVisible:ue,canvasRef:r}),h.jsx("div",{ref:r,className:"absolute overflow-hidden",style:{top:`${Gi}px`,left:`${Gi}px`,right:0,bottom:0,cursor:j?"grabbing":_?"crosshair":"default",backgroundColor:"hsl(var(--muted) / 0.1)"},onDrop:yt,onDragOver:pt,onMouseDown:qt,onMouseMove:Je,onMouseUp:jt,onMouseLeave:jt,onWheel:Ua,onContextMenu:Yn,children:h.jsxs("div",{style:{transform:`translate(${f.x}px, ${f.y}px) scale(${u})`,transformOrigin:"0 0",width:"100%",height:"100%",position:"relative"},children:[J.map(ee=>{const fe=ee.x*Ts,be=ee.y*Ts,ze=J.some(ot=>ot.x===ee.x+1&&ot.y===ee.y),Oe=J.some(ot=>ot.x===ee.x&&ot.y===ee.y+1),ct=f.x/u,zt=f.y/u,Wt=(-ct%Dn+Dn)%Dn,Rt=(-zt%Dn+Dn)%Dn,cn=fe%Dn,wt=be%Dn;return h.jsxs("div",{className:"absolute pointer-events-none",style:{left:`${fe}px`,top:`${be}px`,width:`${Ts}px`,height:`${Ts}px`,backgroundColor:"hsl(var(--canvas-bg))",backgroundImage:`
                  linear-gradient(hsl(var(--canvas-grid)) 1px, transparent 1px),
                  linear-gradient(90deg, hsl(var(--canvas-grid)) 1px, transparent 1px)
                `,backgroundSize:`${Dn}px ${Dn}px`,backgroundPosition:`${Wt+cn}px ${Rt+wt}px`,border:$a?"2px dashed hsl(var(--border) / 0.6)":"none",boxShadow:$a?"inset 0 0 0 1px hsl(var(--border) / 0.3)":"none"},children:[ze&&h.jsx("div",{className:"absolute top-0 bottom-0 pointer-events-none z-10",style:{right:0,width:"1px",backgroundColor:"hsl(var(--border) / 0.5)"}}),Oe&&h.jsx("div",{className:"absolute left-0 right-0 pointer-events-none z-10",style:{bottom:0,height:"1px",backgroundColor:"hsl(var(--border) / 0.5)"}})]},`chunk-${ee.x}-${ee.y}`)}),at&&h.jsx("div",{className:"absolute border-2 border-primary/60 bg-primary/10 pointer-events-none",style:{left:at.x,top:at.y,width:at.width,height:at.height}}),h.jsxs("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",overflow:"visible"},children:[h.jsxs("defs",{children:[h.jsx("marker",{id:"arrowhead-default",markerWidth:"8",markerHeight:"8",refX:"7",refY:"4",orient:"auto",markerUnits:"userSpaceOnUse",children:h.jsx("path",{d:"M0,0 L0,8 L8,4 z",fill:"hsl(var(--border))",stroke:"none"})}),h.jsx("marker",{id:"arrowhead-selected",markerWidth:"10",markerHeight:"10",refX:"8",refY:"5",orient:"auto",markerUnits:"userSpaceOnUse",children:h.jsx("path",{d:"M0,0 L0,10 L10,5 z",fill:"hsl(var(--primary))",stroke:"none"})}),h.jsx("marker",{id:"arrowhead-bottleneck",markerWidth:"12",markerHeight:"12",refX:"10",refY:"6",orient:"auto",markerUnits:"userSpaceOnUse",children:h.jsx("path",{d:"M0,0 L0,12 L12,6 z",fill:"hsl(0 84% 60%)",stroke:"none"})})]}),n&&n.length>0&&h.jsx("g",{style:{pointerEvents:"auto"},children:n.map(ee=>h.jsx(FL,{group:ee,zoom:u},ee.id))}),h.jsxs("g",{style:{pointerEvents:"auto"},children:[Mu.map(ee=>{const fe=e.find(Oe=>Oe.id===ee.source),be=e.find(Oe=>Oe.id===ee.target);if(!fe||!be)return null;const ze=_t.get(ee.id);return ze?h.jsx(RL,{connection:ee,sourceNode:fe,targetNode:be,zoom:u,pan:f,isSelected:C===ee.id,onClick:ze.onClick,onContextMenu:ze.onContextMenu},ee.id):null}),_&&Y&&$&&(()=>{const ee=e.find(Oe=>Oe.id===Y);if(!ee)return null;const fe=gt(Y);let be,ze;if(B!==void 0){const ct=br(ee.position.x,ee.position.y,fe.width,fe.height,16)[B];be=ct.x,ze=ct.y}else be=ee.position.x+fe.width/2,ze=ee.position.y+fe.height/2;return h.jsx("line",{x1:be,y1:ze,x2:$.x,y2:$.y,stroke:"hsl(var(--primary))",strokeWidth:2/u,strokeDasharray:"5,5",style:{pointerEvents:"none"}})})()]})]}),As.map(ee=>{const fe=Xt.get(ee.id);return fe?h.jsx(wL,{node:ee,onConnectionStart:fe.onConnectionStart,onConnectionEnd:fe.onConnectionEnd,isConnecting:_,onContextMenu:fe.onContextMenu},ee.id):null}),Z&&As.map(ee=>h.jsx(kL,{nodeId:ee.id,position:ee.position},`metrics-${ee.id}`))]})}),h.jsx(DL,{isVisible:le}),h.jsx(jL,{isVisible:te}),h.jsx(SL,{selectedNodeId:E,highlightPath:!0}),pe&&h.jsx(WL,{x:pe.x,y:pe.y,onDelete:kn,onClose:()=>me(null)}),ye&&(()=>{const ee=e.find(Be=>Be.id===ye.nodeId);if(!ee)return null;const fe=e.filter(Be=>Be.selected),be=fe.length>1,ze=()=>{be?(fe.forEach(Be=>{A(Be.id)}),Ke.success(`${fe.length} elements deleted`)):(A(ee.id),Ke.success("Element deleted")),ve(null)},Oe=()=>{if(be)fe.forEach((Be,jn)=>{const Ba={...pl(Be),id:`${Be.type}_${Date.now()}_${jn}`,position:{x:Be.position.x+20+jn*10,y:Be.position.y+20+jn*10},selected:!1};Ba.data?.config&&(Ba.data.config=pl(Ba.data.config)),o(Ba)}),Ke.success(`${fe.length} elements duplicated`);else{const Be={...pl(ee),id:`${ee.type}_${Date.now()}`,position:{x:ee.position.x+20,y:ee.position.y+20},selected:!1};Be.data?.config&&(Be.data.config=pl(Be.data.config)),o(Be),Ke.success("Element duplicated")}ve(null)},ct=()=>{if(be){const Be=fe.map(jn=>jn.id).join(", ");navigator.clipboard.writeText(Be),Ke.success(`${fe.length} IDs copied to clipboard`)}else navigator.clipboard.writeText(ee.id),Ke.success("ID copied to clipboard");ve(null)},zt=()=>{be?(fe.forEach(Be=>{N(Be.id)}),Ke.success(`${fe.length} elements brought to front`)):(N(ee.id),Ke.success("Brought to front")),ve(null)},Wt=()=>{be?(fe.forEach(Be=>{D(Be.id)}),Ke.success(`${fe.length} elements sent to back`)):(D(ee.id),Ke.success("Sent to back")),ve(null)},Rt=()=>{be?(fe.forEach(Be=>{q(Be.id)}),Ke.success(`${fe.length} elements brought forward`)):(q(ee.id),Ke.success("Brought forward")),ve(null)},cn=()=>{be?(fe.forEach(Be=>{P(Be.id)}),Ke.success(`${fe.length} elements sent backward`)):(P(ee.id),Ke.success("Sent backward")),ve(null)},wt=()=>{de(be?{nodeId:fe[0].id,x:ye.x,y:ye.y}:{nodeId:ee.id,x:ye.x,y:ye.y}),ve(null)},ot=be?n.filter(Be=>fe.some(jn=>Be.nodeIds.includes(jn.id))):n.filter(Be=>Be.nodeIds.includes(ee.id)),mt=ot.length>=1,Ht=ot.length>=2,is=()=>{if(be){let Be=0;fe.forEach(jn=>{n.filter(xo=>xo.nodeIds.includes(jn.id)).forEach(xo=>{ce(xo.id,jn.id),Be++})}),Be>0&&Ke.success(`Removed ${fe.length} elements from groups`),ve(null)}else Ht?($e({nodeId:ee.id,x:ye.x,y:ye.y}),ve(null)):ot.length===1&&(ce(ot[0].id,ee.id),Ke.success(`Removed from "${ot[0].name}"`),ve(null))};return h.jsx(KL,{x:ye.x,y:ye.y,onDelete:ze,onDuplicate:Oe,onCopyId:ct,onBringToFront:zt,onSendToBack:Wt,onBringForward:Rt,onSendBackward:cn,onAddToGroup:wt,onRemoveFromGroup:mt?is:void 0,onClose:()=>ve(null)})})(),Dt&&h.jsx(YL,{nodeId:Dt.nodeId,x:Dt.x,y:Dt.y,onClose:()=>de(null)}),He&&h.jsx(XL,{nodeId:He.nodeId,x:He.x,y:He.y,onClose:()=>$e(null)})]})}const ZL="modulepreload",JL=function(r){return"/"+r},kv={},Ce=function(e,t,n){let o=Promise.resolve();if(t&&t.length>0){let f=function(p){return Promise.all(p.map(g=>Promise.resolve(g).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),u=l?.nonce||l?.getAttribute("nonce");o=f(t.map(p=>{if(p=JL(p),p in kv)return;kv[p]=!0;const g=p.endsWith(".css"),m=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${m}`))return;const y=document.createElement("link");if(y.rel=g?"stylesheet":ZL,g||(y.as="script"),y.crossOrigin="",y.href=p,u&&y.setAttribute("nonce",u),document.head.appendChild(y),g)return new Promise((x,S)=>{y.addEventListener("load",x),y.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${p}`)))})}))}function i(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return o.then(l=>{for(const u of l||[])u.status==="rejected"&&i(u.reason);return e().catch(i)})},eO=w.lazy(()=>Ce(()=>import("./KafkaConfigAdvanced-BKod3AZk.js"),__vite__mapDeps([0,1,2,3,4,5])).then(r=>({default:r.KafkaConfigAdvanced}))),tO=w.lazy(()=>Ce(()=>import("./RabbitMQConfigAdvanced-C2GPYtwa.js"),__vite__mapDeps([6,1,7,8,9,10,11,12,5,3])).then(r=>({default:r.RabbitMQConfigAdvanced}))),nO=w.lazy(()=>Ce(()=>import("./PostgreSQLConfigAdvanced-B6d8JrKR.js"),__vite__mapDeps([13,2,7,9,8,3,14,4,12])).then(r=>({default:r.PostgreSQLConfigAdvanced}))),sO=w.lazy(()=>Ce(()=>import("./MongoDBConfigAdvanced-BCaDfznX.js"),__vite__mapDeps([15,2,7,9,8,3])).then(r=>({default:r.MongoDBConfigAdvanced}))),aO=w.lazy(()=>Ce(()=>import("./RedisConfigAdvanced-Dg8xh044.js"),__vite__mapDeps([16,2,9,8,3,12])).then(r=>({default:r.RedisConfigAdvanced}))),oO=w.lazy(()=>Ce(()=>import("./ElasticsearchConfigAdvanced-CK31HyG0.js"),__vite__mapDeps([17,2,9,18,19,3,5])).then(r=>({default:r.ElasticsearchConfigAdvanced}))),rO=w.lazy(()=>Ce(()=>import("./CassandraConfigAdvanced-DyJnGqDA.js"),__vite__mapDeps([20,1,2,3,14,19])).then(r=>({default:r.CassandraConfigAdvanced}))),iO=w.lazy(()=>Ce(()=>import("./ClickHouseConfigAdvanced-C6zV7P-T.js"),__vite__mapDeps([21,2,1,7,8,9,22,3,19])).then(r=>({default:r.ClickHouseConfigAdvanced}))),cO=w.lazy(()=>Ce(()=>import("./SnowflakeConfigAdvanced-DpPdGLQY.js"),__vite__mapDeps([23,2,18,3,12])).then(r=>({default:r.SnowflakeConfigAdvanced}))),lO=w.lazy(()=>Ce(()=>import("./S3DataLakeConfigAdvanced-B2FlARgF.js"),__vite__mapDeps([24,18,12,25])).then(r=>({default:r.S3DataLakeConfigAdvanced}))),uO=w.lazy(()=>Ce(()=>import("./NginxConfigAdvanced-jkc3hS2J.js"),__vite__mapDeps([26,2,27,28,11,5])).then(r=>({default:r.NginxConfigAdvanced}))),dO=w.lazy(()=>Ce(()=>import("./RestApiConfigAdvanced-Z1HTF79f.js"),__vite__mapDeps([29,2,27,19])).then(r=>({default:r.RestApiConfigAdvanced}))),fO=w.lazy(()=>Ce(()=>import("./GRPCConfigAdvanced-CxujBLTa.js"),__vite__mapDeps([30,2,18,28,31])).then(r=>({default:r.GRPCConfigAdvanced}))),hO=w.lazy(()=>Ce(()=>import("./WebSocketConfigAdvanced-BqZrKOTx.js"),__vite__mapDeps([32,2,18,10,33,31])).then(r=>({default:r.WebSocketConfigAdvanced}))),pO=w.lazy(()=>Ce(()=>import("./GraphQLConfigAdvanced-CDMa4ZZ-.js"),__vite__mapDeps([34,2,18,3,19,31])).then(r=>({default:r.GraphQLConfigAdvanced}))),gO=w.lazy(()=>Ce(()=>import("./SOAPConfigAdvanced-fw5HiuwX.js"),__vite__mapDeps([35,2,18,28,31])).then(r=>({default:r.SOAPConfigAdvanced}))),mO=w.lazy(()=>Ce(()=>import("./WebhookConfigAdvanced-Dy8uJEuN.js"),__vite__mapDeps([36,18,37,33,31,38])).then(r=>({default:r.WebhookConfigAdvanced}))),yO=w.lazy(()=>Ce(()=>import("./DockerK8sConfigAdvanced-a_0smPj1.js"),__vite__mapDeps([39,2,1])).then(r=>({default:r.DockerK8sConfigAdvanced}))),vO=w.lazy(()=>Ce(()=>import("./HAProxyConfigAdvanced-CuV--yAH.js"),__vite__mapDeps([40,18,41,31,28,5])).then(r=>({default:r.HAProxyConfigAdvanced}))),bO=w.lazy(()=>Ce(()=>import("./TraefikConfigAdvanced-Ou9e_gym.js"),__vite__mapDeps([42,18,43,31,5])).then(r=>({default:r.TraefikConfigAdvanced}))),xO=w.lazy(()=>Ce(()=>import("./EnvoyConfigAdvanced-CV8sb236.js"),__vite__mapDeps([44,18,27,28,31])).then(r=>({default:r.EnvoyConfigAdvanced}))),wO=w.lazy(()=>Ce(()=>import("./ActiveMQConfigAdvanced-DRE_OgVs.js"),__vite__mapDeps([45,1,46,18,10,3,4,5,47])).then(r=>({default:r.ActiveMQConfigAdvanced}))),SO=w.lazy(()=>Ce(()=>import("./AWSSQSConfigAdvanced-pIsvdiAd.js"),__vite__mapDeps([48,1,18,49,10,12,5,33])).then(r=>({default:r.AWSSQSConfigAdvanced}))),CO=w.lazy(()=>Ce(()=>import("./AzureServiceBusConfigAdvanced-Dl5w8yy3.js"),__vite__mapDeps([50,2,10,12])).then(r=>({default:r.AzureServiceBusConfigAdvanced}))),MO=w.lazy(()=>Ce(()=>import("./GCPPubSubConfigAdvanced-D6mCC7Qa.js"),__vite__mapDeps([51,2,10,4,12])).then(r=>({default:r.GCPPubSubConfigAdvanced}))),EO=w.lazy(()=>Ce(()=>import("./KongConfigAdvanced-BUumuDv8.js"),__vite__mapDeps([52,2,9,28,43,4])).then(r=>({default:r.KongConfigAdvanced}))),RO=w.lazy(()=>Ce(()=>import("./ApigeeConfigAdvanced-BJ1MpQk3.js"),__vite__mapDeps([53,1,5])).then(r=>({default:r.ApigeeConfigAdvanced}))),TO=w.lazy(()=>Ce(()=>import("./MuleSoftConfigAdvanced-DCKrixF0.js"),__vite__mapDeps([54,1,3,31])).then(r=>({default:r.MuleSoftConfigAdvanced}))),AO=w.lazy(()=>Ce(()=>import("./GraphQLGatewayConfigAdvanced-C0Jw4oCW.js"),__vite__mapDeps([55,31,27])).then(r=>({default:r.GraphQLGatewayConfigAdvanced}))),NO=w.lazy(()=>Ce(()=>import("./BFFServiceConfigAdvanced-B7lgotX0.js"),__vite__mapDeps([56,18])).then(r=>({default:r.BFFServiceConfigAdvanced}))),kO=w.lazy(()=>Ce(()=>import("./WebhookRelayConfigAdvanced-DhSgwXDv.js"),__vite__mapDeps([57,2,46,18,37,33,31,38])).then(r=>({default:r.WebhookRelayConfigAdvanced}))),DO=w.lazy(()=>Ce(()=>import("./PrometheusConfigAdvanced-BvQUNJiS.js"),__vite__mapDeps([58,2,9])).then(r=>({default:r.PrometheusConfigAdvanced}))),jO=w.lazy(()=>Ce(()=>import("./GrafanaConfigAdvanced-CQgDs6VK.js"),__vite__mapDeps([59,22,2,3])).then(r=>({default:r.GrafanaConfigAdvanced}))),_O=w.lazy(()=>Ce(()=>import("./LokiConfigAdvanced-BvEPy39v.js"),__vite__mapDeps([60,2,47])).then(r=>({default:r.LokiConfigAdvanced}))),zO=w.lazy(()=>Ce(()=>import("./JaegerConfigAdvanced-BQLYwgTL.js"),__vite__mapDeps([61,1,62])).then(r=>({default:r.JaegerConfigAdvanced}))),LO=w.lazy(()=>Ce(()=>import("./OpenTelemetryCollectorConfigAdvanced-C_uvrMoG.js"),__vite__mapDeps([63,1,18,11])).then(r=>({default:r.OpenTelemetryCollectorConfigAdvanced}))),OO=w.lazy(()=>Ce(()=>import("./PagerDutyConfigAdvanced-B0jGgle_.js"),__vite__mapDeps([64,18,4])).then(r=>({default:r.PagerDutyConfigAdvanced}))),PO=w.lazy(()=>Ce(()=>import("./KeycloakConfigAdvanced-exO-rPcE.js"),__vite__mapDeps([65,5,27,12,4,38,66])).then(r=>({default:r.KeycloakConfigAdvanced}))),IO=w.lazy(()=>Ce(()=>import("./WAFConfigAdvanced-CMNgW3FX.js"),__vite__mapDeps([67,18,5,27,31])).then(r=>({default:r.WAFConfigAdvanced}))),qO=w.lazy(()=>Ce(()=>import("./SecretsVaultConfigAdvanced-DxVbKow6.js"),__vite__mapDeps([68,2,18,12,3,5,31])).then(r=>({default:r.SecretsVaultConfigAdvanced}))),HO=w.lazy(()=>Ce(()=>import("./IDSIPSConfigAdvanced-BMEEA_vP.js"),__vite__mapDeps([69,18,5,70,31])).then(r=>({default:r.IDSIPSConfigAdvanced}))),UO=w.lazy(()=>Ce(()=>import("./FirewallConfigAdvanced-ZOJ0bYQR.js"),__vite__mapDeps([71,18,5,31,70,41])).then(r=>({default:r.FirewallConfigAdvanced}))),$O=w.lazy(()=>Ce(()=>import("./JenkinsConfigAdvanced-Ch0dTAPy.js"),__vite__mapDeps([72,1,62,73,4,38])).then(r=>({default:r.JenkinsConfigAdvanced}))),BO=w.lazy(()=>Ce(()=>import("./GitLabCIConfigAdvanced-DQnQPECD.js"),__vite__mapDeps([74,1,62,38])).then(r=>({default:r.GitLabCIConfigAdvanced}))),QO=w.lazy(()=>Ce(()=>import("./ArgoCDConfigAdvanced-G9tSz_cK.js"),__vite__mapDeps([75,1,38])).then(r=>({default:r.ArgoCDConfigAdvanced}))),GO=w.lazy(()=>Ce(()=>import("./HarborConfigAdvanced-CZgO6AAC.js"),__vite__mapDeps([76,73,25,4,5])).then(r=>({default:r.HarborConfigAdvanced}))),FO=w.lazy(()=>Ce(()=>import("./TerraformConfigAdvanced-BJMSPmR9.js"),__vite__mapDeps([77,2,18,31,49,38])).then(r=>({default:r.TerraformConfigAdvanced}))),VO=w.lazy(()=>Ce(()=>import("./AnsibleConfigAdvanced-5CosIfaW.js"),__vite__mapDeps([78,18,28,31,38])).then(r=>({default:r.AnsibleConfigAdvanced}))),KO=w.lazy(()=>Ce(()=>import("./IstioConfigAdvanced-3lqrqitf.js"),__vite__mapDeps([79,18,27,43])).then(r=>({default:r.IstioConfigAdvanced}))),YO=w.lazy(()=>Ce(()=>import("./ServiceMeshConfigAdvanced-CfBvZNlI.js"),__vite__mapDeps([80,18,28,5])).then(r=>({default:r.ServiceMeshConfigAdvanced}))),XO=w.lazy(()=>Ce(()=>import("./APIGatewayConfigAdvanced-D09s-lvU.js"),__vite__mapDeps([81,9,18,27,5,41,43])).then(r=>({default:r.APIGatewayConfigAdvanced}))),WO=w.lazy(()=>Ce(()=>import("./VPNConfigAdvanced-Bvy-g_Yk.js"),__vite__mapDeps([82,18,4,66,38])).then(r=>({default:r.VPNConfigAdvanced}))),ZO=w.lazy(()=>Ce(()=>import("./CDNConfigAdvanced-rGK86-ni.js"),__vite__mapDeps([83,18,27,41])).then(r=>({default:r.CDNConfigAdvanced}))),JO=w.lazy(()=>Ce(()=>import("./SparkConfigAdvanced-BW9ifVA6.js"),__vite__mapDeps([84,18,3,31,38])).then(r=>({default:r.SparkConfigAdvanced}))),e3=w.lazy(()=>Ce(()=>import("./TensorFlowServingConfigAdvanced-DdnWRqbI.js"),__vite__mapDeps([85,2,18,3,31])).then(r=>({default:r.TensorFlowServingConfigAdvanced}))),t3=w.lazy(()=>Ce(()=>import("./PyTorchServeConfigAdvanced-D7qObqah.js"),__vite__mapDeps([86,2,18,3,31])).then(r=>({default:r.PyTorchServeConfigAdvanced}))),n3=w.lazy(()=>Ce(()=>import("./FeatureStoreConfigAdvanced-BbO5hrry.js"),__vite__mapDeps([87,18,73,3,41])).then(r=>({default:r.FeatureStoreConfigAdvanced}))),s3=w.lazy(()=>Ce(()=>import("./MLflowConfigAdvanced-D4abdMEt.js"),__vite__mapDeps([88,73,41])).then(r=>({default:r.MLflowConfigAdvanced}))),a3=w.lazy(()=>Ce(()=>import("./CRMConfigAdvanced-_CzBswHr.js"),__vite__mapDeps([89,18,4,90,41,91])).then(r=>({default:r.CRMConfigAdvanced}))),o3=w.lazy(()=>Ce(()=>import("./ERPConfigAdvanced-B9Q0Xc49.js"),__vite__mapDeps([92,18,73,90,41,91])).then(r=>({default:r.ERPConfigAdvanced}))),r3=w.lazy(()=>Ce(()=>import("./RPABotConfigAdvanced-CpjZ7Uaw.js"),__vite__mapDeps([93,18,41,31,38])).then(r=>({default:r.RPABotConfigAdvanced}))),i3=w.lazy(()=>Ce(()=>import("./BPMNEngineConfigAdvanced-Bccv1n0T.js"),__vite__mapDeps([94,18,31,38,4])).then(r=>({default:r.BPMNEngineConfigAdvanced}))),c3=w.lazy(()=>Ce(()=>import("./PaymentGatewayConfigAdvanced-CZ9g91xN.js"),__vite__mapDeps([95,18,90,41,5,31,38])).then(r=>({default:r.PaymentGatewayConfigAdvanced}))),l3=()=>h.jsx("div",{className:"flex items-center justify-center h-full",children:h.jsx("div",{className:"text-muted-foreground",children:"Loading configuration..."})});function u3({componentId:r,componentType:e}){const t=()=>{switch(e){case"kafka":return h.jsx(eO,{componentId:r});case"rabbitmq":return h.jsx(tO,{componentId:r});case"postgres":return h.jsx(nO,{componentId:r});case"mongodb":return h.jsx(sO,{componentId:r});case"redis":return h.jsx(aO,{componentId:r});case"elasticsearch":return h.jsx(oO,{componentId:r});case"cassandra":return h.jsx(rO,{componentId:r});case"clickhouse":return h.jsx(iO,{componentId:r});case"snowflake":return h.jsx(cO,{componentId:r});case"s3-datalake":return h.jsx(lO,{componentId:r});case"nginx":return h.jsx(uO,{componentId:r});case"rest":return h.jsx(dO,{componentId:r});case"grpc":return h.jsx(fO,{componentId:r});case"websocket":return h.jsx(hO,{componentId:r});case"graphql":return h.jsx(pO,{componentId:r});case"soap":return h.jsx(gO,{componentId:r});case"webhook":return h.jsx(mO,{componentId:r});case"docker":case"kubernetes":return h.jsx(yO,{componentId:r});case"haproxy":return h.jsx(vO,{componentId:r});case"traefik":return h.jsx(bO,{componentId:r});case"envoy":return h.jsx(xO,{componentId:r});case"activemq":return h.jsx(wO,{componentId:r});case"aws-sqs":return h.jsx(SO,{componentId:r});case"azure-service-bus":return h.jsx(CO,{componentId:r});case"gcp-pubsub":return h.jsx(MO,{componentId:r});case"kong":return h.jsx(EO,{componentId:r});case"apigee":return h.jsx(RO,{componentId:r});case"mulesoft":return h.jsx(TO,{componentId:r});case"graphql-gateway":return h.jsx(AO,{componentId:r});case"bff-service":return h.jsx(NO,{componentId:r});case"webhook-relay":return h.jsx(kO,{componentId:r});case"prometheus":return h.jsx(DO,{componentId:r});case"grafana":return h.jsx(jO,{componentId:r});case"loki":return h.jsx(_O,{componentId:r});case"jaeger":return h.jsx(zO,{componentId:r});case"otel-collector":return h.jsx(LO,{componentId:r});case"pagerduty":return h.jsx(OO,{componentId:r});case"keycloak":return h.jsx(PO,{componentId:r});case"waf":return h.jsx(IO,{componentId:r});case"firewall":return h.jsx(UO,{componentId:r});case"secrets-vault":return h.jsx(qO,{componentId:r});case"ids-ips":return h.jsx(HO,{componentId:r});case"jenkins":return h.jsx($O,{componentId:r});case"gitlab-ci":return h.jsx(BO,{componentId:r});case"argo-cd":return h.jsx(QO,{componentId:r});case"terraform":return h.jsx(FO,{componentId:r});case"ansible":return h.jsx(VO,{componentId:r});case"harbor":return h.jsx(GO,{componentId:r});case"istio":return h.jsx(KO,{componentId:r});case"service-mesh":return h.jsx(YO,{componentId:r});case"api-gateway":return h.jsx(XO,{componentId:r});case"vpn":return h.jsx(WO,{componentId:r});case"cdn":return h.jsx(ZO,{componentId:r});case"spark":return h.jsx(JO,{componentId:r});case"tensorflow-serving":return h.jsx(e3,{componentId:r});case"pytorch-serve":return h.jsx(t3,{componentId:r});case"feature-store":return h.jsx(n3,{componentId:r});case"mlflow":return h.jsx(s3,{componentId:r});case"crm":return h.jsx(a3,{componentId:r});case"erp":return h.jsx(o3,{componentId:r});case"rpa-bot":return h.jsx(r3,{componentId:r});case"bpmn-engine":return h.jsx(i3,{componentId:r});case"payment-gateway":return h.jsx(c3,{componentId:r});default:return h.jsx("div",{className:"p-6 text-center text-muted-foreground",children:"Configuration panel not available for this component type"})}};return h.jsx(w.Suspense,{fallback:h.jsx(l3,{}),children:t()})}function d3(){const{undo:r,redo:e,zoom:t,setZoom:n,pan:o,setPan:i,resetCanvas:l,saveDiagram:u,selectedConnectionId:f,selectedNodeId:p,selectedGroupId:g,nodes:m,deleteConnection:y,deleteNode:x,deleteGroup:S,selectConnection:C,selectNode:E,selectGroup:M}=Re(),{canUndo:A,canRedo:T}=Mi(),{isRunning:N,start:D,stop:q}=kt(),{showMinimap:P,toggleMinimap:H,showHeatMapLegend:J,toggleHeatMapLegend:se}=Li();w.useEffect(()=>{const ce=Z=>{const te=Z.ctrlKey||Z.metaKey;if(te&&Z.key==="z"&&!Z.shiftKey&&A){Z.preventDefault(),r();return}if(te&&(Z.key==="z"&&Z.shiftKey||Z.key==="y")&&T){Z.preventDefault(),e();return}if(te&&(Z.key==="="||Z.key==="+")){Z.preventDefault(),n(Math.min(t+.1,2));return}if(te&&Z.key==="-"){Z.preventDefault(),n(Math.max(t-.1,.5));return}if(te&&Z.key==="0"){Z.preventDefault(),n(1),i({x:0,y:0});return}const le=50;if(!te){if(Z.key==="ArrowLeft"){Z.preventDefault(),i({x:o.x+le,y:o.y});return}if(Z.key==="ArrowRight"){Z.preventDefault(),i({x:o.x-le,y:o.y});return}if(Z.key==="ArrowUp"){Z.preventDefault(),i({x:o.x,y:o.y+le});return}if(Z.key==="ArrowDown"){Z.preventDefault(),i({x:o.x,y:o.y-le});return}}if(!te&&Z.key===" "){const ue=Z.target;if(!ue){if(Z.preventDefault(),N)q();else{const{nodes:X,connections:he}=Re.getState();kt.getState().initialize(X,he),D()}return}const z=ue.tagName;if(z==="INPUT"||z==="TEXTAREA"||z==="SELECT"||ue.isContentEditable||ue.closest('input, textarea, select, [contenteditable="true"]'))return;const O=ue.getAttribute("role");if(O==="textbox"||O==="combobox"||O==="searchbox"||O==="spinbutton"||ue.closest("[data-radix-select-trigger], [data-radix-select-content], [data-radix-select-viewport]"))return;if(Z.preventDefault(),N)q();else{const{nodes:X,connections:he}=Re.getState();kt.getState().initialize(X,he),D()}return}if(te&&(Z.key==="s"||Z.key==="")){Z.preventDefault(),u();return}if(te&&(Z.key==="m"||Z.key==="")){Z.preventDefault(),H();return}if(te&&(Z.key==="h"||Z.key==="")){Z.preventDefault(),se();return}if((Z.key==="Delete"||Z.key==="Backspace")&&!te){const ue=document.activeElement;if(ue){const j=ue.tagName;if(j==="INPUT"||j==="TEXTAREA"||j==="SELECT"||ue.isContentEditable)return;const O=ue.getAttribute("role");if(O==="textbox"||O==="combobox"||O==="searchbox"||O==="spinbutton")return;const X=ue.closest("form")!==null,he=ue.closest('[role="textbox"], [role="combobox"], [contenteditable="true"]')!==null,_=ue.closest("[data-radix-select-trigger], [data-radix-select-content]")!==null,Q=ue.closest('[role="dialog"]')!==null;if(X||he||_||Q)return}if(Z.preventDefault(),f){y(f),C(null);return}if(g){S(g),M(null);return}const z=m.filter(j=>j.selected);if(z.length>0){z.forEach(j=>x(j.id)),E(null);return}if(p){x(p),E(null);return}}};return window.addEventListener("keydown",ce),()=>{window.removeEventListener("keydown",ce)}},[r,e,A,T,t,n,o,i,l,u,N,D,q,P,H,J,se,f,p,g,m,y,x,S,C,E,M])}class ml extends w.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){ta("ErrorBoundary caught an error",e,{componentStack:t.componentStack}),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:h.jsx("div",{className:"flex items-center justify-center min-h-screen p-4",children:h.jsxs(Nn,{className:"w-full max-w-2xl",children:[h.jsxs(Ws,{children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx(ys,{className:"h-5 w-5 text-destructive"}),h.jsx(Zs,{children:"-   "})]}),h.jsx(gr,{children:"    "})]}),h.jsxs(Js,{className:"space-y-4",children:[this.state.error&&h.jsxs("div",{className:"space-y-2",children:[h.jsx("p",{className:"text-sm font-semibold text-foreground",children:":"}),h.jsx("pre",{className:"text-xs bg-muted p-3 rounded-md overflow-auto max-h-48",children:this.state.error.toString()})]}),!1,h.jsxs("div",{className:"flex gap-2",children:[h.jsxs(Ne,{onClick:this.handleReset,variant:"default",children:[h.jsx(y2,{className:"h-4 w-4 mr-2"})," "]}),h.jsx(Ne,{onClick:()=>window.location.reload(),variant:"outline",children:" "})]})]})]})}):this.props.children}}function f3(){d3();const{tabs:r}=pu(),e=r.find(t=>t.active);return h.jsx(ml,{children:h.jsx(ML,{children:h.jsx(bL,{children:h.jsxs("div",{className:"h-screen flex flex-col bg-background",children:[h.jsx(mD,{}),h.jsx(gL,{}),h.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[h.jsx(ml,{children:h.jsx(wz,{})}),h.jsx(ml,{children:e?.type==="diagram"?h.jsx(Nv,{}):e?.type==="component"&&e.componentId&&e.componentType?h.jsx("div",{className:"flex-1 overflow-hidden",children:h.jsx(u3,{componentId:e.componentId,componentType:e.componentType})}):h.jsx(Nv,{})}),h.jsx(ml,{children:h.jsx(pL,{})})]})]})})})})}cE.createRoot(document.getElementById("root")).render(h.jsxs(Et.StrictMode,{children:[h.jsx(XE,{position:"top-right"}),h.jsx(f3,{})]}));export{JA as $,ho as A,Qt as B,Nn as C,ap as D,De as E,K0 as F,h3 as G,_5 as H,Nt as I,L5 as J,$l as K,st as L,BA as M,u2 as N,YA as O,Al as P,cb as Q,r2 as R,vn as S,ip as T,k2 as U,We as V,lb as W,uo as X,c2 as Y,fb as Z,kt as _,au as a,vs as a0,kS as a1,fo as a2,ys as a3,Ee as a4,jh as a5,Dh as a6,p3 as a7,UA as a8,Th as a9,Uv as aa,Et as ab,y2 as ac,on as ad,ta as ae,qh as af,hs as b,R2 as c,_a as d,Ws as e,Zs as f,g3 as g,gr as h,Ne as i,h as j,Js as k,Ri as l,Hh as m,a5 as n,V1 as o,o5 as p,X1 as q,w as r,Ci as s,lo as t,Re as u,Xl as v,Wl as w,Jl as x,eu as y,Zl as z};

import{J as Pe,u as ls,a as is,j as e,e as rs,r as j,l as p,S as ue,C as k,h as A,i as _,m as L,A as Le,T as cs,b as ds,c as q,p as je,d as os,f as z,k as Q,P as W,O as Ee,I as g,q as y,s as C,U as Ie,t as w,v as S,w as l,B as N,X as B,o as H,L as o,x as G,D as J,y as K,z as X,E as Y,G as Z,H as se}from"./index-0yVPR4Zl.js";import{T as Ne}from"./textarea-DDJx7dm7.js";import{u as xs}from"./use-toast-DdQFI8JU.js";import{R as ms}from"./refresh-ccw-BqidHAae.js";import{U as ee}from"./users-_FCiOnLf.js";import{D as Re}from"./dollar-sign-ANgbD-E4.js";import{T as De}from"./trending-up-CDjNCTF9.js";import{B as U}from"./building-BJFbuXD2.js";import{M as pe}from"./mail-CbnWC3qz.js";const hs=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],ve=Pe("phone",hs);const us=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ge=Pe("target",us);function Ls({componentId:d}){const{nodes:R,updateNode:I}=ls(),{getComponentMetrics:i}=is(),{toast:m}=xs(),n=R.find(s=>s.id===d);if(!n)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const t=rs.getCRMEmulationEngine(d),f=i(d)?.customMetrics||{},v=n.data.config||{},x=v.contacts||[],a=v.deals||[],r=v.accounts||[],E=v.leads||[],F=v.cases||[];v.activities;const P=t?.getMetrics(),Me=P?.contactsTotal??x.length,Ve=P?.dealsTotal??a.length,Te=P?.pipelineValue??a.filter(s=>s.stage!=="closed-won"&&s.stage!=="closed-lost").reduce((s,c)=>s+c.value,0),$e=P?.conversionRate??(E.length>0?E.filter(s=>s.status==="converted").length/E.length*100:0);P?.dealWinRate,P?.requestsPerSecond??f.requestsPerSecond,P?.averageResponseTime??f.averageResponseTime,P?.errorRate??f.errorRate;const[Oe,ae]=j.useState(!1),[Fe,ne]=j.useState(!1),[qe,te]=j.useState(!1),[ze,le]=j.useState(!1),[Qe,ie]=j.useState(!1),[M,de]=j.useState(null),[V,oe]=j.useState(null),[T,xe]=j.useState(null),[$,me]=j.useState(null),[O,he]=j.useState(null),[D,fe]=j.useState(""),[re,Ue]=j.useState("all"),[ce,We]=j.useState("all"),b=s=>{I(d,{data:{...n.data,config:{...v,...s}}}),t&&t.initializeConfig(n)};j.useEffect(()=>{if(t){const s=t.getContacts(),c=t.getDeals(),u=t.getAccounts(),as=t.getLeads(),ns=t.getCases(),ts=t.getActivities();(s.length>0||c.length>0||u.length>0)&&x.length===0&&a.length===0&&r.length===0&&b({contacts:s,deals:c,accounts:u,leads:as,cases:ns,activities:ts})}},[t]);const be=s=>{de(s||null),ae(!0)},Be=s=>{if(!s.name){m({title:"Validation error",description:"Contact name is required",variant:"destructive"});return}const c=M?x.map(u=>u.id===M.id?{...u,...s}:u):[...x,{id:`contact-${Date.now()}`,name:s.name,email:s.email,phone:s.phone,company:s.company,status:s.status||"lead",createdAt:Date.now(),lastContact:Date.now()}];if(b({contacts:c}),t)if(M)t.updateContact(M.id,s);else{const u=c[c.length-1];t.addContact(u)}ae(!1),m({title:M?"Contact updated":"Contact created",description:`Contact ${s.name} has been ${M?"updated":"created"}.`})},He=s=>{b({contacts:x.filter(c=>c.id!==s)}),t&&t.removeContact(s),m({title:"Contact removed",description:"Contact has been removed."})},ye=s=>{oe(s||null),ne(!0)},Ge=s=>{if(!s.name||!s.value){m({title:"Validation error",description:"Deal name and value are required",variant:"destructive"});return}const c=V?a.map(u=>u.id===V.id?{...u,...s}:u):[...a,{id:`deal-${Date.now()}`,name:s.name,value:s.value,stage:s.stage||"prospecting",probability:s.probability||0,contactId:s.contactId,accountId:s.accountId,expectedClose:s.expectedClose,createdAt:Date.now()}];if(b({deals:c}),t)if(V)t.updateDeal(V.id,s);else{const u=c[c.length-1];t.addDeal(u)}ne(!1),m({title:V?"Deal updated":"Deal created",description:`Deal ${s.name} has been ${V?"updated":"created"}.`})},Je=s=>{b({deals:a.filter(c=>c.id!==s)}),t&&t.removeDeal(s),m({title:"Deal removed",description:"Deal has been removed."})},Ce=s=>{xe(s||null),te(!0)},Ke=s=>{if(!s.name){m({title:"Validation error",description:"Account name is required",variant:"destructive"});return}const c=T?r.map(u=>u.id===T.id?{...u,...s}:u):[...r,{id:`account-${Date.now()}`,name:s.name,type:s.type||"customer",industry:s.industry,website:s.website,phone:s.phone,email:s.email,address:s.address,annualRevenue:s.annualRevenue,employees:s.employees,createdAt:Date.now()}];if(b({accounts:c}),t)if(T)t.updateAccount(T.id,s);else{const u=c[c.length-1];t.addAccount(u)}te(!1),m({title:T?"Account updated":"Account created",description:`Account ${s.name} has been ${T?"updated":"created"}.`})},Xe=s=>{b({accounts:r.filter(c=>c.id!==s)}),t&&t.removeAccount(s),m({title:"Account removed",description:"Account has been removed."})},we=s=>{me(s||null),le(!0)},Ye=s=>{if(!s.name){m({title:"Validation error",description:"Lead name is required",variant:"destructive"});return}const c=$?E.map(u=>u.id===$.id?{...u,...s}:u):[...E,{id:`lead-${Date.now()}`,name:s.name,email:s.email,phone:s.phone,company:s.company,status:s.status||"new",source:s.source||"web",score:s.score||0,createdAt:Date.now()}];if(b({leads:c}),t)if($)t.updateLead($.id,s);else{const u=c[c.length-1];t.addLead(u)}le(!1),m({title:$?"Lead updated":"Lead created",description:`Lead ${s.name} has been ${$?"updated":"created"}.`})},Ze=s=>{b({leads:E.filter(c=>c.id!==s)}),t&&t.removeLead(s),m({title:"Lead removed",description:"Lead has been removed."})},Se=s=>{he(s||null),ie(!0)},es=s=>{if(!s.subject){m({title:"Validation error",description:"Case subject is required",variant:"destructive"});return}const c=O?F.map(u=>u.id===O.id?{...u,...s}:u):[...F,{id:`case-${Date.now()}`,subject:s.subject,description:s.description,contactId:s.contactId,accountId:s.accountId,status:s.status||"new",priority:s.priority||"medium",type:s.type||"question",createdAt:Date.now()}];if(b({cases:c}),t)if(O)t.updateCase(O.id,s);else{const u=c[c.length-1];t.addCase(u)}ie(!1),m({title:O?"Case updated":"Case created",description:`Case ${s.subject} has been ${O?"updated":"created"}.`})},ss=s=>{b({cases:F.filter(c=>c.id!==s)}),t&&t.removeCase(s),m({title:"Case removed",description:"Case has been removed."})},ke=j.useMemo(()=>{let s=x;return D&&(s=s.filter(c=>c.name.toLowerCase().includes(D.toLowerCase())||c.email?.toLowerCase().includes(D.toLowerCase())||c.company?.toLowerCase().includes(D.toLowerCase()))),re!=="all"&&(s=s.filter(c=>c.status===re)),s},[x,D,re]),Ae=j.useMemo(()=>{let s=a;return D&&(s=s.filter(c=>c.name.toLowerCase().includes(D.toLowerCase()))),ce!=="all"&&(s=s.filter(c=>c.stage===ce)),s},[a,D,ce]),_e=s=>{switch(s){case"closed-won":return"bg-green-500";case"closed-lost":return"bg-red-500";case"negotiation":return"bg-blue-500";case"proposal":return"bg-yellow-500";default:return"bg-gray-500"}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"CRM System"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Customer Relationship Management"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage customer relationships and sales pipeline"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(p,{variant:"outline",size:"sm",children:[e.jsx(ms,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(ue,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(k,{className:"border-l-4 border-l-blue-500",children:[e.jsx(A,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{className:"text-sm font-medium text-muted-foreground",children:"Contacts"}),e.jsx(ee,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(L,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:Me}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"total"})]})})]}),e.jsxs(k,{className:"border-l-4 border-l-green-500",children:[e.jsx(A,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{className:"text-sm font-medium text-muted-foreground",children:"Deals"}),e.jsx(Le,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(L,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:Ve}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"active"})]})})]}),e.jsxs(k,{className:"border-l-4 border-l-purple-500",children:[e.jsx(A,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{className:"text-sm font-medium text-muted-foreground",children:"Pipeline Value"}),e.jsx(Re,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(L,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsxs("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:["$",(Te/1e3).toFixed(0),"K"]})})})]}),e.jsxs(k,{className:"border-l-4 border-l-cyan-500",children:[e.jsx(A,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{className:"text-sm font-medium text-muted-foreground",children:"Conversion"}),e.jsx(De,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsx(L,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsxs("span",{className:"text-3xl font-bold text-cyan-600 dark:text-cyan-400",children:[$e.toFixed(1),"%"]})})})]})]}),e.jsxs(cs,{defaultValue:"contacts",className:"space-y-4",children:[e.jsxs(ds,{className:"flex flex-wrap gap-2",children:[e.jsxs(q,{value:"contacts",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Contacts (",x.length,")"]}),e.jsxs(q,{value:"deals",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Deals (",a.length,")"]}),e.jsxs(q,{value:"accounts",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Accounts (",r.length,")"]}),e.jsxs(q,{value:"leads",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Leads (",E.length,")"]}),e.jsxs(q,{value:"cases",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Cases (",F.length,")"]}),e.jsxs(q,{value:"settings",children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(z,{value:"contacts",className:"space-y-4",children:e.jsxs(k,{children:[e.jsx(A,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_,{children:"Contacts"}),e.jsx(Q,{children:"Customer and lead contacts"})]}),e.jsxs(p,{onClick:()=>be(),size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Add Contact"]})]})}),e.jsxs(L,{children:[e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(g,{placeholder:"Search contacts...",value:D,onChange:s=>fe(s.target.value),className:"pl-9"})]}),e.jsxs(y,{value:re,onValueChange:Ue,children:[e.jsxs(C,{className:"w-[180px]",children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),e.jsx(w,{placeholder:"Filter by status"})]}),e.jsxs(S,{children:[e.jsx(l,{value:"all",children:"All Statuses"}),e.jsx(l,{value:"lead",children:"Lead"}),e.jsx(l,{value:"customer",children:"Customer"}),e.jsx(l,{value:"partner",children:"Partner"}),e.jsx(l,{value:"inactive",children:"Inactive"})]})]})]}),ke.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ee,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No contacts found"}),e.jsx("p",{className:"text-xs mt-2",children:'Click "Add Contact" to create a new contact'})]}):e.jsx("div",{className:"space-y-4",children:ke.map(s=>e.jsxs(k,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-gradient-to-r from-blue-50/50 to-transparent dark:from-blue-950/10",children:[e.jsx(A,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:e.jsx(ee,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(_,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(N,{variant:"outline",children:s.status}),s.company&&e.jsxs(N,{variant:"outline",children:[e.jsx(U,{className:"h-3 w-3 mr-1"}),s.company]}),s.value&&e.jsxs(N,{variant:"outline",className:"bg-green-50 dark:bg-green-950/20 text-green-700 dark:text-green-300",children:["$",s.value.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>be(s),className:"hover:bg-blue-50 dark:hover:bg-blue-950/20",children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>He(s.id),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(H,{className:"h-4 w-4"})})]})]})}),e.jsxs(L,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.phone})]})]}),s.lastContact&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Last contact: ",new Date(s.lastContact).toLocaleString()]})]})]},s.id))})]})]})}),e.jsx(z,{value:"deals",className:"space-y-4",children:e.jsxs(k,{children:[e.jsx(A,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_,{children:"Sales Pipeline"}),e.jsx(Q,{children:"Active deals and opportunities"})]}),e.jsxs(p,{onClick:()=>ye(),size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Add Deal"]})]})}),e.jsxs(L,{children:[e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(g,{placeholder:"Search deals...",value:D,onChange:s=>fe(s.target.value),className:"pl-9"})]}),e.jsxs(y,{value:ce,onValueChange:We,children:[e.jsxs(C,{className:"w-[180px]",children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),e.jsx(w,{placeholder:"Filter by stage"})]}),e.jsxs(S,{children:[e.jsx(l,{value:"all",children:"All Stages"}),e.jsx(l,{value:"prospecting",children:"Prospecting"}),e.jsx(l,{value:"qualification",children:"Qualification"}),e.jsx(l,{value:"proposal",children:"Proposal"}),e.jsx(l,{value:"negotiation",children:"Negotiation"}),e.jsx(l,{value:"closed-won",children:"Closed Won"}),e.jsx(l,{value:"closed-lost",children:"Closed Lost"})]})]})]}),Ae.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(De,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No deals found"}),e.jsx("p",{className:"text-xs mt-2",children:'Click "Add Deal" to create a new deal'})]}):e.jsx("div",{className:"space-y-4",children:Ae.map(s=>e.jsxs(k,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow bg-gradient-to-r from-green-50/50 to-transparent dark:from-green-950/10",children:[e.jsx(A,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${_e(s.stage)}/20`,children:e.jsx(Re,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx(_,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(N,{variant:"outline",className:_e(s.stage),children:s.stage}),e.jsxs(N,{variant:"outline",children:["$",s.value.toLocaleString()]}),e.jsxs(N,{variant:"outline",children:[s.probability,"% probability"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>ye(s),className:"hover:bg-green-50 dark:hover:bg-green-950/20",children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>Je(s.id),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(H,{className:"h-4 w-4"})})]})]})}),e.jsx(L,{children:e.jsxs("div",{className:"text-sm",children:[s.contactId&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Contact:"}),e.jsx("span",{className:"ml-2 font-semibold",children:x.find(c=>c.id===s.contactId)?.name||s.contactId})]}),s.accountId&&e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Account:"}),e.jsx("span",{className:"ml-2 font-semibold",children:r.find(c=>c.id===s.accountId)?.name||s.accountId})]}),s.description&&e.jsx("div",{className:"mb-2 text-muted-foreground",children:s.description}),s.expectedClose&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Expected close: ",new Date(s.expectedClose).toLocaleDateString()]})]})})]},s.id))})]})]})}),e.jsx(z,{value:"accounts",className:"space-y-4",children:e.jsxs(k,{children:[e.jsx(A,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_,{children:"Accounts"}),e.jsx(Q,{children:"Company accounts and organizations"})]}),e.jsxs(p,{onClick:()=>Ce(),size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Add Account"]})]})}),e.jsx(L,{children:r.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(U,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No accounts configured"}),e.jsx("p",{className:"text-xs mt-2",children:'Click "Add Account" to create a new account'})]}):e.jsx("div",{className:"space-y-4",children:r.map(s=>e.jsxs(k,{className:"border-l-4 border-l-purple-500 hover:shadow-md transition-shadow",children:[e.jsx(A,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100 dark:bg-purple-900/30",children:e.jsx(U,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx(_,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(N,{variant:"outline",children:s.type}),s.industry&&e.jsx(N,{variant:"outline",children:s.industry}),s.annualRevenue&&e.jsxs(N,{variant:"outline",className:"bg-green-50 dark:bg-green-950/20",children:["$",(s.annualRevenue/1e6).toFixed(1),"M"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>Ce(s),children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>Xe(s.id),children:e.jsx(H,{className:"h-4 w-4"})})]})]})}),e.jsx(L,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.phone})]}),s.website&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.website})]}),s.employees&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{children:[s.employees," employees"]})]})]})})]},s.id))})})]})}),e.jsx(z,{value:"leads",className:"space-y-4",children:e.jsxs(k,{children:[e.jsx(A,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_,{children:"Leads"}),e.jsx(Q,{children:"Potential customers and prospects"})]}),e.jsxs(p,{onClick:()=>we(),size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Add Lead"]})]})}),e.jsx(L,{children:E.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ge,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No leads configured"}),e.jsx("p",{className:"text-xs mt-2",children:'Click "Add Lead" to create a new lead'})]}):e.jsx("div",{className:"space-y-4",children:E.map(s=>e.jsxs(k,{className:"border-l-4 border-l-orange-500 hover:shadow-md transition-shadow",children:[e.jsx(A,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-orange-100 dark:bg-orange-900/30",children:e.jsx(ge,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx(_,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(N,{variant:"outline",children:s.status}),s.source&&e.jsx(N,{variant:"outline",children:s.source}),s.score!==void 0&&e.jsxs(N,{variant:"outline",className:"bg-blue-50 dark:bg-blue-950/20",children:["Score: ",s.score]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>we(s),children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>Ze(s.id),children:e.jsx(H,{className:"h-4 w-4"})})]})]})}),e.jsx(L,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.phone})]}),s.company&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:s.company})]})]})})]},s.id))})})]})}),e.jsx(z,{value:"cases",className:"space-y-4",children:e.jsxs(k,{children:[e.jsx(A,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(_,{children:"Support Cases"}),e.jsx(Q,{children:"Customer support tickets and issues"})]}),e.jsxs(p,{onClick:()=>Se(),size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"Add Case"]})]})}),e.jsx(L,{children:F.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(je,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No cases configured"}),e.jsx("p",{className:"text-xs mt-2",children:'Click "Add Case" to create a new case'})]}):e.jsx("div",{className:"space-y-4",children:F.map(s=>e.jsxs(k,{className:"border-l-4 border-l-red-500 hover:shadow-md transition-shadow",children:[e.jsx(A,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-red-100 dark:bg-red-900/30",children:e.jsx(je,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(_,{className:"text-lg font-semibold",children:s.subject}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(N,{variant:"outline",children:s.status}),e.jsx(N,{variant:"outline",className:s.priority==="critical"?"bg-red-500":s.priority==="high"?"bg-orange-500":s.priority==="medium"?"bg-yellow-500":"bg-gray-500",children:s.priority}),s.type&&e.jsx(N,{variant:"outline",children:s.type})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>Se(s),children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>ss(s.id),children:e.jsx(H,{className:"h-4 w-4"})})]})]})}),e.jsxs(L,{children:[s.description&&e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.description}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Created: ",s.createdAt?new Date(s.createdAt).toLocaleString():"N/A",s.resolvedAt&&e.jsxs("span",{className:"ml-4",children:["Resolved: ",new Date(s.resolvedAt).toLocaleString()]})]})]})]},s.id))})})]})}),e.jsx(z,{value:"settings",className:"space-y-4",children:e.jsxs(k,{children:[e.jsxs(A,{children:[e.jsx(_,{children:"CRM Settings"}),e.jsx(Q,{children:"System configuration"})]}),e.jsxs(L,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"CRM Type"}),e.jsxs(y,{value:v.crmType||"salesforce",onValueChange:s=>b({crmType:s}),children:[e.jsx(C,{children:e.jsx(w,{})}),e.jsxs(S,{children:[e.jsx(l,{value:"salesforce",children:"Salesforce"}),e.jsx(l,{value:"hubspot",children:"HubSpot"}),e.jsx(l,{value:"dynamics",children:"Microsoft Dynamics"}),e.jsx(l,{value:"custom",children:"Custom"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"API Endpoint"}),e.jsx(g,{value:v.apiEndpoint||"",onChange:s=>b({apiEndpoint:s.target.value}),placeholder:"https://api.crm.example.com"})]}),e.jsx(ue,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Enable Contacts"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Manage customer contacts"})]}),e.jsx(G,{checked:v.enableContacts??!0,onCheckedChange:s=>b({enableContacts:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Enable Leads"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Manage potential customers"})]}),e.jsx(G,{checked:v.enableLeads??!0,onCheckedChange:s=>b({enableLeads:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Enable Opportunities"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Manage sales opportunities"})]}),e.jsx(G,{checked:v.enableOpportunities??!0,onCheckedChange:s=>b({enableOpportunities:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Enable Accounts"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Manage company accounts"})]}),e.jsx(G,{checked:v.enableAccounts??!0,onCheckedChange:s=>b({enableAccounts:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Enable Cases"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Manage support cases"})]}),e.jsx(G,{checked:v.enableCases??!0,onCheckedChange:s=>b({enableCases:s})})]}),e.jsx(ue,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Default Deal Stages"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(N,{variant:"outline",children:"Prospecting"}),e.jsx(N,{variant:"outline",children:"Qualification"}),e.jsx(N,{variant:"outline",children:"Proposal"}),e.jsx(N,{variant:"outline",children:"Negotiation"}),e.jsx(N,{variant:"outline",children:"Closed Won"}),e.jsx(N,{variant:"outline",children:"Closed Lost"})]})]})]})]})})]}),e.jsx(J,{open:Oe,onOpenChange:ae,children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsxs(X,{children:[e.jsx(Y,{children:M?"Edit Contact":"Create Contact"}),e.jsx(Z,{children:"Enter contact information"})]}),e.jsx(js,{contact:M,contacts:x,accounts:r,onSave:s=>{Be(s),de(null)},onCancel:()=>{ae(!1),de(null)}})]})}),e.jsx(J,{open:Fe,onOpenChange:ne,children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsxs(X,{children:[e.jsx(Y,{children:V?"Edit Deal":"Create Deal"}),e.jsx(Z,{children:"Enter deal information"})]}),e.jsx(ps,{deal:V,contacts:x,accounts:r,onSave:s=>{Ge(s),oe(null)},onCancel:()=>{ne(!1),oe(null)}})]})}),e.jsx(J,{open:qe,onOpenChange:te,children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsxs(X,{children:[e.jsx(Y,{children:T?"Edit Account":"Create Account"}),e.jsx(Z,{children:"Enter account information"})]}),e.jsx(vs,{account:T,onSave:s=>{Ke(s),xe(null)},onCancel:()=>{te(!1),xe(null)}})]})}),e.jsx(J,{open:ze,onOpenChange:le,children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsxs(X,{children:[e.jsx(Y,{children:$?"Edit Lead":"Create Lead"}),e.jsx(Z,{children:"Enter lead information"})]}),e.jsx(gs,{lead:$,onSave:s=>{Ye(s),me(null)},onCancel:()=>{le(!1),me(null)}})]})}),e.jsx(J,{open:Qe,onOpenChange:ie,children:e.jsxs(K,{className:"max-w-2xl",children:[e.jsxs(X,{children:[e.jsx(Y,{children:O?"Edit Case":"Create Case"}),e.jsx(Z,{children:"Enter case information"})]}),e.jsx(Ns,{crmCase:O,contacts:x,accounts:r,onSave:s=>{es(s),he(null)},onCancel:()=>{ie(!1),he(null)}})]})})]})})}function js({contact:d,contacts:R,accounts:I,onSave:i,onCancel:m}){const[n,t]=j.useState({name:d?.name||"",email:d?.email||"",phone:d?.phone||"",company:d?.company||"",status:d?.status||"lead",accountId:d?.accountId||"",value:d?.value||0}),[h,f]=j.useState({}),v=r=>r?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)?"":"Invalid email format":"",x=()=>{const r={};if((!n.name||n.name.trim()==="")&&(r.name="Name is required"),n.email&&n.email.trim()!==""){const E=v(n.email);E&&(r.email=E)}return f(r),Object.keys(r).length===0},a=()=>{x()&&i(n)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Name *"}),e.jsx(g,{value:n.name,onChange:r=>{t({...n,name:r.target.value}),h.name&&f({...h,name:""})},className:h.name?"border-destructive":""}),h.name&&e.jsx("p",{className:"text-sm text-destructive",children:h.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Email"}),e.jsx(g,{type:"email",value:n.email,onChange:r=>{t({...n,email:r.target.value}),h.email&&f({...h,email:""})},className:h.email?"border-destructive":""}),h.email&&e.jsx("p",{className:"text-sm text-destructive",children:h.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Phone"}),e.jsx(g,{value:n.phone,onChange:r=>t({...n,phone:r.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Company"}),e.jsx(g,{value:n.company,onChange:r=>t({...n,company:r.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Status"}),e.jsxs(y,{value:n.status,onValueChange:r=>t({...n,status:r}),children:[e.jsx(C,{children:e.jsx(w,{})}),e.jsxs(S,{children:[e.jsx(l,{value:"lead",children:"Lead"}),e.jsx(l,{value:"customer",children:"Customer"}),e.jsx(l,{value:"partner",children:"Partner"}),e.jsx(l,{value:"inactive",children:"Inactive"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Account"}),e.jsxs(y,{value:n.accountId||"__none__",onValueChange:r=>t({...n,accountId:r==="__none__"?"":r}),children:[e.jsx(C,{children:e.jsx(w,{placeholder:"Select account"})}),e.jsxs(S,{children:[e.jsx(l,{value:"__none__",children:"None"}),I.map(r=>e.jsx(l,{value:r.id,children:r.name},r.id))]})]})]}),e.jsxs(se,{children:[e.jsx(p,{variant:"outline",onClick:m,children:"Cancel"}),e.jsx(p,{onClick:a,children:"Save"})]})]})}function ps({deal:d,contacts:R,accounts:I,onSave:i,onCancel:m}){const[n,t]=j.useState({name:d?.name||"",value:d?.value||0,stage:d?.stage||"prospecting",probability:d?.probability||0,contactId:d?.contactId||"",accountId:d?.accountId||"",description:d?.description||"",expectedClose:d?.expectedClose}),[h,f]=j.useState({}),v=()=>{const a={};return(!n.name||n.name.trim()==="")&&(a.name="Deal name is required"),(!n.value||n.value<=0)&&(a.value="Value must be greater than 0"),n.probability!==void 0&&(n.probability<0||n.probability>100)&&(a.probability="Probability must be between 0 and 100"),f(a),Object.keys(a).length===0},x=()=>{v()&&i(n)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Deal Name *"}),e.jsx(g,{value:n.name,onChange:a=>{t({...n,name:a.target.value}),h.name&&f({...h,name:""})},className:h.name?"border-destructive":""}),h.name&&e.jsx("p",{className:"text-sm text-destructive",children:h.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Value ($) *"}),e.jsx(g,{type:"number",value:n.value,onChange:a=>{const r=parseFloat(a.target.value)||0;t({...n,value:r}),h.value&&f({...h,value:""})},className:h.value?"border-destructive":""}),h.value&&e.jsx("p",{className:"text-sm text-destructive",children:h.value})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Probability (%)"}),e.jsx(g,{type:"number",min:"0",max:"100",value:n.probability,onChange:a=>{const r=parseInt(a.target.value)||0;t({...n,probability:r}),h.probability&&f({...h,probability:""})},className:h.probability?"border-destructive":""}),h.probability&&e.jsx("p",{className:"text-sm text-destructive",children:h.probability})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Stage"}),e.jsxs(y,{value:n.stage,onValueChange:a=>t({...n,stage:a}),children:[e.jsx(C,{children:e.jsx(w,{})}),e.jsxs(S,{children:[e.jsx(l,{value:"prospecting",children:"Prospecting"}),e.jsx(l,{value:"qualification",children:"Qualification"}),e.jsx(l,{value:"proposal",children:"Proposal"}),e.jsx(l,{value:"negotiation",children:"Negotiation"}),e.jsx(l,{value:"closed-won",children:"Closed Won"}),e.jsx(l,{value:"closed-lost",children:"Closed Lost"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Expected Close Date"}),e.jsx(g,{type:"date",value:n.expectedClose?new Date(n.expectedClose).toISOString().split("T")[0]:"",onChange:a=>t({...n,expectedClose:a.target.value?new Date(a.target.value).getTime():void 0})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Contact"}),e.jsxs(y,{value:n.contactId||"__none__",onValueChange:a=>t({...n,contactId:a==="__none__"?"":a}),children:[e.jsx(C,{children:e.jsx(w,{placeholder:"Select contact"})}),e.jsxs(S,{children:[e.jsx(l,{value:"__none__",children:"None"}),R.map(a=>e.jsx(l,{value:a.id,children:a.name},a.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Account"}),e.jsxs(y,{value:n.accountId||"__none__",onValueChange:a=>t({...n,accountId:a==="__none__"?"":a}),children:[e.jsx(C,{children:e.jsx(w,{placeholder:"Select account"})}),e.jsxs(S,{children:[e.jsx(l,{value:"__none__",children:"None"}),I.map(a=>e.jsx(l,{value:a.id,children:a.name},a.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Description"}),e.jsx(Ne,{value:n.description,onChange:a=>t({...n,description:a.target.value}),rows:3})]}),e.jsxs(se,{children:[e.jsx(p,{variant:"outline",onClick:m,children:"Cancel"}),e.jsx(p,{onClick:x,children:"Save"})]})]})}function vs({account:d,onSave:R,onCancel:I}){const[i,m]=j.useState({name:d?.name||"",type:d?.type||"customer",industry:d?.industry||"",website:d?.website||"",phone:d?.phone||"",email:d?.email||"",address:d?.address||"",annualRevenue:d?.annualRevenue||0,employees:d?.employees||0}),[n,t]=j.useState({}),h=a=>a?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?"":"Invalid email format":"",f=a=>{if(!a)return"";try{return new URL(a.startsWith("http")?a:`https://${a}`),""}catch{return"Invalid URL format"}},v=()=>{const a={};if((!i.name||i.name.trim()==="")&&(a.name="Account name is required"),i.email&&i.email.trim()!==""){const r=h(i.email);r&&(a.email=r)}if(i.website&&i.website.trim()!==""){const r=f(i.website);r&&(a.website=r)}return i.annualRevenue!==void 0&&i.annualRevenue<0&&(a.annualRevenue="Annual revenue cannot be negative"),i.employees!==void 0&&i.employees<0&&(a.employees="Number of employees cannot be negative"),t(a),Object.keys(a).length===0},x=()=>{v()&&R(i)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Account Name *"}),e.jsx(g,{value:i.name,onChange:a=>{m({...i,name:a.target.value}),n.name&&t({...n,name:""})},className:n.name?"border-destructive":""}),n.name&&e.jsx("p",{className:"text-sm text-destructive",children:n.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Type"}),e.jsxs(y,{value:i.type,onValueChange:a=>m({...i,type:a}),children:[e.jsx(C,{children:e.jsx(w,{})}),e.jsxs(S,{children:[e.jsx(l,{value:"customer",children:"Customer"}),e.jsx(l,{value:"partner",children:"Partner"}),e.jsx(l,{value:"competitor",children:"Competitor"}),e.jsx(l,{value:"reseller",children:"Reseller"}),e.jsx(l,{value:"prospect",children:"Prospect"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Industry"}),e.jsx(g,{value:i.industry,onChange:a=>m({...i,industry:a.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Email"}),e.jsx(g,{type:"email",value:i.email,onChange:a=>{m({...i,email:a.target.value}),n.email&&t({...n,email:""})},className:n.email?"border-destructive":""}),n.email&&e.jsx("p",{className:"text-sm text-destructive",children:n.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Phone"}),e.jsx(g,{value:i.phone,onChange:a=>m({...i,phone:a.target.value})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Website"}),e.jsx(g,{value:i.website,onChange:a=>{m({...i,website:a.target.value}),n.website&&t({...n,website:""})},className:n.website?"border-destructive":""}),n.website&&e.jsx("p",{className:"text-sm text-destructive",children:n.website})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Address"}),e.jsx(Ne,{value:i.address,onChange:a=>m({...i,address:a.target.value}),rows:2})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Annual Revenue ($)"}),e.jsx(g,{type:"number",value:i.annualRevenue,onChange:a=>{const r=parseFloat(a.target.value)||0;m({...i,annualRevenue:r}),n.annualRevenue&&t({...n,annualRevenue:""})},className:n.annualRevenue?"border-destructive":""}),n.annualRevenue&&e.jsx("p",{className:"text-sm text-destructive",children:n.annualRevenue})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Employees"}),e.jsx(g,{type:"number",value:i.employees,onChange:a=>{const r=parseInt(a.target.value)||0;m({...i,employees:r}),n.employees&&t({...n,employees:""})},className:n.employees?"border-destructive":""}),n.employees&&e.jsx("p",{className:"text-sm text-destructive",children:n.employees})]})]}),e.jsxs(se,{children:[e.jsx(p,{variant:"outline",onClick:I,children:"Cancel"}),e.jsx(p,{onClick:x,children:"Save"})]})]})}function gs({lead:d,onSave:R,onCancel:I}){const[i,m]=j.useState({name:d?.name||"",email:d?.email||"",phone:d?.phone||"",company:d?.company||"",status:d?.status||"new",source:d?.source||"web",score:d?.score||0}),[n,t]=j.useState({}),h=x=>x?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(x)?"":"Invalid email format":"",f=()=>{const x={};if((!i.name||i.name.trim()==="")&&(x.name="Lead name is required"),i.email&&i.email.trim()!==""){const a=h(i.email);a&&(x.email=a)}return i.score!==void 0&&(i.score<0||i.score>100)&&(x.score="Lead score must be between 0 and 100"),t(x),Object.keys(x).length===0},v=()=>{f()&&R(i)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Lead Name *"}),e.jsx(g,{value:i.name,onChange:x=>{m({...i,name:x.target.value}),n.name&&t({...n,name:""})},className:n.name?"border-destructive":""}),n.name&&e.jsx("p",{className:"text-sm text-destructive",children:n.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Email"}),e.jsx(g,{type:"email",value:i.email,onChange:x=>{m({...i,email:x.target.value}),n.email&&t({...n,email:""})},className:n.email?"border-destructive":""}),n.email&&e.jsx("p",{className:"text-sm text-destructive",children:n.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Phone"}),e.jsx(g,{value:i.phone,onChange:x=>m({...i,phone:x.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Company"}),e.jsx(g,{value:i.company,onChange:x=>m({...i,company:x.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Status"}),e.jsxs(y,{value:i.status,onValueChange:x=>m({...i,status:x}),children:[e.jsx(C,{children:e.jsx(w,{})}),e.jsxs(S,{children:[e.jsx(l,{value:"new",children:"New"}),e.jsx(l,{value:"contacted",children:"Contacted"}),e.jsx(l,{value:"qualified",children:"Qualified"}),e.jsx(l,{value:"converted",children:"Converted"}),e.jsx(l,{value:"lost",children:"Lost"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Source"}),e.jsxs(y,{value:i.source,onValueChange:x=>m({...i,source:x}),children:[e.jsx(C,{children:e.jsx(w,{})}),e.jsxs(S,{children:[e.jsx(l,{value:"web",children:"Web"}),e.jsx(l,{value:"email",children:"Email"}),e.jsx(l,{value:"phone",children:"Phone"}),e.jsx(l,{value:"referral",children:"Referral"}),e.jsx(l,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Lead Score (0-100)"}),e.jsx(g,{type:"number",min:"0",max:"100",value:i.score,onChange:x=>{const a=parseInt(x.target.value)||0;m({...i,score:a}),n.score&&t({...n,score:""})},className:n.score?"border-destructive":""}),n.score&&e.jsx("p",{className:"text-sm text-destructive",children:n.score})]})]}),e.jsxs(se,{children:[e.jsx(p,{variant:"outline",onClick:I,children:"Cancel"}),e.jsx(p,{onClick:v,children:"Save"})]})]})}function Ns({crmCase:d,contacts:R,accounts:I,onSave:i,onCancel:m}){const[n,t]=j.useState({subject:d?.subject||"",description:d?.description||"",status:d?.status||"new",priority:d?.priority||"medium",type:d?.type||"question",contactId:d?.contactId||"",accountId:d?.accountId||""}),[h,f]=j.useState({}),v=()=>{const a={};return(!n.subject||n.subject.trim()==="")&&(a.subject="Subject is required"),f(a),Object.keys(a).length===0},x=()=>{v()&&i(n)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Subject *"}),e.jsx(g,{value:n.subject,onChange:a=>{t({...n,subject:a.target.value}),h.subject&&f({...h,subject:""})},className:h.subject?"border-destructive":""}),h.subject&&e.jsx("p",{className:"text-sm text-destructive",children:h.subject})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Description"}),e.jsx(Ne,{value:n.description,onChange:a=>t({...n,description:a.target.value}),rows:4})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Status"}),e.jsxs(y,{value:n.status,onValueChange:a=>t({...n,status:a}),children:[e.jsx(C,{children:e.jsx(w,{})}),e.jsxs(S,{children:[e.jsx(l,{value:"new",children:"New"}),e.jsx(l,{value:"in-progress",children:"In Progress"}),e.jsx(l,{value:"escalated",children:"Escalated"}),e.jsx(l,{value:"resolved",children:"Resolved"}),e.jsx(l,{value:"closed",children:"Closed"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Priority"}),e.jsxs(y,{value:n.priority,onValueChange:a=>t({...n,priority:a}),children:[e.jsx(C,{children:e.jsx(w,{})}),e.jsxs(S,{children:[e.jsx(l,{value:"low",children:"Low"}),e.jsx(l,{value:"medium",children:"Medium"}),e.jsx(l,{value:"high",children:"High"}),e.jsx(l,{value:"critical",children:"Critical"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Type"}),e.jsxs(y,{value:n.type,onValueChange:a=>t({...n,type:a}),children:[e.jsx(C,{children:e.jsx(w,{})}),e.jsxs(S,{children:[e.jsx(l,{value:"question",children:"Question"}),e.jsx(l,{value:"problem",children:"Problem"}),e.jsx(l,{value:"feature",children:"Feature Request"}),e.jsx(l,{value:"complaint",children:"Complaint"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Contact"}),e.jsxs(y,{value:n.contactId||"__none__",onValueChange:a=>t({...n,contactId:a==="__none__"?"":a}),children:[e.jsx(C,{children:e.jsx(w,{placeholder:"Select contact"})}),e.jsxs(S,{children:[e.jsx(l,{value:"__none__",children:"None"}),R.map(a=>e.jsx(l,{value:a.id,children:a.name},a.id))]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Account"}),e.jsxs(y,{value:n.accountId||"__none__",onValueChange:a=>t({...n,accountId:a==="__none__"?"":a}),children:[e.jsx(C,{children:e.jsx(w,{placeholder:"Select account"})}),e.jsxs(S,{children:[e.jsx(l,{value:"__none__",children:"None"}),I.map(a=>e.jsx(l,{value:a.id,children:a.name},a.id))]})]})]}),e.jsxs(se,{children:[e.jsx(p,{variant:"outline",onClick:m,children:"Cancel"}),e.jsx(p,{onClick:x,children:"Save"})]})]})}export{Ls as CRMConfigAdvanced};

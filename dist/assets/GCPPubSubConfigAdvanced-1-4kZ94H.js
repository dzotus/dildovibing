import{u as A,j as e,r as k,S as f,C as t,e as l,f as i,k as r,B as D,T as V,a as _,b as C,d as y,h as S,i as g,P as M,I as u,m as P,L as m,n as q,o as F,p as J,q as H,s as Q,t as W}from"./index-Gi7Ro3vi.js";import{T as X}from"./textarea-CJbxdcvv.js";import{M as Y}from"./message-square-DRPjkZ5Q.js";import{U as Z}from"./users-CaHPnze_.js";import{K as $}from"./key-CuFEubrb.js";function te({componentId:w}){const{nodes:I,updateNode:E}=A(),N=I.find(s=>s.id===w);if(!N)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const h=N.data.config||{},j=h.projectId||"archiphoenix-lab",L=h.credentials||"",c=h.topics||[],d=h.subscriptions||[],[B,v]=k.useState(null),[O,b]=k.useState(null),o=s=>{E(w,{data:{...N.data,config:{...h,...s}}})},R=()=>{const s={name:"new-topic",projectId:j,messageRetentionDuration:604800,messageCount:0,byteCount:0};o({topics:[...c,s]})},G=s=>{o({topics:c.filter((n,a)=>a!==s)})},T=(s,n,a)=>{const x=[...c];x[s]={...x[s],[n]:a},o({topics:x})},z=()=>{const s={name:"new-subscription",topic:c[0]?.name||"",projectId:j,ackDeadlineSeconds:10,enableMessageOrdering:!1,messageCount:0,unackedMessageCount:0};o({subscriptions:[...d,s]})},K=s=>{o({subscriptions:d.filter((n,a)=>a!==s)})},p=(s,n,a)=>{const x=[...d];x[s]={...x[s],[n]:a},o({subscriptions:x})},U=c.reduce((s,n)=>s+(n.messageCount||0),0);return d.reduce((s,n)=>s+(n.unackedMessageCount||0),0),e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Google Cloud Pub/Sub"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Pub/Sub Service"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure topics and subscriptions with push/pull delivery"})]})}),e.jsx(f,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(t,{children:[e.jsx(l,{className:"pb-3",children:e.jsx(i,{className:"text-sm font-medium",children:"Project ID"})}),e.jsx(r,{children:e.jsx(D,{variant:"outline",children:j})})]}),e.jsxs(t,{children:[e.jsx(l,{className:"pb-3",children:e.jsx(i,{className:"text-sm font-medium",children:"Topics"})}),e.jsx(r,{children:e.jsx("span",{className:"text-2xl font-bold",children:c.length})})]}),e.jsxs(t,{children:[e.jsx(l,{className:"pb-3",children:e.jsx(i,{className:"text-sm font-medium",children:"Subscriptions"})}),e.jsx(r,{children:e.jsx("span",{className:"text-2xl font-bold",children:d.length})})]}),e.jsxs(t,{children:[e.jsx(l,{className:"pb-3",children:e.jsx(i,{className:"text-sm font-medium",children:"Total Messages"})}),e.jsx(r,{children:e.jsx("span",{className:"text-2xl font-bold",children:U.toLocaleString()})})]})]}),e.jsxs(V,{defaultValue:"topics",className:"space-y-4",children:[e.jsxs(_,{children:[e.jsxs(C,{value:"topics",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Topics (",c.length,")"]}),e.jsxs(C,{value:"subscriptions",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Subscriptions (",d.length,")"]}),e.jsxs(C,{value:"credentials",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Credentials"]})]}),e.jsx(y,{value:"topics",className:"space-y-4",children:e.jsxs(t,{children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Topics"}),e.jsx(S,{children:"Configure Pub/Sub topics"})]}),e.jsxs(g,{onClick:R,size:"sm",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Create Topic"]})]})}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:c.map((s,n)=>e.jsxs(t,{className:"border-l-4 border-l-blue-500",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{className:"text-base",children:B===n?e.jsx(u,{value:s.name,onChange:a=>T(n,"name",a.target.value),onBlur:()=>v(null),onKeyDown:a=>{a.key==="Enter"&&v(null)},className:"h-7",autoFocus:!0}):e.jsx("span",{className:"cursor-pointer hover:text-primary",onClick:()=>v(n),children:s.name})}),e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>G(n),disabled:c.length===1,children:e.jsx(P,{className:"h-4 w-4"})})]})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Messages"}),e.jsx("p",{className:"text-lg font-semibold",children:s.messageCount||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Bytes"}),e.jsx("p",{className:"text-lg font-semibold",children:(s.byteCount||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Topic ID"}),e.jsxs("p",{className:"text-xs font-mono text-muted-foreground truncate",children:["projects/",j,"/topics/",s.name]})]})]}),e.jsx(f,{}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Message Retention (seconds)"}),e.jsx(u,{type:"number",value:s.messageRetentionDuration||604800,onChange:a=>T(n,"messageRetentionDuration",Number(a.target.value))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default: 7 days (604800)"})]})})]})]},n))})})]})}),e.jsx(y,{value:"subscriptions",className:"space-y-4",children:e.jsxs(t,{children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(i,{children:"Subscriptions"}),e.jsx(S,{children:"Configure pull and push subscriptions"})]}),e.jsxs(g,{onClick:z,size:"sm",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Create Subscription"]})]})}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:d.map((s,n)=>e.jsxs(t,{className:"border-l-4 border-l-green-500",children:[e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{className:"text-base",children:O===n?e.jsx(u,{value:s.name,onChange:a=>p(n,"name",a.target.value),onBlur:()=>b(null),onKeyDown:a=>{a.key==="Enter"&&b(null)},className:"h-7",autoFocus:!0}):e.jsx("span",{className:"cursor-pointer hover:text-primary",onClick:()=>b(n),children:s.name})}),e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>K(n),disabled:d.length===1,children:e.jsx(P,{className:"h-4 w-4"})})]})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Messages"}),e.jsx("p",{className:"text-lg font-semibold",children:s.messageCount||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Unacked"}),e.jsx("p",{className:"text-lg font-semibold",children:s.unackedMessageCount||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Topic"}),e.jsx(D,{variant:"outline",children:s.topic})]})]}),e.jsx(f,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Topic"}),e.jsxs(q,{value:s.topic,onValueChange:a=>p(n,"topic",a),children:[e.jsx(F,{children:e.jsx(J,{})}),e.jsx(H,{children:c.map(a=>e.jsx(Q,{value:a.name,children:a.name},a.name))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Ack Deadline (seconds)"}),e.jsx(u,{type:"number",value:s.ackDeadlineSeconds,onChange:a=>p(n,"ackDeadlineSeconds",Number(a.target.value)),min:10,max:600})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Push Endpoint URL (optional)"}),e.jsx(u,{value:s.pushEndpoint||"",onChange:a=>p(n,"pushEndpoint",a.target.value),placeholder:"https://api.service/push"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty for pull subscription"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{children:"Enable Message Ordering"}),e.jsx(W,{checked:s.enableMessageOrdering,onCheckedChange:a=>p(n,"enableMessageOrdering",a)})]})]})]})]},n))})})]})}),e.jsx(y,{value:"credentials",className:"space-y-4",children:e.jsxs(t,{children:[e.jsxs(l,{children:[e.jsx(i,{children:"GCP Credentials"}),e.jsx(S,{children:"Configure Google Cloud Platform credentials"})]}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Project ID"}),e.jsx(u,{value:j,onChange:s=>o({projectId:s.target.value}),placeholder:"my-project-id"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Service Account JSON"}),e.jsx(X,{value:L,onChange:s=>o({credentials:s.target.value}),placeholder:'{"type": "service_account", ...}',rows:8}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Paste your GCP service account JSON credentials"})]})]})]})})]})]})})}export{te as GCPPubSubConfigAdvanced};

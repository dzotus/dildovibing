import{E as ae,u as ne,j as e,r as b,i as v,S as _,C as t,e as o,f as h,k as c,B as i,T as le,a as re,b as C,A as te,d as y,h as w,P as T,m as O,L as l,I as d,n as D,o as W,p as R,q as z,s as m,t as ce}from"./index-CHKNZn98.js";import{T as ie}from"./textarea-DXRXS1XW.js";import{R as de}from"./refresh-ccw-X6vm0O4r.js";import{C as ue}from"./cloud-BGIxYA8L.js";import{D as U}from"./database-DQr0aayQ.js";import{K as oe}from"./key-Dt_juhNO.js";const he=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],B=ae("snowflake",he);function ye({componentId:I}){const{nodes:P,updateNode:q}=ne(),S=P.find(s=>s.id===I);if(!S)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const u=S.data.config||{},E=u.account||"archiphoenix.us-east-1",H=u.username||"admin",V=u.password||"",A=u.warehouse||"COMPUTE_WH",M=u.database||"SNOWFLAKE",X=u.schema||"PUBLIC",F=u.role||"ACCOUNTADMIN",x=u.warehouses||[],p=u.databases||[{name:"SNOWFLAKE",comment:"System database",retentionTime:1,size:0,schemas:[{name:"INFORMATION_SCHEMA",tables:0,views:0,functions:0}]}],N=u.queries||[],[xe,me]=b.useState(null),[je,ve]=b.useState(null),[K,k]=b.useState(!1),[f,L]=b.useState(""),r=s=>{q(I,{data:{...S.data,config:{...u,...s}}})},$=()=>{const s={name:"NEW_WH",size:"Small",autoSuspend:60,autoResume:!0,minClusterCount:1,maxClusterCount:1,status:"suspended",runningQueries:0,queuedQueries:0};r({warehouses:[...x,s]})},G=s=>{r({warehouses:x.filter((n,a)=>a!==s)})},g=(s,n,a)=>{const j=[...x];j[s]={...j[s],[n]:a},r({warehouses:j})},J=()=>{const s={name:"NEW_DB",retentionTime:1,size:0,schemas:[{name:"PUBLIC",tables:0,views:0,functions:0}]};r({databases:[...p,s]})},Y=s=>{r({databases:p.filter((n,a)=>a!==s)})},Q=(s,n,a)=>{const j=[...p];j[s]={...j[s],[n]:a},r({databases:j})},Z=()=>{if(!f.trim())return;const s={id:`query-${Date.now()}`,queryText:f,status:"running",warehouse:A,database:M,schema:X,duration:0,rowsReturned:0};r({queries:[s,...N.slice(0,9)]}),L(""),k(!1)},ee=x.reduce((s,n)=>s+(n.runningQueries||0),0),se=x.reduce((s,n)=>s+(n.queuedQueries||0),0);return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Snowflake Data Cloud"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Data Warehouse"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure warehouses, databases, schemas and execute queries"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(v,{variant:"outline",size:"sm",children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"Snowflake Web UI"]})]})]}),e.jsx(_,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(t,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(h,{className:"text-sm font-medium",children:"Account"})}),e.jsx(c,{children:e.jsx(i,{variant:"outline",className:"truncate max-w-full",children:E})})]}),e.jsxs(t,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(h,{className:"text-sm font-medium",children:"Warehouses"})}),e.jsx(c,{children:e.jsx("span",{className:"text-2xl font-bold",children:x.length})})]}),e.jsxs(t,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(h,{className:"text-sm font-medium",children:"Running Queries"})}),e.jsx(c,{children:e.jsx("span",{className:"text-2xl font-bold",children:ee})})]}),e.jsxs(t,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(h,{className:"text-sm font-medium",children:"Queued Queries"})}),e.jsx(c,{children:e.jsx("span",{className:"text-2xl font-bold",children:se})})]})]}),e.jsxs(le,{defaultValue:"warehouses",className:"space-y-4",children:[e.jsxs(re,{children:[e.jsxs(C,{value:"warehouses",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Warehouses (",x.length,")"]}),e.jsxs(C,{value:"databases",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Databases (",p.length,")"]}),e.jsxs(C,{value:"queries",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Queries (",N.length,")"]}),e.jsxs(C,{value:"connection",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Connection"]})]}),e.jsx(y,{value:"warehouses",className:"space-y-4",children:e.jsxs(t,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{children:"Compute Warehouses"}),e.jsx(w,{children:"Configure virtual warehouses for query processing"})]}),e.jsxs(v,{onClick:$,size:"sm",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Create Warehouse"]})]})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:x.map((s,n)=>e.jsxs(t,{className:"border-l-4 border-l-blue-500",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx(h,{className:"text-base",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(i,{variant:s.status==="running"?"default":"outline",children:s.status||"suspended"}),e.jsx(i,{variant:"outline",children:s.size}),e.jsxs(i,{variant:"outline",children:[s.runningQueries||0," running"]})]})]})]}),e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>G(n),disabled:x.length===1,children:e.jsx(O,{className:"h-4 w-4"})})]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Running Queries"}),e.jsx("p",{className:"text-lg font-semibold",children:s.runningQueries||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Queued Queries"}),e.jsx("p",{className:"text-lg font-semibold",children:s.queuedQueries||0})]})]}),e.jsx(_,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Warehouse Name"}),e.jsx(d,{value:s.name,onChange:a=>g(n,"name",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Size"}),e.jsxs(D,{value:s.size,onValueChange:a=>g(n,"size",a),children:[e.jsx(W,{children:e.jsx(R,{})}),e.jsxs(z,{children:[e.jsx(m,{value:"X-Small",children:"X-Small"}),e.jsx(m,{value:"Small",children:"Small"}),e.jsx(m,{value:"Medium",children:"Medium"}),e.jsx(m,{value:"Large",children:"Large"}),e.jsx(m,{value:"X-Large",children:"X-Large"}),e.jsx(m,{value:"2X-Large",children:"2X-Large"}),e.jsx(m,{value:"3X-Large",children:"3X-Large"}),e.jsx(m,{value:"4X-Large",children:"4X-Large"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Auto Suspend (seconds)"}),e.jsx(d,{type:"number",value:s.autoSuspend||60,onChange:a=>g(n,"autoSuspend",Number(a.target.value))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{children:"Auto Resume"}),e.jsx(ce,{checked:s.autoResume??!0,onCheckedChange:a=>g(n,"autoResume",a)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Min Clusters"}),e.jsx(d,{type:"number",value:s.minClusterCount||1,onChange:a=>g(n,"minClusterCount",Number(a.target.value)),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Max Clusters"}),e.jsx(d,{type:"number",value:s.maxClusterCount||1,onChange:a=>g(n,"maxClusterCount",Number(a.target.value)),min:1})]})]})]})]},n))})})]})}),e.jsx(y,{value:"databases",className:"space-y-4",children:e.jsxs(t,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{children:"Databases"}),e.jsx(w,{children:"Manage databases and schemas"})]}),e.jsxs(v,{onClick:J,size:"sm",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Create Database"]})]})}),e.jsx(c,{children:e.jsx("div",{className:"space-y-4",children:p.map((s,n)=>e.jsxs(t,{className:"border-l-4 border-l-green-500",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(U,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx(h,{className:"text-base",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(i,{variant:"outline",children:[s.schemas?.length||0," schemas"]}),s.size!==void 0&&e.jsxs(i,{variant:"outline",children:[s.size.toLocaleString()," bytes"]})]})]})]}),e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>Y(n),disabled:p.length===1,children:e.jsx(O,{className:"h-4 w-4"})})]})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Database Name"}),e.jsx(d,{value:s.name,onChange:a=>Q(n,"name",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Retention Time (days)"}),e.jsx(d,{type:"number",value:s.retentionTime||1,onChange:a=>Q(n,"retentionTime",Number(a.target.value))})]})]}),s.comment&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Comment"}),e.jsx(d,{value:s.comment,onChange:a=>Q(n,"comment",a.target.value)})]}),s.schemas&&s.schemas.length>0&&e.jsxs("div",{children:[e.jsx(l,{className:"mb-2 block",children:"Schemas"}),e.jsx("div",{className:"space-y-2",children:s.schemas.map((a,j)=>e.jsx(t,{className:"p-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs(i,{variant:"outline",children:[a.tables||0," tables"]}),e.jsxs(i,{variant:"outline",children:[a.views||0," views"]}),e.jsxs(i,{variant:"outline",children:[a.functions||0," functions"]})]})]})})},j))})]})]})]},n))})})]})}),e.jsx(y,{value:"queries",className:"space-y-4",children:e.jsxs(t,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(h,{children:"Query History"}),e.jsx(w,{children:"Execute and monitor SQL queries"})]}),e.jsxs(v,{onClick:()=>k(!0),size:"sm",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"New Query"]})]})}),e.jsxs(c,{children:[K&&e.jsxs(t,{className:"mb-4 border-primary",children:[e.jsx(o,{children:e.jsx(h,{children:"Execute Query"})}),e.jsxs(c,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"SQL Query"}),e.jsx(ie,{value:f,onChange:s=>L(s.target.value),placeholder:"SELECT * FROM table_name LIMIT 10;",rows:6})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{onClick:Z,disabled:!f.trim(),children:"Execute"}),e.jsx(v,{variant:"outline",onClick:()=>{k(!1),L("")},children:"Cancel"})]})]})]}),N.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No queries executed"}):e.jsx("div",{className:"space-y-2",children:N.map(s=>e.jsx(t,{className:"border-l-4 border-l-purple-500",children:e.jsx(c,{className:"pt-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(i,{variant:s.status==="success"?"default":s.status==="failed"?"destructive":s.status==="running"?"secondary":"outline",children:s.status}),s.warehouse&&e.jsx(i,{variant:"outline",children:s.warehouse}),s.duration!==void 0&&e.jsxs(i,{variant:"outline",children:[s.duration,"ms"]})]}),e.jsx("p",{className:"text-sm font-mono bg-muted p-2 rounded text-xs",children:s.queryText}),s.rowsReturned!==void 0&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Rows returned: ",s.rowsReturned]})]})})})},s.id))})]})]})}),e.jsx(y,{value:"connection",className:"space-y-4",children:e.jsxs(t,{children:[e.jsxs(o,{children:[e.jsx(h,{children:"Connection Settings"}),e.jsx(w,{children:"Configure Snowflake connection parameters"})]}),e.jsx(c,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Account"}),e.jsx(d,{value:E,onChange:s=>r({account:s.target.value}),placeholder:"account.region.cloud"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Username"}),e.jsx(d,{value:H,onChange:s=>r({username:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Password"}),e.jsx(d,{type:"password",value:V,onChange:s=>r({password:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Role"}),e.jsx(d,{value:F,onChange:s=>r({role:s.target.value}),placeholder:"ACCOUNTADMIN"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Warehouse"}),e.jsxs(D,{value:A,onValueChange:s=>r({warehouse:s}),children:[e.jsx(W,{children:e.jsx(R,{})}),e.jsx(z,{children:x.map(s=>e.jsx(m,{value:s.name,children:s.name},s.name))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Database"}),e.jsxs(D,{value:M,onValueChange:s=>r({database:s}),children:[e.jsx(W,{children:e.jsx(R,{})}),e.jsx(z,{children:p.map(s=>e.jsx(m,{value:s.name,children:s.name},s.name))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Schema"}),e.jsx(d,{value:X,onChange:s=>r({schema:s.target.value}),placeholder:"PUBLIC"})]})]})})]})})]})]})})}export{ye as SnowflakeConfigAdvanced};

import{u as D,j as e,r as z,i as h,S as y,C as a,e as r,f as n,k as l,R as w,A as H,X as M,T as G,a as X,b as j,c as F,d as u,h as p,P as U,B as o,m as V,L as d,t as g,I as N}from"./index-Dd33G1rA.js";import{R as J}from"./refresh-ccw-BqMDkn9s.js";import{G as b}from"./globe-OJLibZCs.js";import{S as k}from"./server-BW8g7Bkz.js";import{C as K}from"./circle-check-big-DUY3LvWD.js";function ee({componentId:S}){const{nodes:T,updateNode:q}=D(),f=T.find(s=>s.id===S);if(!f)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const t=f.data.config||{},x=t.clusters||[{name:"backend-cluster",type:"STRICT_DNS",hosts:[{address:"backend-1",port:8080},{address:"backend-2",port:8080}],healthChecks:!0,connectTimeout:5e3,requests:12500,errors:25},{name:"database-cluster",type:"STATIC_DNS",hosts:[{address:"db-primary",port:5432}],healthChecks:!0,connectTimeout:3e3,requests:8900,errors:5}],m=t.listeners||[{name:"http-listener",address:"0.0.0.0",port:80,filters:["http_connection_manager"],activeConnections:45,requests:12500},{name:"https-listener",address:"0.0.0.0",port:443,filters:["http_connection_manager","tls_inspector"],activeConnections:38,requests:9800}],v=t.routes||[{name:"api-route",match:"/api/*",cluster:"backend-cluster",priority:1,requests:8500},{name:"default-route",match:"*",cluster:"backend-cluster",priority:0,requests:4e3}],P=t.totalClusters||x.length,R=t.totalListeners||m.length,L=t.totalRoutes||v.length,E=t.totalRequests||m.reduce((s,i)=>s+(i.requests||0),0),A=t.totalErrors||x.reduce((s,i)=>s+(i.errors||0),0),[O,I]=z.useState(!1),c=s=>{q(S,{data:{...f.data,config:{...t,...s}}})},_=()=>{const s={name:"new-cluster",type:"STRICT_DNS",hosts:[{address:"localhost",port:8080}],healthChecks:!0,connectTimeout:5e3};c({clusters:[...x,s]}),I(!1)},B=s=>{c({clusters:x.filter(i=>i.name!==s)})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Envoy Proxy"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Service Proxy"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"High-performance edge and service proxy"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{variant:"outline",size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(h,{variant:"outline",size:"sm",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Admin UI"]})]})]}),e.jsx(y,{}),e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsxs(a,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Clusters"}),e.jsx(k,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:P}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"configured"})]})})]}),e.jsxs(a,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Listeners"}),e.jsx(w,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:R}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"active"})]})})]}),e.jsxs(a,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Routes"}),e.jsx(b,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(l,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:L}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"defined"})]})})]}),e.jsxs(a,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Requests"}),e.jsx(H,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsx(l,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-cyan-600 dark:text-cyan-400",children:E.toLocaleString()})})})]}),e.jsxs(a,{className:"border-l-4 border-l-red-500 bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Errors"}),e.jsx(M,{className:"h-4 w-4 text-red-500"})]})}),e.jsx(l,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:A})})})]})]}),e.jsxs(G,{defaultValue:"clusters",className:"space-y-4",children:[e.jsxs(X,{children:[e.jsxs(j,{value:"clusters",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Clusters (",x.length,")"]}),e.jsxs(j,{value:"listeners",children:[e.jsx(w,{className:"h-4 w-4 mr-2"}),"Listeners (",m.length,")"]}),e.jsxs(j,{value:"routes",children:[e.jsx(b,{className:"h-4 w-4 mr-2"}),"Routes (",v.length,")"]}),e.jsxs(j,{value:"settings",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(u,{value:"clusters",className:"space-y-4",children:e.jsxs(a,{children:[e.jsx(r,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Clusters"}),e.jsx(p,{children:"Backend service clusters"})]}),e.jsxs(h,{onClick:_,size:"sm",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Create Cluster"]})]})}),e.jsx(l,{children:e.jsx("div",{className:"space-y-4",children:x.map(s=>e.jsxs(a,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:e.jsx(k,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(n,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(o,{variant:"outline",children:s.type}),e.jsxs(o,{variant:"outline",children:[s.hosts.length," hosts"]}),s.healthChecks&&e.jsxs(o,{variant:"default",className:"bg-green-500",children:[e.jsx(K,{className:"h-3 w-3 mr-1"}),"Health Checks"]})]})]})]}),e.jsx(h,{variant:"ghost",size:"icon",onClick:()=>B(s.name),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(V,{className:"h-4 w-4"})})]})}),e.jsxs(l,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Hosts"}),s.hosts.map((i,C)=>e.jsx("div",{className:"p-2 border rounded text-sm",children:e.jsxs("span",{className:"font-mono",children:[i.address,":",i.port]})},C))]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm mt-4",children:[s.requests&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Requests:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.requests.toLocaleString()})]}),s.errors&&s.errors>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Errors:"}),e.jsx("span",{className:"ml-2 font-semibold text-red-500",children:s.errors})]}),s.connectTimeout&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Timeout:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[s.connectTimeout,"ms"]})]})]})]})]},s.name))})})]})}),e.jsx(u,{value:"listeners",className:"space-y-4",children:e.jsxs(a,{children:[e.jsxs(r,{children:[e.jsx(n,{children:"Listeners"}),e.jsx(p,{children:"Network listeners and ports"})]}),e.jsx(l,{children:e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsxs(a,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-100 dark:bg-green-900/30",children:e.jsx(w,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx(n,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs(o,{variant:"outline",className:"font-mono",children:[s.address,":",s.port]}),s.activeConnections&&e.jsxs(o,{variant:"outline",className:"bg-blue-50 dark:bg-blue-950/20 text-blue-700 dark:text-blue-300",children:[s.activeConnections," connections"]})]})]})]})}),e.jsxs(l,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Filters"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.filters.map((i,C)=>e.jsx(o,{variant:"outline",children:i},C))})]}),s.requests&&e.jsxs("div",{className:"text-sm mt-4",children:[e.jsx("span",{className:"text-muted-foreground",children:"Requests:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.requests.toLocaleString()})]})]})]},s.name))})})]})}),e.jsx(u,{value:"routes",className:"space-y-4",children:e.jsxs(a,{children:[e.jsxs(r,{children:[e.jsx(n,{children:"Routes"}),e.jsx(p,{children:"Request routing rules"})]}),e.jsx(l,{children:e.jsx("div",{className:"space-y-4",children:v.map(s=>e.jsxs(a,{className:"border-l-4 border-l-purple-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100 dark:bg-purple-900/30",children:e.jsx(b,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx(n,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(o,{variant:"outline",className:"font-mono text-xs",children:s.match}),e.jsxs(o,{variant:"outline",children:["â†’ ",s.cluster]}),s.priority!==void 0&&e.jsxs(o,{variant:"outline",children:["Priority: ",s.priority]})]})]})]})}),s.requests&&e.jsx(l,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Requests:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.requests.toLocaleString()})]})})]},s.name))})})]})}),e.jsx(u,{value:"settings",className:"space-y-4",children:e.jsxs(a,{children:[e.jsxs(r,{children:[e.jsx(n,{children:"Envoy Settings"}),e.jsx(p,{children:"Proxy configuration"})]}),e.jsxs(l,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{children:"Enable Admin Interface"}),e.jsx(g,{checked:t.enableAdminInterface??!0,onCheckedChange:s=>c({enableAdminInterface:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{children:"Enable Access Logging"}),e.jsx(g,{checked:t.enableAccessLogging??!0,onCheckedChange:s=>c({enableAccessLogging:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{children:"Enable Stats"}),e.jsx(g,{checked:t.enableStats??!0,onCheckedChange:s=>c({enableStats:s})})]}),e.jsx(y,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Admin Port"}),e.jsx(N,{type:"number",value:t.adminPort??9901,onChange:s=>c({adminPort:parseInt(s.target.value)||9901}),min:1,max:65535})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Drain Time (seconds)"}),e.jsx(N,{type:"number",value:t.drainTime??600,onChange:s=>c({drainTime:parseInt(s.target.value)||600}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Max Connections"}),e.jsx(N,{type:"number",value:t.maxConnections??1024,onChange:s=>c({maxConnections:parseInt(s.target.value)||1024}),min:1})]}),e.jsx(y,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Enable Prometheus Metrics"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Export metrics for Prometheus scraping via /stats/prometheus"})]}),e.jsx(g,{checked:t.metrics?.enabled??!0,onCheckedChange:s=>c({metrics:{...t.metrics,enabled:s,prometheusPath:t.metrics?.prometheusPath||"/stats/prometheus"}})})]}),t.metrics?.enabled!==!1&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Prometheus Stats Path"}),e.jsx(N,{type:"text",value:t.metrics?.prometheusPath??"/stats/prometheus",onChange:s=>c({metrics:{...t.metrics,prometheusPath:s.target.value||"/stats/prometheus"}}),placeholder:"/stats/prometheus"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Metrics available at: ",t.adminPort??9901,t.metrics?.prometheusPath||"/stats/prometheus"]})]})]})]})]})})]})]})})}export{ee as EnvoyConfigAdvanced};

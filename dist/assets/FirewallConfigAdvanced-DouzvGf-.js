import{u as ge,a as ve,j as e,r as v,e as Ne,l as w,S as Y,C as j,h as p,i as f,m as x,be as V,T as be,b as we,c as z,A as ye,d as Ce,f as H,k as O,a5 as Z,I as N,P as ke,ax as Re,aA as _,L as n,q as A,s as D,t as T,v as E,w as i,x as y,B as u,ai as Pe,o as Se,ah as Le}from"./index-HDGrDyRq.js";import{A as Fe,b as Ie}from"./alert-CU-OEAby.js";import{u as Ae}from"./use-toast-XAAHaGVT.js";import{R as De}from"./refresh-ccw-BUKvY8S7.js";import{S as ee}from"./shield-DzL7mY-o.js";import{C as U}from"./circle-check-big-3lbqtoL4.js";import{T as Te}from"./trending-up-CyszUFvc.js";function qe({componentId:C}){const{nodes:se,updateNode:te}=ge(),{componentMetrics:ae}=ve(),{toast:k}=Ae(),R=se.find(s=>s.id===C);if(!R)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const o=R.data.config||{},h=o.rules||[],re=o.logs||[],[P,S]=v.useState(null),[q,L]=v.useState(!1),[r,c]=v.useState({name:"",action:"allow",protocol:"tcp",enabled:!0,priority:5}),[l,d]=v.useState({}),[b,M]=v.useState(""),[F,le]=v.useState("all"),ne=ae.get(C),g=Ne.getFirewallEmulationEngine(C),[I,Q]=v.useState(null),[X,G]=v.useState([]);v.useEffect(()=>{if(g){const s=g.getStats(),t=g.getLogs(100);Q({packetsTotal:s.totalPackets,packetsAllowed:s.allowedPackets,packetsBlocked:s.blockedPackets,packetsRejected:s.rejectedPackets,activeRules:s.activeRules,totalConnections:s.totalConnections,activeConnections:s.activeConnections}),G(t.map(a=>({id:a.id,timestamp:new Date(a.timestamp).toISOString(),action:a.action,source:a.source,destination:a.destination,protocol:a.protocol,port:a.port,sourcePort:a.sourcePort,reason:a.reason||a.ruleName})))}},[g,ne]);const ie=I?.activeRules??h.length,ce=I?.activeRules??h.filter(s=>s.enabled).length,oe=I?.packetsBlocked??o.blockedConnections??0,de=I?.packetsAllowed??o.allowedConnections??0,xe=h.reduce((s,t)=>s+(t.hits||0),0),B=(X.length>0?X:re).filter(s=>{if(F!=="all"&&s.action!==F)return!1;if(b){const t=b.toLowerCase();return s.source.toLowerCase().includes(t)||s.destination.toLowerCase().includes(t)||s.protocol.toLowerCase().includes(t)||s.reason&&s.reason.toLowerCase().includes(t)}return!0}),J=h.filter(s=>{if(b){const t=b.toLowerCase();return s.name.toLowerCase().includes(t)||s.protocol.toLowerCase().includes(t)||s.source&&s.source.toLowerCase().includes(t)||s.destination&&s.destination.toLowerCase().includes(t)}return!0}),m=s=>{te(C,{data:{...R.data,config:{...o,...s}}}),g&&g.initializeConfig(R)},ue=s=>{const t={};return(!s.name||s.name.trim().length===0)&&(t.name="Rule name is required"),s.priority!==void 0&&(s.priority<1||s.priority>1e3)&&(t.priority="Priority must be between 1 and 1000"),(s.protocol==="tcp"||s.protocol==="udp")&&(s.port!==void 0&&(s.port<1||s.port>65535)&&(t.port="Port must be between 1 and 65535"),s.sourcePort!==void 0&&(s.sourcePort<1||s.sourcePort>65535)&&(t.sourcePort="Source port must be between 1 and 65535")),s.source&&!K(s.source)&&(t.source="Invalid IP address or CIDR notation"),s.destination&&!K(s.destination)&&(t.destination="Invalid IP address or CIDR notation"),t},K=s=>/^(\d{1,3}\.){3}\d{1,3}(\/\d{1,2})?$/.test(s),he=()=>{const s=ue(r);if(Object.keys(s).length>0){d(s);return}if(P){const t=h.map(a=>a.id===P?{...a,...r}:a);m({rules:t}),k({title:"Rule updated",description:`Rule "${r.name}" has been updated successfully.`})}else{const t={id:`rule-${Date.now()}`,name:r.name||"New Rule",action:r.action||"allow",protocol:r.protocol||"tcp",source:r.source,destination:r.destination,port:r.port,sourcePort:r.sourcePort,enabled:r.enabled??!0,priority:r.priority||5,hits:0};m({rules:[...h,t]}),k({title:"Rule created",description:`Rule "${t.name}" has been created successfully.`})}c({name:"",action:"allow",protocol:"tcp",enabled:!0,priority:5}),d({}),S(null),L(!1)},me=s=>{c({...s}),S(s.id),d({}),L(!0)},W=()=>{c({name:"",action:"allow",protocol:"tcp",enabled:!0,priority:5}),d({}),S(null),L(!1)},je=s=>{const t=h.find(a=>a.id===s);t&&window.confirm(`Are you sure you want to delete rule "${t.name}"?`)&&(m({rules:h.filter(a=>a.id!==s)}),k({title:"Rule deleted",description:`Rule "${t.name}" has been deleted.`}))},pe=s=>{const t=h.map(a=>a.id===s?{...a,enabled:!a.enabled}:a);m({rules:t})},fe=()=>{if(g){const s=g.getStats(),t=g.getLogs(100);Q({packetsTotal:s.totalPackets,packetsAllowed:s.allowedPackets,packetsBlocked:s.blockedPackets,packetsRejected:s.rejectedPackets,activeRules:s.activeRules,totalConnections:s.totalConnections,activeConnections:s.activeConnections}),G(t.map(a=>({id:a.id,timestamp:new Date(a.timestamp).toISOString(),action:a.action,source:a.source,destination:a.destination,protocol:a.protocol,port:a.port,sourcePort:a.sourcePort,reason:a.reason||a.ruleName}))),k({title:"Refreshed",description:"Firewall statistics and logs have been refreshed."})}},$=s=>{switch(s){case"allow":case"allowed":return"bg-green-500";case"deny":case"blocked":return"bg-red-500";case"reject":case"rejected":return"bg-orange-500";default:return"bg-gray-500"}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Firewall"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Network Firewall"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Network security and traffic filtering"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(w,{variant:"outline",size:"sm",onClick:fe,children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(Y,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(j,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(p,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{className:"text-sm font-medium text-muted-foreground",children:"Rules"}),e.jsx(ee,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:ce}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/ ",ie," total"]})]})})]}),e.jsxs(j,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(p,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{className:"text-sm font-medium text-muted-foreground",children:"Allowed"}),e.jsx(U,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:de.toLocaleString()}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"packets"})]})})]}),e.jsxs(j,{className:"border-l-4 border-l-red-500 bg-card",children:[e.jsx(p,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{className:"text-sm font-medium text-muted-foreground",children:"Blocked"}),e.jsx(V,{className:"h-4 w-4 text-red-500"})]})}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:oe.toLocaleString()}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"packets"})]})})]}),e.jsxs(j,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(p,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{className:"text-sm font-medium text-muted-foreground",children:"Total Hits"}),e.jsx(Te,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(x,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:xe.toLocaleString()})})})]})]}),e.jsxs(be,{defaultValue:"rules",className:"space-y-4",children:[e.jsxs(we,{children:[e.jsxs(z,{value:"rules",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Rules (",h.length,")"]}),e.jsxs(z,{value:"logs",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Logs (",B.length,")"]}),e.jsxs(z,{value:"settings",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(H,{value:"rules",className:"space-y-4",children:e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(f,{children:"Firewall Rules"}),e.jsx(O,{children:"Network traffic filtering rules"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(N,{placeholder:"Search rules...",value:b,onChange:s=>M(s.target.value),className:"pl-8 w-64"})]}),!q&&e.jsxs(w,{onClick:()=>{c({name:"",action:"allow",protocol:"tcp",enabled:!0,priority:5}),d({}),S(null),L(!0)},children:[e.jsx(ke,{className:"h-4 w-4 mr-2"}),"Create Rule"]})]})]})}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-4",children:[q&&e.jsxs(j,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(p,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(f,{children:P?"Edit Rule":"Create New Rule"}),e.jsx(w,{variant:"ghost",size:"icon",onClick:W,children:e.jsx(Re,{className:"h-4 w-4"})})]})}),e.jsxs(x,{className:"space-y-4",children:[Object.keys(l).length>0&&e.jsxs(Fe,{variant:"destructive",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx(Ie,{children:Object.values(l).filter(Boolean).join(", ")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"rule-name",children:"Rule Name *"}),e.jsx(N,{id:"rule-name",value:r.name||"",onChange:s=>{c({...r,name:s.target.value}),l.name&&d({...l,name:""})},placeholder:"Allow HTTP Traffic",className:l.name?"border-destructive":""}),l.name&&e.jsx("p",{className:"text-xs text-destructive",children:l.name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"rule-action",children:"Action *"}),e.jsxs(A,{value:r.action,onValueChange:s=>{c({...r,action:s})},children:[e.jsx(D,{children:e.jsx(T,{})}),e.jsxs(E,{children:[e.jsx(i,{value:"allow",children:"Allow"}),e.jsx(i,{value:"deny",children:"Deny"}),e.jsx(i,{value:"reject",children:"Reject"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"rule-protocol",children:"Protocol *"}),e.jsxs(A,{value:r.protocol,onValueChange:s=>{c({...r,protocol:s})},children:[e.jsx(D,{children:e.jsx(T,{})}),e.jsxs(E,{children:[e.jsx(i,{value:"tcp",children:"TCP"}),e.jsx(i,{value:"udp",children:"UDP"}),e.jsx(i,{value:"icmp",children:"ICMP"}),e.jsx(i,{value:"all",children:"All"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"rule-source",children:"Source IP/CIDR"}),e.jsx(N,{id:"rule-source",value:r.source||"",onChange:s=>{c({...r,source:s.target.value}),l.source&&d({...l,source:""})},placeholder:"192.168.1.0/24",className:l.source?"border-destructive":""}),l.source&&e.jsx("p",{className:"text-xs text-destructive",children:l.source})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"rule-destination",children:"Destination IP/CIDR"}),e.jsx(N,{id:"rule-destination",value:r.destination||"",onChange:s=>{c({...r,destination:s.target.value}),l.destination&&d({...l,destination:""})},placeholder:"10.0.0.0/8",className:l.destination?"border-destructive":""}),l.destination&&e.jsx("p",{className:"text-xs text-destructive",children:l.destination})]})]}),(r.protocol==="tcp"||r.protocol==="udp")&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"rule-port",children:"Destination Port"}),e.jsx(N,{id:"rule-port",type:"number",min:"1",max:"65535",value:r.port||"",onChange:s=>{const t=s.target.value?parseInt(s.target.value):void 0;c({...r,port:t}),l.port&&d({...l,port:""})},placeholder:"80",className:l.port?"border-destructive":""}),l.port&&e.jsx("p",{className:"text-xs text-destructive",children:l.port})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"rule-source-port",children:"Source Port"}),e.jsx(N,{id:"rule-source-port",type:"number",min:"1",max:"65535",value:r.sourcePort||"",onChange:s=>{const t=s.target.value?parseInt(s.target.value):void 0;c({...r,sourcePort:t}),l.sourcePort&&d({...l,sourcePort:""})},placeholder:"1024",className:l.sourcePort?"border-destructive":""}),l.sourcePort&&e.jsx("p",{className:"text-xs text-destructive",children:l.sourcePort})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"rule-priority",children:"Priority (1-1000) *"}),e.jsx(N,{id:"rule-priority",type:"number",min:"1",max:"1000",value:r.priority||5,onChange:s=>{const t=parseInt(s.target.value)||5;c({...r,priority:t}),l.priority&&d({...l,priority:""})},className:l.priority?"border-destructive":""}),l.priority&&e.jsx("p",{className:"text-xs text-destructive",children:l.priority}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Higher priority = evaluated first"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-8",children:[e.jsx(y,{id:"rule-enabled",checked:r.enabled??!0,onCheckedChange:s=>{c({...r,enabled:s})}}),e.jsx(n,{htmlFor:"rule-enabled",children:"Enabled"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(w,{variant:"outline",onClick:W,children:"Cancel"}),e.jsx(w,{onClick:he,children:P?"Update Rule":"Create Rule"})]})]})]}),J.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:b?"No rules match your search":"No rules configured. Create your first rule to get started."}):J.map(s=>e.jsxs(j,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(p,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg ${$(s.action)}/20`,children:s.action==="allow"?e.jsx(U,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(V,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(f,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[e.jsx(u,{variant:"outline",className:$(s.action),children:s.action.toUpperCase()}),e.jsx(u,{variant:"outline",children:s.protocol.toUpperCase()}),s.port&&e.jsxs(u,{variant:"outline",children:["Port: ",s.port]}),s.sourcePort&&e.jsxs(u,{variant:"outline",children:["Src Port: ",s.sourcePort]}),e.jsxs(u,{variant:"outline",children:["Priority: ",s.priority]}),s.hits!==void 0&&e.jsxs(u,{variant:"outline",className:"bg-purple-50 dark:bg-purple-950/20 text-purple-700 dark:text-purple-300",children:[s.hits," hits"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{variant:"ghost",size:"icon",onClick:()=>me(s),children:e.jsx(Pe,{className:"h-4 w-4"})}),e.jsx(y,{checked:s.enabled,onCheckedChange:()=>pe(s.id)}),e.jsx(w,{variant:"ghost",size:"icon",onClick:()=>je(s.id),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(Se,{className:"h-4 w-4"})})]})]})}),e.jsx(x,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.source&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Source:"}),e.jsx("span",{className:"ml-2 font-mono font-semibold",children:s.source})]}),s.destination&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Destination:"}),e.jsx("span",{className:"ml-2 font-mono font-semibold",children:s.destination})]})]})})]},s.id))]})})]})}),e.jsx(H,{value:"logs",className:"space-y-4",children:e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(f,{children:"Firewall Logs"}),e.jsx(O,{children:"Traffic filtering activity logs"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Z,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(N,{placeholder:"Search logs...",value:b,onChange:s=>M(s.target.value),className:"pl-8 w-64"})]}),e.jsxs(A,{value:F,onValueChange:s=>le(s),children:[e.jsxs(D,{className:"w-40",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),e.jsx(T,{})]}),e.jsxs(E,{children:[e.jsx(i,{value:"all",children:"All Actions"}),e.jsx(i,{value:"allowed",children:"Allowed"}),e.jsx(i,{value:"blocked",children:"Blocked"}),e.jsx(i,{value:"rejected",children:"Rejected"})]})]})]})]})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:B.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:b||F!=="all"?"No logs match your filters":"No logs available"}):B.map(s=>e.jsxs(j,{className:`border-l-4 ${s.action==="allowed"?"border-l-green-500 bg-card":"border-l-red-500 bg-card"} hover:shadow-md transition-shadow`,children:[e.jsx(p,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${$(s.action)}/20`,children:s.action==="allowed"?e.jsx(U,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(V,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(f,{className:"text-lg font-semibold capitalize",children:s.action}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[e.jsx(u,{variant:"outline",className:"font-mono text-xs",children:s.source}),e.jsx("span",{children:"â†’"}),e.jsx(u,{variant:"outline",className:"font-mono text-xs",children:s.destination}),e.jsx(u,{variant:"outline",children:s.protocol.toUpperCase()}),s.port&&e.jsxs(u,{variant:"outline",children:["Port: ",s.port]}),s.sourcePort&&e.jsxs(u,{variant:"outline",children:["Src Port: ",s.sourcePort]})]})]})]})}),s.reason&&e.jsx(x,{children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx(_,{className:"h-4 w-4 inline mr-1"}),s.reason]})}),e.jsx(x,{children:e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(s.timestamp).toLocaleString()})})]},s.id))})})]})}),e.jsx(H,{value:"settings",className:"space-y-4",children:e.jsxs(j,{children:[e.jsxs(p,{children:[e.jsx(f,{children:"Firewall Settings"}),e.jsx(O,{children:"Security configuration"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(n,{children:"Enable Firewall"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable or disable firewall functionality"})]}),e.jsx(y,{checked:o.enableFirewall??!0,onCheckedChange:s=>m({enableFirewall:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(n,{children:"Enable Logging"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Log all firewall events"})]}),e.jsx(y,{checked:o.enableLogging??!0,onCheckedChange:s=>m({enableLogging:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(n,{children:"Enable Intrusion Detection"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Detect and prevent intrusion attempts"})]}),e.jsx(y,{checked:o.enableIntrusionDetection??!1,onCheckedChange:s=>m({enableIntrusionDetection:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(n,{children:"Stateful Inspection"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Track connection state for better security"})]}),e.jsx(y,{checked:o.enableStatefulInspection??!0,onCheckedChange:s=>m({enableStatefulInspection:s})})]}),e.jsx(Y,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Default Policy"}),e.jsxs(A,{value:o.defaultPolicy??"deny",onValueChange:s=>m({defaultPolicy:s}),children:[e.jsx(D,{children:e.jsx(T,{})}),e.jsxs(E,{children:[e.jsx(i,{value:"allow",children:"Allow All"}),e.jsx(i,{value:"deny",children:"Deny All"}),e.jsx(i,{value:"reject",children:"Reject All"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Action for packets that don't match any rule"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Log Retention (days)"}),e.jsx(N,{type:"number",value:o.logRetention??30,onChange:s=>m({logRetention:parseInt(s.target.value)||30}),min:1,max:365}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How long to keep firewall logs"})]})]})]})})]})]})})}export{qe as FirewallConfigAdvanced};

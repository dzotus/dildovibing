import{u as Ns,j as e,r as u,e as v,B as S,S as Re,C as d,h as o,i as m,m as r,T as vs,b as fs,c as z,a3 as Be,aj as ys,d as bs,f as $,k as E,l as j,P as U,o as ve,L as x,I as y,q as G,s as Y,t as X,v as Z,w as k,ak as Cs,a5 as He,a4 as ws,af as _e}from"./index-Car91T5O.js";import{P as fe}from"./progress-BAABHvBK.js";import{T as ks}from"./textarea-Cgvn3GTT.js";import{D as Le}from"./database-0M_zUzYF.js";import{T as Ge}from"./table-DfcOZuWL.js";import{C as Ss}from"./code-B9C-Pjha.js";import{R as Es}from"./refresh-ccw-BcN9ARyd.js";import{H as Ye}from"./hard-drive-B0KiQaAd.js";import{P as Xe}from"./pencil-Bc_TQlmQ.js";function Is({componentId:N}){const{nodes:J,connections:ye,updateNode:Ze}=Ns(),D=J.find(s=>s.id===N);if(!D)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const F=D.data.config||{},Je=F.clusterName||"archiphoenix-cluster",b=F.nodes||[],C=F.keyspaces||[{name:"system",replication:3,replicationStrategy:"NetworkTopologyStrategy",tables:0,size:0,durableWrites:!0}],W=F.tables||[],be=F.queries||[],[ze,$e]=u.useState(null),[es,A]=u.useState(!1),[ss,ee]=u.useState(!1),[se,Ce]=u.useState(""),[ae,we]=u.useState(C[0]?.name||"system"),[V,M]=u.useState(""),q=F.consistencyLevel||"QUORUM",Fe=F.replicationFactor||3,[Ae,O]=u.useState(!1),[B,te]=u.useState(null),[c,w]=u.useState({address:"localhost:9042",status:"up",load:0,tokens:256,datacenter:"dc1",rack:"rack1"}),[Ts,Rs]=u.useState(null),[as,ts]=u.useState(null),[ls,le]=u.useState(!1),[ns,ne]=u.useState(!1),[P,ie]=u.useState(null),[I,ce]=u.useState(null),[re,de]=u.useState(""),[oe,me]=u.useState(""),[xe,he]=u.useState(""),[H,ue]=u.useState([]),[ke,je]=u.useState(""),[p,Ve]=u.useState(null),[is,Me]=u.useState([]),[cs,Ke]=u.useState([]),[rs,De]=u.useState([]),[Ie,pe]=u.useState(C),[Oe,ge]=u.useState(W),[Pe,Qe]=u.useState(b);u.useEffect(()=>{if(!D)return;const s=setInterval(()=>{const a=v.getCassandraRoutingEngine(N);if(a){const t=a.getMetrics(),l=a.getKeyspaces(),n=a.getTables(),i=a.getNodes();Ve({readLatency:t.readLatency,writeLatency:t.writeLatency,totalNodes:t.totalNodes,healthyNodes:t.healthyNodes,totalKeyspaces:t.totalKeyspaces,totalTables:t.totalTables,totalRows:t.totalRows,totalSize:t.totalSize}),Qe(i);const g=new Map(C.map(f=>[f.name,f])),h=l.map(f=>{const Q=g.get(f.name);return{...f,size:Q?.size??f.size??0,tables:n.filter(gs=>gs.keyspace===f.name).length}});pe(h);const R=new Map(W.map(f=>[`${f.keyspace}.${f.name}`,f])),L=n.map(f=>{const Q=R.get(`${f.keyspace}.${f.name}`);return{...f,...Q&&{columns:Q.columns}}});ge(L);const Te=a.getAllNodeMetrics(),Ne=a.getAllKeyspaceMetrics(),K=a.getAllTableMetrics();Me(Te),Ke(Ne),De(K)}else Ve(null),pe(C),ge(W),Qe(b),Me([]),Ke([]),De([])},500);return()=>clearInterval(s)},[N,D,C,W]);const ds=p?.totalSize?p.totalSize/(1024*1024*1024):F.totalSize||C.reduce((s,a)=>s+a.size,0),_=p&&(p.readOperationsPerSecond>0||p.totalRows>0)?p.readLatency:null,Ue=p&&(p.writeOperationsPerSecond>0||p.totalRows>0)?p.writeLatency:null,Se=Ie.length>0?Ie:C,We=Oe.length>0?Oe:W,Ee=Pe.length>0?Pe:b,T=s=>{Ze(N,{data:{...D.data,config:{...F,...s}}})},os=()=>{T({keyspaces:[...C,{name:"new_keyspace",replication:Fe,tables:0,size:0}]})},ms=s=>{T({keyspaces:C.filter((a,t)=>t!==s)})},qe=(s,a,t)=>{const l=[...C];l[s]={...l[s],[a]:t},T({keyspaces:l})},xs=()=>{if(!c.address)return;const s={address:c.address,status:c.status||"up",load:c.load??0,tokens:c.tokens||256,datacenter:c.datacenter||"dc1",rack:c.rack||"rack1"};T({nodes:[...b,s]}),w({address:`localhost:${9042+b.length+1}`,status:"up",load:0,tokens:256,datacenter:"dc1",rack:"rack1"}),O(!1)},hs=s=>{if(b.length<=1){alert("Cannot remove the last node. At least one node is required.");return}confirm(`Are you sure you want to remove node ${b[s].address}?`)&&T({nodes:b.filter((a,t)=>t!==s)})},us=s=>{const a=b[s];w({address:a.address,status:a.status,load:a.load,tokens:a.tokens,datacenter:a.datacenter||"dc1",rack:a.rack||"rack1",tokenValues:a.tokenValues}),te(s),O(!1)},js=()=>{if(B===null||!c.address)return;const s={address:c.address,status:c.status||"up",load:c.load??b[B]?.load??0,tokens:c.tokens||256,datacenter:c.datacenter||"dc1",rack:c.rack||"rack1",tokenValues:c.tokenValues},a=[...b];a[B]=s,T({nodes:a}),w({address:`localhost:${9042+b.length+1}`,status:"up",load:0,tokens:256,datacenter:"dc1",rack:"rack1"}),te(null),O(!1)},ps=()=>{if(!V.trim())return;const s=`query-${Date.now()}`,a=Date.now(),t={id:s,query:V,status:"running",duration:0,rowsReturned:0},l=v.getCassandraRoutingEngine(N);let n=t;if(l)try{const i=l.executeCQL(V,q),g=Date.now()-a;if(n={id:s,query:V,status:i.success?"success":"error",duration:g,rowsReturned:i.rowCount||0},i.success){const h=V.trim().toUpperCase();if(h.startsWith("CREATE TABLE")||h.startsWith("CREATE KEYSPACE")||h.startsWith("DROP TABLE")||h.startsWith("DROP KEYSPACE")){const R=l.getKeyspaces(),L=l.getTables(),Te=new Map(C.map(K=>[K.name,K])),Ne=R.map(K=>{const f=Te.get(K.name);return{...K,size:f?.size||K.size||0,tables:L.filter(Q=>Q.keyspace===K.name).length}});T({keyspaces:Ne,tables:L}),pe(Ne),ge(L)}}}catch{const g=Date.now()-a;n={id:s,query:V,status:"error",duration:g,rowsReturned:0}}else n.status="success",n.duration=Date.now()-a;T({queries:[n,...be.slice(0,9)]}),M(""),A(!1)};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(Le,{className:"h-6 w-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Apache Cassandra"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Distributed NoSQL Database"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(S,{variant:"outline",className:"gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full animate-pulse ${p&&p.healthyNodes>0&&p.healthyNodes===p.totalNodes?"bg-green-500":p&&p.healthyNodes>0?"bg-yellow-500":"bg-red-500"}`}),p&&p.totalNodes>0?`Cluster ${p.healthyNodes===p.totalNodes?"Healthy":"Degraded"}`:"Cluster Not Initialized"]})})]}),e.jsx(Re,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Nodes"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p?.totalNodes??Ee.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Cluster nodes"})]})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Keyspaces"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p?.totalKeyspaces??C.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Total keyspaces"})]})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Read Latency"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:_!==null?`${_}ms`:"—"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:_!==null?"Average":"No activity"})]})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium text-muted-foreground",children:"Data Size"})}),e.jsxs(r,{children:[e.jsx("div",{className:"text-2xl font-bold",children:ds.toFixed(1)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"GB"})]})]})]}),e.jsxs(vs,{defaultValue:"keyspaces",className:"w-full",children:[e.jsxs(fs,{className:"flex w-full flex-wrap gap-1",children:[e.jsxs(z,{value:"keyspaces",className:"gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),"Keyspaces"]}),e.jsxs(z,{value:"tables",className:"gap-2",children:[e.jsx(Ge,{className:"h-4 w-4"}),"Tables"]}),e.jsxs(z,{value:"cql",className:"gap-2",children:[e.jsx(Ss,{className:"h-4 w-4"}),"CQL Shell"]}),e.jsxs(z,{value:"cluster",className:"gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),"Cluster"]}),e.jsxs(z,{value:"gossip",className:"gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),"Gossip"]}),e.jsxs(z,{value:"repair",className:"gap-2",children:[e.jsx(Es,{className:"h-4 w-4"}),"Repair"]}),e.jsxs(z,{value:"compaction",className:"gap-2",children:[e.jsx(Ye,{className:"h-4 w-4"}),"Compaction"]}),e.jsxs(z,{value:"hints",className:"gap-2",children:[e.jsx(ys,{className:"h-4 w-4"}),"Hints"]}),e.jsxs(z,{value:"storage",className:"gap-2",children:[e.jsx(Ye,{className:"h-4 w-4"}),"Storage"]}),e.jsxs(z,{value:"settings",className:"gap-2",children:[e.jsx(bs,{className:"h-4 w-4"}),"Settings"]})]}),e.jsx($,{value:"keyspaces",className:"space-y-4 mt-4",children:e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Keyspaces"}),e.jsx(E,{children:"Cassandra keyspace configuration"})]}),e.jsxs(j,{size:"sm",onClick:os,variant:"outline",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Create Keyspace"]})]})}),e.jsx(r,{children:e.jsx("div",{className:"space-y-3",children:Se.map((s,a)=>{const t=cs.find(l=>l.name===s.name);return e.jsxs(d,{className:"border-border",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(Le,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(m,{className:"text-lg",children:s.name}),e.jsxs(E,{className:"text-xs mt-1",children:[t?.totalTables??s.tables," tables • Replication: ",s.replication," • Size: ",t?(t.totalSize/(1024*1024*1024)).toFixed(2):s.size," GB",s.replicationStrategy&&` • ${s.replicationStrategy}`]})]})]}),Se.length>1&&e.jsx(j,{size:"icon",variant:"ghost",onClick:()=>ms(a),children:e.jsx(ve,{className:"h-4 w-4"})})]})}),ze===a&&e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Replication Factor"}),e.jsx(y,{type:"number",value:s.replication,onChange:l=>qe(a,"replication",Number(l.target.value)),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Replication Strategy"}),e.jsxs(G,{value:s.replicationStrategy||"NetworkTopologyStrategy",onValueChange:l=>qe(a,"replicationStrategy",l),children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsxs(Z,{children:[e.jsx(k,{value:"SimpleStrategy",children:"Simple Strategy"}),e.jsx(k,{value:"NetworkTopologyStrategy",children:"Network Topology Strategy"})]})]})]})]}),e.jsx(j,{size:"sm",variant:"outline",onClick:()=>$e(null),children:"Done"})]}),ze!==a&&e.jsxs(r,{className:"space-y-3",children:[e.jsx(j,{size:"sm",variant:"outline",onClick:()=>$e(a),children:"Edit Settings"}),t&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 pt-3 border-t",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Read Latency"}),e.jsxs("div",{className:"text-sm font-semibold",children:[t.readLatency.toFixed(1),"ms"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Write Latency"}),e.jsxs("div",{className:"text-sm font-semibold",children:[t.writeLatency.toFixed(1),"ms"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Read Ops/sec"}),e.jsx("div",{className:"text-sm font-semibold",children:t.readOperationsPerSecond})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Write Ops/sec"}),e.jsx("div",{className:"text-sm font-semibold",children:t.writeOperationsPerSecond})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Rows"}),e.jsx("div",{className:"text-sm font-semibold",children:t.totalRows.toLocaleString()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Data Size"}),e.jsxs("div",{className:"text-sm font-semibold",children:[(t.totalSize/(1024*1024*1024)).toFixed(2)," GB"]})]}),(t.readConsistencyViolations>0||t.writeConsistencyViolations>0)&&e.jsxs(e.Fragment,{children:[t.readConsistencyViolations>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Read Violations"}),e.jsx("div",{className:"text-sm font-semibold text-yellow-600",children:t.readConsistencyViolations})]}),t.writeConsistencyViolations>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Write Violations"}),e.jsx("div",{className:"text-sm font-semibold text-yellow-600",children:t.writeConsistencyViolations})]})]})]})]})]},a)})})})]})}),e.jsxs($,{value:"tables",className:"space-y-4 mt-4",children:[e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Tables"}),e.jsx(E,{children:"Cassandra table configuration"})]}),e.jsxs(j,{size:"sm",variant:"outline",onClick:()=>ee(!0),children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Create Table"]})]})}),e.jsxs(r,{children:[ss&&e.jsx("div",{className:"mb-4 p-4 border border-primary rounded-lg bg-muted/50",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx("h4",{className:"text-sm font-semibold mb-2",children:"Create New Table"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Keyspace"}),e.jsxs(G,{value:ae,onValueChange:we,children:[e.jsx(Y,{children:e.jsx(X,{})}),e.jsx(Z,{children:Se.map(s=>e.jsx(k,{value:s.name,children:s.name},s.name))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Table Name"}),e.jsx(y,{value:se,onChange:s=>Ce(s.target.value),placeholder:"users"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{size:"sm",onClick:async()=>{if(!se.trim()||!ae)return;const s=`CREATE TABLE ${ae}.${se.trim()} (id UUID PRIMARY KEY, data TEXT)`;let a=v.getCassandraRoutingEngine(N);if(!a&&D&&(v.initialize(J,ye||[]),a=v.getCassandraRoutingEngine(N)),a)try{console.log("Executing CREATE TABLE:",s);const t=a.executeCQL(s,q);if(console.log("CREATE TABLE result:",t),t.success){const l=a.getKeyspaces(),n=a.getTables();console.log("Engine keyspaces:",l),console.log("Engine tables:",n);const i=new Map(C.map(h=>[h.name,h])),g=l.map(h=>{const R=i.get(h.name);return{...h,size:R?.size||0,tables:n.filter(L=>L.keyspace===h.name).length}});console.log("Merged keyspaces:",g),console.log("Merged tables:",n),T({keyspaces:g,tables:n}),pe(g),ge(n),Ce(""),we(C[0]?.name||"system"),ee(!1)}else console.error("CREATE TABLE failed:",t.error),alert(`Failed to create table: ${t.error||"Unknown error"}`)}catch(t){console.error("CREATE TABLE error:",t),alert(`Error creating table: ${t instanceof Error?t.message:"Unknown error"}`)}else console.warn("Cassandra engine not available, using CQL Shell fallback"),M(s),ee(!1),A(!0)},disabled:!se.trim()||!ae,children:"Create Table"}),e.jsx(j,{size:"sm",variant:"outline",onClick:()=>{ee(!1),Ce(""),we(C[0]?.name||"system")},children:"Cancel"})]})]})}),We.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No tables created"}):e.jsx("div",{className:"space-y-3",children:We.map((s,a)=>{const t=v.getCassandraRoutingEngine(N),l=t?t.getSecondaryIndexesForTable(s.keyspace,s.name):[],n=t?t.getMaterializedViewsForTable(s.keyspace,s.name):[],i=rs.find(h=>h.keyspace===s.keyspace&&h.name===s.name),g=as===a;return e.jsxs(d,{className:"border-border",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ge,{className:"h-4 w-4 text-primary"}),e.jsxs("div",{children:[e.jsx(m,{className:"text-lg",children:s.name}),e.jsxs(E,{className:"text-xs mt-1",children:[s.keyspace," • ",s.rows||0," rows • ",s.size?`${s.size} GB`:"N/A",s.partitionKey&&` • Partition: ${s.partitionKey.join(", ")}`,s.clusteringKey&&s.clusteringKey.length>0&&` • Clustering: ${s.clusteringKey.join(", ")}`]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(j,{size:"sm",variant:"ghost",onClick:()=>ts(g?null:a),children:g?e.jsx(Cs,{className:"h-4 w-4"}):e.jsx(He,{className:"h-4 w-4"})})})]})}),g&&e.jsxs(r,{className:"space-y-4",children:[s.columns&&s.columns.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(x,{className:"text-sm font-semibold",children:"Schema"}),e.jsxs(j,{size:"sm",variant:"outline",onClick:()=>{M(`ALTER TABLE ${s.keyspace}.${s.name} ...`),A(!0)},children:[e.jsx(Xe,{className:"h-3 w-3 mr-1"}),"Edit via CQL"]})]}),e.jsx("div",{className:"border rounded-md p-3 bg-muted/50",children:e.jsx("div",{className:"space-y-1",children:s.columns.map((h,R)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-mono",children:h.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",className:"text-xs",children:h.type}),h.primaryKey&&e.jsx(S,{variant:"default",className:"text-xs",children:"PK"})]})]},R))})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(x,{className:"text-sm font-semibold",children:["Secondary Indexes (",l.length,")"]}),e.jsxs(j,{size:"sm",variant:"outline",onClick:()=>{ie({keyspace:s.keyspace,table:s.name}),de(""),me(""),le(!0)},children:[e.jsx(U,{className:"h-3 w-3 mr-1"}),"Create Index"]})]}),l.length===0?e.jsx("p",{className:"text-xs text-muted-foreground",children:"No indexes"}):e.jsx("div",{className:"border rounded-md p-3 bg-muted/50 space-y-2",children:l.map((h,R)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ws,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"font-mono",children:h.name}),e.jsxs(S,{variant:"outline",className:"text-xs",children:["on ",h.column]})]}),e.jsx(j,{size:"sm",variant:"ghost",onClick:()=>{const L=`DROP INDEX ${h.name}`;M(L),A(!0)},children:e.jsx(ve,{className:"h-3 w-3"})})]},R))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(x,{className:"text-sm font-semibold",children:["Materialized Views (",n.length,")"]}),e.jsxs(j,{size:"sm",variant:"outline",onClick:()=>{ce({keyspace:s.keyspace,table:s.name}),he(""),ue([]),je(""),ne(!0)},children:[e.jsx(U,{className:"h-3 w-3 mr-1"}),"Create View"]})]}),n.length===0?e.jsx("p",{className:"text-xs text-muted-foreground",children:"No views"}):e.jsx("div",{className:"border rounded-md p-3 bg-muted/50 space-y-2",children:n.map((h,R)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"font-mono",children:h.name}),e.jsxs(S,{variant:"outline",className:"text-xs",children:[h.selectColumns.length," columns"]})]}),e.jsx(j,{size:"sm",variant:"ghost",onClick:()=>{const L=`DROP MATERIALIZED VIEW ${h.name}`;M(L),A(!0)},children:e.jsx(ve,{className:"h-3 w-3"})})]},R))})]}),i&&e.jsxs("div",{className:"space-y-2 pt-3 border-t",children:[e.jsx(x,{className:"text-sm font-semibold",children:"Performance Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Read Latency"}),e.jsxs("div",{className:"text-sm font-semibold",children:[i.readLatency.toFixed(1),"ms"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Write Latency"}),e.jsxs("div",{className:"text-sm font-semibold",children:[i.writeLatency.toFixed(1),"ms"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Read Ops/sec"}),e.jsx("div",{className:"text-sm font-semibold",children:i.readOperationsPerSecond})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Write Ops/sec"}),e.jsx("div",{className:"text-sm font-semibold",children:i.writeOperationsPerSecond})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Rows"}),e.jsx("div",{className:"text-sm font-semibold",children:i.rows.toLocaleString()})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Data Size"}),e.jsxs("div",{className:"text-sm font-semibold",children:[(i.size/(1024*1024*1024)).toFixed(2)," GB"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Pending Compactions"}),e.jsx("div",{className:"text-sm font-semibold",children:i.pendingCompactions})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Completed Compactions"}),e.jsx("div",{className:"text-sm font-semibold",children:i.completedCompactions})]}),(i.readConsistencyViolations>0||i.writeConsistencyViolations>0)&&e.jsxs(e.Fragment,{children:[i.readConsistencyViolations>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Read Violations"}),e.jsx("div",{className:"text-sm font-semibold text-yellow-600",children:i.readConsistencyViolations})]}),i.writeConsistencyViolations>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Write Violations"}),e.jsx("div",{className:"text-sm font-semibold text-yellow-600",children:i.writeConsistencyViolations})]})]})]})]})]})]},a)})})]})]}),ls&&P&&e.jsx("div",{className:"mt-4 p-4 border border-primary rounded-lg bg-muted/50",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-1",children:"Create Secondary Index"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["On ",P.keyspace,".",P.table]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Index Name"}),e.jsx(y,{value:re,onChange:s=>de(s.target.value),placeholder:`${P.table}_idx`})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Column Name"}),e.jsx(y,{value:oe,onChange:s=>me(s.target.value),placeholder:"column_name"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{size:"sm",onClick:async()=>{if(!re.trim()||!oe.trim())return;const s=`CREATE INDEX ${re.trim()} ON ${P.keyspace}.${P.table} (${oe.trim()})`;let a=v.getCassandraRoutingEngine(N);if(!a&&D&&(v.initialize(J,ye||[]),a=v.getCassandraRoutingEngine(N)),a)try{const t=a.executeCQL(s,q);t.success?(de(""),me(""),le(!1),ie(null)):alert(`Failed to create index: ${t.error||"Unknown error"}`)}catch(t){alert(`Error creating index: ${t instanceof Error?t.message:"Unknown error"}`)}else M(s),le(!1),ie(null),A(!0)},disabled:!re.trim()||!oe.trim(),children:"Create Index"}),e.jsx(j,{size:"sm",variant:"outline",onClick:()=>{le(!1),ie(null),de(""),me("")},children:"Cancel"})]})]})}),ns&&I&&e.jsx("div",{className:"mt-4 p-4 border border-primary rounded-lg bg-muted/50",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-1",children:"Create Materialized View"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["On ",I.keyspace,".",I.table]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"View Name"}),e.jsx(y,{value:xe,onChange:s=>he(s.target.value),placeholder:`${I.table}_view`})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"Select Columns (comma-separated)"}),e.jsx(y,{value:H.join(", "),onChange:s=>ue(s.target.value.split(",").map(a=>a.trim()).filter(a=>a)),placeholder:"id, name, email"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"WHERE Clause (optional)"}),e.jsx(y,{value:ke,onChange:s=>je(s.target.value),placeholder:"status = 'active'"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{size:"sm",onClick:async()=>{if(!xe.trim()||H.length===0)return;const s=H.join(", "),a=ke.trim()?` WHERE ${ke}`:"",t=`CREATE MATERIALIZED VIEW ${I.keyspace}.${xe.trim()} AS SELECT ${s} FROM ${I.keyspace}.${I.table}${a} PRIMARY KEY (${H[0]})`;let l=v.getCassandraRoutingEngine(N);if(!l&&D&&(v.initialize(J,ye||[]),l=v.getCassandraRoutingEngine(N)),l)try{const n=l.executeCQL(t,q);n.success?(he(""),ue([]),je(""),ne(!1),ce(null)):alert(`Failed to create view: ${n.error||"Unknown error"}`)}catch(n){alert(`Error creating view: ${n instanceof Error?n.message:"Unknown error"}`)}else M(t),ne(!1),ce(null),A(!0)},disabled:!xe.trim()||H.length===0,children:"Create View"}),e.jsx(j,{size:"sm",variant:"outline",onClick:()=>{ne(!1),ce(null),he(""),ue([]),je("")},children:"Cancel"})]})]})})]}),e.jsx($,{value:"cql",className:"space-y-4 mt-4",children:e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(m,{children:"CQL Shell"}),e.jsx(E,{children:"Execute CQL queries"})]}),e.jsxs(j,{size:"sm",onClick:()=>A(!0),variant:"outline",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"New Query"]})]})}),e.jsxs(r,{children:[es&&e.jsxs(d,{className:"mb-4 border-primary",children:[e.jsx(o,{children:e.jsx(m,{children:"Execute CQL Query"})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{children:"CQL Query"}),e.jsx(ks,{value:V,onChange:s=>M(s.target.value),placeholder:"SELECT * FROM keyspace.table LIMIT 10;",rows:6,className:"font-mono text-sm"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{onClick:ps,disabled:!V.trim(),title:V.trim()?"Execute CQL query":"Enter a CQL query to execute",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Execute"]}),e.jsx(j,{variant:"outline",onClick:()=>{A(!1),M("")},children:"Cancel"})]})]})]}),be.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No queries executed"}):e.jsx("div",{className:"space-y-2",children:be.map(s=>e.jsx(d,{className:"border-l-4 border-l-blue-500",children:e.jsx(r,{className:"pt-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(S,{variant:s.status==="success"?"default":s.status==="error"?"destructive":"secondary",children:s.status}),s.duration!==void 0&&e.jsxs(S,{variant:"outline",children:[s.duration,"ms"]}),s.rowsReturned!==void 0&&e.jsxs(S,{variant:"outline",children:[s.rowsReturned," rows"]})]}),e.jsx("pre",{className:"text-xs font-mono bg-muted p-2 rounded overflow-x-auto",children:s.query})]})})})},s.id))})]})]})}),e.jsx($,{value:"cluster",className:"space-y-4 mt-4",children:e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Cluster Nodes"}),e.jsx(E,{children:"Cassandra cluster topology"})]}),e.jsxs(j,{size:"sm",onClick:()=>{w({address:`localhost:${9042+b.length}`,status:"up",load:0,tokens:256,datacenter:"dc1",rack:"rack1"}),te(null),O(!0)},variant:"outline",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Add Node"]})]})}),e.jsx(r,{children:e.jsxs("div",{className:"space-y-3",children:[Ee.map((s,a)=>{const t=b[a],l=is.find(i=>i.address===s.address),n=B===a;return e.jsxs(d,{className:`border-border ${n?"border-blue-500":""}`,children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${s.status==="up"?"bg-green-500":"bg-red-500"}`}),e.jsx("div",{className:"flex-1",children:n?e.jsx(y,{value:c.address||"",onChange:i=>w({...c,address:i.target.value}),placeholder:"localhost:9042",className:"text-lg font-semibold"}):e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"text-lg",children:s.address}),e.jsxs(E,{className:"text-xs mt-1",children:[s.tokens," tokens • Load: ",(s.load*100).toFixed(1),"%",t?.datacenter&&` • DC: ${t.datacenter}`,t?.rack&&` • Rack: ${t.rack}`]})]})})]}),e.jsx("div",{className:"flex items-center gap-2",children:!n&&e.jsxs(e.Fragment,{children:[e.jsx(S,{variant:s.status==="up"?"default":"destructive",children:s.status.toUpperCase()}),e.jsx(j,{size:"sm",variant:"ghost",onClick:()=>us(a),title:"Edit node",children:e.jsx(Xe,{className:"h-4 w-4"})}),e.jsx(j,{size:"sm",variant:"ghost",onClick:()=>hs(a),title:"Remove node",disabled:b.length<=1,children:e.jsx(ve,{className:"h-4 w-4"})})]})})]})}),e.jsx(r,{children:n?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:`node-status-${a}`,children:"Status"}),e.jsxs(G,{value:c.status||"up",onValueChange:i=>w({...c,status:i}),children:[e.jsx(Y,{id:`node-status-${a}`,children:e.jsx(X,{})}),e.jsxs(Z,{children:[e.jsx(k,{value:"up",children:"Up"}),e.jsx(k,{value:"down",children:"Down"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:`node-tokens-${a}`,children:"Tokens"}),e.jsx(y,{id:`node-tokens-${a}`,type:"number",min:"1",value:c.tokens||256,onChange:i=>w({...c,tokens:parseInt(i.target.value)||256})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:`node-datacenter-${a}`,children:"Datacenter"}),e.jsx(y,{id:`node-datacenter-${a}`,value:c.datacenter||"dc1",onChange:i=>w({...c,datacenter:i.target.value}),placeholder:"dc1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:`node-rack-${a}`,children:"Rack"}),e.jsx(y,{id:`node-rack-${a}`,value:c.rack||"rack1",onChange:i=>w({...c,rack:i.target.value}),placeholder:"rack1"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{size:"sm",onClick:js,disabled:!c.address,children:"Save"}),e.jsx(j,{size:"sm",variant:"outline",onClick:()=>{te(null),O(!1)},children:"Cancel"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Load:"}),e.jsxs("span",{className:"font-semibold",children:[(s.load*100).toFixed(1),"%"]})]}),e.jsx(fe,{value:s.load*100,className:"h-2"})]}),l&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 pt-2 border-t",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Read Latency"}),e.jsxs("div",{className:"text-sm font-semibold",children:[l.readLatency.toFixed(1),"ms"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Write Latency"}),e.jsxs("div",{className:"text-sm font-semibold",children:[l.writeLatency.toFixed(1),"ms"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Read Ops/sec"}),e.jsx("div",{className:"text-sm font-semibold",children:l.readOperationsPerSecond})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Write Ops/sec"}),e.jsx("div",{className:"text-sm font-semibold",children:l.writeOperationsPerSecond})]}),l.readConsistencyViolations>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Read Violations"}),e.jsx("div",{className:"text-sm font-semibold text-yellow-600",children:l.readConsistencyViolations})]}),l.writeConsistencyViolations>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Write Violations"}),e.jsx("div",{className:"text-sm font-semibold text-yellow-600",children:l.writeConsistencyViolations})]})]}),t?.tokenValues&&t.tokenValues.length>0&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-2 pt-2 border-t",children:["Token values: ",t.tokenValues.slice(0,3).join(", "),t.tokenValues.length>3&&` (+${t.tokenValues.length-3} more)`]})]})})]},a)}),Ee.length===0&&!Ae&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No nodes configured. Add a node to start."}),Ae&&B===null&&e.jsxs(d,{className:"border-blue-200 dark:border-blue-800",children:[e.jsxs(o,{className:"pb-3",children:[e.jsx(m,{children:"Add Node"}),e.jsx(E,{children:"Configure new Cassandra cluster node"})]}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-node-address",children:"Address"}),e.jsx(y,{id:"new-node-address",value:c.address||"",onChange:s=>w({...c,address:s.target.value}),placeholder:"localhost:9042"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-node-status",children:"Status"}),e.jsxs(G,{value:c.status||"up",onValueChange:s=>w({...c,status:s}),children:[e.jsx(Y,{id:"new-node-status",children:e.jsx(X,{})}),e.jsxs(Z,{children:[e.jsx(k,{value:"up",children:"Up"}),e.jsx(k,{value:"down",children:"Down"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-node-tokens",children:"Tokens"}),e.jsx(y,{id:"new-node-tokens",type:"number",min:"1",value:c.tokens||256,onChange:s=>w({...c,tokens:parseInt(s.target.value)||256})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-node-datacenter",children:"Datacenter"}),e.jsx(y,{id:"new-node-datacenter",value:c.datacenter||"dc1",onChange:s=>w({...c,datacenter:s.target.value}),placeholder:"dc1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"new-node-rack",children:"Rack"}),e.jsx(y,{id:"new-node-rack",value:c.rack||"rack1",onChange:s=>w({...c,rack:s.target.value}),placeholder:"rack1"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{onClick:xs,disabled:!c.address,children:"Add Node"}),e.jsx(j,{variant:"outline",onClick:()=>{O(!1),w({address:`localhost:${9042+b.length}`,status:"up",load:0,tokens:256,datacenter:"dc1",rack:"rack1"})},children:"Cancel"})]})]})]})]})})]})}),e.jsx($,{value:"gossip",className:"space-y-4 mt-4",children:e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Gossip Protocol State"}),e.jsx(E,{children:"Node state information from gossip protocol"})]}),e.jsx(r,{children:(()=>{const s=v.getCassandraRoutingEngine(N),a=s?s.getGossipState():new Map;return a.size===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No gossip state available"}):e.jsx("div",{className:"space-y-3",children:Array.from(a.entries()).map(([t,l])=>e.jsx(d,{className:"border-border",children:e.jsxs(r,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`h-3 w-3 rounded-full ${l.status==="up"?"bg-green-500":"bg-red-500"}`}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:t}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Heartbeat: ",l.heartbeat," • Last: ",new Date(l.lastHeartbeat).toLocaleTimeString()]})]})]}),e.jsx(S,{variant:l.status==="up"?"default":"destructive",children:l.status.toUpperCase()})]}),e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["Generation: ",l.endpointState.generation," • Version: ",l.endpointState.version]})]})},t))})})()})]})}),e.jsx($,{value:"repair",className:"space-y-4 mt-4",children:e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Repair Operations"}),e.jsx(E,{children:"Anti-entropy repair status and management"})]}),e.jsxs(j,{size:"sm",variant:"outline",onClick:async()=>{const s=v.getCassandraRoutingEngine(N);if(s){const a=s.getTables();if(a.length===0){alert("No tables available for repair");return}const t=a[0],l=s.startRepair(t.keyspace,t.name);alert(l?`Repair started for ${t.keyspace}.${t.name} (Task ID: ${l})`:"Failed to start repair")}},children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Start Repair"]})]})}),e.jsx(r,{children:(()=>{const s=v.getCassandraRoutingEngine(N);if(!s)return e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"Engine not initialized"});const a=s.getRepairMetrics(),t=s.getActiveRepairTasks();return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Active Repairs"})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.activeRepairs})})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Completed"})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.completedRepairs})})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Inconsistencies Found"})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.totalInconsistenciesFound})})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Inconsistencies Fixed"})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.totalInconsistenciesFixed})})]})]}),t.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-sm font-semibold",children:"Active Repair Tasks"}),t.map(l=>e.jsx(d,{className:"border-border",children:e.jsxs(r,{className:"pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold",children:[l.keyspace,".",l.table]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Task ID: ",l.id," • Status: ",l.status]})]}),e.jsx(S,{variant:l.status==="running"?"default":"secondary",children:l.status})]}),e.jsx(fe,{value:l.progress,className:"h-2 mt-2"}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Progress: ",l.progress,"% • Token ranges: ",l.tokenRangesProcessed,"/",l.totalTokenRanges,l.inconsistenciesFound>0&&e.jsxs("span",{children:[" • Found: ",l.inconsistenciesFound," • Fixed: ",l.inconsistenciesFixed]})]})]})},l.id))]})]})})()})]})}),e.jsx($,{value:"compaction",className:"space-y-4 mt-4",children:e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Compaction Status"}),e.jsx(E,{children:"SSTable compaction metrics and tasks"})]}),e.jsx(r,{children:(()=>{const s=v.getCassandraRoutingEngine(N);if(!s)return e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"Engine not initialized"});const a=s.getCompactionMetrics(),t=s.getCompactionTasks();return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Pending"})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.pendingCompactions})})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Running"})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.runningCompactions})})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Completed"})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.completedCompactions})})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Total SSTables"})}),e.jsx(r,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.totalSSTables})})]})]}),t.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-sm font-semibold",children:"Compaction Tasks"}),t.map(l=>e.jsx(d,{className:"border-border",children:e.jsx(r,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:l.tableKey}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Strategy: ",l.strategy," • SSTables: ",l.sstables.length]})]}),e.jsx(S,{variant:l.status==="running"||l.status==="completed"?"default":"secondary",children:l.status})]})})},l.id))]})]})})()})]})}),e.jsx($,{value:"hints",className:"space-y-4 mt-4",children:e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Hinted Handoff"}),e.jsx(E,{children:"Hints for unavailable replicas"})]}),e.jsx(r,{children:(()=>{const s=v.getCassandraRoutingEngine(N);if(!s)return e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"Engine not initialized"});const a=s.getHints(),t=Date.now();return a.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No hints pending"}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm font-semibold mb-2",children:["Total Hints: ",a.length]}),a.slice(0,50).map((l,n)=>{const i=l.ttl-(t-l.timestamp),g=i<=0;return e.jsx(d,{className:`border-border ${g?"opacity-50":""}`,children:e.jsx(r,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold",children:[l.keyspace,".",l.table]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Target: ",l.targetNode," • Partition: ",l.partitionKey]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Created: ",new Date(l.timestamp).toLocaleString(),!g&&` • TTL: ${Math.floor(i/1e3)}s remaining`,g&&" • EXPIRED"]})]}),e.jsx(S,{variant:g?"destructive":"default",children:g?"Expired":"Active"})]})})},n)}),a.length>50&&e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Showing first 50 of ",a.length," hints"]})]})})()})]})}),e.jsx($,{value:"storage",className:"space-y-4 mt-4",children:e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Storage Information"}),e.jsx(E,{children:"Commit log and memtable status"})]}),e.jsx(r,{children:(()=>{const s=v.getCassandraRoutingEngine(N);if(!s)return e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"Engine not initialized"});const a=s.getCommitLogStats(),t=s.getCommitLog(20),l=s.getMemtableInfo();return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Commit Log"})}),e.jsxs(r,{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Entries:"}),e.jsx("span",{className:"font-semibold",children:a.totalEntries})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Size:"}),e.jsxs("span",{className:"font-semibold",children:[(a.totalSize/1024).toFixed(2)," KB"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Entries/sec:"}),e.jsx("span",{className:"font-semibold",children:a.entriesPerSecond})]})]})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Memtable Status"})}),e.jsxs(r,{children:[e.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Tables with memtable data: ",l.filter(n=>n.size>0).length]}),l.filter(n=>n.size>0).length>0&&e.jsx("div",{className:"space-y-1",children:l.filter(n=>n.size>0).slice(0,3).map(n=>e.jsxs("div",{className:"text-xs",children:[n.keyspace,".",n.table,": ",(n.size/1024).toFixed(2)," KB, ",n.rowCount," rows",n.needsFlush&&e.jsx(S,{variant:"destructive",className:"ml-2 text-xs",children:"Needs Flush"})]},n.tableKey))})]})]})]}),t.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{className:"text-sm font-semibold",children:"Recent Commit Log Entries"}),e.jsx("div",{className:"space-y-1 max-h-64 overflow-y-auto",children:t.map((n,i)=>e.jsxs("div",{className:"text-xs font-mono bg-muted p-2 rounded",children:["[",new Date(n.timestamp).toLocaleTimeString(),"] ",n.operation," ",n.keyspace,".",n.table,n.partitionKey&&` (PK: ${n.partitionKey})`," - ",n.size," bytes"]},i))})]})]})})()})]})}),e.jsx($,{value:"settings",className:"space-y-4 mt-4",children:e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(m,{children:"Cluster Settings"}),e.jsx(E,{children:"Cassandra cluster configuration"})]}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Read Latency"})}),e.jsxs(r,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[_,"ms"]}),e.jsx(fe,{value:Math.min(_/10*100,100),className:"h-2 mt-2"})]})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(m,{className:"text-sm font-medium",children:"Write Latency"})}),e.jsxs(r,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Ue,"ms"]}),e.jsx(fe,{value:Math.min(Ue/10*100,100),className:"h-2 mt-2"})]})]})]}),e.jsx(Re,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"cluster-name",children:"Cluster Name"}),e.jsx(y,{id:"cluster-name",value:Je,onChange:s=>T({clusterName:s.target.value}),placeholder:"my-cluster"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"replication-factor",children:"Default Replication Factor"}),e.jsx(y,{id:"replication-factor",type:"number",min:"1",max:"10",value:Fe,onChange:s=>T({replicationFactor:parseInt(s.target.value)||3})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default replication factor for new keyspaces. Can be overridden per keyspace."})]}),e.jsx(Re,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(x,{htmlFor:"default-consistency-level",children:"Default Consistency Level"}),e.jsxs(G,{value:q,onValueChange:s=>T({consistencyLevel:s}),children:[e.jsx(Y,{id:"default-consistency-level",children:e.jsx(X,{placeholder:"Select consistency level"})}),e.jsxs(Z,{children:[e.jsx(k,{value:"ONE",children:"ONE"}),e.jsx(k,{value:"TWO",children:"TWO"}),e.jsx(k,{value:"THREE",children:"THREE"}),e.jsx(k,{value:"QUORUM",children:"QUORUM"}),e.jsx(k,{value:"ALL",children:"ALL"}),e.jsx(k,{value:"LOCAL_ONE",children:"LOCAL_ONE"}),e.jsx(k,{value:"LOCAL_QUORUM",children:"LOCAL_QUORUM"}),e.jsx(k,{value:"EACH_QUORUM",children:"EACH_QUORUM"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default consistency level for CQL queries. Can be overridden per query using CONSISTENCY command or in CQL Shell."})]}),e.jsx("div",{className:"rounded-lg border border-blue-200 bg-blue-50 dark:bg-blue-950 dark:border-blue-800 p-3",children:e.jsxs("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:[e.jsx("strong",{children:"Note:"})," In real Apache Cassandra, consistency level is specified per query/session, not as a global cluster setting. This is a default value used when not explicitly specified in queries."]})})]})]})})]})]})})}export{Is as CassandraConfigAdvanced};

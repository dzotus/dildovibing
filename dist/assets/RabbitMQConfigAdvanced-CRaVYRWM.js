import{E as Qe,u as Le,j as e,r as b,B as w,i,c as oe,S as Be,T as Re,a as Ae,b as D,A as se,d as M,C as x,e as u,f as p,h as g,P as $,k as v,m as G,L as n,I as c,t as Q,n as k,o as E,p as P,q as S,s as t,l as L}from"./index-D0eJihqw.js";import{P as Ke}from"./progress-BdecdG_V.js";import{u as ze}from"./usePortValidation-D7HsmknY.js";import{v as Ve}from"./requiredFields-BLgUUVkB.js";import{s as H,a as ae}from"./toast-D1zIafiD.js";import{M as le}from"./message-square-CVoD1yx9.js";import{A as ne}from"./arrow-right-left-KpaEsqVn.js";import{K as xe}from"./key-yZvRiXek.js";import{S as he}from"./shield-D1vwDJ8j.js";import{D as Ie}from"./database-BiY_ED57.js";const Fe=[["path",{d:"M13 16a3 3 0 0 1 2.24 5",key:"1epib5"}],["path",{d:"M18 12h.01",key:"yjnet6"}],["path",{d:"M18 21h-8a4 4 0 0 1-4-4 7 7 0 0 1 7-7h.2L9.6 6.4a1 1 0 1 1 2.8-2.8L15.8 7h.2c3.3 0 6 2.7 6 6v1a2 2 0 0 1-2 2h-1a3 3 0 0 0-3 3",key:"ue9ozu"}],["path",{d:"M20 8.54V4a2 2 0 1 0-4 0v3",key:"49iql8"}],["path",{d:"M7.612 12.524a3 3 0 1 0-1.6 4.3",key:"1e33i0"}]],He=Qe("rabbit",Fe);function es({componentId:B}){const{nodes:ce,updateNode:me,connections:je}=Le(),J=ce.find(s=>s.id===B);if(!J)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const N=J.data.config||{},U=N.host||"localhost",_=N.port||5672,ue=N.username||"guest",pe=N.password||"",ge=N.vhost||"/",d=N.queues||[],y=N.exchanges||[{name:"amq.direct",type:"direct",durable:!0,autoDelete:!1,internal:!1},{name:"amq.topic",type:"topic",durable:!0,autoDelete:!1,internal:!1},{name:"amq.fanout",type:"fanout",durable:!0,autoDelete:!1,internal:!1}],R=N.bindings||[],T=N.policies||[],{portError:A,hostError:K,portConflict:z}=ze(ce,B,U,_),ie=je.some(s=>s.source===B||s.target===B),[ve,Ue]=b.useState(null),[Ne,W]=b.useState(!1),[ye,X]=b.useState(!1),[fe,Y]=b.useState(!1),[C,q]=b.useState({name:"",type:"direct"}),[h,V]=b.useState({source:y[0]?.name||"",destination:d[0]?.name||"",routingKey:""}),[m,I]=b.useState({name:"",pattern:".*",applyTo:"all"}),[be,Z]=b.useState(null),r=s=>{if(me(B,{data:{...J.data,config:{...N,...s}}}),Object.keys(s).some(a=>["host","port"].includes(a))){const a={...f};Object.keys(s).forEach(l=>{a[l]&&delete a[l]}),re(a)}},[f,re]=b.useState({}),Ce=[{field:"host",label:"Host"},{field:"port",label:"Port",validator:s=>typeof s=="number"&&s>0&&s<=65535}],te=()=>{const s=Ve({host:U,port:_},Ce);return re(s.errors),s.isValid},we=()=>{r({queues:[...d,{name:"new-queue",durable:!0,exclusive:!1,autoDelete:!1,messages:0,consumers:0,ready:0,unacked:0}]})},ke=s=>{r({queues:d.filter((a,l)=>l!==s)})},j=(s,a,l)=>{const o=[...d];o[s]={...o[s],[a]:l},r({queues:o})},Ee=()=>{if(!C.name.trim()){H("Имя exchange не может быть пустым");return}if(y.some(a=>a.name===C.name.trim())){H("Exchange с таким именем уже существует");return}const s={name:C.name.trim(),type:C.type,durable:!0,autoDelete:!1,internal:!1};r({exchanges:[...y,s]}),W(!1),q({name:"",type:"direct"}),ae("Exchange создан")},Pe=s=>{r({exchanges:y.filter((a,l)=>l!==s)})},F=(s,a,l)=>{const o=[...y];o[s]={...o[s],[a]:l},r({exchanges:o})},Se=()=>{if(!h.source||!h.destination){H("Необходимо выбрать exchange и queue");return}const s={id:`binding-${Date.now()}`,source:h.source,destination:h.destination,routingKey:h.routingKey||""};r({bindings:[...R,s]}),X(!1),V({source:y[0]?.name||"",destination:d[0]?.name||"",routingKey:""}),ae("Binding создан")},Te=s=>{r({bindings:R.filter(a=>a.id!==s)})},de=(s,a,l)=>{const o=R.map(ee=>ee.id===s?{...ee,[a]:l}:ee);r({bindings:o})},De=()=>{if(!m.name.trim()){H("Имя policy не может быть пустым");return}if(T.some(a=>a.name===m.name.trim())){H("Policy с таким именем уже существует");return}const s={name:m.name.trim(),pattern:m.pattern||".*",definition:{},priority:0,applyTo:m.applyTo};r({policies:[...T,s]}),Y(!1),I({name:"",pattern:".*",applyTo:"all"}),ae("Policy создана")},O=(s,a,l)=>{const o=[...T];o[s]={...o[s],[a]:l},r({policies:o})},Me=s=>{r({policies:T.filter((a,l)=>l!==s)})};return d.reduce((s,a)=>s+(a.messages||0),0),d.reduce((s,a)=>s+(a.consumers||0),0),e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-orange-500/10",children:e.jsx(He,{className:"h-6 w-6 text-orange-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"RabbitMQ"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Message Broker Management"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(w,{variant:"outline",className:"gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${ie?"bg-green-500 animate-pulse":"bg-gray-400"}`}),ie?"Connected":"Not Connected"]}),e.jsxs(i,{size:"sm",variant:"outline",children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),"Management UI"]})]})]}),e.jsx(Be,{}),e.jsxs(Re,{defaultValue:"queues",className:"w-full",children:[e.jsxs(Ae,{className:"grid w-full grid-cols-6",children:[e.jsxs(D,{value:"queues",className:"gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"Queues"]}),e.jsxs(D,{value:"exchanges",className:"gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),"Exchanges"]}),e.jsxs(D,{value:"bindings",className:"gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),"Bindings"]}),e.jsxs(D,{value:"policies",className:"gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),"Policies"]}),e.jsxs(D,{value:"connection",className:"gap-2",children:[e.jsx(Ie,{className:"h-4 w-4"}),"Connection"]}),e.jsxs(D,{value:"monitoring",className:"gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Monitoring"]})]}),e.jsx(M,{value:"queues",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(p,{children:"Message Queues"}),e.jsx(g,{children:"Configure and monitor RabbitMQ queues"})]}),e.jsxs(i,{size:"sm",onClick:we,variant:"outline",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Add Queue"]})]})}),e.jsx(v,{children:d.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(le,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No queues configured"}),e.jsx("p",{className:"text-xs mt-2",children:'Click "Add Queue" to create a new queue'})]}):e.jsx("div",{className:"space-y-4",children:d.map((s,a)=>e.jsxs(x,{className:"border-border",children:[e.jsx(u,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(le,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(p,{className:"text-lg",children:s.name}),e.jsxs(g,{className:"text-xs mt-1 flex items-center gap-2",children:[s.durable&&e.jsx(w,{variant:"outline",className:"text-xs",children:"Durable"}),s.exclusive&&e.jsx(w,{variant:"outline",className:"text-xs",children:"Exclusive"}),s.autoDelete&&e.jsx(w,{variant:"outline",className:"text-xs",children:"Auto-Delete"})]})]})]}),d.length>1&&e.jsx(i,{size:"icon",variant:"ghost",onClick:()=>ke(a),children:e.jsx(G,{className:"h-4 w-4"})})]})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Queue Name"}),e.jsx(c,{value:s.name,onChange:l=>j(a,"name",l.target.value),placeholder:"queue-name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Properties"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{checked:s.durable,onCheckedChange:l=>{l&&s.exclusive&&j(a,"exclusive",!1),j(a,"durable",l)},disabled:s.exclusive}),e.jsx(n,{className:"text-xs",children:"Durable"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{checked:s.exclusive,onCheckedChange:l=>{l&&j(a,"durable",!1),j(a,"exclusive",l)}}),e.jsx(n,{className:"text-xs",children:"Exclusive"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{checked:s.autoDelete,onCheckedChange:l=>j(a,"autoDelete",l)}),e.jsx(n,{className:"text-xs",children:"Auto-Delete"})]})]})]})]}),ve===a&&e.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Advanced Configuration"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Dead Letter Exchange"}),e.jsx(c,{value:s.deadLetterExchange||"",onChange:l=>j(a,"deadLetterExchange",l.target.value),placeholder:"dlx"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Dead Letter Routing Key"}),e.jsx(c,{value:s.deadLetterRoutingKey||"",onChange:l=>j(a,"deadLetterRoutingKey",l.target.value),placeholder:"routing-key"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Message TTL (ms)"}),e.jsx(c,{type:"number",value:s.messageTtl||"",onChange:l=>j(a,"messageTtl",parseInt(l.target.value)||void 0),placeholder:"60000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Max Length"}),e.jsx(c,{type:"number",value:s.maxLength||"",onChange:l=>j(a,"maxLength",parseInt(l.target.value)||void 0),placeholder:"10000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Max Priority"}),e.jsx(c,{type:"number",min:"0",max:"255",value:s.maxPriority||"",onChange:l=>j(a,"maxPriority",parseInt(l.target.value)||void 0),placeholder:"10"})]})]})]}),e.jsx("div",{className:"pt-3 border-t border-border",children:e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Messages:"}),e.jsx("span",{className:"ml-2 font-semibold",children:(s.messages||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Ready:"}),e.jsx("span",{className:"ml-2 font-semibold",children:(s.ready||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Unacked:"}),e.jsx("span",{className:"ml-2 font-semibold",children:(s.unacked||0).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Consumers:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.consumers||0})]})]})})]})]},a))})})]})}),e.jsxs(M,{value:"exchanges",className:"space-y-4 mt-4",children:[Ne&&e.jsxs(x,{className:"mb-4 border-primary",children:[e.jsxs(u,{children:[e.jsx(p,{children:"Create Exchange"}),e.jsx(g,{children:"Configure exchange settings"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Exchange Name"}),e.jsx(c,{placeholder:"my-exchange",value:C.name,onChange:s=>q({...C,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Type"}),e.jsxs(k,{value:C.type,onValueChange:s=>q({...C,type:s}),children:[e.jsx(E,{children:e.jsx(P,{})}),e.jsxs(S,{children:[e.jsx(t,{value:"direct",children:"Direct"}),e.jsx(t,{value:"topic",children:"Topic"}),e.jsx(t,{value:"fanout",children:"Fanout"}),e.jsx(t,{value:"headers",children:"Headers"})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{onClick:Ee,children:"Create Exchange"}),e.jsx(i,{variant:"outline",onClick:()=>{W(!1),q({name:"",type:"direct"})},children:"Cancel"})]})]})]}),e.jsxs(x,{children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(p,{children:"Exchanges"}),e.jsx(g,{children:"Message routing exchanges"})]}),e.jsxs(i,{size:"sm",onClick:()=>W(!0),variant:"outline",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Create Exchange"]})]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-4",children:y.map((s,a)=>e.jsxs(x,{className:"border-border",children:[e.jsx(u,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(ne,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(p,{className:"text-lg",children:s.name}),e.jsxs(g,{className:"text-xs mt-1",children:[e.jsx(w,{variant:"outline",children:s.type}),s.durable&&e.jsx(w,{variant:"outline",className:"ml-1",children:"Durable"}),s.internal&&e.jsx(w,{variant:"outline",className:"ml-1",children:"Internal"})]})]})]}),e.jsx(i,{size:"icon",variant:"ghost",onClick:()=>Pe(a),children:e.jsx(G,{className:"h-4 w-4"})})]})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Exchange Name"}),e.jsx(c,{value:s.name,onChange:l=>F(a,"name",l.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Type"}),e.jsxs(k,{value:s.type,onValueChange:l=>F(a,"type",l),children:[e.jsx(E,{children:e.jsx(P,{})}),e.jsxs(S,{children:[e.jsx(t,{value:"direct",children:"Direct"}),e.jsx(t,{value:"topic",children:"Topic"}),e.jsx(t,{value:"fanout",children:"Fanout"}),e.jsx(t,{value:"headers",children:"Headers"})]})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{checked:s.durable,onCheckedChange:l=>F(a,"durable",l)}),e.jsx(n,{className:"text-xs",children:"Durable"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{checked:s.autoDelete,onCheckedChange:l=>F(a,"autoDelete",l)}),e.jsx(n,{className:"text-xs",children:"Auto-Delete"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{checked:s.internal,onCheckedChange:l=>F(a,"internal",l)}),e.jsx(n,{className:"text-xs",children:"Internal"})]})]})]})]},a))})})]})]}),e.jsxs(M,{value:"bindings",className:"space-y-4 mt-4",children:[ye&&e.jsxs(x,{className:"mb-4 border-primary",children:[e.jsxs(u,{children:[e.jsx(p,{children:"Create Binding"}),e.jsx(g,{children:"Bind exchange to queue"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Source Exchange"}),e.jsxs(k,{value:h.source,onValueChange:s=>V({...h,source:s}),children:[e.jsx(E,{children:e.jsx(P,{placeholder:"Select exchange"})}),e.jsx(S,{children:y.map(s=>e.jsx(t,{value:s.name,children:s.name},s.name))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Destination Queue"}),e.jsxs(k,{value:h.destination,onValueChange:s=>V({...h,destination:s}),children:[e.jsx(E,{children:e.jsx(P,{placeholder:"Select queue"})}),e.jsx(S,{children:d.map(s=>e.jsx(t,{value:s.name,children:s.name},s.name))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Routing Key"}),e.jsx(c,{placeholder:"routing.key",value:h.routingKey,onChange:s=>V({...h,routingKey:s.target.value})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{onClick:Se,children:"Create Binding"}),e.jsx(i,{variant:"outline",onClick:()=>{X(!1),V({source:y[0]?.name||"",destination:d[0]?.name||"",routingKey:""})},children:"Cancel"})]})]})]}),e.jsxs(x,{children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(p,{children:"Bindings"}),e.jsx(g,{children:"Exchange to queue bindings"})]}),e.jsxs(i,{size:"sm",onClick:()=>X(!0),variant:"outline",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Create Binding"]})]})}),e.jsx(v,{children:R.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(xe,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No bindings configured"})]}):e.jsx("div",{className:"space-y-3",children:R.map(s=>e.jsx(x,{className:"p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ne,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.source}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["→ ",s.destination," • Key: ",s.routingKey||"(none)"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(k,{value:s.source,onValueChange:a=>de(s.id,"source",a),children:[e.jsx(E,{className:"w-32",children:e.jsx(P,{})}),e.jsx(S,{children:y.map(a=>e.jsx(t,{value:a.name,children:a.name},a.name))})]}),e.jsx(c,{className:"w-32",value:s.routingKey,onChange:a=>de(s.id,"routingKey",a.target.value),placeholder:"routing key"}),e.jsx(i,{size:"icon",variant:"ghost",onClick:()=>Te(s.id),children:e.jsx(G,{className:"h-4 w-4"})})]})]})},s.id))})})]})]}),e.jsxs(M,{value:"policies",className:"space-y-4 mt-4",children:[fe&&e.jsxs(x,{className:"mb-4 border-primary",children:[e.jsxs(u,{children:[e.jsx(p,{children:"Create Policy"}),e.jsx(g,{children:"Configure queue/exchange policies"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Policy Name"}),e.jsx(c,{placeholder:"ha-policy",value:m.name,onChange:s=>I({...m,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Pattern"}),e.jsx(c,{placeholder:".*",value:m.pattern,onChange:s=>I({...m,pattern:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Apply To"}),e.jsxs(k,{value:m.applyTo,onValueChange:s=>I({...m,applyTo:s}),children:[e.jsx(E,{children:e.jsx(P,{})}),e.jsxs(S,{children:[e.jsx(t,{value:"queues",children:"Queues"}),e.jsx(t,{value:"exchanges",children:"Exchanges"}),e.jsx(t,{value:"all",children:"All"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{onClick:De,children:"Create Policy"}),e.jsx(i,{variant:"outline",onClick:()=>{Y(!1),I({name:"",pattern:".*",applyTo:"all"})},children:"Cancel"})]})]})]}),e.jsxs(x,{children:[e.jsx(u,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(p,{children:"Policies"}),e.jsx(g,{children:"Queue and exchange policies"})]}),e.jsxs(i,{size:"sm",onClick:()=>Y(!0),variant:"outline",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"Create Policy"]})]})}),e.jsx(v,{children:T.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(he,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No policies configured"})]}):e.jsx("div",{className:"space-y-3",children:T.map((s,a)=>e.jsx(x,{className:"p-3",children:be===a?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Policy Name"}),e.jsx(c,{value:s.name,onChange:l=>O(a,"name",l.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Pattern"}),e.jsx(c,{value:s.pattern,onChange:l=>O(a,"pattern",l.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Apply To"}),e.jsxs(k,{value:s.applyTo,onValueChange:l=>O(a,"applyTo",l),children:[e.jsx(E,{children:e.jsx(P,{})}),e.jsxs(S,{children:[e.jsx(t,{value:"queues",children:"Queues"}),e.jsx(t,{value:"exchanges",children:"Exchanges"}),e.jsx(t,{value:"all",children:"All"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Priority"}),e.jsx(c,{type:"number",value:s.priority,onChange:l=>O(a,"priority",parseInt(l.target.value)||0)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{size:"sm",onClick:()=>Z(null),children:"Save"}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>Z(null),children:"Cancel"})]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:s.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Pattern: ",s.pattern," • Apply to: ",s.applyTo," • Priority: ",s.priority]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{size:"icon",variant:"ghost",onClick:()=>Z(a),children:e.jsx(oe,{className:"h-4 w-4"})}),e.jsx(i,{size:"icon",variant:"ghost",onClick:()=>Me(a),children:e.jsx(G,{className:"h-4 w-4"})})]})]})},a))})})]})]}),e.jsx(M,{value:"connection",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsxs(u,{children:[e.jsx(p,{children:"Connection Settings"}),e.jsx(g,{children:"RabbitMQ server connection details"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{htmlFor:"host",children:["Host ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsx(c,{id:"host",value:U,onChange:s=>{r({host:s.target.value}),f.host&&te()},onBlur:te,placeholder:"localhost",className:K||f.host?"border-destructive":""}),K&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsx("span",{children:K})]}),!K&&f.host&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsx("span",{children:f.host})]}),!K&&f.host&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsx("span",{children:f.host})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"port",children:"Port"}),e.jsx(c,{id:"port",type:"number",value:_,onChange:s=>r({port:parseInt(s.target.value)||5672}),placeholder:"5672",className:A||z.hasConflict?"border-destructive":""}),A&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsx("span",{children:A})]}),!A&&!f.port&&z.hasConflict&&z.conflictingNode&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-amber-600 dark:text-amber-400",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsxs("span",{children:['Конфликт порта: компонент "',z.conflictingNode.data.label||z.conflictingNode.type,'" уже использует ',U,":",_]})]}),!A&&f.port&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-destructive",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsx("span",{children:f.port})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"username",children:"Username"}),e.jsx(c,{id:"username",value:ue,onChange:s=>r({username:s.target.value}),placeholder:"guest"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"password",children:"Password"}),e.jsx(c,{id:"password",type:"password",value:pe,onChange:s=>r({password:s.target.value}),placeholder:"password"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"vhost",children:"Virtual Host"}),e.jsx(c,{id:"vhost",value:ge,onChange:s=>r({vhost:s.target.value}),placeholder:"/"})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Параметры подключения сохраняются автоматически при изменении. Эти настройки используются для симуляции работы RabbitMQ брокера."})})]})]})}),e.jsx(M,{value:"monitoring",className:"space-y-4 mt-4",children:e.jsxs(x,{children:[e.jsxs(u,{children:[e.jsx(p,{children:"Queue Monitoring"}),e.jsx(g,{children:"Real-time queue statistics and metrics"})]}),e.jsxs(v,{children:[d.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(se,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"Нет очередей для мониторинга"}),e.jsx("p",{className:"text-xs mt-2",children:'Создайте очереди во вкладке "Queues" для отслеживания метрик'})]}):e.jsx("div",{className:"space-y-4",children:d.map((s,a)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"font-semibold",children:s.name}),e.jsxs(w,{variant:"secondary",children:[s.messages||0," messages"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Ready Messages"}),e.jsx("span",{className:"font-semibold",children:(s.ready||0).toLocaleString()})]}),e.jsx(Ke,{value:s.messages?(s.ready||0)/s.messages*100:0,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Unacked Messages"}),e.jsx("span",{className:"font-semibold",children:(s.unacked||0).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Consumers"}),e.jsx("span",{className:"font-semibold",children:s.consumers||0})]})]})]},a))}),e.jsxs("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg border border-border",children:[e.jsxs("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Как проверить мониторинг"]}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Запустите симуляцию (кнопка Play в панели управления)"}),e.jsx("li",{children:"Подключите компоненты к RabbitMQ через connections"}),e.jsx("li",{children:"Метрики обновляются автоматически во время симуляции"}),e.jsx("li",{children:"Обратите внимание на значения Ready, Unacked и Consumers"}),e.jsx("li",{children:"Если очередь растет (Ready увеличивается), проверьте количество Consumers"}),e.jsx("li",{children:"Unacked показывает сообщения в обработке у consumers"})]})]})]})]})})]})]})})}export{es as RabbitMQConfigAdvanced};

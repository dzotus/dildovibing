import{u as Z,j as e,r as I,i as N,S as R,C as l,e as c,f as d,k as x,R as k,T as ee,a as se,b as f,A as ae,c as te,d as y,h as w,P as T,B as o,m as L,L as m,I as b,n as A,o as O,p as q,q as E,s as p,X as ne,l as re,t as P}from"./index-DLY56EcE.js";import{R as le}from"./refresh-ccw-CIIwm2k8.js";import{T as S}from"./trending-up-B0BoZP1t.js";import{C as U}from"./circle-check-big-B_f8k0M8.js";import{S as H}from"./server-dBT74kKC.js";import{S as ie}from"./shield-DkBueQ2J.js";function ge({componentId:B}){const{nodes:z,updateNode:F}=Z(),C=z.find(s=>s.id===B);if(!C)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const r=C.data.config||{},v=r.frontends||[{id:"1",name:"http_frontend",bind:"0.0.0.0:80",mode:"http",backends:["web_backend"],requests:125e3,responses:124500}],i=r.backends||[{id:"1",name:"web_backend",mode:"http",balance:"roundrobin",servers:[{id:"1",name:"web1",address:"192.168.1.10",port:8080,weight:100,check:!0,status:"up",sessions:45,bytesIn:1024e3,bytesOut:2048e3,errors:0},{id:"2",name:"web2",address:"192.168.1.11",port:8080,weight:100,check:!0,status:"up",sessions:38,bytesIn:89e4,bytesOut:178e4,errors:0}],healthCheck:{enabled:!0,interval:2e3,timeout:1e3,path:"/health"}}],M=r.totalRequests||v.reduce((s,a)=>s+(a.requests||0),0),V=r.totalResponses||v.reduce((s,a)=>s+(a.responses||0),0),D=r.activeConnections||i.reduce((s,a)=>s+a.servers.reduce((t,n)=>t+(n.sessions||0),0),0),_=r.totalBytesIn||i.reduce((s,a)=>s+a.servers.reduce((t,n)=>t+(n.bytesIn||0),0),0),$=r.totalBytesOut||i.reduce((s,a)=>s+a.servers.reduce((t,n)=>t+(n.bytesOut||0),0),0),[ce,de]=I.useState(null),[xe,K]=I.useState(!1),h=s=>{F(B,{data:{...C.data,config:{...r,...s}}})},X=()=>{const s={id:`backend-${Date.now()}`,name:"new-backend",mode:"http",balance:"roundrobin",servers:[],healthCheck:{enabled:!0,interval:2e3,timeout:1e3,path:"/health"}};h({backends:[...i,s]}),K(!1)},G=s=>{h({backends:i.filter(a=>a.id!==s)})},j=(s,a,t)=>{const n=i.map(u=>u.id===s?{...u,[a]:t}:u);h({backends:n})},W=s=>{const a=i.find(n=>n.id===s);if(!a)return;const t={id:`server-${Date.now()}`,name:"new-server",address:"192.168.1.100",port:8080,weight:100,check:!0,status:"up",sessions:0,bytesIn:0,bytesOut:0,errors:0};j(s,"servers",[...a.servers,t])},J=(s,a)=>{const t=i.find(n=>n.id===s);t&&j(s,"servers",t.servers.filter(n=>n.id!==a))},Q=(s,a,t,n)=>{const u=i.find(g=>g.id===s);if(!u)return;const Y=u.servers.map(g=>g.id===a?{...g,[t]:n}:g);j(s,"servers",Y)};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"HAProxy"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Load Balancer"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"High-performance load balancer and proxy server"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(N,{variant:"outline",size:"sm",children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Refresh Stats"]})})]}),e.jsx(R,{}),e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsxs(l,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Requests"}),e.jsx(S,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(x,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:M.toLocaleString()})})})]}),e.jsxs(l,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Responses"}),e.jsx(U,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(x,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:V.toLocaleString()})})})]}),e.jsxs(l,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Connections"}),e.jsx(k,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsx(x,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-2xl font-bold text-cyan-600 dark:text-cyan-400",children:D})})})]}),e.jsxs(l,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Bytes In"}),e.jsx(S,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:(_/1024/1024).toFixed(1)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"MB"})]})})]}),e.jsxs(l,{className:"border-l-4 border-l-orange-500 bg-card",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{className:"text-sm font-medium text-muted-foreground",children:"Bytes Out"}),e.jsx(S,{className:"h-4 w-4 text-orange-500"})]})}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:($/1024/1024).toFixed(1)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"MB"})]})})]})]}),e.jsxs(ee,{defaultValue:"backends",className:"space-y-4",children:[e.jsxs(se,{children:[e.jsxs(f,{value:"backends",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Backends (",i.length,")"]}),e.jsxs(f,{value:"frontends",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Frontends (",v.length,")"]}),e.jsxs(f,{value:"stats",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Statistics"]}),e.jsxs(f,{value:"settings",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(y,{value:"backends",className:"space-y-4",children:e.jsxs(l,{children:[e.jsx(c,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Backends"}),e.jsx(w,{children:"Configure backend server pools"})]}),e.jsxs(N,{onClick:X,size:"sm",children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Create Backend"]})]})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:i.map(s=>e.jsxs(l,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(c,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/30",children:e.jsx(H,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(d,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(o,{variant:"outline",children:s.mode.toUpperCase()}),e.jsx(o,{variant:"outline",children:s.balance}),e.jsxs(o,{variant:"outline",className:"bg-green-50 dark:bg-green-950/20 text-green-700 dark:text-green-300",children:[s.servers.length," servers"]}),e.jsxs(o,{variant:"outline",className:"bg-green-50 dark:bg-green-950/20 text-green-700 dark:text-green-300",children:[s.servers.filter(a=>a.status==="up").length," up"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(N,{size:"sm",variant:"outline",onClick:()=>W(s.id),children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Add Server"]}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>G(s.id),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(L,{className:"h-4 w-4"})})]})]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Backend Name"}),e.jsx(b,{value:s.name,onChange:a=>j(s.id,"name",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Mode"}),e.jsxs(A,{value:s.mode,onValueChange:a=>j(s.id,"mode",a),children:[e.jsx(O,{children:e.jsx(q,{})}),e.jsxs(E,{children:[e.jsx(p,{value:"http",children:"HTTP"}),e.jsx(p,{value:"tcp",children:"TCP"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Balance Algorithm"}),e.jsxs(A,{value:s.balance,onValueChange:a=>j(s.id,"balance",a),children:[e.jsx(O,{children:e.jsx(q,{})}),e.jsxs(E,{children:[e.jsx(p,{value:"roundrobin",children:"Round Robin"}),e.jsx(p,{value:"leastconn",children:"Least Connections"}),e.jsx(p,{value:"source",children:"Source"}),e.jsx(p,{value:"uri",children:"URI"})]})]})]})]}),e.jsx(R,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Servers"}),e.jsx("div",{className:"space-y-2",children:s.servers.map(a=>e.jsx(l,{className:"p-3 border-l-2 border-l-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1.5 rounded ${a.status==="up"?"bg-green-100 dark:bg-green-900/30":a.status==="down"?"bg-red-100 dark:bg-red-900/30":"bg-gray-100 dark:bg-gray-900/30"}`,children:a.status==="up"?e.jsx(U,{className:"h-4 w-4 text-green-600 dark:text-green-400"}):a.status==="down"?e.jsx(ne,{className:"h-4 w-4 text-red-600 dark:text-red-400"}):e.jsx(re,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:a.name}),e.jsxs(o,{variant:"outline",className:"text-xs",children:[a.address,":",a.port]}),e.jsx(o,{variant:a.status==="up"?"default":"destructive",children:a.status})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground mt-1",children:[e.jsxs("span",{children:["Weight: ",a.weight]}),e.jsxs("span",{children:["Sessions: ",a.sessions||0]}),a.errors&&a.errors>0&&e.jsxs("span",{className:"text-red-500",children:["Errors: ",a.errors]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{type:"number",value:a.weight||100,onChange:t=>Q(s.id,a.id,"weight",Number(t.target.value)),className:"w-20",min:1,max:256}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>J(s.id,a.id),className:"hover:bg-destructive/10 hover:text-destructive",children:e.jsx(L,{className:"h-4 w-4"})})]})]})},a.id))})]})]})]},s.id))})})]})}),e.jsx(y,{value:"frontends",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Frontends"}),e.jsx(w,{children:"Configure frontend listeners"})]}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:v.map(s=>e.jsxs(l,{className:"border-l-4 border-l-purple-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(c,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100 dark:bg-purple-900/30",children:e.jsx(k,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx(d,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(o,{variant:"outline",children:s.bind}),e.jsx(o,{variant:"outline",children:s.mode.toUpperCase()}),s.ssl&&e.jsxs(o,{variant:"default",className:"bg-green-500",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),"SSL"]})]})]})]})})}),e.jsx(x,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Requests:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.requests?.toLocaleString()||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Responses:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.responses?.toLocaleString()||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Backends:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.backends.length})]})]})})]},s.id))})})]})}),e.jsx(y,{value:"stats",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Real-time Statistics"}),e.jsx(w,{children:"Live server and connection statistics"})]}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:i.map(s=>e.jsxs(l,{className:"border-l-4 border-l-blue-500",children:[e.jsx(c,{className:"pb-3",children:e.jsx(d,{className:"text-base",children:s.name})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-2",children:s.servers.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(o,{variant:a.status==="up"?"default":"destructive",children:a.status}),e.jsx("span",{className:"font-medium",children:a.name}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.address,":",a.port]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Sessions: ",a.sessions||0]}),e.jsxs("span",{children:["In: ",(a.bytesIn||0)/1024," KB"]}),e.jsxs("span",{children:["Out: ",(a.bytesOut||0)/1024," KB"]}),a.errors&&a.errors>0&&e.jsxs("span",{className:"text-red-500",children:["Errors: ",a.errors]})]})]},a.id))})})]},s.id))})})]})}),e.jsx(y,{value:"settings",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"HAProxy Settings"}),e.jsx(w,{children:"Global configuration"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{children:"Enable Stats UI"}),e.jsx(P,{checked:r.enableStatsUI??!0,onCheckedChange:s=>h({enableStatsUI:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{children:"Enable Logging"}),e.jsx(P,{checked:r.enableLogging??!0,onCheckedChange:s=>h({enableLogging:s})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Max Connections"}),e.jsx(b,{type:"number",value:r.maxConnections??4096,onChange:s=>h({maxConnections:parseInt(s.target.value)||4096}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Timeout Connect (ms)"}),e.jsx(b,{type:"number",value:r.timeoutConnect??5e3,onChange:s=>h({timeoutConnect:parseInt(s.target.value)||5e3}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Timeout Server (ms)"}),e.jsx(b,{type:"number",value:r.timeoutServer??5e4,onChange:s=>h({timeoutServer:parseInt(s.target.value)||5e4}),min:1})]})]})]})})]})]})})}export{ge as HAProxyConfigAdvanced};

import{u as O,a as V,j as e,e as q,r as g,B as E,S as z,T as K,b as Q,c as N,A as W,d as X,f as b,C as i,h as l,i as o,k as d,m as j,L as Y,I as Z}from"./index-D3yNmt2J.js";import{P as _}from"./progress-C5wuyoJE.js";import{G as S}from"./git-branch-FLyvgkhv.js";function re({componentId:m}){const{nodes:M,updateNode:A}=O(),{isRunning:x}=V(),v=M.find(s=>s.id===m);if(!v)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const T=v.data.config||{},J=T.serverUrl||"http://jaeger:16686",n=q.getJaegerEmulationEngine(m),[L,w]=g.useState([]),[$,y]=g.useState([]),[p,C]=g.useState({totalTraces:0,errorRate:0,avgTraceDuration:0});g.useEffect(()=>{if(!n){w([]),y([]),C({totalTraces:0,errorRate:0,avgTraceDuration:0});return}const s=()=>{const r=n.getRecentTraces(20),f=r.map(a=>{const h=a.spans.find(H=>!H.parentSpanId)||a.spans[0],G=a.duration/1e3;new Date(a.startTime/1e3).toISOString();const P=k(a.startTime/1e3);return{id:a.traceId,service:h?.serviceName||"unknown",operation:h?.operationName||"unknown",duration:Math.round(G),spans:a.spanCount,status:a.hasErrors?"error":"success",timestamp:P}});w(f);const c=n.getServiceStats().map(a=>({name:a.name,traces:a.tracesTotal,errors:a.errorsTotal,avgDuration:Math.round(a.avgDuration/1e3)}));y(c),n.getJaegerMetrics(),n.calculateLoad();const t=r.length,U=r.filter(a=>a.hasErrors).length,B=t>0?U/t*100:0,F=r.length>0?r.reduce((a,h)=>a+h.duration/1e3,0)/r.length:0;C({totalTraces:t,errorRate:B,avgTraceDuration:Math.round(F)})};if(s(),x){const r=setInterval(s,2e3);return()=>clearInterval(r)}},[n,x,m]);const R=L,D=$;p.totalTraces,p.errorRate,p.avgTraceDuration;function k(s){const f=Date.now()-s,u=Math.floor(f/1e3),c=Math.floor(u/60),t=Math.floor(c/60);return u<60?`${u}s ago`:c<60?`${c}m ago`:t<24?`${t}h ago`:`${Math.floor(t/24)}d ago`}const I=s=>{A(m,{data:{...v.data,config:{...T,...s}}})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(S,{className:"h-6 w-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Jaeger"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Distributed Tracing System"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(E,{variant:"outline",className:"gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${x?"bg-green-500 animate-pulse":"bg-gray-400"}`}),x?"Running":"Stopped"]})})]}),e.jsx(z,{}),e.jsxs(K,{defaultValue:"traces",className:"w-full",children:[e.jsxs(Q,{className:"grid w-full grid-cols-3",children:[e.jsxs(N,{value:"traces",className:"gap-2",children:[e.jsx(S,{className:"h-4 w-4"}),"Traces"]}),e.jsxs(N,{value:"services",className:"gap-2",children:[e.jsx(W,{className:"h-4 w-4"}),"Services"]}),e.jsxs(N,{value:"settings",className:"gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Settings"]})]}),e.jsx(b,{value:"traces",className:"space-y-4 mt-4",children:e.jsxs(i,{children:[e.jsxs(l,{children:[e.jsx(o,{children:"Recent Traces"}),e.jsx(d,{children:"Distributed trace information"})]}),e.jsx(j,{children:R.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{className:"text-sm",children:"No traces available"}),e.jsx("p",{className:"text-xs mt-1",children:"Traces will appear here when simulation is running"})]}):e.jsx("div",{className:"space-y-3",children:R.map(s=>e.jsx(i,{className:"border-border",children:e.jsx(l,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(S,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(o,{className:"text-lg",children:s.operation}),e.jsxs(d,{className:"text-xs mt-1",children:["Service: ",s.service," • ",s.spans," spans • ",s.duration,"ms • ",s.timestamp]})]})]}),e.jsx(E,{variant:s.status==="success"?"default":"destructive",children:s.status})]})})},s.id))})})]})}),e.jsx(b,{value:"services",className:"space-y-4 mt-4",children:e.jsxs(i,{children:[e.jsxs(l,{children:[e.jsx(o,{children:"Services"}),e.jsx(d,{children:"Service trace statistics"})]}),e.jsx(j,{children:D.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{className:"text-sm",children:"No services available"}),e.jsx("p",{className:"text-xs mt-1",children:"Service statistics will appear here when traces are collected"})]}):e.jsx("div",{className:"space-y-3",children:D.map(s=>e.jsxs(i,{className:"border-border",children:[e.jsx(l,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(o,{className:"text-lg",children:s.name}),e.jsxs(d,{className:"text-xs mt-1",children:[s.traces," traces • ",s.errors," errors • Avg: ",s.avgDuration,"ms"]})]})})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Error Rate"}),e.jsxs("span",{className:"font-semibold",children:[(s.errors/s.traces*100).toFixed(1),"%"]})]}),e.jsx(_,{value:s.errors/s.traces*100,className:"h-2"})]})})]},s.name))})})]})}),e.jsx(b,{value:"settings",className:"space-y-4 mt-4",children:e.jsxs(i,{children:[e.jsxs(l,{children:[e.jsx(o,{children:"Jaeger Server"}),e.jsx(d,{children:"Server configuration"})]}),e.jsx(j,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"server-url",children:"Server URL"}),e.jsx(Z,{id:"server-url",value:J,onChange:s=>I({serverUrl:s.target.value}),placeholder:"http://jaeger:16686"})]})})]})})]})]})})}export{re as JaegerConfigAdvanced};

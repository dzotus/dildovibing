import{J as we,u as _e,a as Le,j as e,r as S,e as ce,B as Pe,l as j,d as ee,S as R,C as p,h as v,i as g,m as x,T as ze,b as $e,c as k,W as Re,Z as Me,A as Ue,f as w,k as b,L as i,I as h,P as M,o as U,q as Te,s as Ze,t as Ee,v as Ge,w as E,x as T}from"./index-0yVPR4Zl.js";import{T as Fe}from"./textarea-DDJx7dm7.js";import{P as le}from"./progress-DepjVIQE.js";import{u as Ae}from"./use-toast-DdQFI8JU.js";import{G as We}from"./globe-D2_F5mO6.js";import{S as qe}from"./server-Cy6MGcPl.js";import{A as ne}from"./arrow-right-left-C9XDOGkn.js";import{S as Xe}from"./shield-BjxQad9w.js";const He=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],Be=we("gauge",He);function De(n){let r=`# NGINX Configuration
`;if(r+=`# Generated from structured settings

`,n.upstreams&&n.upstreams.length>0){r+=`# Upstream blocks
`;for(const d of n.upstreams){r+=`upstream ${d.name} {
`,d.method&&d.method!=="round-robin"&&(r+=`    ${d.method};
`),d.keepalive&&(r+=`    keepalive ${d.keepalive};
`);for(const N of d.servers||[]){let f=`    server ${N.address}`;N.weight&&N.weight!==1&&(f+=` weight=${N.weight}`),N.maxFails&&(f+=` max_fails=${N.maxFails}`),N.failTimeout&&(f+=` fail_timeout=${N.failTimeout}`),N.backup&&(f+=" backup"),N.down&&(f+=" down"),f+=";",r+=`    ${f}
`}r+=`}

`}}if(n.rateLimitZones&&n.rateLimitZones.length>0){r+=`# Rate limit zones
`;for(const d of n.rateLimitZones)r+=`limit_req_zone $binary_remote_addr zone=${d.name}:${d.size} rate=${d.rate};
`;r+=`
`}if(r+=`server {
`,n.enableSSL){if(r+=`    listen ${n.sslPort} ssl;
`,n.sslCertificates&&n.sslCertificates.length>0){const d=n.sslCertificates[0];r+=`    ssl_certificate ${d.certPath};
`,r+=`    ssl_certificate_key ${d.keyPath};
`}}else r+=`    listen ${n.port};
`;if(r+=`    server_name ${n.serverName};

`,n.enableGzip&&(r+=`    gzip on;
`,r+=`    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

`),n.enableCache&&(r+=`    proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=60m use_temp_path=off;

`),n.locations&&n.locations.length>0)for(const d of n.locations)r+=`    location ${d.path} {
`,d.rateLimit&&(r+=`        limit_req zone=${d.rateLimit.zone} rate=${d.rateLimit.rate}`,d.rateLimit.burst&&(r+=` burst=${d.rateLimit.burst}`),d.rateLimit.nodelay&&(r+=" nodelay"),r+=`;
`),d.method==="proxy"&&d.proxyPass?(r+=`        proxy_pass ${d.proxyPass};
`,r+=`        proxy_set_header Host $host;
`,r+=`        proxy_set_header X-Real-IP $remote_addr;
`,r+=`        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
`,r+=`        proxy_set_header X-Forwarded-Proto $scheme;
`):d.method==="static"&&(r+=`        root /usr/share/nginx/html;
`,r+=`        try_files $uri $uri/ =404;
`),d.cache?.enabled&&(r+=`        proxy_cache my_cache;
`,r+=`        proxy_cache_valid ${d.cache.valid||"200 1h"};
`),r+=`    }

`;else r+=`    location / {
`,n.upstreams&&n.upstreams.length>0?r+=`        proxy_pass http://${n.upstreams[0].name};
`:r+=`        proxy_pass http://backend:8080;
`,r+=`        proxy_set_header Host $host;
`,r+=`        proxy_set_header X-Real-IP $remote_addr;
`,r+=`    }

`;return r+=`}
`,r}function ss({componentId:n}){const{nodes:r,updateNode:d,connections:N}=_e(),{getComponentMetrics:f,isRunning:de}=Le(),{toast:y}=Ae(),z=r.find(s=>s.id===n);if(!z)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const l=f(n),oe=N.some(s=>s.source===n||s.target===n),se=de&&oe&&l&&(l.throughput>0||l.utilization>0),c=z.data.config||{},G=c.port||80,ae=c.serverName||"localhost",F=c.maxWorkers||4,me=c.config||`server {
  listen 80;
  server_name localhost;

  location / {
    proxy_pass http://backend:8080;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
  }
}`,_=c.locations||[{path:"/",proxyPass:"http://backend:8080",method:"proxy"},{path:"/api",proxyPass:"http://api:3000",method:"proxy"}],C=c.upstreams||[{name:"backend",servers:[{address:"backend1:8080",weight:1},{address:"backend2:8080",weight:1},{address:"backend3:8080",weight:2}],method:"round-robin",keepalive:32}],$=c.sslCertificates||[{name:"default",certPath:"/etc/nginx/ssl/cert.pem",keyPath:"/etc/nginx/ssl/key.pem",domain:"example.com"}],L=c.rateLimitZones||[{name:"api_limit",size:"10m",rate:"10r/s"},{name:"login_limit",size:"5m",rate:"5r/m"}],Z=c.enableSSL??!1,te=c.sslPort||443,re=c.enableGzip??!0,ie=c.enableCache??!0;c.requestsPerSecond,c.activeConnections;const[he,A]=S.useState(!1),[xe,W]=S.useState(!1),[je,q]=S.useState(!1),[X,ue]=S.useState(null),[H,B]=S.useState(""),[D,I]=S.useState(""),[V,K]=S.useState("");S.useEffect(()=>{if(z){const s=ce.getNginxRoutingEngine(n);s&&s.initialize({locations:c.locations||[],upstreams:c.upstreams||[],rateLimitZones:c.rateLimitZones||[],sslCertificates:c.sslCertificates||[],enableSSL:c.enableSSL,sslPort:c.sslPort,enableGzip:c.enableGzip,enableCache:c.enableCache,maxWorkers:c.maxWorkers})}},[c,n,z]);const m=s=>{d(n,{data:{...z.data,config:{...c,...s}}})},pe=()=>{m({locations:[..._,{path:"/new-path",proxyPass:"http://service:8080",method:"proxy"}]})},ve=s=>{m({locations:_.filter((a,t)=>t!==s)})},J=(s,a,t)=>{const o=[..._];o[s]={...o[s],[a]:t},m({locations:o})},ge=()=>{if(!H.trim()){y({title:"Error",description:"Upstream name is required",variant:"destructive"});return}const s={name:H.trim(),servers:[{address:"server1:8080",weight:1}],method:"round-robin"};m({upstreams:[...C,s]}),A(!1),B(""),y({title:"Success",description:`Upstream "${s.name}" added`})},Ne=s=>{m({upstreams:C.filter((a,t)=>t!==s)})},O=(s,a,t)=>{const o=[...C];o[s]={...o[s],[a]:t},m({upstreams:o})},fe=s=>{const a=[...C];a[s].servers||(a[s].servers=[]),a[s].servers=[...a[s].servers,{address:"server:8080",weight:1}],m({upstreams:a})},be=(s,a)=>{const t=[...C];t[s].servers=t[s].servers.filter((o,u)=>u!==a),m({upstreams:t})},P=(s,a,t,o)=>{const u=[...C];u[s].servers[a]={...u[s].servers[a],[t]:o},m({upstreams:u})},ye=()=>{if(!D.trim()){y({title:"Error",description:"Certificate name is required",variant:"destructive"});return}const s={name:D.trim(),certPath:"/etc/nginx/ssl/cert.pem",keyPath:"/etc/nginx/ssl/key.pem",domain:"example.com"};m({sslCertificates:[...$,s]}),W(!1),I(""),y({title:"Success",description:`SSL certificate "${s.name}" added`})},Ce=s=>{m({sslCertificates:$.filter((a,t)=>t!==s)})},Q=(s,a,t)=>{const o=[...$];o[s]={...o[s],[a]:t},m({sslCertificates:o})},Se=()=>{if(!V.trim()){y({title:"Error",description:"Zone name is required",variant:"destructive"});return}const s={name:V.trim(),size:"10m",rate:"10r/s"};m({rateLimitZones:[...L,s]}),q(!1),K(""),y({title:"Success",description:`Rate limit zone "${s.name}" added`})},ke=s=>{m({rateLimitZones:L.filter((a,t)=>t!==s)})},Y=(s,a,t)=>{const o=[...L];o[s]={...o[s],[a]:t},m({rateLimitZones:o})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-500/10",children:e.jsx(We,{className:"h-6 w-6 text-green-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"NGINX"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Web Server & Reverse Proxy"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Pe,{variant:"outline",className:"gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${se?"bg-green-500 animate-pulse":"bg-gray-400"}`}),se?"Running":"Idle"]}),e.jsxs(j,{size:"sm",variant:"outline",onClick:()=>{const s=ce.getNginxRoutingEngine(n);s&&(s.initialize({locations:c.locations||[],upstreams:c.upstreams||[],rateLimitZones:c.rateLimitZones||[],sslCertificates:c.sslCertificates||[],enableSSL:c.enableSSL,sslPort:c.sslPort,enableGzip:c.enableGzip,enableCache:c.enableCache,maxWorkers:c.maxWorkers}),y({title:"Success",description:"NGINX configuration reloaded"}))},children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Reload Config"]})]})]}),e.jsx(R,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(p,{children:[e.jsx(v,{className:"pb-3",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Throughput"})}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l?Math.round(l.throughput):"0"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"req/s"})]})]}),e.jsxs(p,{children:[e.jsx(v,{className:"pb-3",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Latency"})}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l?Math.round(l.latency):"0"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"ms (avg)"})]})]}),e.jsxs(p,{children:[e.jsx(v,{className:"pb-3",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Cache Hit Rate"})}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l?.customMetrics?.cache_hit_rate?`${Math.round(l.customMetrics.cache_hit_rate*100)}%`:"0%"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[l?.customMetrics?.cache_hits||0," hits / ",l?.customMetrics?.cache_misses||0," misses"]})]})]}),e.jsxs(p,{children:[e.jsx(v,{className:"pb-3",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Utilization"})}),e.jsxs(x,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[l?Math.round(l.utilization*100):"0","%"]}),e.jsx(le,{value:l?l.utilization*100:0,className:"mt-2"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(p,{children:[e.jsx(v,{className:"pb-3",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"SSL"})}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Z?"Enabled":"Disabled"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"TLS/SSL status"})]})]}),e.jsxs(p,{children:[e.jsx(v,{className:"pb-3",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Workers"})}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:F}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Worker processes"})]})]}),e.jsxs(p,{children:[e.jsx(v,{className:"pb-3",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Locations"})}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:_.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Configured"})]})]}),e.jsxs(p,{children:[e.jsx(v,{className:"pb-3",children:e.jsx(g,{className:"text-sm font-medium text-muted-foreground",children:"Port"})}),e.jsxs(x,{children:[e.jsx("div",{className:"text-2xl font-bold",children:G}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Listening port"})]})]})]}),e.jsxs(ze,{defaultValue:"server",className:"w-full",children:[e.jsxs($e,{className:"grid w-full grid-cols-8",children:[e.jsxs(k,{value:"server",className:"gap-2",children:[e.jsx(qe,{className:"h-4 w-4"}),"Server"]}),e.jsxs(k,{value:"upstreams",className:"gap-2",children:[e.jsx(Re,{className:"h-4 w-4"}),"Upstreams"]}),e.jsxs(k,{value:"locations",className:"gap-2",children:[e.jsx(ne,{className:"h-4 w-4"}),"Locations"]}),e.jsxs(k,{value:"ssl",className:"gap-2",children:[e.jsx(Xe,{className:"h-4 w-4"}),"SSL/TLS"]}),e.jsxs(k,{value:"rate-limiting",className:"gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),"Rate Limit"]}),e.jsxs(k,{value:"performance",className:"gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),"Performance"]}),e.jsxs(k,{value:"metrics",className:"gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Metrics"]}),e.jsxs(k,{value:"config",className:"gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Config"]})]}),e.jsx(w,{value:"server",className:"space-y-4 mt-4",children:e.jsxs(p,{children:[e.jsxs(v,{children:[e.jsx(g,{children:"Server Configuration"}),e.jsx(b,{children:"Basic server settings"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"port",children:"Port"}),e.jsx(h,{id:"port",type:"number",value:G,onChange:s=>m({port:parseInt(s.target.value)||80}),placeholder:"80"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"server-name",children:"Server Name"}),e.jsx(h,{id:"server-name",value:ae,onChange:s=>m({serverName:s.target.value}),placeholder:"localhost"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"max-workers",children:"Worker Processes"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{id:"max-workers",type:"number",min:"1",value:F,onChange:s=>m({maxWorkers:parseInt(s.target.value)||4}),placeholder:"4"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"processes"})]})]})]})]})}),e.jsx(w,{value:"upstreams",className:"space-y-4 mt-4",children:e.jsxs(p,{children:[e.jsxs(v,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Upstream Servers"}),e.jsx(b,{children:"Configure load balancing backends"})]}),e.jsxs(j,{size:"sm",onClick:()=>A(!0),variant:"outline",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Add Upstream"]})]}),he&&e.jsx(x,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Upstream Name"}),e.jsx(h,{placeholder:"backend",value:H,onChange:s=>B(s.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{onClick:ge,children:"Create Upstream"}),e.jsx(j,{variant:"outline",onClick:()=>{A(!1),B("")},children:"Cancel"})]})]})}),e.jsx(x,{className:"space-y-4",children:C.map((s,a)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold font-mono",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.servers.length," server(s) • Method: ",s.method||"round-robin"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>ue(X===a?null:a),children:X===a?"Hide":"Edit"}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>Ne(a),children:e.jsx(U,{className:"h-4 w-4"})})]})]}),X===a&&e.jsxs("div",{className:"space-y-4 pt-3 border-t",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Upstream Name"}),e.jsx(h,{value:s.name,onChange:t=>O(a,"name",t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Load Balancing Method"}),e.jsxs(Te,{value:s.method||"round-robin",onValueChange:t=>O(a,"method",t),children:[e.jsx(Ze,{children:e.jsx(Ee,{})}),e.jsxs(Ge,{children:[e.jsx(E,{value:"round-robin",children:"Round Robin"}),e.jsx(E,{value:"least_conn",children:"Least Connections"}),e.jsx(E,{value:"ip_hash",children:"IP Hash"}),e.jsx(E,{value:"hash",children:"Hash"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Servers"}),e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>fe(a),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Add Server"]})]}),e.jsx("div",{className:"space-y-2",children:s.servers.map((t,o)=>e.jsx("div",{className:"p-3 border rounded bg-muted/50 space-y-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-2 flex-1",children:[e.jsx(h,{value:t.address,onChange:u=>P(a,o,"address",u.target.value),placeholder:"server:8080"}),e.jsx(h,{type:"number",value:t.weight||1,onChange:u=>P(a,o,"weight",parseInt(u.target.value)||1),placeholder:"Weight"}),e.jsx(h,{type:"number",value:t.maxFails||3,onChange:u=>P(a,o,"maxFails",parseInt(u.target.value)||3),placeholder:"Max Fails"}),e.jsx(h,{value:t.failTimeout||"10s",onChange:u=>P(a,o,"failTimeout",u.target.value),placeholder:"Fail Timeout"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{checked:t.backup||!1,onCheckedChange:u=>P(a,o,"backup",u)}),e.jsx(i,{className:"text-xs",children:"Backup"}),e.jsx(T,{checked:t.down||!1,onCheckedChange:u=>P(a,o,"down",u)}),e.jsx(i,{className:"text-xs",children:"Down"}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>be(a,o),children:e.jsx(U,{className:"h-3 w-3"})})]})]})},o))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Keepalive Connections"}),e.jsx(h,{type:"number",value:s.keepalive||32,onChange:t=>O(a,"keepalive",parseInt(t.target.value)||32),placeholder:"32"})]})]})]},a))})]})}),e.jsx(w,{value:"locations",className:"space-y-4 mt-4",children:e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Location Blocks"}),e.jsx(b,{children:"Configure routing and proxying"})]}),e.jsxs(j,{size:"sm",onClick:pe,variant:"outline",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Add Location"]})]})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:_.map((s,a)=>e.jsxs(p,{className:"border-border",children:[e.jsx(v,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(ne,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx(g,{className:"text-lg",children:s.path}),e.jsxs(b,{className:"text-xs mt-1",children:[s.method," → ",s.proxyPass]})]})]}),_.length>1&&e.jsx(j,{size:"icon",variant:"ghost",onClick:()=>ve(a),children:e.jsx(U,{className:"h-4 w-4"})})]})}),e.jsxs(x,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Path"}),e.jsx(h,{value:s.path,onChange:t=>J(a,"path",t.target.value),placeholder:"/"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Method"}),e.jsx(h,{value:s.method,onChange:t=>J(a,"method",t.target.value),placeholder:"proxy"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Proxy Pass"}),e.jsx(h,{value:s.proxyPass,onChange:t=>J(a,"proxyPass",t.target.value),placeholder:"http://backend:8080"})]})]})]},a))})})]})}),e.jsx(w,{value:"ssl",className:"space-y-4 mt-4",children:e.jsxs(p,{children:[e.jsxs(v,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"SSL/TLS Configuration"}),e.jsx(b,{children:"Secure connections and certificates"})]}),e.jsxs(j,{size:"sm",onClick:()=>W(!0),variant:"outline",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Add Certificate"]})]}),xe&&e.jsx(x,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Certificate Name"}),e.jsx(h,{placeholder:"default",value:D,onChange:s=>I(s.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{onClick:ye,children:"Add Certificate"}),e.jsx(j,{variant:"outline",onClick:()=>{W(!1),I("")},children:"Cancel"})]})]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{children:"Enable SSL"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Enable HTTPS support"})]}),e.jsx(T,{checked:Z,onCheckedChange:s=>m({enableSSL:s})})]}),Z&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"ssl-port",children:"SSL Port"}),e.jsx(h,{id:"ssl-port",type:"number",value:te,onChange:s=>m({sslPort:parseInt(s.target.value)||443}),placeholder:"443"})]}),e.jsx(R,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(i,{children:"SSL Certificates"}),$.map((s,a)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"font-semibold",children:s.name}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>Ce(a),children:e.jsx(U,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Certificate Path"}),e.jsx(h,{value:s.certPath,onChange:t=>Q(a,"certPath",t.target.value),placeholder:"/etc/nginx/ssl/cert.pem"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Private Key Path"}),e.jsx(h,{value:s.keyPath,onChange:t=>Q(a,"keyPath",t.target.value),placeholder:"/etc/nginx/ssl/key.pem"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Domain"}),e.jsx(h,{value:s.domain||"",onChange:t=>Q(a,"domain",t.target.value),placeholder:"example.com"})]})]},a))]})]})]})]})}),e.jsx(w,{value:"rate-limiting",className:"space-y-4 mt-4",children:e.jsxs(p,{children:[e.jsxs(v,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Rate Limiting"}),e.jsx(b,{children:"Configure request rate limiting zones"})]}),e.jsxs(j,{size:"sm",onClick:()=>q(!0),variant:"outline",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Add Zone"]})]}),je&&e.jsx(x,{className:"border-b pb-4 mb-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Zone Name"}),e.jsx(h,{placeholder:"api_limit",value:V,onChange:s=>K(s.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{onClick:Se,children:"Add Zone"}),e.jsx(j,{variant:"outline",onClick:()=>{q(!1),K("")},children:"Cancel"})]})]})}),e.jsxs(x,{className:"space-y-3",children:[L.map((s,a)=>e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-card space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold font-mono",children:s.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Size: ",s.size," • Rate: ",s.rate]})]}),e.jsx(j,{variant:"ghost",size:"icon",onClick:()=>ke(a),children:e.jsx(U,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Zone Name"}),e.jsx(h,{value:s.name,onChange:t=>Y(a,"name",t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Size"}),e.jsx(h,{value:s.size,onChange:t=>Y(a,"size",t.target.value),placeholder:"10m"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Rate"}),e.jsx(h,{value:s.rate,onChange:t=>Y(a,"rate",t.target.value),placeholder:"10r/s"})]})]})]},a)),L.length===0&&e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No rate limit zones configured. Add a zone to get started."})]})]})}),e.jsx(w,{value:"performance",className:"space-y-4 mt-4",children:e.jsxs(p,{children:[e.jsxs(v,{children:[e.jsx(g,{children:"Performance Settings"}),e.jsx(b,{children:"Optimization and caching"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{children:"Enable Gzip"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Compress responses"})]}),e.jsx(T,{checked:re,onCheckedChange:s=>m({enableGzip:s})})]}),e.jsx(R,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(i,{children:"Enable Cache"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Cache static content"})]}),e.jsx(T,{checked:ie,onCheckedChange:s=>m({enableCache:s})})]})]})]})}),e.jsx(w,{value:"metrics",className:"space-y-4 mt-4",children:e.jsxs(p,{children:[e.jsxs(v,{children:[e.jsx(g,{children:"Real-time Metrics"}),e.jsx(b,{children:"Live performance metrics from NGINX simulation"})]}),e.jsx(x,{className:"space-y-6",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Requests Per Second"}),e.jsx("div",{className:"text-3xl font-bold",children:Math.round(l.throughput)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Current throughput"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Average Latency"}),e.jsxs("div",{className:"text-3xl font-bold",children:[Math.round(l.latency),"ms"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Response time"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Error Rate"}),e.jsxs("div",{className:"text-3xl font-bold",children:[(l.errorRate*100).toFixed(2),"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Failed requests"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Utilization"}),e.jsxs("div",{className:"text-3xl font-bold",children:[Math.round(l.utilization*100),"%"]}),e.jsx(le,{value:l.utilization*100,className:"mt-2"})]})]}),e.jsx(R,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Cache Hit Rate"}),e.jsx("div",{className:"text-2xl font-bold",children:l.customMetrics?.cache_hit_rate?`${Math.round(l.customMetrics.cache_hit_rate*100)}%`:"0%"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Hits: ",l.customMetrics?.cache_hits||0," | Misses: ",l.customMetrics?.cache_misses||0]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Active Connections"}),e.jsx("div",{className:"text-2xl font-bold",children:l.customMetrics?.active_connections||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Current connections"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Rate Limit Blocks"}),e.jsx("div",{className:"text-2xl font-bold",children:l.customMetrics?.rate_limit_blocks||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Blocked requests"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Worker Threads"}),e.jsx("div",{className:"text-2xl font-bold",children:l.customMetrics?.worker_threads||F}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active workers"})]})]}),l.latencyP50!==void 0&&e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Latency P50"}),e.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(l.latencyP50),"ms"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Median latency"})]}),l.latencyP99!==void 0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Latency P99"}),e.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(l.latencyP99),"ms"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"99th percentile"})]})]})]})]}):e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No metrics available. Start the simulation to see real-time metrics."})})]})}),e.jsx(w,{value:"config",className:"space-y-4 mt-4",children:e.jsxs(p,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(g,{children:"Server Block Configuration"}),e.jsx(b,{children:"NGINX server block configuration (read-only view)"})]}),e.jsxs(j,{size:"sm",variant:"outline",onClick:()=>{const s=De({port:G,serverName:ae,locations:_,upstreams:C,sslCertificates:$,rateLimitZones:L,enableSSL:Z,sslPort:te,enableGzip:re,enableCache:ie});m({config:s}),y({title:"Success",description:"Configuration regenerated from structured settings"})},children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Regenerate from Settings"]})]})}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"config",children:"Configuration"}),e.jsx(Fe,{id:"config",value:me,onChange:s=>m({config:s.target.value}),className:"font-mono text-sm h-96",placeholder:"Enter NGINX configuration..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Note: This is a read-only view. Use the structured tabs (Server, Locations, Upstreams, etc.) to configure NGINX. Changes here are saved but do not affect simulation. Click "Regenerate from Settings" to sync with current configuration.'})]})})]})})]})]})})}export{ss as NginxConfigAdvanced};

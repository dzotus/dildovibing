import{r as h,j as e,C as S,h as w,i as T,k as C,B,m as E,aH as le,S as ie,l as de,aF as Re,aG as Ie,n as Pe,u as Ue,a as Ae,e as Ve,T as Be,b as $e,c as Z,A as ue,d as qe,f as _,a5 as He,I as D,am as Je,L as o,ah as ce,q as L,s as R,t as I,v as P,w as n,a6 as ze,D as Oe,x as Ge,y as Qe,z as Ke,E as Xe,G as We,H as Ye}from"./index-UHkh-5io.js";import{P as q}from"./progress-CUC2GdAn.js";import{G as ee}from"./git-branch-bSUX7r7u.js";import{S as ge}from"./server-BJdb_qnB.js";import{C as ve}from"./clock-BG9TXgSU.js";import{G as je}from"./gauge-tCJtxx-7.js";function Ze({trace:m,onSpanClick:H}){const[J,U]=h.useState(new Set),[c,$]=h.useState(null),z=(()=>{const t=new Map,r=[];for(const l of m.spans)t.set(l.spanId,{span:l,children:[],depth:0});for(const l of m.spans){const v=t.get(l.spanId);if(!l.parentSpanId||!t.has(l.parentSpanId))r.push(v);else{const N=t.get(l.parentSpanId);N&&(N.children.push(v),v.depth=N.depth+1)}}const g=l=>{l.children.sort((v,N)=>v.span.startTime-N.span.startTime),l.children.forEach(g)};return r.forEach(g),r})(),O=m.startTime/1e3,F=m.duration/1e3,se=t=>{const r=new Set(J);r.has(t)?r.delete(t):r.add(t),U(r)},p=t=>{$(t),H&&H(t)},G=t=>{const{span:r}=t,g=J.has(r.spanId),l=t.children.length>0,v=r.startTime/1e3,N=r.duration/1e3,A=(v-O)/F*100,i=N/F*100,f=r.tags.some(y=>y.key==="error"&&y.value===!0)||r.logs.some(y=>y.fields.some(ae=>ae.key==="error"));return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:le("flex items-center gap-2 p-2 rounded hover:bg-muted/50 cursor-pointer transition-colors",c?.spanId===r.spanId&&"bg-primary/10"),onClick:()=>p(r),style:{paddingLeft:`${t.depth*20+8}px`},children:[e.jsx("div",{className:"flex items-center gap-1 min-w-[24px]",children:l?e.jsx(de,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:y=>{y.stopPropagation(),se(r.spanId)},children:g?e.jsx(Re,{className:"h-4 w-4"}):e.jsx(Ie,{className:"h-4 w-4"})}):e.jsx("div",{className:"w-6"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{variant:"outline",className:"text-xs",children:[e.jsx(ge,{className:"h-3 w-3 mr-1"}),r.serviceName]}),e.jsx("span",{className:"font-medium text-sm",children:r.operationName}),f&&e.jsx(Pe,{className:"h-4 w-4 text-destructive"})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ve,{className:"h-3 w-3"}),N.toFixed(2),"ms"]}),e.jsxs("span",{children:[r.tags.length," tags"]}),r.logs.length>0&&e.jsxs("span",{children:[r.logs.length," logs"]})]})]}),e.jsx("div",{className:"w-32 h-6 bg-muted rounded relative overflow-hidden",children:e.jsx("div",{className:le("absolute h-full rounded",f?"bg-destructive":"bg-primary"),style:{left:`${A}%`,width:`${i}%`}})})]}),l&&g&&e.jsx("div",{className:"ml-4",children:t.children.map(y=>G(y))})]},r.spanId)};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(S,{children:[e.jsx(w,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"Trace: ",m.traceId.substring(0,16),"..."]}),e.jsxs(C,{className:"mt-2",children:[m.spanCount," spans • ",m.serviceCount," services • ",F.toFixed(2),"ms",m.hasErrors&&e.jsx(B,{variant:"destructive",className:"ml-2",children:"Has Errors"})]})]})})}),e.jsxs(E,{children:[e.jsx("div",{className:"w-full h-8 bg-muted rounded relative overflow-hidden mb-4",children:m.spans.map(t=>{const r=t.startTime/1e3,g=t.duration/1e3,l=(r-O)/F*100,v=g/F*100,N=t.tags.some(A=>A.key==="error"&&A.value===!0);return e.jsx("div",{className:le("absolute h-full",N?"bg-destructive/50":"bg-primary/30"),style:{left:`${l}%`,width:`${v}%`},title:`${t.serviceName}: ${t.operationName}`},t.spanId)})}),e.jsx("div",{className:"space-y-1 max-h-96 overflow-y-auto",children:z.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:e.jsx("p",{className:"text-sm",children:"No spans in trace"})}):z.map(t=>G(t))})]})]}),c&&e.jsxs(S,{children:[e.jsxs(w,{children:[e.jsx(T,{children:"Span Details"}),e.jsxs(C,{children:[c.serviceName," • ",c.operationName]})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Span ID:"}),e.jsx("span",{className:"ml-2 font-mono",children:c.spanId})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Trace ID:"}),e.jsxs("span",{className:"ml-2 font-mono",children:[c.traceId.substring(0,16),"..."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Duration:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[(c.duration/1e3).toFixed(2),"ms"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Start Time:"}),e.jsx("span",{className:"ml-2",children:new Date(c.startTime/1e3).toLocaleString()})]}),c.parentSpanId&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Parent Span ID:"}),e.jsx("span",{className:"ml-2 font-mono",children:c.parentSpanId})]})]}),e.jsx(ie,{}),c.tags.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2 text-sm",children:["Tags (",c.tags.length,")"]}),e.jsx("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:c.tags.map((t,r)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm p-2 bg-muted/50 rounded",children:[e.jsx(B,{variant:"outline",className:"text-xs",children:t.key}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-mono text-xs",children:String(t.value)})]},r))})]}),c.logs.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-2 text-sm",children:["Logs (",c.logs.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:c.logs.map((t,r)=>e.jsxs("div",{className:"p-2 bg-muted/50 rounded text-sm",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:new Date(t.timestamp/1e3).toLocaleString()}),e.jsx("div",{className:"space-y-1",children:t.fields.map((g,l)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{variant:"outline",className:"text-xs",children:g.key}),e.jsx("span",{className:"text-muted-foreground",children:":"}),e.jsx("span",{className:"font-mono text-xs",children:String(g.value)})]},l))})]},r))})]})]})]})]})}function ls({componentId:m}){const{nodes:H,updateNode:J}=Ue(),{isRunning:U,getComponentMetrics:c}=Ae(),$=H.find(s=>s.id===m);if(!$)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const x=$.data.config||{},z=x.serverUrl||"http://jaeger:16686",O=x.agentEndpoint||"http://jaeger-agent:6831",F=x.collectorEndpoint||"http://jaeger-collector:14268",se=x.queryEndpoint||"http://jaeger-query:16686",p=x.samplingType||"probabilistic",G=x.samplingParam??.001,t=x.storageBackend||"memory",r=x.storageUrl||"",g=x.maxTraces||1e4,l=x.traceTTL||864e5,v=x.enableMetrics??!0,N=x.metricsBackend||"prometheus",A=x.metricsUrl||"http://prometheus:9090",i=Ve.getJaegerEmulationEngine(m),[f,y]=h.useState([]),[ae,oe]=h.useState([]),[te,me]=h.useState({totalTraces:0,errorRate:0,avgTraceDuration:0}),[k,xe]=h.useState(""),[Q,Ne]=h.useState("all"),[K,fe]=h.useState("all"),[X,ye]=h.useState("all"),[W,be]=h.useState("all"),[re,he]=h.useState(null);h.useEffect(()=>{if(!i){y([]),oe([]),me({totalTraces:0,errorRate:0,avgTraceDuration:0});return}const s=()=>{const a=i.getRecentTraces(20),j=a.map(d=>{const Y=d.spans.find(Le=>!Le.parentSpanId)||d.spans[0],ke=d.duration/1e3;new Date(d.startTime/1e3).toISOString();const Me=Ce(d.startTime/1e3);return{id:d.traceId,service:Y?.serviceName||"unknown",operation:Y?.operationName||"unknown",duration:Math.round(ke),spans:d.spanCount,status:d.hasErrors?"error":"success",timestamp:Me}});y(j);const M=i.getServiceStats().map(d=>({name:d.name,traces:d.tracesTotal,errors:d.errorsTotal,avgDuration:Math.round(d.avgDuration/1e3)}));oe(M),i.getJaegerMetrics(),i.calculateLoad();const b=a.length,De=a.filter(d=>d.hasErrors).length,Ee=b>0?De/b*100:0,Fe=a.length>0?a.reduce((d,Y)=>d+Y.duration/1e3,0)/a.length:0;me({totalTraces:b,errorRate:Ee,avgTraceDuration:Math.round(Fe)})};if(s(),U){const a=setInterval(s,2e3);return()=>clearInterval(a)}},[i,U,m]);const ne=h.useMemo(()=>{let s=f;if(k&&(s=s.filter(a=>a.id.toLowerCase().includes(k.toLowerCase())||a.service.toLowerCase().includes(k.toLowerCase())||a.operation.toLowerCase().includes(k.toLowerCase()))),Q!=="all"&&(s=s.filter(a=>a.service===Q)),K!=="all"&&(s=s.filter(a=>a.operation===K)),X!=="all"&&(s=s.filter(a=>a.status===X)),W!=="all"&&i){const a=Date.now();let j;switch(W){case"1h":j=a-36e5;break;case"24h":j=a-864e5;break;case"7d":j=a-6048e5;break}if(j){const V=i.queryTraces({startTime:j,limit:1e3}),M=new Set(V.traces.map(b=>b.traceId));s=s.filter(b=>M.has(b.id))}}return s},[f,k,Q,K,X,W,i]),pe=ae;te.totalTraces,te.errorRate,te.avgTraceDuration;const Se=h.useMemo(()=>{const s=new Set(f.map(a=>a.service));return Array.from(s).sort()},[f]),we=h.useMemo(()=>{const s=new Set(f.map(a=>a.operation));return Array.from(s).sort()},[f]),Te=s=>{if(i){const a=i.getTraceById(s);a&&he(a)}};function Ce(s){const j=Date.now()-s,V=Math.floor(j/1e3),M=Math.floor(V/60),b=Math.floor(M/60);return V<60?`${V}s ago`:M<60?`${M}m ago`:b<24?`${b}h ago`:`${Math.floor(b/24)}d ago`}const u=s=>{J(m,{data:{...$.data,config:{...x,...s}}})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:e.jsx(ee,{className:"h-6 w-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Jaeger"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Distributed Tracing System"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(B,{variant:"outline",className:"gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${U?"bg-green-500 animate-pulse":"bg-gray-400"}`}),U?"Running":"Stopped"]})})]}),e.jsx(ie,{}),e.jsxs(Be,{defaultValue:"traces",className:"w-full",children:[e.jsxs($e,{className:"grid w-full grid-cols-4",children:[e.jsxs(Z,{value:"traces",className:"gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Traces"]}),e.jsxs(Z,{value:"services",className:"gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Services"]}),e.jsxs(Z,{value:"settings",className:"gap-2",children:[e.jsx(qe,{className:"h-4 w-4"}),"Settings"]}),e.jsxs(Z,{value:"metrics",className:"gap-2",children:[e.jsx(je,{className:"h-4 w-4"}),"Metrics"]})]}),e.jsx(_,{value:"traces",className:"space-y-4 mt-4",children:e.jsxs(S,{children:[e.jsxs(w,{children:[e.jsx(T,{children:"Recent Traces"}),e.jsx(C,{children:"Distributed trace information"})]}),e.jsxs(E,{children:[e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(D,{placeholder:"Search by trace ID, service, or operation...",value:k,onChange:s=>xe(s.target.value),className:"pl-9"}),k&&e.jsx(de,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",onClick:()=>xe(""),children:e.jsx(Je,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(o,{className:"text-xs flex items-center gap-1",children:[e.jsx(ce,{className:"h-3 w-3"}),"Service"]}),e.jsxs(L,{value:Q,onValueChange:Ne,children:[e.jsx(R,{className:"h-8 text-xs",children:e.jsx(I,{})}),e.jsxs(P,{children:[e.jsx(n,{value:"all",children:"All Services"}),Se.map(s=>e.jsx(n,{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(o,{className:"text-xs flex items-center gap-1",children:[e.jsx(ce,{className:"h-3 w-3"}),"Operation"]}),e.jsxs(L,{value:K,onValueChange:fe,children:[e.jsx(R,{className:"h-8 text-xs",children:e.jsx(I,{})}),e.jsxs(P,{children:[e.jsx(n,{value:"all",children:"All Operations"}),we.map(s=>e.jsx(n,{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(o,{className:"text-xs flex items-center gap-1",children:[e.jsx(ce,{className:"h-3 w-3"}),"Status"]}),e.jsxs(L,{value:X,onValueChange:s=>ye(s),children:[e.jsx(R,{className:"h-8 text-xs",children:e.jsx(I,{})}),e.jsxs(P,{children:[e.jsx(n,{value:"all",children:"All"}),e.jsx(n,{value:"success",children:"Success"}),e.jsx(n,{value:"error",children:"Error"})]})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs(o,{className:"text-xs flex items-center gap-1",children:[e.jsx(ve,{className:"h-3 w-3"}),"Time"]}),e.jsxs(L,{value:W,onValueChange:s=>be(s),children:[e.jsx(R,{className:"h-8 text-xs",children:e.jsx(I,{})}),e.jsxs(P,{children:[e.jsx(n,{value:"all",children:"All Time"}),e.jsx(n,{value:"1h",children:"Last Hour"}),e.jsx(n,{value:"24h",children:"Last 24 Hours"}),e.jsx(n,{value:"7d",children:"Last 7 Days"})]})]})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Showing ",ne.length," of ",f.length," traces"]})]}),ne.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{className:"text-sm",children:"No traces available"}),e.jsx("p",{className:"text-xs mt-1",children:f.length===0?"Traces will appear here when simulation is running":"No traces match the current filters"})]}):e.jsx("div",{className:"space-y-3",children:ne.map(s=>e.jsx(S,{className:"border-border",children:e.jsx(w,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"p-2 rounded bg-primary/10",children:e.jsx(ee,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx(T,{className:"text-lg",children:s.operation}),e.jsxs(C,{className:"text-xs mt-1",children:["Service: ",s.service," • ",s.spans," spans • ",s.duration,"ms • ",s.timestamp]}),e.jsxs("div",{className:"mt-1 text-xs font-mono text-muted-foreground",children:["Trace ID: ",s.id.substring(0,16),"..."]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{variant:s.status==="success"?"default":"destructive",children:s.status}),e.jsxs(de,{variant:"outline",size:"sm",onClick:()=>Te(s.id),className:"gap-2",children:[e.jsx(ze,{className:"h-4 w-4"}),"View Trace"]})]})]})})},s.id))})]})]})}),e.jsx(_,{value:"services",className:"space-y-4 mt-4",children:e.jsxs(S,{children:[e.jsxs(w,{children:[e.jsx(T,{children:"Services"}),e.jsx(C,{children:"Service trace statistics"})]}),e.jsx(E,{children:pe.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{className:"text-sm",children:"No services available"}),e.jsx("p",{className:"text-xs mt-1",children:"Service statistics will appear here when traces are collected"})]}):e.jsx("div",{className:"space-y-3",children:pe.map(s=>e.jsxs(S,{className:"border-border",children:[e.jsx(w,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx(T,{className:"text-lg",children:s.name}),e.jsxs(C,{className:"text-xs mt-1",children:[s.traces," traces • ",s.errors," errors • Avg: ",s.avgDuration,"ms"]})]})})}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Error Rate"}),e.jsxs("span",{className:"font-semibold",children:[(s.errors/s.traces*100).toFixed(1),"%"]})]}),e.jsx(q,{value:s.errors/s.traces*100,className:"h-2"})]})})]},s.name))})})]})}),e.jsxs(_,{value:"settings",className:"space-y-4 mt-4",children:[e.jsxs(S,{children:[e.jsxs(w,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-5 w-5"}),"Endpoints"]}),e.jsx(C,{children:"Jaeger service endpoints configuration"})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"server-url",children:"Server URL (UI)"}),e.jsx(D,{id:"server-url",value:z,onChange:s=>u({serverUrl:s.target.value}),placeholder:"http://jaeger:16686"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Query UI endpoint (HTTP, port 16686)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"agent-endpoint",children:"Agent Endpoint"}),e.jsx(D,{id:"agent-endpoint",value:O,onChange:s=>u({agentEndpoint:s.target.value}),placeholder:"http://jaeger-agent:6831"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Agent endpoint (UDP 6831/gRPC 14250)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"collector-endpoint",children:"Collector Endpoint"}),e.jsx(D,{id:"collector-endpoint",value:F,onChange:s=>u({collectorEndpoint:s.target.value}),placeholder:"http://jaeger-collector:14268"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Collector endpoint (HTTP 14268/gRPC 14250)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"query-endpoint",children:"Query Endpoint"}),e.jsx(D,{id:"query-endpoint",value:se,onChange:s=>u({queryEndpoint:s.target.value}),placeholder:"http://jaeger-query:16686"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Query service endpoint (HTTP 16686/gRPC 16685)"})]})]})]}),e.jsxs(S,{children:[e.jsxs(w,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),"Sampling"]}),e.jsx(C,{children:"Trace sampling configuration"})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"sampling-type",children:"Sampling Type"}),e.jsxs(L,{value:p,onValueChange:s=>u({samplingType:s}),children:[e.jsx(R,{id:"sampling-type",children:e.jsx(I,{})}),e.jsxs(P,{children:[e.jsx(n,{value:"probabilistic",children:"Probabilistic"}),e.jsx(n,{value:"ratelimiting",children:"Rate Limiting"}),e.jsx(n,{value:"peroperation",children:"Per Operation"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[p==="probabilistic"&&"Sample traces with fixed probability (0-1)",p==="ratelimiting"&&"Sample up to N traces per second",p==="peroperation"&&"Sample per operation with rate limit"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(o,{htmlFor:"sampling-param",children:["Sampling Parameter",p==="probabilistic"&&" (Probability 0-1)",p==="ratelimiting"&&" (Traces/sec)",p==="peroperation"&&" (Default Traces/sec)"]}),e.jsx(D,{id:"sampling-param",type:"number",min:p==="probabilistic"?0:1,max:p==="probabilistic"?1:void 0,step:p==="probabilistic"?.001:1,value:G,onChange:s=>{const a=parseFloat(s.target.value);isNaN(a)||u({samplingParam:a})},placeholder:p==="probabilistic"?"0.001":"10"}),i&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Current sampling rate: ",(i.calculateLoad().samplingRate*100).toFixed(2),"%"]})]})]})]}),e.jsxs(S,{children:[e.jsxs(w,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"h-5 w-5"}),"Storage"]}),e.jsx(C,{children:"Storage backend configuration"})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"storage-backend",children:"Storage Backend"}),e.jsxs(L,{value:t,onValueChange:s=>u({storageBackend:s}),children:[e.jsx(R,{id:"storage-backend",children:e.jsx(I,{})}),e.jsxs(P,{children:[e.jsx(n,{value:"memory",children:"In-Memory"}),e.jsx(n,{value:"elasticsearch",children:"Elasticsearch"}),e.jsx(n,{value:"cassandra",children:"Cassandra"}),e.jsx(n,{value:"kafka",children:"Kafka"})]})]})]}),t!=="memory"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"storage-url",children:"Storage URL"}),e.jsx(D,{id:"storage-url",value:r,onChange:s=>u({storageUrl:s.target.value}),placeholder:t==="elasticsearch"?"http://elasticsearch:9200":t==="cassandra"?"cassandra:9042":"kafka:9092"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"max-traces",children:"Max Traces"}),e.jsx(D,{id:"max-traces",type:"number",min:1,value:g,onChange:s=>{const a=parseInt(s.target.value,10);!isNaN(a)&&a>0&&u({maxTraces:a})},placeholder:"10000"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum number of traces to store"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"trace-ttl",children:"Trace TTL (ms)"}),e.jsx(D,{id:"trace-ttl",type:"number",min:1e3,value:l,onChange:s=>{const a=parseInt(s.target.value,10);!isNaN(a)&&a>=1e3&&u({traceTTL:a})},placeholder:"86400000"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Time to live for traces in milliseconds (default: 24 hours)"})]})]})]}),e.jsxs(S,{children:[e.jsxs(w,{children:[e.jsxs(T,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5"}),"Metrics Export"]}),e.jsx(C,{children:"Metrics export configuration"})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(o,{htmlFor:"enable-metrics",children:"Enable Metrics Export"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Export Jaeger metrics to external backend"})]}),e.jsx(Ge,{id:"enable-metrics",checked:v,onCheckedChange:s=>u({enableMetrics:s})})]}),v&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"metrics-backend",children:"Metrics Backend"}),e.jsxs(L,{value:N,onValueChange:s=>u({metricsBackend:s}),children:[e.jsx(R,{id:"metrics-backend",children:e.jsx(I,{})}),e.jsxs(P,{children:[e.jsx(n,{value:"prometheus",children:"Prometheus"}),e.jsx(n,{value:"statsd",children:"StatsD"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"metrics-url",children:"Metrics URL"}),e.jsx(D,{id:"metrics-url",value:A,onChange:s=>u({metricsUrl:s.target.value}),placeholder:"http://prometheus:9090"})]})]})]})]})]}),e.jsx(_,{value:"metrics",className:"space-y-4 mt-4",children:e.jsxs(S,{children:[e.jsxs(w,{children:[e.jsx(T,{children:"Jaeger Metrics"}),e.jsx(C,{children:"Real-time metrics from Jaeger engine"})]}),e.jsx(E,{children:i?e.jsx("div",{className:"space-y-4",children:(()=>{const s=i.calculateLoad(),a=i.getJaegerMetrics(),j=c(m);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Spans/sec"}),e.jsx("span",{className:"font-semibold",children:s.spansPerSecond.toFixed(2)})]}),e.jsx(q,{value:Math.min(100,s.spansPerSecond/1e3*100),className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Traces/sec"}),e.jsx("span",{className:"font-semibold",children:s.tracesPerSecond.toFixed(2)})]}),e.jsx(q,{value:Math.min(100,s.tracesPerSecond/100*100),className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Sampling Rate"}),e.jsxs("span",{className:"font-semibold",children:[(s.samplingRate*100).toFixed(2),"%"]})]}),e.jsx(q,{value:s.samplingRate*100,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Storage Utilization"}),e.jsxs("span",{className:"font-semibold",children:[(s.storageUtilization*100).toFixed(2),"%"]})]}),e.jsx(q,{value:s.storageUtilization*100,className:"h-2"})]})]}),e.jsx(ie,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Spans Received:"}),e.jsx("span",{className:"ml-2 font-semibold",children:a.spansReceivedTotal.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Spans Dropped:"}),e.jsx("span",{className:"ml-2 font-semibold",children:a.spansDroppedTotal.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Traces Stored:"}),e.jsx("span",{className:"ml-2 font-semibold",children:a.tracesStoredTotal.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Query Latency:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[s.queryLatency.toFixed(2),"ms"]})]}),j&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Throughput:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[j.throughput.toFixed(2),"/s"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Error Rate:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[(j.errorRate*100).toFixed(2),"%"]})]})]})]})]})})()}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{className:"text-sm",children:"Jaeger engine not initialized"}),e.jsx("p",{className:"text-xs mt-1",children:"Start simulation to see metrics"})]})})]})})]}),e.jsx(Qe,{open:re!==null,onOpenChange:s=>!s&&he(null),children:e.jsxs(Ke,{className:"max-w-5xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Xe,{children:[e.jsx(We,{children:"Trace Details"}),e.jsx(Ye,{children:"View trace tree and span details"})]}),re&&e.jsx(Ze,{trace:re})]})})]})})}export{ls as JaegerConfigAdvanced};

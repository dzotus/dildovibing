import{E as it,aI as q,j as e,aO as lt,aq as Ms,ar as ct,as as dt,at as Es,aw as ot,aP as mt,au as xt,r as k,ad as ps,a7 as ht,u as ut,X as jt,V as pt,i as b,S as H,C as d,e as m,f as n,A as cs,k as o,Z as Ke,R as ds,T as ft,a as gt,b as se,c as vt,d as te,h as J,P as Re,I as O,N as os,a9 as ms,B as S,M as Ne,m as Ie,n as Nt,o as bt,p as yt,q as kt,s as Cs,aa as Le,L as C,ai as wt,ab as St,D as ae,v as re,w as ne,x as ie,y as le,z as be,t as xs}from"./index-D1p3qKk1.js";import{T as Ct}from"./textarea-Cbj5d7Ql.js";import{P as me}from"./progress-BrxiVvhD.js";import{c as As,R as Tt,T as Dt,b as Mt}from"./index-7MPGqzy7.js";import{u as Et}from"./use-toast-D6Huwyee.js";import{R as At}from"./refresh-ccw-BoEyyRRQ.js";import{D as Rt}from"./database-DCvPvYtR.js";import{C as It}from"./code-CvmuBIIH.js";import{C as Qe}from"./clock-BHe_SsWz.js";import{H as Lt}from"./hard-drive-Bn6AiHe4.js";import{T as Pt}from"./terminal-7W8YURpS.js";import{C as Ts}from"./chart-column-BEtwdQtr.js";import{C as Ds}from"./circle-check-big-lBf-svbX.js";import{R as ye,C as ke,X as we,Y as xe,T as Se,P as He,L as hs,a as Pe}from"./LineChart-C4lQ7HUu.js";import{A as us,a as Ce}from"./AreaChart-CZXYxvdi.js";const Bt=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],qe=it("cpu",Bt);var Z="Accordion",Ot=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[fs,zt,Vt]=lt(Z),[Ye]=ct(Z,[Vt,As]),gs=As(),Rs=q.forwardRef((v,T)=>{const{type:N,...D}=v,z=D,h=D;return e.jsx(fs.Provider,{scope:v.__scopeAccordion,children:N==="multiple"?e.jsx(Wt,{...h,ref:T}):e.jsx(Ut,{...z,ref:T})})});Rs.displayName=Z;var[Is,Ft]=Ye(Z),[Ls,_t]=Ye(Z,{collapsible:!1}),Ut=q.forwardRef((v,T)=>{const{value:N,defaultValue:D,onValueChange:z=()=>{},collapsible:h=!1,...F}=v,[l,ee]=Ms({prop:N,defaultProp:D??"",onChange:z,caller:Z});return e.jsx(Is,{scope:v.__scopeAccordion,value:q.useMemo(()=>l?[l]:[],[l]),onItemOpen:ee,onItemClose:q.useCallback(()=>h&&ee(""),[h,ee]),children:e.jsx(Ls,{scope:v.__scopeAccordion,collapsible:h,children:e.jsx(Ps,{...F,ref:T})})})}),Wt=q.forwardRef((v,T)=>{const{value:N,defaultValue:D,onValueChange:z=()=>{},...h}=v,[F,l]=Ms({prop:N,defaultProp:D??[],onChange:z,caller:Z}),ee=q.useCallback(i=>l((X=[])=>[...X,i]),[l]),K=q.useCallback(i=>l((X=[])=>X.filter(he=>he!==i)),[l]);return e.jsx(Is,{scope:v.__scopeAccordion,value:F,onItemOpen:ee,onItemClose:K,children:e.jsx(Ls,{scope:v.__scopeAccordion,collapsible:!0,children:e.jsx(Ps,{...h,ref:T})})})}),[$t,Ze]=Ye(Z),Ps=q.forwardRef((v,T)=>{const{__scopeAccordion:N,disabled:D,dir:z,orientation:h="vertical",...F}=v,l=q.useRef(null),ee=ot(l,T),K=zt(N),X=mt(z)==="ltr",he=xt(v.onKeyDown,ce=>{if(!Ot.includes(ce.key))return;const u=ce.target,L=K().filter(Ee=>!Ee.ref.current?.disabled),$=L.findIndex(Ee=>Ee.ref.current===u),R=L.length;if($===-1)return;ce.preventDefault();let Y=$;const Te=0,De=R-1,Me=()=>{Y=$+1,Y>De&&(Y=Te)},ue=()=>{Y=$-1,Y<Te&&(Y=De)};switch(ce.key){case"Home":Y=Te;break;case"End":Y=De;break;case"ArrowRight":h==="horizontal"&&(X?Me():ue());break;case"ArrowDown":h==="vertical"&&Me();break;case"ArrowLeft":h==="horizontal"&&(X?ue():Me());break;case"ArrowUp":h==="vertical"&&ue();break}const es=Y%R;L[es].ref.current?.focus()});return e.jsx($t,{scope:N,disabled:D,direction:z,orientation:h,children:e.jsx(fs.Slot,{scope:N,children:e.jsx(Es.div,{...F,"data-orientation":h,ref:ee,onKeyDown:D?void 0:he})})})}),Xe="AccordionItem",[Gt,vs]=Ye(Xe),Bs=q.forwardRef((v,T)=>{const{__scopeAccordion:N,value:D,...z}=v,h=Ze(Xe,N),F=Ft(Xe,N),l=gs(N),ee=dt(),K=D&&F.value.includes(D)||!1,i=h.disabled||v.disabled;return e.jsx(Gt,{scope:N,open:K,disabled:i,triggerId:ee,children:e.jsx(Tt,{"data-orientation":h.orientation,"data-state":Us(K),...l,...z,ref:T,disabled:i,open:K,onOpenChange:X=>{X?F.onItemOpen(D):F.onItemClose(D)}})})});Bs.displayName=Xe;var Os="AccordionHeader",zs=q.forwardRef((v,T)=>{const{__scopeAccordion:N,...D}=v,z=Ze(Z,N),h=vs(Os,N);return e.jsx(Es.h3,{"data-orientation":z.orientation,"data-state":Us(h.open),"data-disabled":h.disabled?"":void 0,...D,ref:T})});zs.displayName=Os;var js="AccordionTrigger",Vs=q.forwardRef((v,T)=>{const{__scopeAccordion:N,...D}=v,z=Ze(Z,N),h=vs(js,N),F=_t(js,N),l=gs(N);return e.jsx(fs.ItemSlot,{scope:N,children:e.jsx(Dt,{"aria-disabled":h.open&&!F.collapsible||void 0,"data-orientation":z.orientation,id:h.triggerId,...l,...D,ref:T})})});Vs.displayName=js;var Fs="AccordionContent",_s=q.forwardRef((v,T)=>{const{__scopeAccordion:N,...D}=v,z=Ze(Z,N),h=vs(Fs,N),F=gs(N);return e.jsx(Mt,{role:"region","aria-labelledby":h.triggerId,"data-orientation":z.orientation,...F,...D,ref:T,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...v.style}})});_s.displayName=Fs;function Us(v){return v?"open":"closed"}var Jt=Rs,Kt=Bs,Qt=zs,Ws=Vs,$s=_s;const Ht=Jt,Gs=k.forwardRef(({className:v,...T},N)=>e.jsx(Kt,{ref:N,className:ps("border-b",v),...T}));Gs.displayName="AccordionItem";const Js=k.forwardRef(({className:v,children:T,...N},D)=>e.jsx(Qt,{className:"flex",children:e.jsxs(Ws,{ref:D,className:ps("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",v),...N,children:[T,e.jsx(ht,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));Js.displayName=Ws.displayName;const Ks=k.forwardRef(({className:v,children:T,...N},D)=>e.jsx($s,{ref:D,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...N,children:e.jsx("div",{className:ps("pb-4 pt-0",v),children:T})}));Ks.displayName=$s.displayName;function fa({componentId:v}){const{nodes:T,updateNode:N}=ut(),{getComponentMetrics:D,isRunning:z}=jt(),{toast:h}=Et(),F=T.find(s=>s.id===v);if(!F)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const l=pt.getSparkEmulationEngine(v),K=D(v)?.customMetrics||{},i=F.data.config||{},X=l?l.getJobs():[],he=l?l.getStages():[],ce=l?l.getExecutors():[],u=l?l.getMetrics():null,L=X.length>0?X.map(s=>({...s,startTime:typeof s.startTime=="number"?new Date(s.startTime).toISOString():s.startTime,endTime:s.endTime?typeof s.endTime=="number"?new Date(s.endTime).toISOString():s.endTime:void 0})):i.jobs||[],$=he.length>0?he:i.stages||[],R=ce.length>0?ce:i.executors||[],Y=u?.totalJobs??K.totalJobs??L.length,Te=u?.activeJobs??K.activeJobs??L.filter(s=>s.status==="RUNNING").length,De=u?.totalExecutors??K.totalExecutors??R.length,Me=u?.aliveExecutors??K.aliveExecutors??R.filter(s=>s.status==="ALIVE").length,ue=u?.totalCores??K.totalCores??R.reduce((s,t)=>s+t.cores,0),es=u?.totalMemory??K.totalMemory??R.reduce((s,t)=>s+t.memoryMax,0)/1024,Ee=i.master||i.sparkMaster||"local[*]",Qs=i.appName||i.sparkAppName||"archiphoenix-spark",[qt,Xt]=k.useState(""),[Hs,Be]=k.useState(!1),[qs,Oe]=k.useState(!1),[Yt,Zt]=k.useState(null),[ea,sa]=k.useState(null),[ss,ze]=k.useState(null),[ts,Ve]=k.useState(null),[je,Xs]=k.useState(""),[pe,Ys]=k.useState(""),[as,Zs]=k.useState("all"),[P,Fe]=k.useState(null),[f,Ns]=k.useState(null),[E,bs]=k.useState(null),[_e,Ue]=k.useState(""),ys=l?l.getSQLQueries():[],[Ae,fe]=k.useState(ys.length>0?ys:i.sqlQueries||[]),[V,ge]=k.useState(i.storageLevels||[]),[de,oe]=k.useState(null),[ve,rs]=k.useState(i.environment||{}),[et,We]=k.useState(!1),[$e,ns]=k.useState(""),[is,ls]=k.useState("");k.useEffect(()=>{if(l){const s=l.getSQLQueries();s.length>0?fe(s):i.sqlQueries&&fe(i.sqlQueries)}else i.sqlQueries&&fe(i.sqlQueries);i.storageLevels&&ge(i.storageLevels)},[i.sqlQueries,i.storageLevels,l]);const M=s=>{if(N(v,{data:{...F.data,config:{...i,...s}}}),l){const t=T.find(a=>a.id===v);t&&l.updateConfig(t)}};k.useEffect(()=>{if(!z||!l)return;const s=setInterval(()=>{const t=T.find(r=>r.id===v);if(!t)return;const a=l.getJobs(),c=l.getStages(),x=l.getExecutors(),g=l.getSQLQueries();g.length>0&&fe(g),N(v,{data:{...t.data,config:{...t.data.config,jobs:a,stages:c,executors:x,sqlQueries:g}}})},2e3);return()=>clearInterval(s)},[z,l,v,T,N]);const ks=s=>{if(!s.name){h({title:"Error",description:"Job name is required",variant:"destructive"});return}const t={id:`job-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:s.name||`Spark Job ${Date.now()}`,status:"RUNNING",startTime:Date.now(),stages:s.stages||3,tasks:s.tasks||100,executors:Me,inputBytes:0,outputBytes:0,shuffleRead:0,shuffleWrite:0,submissionTime:Date.now()};l&&l.addJob(t);const a=[...L,t];M({jobs:a}),h({title:"Success",description:"Job created successfully"}),Be(!1)},st=s=>{l&&l.removeJob(s);const t=L.filter(a=>a.id!==s);M({jobs:t}),h({title:"Success",description:"Job deleted successfully"}),ze(null)},tt=s=>{if(!s.id||!s.host){h({title:"Error",description:"Executor ID and host are required",variant:"destructive"});return}const t=i.executorMemory||"4g",a=rt(t),c=i.executorCores||2,x={id:s.id,host:s.host,status:"ALIVE",cores:s.cores||c,memoryUsed:a*.3,memoryMax:a,diskUsed:a*.2,diskMax:a*2,activeTasks:0,totalTasks:0,totalInputBytes:0,totalShuffleRead:0,totalShuffleWrite:0,startTime:Date.now(),lastHeartbeat:Date.now()};l&&l.addExecutor(x);const g=[...R,x];M({executors:g}),h({title:"Success",description:"Executor added successfully"}),Oe(!1)},at=s=>{l&&l.removeExecutor(s);const t=R.map(a=>a.id===s?{...a,status:"DEAD"}:a);M({executors:t}),h({title:"Success",description:"Executor removed successfully"}),Ve(null)},rt=s=>{const t=s.match(/^(\d+)([kmg]?)$/i);if(!t)return 4096;const a=parseInt(t[1],10);switch(t[2].toLowerCase()){case"k":return a/1024;case"m":return a;case"g":return a*1024;default:return a}},ws=k.useMemo(()=>je?L.filter(s=>s.name.toLowerCase().includes(je.toLowerCase())||s.id.toLowerCase().includes(je.toLowerCase())):L,[L,je]),Ss=k.useMemo(()=>pe?R.filter(s=>s.id.toLowerCase().includes(pe.toLowerCase())||s.host.toLowerCase().includes(pe.toLowerCase())):R,[R,pe]),Q=s=>{switch(s){case"RUNNING":case"ACTIVE":case"ALIVE":return"bg-green-500";case"SUCCEEDED":case"COMPLETE":return"bg-blue-500";case"FAILED":case"DEAD":return"bg-red-500";case"KILLED":return"bg-gray-500";default:return"bg-gray-500"}},p=s=>{if(!s||s===0)return"0 B";const t=["B","KB","MB","GB","TB"],a=Math.floor(Math.log(s)/Math.log(1024));return`${(s/Math.pow(1024,a)).toFixed(2)} ${t[a]}`},nt=s=>{if(!s)return"0s";const t=Math.floor(s/3600),a=Math.floor(s%3600/60),c=s%60;return t>0?`${t}h ${a}m ${c}s`:a>0?`${a}m ${c}s`:`${c}s`},Ge=s=>s?nt(Math.floor(s/1e3)):"0s";return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Apache Spark"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Spark Application"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Unified analytics engine for large-scale data processing"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{const s=T.find(t=>t.id===v);s&&l&&l.updateConfig(s),h({title:"Refreshed",description:"Spark data refreshed"})},children:[e.jsx(At,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(H,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(d,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Jobs"}),e.jsx(cs,{className:"h-4 w-4 text-blue-500"})]})}),e.jsxs(o,{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:Y}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"total"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[Te," active"]})]})]}),e.jsxs(d,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Executors"}),e.jsx(qe,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:De}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"alive"})]})})]}),e.jsxs(d,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Cores"}),e.jsx(Ke,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:ue}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"total"})]})})]}),e.jsxs(d,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Memory"}),e.jsx(Rt,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsx(o,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-cyan-600 dark:text-cyan-400",children:(es/1024).toFixed(1)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"GB"})]})})]}),e.jsxs(d,{className:"border-l-4 border-l-orange-500 bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{className:"text-sm font-medium text-muted-foreground",children:"Active Stages"}),e.jsx(ds,{className:"h-4 w-4 text-orange-500"})]})}),e.jsxs(o,{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400",children:u?.activeStages??$.filter(s=>s.status==="ACTIVE").length}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"active"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[$.length," total"]})]})]})]}),e.jsxs(ft,{defaultValue:"jobs",className:"space-y-4",children:[e.jsxs(gt,{className:"flex-wrap",children:[e.jsxs(se,{value:"jobs",className:"flex items-center gap-2",children:[e.jsx(cs,{className:"h-4 w-4"}),"Jobs (",L.length,")"]}),e.jsxs(se,{value:"stages",className:"flex items-center gap-2",children:[e.jsx(ds,{className:"h-4 w-4"}),"Stages (",$.length,")"]}),e.jsxs(se,{value:"executors",className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-4 w-4"}),"Executors (",R.length,")"]}),e.jsxs(se,{value:"sql",className:"flex items-center gap-2",children:[e.jsx(It,{className:"h-4 w-4"}),"SQL"]}),e.jsxs(se,{value:"streaming",className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Streaming"]}),e.jsxs(se,{value:"timeline",className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),"Timeline"]}),e.jsxs(se,{value:"storage",className:"flex items-center gap-2",children:[e.jsx(Lt,{className:"h-4 w-4"}),"Storage"]}),e.jsxs(se,{value:"environment",className:"flex items-center gap-2",children:[e.jsx(Pt,{className:"h-4 w-4"}),"Environment"]}),e.jsxs(se,{value:"metrics",className:"flex items-center gap-2",children:[e.jsx(Ts,{className:"h-4 w-4"}),"Metrics"]}),e.jsxs(se,{value:"settings",className:"flex items-center gap-2",children:[e.jsx(vt,{className:"h-4 w-4"}),"Settings"]})]}),e.jsx(te,{value:"jobs",className:"space-y-4",children:e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Jobs"}),e.jsx(J,{children:"Spark application jobs"})]}),e.jsxs(b,{onClick:()=>Be(!0),size:"sm",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Add Job"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(O,{placeholder:"Search jobs...",value:je,onChange:s=>Xs(s.target.value),className:"max-w-sm"})})]}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:ws.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:je?"No jobs found matching your search":"No jobs yet. Create one to get started."}):ws.map(s=>e.jsxs(d,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${Q(s.status)}/20`,children:s.status==="RUNNING"?e.jsx(os,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):s.status==="SUCCEEDED"?e.jsx(Ds,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}):e.jsx(ms,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(n,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(S,{variant:"outline",className:Q(s.status),children:s.status}),s.duration&&e.jsxs(S,{variant:"outline",children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"}),Ge(s.duration)]}),s.stages&&e.jsxs(S,{variant:"outline",children:[s.stages," stages"]}),s.tasks&&e.jsxs(S,{variant:"outline",children:[s.tasks," tasks"]})]})]})]})})}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Input:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(s.inputBytes)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Output:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(s.outputBytes)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shuffle Read:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(s.shuffleRead)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shuffle Write:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(s.shuffleWrite)})]})]}),s.startTime&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Started: ",new Date(s.startTime).toLocaleString(),s.endTime&&` â€¢ Ended: ${new Date(s.endTime).toLocaleString()}`]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>Fe(s),children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>ze(s.id),children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]},s.id))})})]})}),e.jsx(te,{value:"stages",className:"space-y-4",children:e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Stages"}),e.jsx(J,{children:"Job execution stages"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Nt,{value:as,onValueChange:Zs,children:[e.jsx(bt,{className:"w-[200px]",children:e.jsx(yt,{placeholder:"Filter by job"})}),e.jsxs(kt,{children:[e.jsx(Cs,{value:"all",children:"All Jobs"}),L.map(s=>e.jsx(Cs,{value:s.id,children:s.name},s.id))]})]})})]})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:(()=>{const t=(as==="all"?$:$.filter(c=>c.jobId===as)).reduce((c,x)=>(c[x.jobId]||(c[x.jobId]=[]),c[x.jobId].push(x),c),{}),a=Object.keys(t);return a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No stages found"}):e.jsx(Ht,{type:"multiple",className:"w-full",children:a.map(c=>{const x=t[c],g=L.find(r=>r.id===c);return e.jsxs(Gs,{value:c,children:[e.jsx(Js,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:g?.name||c}),e.jsxs(S,{variant:"outline",children:[x.length," stages"]})]})}),e.jsx(Ks,{children:e.jsx("div",{className:"space-y-4 pt-2",children:x.map(r=>{const A=r.numTasks>0?r.numCompleteTasks/r.numTasks*100:0;return r.numFailedTasks>0,e.jsxs(d,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${Q(r.status)}/20`,children:r.status==="COMPLETE"?e.jsx(Ds,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}):r.status==="ACTIVE"?e.jsx(os,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(ms,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(n,{className:"text-lg font-semibold",children:r.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(S,{variant:"outline",className:Q(r.status),children:r.status}),r.stageType&&e.jsx(S,{variant:"outline",className:"text-xs",children:r.stageType}),e.jsxs(S,{variant:"outline",children:[r.numCompleteTasks,"/",r.numTasks," tasks"]}),r.numFailedTasks>0&&e.jsxs(S,{variant:"outline",className:"bg-red-500",children:[r.numFailedTasks," failed"]}),r.duration&&e.jsxs(S,{variant:"outline",children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"}),Ge(r.duration)]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-1",children:[e.jsx("span",{children:"Task Progress"}),e.jsxs("span",{children:[r.numCompleteTasks,"/",r.numTasks," (",A.toFixed(0),"%)"]})]}),e.jsx(me,{value:A,className:"h-2"})]})]})]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>Ns(r),children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Details"]})]})}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Input:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(r.inputBytes)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Output:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(r.outputBytes)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shuffle Read:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(r.shuffleRead)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shuffle Write:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(r.shuffleWrite)})]})]}),r.shuffleRead&&r.shuffleRead>0||r.shuffleWrite&&r.shuffleWrite>0?e.jsxs("div",{className:"mt-4 p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ts,{className:"h-4 w-4"}),e.jsx("span",{className:"font-semibold text-sm",children:"Shuffle Operations"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Read:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(r.shuffleRead)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Write:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(r.shuffleWrite)})]})]}),r.shuffleNetworkRead&&r.shuffleNetworkRead>0||r.shuffleSpillMemory&&r.shuffleSpillMemory>0?e.jsxs("div",{className:"border-t pt-3 mt-3 space-y-2",children:[e.jsx("div",{className:"text-xs font-semibold text-muted-foreground mb-2",children:"Network & Spill Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[r.shuffleNetworkRead&&r.shuffleNetworkRead>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Network Read:"}),e.jsx("span",{className:"ml-2 font-semibold text-blue-600 dark:text-blue-400",children:p(r.shuffleNetworkRead)})]}),r.shuffleNetworkWrite&&r.shuffleNetworkWrite>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Network Write:"}),e.jsx("span",{className:"ml-2 font-semibold text-blue-600 dark:text-blue-400",children:p(r.shuffleNetworkWrite)})]}),r.shuffleSpillMemory&&r.shuffleSpillMemory>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Memory Spill:"}),e.jsx("span",{className:"ml-2 font-semibold text-orange-600 dark:text-orange-400",children:p(r.shuffleSpillMemory)})]}),r.shuffleSpillDisk&&r.shuffleSpillDisk>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Disk Spill:"}),e.jsx("span",{className:"ml-2 font-semibold text-orange-600 dark:text-orange-400",children:p(r.shuffleSpillDisk)})]}),r.shuffleFetchWaitTime&&r.shuffleFetchWaitTime>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Fetch Wait:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[r.shuffleFetchWaitTime.toFixed(0),"ms"]})]})]})]}):null,r.shuffleRead&&r.shuffleRead>104857600&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-yellow-600 dark:text-yellow-400",children:[e.jsx(Le,{className:"h-3 w-3"}),"Large shuffle operation detected"]}),r.shuffleSpillMemory&&r.shuffleSpillMemory>0&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs text-orange-600 dark:text-orange-400",children:[e.jsx(Le,{className:"h-3 w-3"}),"Memory spill detected - consider increasing executor memory"]})]}):null]})]},r.id)})})})]},c)})})})()})})]})}),e.jsx(te,{value:"executors",className:"space-y-4",children:e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Executors"}),e.jsx(J,{children:"Spark executor nodes"})]}),e.jsxs(b,{onClick:()=>Oe(!0),size:"sm",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Add Executor"]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(O,{placeholder:"Search executors...",value:pe,onChange:s=>Ys(s.target.value),className:"max-w-sm"})})]}),e.jsx(o,{children:e.jsx("div",{className:"space-y-4",children:Ss.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:pe?"No executors found matching your search":"No executors yet. Add one to get started."}):Ss.map(s=>e.jsxs(d,{className:"border-l-4 border-l-purple-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${Q(s.status)}/20`,children:e.jsx(qe,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx(n,{className:"text-lg font-semibold",children:s.id}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(S,{variant:"outline",className:Q(s.status),children:s.status}),e.jsx(S,{variant:"outline",children:s.host}),e.jsxs(S,{variant:"outline",children:[s.cores," cores"]})]})]})]})})}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Memory:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[(s.memoryUsed/1024).toFixed(1)," / ",(s.memoryMax/1024).toFixed(1)," GB"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Disk:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[(s.diskUsed/1024).toFixed(1)," / ",(s.diskMax/1024).toFixed(1)," GB"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Tasks:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[s.activeTasks," active / ",s.totalTasks," total"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shuffle:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:["R: ",p(s.totalShuffleRead)," W: ",p(s.totalShuffleWrite)]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>bs(s),children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"View Details"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>Ve(s.id),children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Remove"]})]})]})]},s.id))})})]})}),e.jsx(te,{value:"sql",className:"space-y-4",children:e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(n,{children:"SQL Queries"}),e.jsx(J,{children:"Execute and monitor SQL queries"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"SQL Query"}),e.jsx(Ct,{placeholder:"SELECT * FROM table WHERE condition...",value:_e,onChange:s=>Ue(s.target.value),className:"min-h-[120px] font-mono text-sm"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{onClick:()=>{if(!_e.trim()){h({title:"Error",description:"Please enter a SQL query",variant:"destructive"});return}if(l){const t=[l.executeSQL(_e,Date.now()),...Ae];fe(t),M({sqlQueries:t}),Ue(""),h({title:"Query submitted",description:"SQL query is being executed"})}else{const t=[{id:`query-${Date.now()}`,query:_e,status:"RUNNING",startTime:Date.now(),rowsProcessed:0},...Ae];fe(t),M({sqlQueries:t}),Ue(""),h({title:"Query submitted",description:"SQL query is being executed"})}},children:[e.jsx(os,{className:"h-4 w-4 mr-2"}),"Execute Query"]}),e.jsx(b,{variant:"outline",onClick:()=>Ue(""),children:"Clear"})]})]}),e.jsx(H,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(n,{className:"text-lg",children:"Query History"}),e.jsxs(S,{variant:"outline",children:[Ae.length," queries"]})]}),e.jsx("div",{className:"space-y-3",children:Ae.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No queries executed yet"}):Ae.map(s=>e.jsxs(d,{className:"border-l-4 border-l-blue-500",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{variant:"outline",className:Q(s.status),children:s.status}),s.executionTime&&e.jsxs(S,{variant:"outline",children:[e.jsx(Qe,{className:"h-3 w-3 mr-1"}),s.executionTime.toFixed(0),"ms"]}),s.rowsProcessed!==void 0&&e.jsxs(S,{variant:"outline",children:[s.rowsProcessed.toLocaleString()," rows"]})]}),s.startTime&&e.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(s.startTime).toLocaleString()})]})}),e.jsxs(o,{children:[e.jsx("div",{className:"bg-muted p-3 rounded-lg font-mono text-sm",children:e.jsx("pre",{className:"whitespace-pre-wrap",children:s.query})}),(s.explainPlan||s.physicalPlan||s.logicalPlan)&&e.jsxs("div",{className:"mt-3 space-y-3",children:[s.logicalPlan&&e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-semibold",children:"Logical Plan"}),e.jsx("div",{className:"bg-muted p-3 rounded-lg font-mono text-xs mt-1",children:e.jsx("pre",{className:"whitespace-pre-wrap",children:s.logicalPlan})})]}),s.physicalPlan&&e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-semibold",children:"Physical Plan"}),e.jsx("div",{className:"bg-muted p-3 rounded-lg font-mono text-xs mt-1",children:e.jsx("pre",{className:"whitespace-pre-wrap",children:s.physicalPlan})})]}),s.explainPlan&&e.jsxs("div",{children:[e.jsx(C,{className:"text-sm font-semibold",children:"Explain Plan"}),e.jsx("div",{className:"bg-muted p-3 rounded-lg font-mono text-xs mt-1",children:e.jsx("pre",{className:"whitespace-pre-wrap",children:s.explainPlan})})]})]})]})]},s.id))})]})]})]})}),e.jsx(te,{value:"streaming",className:"space-y-4",children:e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Streaming Jobs"}),e.jsx(J,{children:"Real-time data processing with Spark Streaming"})]}),i.enableStreaming&&e.jsxs(b,{size:"sm",onClick:()=>{if(l){const s=i.streamingBatchInterval||1e3;l.createStreamingJob(`Streaming Job ${Date.now()}`,s,Date.now()),h({title:"Streaming job created",description:"New streaming job has been started"})}},children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Create Streaming Job"]})]})}),e.jsx(o,{children:i.enableStreaming?(()=>{const s=l?l.getStreamingJobs():[];return s.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No streaming jobs yet. Create one to get started."}):e.jsx("div",{className:"space-y-4",children:s.map(t=>{const a=t.totalBatches>0?(t.processedBatches/t.totalBatches*100).toFixed(1):"0",c=t.currentBackpressure>.7?"text-red-600 dark:text-red-400":t.currentBackpressure>.4?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400";return e.jsxs(d,{className:"border-l-4 border-l-purple-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${Q(t.status)}/20`,children:t.status==="ACTIVE"?e.jsx(Ke,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"}):e.jsx(ms,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(n,{className:"text-lg font-semibold",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(S,{variant:"outline",className:Q(t.status),children:t.status}),e.jsxs(S,{variant:"outline",children:["Batch: ",t.batchInterval,"ms"]}),e.jsxs(S,{variant:"outline",children:[t.totalBatches," batches"]}),t.backpressureEnabled&&e.jsxs(S,{variant:"outline",className:c,children:["Backpressure: ",(t.currentBackpressure*100).toFixed(0),"%"]})]})]})]}),t.status==="ACTIVE"&&e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{l&&(l.stopStreamingJob(t.id),h({title:"Streaming job stopped",description:"The streaming job has been stopped"}))},children:[e.jsx(wt,{className:"h-4 w-4 mr-2"}),"Stop"]})]})}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Processed Batches:"}),e.jsx("span",{className:"ml-2 font-semibold",children:t.processedBatches})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Failed Batches:"}),e.jsx("span",{className:"ml-2 font-semibold text-red-600 dark:text-red-400",children:t.failedBatches})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Success Rate:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[a,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Records Processed:"}),e.jsx("span",{className:"ml-2 font-semibold",children:t.totalRecordsProcessed.toLocaleString()})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Avg Processing Time:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[t.averageProcessingTime.toFixed(0),"ms"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Next Batch:"}),e.jsx("span",{className:"ml-2 font-semibold",children:t.nextBatchTime?new Date(t.nextBatchTime).toLocaleTimeString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Checkpoint Dir:"}),e.jsx("span",{className:"ml-2 font-semibold text-xs",children:t.checkpointDirectory||"/checkpoint"})]})]}),t.currentBackpressure>.5&&e.jsxs("div",{className:"mt-3 p-2 bg-yellow-50 dark:bg-yellow-950/20 rounded text-xs text-yellow-800 dark:text-yellow-200",children:[e.jsx(Le,{className:"h-3 w-3 inline mr-1"}),"High backpressure detected. Consider increasing batch interval or reducing processing time."]}),t.jobId&&e.jsx("div",{className:"mt-3",children:e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{const x=l?.getJob(t.jobId);x&&Fe(x)},children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"View Latest Batch Job"]})})]})]},t.id)})})})():e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Ke,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Streaming is disabled. Enable it in Settings tab to start streaming jobs."})]})})]})}),e.jsx(te,{value:"timeline",className:"space-y-4",children:e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(n,{children:"Timeline View"}),e.jsx(J,{children:"Job and stage execution timeline with metrics"})]}),e.jsxs(o,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Job Execution Timeline"}),e.jsx(ye,{width:"100%",height:300,children:e.jsxs(us,{data:k.useMemo(()=>{const s=Date.now(),t=36e5,a=20,c=t/a,x=[];for(let g=0;g<=a;g++){const r=s-(t-g*c),A=new Date(r).toLocaleTimeString(),B=L.filter(y=>{const U=typeof y.startTime=="string"?new Date(y.startTime).getTime():typeof y.startTime=="number"?y.startTime:0,j=y.endTime?typeof y.endTime=="string"?new Date(y.endTime).getTime():typeof y.endTime=="number"?y.endTime:1/0:1/0;return U<=r&&(j>=r||!y.endTime)}).length,G=L.filter(y=>{const U=y.endTime?typeof y.endTime=="string"?new Date(y.endTime).getTime():typeof y.endTime=="number"?y.endTime:0:0;return y.status==="SUCCEEDED"&&U>0&&U<=r}).length,_=L.filter(y=>{const U=y.endTime?typeof y.endTime=="string"?new Date(y.endTime).getTime():typeof y.endTime=="number"?y.endTime:0:0;return y.status==="FAILED"&&U>0&&U<=r}).length;x.push({time:A,timestamp:r,running:B,succeeded:G,failed:_,total:B+G+_})}return x},[L]),children:[e.jsx(ke,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(we,{dataKey:"time",stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10}}),e.jsx(xe,{stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10}}),e.jsx(Se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"4px"}}),e.jsx(He,{}),e.jsx(Ce,{type:"monotone",dataKey:"running",stackId:"1",stroke:"hsl(142 76% 36%)",fill:"hsl(142 76% 36%)",fillOpacity:.6,name:"Running"}),e.jsx(Ce,{type:"monotone",dataKey:"succeeded",stackId:"1",stroke:"hsl(217 91% 60%)",fill:"hsl(217 91% 60%)",fillOpacity:.6,name:"Succeeded"}),e.jsx(Ce,{type:"monotone",dataKey:"failed",stackId:"1",stroke:"hsl(0 84% 60%)",fill:"hsl(0 84% 60%)",fillOpacity:.6,name:"Failed"})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Stage Execution Timeline"}),e.jsx(ye,{width:"100%",height:300,children:e.jsxs(hs,{data:k.useMemo(()=>{const s=Date.now(),t=36e5,a=20,c=t/a,x=[];for(let g=0;g<=a;g++){const r=s-(t-g*c),A=new Date(r).toLocaleTimeString(),B=$.filter(_=>{const y=_.submissionTime||0,U=_.completionTime||1/0;return _.status==="ACTIVE"&&y<=r&&U>=r}).length,G=$.filter(_=>{const y=_.completionTime||0;return _.status==="COMPLETE"&&y>0&&y<=r}).length;x.push({time:A,timestamp:r,active:B,complete:G})}return x},[$]),children:[e.jsx(ke,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(we,{dataKey:"time",stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10}}),e.jsx(xe,{stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10}}),e.jsx(Se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"4px"}}),e.jsx(He,{}),e.jsx(Pe,{type:"monotone",dataKey:"active",stroke:"hsl(142 76% 36%)",strokeWidth:2,name:"Active Stages",dot:{r:3}}),e.jsx(Pe,{type:"monotone",dataKey:"complete",stroke:"hsl(217 91% 60%)",strokeWidth:2,name:"Complete Stages",dot:{r:3}})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Metrics Over Time"}),e.jsx(ye,{width:"100%",height:300,children:e.jsxs(hs,{data:k.useMemo(()=>{const s=Date.now(),t=36e5,a=20,c=t/a,x=[];for(let g=0;g<=a;g++){const r=s-(t-g*c),A=new Date(r).toLocaleTimeString(),B=L.filter(j=>{const w=typeof j.startTime=="string"?new Date(j.startTime).getTime():typeof j.startTime=="number"?j.startTime:0,I=j.endTime?typeof j.endTime=="string"?new Date(j.endTime).getTime():typeof j.endTime=="number"?j.endTime:1/0:1/0;return w<=r&&(I>=r||!j.endTime)}),G=B.reduce((j,w)=>j+(w.inputBytes||0),0),_=B.reduce((j,w)=>j+(w.outputBytes||0),0),y=(G+_)/3600,U=B.length>0?B.reduce((j,w)=>{const I=w.duration||0;return j+I},0)/B.length:0;x.push({time:A,timestamp:r,throughput:y/1024/1024,latency:U/1e3})}return x},[L]),children:[e.jsx(ke,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(we,{dataKey:"time",stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10}}),e.jsx(xe,{yAxisId:"left",stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10},label:{value:"Throughput (MB/s)",angle:-90,position:"insideLeft"}}),e.jsx(xe,{yAxisId:"right",orientation:"right",stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10},label:{value:"Latency (s)",angle:90,position:"insideRight"}}),e.jsx(Se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"4px"}}),e.jsx(He,{}),e.jsx(Pe,{yAxisId:"left",type:"monotone",dataKey:"throughput",stroke:"hsl(217 91% 60%)",strokeWidth:2,name:"Throughput (MB/s)",dot:{r:3}}),e.jsx(Pe,{yAxisId:"right",type:"monotone",dataKey:"latency",stroke:"hsl(142 76% 36%)",strokeWidth:2,name:"Avg Latency (s)",dot:{r:3}})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Event Timeline"}),e.jsx(d,{children:e.jsx(o,{className:"pt-6",children:e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:k.useMemo(()=>{const s=[];return L.forEach(t=>{const a=t.submissionTime||(typeof t.startTime=="string"?new Date(t.startTime).getTime():typeof t.startTime=="number"?t.startTime:Date.now()),c=typeof t.startTime=="string"?new Date(t.startTime).getTime():typeof t.startTime=="number"?t.startTime:Date.now(),x=t.completionTime||(t.endTime?typeof t.endTime=="string"?new Date(t.endTime).getTime():typeof t.endTime=="number"?t.endTime:0:0);s.push({id:`${t.id}-submission`,type:"job",event:"submission",timestamp:a,name:t.name,status:t.status}),c!==a&&s.push({id:`${t.id}-start`,type:"job",event:"start",timestamp:c,name:t.name,status:t.status}),x>0&&s.push({id:`${t.id}-completion`,type:"job",event:t.status==="FAILED"?"failed":"completion",timestamp:x,name:t.name,status:t.status})}),$.forEach(t=>{const a=t.submissionTime||0,c=t.completionTime||0;a>0&&s.push({id:`${t.id}-submission`,type:"stage",event:"submission",timestamp:a,name:t.name,status:t.status}),c>0&&c!==a&&s.push({id:`${t.id}-completion`,type:"stage",event:t.status==="FAILED"?"failed":"completion",timestamp:c,name:t.name,status:t.status})}),R.forEach(t=>{const a=t.startTime||Date.now(),c=t.lastHeartbeat||Date.now();s.push({id:`${t.id}-added`,type:"executor",event:"added",timestamp:a,name:t.id,status:t.status}),c>a&&s.push({id:`${t.id}-heartbeat`,type:"executor",event:"heartbeat",timestamp:c,name:t.id,status:t.status}),t.status==="DEAD"&&s.push({id:`${t.id}-removed`,type:"executor",event:"removed",timestamp:c+3e4,name:t.id,status:t.status})}),s.sort((t,a)=>a.timestamp-t.timestamp),s.slice(0,50)},[L,$,R]).map(s=>{const t=s.type==="job"?e.jsx(cs,{className:"h-4 w-4"}):s.type==="stage"?e.jsx(ds,{className:"h-4 w-4"}):e.jsx(qe,{className:"h-4 w-4"}),a=s.event==="failed"||s.event==="removed"?"text-red-600 dark:text-red-400":s.event==="completion"||s.event==="start"?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400";return e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-muted rounded-lg hover:bg-muted/80 transition-colors",children:[e.jsx("div",{className:`mt-0.5 ${a}`,children:t}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold text-sm",children:s.name}),e.jsx(S,{variant:"outline",className:"text-xs",children:s.type}),e.jsx(S,{variant:"outline",className:"text-xs",children:s.event})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(s.timestamp).toLocaleString()})]})]},s.id)})})})})]})]})]})}),e.jsx(te,{value:"storage",className:"space-y-4",children:e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Storage & Cache"}),e.jsx(J,{children:"RDD persistence and cache management"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{const s={id:`rdd-${Date.now()}`,rddId:`rdd-${Date.now()}`,name:`RDD ${V.length+1}`,storageLevel:"MEMORY_AND_DISK",memorySize:Math.floor(Math.random()*100*1024*1024),diskSize:Math.floor(Math.random()*200*1024*1024),cached:!0},t=[...V,s];ge(t),M({storageLevels:t}),h({title:"RDD persisted",description:"New RDD has been persisted to cache"})},children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Persist RDD"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{ge([]),M({storageLevels:[]}),h({title:"Cache cleared",description:"All cached RDDs have been cleared"})},children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),"Clear Cache"]})]})]})}),e.jsxs(o,{children:[e.jsx("div",{className:"space-y-4",children:V.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No cached RDDs"}):V.map(s=>e.jsxs(d,{className:"border-l-4 border-l-cyan-500",children:[e.jsx(m,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-lg",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(S,{variant:"outline",children:s.storageLevel}),e.jsx(S,{variant:"outline",children:s.rddId}),s.cached&&e.jsx(S,{variant:"outline",className:"bg-green-500",children:"Cached"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[s.cached?e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{const t=V.map(a=>a.id===s.id?{...a,cached:!1}:a);ge(t),M({storageLevels:t}),h({title:"RDD unpersisted",description:`${s.name} has been unpersisted from cache`})},children:"Unpersist"}):e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{const t=V.map(a=>a.id===s.id?{...a,cached:!0}:a);ge(t),M({storageLevels:t}),h({title:"RDD persisted",description:`${s.name} has been persisted to cache`})},children:"Persist"}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{const t=V.filter(a=>a.id!==s.id);ge(t),M({storageLevels:t}),h({title:"RDD removed",description:`${s.name} has been removed`})},children:e.jsx(Ie,{className:"h-4 w-4"})})]})]})}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Memory Size:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(s.memorySize)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Disk Size:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(s.diskSize)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Storage Level: ",s.storageLevel]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["RDD ID: ",s.rddId]})]})]})]},s.id))}),e.jsx(H,{className:"my-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Cache Statistics"})}),e.jsx(o,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Cached RDDs:"}),e.jsx("span",{className:"ml-2 font-semibold",children:V.filter(s=>s.cached).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Memory:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(V.reduce((s,t)=>s+t.memorySize,0))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Disk:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(V.reduce((s,t)=>s+t.diskSize,0))})]})]})})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(n,{className:"text-sm",children:"Block Manager"}),e.jsx(J,{children:"Block storage and memory management"})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Blocks:"}),e.jsx("span",{className:"ml-2 font-semibold",children:V.length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Memory Blocks:"}),e.jsx("span",{className:"ml-2 font-semibold",children:V.filter(s=>s.storageLevel.includes("MEMORY")).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Disk Blocks:"}),e.jsx("span",{className:"ml-2 font-semibold",children:V.filter(s=>s.storageLevel.includes("DISK")).length})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Memory Usage:"}),e.jsx("span",{className:"ml-2 font-semibold",children:(()=>{const s=R.reduce((a,c)=>a+c.memoryMax,0);return`${(V.reduce((a,c)=>a+c.memorySize,0)/s*100).toFixed(1)}%`})()})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Block Locations: Distributed across ",R.length," executors"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Memory Capacity: ",p(R.reduce((s,t)=>s+t.memoryMax,0))]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Disk Capacity: ",p(R.reduce((s,t)=>s+t.diskMax,0))]})]})]})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(n,{className:"text-sm",children:"Storage Usage Over Time"}),e.jsx(J,{children:"Memory and disk usage trends"})]}),e.jsx(o,{children:e.jsx(ye,{width:"100%",height:200,children:e.jsxs(us,{data:k.useMemo(()=>{const s=Date.now(),t=36e5,a=15,c=t/a,x=[];for(let g=0;g<=a;g++){const r=s-(t-g*c),A=new Date(r).toLocaleString("en-US",{hour:"2-digit",minute:"2-digit"}),B=V.reduce((w,I)=>w+I.memorySize,0),G=V.reduce((w,I)=>w+I.diskSize,0),_=R.reduce((w,I)=>w+I.memoryMax,0),y=R.reduce((w,I)=>w+I.diskMax,0),U=1+Math.sin(g/a*Math.PI*2)*.1,j=1+Math.cos(g/a*Math.PI*2)*.1;x.push({time:A,memory:B*U/_*100,disk:G*j/y*100})}return x},[V,R]),children:[e.jsx(ke,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(we,{dataKey:"time",stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10}}),e.jsx(xe,{stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10},domain:[0,100],label:{value:"Usage %",angle:-90,position:"insideLeft"}}),e.jsx(Se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"4px"}}),e.jsx(He,{}),e.jsx(Ce,{type:"monotone",dataKey:"memory",stroke:"hsl(217 91% 60%)",fill:"hsl(217 91% 60%)",fillOpacity:.6,name:"Memory Usage %"}),e.jsx(Ce,{type:"monotone",dataKey:"disk",stroke:"hsl(142 76% 36%)",fill:"hsl(142 76% 36%)",fillOpacity:.6,name:"Disk Usage %"})]})})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Storage Level Breakdown"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-2",children:["MEMORY_ONLY","MEMORY_AND_DISK","DISK_ONLY","MEMORY_ONLY_SER","MEMORY_AND_DISK_SER"].map(s=>{const t=V.filter(x=>x.storageLevel===s);if(t.length===0)return null;const a=t.reduce((x,g)=>x+g.memorySize,0),c=t.reduce((x,g)=>x+g.diskSize,0);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-sm",children:s}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[t.length," RDDs"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm",children:["Memory: ",p(a)]}),e.jsxs("div",{className:"text-sm",children:["Disk: ",p(c)]})]})]},s)})})})]})]})]})]})}),e.jsxs(te,{value:"environment",className:"space-y-4",children:[e.jsxs(d,{children:[e.jsx(m,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Environment Variables"}),e.jsx(J,{children:"System and Spark configuration"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>We(!0),children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Add Variable"]}),e.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{const s={SPARK_HOME:i.sparkMaster||"/opt/spark",JAVA_HOME:"/usr/lib/jvm/java-8-openjdk",PYSPARK_PYTHON:"/usr/bin/python3",SPARK_MASTER:i.master||i.sparkMaster||"local[*]",SPARK_APP_NAME:i.appName||i.sparkAppName||"archiphoenix-spark",SPARK_DRIVER_MEMORY:i.driverMemory||"2g",SPARK_EXECUTOR_MEMORY:i.executorMemory||"4g",SPARK_EXECUTOR_CORES:String(i.executorCores||2),...ve},t=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),c=document.createElement("a");c.href=a,c.download="spark-environment.json",c.click(),URL.revokeObjectURL(a),h({title:"Exported",description:"Environment configuration exported"})},children:[e.jsx(St,{className:"h-4 w-4 mr-2"}),"Export Environment"]})]})]})}),e.jsxs(o,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx(n,{className:"text-sm",children:"System Variables"})}),e.jsx("div",{className:"space-y-2",children:[{key:"SPARK_HOME",value:i.sparkMaster||"/opt/spark",editable:!1},{key:"JAVA_HOME",value:"/usr/lib/jvm/java-8-openjdk",editable:!1},{key:"PYSPARK_PYTHON",value:"/usr/bin/python3",editable:!1}].map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsx("span",{className:"font-mono text-sm",children:s.key}),e.jsx("div",{className:"flex items-center gap-2",children:de?.key===s.key?e.jsxs(e.Fragment,{children:[e.jsx(O,{value:de.value,onChange:t=>oe({...de,value:t.target.value}),className:"w-64 h-8"}),e.jsx(b,{size:"sm",onClick:()=>{oe(null)},children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:s.value}),s.editable&&e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>oe({key:s.key,value:s.value}),children:e.jsx(Ne,{className:"h-4 w-4"})})]})})]},s.key))})]}),Object.keys(ve).length>0&&e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx(n,{className:"text-sm",children:"Custom Variables"})}),e.jsx("div",{className:"space-y-2",children:Object.entries(ve).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsx("span",{className:"font-mono text-sm",children:s}),e.jsx("div",{className:"flex items-center gap-2",children:de?.key===s?e.jsxs(e.Fragment,{children:[e.jsx(O,{value:de.value,onChange:a=>oe({...de,value:a.target.value}),className:"w-64 h-8"}),e.jsx(b,{size:"sm",onClick:()=>{const a={...ve,[s]:de.value};rs(a),M({environment:a}),oe(null),h({title:"Updated",description:`Environment variable ${s} updated`})},children:"Save"}),e.jsx(b,{size:"sm",variant:"outline",onClick:()=>oe(null),children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:t}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>oe({key:s,value:t}),children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>{const a={...ve};delete a[s],rs(a),M({environment:a}),h({title:"Removed",description:`Environment variable ${s} removed`})},children:e.jsx(Ie,{className:"h-4 w-4"})})]})})]},s))})]})]}),e.jsx(H,{}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm mb-3",children:"Spark Configuration"}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[{key:"spark.master",value:i.master||i.sparkMaster||"local[*]"},{key:"spark.app.name",value:i.appName||i.sparkAppName||"archiphoenix-spark"},{key:"spark.driver.memory",value:i.driverMemory||"2g"},{key:"spark.executor.memory",value:i.executorMemory||"4g"},{key:"spark.executor.cores",value:String(i.executorCores||2)},{key:"spark.dynamicAllocation.enabled",value:String(i.enableDynamicAllocation??!0)},{key:"spark.dynamicAllocation.minExecutors",value:String(i.minExecutors||1)},{key:"spark.dynamicAllocation.maxExecutors",value:String(i.maxExecutors||10)},{key:"spark.sql.shuffle.partitions",value:"200"},{key:"spark.default.parallelism",value:String(ue||2)},{key:"spark.serializer",value:"org.apache.spark.serializer.KryoSerializer"},{key:"spark.sql.adaptive.enabled",value:"true"},{key:"spark.sql.adaptive.coalescePartitions.enabled",value:"true"},{key:"spark.sql.adaptive.skewJoin.enabled",value:"true"},{key:"spark.network.timeout",value:"800s"},{key:"spark.executor.heartbeatInterval",value:"10s"},{key:"spark.shuffle.service.enabled",value:String(i.enableDynamicAllocation??!0)},{key:"spark.sql.execution.arrow.pyspark.enabled",value:"true"},{key:"spark.sql.execution.arrow.maxRecordsPerBatch",value:"10000"}].map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsx("span",{className:"font-mono text-sm",children:s.key}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.value})]},s.key))})]}),e.jsx(H,{}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm mb-3",children:"JVM Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-xs text-muted-foreground",children:"Heap Size (Driver)"}),e.jsx("div",{className:"p-3 bg-muted rounded-lg mt-1",children:e.jsx("span",{className:"text-sm font-semibold",children:i.driverMemory||"2g"})})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-xs text-muted-foreground",children:"Heap Size (Executor)"}),e.jsx("div",{className:"p-3 bg-muted rounded-lg mt-1",children:e.jsx("span",{className:"text-sm font-semibold",children:i.executorMemory||"4g"})})]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-xs text-muted-foreground",children:"GC Type"}),e.jsx("div",{className:"p-3 bg-muted rounded-lg mt-1",children:e.jsx("span",{className:"text-sm font-semibold",children:"G1GC"})})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-xs text-muted-foreground",children:"GC Options"}),e.jsxs("div",{className:"p-3 bg-muted rounded-lg mt-1 space-y-1",children:[e.jsx("div",{className:"text-xs font-mono",children:"-XX:+UseG1GC"}),e.jsx("div",{className:"text-xs font-mono",children:"-XX:MaxGCPauseMillis=200"}),e.jsx("div",{className:"text-xs font-mono",children:"-XX:+PrintGCDetails"}),e.jsx("div",{className:"text-xs font-mono",children:"-XX:+PrintGCTimeStamps"})]})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-xs text-muted-foreground",children:"JVM Options"}),e.jsxs("div",{className:"p-3 bg-muted rounded-lg mt-1 space-y-1",children:[e.jsx("div",{className:"text-xs font-mono",children:"-XX:+UseCompressedOops"}),e.jsx("div",{className:"text-xs font-mono",children:"-XX:+UseCompressedClassPointers"}),e.jsx("div",{className:"text-xs font-mono",children:"-XX:+HeapDumpOnOutOfMemoryError"}),e.jsx("div",{className:"text-xs font-mono",children:"-XX:HeapDumpPath=/tmp/spark-heap-dump"})]})]})]})]}),e.jsx(H,{}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm mb-3",children:"Runtime Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsx("span",{children:"Java Version"}),e.jsx("span",{className:"text-muted-foreground",children:"1.8.0_312"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsx("span",{children:"Scala Version"}),e.jsx("span",{className:"text-muted-foreground",children:"2.12.15"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsx("span",{children:"Python Version"}),e.jsx("span",{className:"text-muted-foreground",children:"3.9.7"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsx("span",{children:"Spark Version"}),e.jsx("span",{className:"text-muted-foreground",children:"3.3.0"})]})]})]})]})]}),e.jsx(ae,{open:et,onOpenChange:We,children:e.jsxs(re,{children:[e.jsxs(ne,{children:[e.jsx(ie,{children:"Add Environment Variable"}),e.jsx(le,{children:"Add a custom environment variable to the Spark configuration"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Variable Name"}),e.jsx(O,{value:$e,onChange:s=>ns(s.target.value),placeholder:"MY_CUSTOM_VAR"})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Variable Value"}),e.jsx(O,{value:is,onChange:s=>ls(s.target.value),placeholder:"value"})]})]}),e.jsxs(be,{children:[e.jsx(b,{variant:"outline",onClick:()=>{We(!1),ns(""),ls("")},children:"Cancel"}),e.jsx(b,{onClick:()=>{if(!$e||!is){h({title:"Error",description:"Variable name and value are required",variant:"destructive"});return}const s={...ve,[$e]:is};rs(s),M({environment:s}),We(!1),ns(""),ls(""),h({title:"Added",description:`Environment variable ${$e} added`})},children:"Add"})]})]})})]}),e.jsx(te,{value:"metrics",className:"space-y-4",children:e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(n,{children:"Additional Metrics"}),e.jsx(J,{children:"GC, Network, Disk, and JVM metrics"})]}),e.jsxs(o,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(n,{className:"text-sm mb-4",children:"GC Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"GC Pause Time"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?`${u.gcPauseTime.toFixed(0)} ms`:"0 ms"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Total pause time"})]})]}),e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"GC Frequency"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?`${u.gcFrequency.toFixed(1)} /hour`:"0 /hour"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"GC events per hour"})]})]}),e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"Memory Before GC"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?`${u.memoryBeforeGC.toFixed(2)} GB`:"0 GB"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Memory before last GC"})]})]}),e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"Memory After GC"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?`${u.memoryAfterGC.toFixed(2)} GB`:"0 GB"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Memory after last GC"})]})]})]})]}),e.jsx(H,{}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm mb-4",children:"Network Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"Total Network I/O"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?p(u.totalNetworkIO):"0 B"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Total network traffic"})]})]}),e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"Network Utilization"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?`${u.networkUtilization.toFixed(1)}%`:"0%"}),e.jsx(me,{value:u?.networkUtilization||0,className:"mt-2"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Network bandwidth usage"})]})]}),e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"Network Errors"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?u.networkErrors:0}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Total network errors"})]})]})]})]}),e.jsx(H,{}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm mb-4",children:"Disk Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"Disk I/O Rate"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?`${(u.diskIORate/1024/1024).toFixed(2)} MB/s`:"0 MB/s"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Disk I/O throughput"})]})]}),e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"Disk Utilization"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?`${u.diskUtilization.toFixed(1)}%`:"0%"}),e.jsx(me,{value:u?.diskUtilization||0,className:"mt-2"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Disk space usage"})]})]}),e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"Disk Errors"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?u.diskErrors:0}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Total disk errors"})]})]})]})]}),e.jsx(H,{}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm mb-4",children:"JVM Metrics"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"Heap Usage"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?`${u.heapUsage.toFixed(2)} GB`:"0 GB"}),e.jsx(me,{value:u&&u.totalMemory>0?u.heapUsage/u.totalMemory*100:0,className:"mt-2"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:u&&u.totalMemory>0?`of ${u.totalMemory.toFixed(2)} GB`:"Heap memory"})]})]}),e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"Non-Heap Usage"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?`${u.nonHeapUsage.toFixed(2)} GB`:"0 GB"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Metaspace, code cache, etc."})]})]}),e.jsxs(d,{children:[e.jsx(m,{className:"pb-3",children:e.jsx(n,{className:"text-xs text-muted-foreground",children:"Thread Count"})}),e.jsxs(o,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u?u.threadCount:0}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Active threads"})]})]})]})]}),e.jsx(H,{}),e.jsxs("div",{children:[e.jsx(n,{className:"text-sm mb-4",children:"Metrics Over Time"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-xs",children:"GC Pause Time"})}),e.jsx(o,{children:e.jsx(ye,{width:"100%",height:150,children:e.jsxs(us,{data:k.useMemo(()=>{const s=Date.now(),t=36e5,a=15,c=t/a,x=[];for(let g=0;g<=a;g++){const r=s-(t-g*c),A=new Date(r).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),B=u?.gcPauseTime||0,G=1+Math.sin(g/a*Math.PI*2)*.3;x.push({time:A,pauseTime:B*G})}return x},[u]),children:[e.jsx(ke,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(we,{dataKey:"time",stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10}}),e.jsx(xe,{stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10}}),e.jsx(Se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"4px"}}),e.jsx(Ce,{type:"monotone",dataKey:"pauseTime",stroke:"hsl(0 84% 60%)",fill:"hsl(0 84% 60%)",fillOpacity:.6,name:"GC Pause (ms)"})]})})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-xs",children:"Network Utilization"})}),e.jsx(o,{children:e.jsx(ye,{width:"100%",height:150,children:e.jsxs(hs,{data:k.useMemo(()=>{const s=Date.now(),t=36e5,a=15,c=t/a,x=[];for(let g=0;g<=a;g++){const r=s-(t-g*c),A=new Date(r).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),B=u?.networkUtilization||0,G=1+Math.sin(g/a*Math.PI*2)*.2;x.push({time:A,utilization:Math.min(100,B*G)})}return x},[u]),children:[e.jsx(ke,{strokeDasharray:"3 3",stroke:"hsl(var(--border))"}),e.jsx(we,{dataKey:"time",stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10}}),e.jsx(xe,{stroke:"hsl(var(--muted-foreground))",tick:{fontSize:10},domain:[0,100]}),e.jsx(Se,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"4px"}}),e.jsx(Pe,{type:"monotone",dataKey:"utilization",stroke:"hsl(217 91% 60%)",strokeWidth:2,name:"Utilization %",dot:{r:3}})]})})})]})]})]})]})]})}),e.jsx(te,{value:"settings",className:"space-y-4",children:e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(n,{children:"Spark Settings"}),e.jsx(J,{children:"Application configuration"})]}),e.jsxs(o,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Master URL"}),e.jsx(O,{value:Ee,onChange:s=>M({sparkMaster:s.target.value}),placeholder:"spark://master:7077"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Application Name"}),e.jsx(O,{value:Qs,onChange:s=>M({sparkAppName:s.target.value}),placeholder:"Spark Application"})]}),e.jsx(H,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Driver Memory"}),e.jsx(O,{type:"text",value:i.driverMemory||"2g",onChange:s=>M({driverMemory:s.target.value}),placeholder:"2g"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Executor Memory"}),e.jsx(O,{type:"text",value:i.executorMemory||"4g",onChange:s=>M({executorMemory:s.target.value}),placeholder:"4g"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Executor Cores"}),e.jsx(O,{type:"number",value:i.executorCores||2,onChange:s=>M({executorCores:parseInt(s.target.value)||2}),min:1,max:32})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Min Executors"}),e.jsx(O,{type:"number",value:i.minExecutors||1,onChange:s=>M({minExecutors:parseInt(s.target.value)||1}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Max Executors"}),e.jsx(O,{type:"number",value:i.maxExecutors||10,onChange:s=>M({maxExecutors:parseInt(s.target.value)||10}),min:1})]}),e.jsx(H,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(C,{children:"Enable Dynamic Allocation"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Dynamically scale executors"})]}),e.jsx(xs,{checked:i.enableDynamicAllocation??!0,onCheckedChange:s=>M({enableDynamicAllocation:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(C,{children:"Enable Checkpointing"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Save state for fault tolerance"})]}),e.jsx(xs,{checked:i.enableCheckpointing??!0,onCheckedChange:s=>M({enableCheckpointing:s})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Checkpoint Directory"}),e.jsx(O,{type:"text",value:i.checkpointDirectory||"/checkpoint",onChange:s=>M({checkpointDirectory:s.target.value}),placeholder:"/checkpoint"})]}),e.jsx(H,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(C,{children:"Enable Streaming"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable Spark Streaming"})]}),e.jsx(xs,{checked:i.enableStreaming??!1,onCheckedChange:s=>M({enableStreaming:s})})]}),i.enableStreaming&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Batch Interval (ms)"}),e.jsx(O,{type:"number",value:i.streamingBatchInterval||1e3,onChange:s=>M({streamingBatchInterval:parseInt(s.target.value)||1e3}),min:100,max:6e4})]})]})]})})]}),e.jsx(ae,{open:Hs,onOpenChange:Be,children:e.jsxs(re,{children:[e.jsxs(ne,{children:[e.jsx(ie,{children:"Create New Job"}),e.jsx(le,{children:"Create a new Spark job"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Job Name"}),e.jsx(O,{id:"job-name",placeholder:"My Spark Job",onKeyDown:s=>{if(s.key==="Enter"){const t=s.target;ks({name:t.value})}}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Stages"}),e.jsx(O,{type:"number",defaultValue:3,min:1,id:"job-stages"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Tasks"}),e.jsx(O,{type:"number",defaultValue:100,min:1,id:"job-tasks"})]})]}),e.jsxs(be,{children:[e.jsx(b,{variant:"outline",onClick:()=>Be(!1),children:"Cancel"}),e.jsx(b,{onClick:()=>{const s=document.getElementById("job-name"),t=document.getElementById("job-stages"),a=document.getElementById("job-tasks");ks({name:s.value,stages:parseInt(t.value)||3,tasks:parseInt(a.value)||100})},children:"Create"})]})]})}),e.jsx(ae,{open:qs,onOpenChange:Oe,children:e.jsxs(re,{children:[e.jsxs(ne,{children:[e.jsx(ie,{children:"Add Executor"}),e.jsx(le,{children:"Add a new Spark executor"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Executor ID"}),e.jsx(O,{id:"executor-id",placeholder:"executor-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Host"}),e.jsx(O,{id:"executor-host",placeholder:"host.example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{children:"Cores"}),e.jsx(O,{type:"number",defaultValue:i.executorCores||2,min:1,max:32,id:"executor-cores"})]})]}),e.jsxs(be,{children:[e.jsx(b,{variant:"outline",onClick:()=>Oe(!1),children:"Cancel"}),e.jsx(b,{onClick:()=>{const s=document.getElementById("executor-id"),t=document.getElementById("executor-host"),a=document.getElementById("executor-cores");tt({id:s.value,host:t.value,cores:parseInt(a.value)||i.executorCores||2})},children:"Add"})]})]})}),e.jsx(ae,{open:!!ss,onOpenChange:s=>!s&&ze(null),children:e.jsxs(re,{children:[e.jsxs(ne,{children:[e.jsx(ie,{children:"Delete Job"}),e.jsx(le,{children:"Are you sure you want to delete this job? This action cannot be undone."})]}),e.jsxs(be,{children:[e.jsx(b,{variant:"outline",onClick:()=>ze(null),children:"Cancel"}),e.jsx(b,{variant:"destructive",onClick:()=>ss&&st(ss),children:"Delete"})]})]})}),e.jsx(ae,{open:!!ts,onOpenChange:s=>!s&&Ve(null),children:e.jsxs(re,{children:[e.jsxs(ne,{children:[e.jsx(ie,{children:"Remove Executor"}),e.jsx(le,{children:"Are you sure you want to remove this executor? This action cannot be undone."})]}),e.jsxs(be,{children:[e.jsx(b,{variant:"outline",onClick:()=>Ve(null),children:"Cancel"}),e.jsx(b,{variant:"destructive",onClick:()=>ts&&at(ts),children:"Remove"})]})]})}),e.jsx(ae,{open:!!P,onOpenChange:s=>!s&&Fe(null),children:e.jsxs(re,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ne,{children:[e.jsxs(ie,{children:["Job Details: ",P?.name]}),e.jsx(le,{children:"Detailed information about the Spark job"})]}),P&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Status"})}),e.jsx(o,{children:e.jsx(S,{variant:"outline",className:Q(P.status),children:P.status})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Duration"})}),e.jsx(o,{children:e.jsx("span",{className:"text-sm",children:Ge(P.duration)})})]})]}),e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(n,{className:"text-sm",children:"Stages DAG"}),e.jsx(J,{children:"Stage dependencies visualization"})]}),e.jsx(o,{children:l?(()=>{const s=l.getJobDAG(P.id),t=s.stages,a=s.edges;if(t.length===0)return e.jsx("div",{className:"text-sm text-muted-foreground",children:"No stages available"});const c=new Map,x=new Map,g=new Set,r=[];for(t.filter(j=>!j.parentStageIds||j.parentStageIds.length===0).forEach(j=>{r.push({id:j.id,level:0}),x.set(j.id,0)});r.length>0;){const{id:j,level:w}=r.shift();if(g.has(j))continue;g.add(j);const I=t.find(W=>W.id===j);if(I?.childStageIds){for(const W of I.childStageIds)if(!g.has(W)){const Je=Math.max(w+1,x.get(W)||0);x.set(W,Je),r.push({id:W,level:Je})}}}const B=new Map;t.forEach(j=>{const w=x.get(j.id)||0;B.has(w)||B.set(w,[]),B.get(w).push(j.id)});const G=Math.max(...Array.from(B.keys())),_=800,y=Math.max(400,(G+1)*120),U=_/(G+1);return B.forEach((j,w)=>{const I=y/(j.length+1);j.forEach((W,Je)=>{c.set(W,{x:w*U+U/2,y:(Je+1)*I})})}),e.jsx("div",{className:"overflow-auto border rounded-lg p-4 bg-muted/20",children:e.jsxs("svg",{width:_,height:y,className:"w-full",children:[a.map((j,w)=>{const I=c.get(j.from),W=c.get(j.to);return!I||!W?null:e.jsx("line",{x1:I.x,y1:I.y,x2:W.x,y2:W.y,stroke:"currentColor",strokeWidth:"2",className:"text-muted-foreground",markerEnd:"url(#arrowhead)"},`edge-${w}`)}),e.jsx("defs",{children:e.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto",children:e.jsx("polygon",{points:"0 0, 10 3, 0 6",fill:"currentColor",className:"text-muted-foreground"})})}),t.map(j=>{const w=c.get(j.id);if(!w)return null;const I=Q(j.status),W=j.status==="ACTIVE";return e.jsxs("g",{children:[e.jsx("circle",{cx:w.x,cy:w.y,r:W?35:30,fill:W?"currentColor":"transparent",className:W?`${I} opacity-20`:"",stroke:"currentColor",strokeWidth:"2",className:`${I} cursor-pointer hover:opacity-80`}),e.jsx("text",{x:w.x,y:w.y-5,textAnchor:"middle",className:"text-xs font-semibold fill-foreground",children:j.name}),e.jsxs("text",{x:w.x,y:w.y+15,textAnchor:"middle",className:"text-[10px] fill-muted-foreground",children:[j.numCompleteTasks,"/",j.numTasks]})]},j.id)})]})})})():e.jsx("div",{className:"text-sm text-muted-foreground",children:"No stages available"})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Stages List"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-2",children:l?l.getStagesForJob(P.id).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:s.name}),s.stageType&&e.jsx(S,{variant:"outline",className:"text-xs",children:s.stageType})]}),e.jsx(S,{variant:"outline",className:Q(s.status),children:s.status})]},s.id)):e.jsx("div",{className:"text-sm text-muted-foreground",children:"No stages available"})})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Data Metrics"})}),e.jsx(o,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Input Bytes:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(P.inputBytes)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Output Bytes:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(P.outputBytes)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shuffle Read:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(P.shuffleRead)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shuffle Write:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(P.shuffleWrite)})]})]})})]}),l&&(()=>{const s=l.getStagesForJob(P.id);if(!s.some(r=>r.shuffleNetworkRead&&r.shuffleNetworkRead>0||r.shuffleSpillMemory&&r.shuffleSpillMemory>0))return null;const a=s.reduce((r,A)=>r+(A.shuffleNetworkRead||0),0),c=s.reduce((r,A)=>r+(A.shuffleNetworkWrite||0),0),x=s.reduce((r,A)=>r+(A.shuffleSpillMemory||0),0),g=s.reduce((r,A)=>r+(A.shuffleSpillDisk||0),0);return e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(n,{className:"text-sm",children:"Shuffle Network & Spill Metrics"}),e.jsx(J,{children:"Network I/O and memory spill during shuffle operations"})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Network Read:"}),e.jsx("span",{className:"ml-2 font-semibold text-blue-600 dark:text-blue-400",children:p(a)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Network Write:"}),e.jsx("span",{className:"ml-2 font-semibold text-blue-600 dark:text-blue-400",children:p(c)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Memory Spill:"}),e.jsx("span",{className:"ml-2 font-semibold text-orange-600 dark:text-orange-400",children:p(x)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Disk Spill Read:"}),e.jsx("span",{className:"ml-2 font-semibold text-orange-600 dark:text-orange-400",children:p(g)})]})]}),x>0&&e.jsxs("div",{className:"mt-3 p-2 bg-orange-50 dark:bg-orange-950/20 rounded text-xs text-orange-800 dark:text-orange-200",children:[e.jsx(Le,{className:"h-3 w-3 inline mr-1"}),"Memory spill detected. Consider increasing executor memory or reducing shuffle operations."]})]})]})})(),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Timeline"})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[P.submissionTime&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Submission:"}),e.jsx("span",{children:new Date(P.submissionTime).toLocaleString()})]}),P.startTime&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Start:"}),e.jsx("span",{children:new Date(P.startTime).toLocaleString()})]}),P.completionTime&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Completion:"}),e.jsx("span",{children:new Date(P.completionTime).toLocaleString()})]})]})})]}),P.status==="RUNNING"&&e.jsx(be,{children:e.jsx(b,{variant:"destructive",onClick:()=>{l&&P&&(l.removeJob(P.id),h({title:"Job killed",description:"The job has been terminated"}),Fe(null))},children:"Kill Job"})})]})]})}),e.jsx(ae,{open:!!f,onOpenChange:s=>!s&&Ns(null),children:e.jsxs(re,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ne,{children:[e.jsxs(ie,{children:["Stage Details: ",f?.name]}),e.jsx(le,{children:"Detailed information about the Spark stage"})]}),f&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Status"})}),e.jsx(o,{children:e.jsx(S,{variant:"outline",className:Q(f.status),children:f.status})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Tasks"})}),e.jsxs(o,{children:[e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{children:["Total: ",f.numTasks]}),e.jsxs("div",{children:["Complete: ",f.numCompleteTasks]}),e.jsxs("div",{children:["Active: ",f.numActiveTasks]}),f.numFailedTasks>0&&e.jsxs("div",{className:"text-red-600",children:["Failed: ",f.numFailedTasks]})]}),e.jsx("div",{className:"mt-2",children:e.jsx(me,{value:f.numCompleteTasks/f.numTasks*100,className:"h-2"})})]})]})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Data Metrics"})}),e.jsx(o,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Input Bytes:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(f.inputBytes)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Output Bytes:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(f.outputBytes)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shuffle Read:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(f.shuffleRead)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shuffle Write:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(f.shuffleWrite)})]}),f.stageType&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Stage Type:"}),e.jsx("span",{className:"ml-2 font-semibold",children:e.jsx(S,{variant:"outline",children:f.stageType})})]})]})})]}),f.shuffleNetworkRead&&f.shuffleNetworkRead>0||f.shuffleSpillMemory&&f.shuffleSpillMemory>0?e.jsxs(d,{children:[e.jsxs(m,{children:[e.jsx(n,{className:"text-sm",children:"Shuffle Network & Spill Metrics"}),e.jsx(J,{children:"Detailed shuffle operation metrics"})]}),e.jsxs(o,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[f.shuffleNetworkRead&&f.shuffleNetworkRead>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Network Read:"}),e.jsx("span",{className:"ml-2 font-semibold text-blue-600 dark:text-blue-400",children:p(f.shuffleNetworkRead)})]}),f.shuffleNetworkWrite&&f.shuffleNetworkWrite>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Network Write:"}),e.jsx("span",{className:"ml-2 font-semibold text-blue-600 dark:text-blue-400",children:p(f.shuffleNetworkWrite)})]}),f.shuffleSpillMemory&&f.shuffleSpillMemory>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Memory Spill:"}),e.jsx("span",{className:"ml-2 font-semibold text-orange-600 dark:text-orange-400",children:p(f.shuffleSpillMemory)})]}),f.shuffleSpillDisk&&f.shuffleSpillDisk>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Disk Spill:"}),e.jsx("span",{className:"ml-2 font-semibold text-orange-600 dark:text-orange-400",children:p(f.shuffleSpillDisk)})]}),f.shuffleFetchWaitTime&&f.shuffleFetchWaitTime>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Fetch Wait Time:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[f.shuffleFetchWaitTime.toFixed(0),"ms"]})]})]}),f.shuffleSpillMemory&&f.shuffleSpillMemory>0&&e.jsxs("div",{className:"mt-3 p-2 bg-orange-50 dark:bg-orange-950/20 rounded text-xs text-orange-800 dark:text-orange-200",children:[e.jsx(Le,{className:"h-3 w-3 inline mr-1"}),"Memory spill detected. This indicates high memory pressure during shuffle operations."]})]})]}):null,e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Shuffle Details"})}),e.jsx(o,{children:e.jsx("div",{className:"space-y-2 text-sm",children:R.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[e.jsx("span",{children:s.id}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("span",{className:"text-muted-foreground",children:["R: ",p(s.totalShuffleRead||0)]}),e.jsxs("span",{className:"text-muted-foreground",children:["W: ",p(s.totalShuffleWrite||0)]})]})]},s.id))})})]}),f.duration&&e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Timeline"})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[f.submissionTime&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Submission:"}),e.jsx("span",{children:new Date(f.submissionTime).toLocaleString()})]}),f.completionTime&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Completion:"}),e.jsx("span",{children:new Date(f.completionTime).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Duration:"}),e.jsx("span",{children:Ge(f.duration)})]})]})})]})]})]})}),e.jsx(ae,{open:!!E,onOpenChange:s=>!s&&bs(null),children:e.jsxs(re,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ne,{children:[e.jsxs(ie,{children:["Executor Details: ",E?.id]}),e.jsx(le,{children:"Detailed information about the Spark executor"})]}),E&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Status"})}),e.jsx(o,{children:e.jsx(S,{variant:"outline",className:Q(E.status),children:E.status})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Host"})}),e.jsx(o,{children:e.jsx("span",{className:"text-sm",children:E.host})})]})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Resources"})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Memory"}),e.jsxs("span",{children:[(E.memoryUsed/1024).toFixed(1)," / ",(E.memoryMax/1024).toFixed(1)," GB"]})]}),e.jsx(me,{value:E.memoryUsed/E.memoryMax*100,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Disk"}),e.jsxs("span",{children:[(E.diskUsed/1024).toFixed(1)," / ",(E.diskMax/1024).toFixed(1)," GB"]})]}),e.jsx(me,{value:E.diskUsed/E.diskMax*100,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mt-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Cores:"}),e.jsx("span",{className:"ml-2 font-semibold",children:E.cores})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Active Tasks:"}),e.jsx("span",{className:"ml-2 font-semibold",children:E.activeTasks})]})]})]})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Task Metrics"})}),e.jsx(o,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Tasks:"}),e.jsx("span",{className:"ml-2 font-semibold",children:E.totalTasks})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Active Tasks:"}),e.jsx("span",{className:"ml-2 font-semibold",children:E.activeTasks})]})]})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Data Metrics"})}),e.jsx(o,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Input Bytes:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(E.totalInputBytes)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shuffle Read:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(E.totalShuffleRead)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Shuffle Write:"}),e.jsx("span",{className:"ml-2 font-semibold",children:p(E.totalShuffleWrite)})]})]})})]}),e.jsxs(d,{children:[e.jsx(m,{children:e.jsx(n,{className:"text-sm",children:"Timeline"})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-2 text-sm",children:[E.startTime&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Start Time:"}),e.jsx("span",{children:new Date(E.startTime).toLocaleString()})]}),E.lastHeartbeat&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Heartbeat:"}),e.jsx("span",{children:new Date(E.lastHeartbeat).toLocaleString()})]})]})})]})]})]})})]})})}export{fa as SparkConfigAdvanced};

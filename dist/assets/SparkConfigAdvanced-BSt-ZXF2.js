import{E as W,u as O,j as s,r as z,i as P,S,C as a,e as t,f as l,A as E,k as r,Z as K,R as T,T as X,a as Z,b as p,c as _,d as N,h as f,N as A,X as B,B as i,L as o,I as h}from"./index-2Qx8irw2.js";import{R as q}from"./refresh-ccw-DHaGPCfE.js";import{D as H}from"./database-Ck9K8pXy.js";import{C as D}from"./circle-check-big-XTaBX9af.js";import{C as R}from"./clock-DYxsyur0.js";const Q=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],b=W("cpu",Q);function ds({componentId:y}){const{nodes:L,updateNode:I}=O(),g=L.find(e=>e.id===y);if(!g)return s.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const d=g.data.config||{},j=d.jobs||[],k=d.stages||[],u=d.executors||[],$=d.totalJobs||j.length,J=d.activeJobs||j.filter(e=>e.status==="RUNNING").length,U=d.totalExecutors||u.length,V=d.totalCores||u.reduce((e,c)=>e+c.cores,0),F=d.totalMemory||u.reduce((e,c)=>e+c.memoryMax,0),G=d.sparkMaster||"spark://master:7077",w=d.sparkAppName||"Spark Application",[Y,ss]=z.useState(""),C=e=>{I(y,{data:{...g.data,config:{...d,...e}}})},x=e=>{switch(e){case"RUNNING":case"ACTIVE":case"ALIVE":return"bg-green-500";case"SUCCEEDED":case"COMPLETE":return"bg-blue-500";case"FAILED":case"DEAD":return"bg-red-500";case"KILLED":return"bg-gray-500";default:return"bg-gray-500"}},n=e=>{if(!e)return"0 B";const c=["B","KB","MB","GB","TB"],m=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,m)).toFixed(2)} ${c[m]}`},M=e=>{if(!e)return"0s";const c=Math.floor(e/3600),m=Math.floor(e%3600/60),v=e%60;return c>0?`${c}h ${m}m ${v}s`:m>0?`${m}m ${v}s`:`${v}s`};return s.jsx("div",{className:"h-full overflow-y-auto bg-background",children:s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Apache Spark"}),s.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Spark Application"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Unified analytics engine for large-scale data processing"})]}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(P,{variant:"outline",size:"sm",children:[s.jsx(q,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),s.jsx(S,{}),s.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[s.jsxs(a,{className:"border-l-4 border-l-blue-500 bg-card",children:[s.jsx(t,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(l,{className:"text-sm font-medium text-muted-foreground",children:"Jobs"}),s.jsx(E,{className:"h-4 w-4 text-blue-500"})]})}),s.jsxs(r,{children:[s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:$}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"total"})]}),s.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[J," active"]})]})]}),s.jsxs(a,{className:"border-l-4 border-l-green-500 bg-card",children:[s.jsx(t,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(l,{className:"text-sm font-medium text-muted-foreground",children:"Executors"}),s.jsx(b,{className:"h-4 w-4 text-green-500"})]})}),s.jsx(r,{children:s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:U}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"alive"})]})})]}),s.jsxs(a,{className:"border-l-4 border-l-purple-500 bg-card",children:[s.jsx(t,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(l,{className:"text-sm font-medium text-muted-foreground",children:"Cores"}),s.jsx(K,{className:"h-4 w-4 text-purple-500"})]})}),s.jsx(r,{children:s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:V}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"total"})]})})]}),s.jsxs(a,{className:"border-l-4 border-l-cyan-500 bg-card",children:[s.jsx(t,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(l,{className:"text-sm font-medium text-muted-foreground",children:"Memory"}),s.jsx(H,{className:"h-4 w-4 text-cyan-500"})]})}),s.jsx(r,{children:s.jsxs("div",{className:"flex items-baseline gap-2",children:[s.jsx("span",{className:"text-3xl font-bold text-cyan-600 dark:text-cyan-400",children:(F/1024).toFixed(1)}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"GB"})]})})]}),s.jsxs(a,{className:"border-l-4 border-l-orange-500 bg-card",children:[s.jsx(t,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(l,{className:"text-sm font-medium text-muted-foreground",children:"App Name"}),s.jsx(T,{className:"h-4 w-4 text-orange-500"})]})}),s.jsx(r,{children:s.jsx("div",{className:"text-sm font-semibold text-orange-600 dark:text-orange-400 truncate",children:w})})]})]}),s.jsxs(X,{defaultValue:"jobs",className:"space-y-4",children:[s.jsxs(Z,{children:[s.jsxs(p,{value:"jobs",children:[s.jsx(E,{className:"h-4 w-4 mr-2"}),"Jobs (",j.length,")"]}),s.jsxs(p,{value:"stages",children:[s.jsx(T,{className:"h-4 w-4 mr-2"}),"Stages (",k.length,")"]}),s.jsxs(p,{value:"executors",children:[s.jsx(b,{className:"h-4 w-4 mr-2"}),"Executors (",u.length,")"]}),s.jsxs(p,{value:"settings",children:[s.jsx(_,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),s.jsx(N,{value:"jobs",className:"space-y-4",children:s.jsxs(a,{children:[s.jsxs(t,{children:[s.jsx(l,{children:"Jobs"}),s.jsx(f,{children:"Spark application jobs"})]}),s.jsx(r,{children:s.jsx("div",{className:"space-y-4",children:j.map(e=>s.jsxs(a,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[s.jsx(t,{className:"pb-3",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${x(e.status)}/20`,children:e.status==="RUNNING"?s.jsx(A,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.status==="SUCCEEDED"?s.jsx(D,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}):s.jsx(B,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),s.jsxs("div",{children:[s.jsx(l,{className:"text-lg font-semibold",children:e.name}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx(i,{variant:"outline",className:x(e.status),children:e.status}),e.duration&&s.jsxs(i,{variant:"outline",children:[s.jsx(R,{className:"h-3 w-3 mr-1"}),M(e.duration)]}),e.stages&&s.jsxs(i,{variant:"outline",children:[e.stages," stages"]}),e.tasks&&s.jsxs(i,{variant:"outline",children:[e.tasks," tasks"]})]})]})]})})}),s.jsxs(r,{children:[s.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Input:"}),s.jsx("span",{className:"ml-2 font-semibold",children:n(e.inputBytes)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Output:"}),s.jsx("span",{className:"ml-2 font-semibold",children:n(e.outputBytes)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Shuffle Read:"}),s.jsx("span",{className:"ml-2 font-semibold",children:n(e.shuffleRead)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Shuffle Write:"}),s.jsx("span",{className:"ml-2 font-semibold",children:n(e.shuffleWrite)})]})]}),e.startTime&&s.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Started: ",new Date(e.startTime).toLocaleString(),e.endTime&&` â€¢ Ended: ${new Date(e.endTime).toLocaleString()}`]})]})]},e.id))})})]})}),s.jsx(N,{value:"stages",className:"space-y-4",children:s.jsxs(a,{children:[s.jsxs(t,{children:[s.jsx(l,{children:"Stages"}),s.jsx(f,{children:"Job execution stages"})]}),s.jsx(r,{children:s.jsx("div",{className:"space-y-4",children:k.map(e=>s.jsxs(a,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow bg-card",children:[s.jsx(t,{className:"pb-3",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${x(e.status)}/20`,children:e.status==="COMPLETE"?s.jsx(D,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}):e.status==="ACTIVE"?s.jsx(A,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):s.jsx(B,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),s.jsxs("div",{children:[s.jsx(l,{className:"text-lg font-semibold",children:e.name}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx(i,{variant:"outline",className:x(e.status),children:e.status}),s.jsxs(i,{variant:"outline",children:[e.numCompleteTasks,"/",e.numTasks," tasks"]}),e.duration&&s.jsxs(i,{variant:"outline",children:[s.jsx(R,{className:"h-3 w-3 mr-1"}),M(e.duration)]})]})]})]})})}),s.jsx(r,{children:s.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Input:"}),s.jsx("span",{className:"ml-2 font-semibold",children:n(e.inputBytes)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Output:"}),s.jsx("span",{className:"ml-2 font-semibold",children:n(e.outputBytes)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Shuffle Read:"}),s.jsx("span",{className:"ml-2 font-semibold",children:n(e.shuffleRead)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Shuffle Write:"}),s.jsx("span",{className:"ml-2 font-semibold",children:n(e.shuffleWrite)})]})]})})]},e.id))})})]})}),s.jsx(N,{value:"executors",className:"space-y-4",children:s.jsxs(a,{children:[s.jsxs(t,{children:[s.jsx(l,{children:"Executors"}),s.jsx(f,{children:"Spark executor nodes"})]}),s.jsx(r,{children:s.jsx("div",{className:"space-y-4",children:u.map(e=>s.jsxs(a,{className:"border-l-4 border-l-purple-500 hover:shadow-md transition-shadow bg-card",children:[s.jsx(t,{className:"pb-3",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${x(e.status)}/20`,children:s.jsx(b,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"})}),s.jsxs("div",{children:[s.jsx(l,{className:"text-lg font-semibold",children:e.id}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx(i,{variant:"outline",className:x(e.status),children:e.status}),s.jsx(i,{variant:"outline",children:e.host}),s.jsxs(i,{variant:"outline",children:[e.cores," cores"]})]})]})]})})}),s.jsx(r,{children:s.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Memory:"}),s.jsxs("span",{className:"ml-2 font-semibold",children:[(e.memoryUsed/1024).toFixed(1)," / ",(e.memoryMax/1024).toFixed(1)," GB"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Disk:"}),s.jsxs("span",{className:"ml-2 font-semibold",children:[(e.diskUsed/1024).toFixed(1)," / ",(e.diskMax/1024).toFixed(1)," GB"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Tasks:"}),s.jsxs("span",{className:"ml-2 font-semibold",children:[e.activeTasks," active / ",e.totalTasks," total"]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-muted-foreground",children:"Shuffle:"}),s.jsxs("span",{className:"ml-2 font-semibold",children:["R: ",n(e.totalShuffleRead)," W: ",n(e.totalShuffleWrite)]})]})]})})]},e.id))})})]})}),s.jsx(N,{value:"settings",className:"space-y-4",children:s.jsxs(a,{children:[s.jsxs(t,{children:[s.jsx(l,{children:"Spark Settings"}),s.jsx(f,{children:"Application configuration"})]}),s.jsxs(r,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(o,{children:"Master URL"}),s.jsx(h,{value:G,onChange:e=>C({sparkMaster:e.target.value}),placeholder:"spark://master:7077"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(o,{children:"Application Name"}),s.jsx(h,{value:w,onChange:e=>C({sparkAppName:e.target.value}),placeholder:"Spark Application"})]}),s.jsx(S,{}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(o,{children:"Driver Memory"}),s.jsx(h,{type:"text",defaultValue:"2g"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(o,{children:"Executor Memory"}),s.jsx(h,{type:"text",defaultValue:"4g"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(o,{children:"Executor Cores"}),s.jsx(h,{type:"number",defaultValue:4,min:1})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(o,{children:"Max Executors"}),s.jsx(h,{type:"number",defaultValue:10,min:1})]})]})]})})]})]})})}export{ds as SparkConfigAdvanced};

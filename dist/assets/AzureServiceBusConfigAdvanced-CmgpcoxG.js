import{u as R,j as e,r as z,S as y,C as d,e as o,f as p,k as x,B as V,T as F,a as G,b as S,d as w,h as T,i as g,P as k,L as c,I as l,m as D,t as N}from"./index-Dy7IKEk-.js";import{T as J}from"./textarea-E5z5wuOP.js";import{M as E}from"./message-square-Dh1HQU8p.js";import{K as U}from"./key-LnBklxjN.js";function ne({componentId:L}){const{nodes:Q,updateNode:B}=R(),M=Q.find(s=>s.id===L);if(!M)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const v=M.data.config||{},f=v.namespace||"archiphoenix.servicebus.windows.net",P=v.connectionString||"",u=v.queues||[],r=v.topics||[],[W,X]=z.useState(null),[Y,Z]=z.useState(null),m=s=>{B(L,{data:{...M.data,config:{...v,...s}}})},A=()=>{const s={name:"new-queue",namespace:f,maxSizeInMegabytes:1024,defaultMessageTimeToLive:2592e3,lockDuration:30,maxDeliveryCount:10,enablePartitioning:!1,enableDeadLetteringOnMessageExpiration:!0,enableSessions:!1,activeMessageCount:0,deadLetterMessageCount:0,scheduledMessageCount:0};m({queues:[...u,s]})},O=s=>{m({queues:u.filter((n,a)=>a!==s)})},h=(s,n,a)=>{const i=[...u];i[s]={...i[s],[n]:a},m({queues:i})},q=()=>{const s={name:"new-topic",namespace:f,maxSizeInMegabytes:1024,defaultMessageTimeToLive:2592e3,enablePartitioning:!1,subscriptions:[]};m({topics:[...r,s]})},_=s=>{m({topics:r.filter((n,a)=>a!==s)})},j=(s,n,a)=>{const i=[...r];i[s]={...i[s],[n]:a},m({topics:i})},I=s=>{const n=r[s];if(n){const a={name:"new-subscription",maxDeliveryCount:10,lockDuration:30,enableDeadLetteringOnMessageExpiration:!0,activeMessageCount:0},i=[...n.subscriptions||[],a];j(s,"subscriptions",i)}},K=(s,n)=>{const a=r[s];if(a&&a.subscriptions){const i=a.subscriptions.filter((t,b)=>b!==n);j(s,"subscriptions",i)}},C=(s,n,a,i)=>{const t=r[s];if(t&&t.subscriptions){const b=[...t.subscriptions];b[n]={...b[n],[a]:i},j(s,"subscriptions",b)}},H=u.reduce((s,n)=>s+(n.activeMessageCount||0),0)+r.reduce((s,n)=>s+(n.subscriptions?.reduce((a,i)=>a+(i.activeMessageCount||0),0)||0),0);return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Azure Service Bus"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Service Bus Namespace"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure queues, topics and subscriptions with sessions and dead-lettering"})]})}),e.jsx(y,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(p,{className:"text-sm font-medium",children:"Namespace"})}),e.jsx(x,{children:e.jsx(V,{variant:"outline",className:"truncate max-w-full",children:f})})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(p,{className:"text-sm font-medium",children:"Queues"})}),e.jsx(x,{children:e.jsx("span",{className:"text-2xl font-bold",children:u.length})})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(p,{className:"text-sm font-medium",children:"Topics"})}),e.jsx(x,{children:e.jsx("span",{className:"text-2xl font-bold",children:r.length})})]}),e.jsxs(d,{children:[e.jsx(o,{className:"pb-3",children:e.jsx(p,{className:"text-sm font-medium",children:"Total Messages"})}),e.jsx(x,{children:e.jsx("span",{className:"text-2xl font-bold",children:H.toLocaleString()})})]})]}),e.jsxs(F,{defaultValue:"queues",className:"space-y-4",children:[e.jsxs(G,{children:[e.jsxs(S,{value:"queues",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Queues (",u.length,")"]}),e.jsxs(S,{value:"topics",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Topics (",r.length,")"]}),e.jsxs(S,{value:"connection",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Connection"]})]}),e.jsx(w,{value:"queues",className:"space-y-4",children:e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(p,{children:"Queues"}),e.jsx(T,{children:"Configure Service Bus queues"})]}),e.jsxs(g,{onClick:A,size:"sm",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Create Queue"]})]})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:u.map((s,n)=>e.jsxs(d,{className:"border-l-4 border-l-blue-500",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(c,{children:"Queue Name"}),e.jsx(l,{value:s.name,onChange:a=>h(n,"name",a.target.value),placeholder:"queue-name"})]}),e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>O(n),disabled:u.length===1,className:"ml-4",children:e.jsx(D,{className:"h-4 w-4"})})]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active Messages"}),e.jsx("p",{className:"text-lg font-semibold",children:s.activeMessageCount||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Dead Letter"}),e.jsx("p",{className:"text-lg font-semibold",children:s.deadLetterMessageCount||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Scheduled"}),e.jsx("p",{className:"text-lg font-semibold",children:s.scheduledMessageCount||0})]})]}),e.jsx(y,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Max Size (MB)"}),e.jsx(l,{type:"number",value:s.maxSizeInMegabytes,onChange:a=>h(n,"maxSizeInMegabytes",Number(a.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Message TTL (seconds)"}),e.jsx(l,{type:"number",value:s.defaultMessageTimeToLive,onChange:a=>h(n,"defaultMessageTimeToLive",Number(a.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Lock Duration (seconds)"}),e.jsx(l,{type:"number",value:s.lockDuration,onChange:a=>h(n,"lockDuration",Number(a.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Max Delivery Count"}),e.jsx(l,{type:"number",value:s.maxDeliveryCount,onChange:a=>h(n,"maxDeliveryCount",Number(a.target.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{children:"Enable Sessions"}),e.jsx(N,{checked:s.enableSessions,onCheckedChange:a=>h(n,"enableSessions",a)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{children:"Enable Partitioning"}),e.jsx(N,{checked:s.enablePartitioning,onCheckedChange:a=>h(n,"enablePartitioning",a)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{children:"Dead Letter on Expiration"}),e.jsx(N,{checked:s.enableDeadLetteringOnMessageExpiration,onCheckedChange:a=>h(n,"enableDeadLetteringOnMessageExpiration",a)})]})]})]})]},n))})})]})}),e.jsx(w,{value:"topics",className:"space-y-4",children:e.jsxs(d,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(p,{children:"Topics"}),e.jsx(T,{children:"Configure publish-subscribe topics with subscriptions"})]}),e.jsxs(g,{onClick:q,size:"sm",children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Create Topic"]})]})}),e.jsx(x,{children:e.jsx("div",{className:"space-y-4",children:r.map((s,n)=>e.jsxs(d,{className:"border-l-4 border-l-green-500",children:[e.jsx(o,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(c,{children:"Topic Name"}),e.jsx(l,{value:s.name,onChange:a=>j(n,"name",a.target.value),placeholder:"topic-name"})]}),e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>_(n),disabled:r.length===1,className:"ml-4",children:e.jsx(D,{className:"h-4 w-4"})})]})}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Max Size (MB)"}),e.jsx(l,{type:"number",value:s.maxSizeInMegabytes,onChange:a=>j(n,"maxSizeInMegabytes",Number(a.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Message TTL (seconds)"}),e.jsx(l,{type:"number",value:s.defaultMessageTimeToLive,onChange:a=>j(n,"defaultMessageTimeToLive",Number(a.target.value))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{children:"Enable Partitioning"}),e.jsx(N,{checked:s.enablePartitioning,onCheckedChange:a=>j(n,"enablePartitioning",a)})]})]}),e.jsx(y,{}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs(c,{children:["Subscriptions (",s.subscriptions?.length||0,")"]}),e.jsxs(g,{size:"sm",variant:"outline",onClick:()=>I(n),children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Add Subscription"]})]}),s.subscriptions&&s.subscriptions.length>0?e.jsx("div",{className:"space-y-4",children:s.subscriptions.map((a,i)=>e.jsx(d,{className:"p-4 border-l-4 border-l-purple-500",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(c,{children:"Subscription Name"}),e.jsx(l,{value:a.name,onChange:t=>C(n,i,"name",t.target.value),placeholder:"subscription-name"})]}),e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>K(n,i),className:"ml-4",children:e.jsx(D,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Active Messages"}),e.jsx("p",{className:"text-lg font-semibold",children:a.activeMessageCount||0})]})}),e.jsx(y,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Lock Duration (seconds)"}),e.jsx(l,{type:"number",value:a.lockDuration,onChange:t=>C(n,i,"lockDuration",Number(t.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Max Delivery Count"}),e.jsx(l,{type:"number",value:a.maxDeliveryCount,onChange:t=>C(n,i,"maxDeliveryCount",Number(t.target.value))})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{children:"Dead Letter on Expiration"}),e.jsx(N,{checked:a.enableDeadLetteringOnMessageExpiration,onCheckedChange:t=>C(n,i,"enableDeadLetteringOnMessageExpiration",t)})]})]})},i))}):e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No subscriptions"})]})]})]},n))})})]})}),e.jsx(w,{value:"connection",className:"space-y-4",children:e.jsxs(d,{children:[e.jsxs(o,{children:[e.jsx(p,{children:"Connection Settings"}),e.jsx(T,{children:"Azure Service Bus connection string"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Namespace"}),e.jsx(l,{value:f,onChange:s=>m({namespace:s.target.value}),placeholder:"my-namespace.servicebus.windows.net"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Connection String"}),e.jsx(J,{value:P,onChange:s=>m({connectionString:s.target.value}),placeholder:"Endpoint=sb://...",rows:4})]})]})]})})]})]})})}export{ne as AzureServiceBusConfigAdvanced};

import{u as W,j as e,r as T,i as b,S as p,C as c,e as d,f as o,k as r,T as Y,a as Z,b as N,a2 as ee,c as se,d as f,h as y,B as x,X as ne,P as te,t as m,m as ie,L as i,I as v,n as S,o as C,p as k,q as w,s as l}from"./index-CHKNZn98.js";import{R as ae}from"./refresh-ccw-X6vm0O4r.js";import{S as le}from"./shield-BHxX70PM.js";import{B as ce}from"./ban-CWmd5fiO.js";import{C as re}from"./circle-check-big-D_CmPeBN.js";function pe({componentId:I}){const{nodes:L,updateNode:R}=W(),D=L.find(s=>s.id===I);if(!D)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const t=D.data.config||{},E=t.mode||"ids",H=t.enableSignatureDetection??!0,V=t.enableAnomalyDetection??!0,M=t.enableBehavioralAnalysis??!1,O=t.alertThreshold||"medium",B=t.enableAutoBlock??!1,z=t.blockDuration||3600,P=t.enableLogging??!0,F=t.logRetention||30,u=t.alerts||[{id:"1",type:"signature",sourceIP:"192.168.1.100",destinationIP:"10.0.0.50",protocol:"TCP",port:22,severity:"high",timestamp:new Date().toISOString(),description:"SSH brute force attempt detected",blocked:!0,signature:"SSH_BRUTE_FORCE"}],h=t.signatures||[{id:"1",name:"SSH Brute Force",description:"Detects multiple failed SSH login attempts",enabled:!0,severity:"high",pattern:"alert tcp any any -> any 22",action:"block"},{id:"2",name:"SQL Injection",description:"Detects SQL injection attempts",enabled:!0,severity:"critical",pattern:`content:"' OR 1=1"`,action:"block"}],g=t.blockedIPs||[{ip:"192.168.1.100",reason:"SSH brute force",blockedAt:new Date().toISOString(),duration:3600}],Q=t.totalAlerts||u.length,U=t.alertsBlocked||u.filter(s=>s.blocked).length,X=t.signaturesActive||h.filter(s=>s.enabled).length,[de,oe]=T.useState(null),[xe,_]=T.useState(!1),a=s=>{R(I,{data:{...D.data,config:{...t,...s}}})},$=()=>{const s={id:`sig-${Date.now()}`,name:"New Signature",description:"",enabled:!0,severity:"medium",pattern:"",action:"alert"};a({signatures:[...h,s]}),_(!1)},q=s=>{a({signatures:h.filter(n=>n.id!==s)})},j=(s,n,J)=>{const K=h.map(A=>A.id===s?{...A,[n]:J}:A);a({signatures:K})},G=s=>{a({blockedIPs:g.filter(n=>n.ip!==s)})};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"IDS / IPS"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Intrusion Detection & Prevention"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Monitor and protect network from security threats"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(b,{variant:"outline",size:"sm",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(p,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(c,{children:[e.jsx(d,{className:"pb-3",children:e.jsx(o,{className:"text-sm font-medium",children:"Total Alerts"})}),e.jsx(r,{children:e.jsx("span",{className:"text-2xl font-bold",children:Q})})]}),e.jsxs(c,{children:[e.jsx(d,{className:"pb-3",children:e.jsx(o,{className:"text-sm font-medium",children:"Alerts Blocked"})}),e.jsx(r,{children:e.jsx("span",{className:"text-2xl font-bold text-red-500",children:U})})]}),e.jsxs(c,{children:[e.jsx(d,{className:"pb-3",children:e.jsx(o,{className:"text-sm font-medium",children:"Active Signatures"})}),e.jsx(r,{children:e.jsx("span",{className:"text-2xl font-bold",children:X})})]}),e.jsxs(c,{children:[e.jsx(d,{className:"pb-3",children:e.jsx(o,{className:"text-sm font-medium",children:"Blocked IPs"})}),e.jsx(r,{children:e.jsx("span",{className:"text-2xl font-bold",children:g.length})})]})]}),e.jsxs(Y,{defaultValue:"alerts",className:"space-y-4",children:[e.jsxs(Z,{children:[e.jsxs(N,{value:"alerts",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Alerts (",u.length,")"]}),e.jsxs(N,{value:"signatures",children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),"Signatures (",h.length,")"]}),e.jsxs(N,{value:"blocked",children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Blocked IPs (",g.length,")"]}),e.jsxs(N,{value:"settings",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(f,{value:"alerts",className:"space-y-4",children:e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Security Alerts"}),e.jsx(y,{children:"Recent intrusion detection alerts"})]}),e.jsx(r,{children:u.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No alerts detected"}):e.jsx("div",{className:"space-y-2",children:u.map(s=>e.jsx(c,{className:`border-l-4 ${s.severity==="critical"?"border-l-red-500":s.severity==="high"?"border-l-orange-500":s.severity==="medium"?"border-l-yellow-500":"border-l-blue-500"}`,children:e.jsx(r,{className:"pt-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(x,{variant:s.severity==="critical"?"destructive":s.severity==="high"?"default":"outline",children:s.severity}),e.jsx(x,{variant:"outline",children:s.type}),s.blocked?e.jsxs(x,{variant:"default",className:"bg-green-500",children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),"Blocked"]}):e.jsxs(x,{variant:"outline",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Not Blocked"]})]}),e.jsx("p",{className:"font-medium mb-1",children:s.description}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Source: ",s.sourceIP," â†’ Destination: ",s.destinationIP]}),e.jsxs("p",{children:["Protocol: ",s.protocol," Port: ",s.port]}),e.jsxs("p",{children:["Time: ",new Date(s.timestamp).toLocaleString()]}),s.signature&&e.jsxs("p",{children:["Signature: ",s.signature]})]})]})})})},s.id))})})]})}),e.jsx(f,{value:"signatures",className:"space-y-4",children:e.jsxs(c,{children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Detection Signatures"}),e.jsx(y,{children:"Configure detection rules and patterns"})]}),e.jsxs(b,{onClick:$,size:"sm",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Create Signature"]})]})}),e.jsx(r,{children:e.jsx("div",{className:"space-y-4",children:h.map(s=>e.jsxs(c,{className:"border-l-4 border-l-blue-500",children:[e.jsx(d,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-base",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(x,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"}),e.jsx(x,{variant:s.severity==="critical"?"destructive":s.severity==="high"?"default":"outline",children:s.severity}),e.jsx(x,{variant:"outline",children:s.action})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{checked:s.enabled,onCheckedChange:n=>j(s.id,"enabled",n)}),e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>q(s.id),children:e.jsx(ie,{className:"h-4 w-4"})})]})]})}),e.jsx(r,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Signature Name"}),e.jsx(v,{value:s.name,onChange:n=>j(s.id,"name",n.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Severity"}),e.jsxs(S,{value:s.severity,onValueChange:n=>j(s.id,"severity",n),children:[e.jsx(C,{children:e.jsx(k,{})}),e.jsxs(w,{children:[e.jsx(l,{value:"critical",children:"Critical"}),e.jsx(l,{value:"high",children:"High"}),e.jsx(l,{value:"medium",children:"Medium"}),e.jsx(l,{value:"low",children:"Low"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Action"}),e.jsxs(S,{value:s.action,onValueChange:n=>j(s.id,"action",n),children:[e.jsx(C,{children:e.jsx(k,{})}),e.jsxs(w,{children:[e.jsx(l,{value:"block",children:"Block"}),e.jsx(l,{value:"alert",children:"Alert"}),e.jsx(l,{value:"log",children:"Log"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Description"}),e.jsx(v,{value:s.description,onChange:n=>j(s.id,"description",n.target.value),placeholder:"Signature description"})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(i,{children:"Pattern"}),e.jsx(v,{value:s.pattern,onChange:n=>j(s.id,"pattern",n.target.value),placeholder:"Detection pattern",className:"font-mono text-sm"})]})]})})]},s.id))})})]})}),e.jsx(f,{value:"blocked",className:"space-y-4",children:e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"Blocked IP Addresses"}),e.jsx(y,{children:"IPs currently blocked by the system"})]}),e.jsx(r,{children:g.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No IPs blocked"}):e.jsx("div",{className:"space-y-2",children:g.map((s,n)=>e.jsx(c,{className:"border-l-4 border-l-red-500",children:e.jsx(r,{className:"pt-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(x,{variant:"destructive",children:s.ip}),e.jsx(x,{variant:"outline",children:s.reason})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsxs("p",{children:["Blocked at: ",new Date(s.blockedAt).toLocaleString()]}),s.duration&&e.jsxs("p",{children:["Duration: ",s.duration," seconds"]}),s.expiresAt&&e.jsxs("p",{children:["Expires: ",new Date(s.expiresAt).toLocaleString()]})]})]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>G(s.ip),children:"Unblock"})]})})},n))})})]})}),e.jsx(f,{value:"settings",className:"space-y-4",children:e.jsxs(c,{children:[e.jsxs(d,{children:[e.jsx(o,{children:"IDS/IPS Settings"}),e.jsx(y,{children:"Configure detection and prevention settings"})]}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Operation Mode"}),e.jsxs(S,{value:E,onValueChange:s=>a({mode:s}),children:[e.jsx(C,{children:e.jsx(k,{})}),e.jsxs(w,{children:[e.jsx(l,{value:"ips",children:"IPS (Prevention - Active blocking)"}),e.jsx(l,{value:"ids",children:"IDS (Detection - Monitoring only)"})]})]})]}),e.jsx(p,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Signature Detection"}),e.jsx(m,{checked:H,onCheckedChange:s=>a({enableSignatureDetection:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Anomaly Detection"}),e.jsx(m,{checked:V,onCheckedChange:s=>a({enableAnomalyDetection:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Behavioral Analysis"}),e.jsx(m,{checked:M,onCheckedChange:s=>a({enableBehavioralAnalysis:s})})]})]}),e.jsx(p,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Alert Threshold"}),e.jsxs(S,{value:O,onValueChange:s=>a({alertThreshold:s}),children:[e.jsx(C,{children:e.jsx(k,{})}),e.jsxs(w,{children:[e.jsx(l,{value:"critical",children:"Critical"}),e.jsx(l,{value:"high",children:"High"}),e.jsx(l,{value:"medium",children:"Medium"}),e.jsx(l,{value:"low",children:"Low"})]})]})]}),e.jsx(p,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Auto Block"}),e.jsx(m,{checked:B,onCheckedChange:s=>a({enableAutoBlock:s})})]}),B&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Block Duration (seconds)"}),e.jsx(v,{type:"number",value:z,onChange:s=>a({blockDuration:Number(s.target.value)}),min:60,max:86400})]}),e.jsx(p,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(i,{children:"Enable Logging"}),e.jsx(m,{checked:P,onCheckedChange:s=>a({enableLogging:s})})]}),P&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{children:"Log Retention (days)"}),e.jsx(v,{type:"number",value:F,onChange:s=>a({logRetention:Number(s.target.value)}),min:1,max:365})]})]})]})})]})]})})}export{pe as IDSIPSConfigAdvanced};

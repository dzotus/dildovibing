import{E as W,u as X,j as e,r as u,i as b,S as V,C as l,e as r,f as c,k as i,A as I,Z as K,T as Q,a as Y,b as p,N as O,c as ee,d as g,h as v,L as a,n as B,o as D,p as E,q,s as A,B as d,ah as se,I as N,t as R}from"./index-D23A2X5A.js";import{T as $}from"./textarea-jYm4DBr1.js";import{R as ae}from"./refresh-ccw-C1sN3B1t.js";import{D as te}from"./database-NUChT3Xv.js";import{C as ne}from"./circle-check-big-D5vTmfeK.js";const le=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],y=W("flame",le);function oe({componentId:w}){const{nodes:F,updateNode:H}=X(),f=F.find(s=>s.id===w);if(!f)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const o=f.data.config||{},n=o.models||[],h=o.predictions||[],S=o.endpoint||"localhost:8080",z=o.totalModels||n.length,J=o.totalPredictions||h.length,Z=o.averageLatency||(n.length>0?n.reduce((s,t)=>s+(t.avgLatency||0),0)/n.length:0),[x,_]=u.useState(""),[j,C]=u.useState(""),[T,P]=u.useState(""),[G,k]=u.useState(""),M=s=>{H(w,{data:{...f.data,config:{...o,...s}}})},U=()=>{if(!x||!j)return;const s={id:`pred-${Date.now()}`,model:x,version:j,input:T,output:JSON.stringify({predictions:[[.85,.1,.05]]},null,2),status:"success",timestamp:new Date().toISOString(),latency:Math.floor(Math.random()*40)+20};k(s.output||""),M({predictions:[...h,s]})},L=s=>{switch(s){case"serving":return"bg-green-500";case"loading":return"bg-yellow-500";case"unavailable":return"bg-red-500";default:return"bg-gray-500"}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"PyTorch Serve"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Model Serving"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Flexible and easy-to-use serving for PyTorch models"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(b,{variant:"outline",size:"sm",children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(V,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(l,{className:"border-l-4 border-l-orange-500 bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Models"}),e.jsx(y,{className:"h-4 w-4 text-orange-500"})]})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400",children:z}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"serving"})]})})]}),e.jsxs(l,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Predictions"}),e.jsx(I,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:J}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"total"})]})})]}),e.jsxs(l,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Avg Latency"}),e.jsx(K,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(i,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:Z.toFixed(0)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"ms"})]})})]}),e.jsxs(l,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{className:"text-sm font-medium text-muted-foreground",children:"Endpoint"}),e.jsx(te,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsx(i,{children:e.jsx("div",{className:"text-sm font-semibold text-cyan-600 dark:text-cyan-400 truncate",children:S})})]})]}),e.jsxs(Q,{defaultValue:"test",className:"space-y-4",children:[e.jsxs(Y,{children:[e.jsxs(p,{value:"test",children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Test Prediction"]}),e.jsxs(p,{value:"models",children:[e.jsx(y,{className:"h-4 w-4 mr-2"}),"Models (",n.length,")"]}),e.jsxs(p,{value:"history",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Prediction History (",h.length,")"]}),e.jsxs(p,{value:"settings",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(g,{value:"test",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsx(c,{children:"Model Prediction"}),e.jsx(v,{children:"Test model inference"})]}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Model"}),e.jsxs(B,{value:x,onValueChange:s=>{_(s);const t=n.find(m=>m.name===s);t&&C(t.version)},children:[e.jsx(D,{children:e.jsx(E,{placeholder:"Select model"})}),e.jsx(q,{children:n.map(s=>e.jsx(A,{value:s.name,children:s.name},s.name))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Version"}),e.jsxs(B,{value:j,onValueChange:C,children:[e.jsx(D,{children:e.jsx(E,{placeholder:"Select version"})}),e.jsx(q,{children:x&&n.find(s=>s.name===x)&&e.jsx(A,{value:n.find(s=>s.name===x).version,children:n.find(s=>s.name===x).version})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Input (JSON)"}),e.jsx($,{value:T,onChange:s=>P(s.target.value),className:"font-mono text-sm min-h-[200px]",placeholder:'{ "data": [...] }'})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Output"}),e.jsx($,{value:G,readOnly:!0,className:"font-mono text-sm min-h-[200px] bg-muted",placeholder:"Prediction result will appear here..."})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{onClick:U,disabled:!x||!j,children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Run Prediction"]}),e.jsx(b,{variant:"outline",onClick:()=>{P(""),k("")},children:"Clear"})]})]})]})}),e.jsx(g,{value:"models",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsx(c,{children:"Models"}),e.jsx(v,{children:"Deployed PyTorch models"})]}),e.jsx(i,{children:e.jsx("div",{className:"space-y-4",children:n.map(s=>e.jsxs(l,{className:"border-l-4 border-l-orange-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${L(s.status)}/20`,children:e.jsx(y,{className:"h-5 w-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx(c,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(d,{variant:"outline",className:L(s.status),children:s.status}),e.jsxs(d,{variant:"outline",children:["v",s.version]}),e.jsx(d,{variant:"outline",children:s.handler}),s.requests&&e.jsxs(d,{variant:"outline",children:[s.requests," requests"]})]})]})]})}),e.jsxs(i,{children:[s.inputs&&s.inputs.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Inputs"}),s.inputs.map((t,m)=>e.jsxs("div",{className:"p-2 border rounded text-sm",children:[e.jsx("span",{className:"font-mono font-semibold",children:t.name}),e.jsx(d,{variant:"outline",className:"ml-2 text-xs",children:t.dtype}),e.jsx(d,{variant:"outline",className:"ml-2 text-xs",children:t.shape})]},m))]}),s.outputs&&s.outputs.length>0&&e.jsxs("div",{className:"space-y-2 mt-4",children:[e.jsx(a,{children:"Outputs"}),s.outputs.map((t,m)=>e.jsxs("div",{className:"p-2 border rounded text-sm",children:[e.jsx("span",{className:"font-mono font-semibold",children:t.name}),e.jsx(d,{variant:"outline",className:"ml-2 text-xs",children:t.dtype}),e.jsx(d,{variant:"outline",className:"ml-2 text-xs",children:t.shape})]},m))]}),s.avgLatency&&e.jsxs("div",{className:"mt-4 text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Avg Latency:"}),e.jsxs("span",{className:"ml-2 font-semibold",children:[s.avgLatency,"ms"]})]})]})]},`${s.name}-${s.version}`))})})]})}),e.jsx(g,{value:"history",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsx(c,{children:"Prediction History"}),e.jsx(v,{children:"Previously executed predictions"})]}),e.jsx(i,{children:e.jsx("div",{className:"space-y-4",children:h.map(s=>e.jsxs(l,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(r,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.status==="success"?"bg-green-100 dark:bg-green-900/30":"bg-red-100 dark:bg-red-900/30"}`,children:s.status==="success"?e.jsx(ne,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(se,{className:"h-5 w-5 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsxs(c,{className:"text-lg font-semibold",children:[s.model," v",s.version]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.latency&&e.jsxs(d,{variant:"outline",children:[s.latency,"ms"]}),e.jsx(d,{variant:s.status==="success"?"default":"destructive",children:s.status})]})]})]})})}),e.jsxs(i,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.input&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Input"}),e.jsx("pre",{className:"p-3 bg-muted rounded text-xs font-mono overflow-x-auto max-h-40 overflow-y-auto",children:s.input})]}),s.output&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Output"}),e.jsx("pre",{className:"p-3 bg-muted rounded text-xs font-mono overflow-x-auto max-h-40 overflow-y-auto",children:s.output})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:new Date(s.timestamp).toLocaleString()})]})]},s.id))})})]})}),e.jsx(g,{value:"settings",className:"space-y-4",children:e.jsxs(l,{children:[e.jsxs(r,{children:[e.jsx(c,{children:"PyTorch Serve Settings"}),e.jsx(v,{children:"Server configuration"})]}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Endpoint"}),e.jsx(N,{value:S,onChange:s=>M({endpoint:s.target.value}),placeholder:"localhost:8080"})]}),e.jsx(V,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(a,{children:"Enable GPU"}),e.jsx(R,{})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(a,{children:"Enable Batching"}),e.jsx(R,{defaultChecked:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Batch Size"}),e.jsx(N,{type:"number",defaultValue:32,min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Max Batch Wait Time (ms)"}),e.jsx(N,{type:"number",defaultValue:100,min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(a,{children:"Model Store"}),e.jsx(N,{defaultValue:"/models"})]})]})]})})]})]})})}export{oe as PyTorchServeConfigAdvanced};

import{u as qe,X as Ge,r as S,j as e,V as G,i as b,S as V,C,e as P,f as k,k as w,R as H,Z as He,T as We,a as Ze,b as W,B as p,c as Qe,d as Z,h as Q,P as ee,K as se,I as m,n as v,o as g,O as ne,p as f,q as N,s as l,U as te,m as ae,L as c,t as y,D as le,v as ce,w as ie,x as re,y as oe,z as de,a6 as xe,a8 as he,a9 as ue,aa as me,ab as je,ac as pe,ad as ve,ae as ge}from"./index-D23A2X5A.js";import{b as fe,s as E,a as I}from"./toast-y51Cxgtb.js";import{R as Xe}from"./refresh-ccw-C1sN3B1t.js";import{U as X}from"./users-Dz6R0HsC.js";import{L as Je}from"./lock-XZfdzNCT.js";import{C as Ye}from"./clock-CumNGRXg.js";function cs({componentId:L}){const{nodes:Ne,updateNode:be}=qe(),{getComponentMetrics:ye,isRunning:B}=Ge(),T=Ne.find(s=>s.id===L),[a,j]=S.useState(null),[t,x]=S.useState(null),[M,z]=S.useState(null),[F,U]=S.useState(null),[D,Ce]=S.useState(""),[R,Pe]=S.useState(""),[$,ke]=S.useState("all"),[K,we]=S.useState("all");if(!T)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const i=T.data.config||{},d=G.getVPNEmulationEngine(L),A=ye(L),Ae=()=>d&&B?d.getConnections().map(n=>({id:n.id,username:n.username,remoteIP:n.remoteIP,localIP:n.localIP,status:n.status,protocol:n.protocol,connectedAt:n.connectedAt?new Date(n.connectedAt).toISOString():void 0,bytesIn:n.bytesIn,bytesOut:n.bytesOut,packetsIn:n.packetsIn,packetsOut:n.packetsOut,duration:n.connectedAt?Math.floor((Date.now()-n.connectedAt)/1e3):void 0,encryptionAlgorithm:n.encryptionAlgorithm,compressionEnabled:n.compressionEnabled})):i.connections||[],Se=()=>d&&B?d.getTunnels().map(n=>({id:n.id,name:n.name,type:n.type,protocol:n.protocol,localEndpoint:n.localEndpoint,remoteEndpoint:n.remoteEndpoint,status:n.status,connections:n.connections,bytesIn:n.bytesIn,bytesOut:n.bytesOut,packetsIn:n.packetsIn,packetsOut:n.packetsOut,encryptionAlgorithm:n.encryptionAlgorithm,compressionEnabled:n.compressionEnabled,keepAliveEnabled:n.keepAliveEnabled,keepAliveInterval:n.keepAliveInterval})):i.tunnels||[],h=Ae(),u=Se(),Ee=h.filter(s=>s.status==="connected").length,Ie=h.length,Te=u.filter(s=>s.status==="up").length,De=u.length,Oe=h.reduce((s,n)=>s+(n.bytesIn||0)+(n.bytesOut||0),0)+u.reduce((s,n)=>s+(n.bytesIn||0)+(n.bytesOut||0),0),J=h.filter(s=>{const n=!D||s.username.toLowerCase().includes(D.toLowerCase())||s.remoteIP.includes(D)||s.localIP&&s.localIP.includes(D),o=$==="all"||s.status===$;return n&&o}),Y=u.filter(s=>{const n=!R||s.name.toLowerCase().includes(R.toLowerCase())||s.remoteEndpoint.includes(R),o=K==="all"||s.status===K;return n&&o}),r=s=>{if(be(L,{data:{...T.data,config:{...i,...s}}}),d){const n={...T,data:{...T.data,config:{...i,...s}}};d.initializeConfig(n),G.initialize([n],[])}},Ve=()=>{const s={id:`conn-${Date.now()}`,username:"",remoteIP:"",status:"disconnected",protocol:i.vpnProtocol||"openvpn",bytesIn:0,bytesOut:0,packetsIn:0,packetsOut:0,encryptionAlgorithm:i.encryptionAlgorithm,compressionEnabled:i.enableCompression};j(s)},Le=s=>{j({...s})},Me=()=>{if(!a)return;if(!a.username.trim()){E("Username is required");return}if(!a.remoteIP.trim()){E("Remote IP is required");return}const s=a.id&&h.find(n=>n.id===a.id)?h.map(n=>n.id===a.id?a:n):[...h,a];if(r({connections:s}),d)try{a.id&&h.find(n=>n.id===a.id)?d.updateConnectionStatus(a.id,a.status):d.createConnection({id:a.id,username:a.username,remoteIP:a.remoteIP,localIP:a.localIP,status:a.status,protocol:a.protocol||i.vpnProtocol||"openvpn",bytesIn:a.bytesIn||0,bytesOut:a.bytesOut||0,packetsIn:a.packetsIn||0,packetsOut:a.packetsOut||0,encryptionAlgorithm:a.encryptionAlgorithm,compressionEnabled:a.compressionEnabled}),I(a.id&&h.find(n=>n.id===a.id)?"Connection updated successfully":"Connection created successfully")}catch(n){E(n instanceof Error?n.message:"Failed to update connection")}else I(a.id&&h.find(n=>n.id===a.id)?"Connection updated successfully":"Connection created successfully");j(null)},Fe=s=>{const n=h.filter(o=>o.id!==s);if(r({connections:n}),d)try{d.removeConnection(s),I("Connection deleted successfully")}catch(o){E(o instanceof Error?o.message:"Failed to delete connection")}else I("Connection deleted successfully");z(null)},Re=()=>{const s={id:`tunnel-${Date.now()}`,name:"",type:"site-to-site",protocol:i.vpnProtocol||"openvpn",remoteEndpoint:"",status:"down",connections:[],bytesIn:0,bytesOut:0,packetsIn:0,packetsOut:0,encryptionAlgorithm:i.encryptionAlgorithm,compressionEnabled:i.enableCompression,keepAliveEnabled:i.enableKeepAlive,keepAliveInterval:30};x(s)},_e=s=>{x({...s})},Be=()=>{if(!t)return;if(!t.name.trim()){E("Tunnel name is required");return}if(!t.remoteEndpoint.trim()){E("Remote endpoint is required");return}const s=t.id&&u.find(n=>n.id===t.id)?u.map(n=>n.id===t.id?t:n):[...u,t];if(r({tunnels:s}),d)try{t.id&&u.find(n=>n.id===t.id)?d.updateTunnelStatus(t.id,t.status):d.createTunnel({id:t.id,name:t.name,type:t.type,protocol:t.protocol||i.vpnProtocol||"openvpn",localEndpoint:t.localEndpoint||"",remoteEndpoint:t.remoteEndpoint,status:t.status,connections:t.connections||[],bytesIn:t.bytesIn||0,bytesOut:t.bytesOut||0,packetsIn:t.packetsIn||0,packetsOut:t.packetsOut||0,encryptionAlgorithm:t.encryptionAlgorithm,compressionEnabled:t.compressionEnabled,keepAliveEnabled:t.keepAliveEnabled,keepAliveInterval:t.keepAliveInterval||30}),I(t.id&&u.find(n=>n.id===t.id)?"Tunnel updated successfully":"Tunnel created successfully")}catch(n){E(n instanceof Error?n.message:"Failed to update tunnel")}else I(t.id&&u.find(n=>n.id===t.id)?"Tunnel updated successfully":"Tunnel created successfully");x(null)},ze=s=>{const n=u.filter(o=>o.id!==s);if(r({tunnels:n}),d)try{d.removeTunnel(s),I("Tunnel deleted successfully")}catch(o){E(o instanceof Error?o.message:"Failed to delete tunnel")}else I("Tunnel deleted successfully");U(null)},Ue=()=>{d&&B?(d.initializeConfig(T),G.initialize([T],[]),fe("VPN metrics refreshed")):fe("VPN metrics refreshed")},_=s=>{switch(s){case"connected":case"up":return"bg-green-500";case"disconnected":case"down":return"bg-gray-500";case"connecting":case"disconnecting":return"bg-yellow-500";default:return"bg-gray-500"}},O=s=>{if(!s)return"0 B";const n=["B","KB","MB","GB","TB"],o=Math.floor(Math.log(s)/Math.log(1024));return`${(s/Math.pow(1024,o)).toFixed(2)} ${n[o]}`},$e=s=>{if(!s)return"0s";const n=Math.floor(s/3600),o=Math.floor(s%3600/60),q=s%60;return n>0?`${n}h ${o}m ${q}s`:o>0?`${o}m ${q}s`:`${q}s`},Ke=i.encryptionAlgorithm||"aes-256";return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"VPN Concentrator"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Virtual Private Network"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Secure remote access and site-to-site connectivity"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(b,{variant:"outline",size:"sm",onClick:Ue,children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(V,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(C,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(P,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"text-sm font-medium text-muted-foreground",children:"Connections"}),e.jsx(X,{className:"h-4 w-4 text-blue-500"})]})}),e.jsxs(w,{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:Ee}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/ ",Ie," total"]})]}),A?.customMetrics?.vpn_active_connections!==void 0&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["From simulation: ",A.customMetrics.vpn_active_connections]})]})]}),e.jsxs(C,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(P,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"text-sm font-medium text-muted-foreground",children:"Tunnels"}),e.jsx(H,{className:"h-4 w-4 text-green-500"})]})}),e.jsxs(w,{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:Te}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/ ",De," total"]})]}),A?.customMetrics?.vpn_active_tunnels!==void 0&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["From simulation: ",A.customMetrics.vpn_active_tunnels]})]})]}),e.jsxs(C,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(P,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"text-sm font-medium text-muted-foreground",children:"Data Transferred"}),e.jsx(He,{className:"h-4 w-4 text-purple-500"})]})}),e.jsxs(w,{children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:(Oe/1024/1024/1024).toFixed(2)}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"GB"})]}),A?.customMetrics?.vpn_bytes_per_second!==void 0&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[O(A.customMetrics.vpn_bytes_per_second),"/s"]})]})]}),e.jsxs(C,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(P,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{className:"text-sm font-medium text-muted-foreground",children:"Encryption"}),e.jsx(Je,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsxs(w,{children:[e.jsx("div",{className:"text-sm font-semibold text-cyan-600 dark:text-cyan-400",children:Ke.toUpperCase().replace("-","-")}),A?.customMetrics?.vpn_encryption_operations!==void 0&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[A.customMetrics.vpn_encryption_operations.toLocaleString()," operations"]})]})]})]}),e.jsxs(We,{defaultValue:"connections",className:"space-y-4",children:[e.jsxs(Ze,{className:"flex-wrap",children:[e.jsxs(W,{value:"connections",className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{children:"Connections"}),e.jsx(p,{variant:"secondary",className:"ml-1",children:h.length})]}),e.jsxs(W,{value:"tunnels",className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:"Tunnels"}),e.jsx(p,{variant:"secondary",className:"ml-1",children:u.length})]}),e.jsxs(W,{value:"settings",className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx("span",{children:"Settings"})]})]}),e.jsx(Z,{value:"connections",className:"space-y-4",children:e.jsxs(C,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(k,{children:"Active Connections"}),e.jsx(Q,{children:"VPN client connections"})]}),e.jsxs(b,{onClick:Ve,size:"sm",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Add Connection"]})]})}),e.jsx(w,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(se,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(m,{placeholder:"Search connections...",value:D,onChange:s=>Ce(s.target.value),className:"pl-8"})]}),e.jsxs(v,{value:$,onValueChange:s=>ke(s),children:[e.jsxs(g,{className:"w-[180px]",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),e.jsx(f,{})]}),e.jsxs(N,{children:[e.jsx(l,{value:"all",children:"All Status"}),e.jsx(l,{value:"connected",children:"Connected"}),e.jsx(l,{value:"disconnected",children:"Disconnected"})]})]})]}),J.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:h.length===0?"No connections configured":"No connections match your filters"}):e.jsx("div",{className:"space-y-4",children:J.map(s=>e.jsxs(C,{className:"border-l-4 border-l-blue-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(P,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg ${_(s.status)}/20`,children:e.jsx(X,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(k,{className:"text-lg font-semibold",children:s.username}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[e.jsx(p,{variant:"outline",className:_(s.status),children:s.status}),e.jsx(p,{variant:"outline",className:"font-mono text-xs",children:s.remoteIP}),s.localIP&&e.jsx(p,{variant:"outline",className:"font-mono text-xs",children:s.localIP}),s.protocol&&e.jsx(p,{variant:"outline",children:s.protocol}),s.duration!==void 0&&e.jsxs(p,{variant:"outline",children:[e.jsx(Ye,{className:"h-3 w-3 mr-1"}),$e(s.duration)]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>Le(s),children:e.jsx(te,{className:"h-4 w-4"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>z(s.id),children:e.jsx(ae,{className:"h-4 w-4 text-destructive"})})]})]})}),e.jsxs(w,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Bytes In:"}),e.jsx("span",{className:"ml-2 font-semibold",children:O(s.bytesIn)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Bytes Out:"}),e.jsx("span",{className:"ml-2 font-semibold",children:O(s.bytesOut)})]}),s.packetsIn!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Packets In:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.packetsIn.toLocaleString()})]}),s.packetsOut!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Packets Out:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.packetsOut.toLocaleString()})]})]}),s.connectedAt&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Connected: ",new Date(s.connectedAt).toLocaleString()]})]})]},s.id))})]})})]})}),e.jsx(Z,{value:"tunnels",className:"space-y-4",children:e.jsxs(C,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(k,{children:"VPN Tunnels"}),e.jsx(Q,{children:"Site-to-site and remote access tunnels"})]}),e.jsxs(b,{onClick:Re,size:"sm",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Add Tunnel"]})]})}),e.jsx(w,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(se,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(m,{placeholder:"Search tunnels...",value:R,onChange:s=>Pe(s.target.value),className:"pl-8"})]}),e.jsxs(v,{value:K,onValueChange:s=>we(s),children:[e.jsxs(g,{className:"w-[180px]",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),e.jsx(f,{})]}),e.jsxs(N,{children:[e.jsx(l,{value:"all",children:"All Status"}),e.jsx(l,{value:"up",children:"Up"}),e.jsx(l,{value:"down",children:"Down"})]})]})]}),Y.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:u.length===0?"No tunnels configured":"No tunnels match your filters"}):e.jsx("div",{className:"space-y-4",children:Y.map(s=>e.jsxs(C,{className:"border-l-4 border-l-green-500 hover:shadow-md transition-shadow bg-card",children:[e.jsx(P,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:`p-2 rounded-lg ${_(s.status)}/20`,children:e.jsx(H,{className:"h-5 w-5 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(k,{className:"text-lg font-semibold",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[e.jsx(p,{variant:"outline",className:_(s.status),children:s.status}),e.jsx(p,{variant:"outline",children:s.type}),s.protocol&&e.jsx(p,{variant:"outline",children:s.protocol}),e.jsx(p,{variant:"outline",className:"font-mono text-xs",children:s.remoteEndpoint}),s.connections&&s.connections.length>0&&e.jsxs(p,{variant:"outline",className:"bg-blue-50 dark:bg-blue-950/20 text-blue-700 dark:text-blue-300",children:[s.connections.length," connections"]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>_e(s),children:e.jsx(te,{className:"h-4 w-4"})}),e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>U(s.id),children:e.jsx(ae,{className:"h-4 w-4 text-destructive"})})]})]})}),e.jsxs(w,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Bytes In:"}),e.jsx("span",{className:"ml-2 font-semibold",children:O(s.bytesIn)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Bytes Out:"}),e.jsx("span",{className:"ml-2 font-semibold",children:O(s.bytesOut)})]}),s.packetsIn!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Packets In:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.packetsIn.toLocaleString()})]}),s.packetsOut!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Packets Out:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.packetsOut.toLocaleString()})]})]}),s.localEndpoint&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Local: ",s.localEndpoint]})]})]},s.id))})]})})]})}),e.jsx(Z,{value:"settings",className:"space-y-4",children:e.jsxs(C,{children:[e.jsxs(P,{children:[e.jsx(k,{children:"VPN Settings"}),e.jsx(Q,{children:"VPN concentrator configuration"})]}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"VPN Protocol"}),e.jsxs(v,{value:i.vpnProtocol??"openvpn",onValueChange:s=>r({vpnProtocol:s}),children:[e.jsx(g,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"openvpn",children:"OpenVPN"}),e.jsx(l,{value:"ipsec",children:"IPsec"}),e.jsx(l,{value:"wireguard",children:"WireGuard"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Encryption Algorithm"}),e.jsxs(v,{value:i.encryptionAlgorithm??"aes-256",onValueChange:s=>r({encryptionAlgorithm:s}),children:[e.jsx(g,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"aes-256",children:"AES-256"}),e.jsx(l,{value:"aes-128",children:"AES-128"}),e.jsx(l,{value:"chacha20-poly1305",children:"ChaCha20-Poly1305"})]})]})]}),e.jsx(V,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Enable Compression"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Compress VPN traffic"})]}),e.jsx(y,{checked:i.enableCompression??!0,onCheckedChange:s=>r({enableCompression:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Enable Keep-Alive"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Keep connections alive"})]}),e.jsx(y,{checked:i.enableKeepAlive??!0,onCheckedChange:s=>r({enableKeepAlive:s})})]}),e.jsx(V,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Max Connections"}),e.jsx(m,{type:"number",value:i.maxConnections??1e3,onChange:s=>r({maxConnections:parseInt(s.target.value)||1e3}),min:1,max:1e4}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum concurrent VPN connections"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Connection Timeout (seconds)"}),e.jsx(m,{type:"number",value:i.connectionTimeout??300,onChange:s=>r({connectionTimeout:parseInt(s.target.value)||300}),min:1,max:3600}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Timeout for inactive connections"})]}),e.jsx(V,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(c,{className:"text-base font-semibold",children:"Protocol Settings"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Enable SSL VPN"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable SSL-based VPN"})]}),e.jsx(y,{checked:i.enableSSL??!0,onCheckedChange:s=>r({enableSSL:s})})]}),i.enableSSL&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"SSL Port"}),e.jsx(m,{type:"number",value:i.sslPort??443,onChange:s=>r({sslPort:parseInt(s.target.value)||443}),min:1,max:65535})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Enable IPSec"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable IPSec protocol"})]}),e.jsx(y,{checked:i.enableIPSec??!0,onCheckedChange:s=>r({enableIPSec:s})})]}),i.enableIPSec&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"IPSec Port"}),e.jsx(m,{type:"number",value:i.ipsecPort??500,onChange:s=>r({ipsecPort:parseInt(s.target.value)||500}),min:1,max:65535})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Enable L2TP"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable L2TP protocol"})]}),e.jsx(y,{checked:i.enableL2TP??!1,onCheckedChange:s=>r({enableL2TP:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Enable PPTP"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable PPTP protocol (not recommended)"})]}),e.jsx(y,{checked:i.enablePPTP??!1,onCheckedChange:s=>r({enablePPTP:s})})]})]}),e.jsx(V,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:e.jsx(c,{className:"text-base font-semibold",children:"Authentication"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Enable RADIUS"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Use RADIUS for authentication"})]}),e.jsx(y,{checked:i.enableRadius??!1,onCheckedChange:s=>r({enableRadius:s})})]}),i.enableRadius&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"RADIUS Server"}),e.jsx(m,{type:"text",value:i.radiusServer??"",onChange:s=>r({radiusServer:s.target.value}),placeholder:"radius.example.com"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(c,{children:"Enable MFA"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Multi-factor authentication"})]}),e.jsx(y,{checked:i.enableMFA??!1,onCheckedChange:s=>r({enableMFA:s})})]}),i.enableMFA&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"MFA Provider"}),e.jsxs(v,{value:i.mfaProvider??"totp",onValueChange:s=>r({mfaProvider:s}),children:[e.jsx(g,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"totp",children:"TOTP"}),e.jsx(l,{value:"sms",children:"SMS"}),e.jsx(l,{value:"email",children:"Email"})]})]})]})]})]})]})})]}),e.jsx(le,{open:a!==null,onOpenChange:s=>!s&&j(null),children:e.jsxs(ce,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(re,{children:a?.id&&h.find(s=>s.id===a.id)?"Edit Connection":"Add Connection"}),e.jsx(oe,{children:"Configure VPN connection settings"})]}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Username *"}),e.jsx(m,{value:a.username,onChange:s=>j({...a,username:s.target.value}),placeholder:"user@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Remote IP *"}),e.jsx(m,{value:a.remoteIP,onChange:s=>j({...a,remoteIP:s.target.value}),placeholder:"203.0.113.10"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Local IP"}),e.jsx(m,{value:a.localIP||"",onChange:s=>j({...a,localIP:s.target.value}),placeholder:"10.8.0.5"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Status"}),e.jsxs(v,{value:a.status,onValueChange:s=>j({...a,status:s}),children:[e.jsx(g,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"connected",children:"Connected"}),e.jsx(l,{value:"disconnected",children:"Disconnected"}),e.jsx(l,{value:"connecting",children:"Connecting"}),e.jsx(l,{value:"disconnecting",children:"Disconnecting"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Protocol"}),e.jsxs(v,{value:a.protocol||"openvpn",onValueChange:s=>j({...a,protocol:s}),children:[e.jsx(g,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"openvpn",children:"OpenVPN"}),e.jsx(l,{value:"ipsec",children:"IPsec"}),e.jsx(l,{value:"wireguard",children:"WireGuard"}),e.jsx(l,{value:"l2tp",children:"L2TP"}),e.jsx(l,{value:"pptp",children:"PPTP"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Encryption Algorithm"}),e.jsxs(v,{value:a.encryptionAlgorithm||"aes-256",onValueChange:s=>j({...a,encryptionAlgorithm:s}),children:[e.jsx(g,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"aes-256",children:"AES-256"}),e.jsx(l,{value:"aes-128",children:"AES-128"}),e.jsx(l,{value:"chacha20-poly1305",children:"ChaCha20-Poly1305"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{children:"Enable Compression"}),e.jsx(y,{checked:a.compressionEnabled??!0,onCheckedChange:s=>j({...a,compressionEnabled:s})})]})]}),e.jsxs(de,{children:[e.jsx(b,{variant:"outline",onClick:()=>j(null),children:"Cancel"}),e.jsx(b,{onClick:Me,children:"Save"})]})]})}),e.jsx(le,{open:t!==null,onOpenChange:s=>!s&&x(null),children:e.jsxs(ce,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ie,{children:[e.jsx(re,{children:t?.id&&u.find(s=>s.id===t.id)?"Edit Tunnel":"Add Tunnel"}),e.jsx(oe,{children:"Configure VPN tunnel settings"})]}),t&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Tunnel Name *"}),e.jsx(m,{value:t.name,onChange:s=>x({...t,name:s.target.value}),placeholder:"HQ to Branch"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Tunnel Type"}),e.jsxs(v,{value:t.type,onValueChange:s=>x({...t,type:s}),children:[e.jsx(g,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"site-to-site",children:"Site-to-Site"}),e.jsx(l,{value:"remote-access",children:"Remote Access"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Status"}),e.jsxs(v,{value:t.status,onValueChange:s=>x({...t,status:s}),children:[e.jsx(g,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"up",children:"Up"}),e.jsx(l,{value:"down",children:"Down"}),e.jsx(l,{value:"connecting",children:"Connecting"}),e.jsx(l,{value:"disconnecting",children:"Disconnecting"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Remote Endpoint *"}),e.jsx(m,{value:t.remoteEndpoint,onChange:s=>x({...t,remoteEndpoint:s.target.value}),placeholder:"192.168.100.1 or vpn.example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Local Endpoint"}),e.jsx(m,{value:t.localEndpoint||"",onChange:s=>x({...t,localEndpoint:s.target.value}),placeholder:"192.168.1.1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Protocol"}),e.jsxs(v,{value:t.protocol||"openvpn",onValueChange:s=>x({...t,protocol:s}),children:[e.jsx(g,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"openvpn",children:"OpenVPN"}),e.jsx(l,{value:"ipsec",children:"IPsec"}),e.jsx(l,{value:"wireguard",children:"WireGuard"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Encryption Algorithm"}),e.jsxs(v,{value:t.encryptionAlgorithm||"aes-256",onValueChange:s=>x({...t,encryptionAlgorithm:s}),children:[e.jsx(g,{children:e.jsx(f,{})}),e.jsxs(N,{children:[e.jsx(l,{value:"aes-256",children:"AES-256"}),e.jsx(l,{value:"aes-128",children:"AES-128"}),e.jsx(l,{value:"chacha20-poly1305",children:"ChaCha20-Poly1305"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{children:"Enable Compression"}),e.jsx(y,{checked:t.compressionEnabled??!0,onCheckedChange:s=>x({...t,compressionEnabled:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(c,{children:"Enable Keep-Alive"}),e.jsx(y,{checked:t.keepAliveEnabled??!0,onCheckedChange:s=>x({...t,keepAliveEnabled:s})})]}),t.keepAliveEnabled&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Keep-Alive Interval (seconds)"}),e.jsx(m,{type:"number",value:t.keepAliveInterval||30,onChange:s=>x({...t,keepAliveInterval:parseInt(s.target.value)||30}),min:1,max:300})]})]}),e.jsxs(de,{children:[e.jsx(b,{variant:"outline",onClick:()=>x(null),children:"Cancel"}),e.jsx(b,{onClick:Be,children:"Save"})]})]})}),e.jsx(xe,{open:M!==null,onOpenChange:s=>!s&&z(null),children:e.jsxs(he,{children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Delete Connection"}),e.jsxs(je,{children:['Are you sure you want to delete connection "',h.find(s=>s.id===M)?.username,'"? This action cannot be undone.']})]}),e.jsxs(pe,{children:[e.jsx(ve,{children:"Cancel"}),e.jsx(ge,{onClick:()=>M&&Fe(M),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})}),e.jsx(xe,{open:F!==null,onOpenChange:s=>!s&&U(null),children:e.jsxs(he,{children:[e.jsxs(ue,{children:[e.jsx(me,{children:"Delete Tunnel"}),e.jsxs(je,{children:['Are you sure you want to delete tunnel "',u.find(s=>s.id===F)?.name,'"? This action cannot be undone.']})]}),e.jsxs(pe,{children:[e.jsx(ve,{children:"Cancel"}),e.jsx(ge,{onClick:()=>F&&ze(F),className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})})}export{cs as VPNConfigAdvanced};

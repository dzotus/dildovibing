import{u as H,j as e,r as A,e as R,l as N,S as U,C as f,h as S,i as M,m as v,B as y,T as we,b as Re,c as L,A as Qe,f as k,k as I,P as J,I as h,o as Z,L as o,q as V,s as W,t as F,v as O,w as b,x as ae,d as Ge,$ as te,a1 as ie,a2 as le,a3 as re,a4 as ne,a5 as ce,a6 as oe,a7 as de}from"./index-CwK32Mz8.js";import{P as w}from"./progress-CUxBxdH0.js";import{d as De,e as Ie}from"./validation-CyJvwzmY.js";import{a as q,s as me}from"./toast-DfLGesnc.js";import{R as Te}from"./refresh-ccw-D-s9mPLx.js";import{C as Pe}from"./cloud-Djvm2w5y.js";import{M as xe}from"./message-square-19feBYZT.js";import{K as _e}from"./key-uSIXbULw.js";import{S as He}from"./shield-iBzfi9_i.js";import{S as Le}from"./send-C5-9gFiJ.js";const n={MESSAGES_HIGH:1e4,MESSAGES_WARNING:5e3,MESSAGES_HEALTHY:1e3,MESSAGES_MAX_PROGRESS:5e4,IN_FLIGHT_MAX_PROGRESS:5e3,IN_FLIGHT_WARNING:1e3,DELAYED_MAX_PROGRESS:500,TOTAL_MESSAGES_MAX_PROGRESS:1e5};function Je({componentId:E}){const{nodes:he,updateNode:T}=H(),p=he.find(s=>s.id===E);if(!p)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const g=p.data.config||{},c=g.queues||[],ge=g.accessKeyId||"",ue=g.secretAccessKey||"",P=g.defaultRegion||"us-east-1",z=g.accountId||"123456789012",C=g.iamPolicies||[],[pe,K]=A.useState(null),[ke,je]=A.useState(!1),[Ve,Ne]=A.useState(!1),[fe,$]=A.useState(null),[G,ee]=A.useState(""),[d,Q]=A.useState({}),[D,Y]=A.useState(null),[X,B]=A.useState(null);A.useEffect(()=>{if(!p||c.length===0)return;const{nodes:s,connections:a}=H.getState();R.updateNodesAndConnections(s,a)},[E,c.length,p?.id]),A.useEffect(()=>{if(!p||c.length===0)return;const s=R.getSQSRoutingEngine(E);if(!s)return;const a=s.getAllQueueMetrics(),t=p.data.config?.queues||[],i=t.map(l=>{const r=a.get(l.name);return r?{...l,approximateMessages:r.approximateMessages,approximateMessagesNotVisible:r.approximateMessagesNotVisible,approximateMessagesDelayed:r.approximateMessagesDelayed}:l});i.some((l,r)=>l.approximateMessages!==t[r]?.approximateMessages||l.approximateMessagesNotVisible!==t[r]?.approximateMessagesNotVisible||l.approximateMessagesDelayed!==t[r]?.approximateMessagesDelayed)&&T(E,{data:{...p.data,config:{...p.data.config,queues:i}}})},[E,p?.data.config,c.length,T]);const m=s=>{T(E,{data:{...p.data,config:{...g,...s}}})},ve=()=>{const s={name:"new-queue",type:"standard",region:P,visibilityTimeout:30,messageRetention:4,delaySeconds:0,receiveMessageWaitTimeSeconds:0,approximateMessages:0,approximateMessagesNotVisible:0,approximateMessagesDelayed:0,tags:[]};m({queues:[...c,s]}),je(!1)},Se=s=>{Y(s)},Me=()=>{if(D!==null){const s=c[D].name;m({queues:c.filter((a,t)=>t!==D)}),Y(null),q(`Queue "${s}" has been deleted`)}},u=(s,a,t)=>{const i=[...c],x=i[s];if(a==="name"){const l=De(t,x.type==="fifo");if(l.valid){const r={...d};r[s]&&delete r[s].name,Q(r)}else{Q({...d,[s]:{...d[s],name:l.error||""}});return}}if(a==="region"){const l=Ie(t);if(l.valid){const r={...d};r[s]&&delete r[s].region,Q(r)}else{Q({...d,[s]:{...d[s],region:l.error||""}});return}}if(["visibilityTimeout","messageRetention","delaySeconds","maxReceiveCount","receiveMessageWaitTimeSeconds"].includes(a)){const l=Number(t);if(isNaN(l)||l<0){Q({...d,[s]:{...d[s],[a]:`${a} must be a positive number`}});return}else{const r={...d};r[s]&&delete r[s][a],Q(r)}}i[s]={...i[s],[a]:t},m({queues:i})},ye=()=>{const s={id:`policy-${Date.now()}`,principal:"*",action:"sqs:SendMessage",resource:"*",effect:"Allow"};m({iamPolicies:[...C,s]}),Ne(!1)},be=s=>{B(s)},Ae=()=>{X&&(m({iamPolicies:C.filter(s=>s.id!==X)}),B(null),q("IAM Policy has been deleted"))},Ee=s=>{const a=c[s];if(a&&G){const{nodes:t,connections:i}=H.getState();R.updateNodesAndConnections(t,i);const x=R.getSQSRoutingEngine(E);if(x){const l=a.testAttributes;if(x.sendMessage(a.name,G,new Blob([G]).size,l,a.type==="fifo"?"test-group":void 0,a.type==="fifo"&&a.contentBasedDedup?void 0:`test-${Date.now()}`)){const j=x.getQueueMetrics(a.name);j&&(u(s,"approximateMessages",j.approximateMessages),u(s,"approximateMessagesNotVisible",j.approximateMessagesNotVisible),u(s,"approximateMessagesDelayed",j.approximateMessagesDelayed)),R.updateNodesAndConnections(t,i)}}else u(s,"approximateMessages",(a.approximateMessages||0)+1);ee("")}},_=c.reduce((s,a)=>s+(a.approximateMessages||0),0),se=c.reduce((s,a)=>s+(a.approximateMessagesNotVisible||0),0);return e.jsxs("div",{className:"h-full overflow-y-auto bg-background",children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"Amazon SQS"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Simple Queue Service"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure and manage AWS SQS queues with delivery guarantees"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>{const{nodes:s,connections:a}=H.getState();R.updateNodesAndConnections(s,a);const t=R.getSQSRoutingEngine(E);if(t){const i=t.getAllQueueMetrics(),l=(p.data.config?.queues||[]).map(r=>{const j=i.get(r.name);return j?{...r,approximateMessages:j.approximateMessages,approximateMessagesNotVisible:j.approximateMessagesNotVisible,approximateMessagesDelayed:j.approximateMessagesDelayed}:r});T(E,{data:{...p.data,config:{...p.data.config,queues:l}}}),q("Metrics refreshed")}else me("Routing engine not initialized")},children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>{if(c.length===0){me("Please create a queue first");return}const s=c[0].name,a=c[0].region||P,i=`https://sqs.${a}.amazonaws.com/123456789012/${s}`,x=`https://console.aws.amazon.com/sqs/v2/home?region=${a}#/queues/${encodeURIComponent(i)}`;window.open(x,"_blank")},children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"AWS Console"]})]})]}),e.jsx(U,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(f,{children:[e.jsx(S,{className:"pb-3",children:e.jsx(M,{className:"text-sm font-medium",children:"Total Queues"})}),e.jsxs(v,{children:[e.jsx("span",{className:"text-2xl font-bold",children:c.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Active queues"})]})]}),e.jsxs(f,{children:[e.jsx(S,{className:"pb-3",children:e.jsx(M,{className:"text-sm font-medium",children:"Total Messages"})}),e.jsxs(v,{children:[e.jsx("span",{className:"text-2xl font-bold",children:_.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Approximate count"}),e.jsx(w,{value:Math.min(_/n.TOTAL_MESSAGES_MAX_PROGRESS*100,100),className:`h-2 mt-2 ${_>n.MESSAGES_MAX_PROGRESS?"bg-red-500":_>n.MESSAGES_HIGH?"bg-yellow-500":"bg-green-500"}`})]})]}),e.jsxs(f,{children:[e.jsx(S,{className:"pb-3",children:e.jsx(M,{className:"text-sm font-medium",children:"In Flight"})}),e.jsxs(v,{children:[e.jsx("span",{className:"text-2xl font-bold",children:se.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Being processed"}),e.jsx(w,{value:Math.min(se/n.IN_FLIGHT_MAX_PROGRESS*100,100),className:"h-2 mt-2"})]})]}),e.jsxs(f,{children:[e.jsx(S,{className:"pb-3",children:e.jsx(M,{className:"text-sm font-medium",children:"Default Region"})}),e.jsxs(v,{children:[e.jsx(y,{variant:"outline",children:P}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"AWS Region"})]})]})]}),e.jsxs(we,{defaultValue:"queues",className:"space-y-4",children:[e.jsxs(Re,{className:"flex flex-wrap gap-2",children:[e.jsxs(L,{value:"queues",className:"flex-shrink-0",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Queues (",c.length,")"]}),e.jsxs(L,{value:"credentials",className:"flex-shrink-0",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Credentials"]}),e.jsxs(L,{value:"policies",className:"flex-shrink-0",children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),"IAM Policies (",C.length,")"]}),e.jsxs(L,{value:"monitoring",className:"flex-shrink-0",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Monitoring"]})]}),e.jsx(k,{value:"queues",className:"space-y-4",children:e.jsxs(f,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(M,{children:"Queues"}),e.jsx(I,{children:"Manage SQS queues and their configuration"})]}),e.jsxs(N,{onClick:ve,size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Create Queue"]})]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-4",children:c.map((s,a)=>e.jsxs(f,{className:"border-l-4 border-l-orange-500",children:[e.jsx(S,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xe,{className:"h-5 w-5 text-orange-500"}),e.jsxs("div",{children:[e.jsx(M,{className:"text-base",children:pe===a?e.jsxs("div",{className:"space-y-1",children:[e.jsx(h,{value:s.name,onChange:t=>u(a,"name",t.target.value),onBlur:()=>K(null),onKeyDown:t=>{t.key==="Enter"&&K(null)},className:`h-7 ${d[a]?.name?"border-red-500":""}`,autoFocus:!0}),d[a]?.name&&e.jsx("p",{className:"text-xs text-red-500",children:d[a].name})]}):e.jsx("span",{className:"cursor-pointer hover:text-primary",onClick:()=>K(a),children:s.name})}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(y,{variant:s.type==="fifo"?"default":"outline",children:s.type==="fifo"?"FIFO":"Standard"}),e.jsx(y,{variant:"outline",children:s.region})]})]})]}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>Se(a),disabled:c.length===1,children:e.jsx(Z,{className:"h-4 w-4"})})]})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Messages Available"}),(s.approximateMessages||0)>n.MESSAGES_HIGH&&e.jsx(y,{variant:"destructive",className:"text-xs",children:"High"})]}),e.jsx("p",{className:"text-2xl font-bold",children:s.approximateMessages?.toLocaleString()||0}),e.jsx(w,{value:Math.min((s.approximateMessages||0)/n.MESSAGES_MAX_PROGRESS*100,100),className:`h-2 ${(s.approximateMessages||0)>n.MESSAGES_HIGH?"bg-red-500":(s.approximateMessages||0)>n.MESSAGES_WARNING?"bg-yellow-500":"bg-green-500"}`}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ready to consume"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"In Flight"}),(s.approximateMessagesNotVisible||0)>n.IN_FLIGHT_WARNING&&e.jsx(y,{variant:"outline",className:"text-xs",children:"Processing"})]}),e.jsx("p",{className:"text-2xl font-bold",children:s.approximateMessagesNotVisible?.toLocaleString()||0}),e.jsx(w,{value:Math.min((s.approximateMessagesNotVisible||0)/2e3*100,100),className:"h-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Being processed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Delayed"}),e.jsx("p",{className:"text-2xl font-bold",children:s.approximateMessagesDelayed?.toLocaleString()||0}),e.jsx(w,{value:Math.min((s.approximateMessagesDelayed||0)/n.DELAYED_MAX_PROGRESS*100,100),className:"h-2 bg-orange-500"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Waiting for delay"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Queue URL"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(y,{variant:"outline",className:"font-mono text-xs",children:s.region})}),e.jsxs("p",{className:"text-xs font-mono text-muted-foreground truncate",title:`https://sqs.${s.region}.amazonaws.com/${z}/${s.name}`,children:["https://sqs.",s.region,".amazonaws.com/",z,"/",s.name]}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${(s.approximateMessages||0)===0&&(s.approximateMessagesNotVisible||0)===0?"bg-gray-400":(s.approximateMessages||0)<n.MESSAGES_HEALTHY?"bg-green-500":(s.approximateMessages||0)<n.MESSAGES_HIGH?"bg-yellow-500":"bg-red-500"}`}),e.jsx("p",{className:"text-xs text-muted-foreground",children:(s.approximateMessages||0)===0&&(s.approximateMessagesNotVisible||0)===0?"Idle":(s.approximateMessages||0)<n.MESSAGES_HEALTHY?"Healthy":(s.approximateMessages||0)<n.MESSAGES_HIGH?"Warning":"Critical"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{children:"Tags"}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>{const t=[...c];t[a].tags||(t[a].tags=[]),t[a].tags.push({key:"",value:""}),m({queues:t})},children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),"Add Tag"]})]}),s.tags&&s.tags.length>0?e.jsx("div",{className:"space-y-2",children:s.tags.map((t,i)=>e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(h,{placeholder:"Key",value:t.key,onChange:x=>{const l=[...c];l[a].tags[i].key=x.target.value,m({queues:l})},className:"flex-1"}),e.jsx(h,{placeholder:"Value",value:t.value,onChange:x=>{const l=[...c];l[a].tags[i].value=x.target.value,m({queues:l})},className:"flex-1"}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>{const x=[...c];x[a].tags=x[a].tags.filter((l,r)=>r!==i),m({queues:x})},children:e.jsx(Z,{className:"h-4 w-4"})})]},i))}):e.jsx("p",{className:"text-xs text-muted-foreground",children:"No tags configured"})]})]}),e.jsx(U,{}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Queue Type"}),e.jsxs(V,{value:s.type,onValueChange:t=>u(a,"type",t),children:[e.jsx(W,{children:e.jsx(F,{})}),e.jsxs(O,{children:[e.jsx(b,{value:"standard",children:"Standard Queue"}),e.jsx(b,{value:"fifo",children:"FIFO Queue"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Region"}),e.jsx(h,{value:s.region,onChange:t=>u(a,"region",t.target.value),placeholder:"us-east-1",className:d[a]?.region?"border-red-500":""}),d[a]?.region&&e.jsx("p",{className:"text-xs text-red-500",children:d[a].region})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Visibility Timeout (seconds)"}),e.jsx(h,{type:"number",value:s.visibilityTimeout,onChange:t=>u(a,"visibilityTimeout",Number(t.target.value)),min:0,max:43200,className:d[a]?.visibilityTimeout?"border-red-500":""}),d[a]?.visibilityTimeout&&e.jsx("p",{className:"text-xs text-red-500",children:d[a].visibilityTimeout}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Time a message is hidden after being received"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Message Retention Period (days)"}),e.jsx(h,{type:"number",value:s.messageRetention,onChange:t=>u(a,"messageRetention",Number(t.target.value)),min:1,max:14}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How long messages are kept (1-14 days)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Delivery Delay (seconds)"}),e.jsx(h,{type:"number",value:s.delaySeconds,onChange:t=>u(a,"delaySeconds",Number(t.target.value)),min:0,max:900}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Delay before messages become available (0-900 seconds)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Dead Letter Queue"}),e.jsx(h,{value:s.deadLetterQueue||"",onChange:t=>u(a,"deadLetterQueue",t.target.value),placeholder:"dlq-name"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Queue for messages that fail processing"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Long Polling Wait Time (seconds)"}),e.jsx(h,{type:"number",value:s.receiveMessageWaitTimeSeconds??0,onChange:t=>u(a,"receiveMessageWaitTimeSeconds",Number(t.target.value)),min:0,max:20,className:d[a]?.receiveMessageWaitTimeSeconds?"border-red-500":""}),d[a]?.receiveMessageWaitTimeSeconds&&e.jsx("p",{className:"text-xs text-red-500",children:d[a].receiveMessageWaitTimeSeconds}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Max wait time for ReceiveMessage (0-20 seconds)"})]}),s.type==="fifo"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Max Receive Count"}),e.jsx(h,{type:"number",value:s.maxReceiveCount||3,onChange:t=>u(a,"maxReceiveCount",Number(t.target.value)),min:1,max:1e3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Messages moved to DLQ after this many receives"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(o,{children:"Content-Based Deduplication"}),e.jsx(ae,{checked:s.contentBasedDedup||!1,onCheckedChange:t=>u(a,"contentBasedDedup",t)})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically deduplicate messages by content hash"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"FIFO Throughput Limit"}),e.jsxs(V,{value:s.fifoThroughputLimit||"perQueue",onValueChange:t=>u(a,"fifoThroughputLimit",t),children:[e.jsx(W,{children:e.jsx(F,{})}),e.jsxs(O,{children:[e.jsx(b,{value:"perQueue",children:"Per Queue"}),e.jsx(b,{value:"perMessageGroupId",children:"Per Message Group ID"})]})]})]})]})]}),e.jsx(U,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Send Test Message"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(h,{value:G,onChange:t=>ee(t.target.value),placeholder:"Enter test message..."}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-xs",children:"Message Attributes (key=value, comma-separated)"}),e.jsx(h,{placeholder:"env=prod, type=order, priority=high",onChange:t=>{const i=t.target.value,x={};i.split(",").map(l=>l.trim()).filter(Boolean).forEach(l=>{const[r,j]=l.split("=").map(Ce=>Ce.trim());r&&j!==void 0&&(x[r]=j)}),u(a,"testAttributes",x)}})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(N,{size:"sm",onClick:()=>Ee(a),disabled:!G,children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"Send"]})})]})]})]})]},a))})})]})}),e.jsx(k,{value:"credentials",className:"space-y-4",children:e.jsxs(f,{children:[e.jsxs(S,{children:[e.jsx(M,{children:"AWS Credentials"}),e.jsx(I,{children:"Configure AWS access credentials for SQS"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"accessKeyId",children:"Access Key ID"}),e.jsx(h,{id:"accessKeyId",value:ge,onChange:s=>m({accessKeyId:s.target.value}),placeholder:"AKIAIOSFODNN7EXAMPLE"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"secretAccessKey",children:"Secret Access Key"}),e.jsx(h,{id:"secretAccessKey",type:"password",value:ue,onChange:s=>m({secretAccessKey:s.target.value}),placeholder:"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"defaultRegion",children:"Default Region"}),e.jsx(h,{id:"defaultRegion",value:P,onChange:s=>m({defaultRegion:s.target.value}),placeholder:"us-east-1"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"accountId",children:"AWS Account ID"}),e.jsx(h,{id:"accountId",value:z,onChange:s=>m({accountId:s.target.value}),placeholder:"123456789012"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Used for generating Queue URLs and ARNs"})]}),e.jsx("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-md",children:e.jsxs("p",{className:"text-sm text-yellow-700 dark:text-yellow-400",children:[e.jsx("strong",{children:"Security Note:"})," In production, use IAM roles or environment variables instead of hardcoding credentials."]})})]})]})}),e.jsx(k,{value:"policies",className:"space-y-4",children:e.jsxs(f,{children:[e.jsx(S,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(M,{children:"IAM Policies"}),e.jsx(I,{children:"Configure access policies for queues"})]}),e.jsxs(N,{onClick:ye,size:"sm",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Add Policy"]})]})}),e.jsx(v,{children:C.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"No policies configured"}):e.jsx("div",{className:"space-y-2",children:C.map(s=>e.jsx(f,{className:"border-l-4 border-l-blue-500",children:e.jsx(v,{className:"pt-4",children:fe===s.id?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Principal"}),e.jsx(h,{value:s.principal,onChange:a=>{const t=C.map(i=>i.id===s.id?{...i,principal:a.target.value}:i);m({iamPolicies:t})},placeholder:"* or arn:aws:iam::..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Action"}),e.jsxs(V,{value:s.action,onValueChange:a=>{const t=C.map(i=>i.id===s.id?{...i,action:a}:i);m({iamPolicies:t})},children:[e.jsx(W,{children:e.jsx(F,{})}),e.jsxs(O,{children:[e.jsx(b,{value:"sqs:SendMessage",children:"SendMessage"}),e.jsx(b,{value:"sqs:ReceiveMessage",children:"ReceiveMessage"}),e.jsx(b,{value:"sqs:DeleteMessage",children:"DeleteMessage"}),e.jsx(b,{value:"sqs:GetQueueAttributes",children:"GetQueueAttributes"}),e.jsx(b,{value:"sqs:*",children:"All Actions (*)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Resource"}),e.jsx(h,{value:s.resource,onChange:a=>{const t=C.map(i=>i.id===s.id?{...i,resource:a.target.value}:i);m({iamPolicies:t})},placeholder:"* or queue name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Effect"}),e.jsxs(V,{value:s.effect,onValueChange:a=>{const t=C.map(i=>i.id===s.id?{...i,effect:a}:i);m({iamPolicies:t})},children:[e.jsx(W,{children:e.jsx(F,{})}),e.jsxs(O,{children:[e.jsx(b,{value:"Allow",children:"Allow"}),e.jsx(b,{value:"Deny",children:"Deny"})]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{size:"sm",onClick:()=>$(null),children:"Save"}),e.jsx(N,{size:"sm",variant:"outline",onClick:()=>$(null),children:"Cancel"})]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Principal"}),e.jsx("p",{className:"text-sm font-medium",children:s.principal})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Action"}),e.jsx(y,{variant:"outline",children:s.action})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Resource"}),e.jsx("p",{className:"text-sm font-medium truncate",title:s.resource,children:s.resource})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Effect"}),e.jsx(y,{variant:s.effect==="Allow"?"default":"destructive",children:s.effect})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>$(s.id),children:e.jsx(Ge,{className:"h-4 w-4"})}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>be(s.id),children:e.jsx(Z,{className:"h-4 w-4"})})]})]})})},s.id))})})]})}),e.jsxs(k,{value:"monitoring",className:"space-y-4",children:[e.jsxs(f,{children:[e.jsxs(S,{children:[e.jsx(M,{children:"Queue Monitoring"}),e.jsx(I,{children:"Monitor queue metrics and performance"})]}),e.jsx(v,{children:e.jsx("div",{className:"space-y-4",children:c.map((s,a)=>e.jsxs(f,{className:"border-l-4 border-l-green-500",children:[e.jsx(S,{className:"pb-3",children:e.jsx(M,{className:"text-base",children:s.name})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Messages Available"}),(s.approximateMessages||0)>n.MESSAGES_HIGH&&e.jsx(y,{variant:"destructive",className:"text-xs",children:"High"})]}),e.jsx("p",{className:"text-2xl font-bold",children:s.approximateMessages?.toLocaleString()||0}),e.jsx(w,{value:Math.min((s.approximateMessages||0)/n.MESSAGES_MAX_PROGRESS*100,100),className:`h-2 ${(s.approximateMessages||0)>n.MESSAGES_HIGH?"bg-red-500":(s.approximateMessages||0)>n.MESSAGES_WARNING?"bg-yellow-500":"bg-green-500"}`}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ready to consume"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"In Flight"}),(s.approximateMessagesNotVisible||0)>n.IN_FLIGHT_WARNING&&e.jsx(y,{variant:"outline",className:"text-xs",children:"Processing"})]}),e.jsx("p",{className:"text-2xl font-bold",children:s.approximateMessagesNotVisible?.toLocaleString()||0}),e.jsx(w,{value:Math.min((s.approximateMessagesNotVisible||0)/2e3*100,100),className:"h-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Being processed"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Delayed"}),e.jsx("p",{className:"text-2xl font-bold",children:s.approximateMessagesDelayed?.toLocaleString()||0}),e.jsx(w,{value:Math.min((s.approximateMessagesDelayed||0)/n.DELAYED_MAX_PROGRESS*100,100),className:"h-2 bg-orange-500"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Waiting for delay"})]})]}),e.jsxs("div",{className:"mt-4 p-3 rounded-md border bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${(s.approximateMessages||0)===0&&(s.approximateMessagesNotVisible||0)===0?"bg-gray-400":(s.approximateMessages||0)<n.MESSAGES_HEALTHY?"bg-green-500 animate-pulse":(s.approximateMessages||0)<n.MESSAGES_HEALTHY0?"bg-yellow-500":"bg-red-500 animate-pulse"}`}),e.jsx("span",{className:"text-sm font-medium",children:"Queue Health"})]}),e.jsx(y,{variant:(s.approximateMessages||0)===0&&(s.approximateMessagesNotVisible||0)===0?"secondary":(s.approximateMessages||0)<n.MESSAGES_HEALTHY?"default":(s.approximateMessages||0)<n.MESSAGES_HEALTHY0?"outline":"destructive",children:(s.approximateMessages||0)===0&&(s.approximateMessagesNotVisible||0)===0?"Idle":(s.approximateMessages||0)<n.MESSAGES_HEALTHY?"Healthy":(s.approximateMessages||0)<n.MESSAGES_HIGH?"Warning":"Critical"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:(s.approximateMessages||0)===0&&(s.approximateMessagesNotVisible||0)===0?"Queue is idle with no messages":(s.approximateMessages||0)<n.MESSAGES_HEALTHY?"Queue is operating normally":(s.approximateMessages||0)<n.MESSAGES_HEALTHY0?"Queue has high message count, consider scaling consumers":"Queue is critically overloaded, immediate action required"})]})]})]},a))})})]}),e.jsxs(f,{children:[e.jsxs(S,{children:[e.jsx(M,{children:"Metrics Export"}),e.jsx(I,{children:"Configure Prometheus metrics export via CloudWatch exporter"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(o,{children:"Enable Metrics Export"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Export SQS metrics via CloudWatch exporter for Prometheus scraping"})]}),e.jsx(ae,{checked:g.metrics?.enabled??!0,onCheckedChange:s=>m({metrics:{...g.metrics,enabled:s,port:g.metrics?.port||9102,path:g.metrics?.path||"/metrics"}})})]}),g.metrics?.enabled!==!1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Metrics Port (CloudWatch Exporter)"}),e.jsx(h,{type:"number",value:g.metrics?.port??9102,onChange:s=>m({metrics:{...g.metrics,port:parseInt(s.target.value)||9102,path:g.metrics?.path||"/metrics"}}),min:1024,max:65535}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Port for CloudWatch exporter metrics endpoint"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Metrics Path"}),e.jsx(h,{type:"text",value:g.metrics?.path??"/metrics",onChange:s=>m({metrics:{...g.metrics,path:s.target.value||"/metrics",port:g.metrics?.port||9102}}),placeholder:"/metrics"})]})]})]})]})]})]})]}),e.jsx(te,{open:D!==null,onOpenChange:s=>!s&&Y(null),children:e.jsxs(ie,{children:[e.jsxs(le,{children:[e.jsx(re,{children:"Delete Queue?"}),e.jsxs(ne,{children:['Are you sure you want to delete queue "',c[D||0]?.name,'"? This action cannot be undone.']})]}),e.jsxs(ce,{children:[e.jsx(oe,{children:"Cancel"}),e.jsx(de,{onClick:Me,children:"Delete"})]})]})}),e.jsx(te,{open:X!==null,onOpenChange:s=>!s&&B(null),children:e.jsxs(ie,{children:[e.jsxs(le,{children:[e.jsx(re,{children:"Delete IAM Policy?"}),e.jsx(ne,{children:"Are you sure you want to delete this IAM policy? This action cannot be undone."})]}),e.jsxs(ce,{children:[e.jsx(oe,{children:"Cancel"}),e.jsx(de,{onClick:Ae,children:"Delete"})]})]})})]})}export{Je as AWSSQSConfigAdvanced};

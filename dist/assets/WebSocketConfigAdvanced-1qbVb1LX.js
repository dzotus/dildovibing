import{E as Fe,u as Ge,X as Xe,j as e,V as Ze,r as b,i as m,S as k,C as x,e as h,f as u,R as Ne,k as j,T as _e,a as Je,b as z,c as Qe,d as B,h as D,L as d,B as $,I as f,ah as ee,Z as Ye,P as se,m as Ce,n as ye,o as Se,p as we,q as ke,s as F,t as K}from"./index-VkfV5NX_.js";import{T as es}from"./textarea-DmRVsU5A.js";import{d as H}from"./toast-Dya0nCAi.js";import{R as ss}from"./refresh-ccw-DNbAAafF.js";import{M as te}from"./message-square-BDIwFm3T.js";import{S as ne}from"./send-vrhZGJxT.js";import{B as je}from"./bell-BIJPsicB.js";import{C as ge}from"./circle-check-big-BQFvBRWo.js";import{P as Ee}from"./pen-GA_JNABA.js";const ts=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],ns=Fe("house",ts);function hs({componentId:E}){const{nodes:Me,updateNode:G}=Ge(),{getComponentMetrics:Re,isRunning:X}=Xe(),P=Me.find(s=>s.id===E);if(!P)return e.jsx("div",{className:"p-4 text-muted-foreground",children:"Component not found"});const i=P.data.config||{};Re(E);const a=Ze.getWebSocketEmulationEngine(E),ie=a?.getWebSocketMetrics(),o=i.connections||[],Z=i.messages||[],L=i.rooms||[],M=i.subscriptions||[],R=i.endpoint||"ws://localhost:8080/ws",Ae=i.protocol||"ws",De=o.filter(s=>s.status==="connected").length,Pe=ie?.connectionsTotal||i.totalConnections||o.length,Le=ie?.connectionsActive||i.activeConnections||De,Te=ie?.messagesTotal||i.totalMessages||Z.length,[_,pe]=b.useState(""),[g,S]=b.useState(!1),[v,T]=b.useState(null),[C,w]=b.useState(null),[y,ae]=b.useState(null),[I,ce]=b.useState(null),[p,O]=b.useState(""),[re,V]=b.useState(""),[N,q]=b.useState("");b.useEffect(()=>{if(v){const s=o.find(t=>t.id===v);s&&s.status==="connected"?(S(!0),C||w(R)):(S(!1),T(null),w(null))}else{const s=o.find(t=>t.id.startsWith("test-client-"));s&&s.status==="connected"?(T(s.id),S(!0),C||w(R)):g&&(S(!1),w(null))}},[o,v,R,C,g]),b.useEffect(()=>{if(!X||!a)return;const s=setInterval(()=>{const t=a.getWebSocketMetrics(),n=a.getActiveConnections(),me=a.getRooms(),xe=a.getSubscriptions(),A=a.getMessageHistory(100);let W=[...n.map(l=>({id:l.id,status:l.status==="connected"?"connected":l.status==="disconnected"?"disconnected":"connecting",connectedAt:l.connectedAt?new Date(l.connectedAt).toISOString():void 0,messagesSent:l.messagesSent,messagesReceived:l.messagesReceived}))];const he=o.filter(l=>l.id.startsWith("test-client-"));for(const l of he){const Y=W.findIndex(Ue=>Ue.id===l.id);Y>=0?W[Y]=l:W.push(l)}const ue=A.map(l=>({id:l.id,type:l.direction==="sent"?"sent":"received",content:typeof l.content=="string"?l.content:"[Binary data]",timestamp:new Date(l.timestamp).toISOString()})),c=(i.messages||[]).filter(l=>l.id.startsWith("msg-")&&!A.find(Y=>Y.id===l.id)),Q=[...ue,...c].slice(-100);G(E,{data:{...P.data,config:{...i,connections:W,rooms:me,subscriptions:xe,messages:Q,totalConnections:t.connectionsTotal,activeConnections:t.connectionsActive,totalMessages:t.messagesTotal}}})},1e3);return()=>clearInterval(s)},[X,a,E,P,i,G,v,o]);const Ie=s=>{if(!s.trim())return"Endpoint is required";try{const t=new URL(s);return t.protocol!=="ws:"&&t.protocol!=="wss:"?"Endpoint must use ws:// or wss:// protocol":null}catch{return"Invalid endpoint URL format"}},U=(s,t,n=1)=>s==null?null:isNaN(s)||s<n?`${t} must be at least ${n}`:null,r=s=>{if(s.endpoint!==void 0){const n=Ie(s.endpoint);if(n){H(n);return}}if(s.maxConnections!==void 0){const n=U(s.maxConnections,"Max connections");if(n){H(n);return}}if(s.maxMessageSize!==void 0){const n=U(s.maxMessageSize,"Max message size");if(n){H(n);return}}if(s.pingInterval!==void 0){const n=U(s.pingInterval,"Ping interval",1);if(n){H(n);return}}if(s.rateLimit){if(s.rateLimit.messagesPerSecond!==void 0){const n=U(s.rateLimit.messagesPerSecond,"Messages per second");if(n){H(n);return}}if(s.rateLimit.connectionsPerSecond!==void 0){const n=U(s.rateLimit.connectionsPerSecond,"Connections per second");if(n){H(n);return}}}const t={...i,...s};G(E,{data:{...P.data,config:t}}),a&&a.updateConfig(t)},We=()=>{if(!_.trim()||!g||!v)return;const s={id:`msg-${Date.now()}`,type:"sent",content:_,timestamp:new Date().toISOString()},t=o.map(n=>n.id===v?{...n,messagesSent:(n.messagesSent||0)+1}:n);r({messages:[...Z,s],connections:t}),pe("")},ze=()=>{if(g){if(v){a&&a.closeConnection(v);const s=o.map(t=>t.id===v?{...t,status:"disconnected",connectedAt:t.connectedAt}:t);r({connections:s}),T(null)}S(!1),w(null)}else{const s=`test-client-${Date.now()}`,t={id:s,status:"connected",connectedAt:new Date().toISOString(),messagesSent:0,messagesReceived:0};if(T(s),w(R),S(!0),r({connections:[...o,t]}),a&&!a.createConnection(s,{clientIP:"127.0.0.1",userAgent:"WebSocket Test Client"})){S(!1),T(null),w(null);return}}},Be=s=>{if(g&&C&&s!==C){let t=[...o];v&&(t=o.map(n=>n.id===v?{...n,status:"disconnected",connectedAt:n.connectedAt}:n),T(null)),S(!1),w(null),r({endpoint:s,connections:t})}else r({endpoint:s})},J=()=>{if(!p.trim())return;const s={id:`room-${Date.now()}`,name:p,connections:[],messagesBroadcast:0,createdAt:Date.now(),description:re},t=[...L,s];r({rooms:t}),a&&a.updateConfig({rooms:t}),O(""),V("")},$e=s=>{ae(s),O(s.name),V(s.description||"")},le=()=>{if(!y||!p.trim())return;const s=L.map(t=>t.id===y.id?{...t,name:p,description:re}:t);r({rooms:s}),a&&a.updateConfig({rooms:s}),ae(null),O(""),V("")},oe=()=>{ae(null),O(""),V("")},Ke=s=>{const t=L.filter(n=>n.id!==s);r({rooms:t}),a&&a.updateConfig({rooms:t})},de=()=>{if(!N.trim())return;const s={id:`sub-${Date.now()}`,topic:N,connections:[],messagesDelivered:0,createdAt:Date.now(),enabled:!0},t=[...M,s];r({subscriptions:t}),a&&a.updateConfig({subscriptions:t}),q("")},He=s=>{const t=M.filter(n=>n.id!==s);r({subscriptions:t}),a&&a.updateConfig({subscriptions:t})},Oe=s=>{ce(s),q(s.topic)},fe=()=>{if(!I||!N.trim())return;const s=M.map(t=>t.id===I.id?{...t,topic:N}:t);r({subscriptions:s}),a&&a.updateConfig({subscriptions:s}),ce(null),q("")},ve=()=>{ce(null),q("")},Ve=s=>{const t=M.map(n=>n.id===s?{...n,enabled:!n.enabled}:n);r({subscriptions:t}),a&&a.updateConfig({subscriptions:t})},qe=()=>{if(a&&X){const s=a.getWebSocketMetrics(),t=a.getActiveConnections(),n=a.getRooms(),me=a.getSubscriptions(),xe=a.getMessageHistory(100),A=t.map(c=>({id:c.id,status:c.status==="connected"?"connected":c.status==="disconnected"?"disconnected":"connecting",connectedAt:c.connectedAt?new Date(c.connectedAt).toISOString():void 0,messagesSent:c.messagesSent,messagesReceived:c.messagesReceived})),be=o.filter(c=>c.id.startsWith("test-client-"));for(const c of be){const Q=A.findIndex(l=>l.id===c.id);Q>=0?A[Q]=c:A.push(c)}const W=n.map(c=>({id:c.id,name:c.name,connections:c.connections,messagesBroadcast:c.messagesBroadcast,createdAt:c.createdAt})),he=me.map(c=>({id:c.id,topic:c.topic,connections:c.connections,messagesDelivered:c.messagesDelivered,createdAt:c.createdAt,enabled:c.enabled})),ue=xe.map(c=>({id:c.id,type:c.direction==="sent"?"sent":"received",content:typeof c.content=="string"?c.content:"[Binary data]",timestamp:new Date(c.timestamp).toISOString()}));G(E,{data:{...P.data,config:{...i,connections:A,rooms:W,subscriptions:he,messages:ue,totalConnections:s.connectionsTotal,activeConnections:s.connectionsActive,totalMessages:s.messagesTotal}}})}};return e.jsx("div",{className:"h-full overflow-y-auto bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground tracking-wide",children:"WebSocket"}),e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"WebSocket Server"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Real-time bidirectional communication"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(m,{variant:"outline",size:"sm",onClick:qe,disabled:!X&&!a,children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),e.jsx(k,{}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs(x,{className:"border-l-4 border-l-blue-500 bg-card",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Connections"}),e.jsx(Ne,{className:"h-4 w-4 text-blue-500"})]})}),e.jsx(j,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:Le}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["/ ",Pe," total"]})]})})]}),e.jsxs(x,{className:"border-l-4 border-l-green-500 bg-card",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Messages"}),e.jsx(te,{className:"h-4 w-4 text-green-500"})]})}),e.jsx(j,{children:e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:Te}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"exchanged"})]})})]}),e.jsxs(x,{className:"border-l-4 border-l-purple-500 bg-card",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Sent"}),e.jsx(ne,{className:"h-4 w-4 text-purple-500"})]})}),e.jsx(j,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-purple-600 dark:text-purple-400",children:o.reduce((s,t)=>s+(t.messagesSent||0),0)})})})]}),e.jsxs(x,{className:"border-l-4 border-l-cyan-500 bg-card",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(u,{className:"text-sm font-medium text-muted-foreground",children:"Received"}),e.jsx(te,{className:"h-4 w-4 text-cyan-500"})]})}),e.jsx(j,{children:e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-3xl font-bold text-cyan-600 dark:text-cyan-400",children:o.reduce((s,t)=>s+(t.messagesReceived||0),0)})})})]})]}),e.jsxs(_e,{defaultValue:"client",className:"space-y-4",children:[e.jsxs(Je,{className:"flex-wrap",children:[e.jsxs(z,{value:"client",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Test Client"]}),e.jsxs(z,{value:"connections",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Connections (",o.length,")"]}),e.jsxs(z,{value:"rooms",children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),"Rooms (",L.length,")"]}),e.jsxs(z,{value:"subscriptions",children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Subscriptions (",M.length,")"]}),e.jsxs(z,{value:"messages",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Messages (",Z.length,")"]}),e.jsxs(z,{value:"settings",children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(B,{value:"client",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"WebSocket Test Client"}),e.jsx(D,{children:"Connect and send messages"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{children:"Endpoint"}),g&&C&&e.jsxs($,{variant:"outline",className:"text-xs",children:["Connected to: ",C]})]}),e.jsx(f,{value:R,onChange:s=>Be(s.target.value),placeholder:"ws://localhost:8080/ws"}),g&&C&&R!==C&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-950/20 p-2 rounded",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{children:"Endpoint changed. Connection has been disconnected."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{onClick:ze,variant:g?"destructive":"default",children:g?"Disconnect":"Connect"}),e.jsx($,{variant:g?"default":"outline",children:g?"Connected":"Disconnected"})]}),e.jsx(k,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Send Message"}),e.jsx(es,{value:_,onChange:s=>pe(s.target.value),className:"font-mono text-sm min-h-[100px]",placeholder:'{ "type": "message", "data": "Hello" }',disabled:!g})]}),e.jsxs(m,{onClick:We,disabled:!g||!_.trim(),children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Send Message"]})]})]})}),e.jsx(B,{value:"connections",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Active Connections"}),e.jsx(D,{children:"WebSocket client connections"})]}),e.jsx(j,{children:e.jsx("div",{className:"space-y-4",children:o.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No connections yet. Use the Test Client tab to create a connection."}):o.map(s=>e.jsxs(x,{className:`border-l-4 hover:shadow-md transition-shadow bg-card ${s.status==="connected"?"border-l-green-500":s.status==="disconnected"?"border-l-gray-400":"border-l-yellow-500"}`,children:[e.jsx(h,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.status==="connected"?"bg-green-100 dark:bg-green-900/30":s.status==="disconnected"?"bg-gray-100 dark:bg-gray-900/30":"bg-yellow-100 dark:bg-yellow-900/30"}`,children:s.status==="connected"?e.jsx(ge,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):s.status==="disconnected"?e.jsx(ee,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"}):e.jsx(Ye,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg font-semibold",children:s.id.startsWith("test-client-")?"Test Client":s.id}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx($,{variant:s.status==="connected"?"default":"outline",children:s.status}),s.connectedAt&&e.jsxs($,{variant:"outline",children:[s.status==="connected"?"Connected":"Disconnected"," ",new Date(s.connectedAt).toLocaleString()]})]})]})]})})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Sent:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.messagesSent||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Received:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.messagesReceived||0})]}),s.lastMessage&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Last:"}),e.jsx("span",{className:"ml-2 font-semibold truncate",children:s.lastMessage})]})]})})]},s.id))})})]})}),e.jsx(B,{value:"messages",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Message History"}),e.jsx(D,{children:"Sent and received messages"})]}),e.jsx(j,{children:e.jsx("div",{className:"space-y-4",children:Z.map(s=>e.jsxs(x,{className:`border-l-4 ${s.type==="sent"?"border-l-green-500 bg-card":"border-l-blue-500 bg-card"} hover:shadow-md transition-shadow`,children:[e.jsx(h,{className:"pb-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.type==="sent"?"bg-green-100 dark:bg-green-900/30":"bg-blue-100 dark:bg-blue-900/30"}`,children:s.type==="sent"?e.jsx(ne,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(te,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg font-semibold capitalize",children:s.type}),e.jsx($,{variant:"outline",className:"mt-2",children:new Date(s.timestamp).toLocaleString()})]})]})})}),e.jsx(j,{children:e.jsx("pre",{className:"p-3 bg-muted rounded text-xs font-mono overflow-x-auto",children:s.content})})]},s.id))})})]})}),e.jsx(B,{value:"rooms",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Rooms"}),e.jsx(D,{children:"Group connections into rooms for broadcasting"})]}),e.jsxs(m,{onClick:J,size:"sm",disabled:!p.trim(),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add Room"]})]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{value:p,onChange:s=>O(s.target.value),placeholder:"Room name",className:"flex-1",onKeyDown:s=>{s.key==="Enter"&&!y&&p.trim()?J():s.key==="Enter"&&y&&p.trim()?le():s.key==="Escape"&&y&&oe()}}),e.jsx(f,{value:re,onChange:s=>V(s.target.value),placeholder:"Description (optional)",className:"flex-1",onKeyDown:s=>{s.key==="Enter"&&!y&&p.trim()?J():s.key==="Enter"&&y&&p.trim()?le():s.key==="Escape"&&y&&oe()}}),y?e.jsxs(e.Fragment,{children:[e.jsxs(m,{onClick:le,disabled:!p.trim(),children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Save"]}),e.jsxs(m,{onClick:oe,variant:"outline",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):e.jsxs(m,{onClick:J,disabled:!p.trim(),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add"]})]}),e.jsx(k,{}),e.jsxs("div",{className:"space-y-4",children:[L.map(s=>e.jsxs(x,{className:"border-l-4 border-l-purple-500",children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{className:"text-lg",children:s.name}),s.description&&e.jsx(D,{className:"mt-1",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>$e(s),children:e.jsx(Ee,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>Ke(s.id),children:e.jsx(Ce,{className:"h-4 w-4 text-destructive"})})]})]})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Connections:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.connections?.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Messages:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.messagesBroadcast||0})]}),s.createdAt&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"}),e.jsx("span",{className:"ml-2 font-semibold",children:new Date(s.createdAt).toLocaleDateString()})]})]})})]},s.id)),L.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No rooms created yet. Create a room to group connections."})]})]})]})}),e.jsx(B,{value:"subscriptions",className:"space-y-4",children:e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(u,{children:"Subscriptions"}),e.jsx(D,{children:"Subscribe connections to topics for event delivery"})]}),e.jsxs(m,{onClick:de,size:"sm",disabled:!N.trim(),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add Subscription"]})]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{value:N,onChange:s=>q(s.target.value),placeholder:"Topic name (e.g., notifications, updates)",className:"flex-1",onKeyDown:s=>{s.key==="Enter"&&!I&&N.trim()?de():s.key==="Enter"&&I&&N.trim()?fe():s.key==="Escape"&&I&&ve()}}),I?e.jsxs(e.Fragment,{children:[e.jsxs(m,{onClick:fe,disabled:!N.trim(),children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Save"]}),e.jsxs(m,{onClick:ve,variant:"outline",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}):e.jsxs(m,{onClick:de,disabled:!N.trim(),children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add"]})]}),e.jsx(k,{}),e.jsxs("div",{className:"space-y-4",children:[M.map(s=>e.jsxs(x,{className:`border-l-4 ${s.enabled?"border-l-green-500":"border-l-gray-300"}`,children:[e.jsx(h,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.enabled?"bg-green-100 dark:bg-green-900/30":"bg-gray-100 dark:bg-gray-900/30"}`,children:s.enabled?e.jsx(je,{className:"h-5 w-5 text-green-600 dark:text-green-400"}):e.jsx(je,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("div",{children:[e.jsx(u,{className:"text-lg",children:s.topic}),e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx($,{variant:s.enabled?"default":"outline",children:s.enabled?"Enabled":"Disabled"})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>Oe(s),children:e.jsx(Ee,{className:"h-4 w-4"})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>Ve(s.id),children:s.enabled?"Disable":"Enable"}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>He(s.id),children:e.jsx(Ce,{className:"h-4 w-4 text-destructive"})})]})]})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Subscribers:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.connections?.length||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Messages:"}),e.jsx("span",{className:"ml-2 font-semibold",children:s.messagesDelivered||0})]}),s.createdAt&&e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"}),e.jsx("span",{className:"ml-2 font-semibold",children:new Date(s.createdAt).toLocaleDateString()})]})]})})]},s.id)),M.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No subscriptions created yet. Create a subscription to deliver messages to connections."})]})]})]})}),e.jsx(B,{value:"settings",className:"space-y-4",children:e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"WebSocket Settings"}),e.jsx(D,{children:"Server configuration"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Endpoint URL"}),e.jsx(f,{value:R,onChange:s=>r({endpoint:s.target.value}),placeholder:"ws://localhost:8080/ws"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Protocol"}),e.jsxs(ye,{value:Ae,onValueChange:s=>r({protocol:s}),children:[e.jsx(Se,{children:e.jsx(we,{})}),e.jsxs(ke,{children:[e.jsx(F,{value:"ws",children:"WS (WebSocket)"}),e.jsx(F,{value:"wss",children:"WSS (Secure WebSocket)"})]})]})]}),e.jsx(k,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{children:"Enable Compression"}),e.jsx(K,{checked:i.enableCompression??!0,onCheckedChange:s=>r({enableCompression:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(d,{children:"Enable Ping/Pong"}),e.jsx(K,{checked:i.enablePingPong??!0,onCheckedChange:s=>r({enablePingPong:s})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Ping Interval (seconds)"}),e.jsx(f,{type:"number",value:i.pingInterval??30,onChange:s=>r({pingInterval:parseInt(s.target.value)||30}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Max Connections"}),e.jsx(f,{type:"number",value:i.maxConnections??1e3,onChange:s=>r({maxConnections:parseInt(s.target.value)||1e3}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Max Message Size (KB)"}),e.jsx(f,{type:"number",value:i.maxMessageSize??1024,onChange:s=>r({maxMessageSize:parseInt(s.target.value)||1024}),min:1})]}),e.jsx(k,{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Enable Rooms"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Group connections for broadcasting"})]}),e.jsx(K,{checked:i.roomsEnabled??!0,onCheckedChange:s=>r({roomsEnabled:s})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Enable Subscriptions"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Subscribe to topics for event delivery"})]}),e.jsx(K,{checked:i.subscriptionsEnabled??!0,onCheckedChange:s=>r({subscriptionsEnabled:s})})]}),e.jsx(k,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Authentication"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Require authentication for connections"})]}),e.jsx(K,{checked:i.authentication?.enabled??!1,onCheckedChange:s=>r({authentication:{...i.authentication,enabled:s,method:i.authentication?.method||"none"}})})]}),i.authentication?.enabled&&e.jsxs("div",{className:"space-y-2 pl-6 border-l-2",children:[e.jsx(d,{children:"Authentication Method"}),e.jsxs(ye,{value:i.authentication?.method||"none",onValueChange:s=>r({authentication:{...i.authentication,method:s}}),children:[e.jsx(Se,{children:e.jsx(we,{})}),e.jsxs(ke,{children:[e.jsx(F,{value:"token",children:"Token"}),e.jsx(F,{value:"apiKey",children:"API Key"}),e.jsx(F,{value:"basic",children:"Basic Auth"})]})]}),i.authentication?.method==="token"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Token"}),e.jsx(f,{type:"password",value:i.authentication?.token||"",onChange:s=>r({authentication:{...i.authentication,token:s.target.value}}),placeholder:"Enter token"})]}),i.authentication?.method==="apiKey"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"API Key"}),e.jsx(f,{type:"password",value:i.authentication?.apiKey||"",onChange:s=>r({authentication:{...i.authentication,apiKey:s.target.value}}),placeholder:"Enter API key"})]})]})]}),e.jsx(k,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(d,{children:"Rate Limiting"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Limit message and connection rates"})]}),e.jsx(K,{checked:i.rateLimit?.enabled??!1,onCheckedChange:s=>r({rateLimit:{...i.rateLimit,enabled:s,messagesPerSecond:i.rateLimit?.messagesPerSecond||1e3,connectionsPerSecond:i.rateLimit?.connectionsPerSecond||100}})})]}),i.rateLimit?.enabled&&e.jsxs("div",{className:"space-y-2 pl-6 border-l-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Messages Per Second"}),e.jsx(f,{type:"number",value:i.rateLimit?.messagesPerSecond||1e3,onChange:s=>r({rateLimit:{...i.rateLimit,messagesPerSecond:parseInt(s.target.value)||1e3}}),min:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Connections Per Second"}),e.jsx(f,{type:"number",value:i.rateLimit?.connectionsPerSecond||100,onChange:s=>r({rateLimit:{...i.rateLimit,connectionsPerSecond:parseInt(s.target.value)||100}}),min:1})]})]})]})]})]})})]})]})})}export{hs as WebSocketConfigAdvanced};
